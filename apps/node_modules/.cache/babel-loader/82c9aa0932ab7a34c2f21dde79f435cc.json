{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback } from 'react';\nimport { use3DRevisionsQuery } from './use3DRevisionsQuery';\nexport const useDefault3DModelRevision = (modelId, opts) => {\n  _s();\n  return use3DRevisionsQuery(modelId, {\n    select: useCallback((revisions = []) => {\n      const publishedRevisions = revisions.filter(r => r.published);\n      if (!revisions.length) {\n        return undefined;\n      } else {\n        if (!publishedRevisions.length) {\n          return revisions.reduce(findNewestRevision, {}) || undefined;\n        }\n        return publishedRevisions.reduce(findNewestRevision, {});\n      }\n    }, []),\n    ...opts\n  });\n};\n\n/**\n * iterator for reducer\n */\n_s(useDefault3DModelRevision, \"epj4qY15NHsef74wNqHIp5fdZmg=\");\nexport const findNewestRevision = (acc, current) => {\n  return acc?.createdTime > current?.createdTime ? acc : current;\n};","map":{"version":3,"names":["useCallback","use3DRevisionsQuery","useDefault3DModelRevision","modelId","opts","select","revisions","publishedRevisions","filter","r","published","length","undefined","reduce","findNewestRevision","acc","current","createdTime"],"sources":["/Volumes/csvol/fusion/libs/data-exploration/domain-layer/src/threeD/internal/queries/useDefault3DModelRevision.ts"],"sourcesContent":["import { useCallback } from 'react';\n\nimport { Revision3DWithIndex, RevisionOpts } from '../types';\n\nimport { use3DRevisionsQuery } from './use3DRevisionsQuery';\n\nexport const useDefault3DModelRevision = (\n  modelId?: number,\n  opts?: Omit<\n    RevisionOpts<Revision3DWithIndex | undefined>,\n    'queryKey' | 'queryFn' | 'select'\n  >\n) => {\n  return use3DRevisionsQuery(modelId, {\n    select: useCallback((revisions: Revision3DWithIndex[] = []) => {\n      const publishedRevisions = revisions.filter((r) => r.published);\n\n      if (!revisions.length) {\n        return undefined;\n      } else {\n        if (!publishedRevisions.length) {\n          return (\n            revisions.reduce(findNewestRevision, {} as Revision3DWithIndex) ||\n            undefined\n          );\n        }\n        return publishedRevisions.reduce(\n          findNewestRevision,\n          {} as Revision3DWithIndex\n        );\n      }\n    }, []),\n    ...opts,\n  });\n};\n\n/**\n * iterator for reducer\n */\nexport const findNewestRevision = (\n  acc: Revision3DWithIndex,\n  current: Revision3DWithIndex\n) => {\n  return acc?.createdTime > current?.createdTime ? acc : current;\n};\n"],"mappings":";AAAA,SAASA,WAAW,QAAQ,OAAO;AAInC,SAASC,mBAAmB,QAAQ,uBAAuB;AAE3D,OAAO,MAAMC,yBAAyB,GAAG,CACvCC,OAAgB,EAChBC,IAGC,KACE;EAAA;EACH,OAAOH,mBAAmB,CAACE,OAAO,EAAE;IAClCE,MAAM,EAAEL,WAAW,CAAC,CAACM,SAAgC,GAAG,EAAE,KAAK;MAC7D,MAAMC,kBAAkB,GAAGD,SAAS,CAACE,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACC,SAAS,CAAC;MAE/D,IAAI,CAACJ,SAAS,CAACK,MAAM,EAAE;QACrB,OAAOC,SAAS;MAClB,CAAC,MAAM;QACL,IAAI,CAACL,kBAAkB,CAACI,MAAM,EAAE;UAC9B,OACEL,SAAS,CAACO,MAAM,CAACC,kBAAkB,EAAE,CAAC,CAAC,CAAwB,IAC/DF,SAAS;QAEb;QACA,OAAOL,kBAAkB,CAACM,MAAM,CAC9BC,kBAAkB,EAClB,CAAC,CAAC,CACH;MACH;IACF,CAAC,EAAE,EAAE,CAAC;IACN,GAAGV;EACL,CAAC,CAAC;AACJ,CAAC;;AAED;AACA;AACA;AAFA,GA9BaF,yBAAyB;AAiCtC,OAAO,MAAMY,kBAAkB,GAAG,CAChCC,GAAwB,EACxBC,OAA4B,KACzB;EACH,OAAOD,GAAG,EAAEE,WAAW,GAAGD,OAAO,EAAEC,WAAW,GAAGF,GAAG,GAAGC,OAAO;AAChE,CAAC"},"metadata":{},"sourceType":"module"}