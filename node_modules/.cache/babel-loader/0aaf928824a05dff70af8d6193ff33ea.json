{"ast":null,"code":"import { useMemo } from 'react';\nimport omit from 'lodash/omit';\nimport { mergeDynamicFilterOptions } from '../../../utils/mergeDynamicFilterOptions';\nimport { useDocumentsMetadataValuesAggregateQuery } from '../../service';\nimport { mapFiltersToDocumentSearchFilters } from '../transformers';\nexport const useDocumentMetadataValuesOptionsQuery = ({\n  searchQuery,\n  filter\n}) => {\n  var _s = $RefreshSig$();\n  return _s((metadataKey, query, options) => {\n    _s();\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const {\n      data = [],\n      isLoading\n    } = useDocumentsMetadataValuesAggregateQuery({\n      metadataKey,\n      query,\n      options\n    });\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const {\n      data: dynamicData = []\n    } = useDocumentsMetadataValuesAggregateQuery({\n      metadataKey,\n      query,\n      filter: mapFiltersToDocumentSearchFilters(omit(filter, 'metadata'), searchQuery),\n      options\n    });\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const transformedOptions = useMemo(() => {\n      return mergeDynamicFilterOptions(data, dynamicData);\n    }, [data, dynamicData]);\n    return {\n      options: transformedOptions,\n      isLoading\n    };\n  }, \"yM30trnFAMSmysFUAkbK69BI57o=\", false, function () {\n    return [useDocumentsMetadataValuesAggregateQuery, useDocumentsMetadataValuesAggregateQuery];\n  });\n};","map":{"version":3,"names":["useMemo","omit","mergeDynamicFilterOptions","useDocumentsMetadataValuesAggregateQuery","mapFiltersToDocumentSearchFilters","useDocumentMetadataValuesOptionsQuery","searchQuery","filter","metadataKey","query","options","data","isLoading","dynamicData","transformedOptions"],"sources":["/Volumes/csvol/fusion/libs/data-exploration/domain-layer/src/documents/internal/hooks/useDocumentMetadataValuesOptionsQuery.ts"],"sourcesContent":["import { useMemo } from 'react';\n\nimport { UseQueryOptions } from '@tanstack/react-query';\nimport omit from 'lodash/omit';\n\nimport { InternalDocumentFilter } from '@data-exploration-lib/core';\n\nimport { mergeDynamicFilterOptions } from '../../../utils/mergeDynamicFilterOptions';\nimport { useDocumentsMetadataValuesAggregateQuery } from '../../service';\nimport { mapFiltersToDocumentSearchFilters } from '../transformers';\n\ninterface Props {\n  searchQuery?: string;\n  filter?: InternalDocumentFilter;\n}\n\nexport const useDocumentMetadataValuesOptionsQuery =\n  ({ searchQuery, filter }: Props) =>\n  (\n    metadataKey?: string | null,\n    query?: string,\n    options?: UseQueryOptions<any>\n  ) => {\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const { data = [], isLoading } = useDocumentsMetadataValuesAggregateQuery({\n      metadataKey,\n      query,\n      options,\n    });\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const { data: dynamicData = [] } = useDocumentsMetadataValuesAggregateQuery(\n      {\n        metadataKey,\n        query,\n        filter: mapFiltersToDocumentSearchFilters(\n          omit(filter, 'metadata'),\n          searchQuery\n        ),\n        options,\n      }\n    );\n\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const transformedOptions = useMemo(() => {\n      return mergeDynamicFilterOptions(data, dynamicData);\n    }, [data, dynamicData]);\n\n    return { options: transformedOptions, isLoading };\n  };\n"],"mappings":"AAAA,SAASA,OAAO,QAAQ,OAAO;AAG/B,OAAOC,IAAI,MAAM,aAAa;AAI9B,SAASC,yBAAyB,QAAQ,0CAA0C;AACpF,SAASC,wCAAwC,QAAQ,eAAe;AACxE,SAASC,iCAAiC,QAAQ,iBAAiB;AAOnE,OAAO,MAAMC,qCAAqC,GAChD,CAAC;EAAEC,WAAW;EAAEC;AAAc,CAAC;EAAA;EAAA,UAC/B,CACEC,WAA2B,EAC3BC,KAAc,EACdC,OAA8B,KAC3B;IAAA;IACH;IACA,MAAM;MAAEC,IAAI,GAAG,EAAE;MAAEC;IAAU,CAAC,GAAGT,wCAAwC,CAAC;MACxEK,WAAW;MACXC,KAAK;MACLC;IACF,CAAC,CAAC;;IAEF;IACA,MAAM;MAAEC,IAAI,EAAEE,WAAW,GAAG;IAAG,CAAC,GAAGV,wCAAwC,CACzE;MACEK,WAAW;MACXC,KAAK;MACLF,MAAM,EAAEH,iCAAiC,CACvCH,IAAI,CAACM,MAAM,EAAE,UAAU,CAAC,EACxBD,WAAW,CACZ;MACDI;IACF,CAAC,CACF;;IAED;IACA,MAAMI,kBAAkB,GAAGd,OAAO,CAAC,MAAM;MACvC,OAAOE,yBAAyB,CAACS,IAAI,EAAEE,WAAW,CAAC;IACrD,CAAC,EAAE,CAACF,IAAI,EAAEE,WAAW,CAAC,CAAC;IAEvB,OAAO;MAAEH,OAAO,EAAEI,kBAAkB;MAAEF;IAAU,CAAC;EACnD,CAAC;IAAA,QAzBkCT,wCAAwC,EAOtCA,wCAAwC;EAAA;AAAA,CAkB5E"},"metadata":{},"sourceType":"module"}