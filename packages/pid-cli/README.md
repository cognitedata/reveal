# PID CLI

This tool is created to process files generated by Diagram Parser (react-pid) to JSON files that can be consumed by LineWalk.

This package primarily uses Typescript to use methods and typings from `pid-tools`.
It is not included in the bazel build, but instead compiled in memory when the script is run using ts-node.

The scripts used to download and upload files to CDF are in Python as the [Cogitne Javascript SDK](https://github.com/cognitedata/cognite-sdk-js) does not support personal authentication with interactive login, when not used in browser context.

## Get started

Run

```
yarn install
```

in the root directory in this package to install Typescript and Python dependencies.

## Versioning

The output used by LineWalk has versioning, and you should supply a version when running the script (default is 0.0.1). If a previously uploaded version is used, it will overwrite the existing files when uploading to CDF.

## Usage

### Download graph documents from CDF

Run the following command to download all parsed files from Diagram Parser in CDF to the `./graphs` folder.

**Note: this will overwrite any files with conflicting file names**.

```bash
yarn download
```

### Calculate only

Run the following parse the graphs in the `./graphs` folder and output the Linewalk output to the `./documents` folder.

```bash
yarn parse --output-version <version>
```

### Upload only

Run the following command to upload the documents in the `./documents` folder to CDF.

```bash
yarn upload
```

### Download, Calculate and Upload

Run

```
sh cli.sh -v ${version}
```

to run the three steps above in one command.
