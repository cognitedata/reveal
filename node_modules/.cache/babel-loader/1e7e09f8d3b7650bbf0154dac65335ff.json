{"ast":null,"code":"import { calculateGranularity } from '../utils';\nexport const mapToTimeseriesDatapointsQuery = ({\n  query,\n  metadata\n}) => {\n  const {\n    timeseriesId,\n    dateRange\n  } = query;\n  const {\n    numberOfPoints,\n    dataFetchMode\n  } = metadata;\n  const queryBase = {\n    id: timeseriesId,\n    start: dateRange?.[0],\n    end: dateRange?.[1],\n    limit: numberOfPoints\n  };\n  if (dataFetchMode === 'raw') {\n    return queryBase;\n  }\n  return {\n    ...queryBase,\n    aggregates: ['average', 'max', 'min', 'count'],\n    granularity: calculateGranularity(dateRange, numberOfPoints)\n  };\n};","map":{"version":3,"names":["calculateGranularity","mapToTimeseriesDatapointsQuery","query","metadata","timeseriesId","dateRange","numberOfPoints","dataFetchMode","queryBase","id","start","end","limit","aggregates","granularity"],"sources":["/Volumes/csvol/fusion/libs/shared/plotting-components/src/TimeseriesChart/domain/internal/transformers/mapToTimeseriesDatapointsQuery.ts"],"sourcesContent":["import {\n  TimeseriesDatapointsQuery,\n  TimeseriesDatapointsQueryBase,\n} from '../../service/types';\nimport { TimeseriesChartMetadata, TimeseriesChartQuery } from '../types';\nimport { calculateGranularity } from '../utils';\n\ninterface Props {\n  query: TimeseriesChartQuery;\n  metadata: TimeseriesChartMetadata;\n}\n\nexport const mapToTimeseriesDatapointsQuery = ({\n  query,\n  metadata,\n}: Props): TimeseriesDatapointsQuery => {\n  const { timeseriesId, dateRange } = query;\n  const { numberOfPoints, dataFetchMode } = metadata;\n\n  const queryBase: TimeseriesDatapointsQueryBase = {\n    id: timeseriesId,\n    start: dateRange?.[0],\n    end: dateRange?.[1],\n    limit: numberOfPoints,\n  };\n\n  if (dataFetchMode === 'raw') {\n    return queryBase;\n  }\n\n  return {\n    ...queryBase,\n    aggregates: ['average', 'max', 'min', 'count'],\n    granularity: calculateGranularity(dateRange, numberOfPoints),\n  };\n};\n"],"mappings":"AAKA,SAASA,oBAAoB,QAAQ,UAAU;AAO/C,OAAO,MAAMC,8BAA8B,GAAG,CAAC;EAC7CC,KAAK;EACLC;AACK,CAAC,KAAgC;EACtC,MAAM;IAAEC,YAAY;IAAEC;EAAU,CAAC,GAAGH,KAAK;EACzC,MAAM;IAAEI,cAAc;IAAEC;EAAc,CAAC,GAAGJ,QAAQ;EAElD,MAAMK,SAAwC,GAAG;IAC/CC,EAAE,EAAEL,YAAY;IAChBM,KAAK,EAAEL,SAAS,GAAG,CAAC,CAAC;IACrBM,GAAG,EAAEN,SAAS,GAAG,CAAC,CAAC;IACnBO,KAAK,EAAEN;EACT,CAAC;EAED,IAAIC,aAAa,KAAK,KAAK,EAAE;IAC3B,OAAOC,SAAS;EAClB;EAEA,OAAO;IACL,GAAGA,SAAS;IACZK,UAAU,EAAE,CAAC,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,CAAC;IAC9CC,WAAW,EAAEd,oBAAoB,CAACK,SAAS,EAAEC,cAAc;EAC7D,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"module"}