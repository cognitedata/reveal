{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$(),\n  _s5 = $RefreshSig$(),\n  _s6 = $RefreshSig$(),\n  _s7 = $RefreshSig$(),\n  _s8 = $RefreshSig$(),\n  _s9 = $RefreshSig$(),\n  _s10 = $RefreshSig$(),\n  _s11 = $RefreshSig$(),\n  _s12 = $RefreshSig$(),\n  _s13 = $RefreshSig$(),\n  _s14 = $RefreshSig$(),\n  _s15 = $RefreshSig$();\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport camelCase from 'lodash/camelCase';\nimport mapKeys from 'lodash/mapKeys';\nimport sdk, { getUserInformation } from '@cognite/cdf-sdk-singleton';\nimport { getProject } from '@cognite/cdf-utilities';\nimport { getCalls, getCall, getResponse, getLogs, getLatestCalls, getScheduleData } from './api';\nimport { allFunctionsKey, allSchedulesKey, callKey, callsKey, functionKey, logsKey, responseKey, sortFunctionKey, limitsKey } from './queryKeys';\nexport const useFunctions = config => {\n  _s();\n  const cache = useQueryClient();\n  return useQuery([allFunctionsKey], () => sdk.get(`/api/v1/projects/${getProject()}/functions`).then(r => r.data?.items), {\n    onSuccess: functions => {\n      functions.forEach(fn => {\n        cache.setQueryData(functionKey({\n          id: fn.id\n        }), fn);\n      });\n    },\n    ...config\n  });\n};\n_s(useFunctions, \"YAWdbCDwv3qCh8x+qcnpA2qpet4=\", false, function () {\n  return [useQueryClient, useQuery];\n});\nexport const useFunction = (id, config) => {\n  _s2();\n  return useQuery(functionKey({\n    id\n  }), () => sdk.get(`/api/v1/projects/${getProject()}/functions/${id}`).then(r => r.data), config);\n};\n_s2(useFunction, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useSchedules = config => {\n  _s3();\n  return useQuery([allSchedulesKey], () => sdk.get(`/api/v1/projects/${getProject()}/functions/schedules`, {\n    params: {\n      limit: 1000\n    }\n  }).then(r => r.data?.items), config);\n};\n_s3(useSchedules, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useRetriveScheduleInputData = (scheduleId, config) => {\n  _s4();\n  return useQuery([allSchedulesKey, scheduleId], () => getScheduleData(scheduleId), config);\n};\n_s4(useRetriveScheduleInputData, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useLimits = config => {\n  _s5();\n  return useQuery([limitsKey], () => sdk.get(`/api/v1/projects/${getProject()}/functions/limits`, {\n    params: {\n      vendor: true\n    }\n  }).then(r => mapKeys(r.data, (_, key) => camelCase(key))), config);\n};\n_s5(useLimits, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useCalls = (args, config) => {\n  _s6();\n  return useQuery(callsKey(args), () => getCalls(callsKey(args), args), config);\n};\n_s6(useCalls, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useMultipleCalls = (args, config) => {\n  _s7();\n  return useQuery([sortFunctionKey, args], () => getLatestCalls([sortFunctionKey, args], args), config);\n};\n_s7(useMultipleCalls, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useCall = (args, config) => {\n  _s8();\n  return useQuery(callKey(args), () => getCall(callKey(args), args), config);\n};\n_s8(useCall, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useResponse = (args, config) => {\n  _s9();\n  return useQuery(responseKey(args), () => getResponse(responseKey(args), args), config);\n};\n_s9(useResponse, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useLogs = (args, config) => {\n  _s10();\n  return useQuery(logsKey(args), () => getLogs(logsKey(args), args), config);\n};\n_s10(useLogs, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useSDK = (assetType, method, data) => {\n  _s11();\n  return useQuery(['sdk', assetType, data], () =>\n  // @ts-ignore\n  sdk[assetType][method](data));\n};\n_s11(useSDK, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useRefreshApp = () => {\n  _s12();\n  const client = useQueryClient();\n  return () => {\n    client.invalidateQueries();\n  };\n};\n_s12(useRefreshApp, \"jwLmtA0E3A/BpKDVRSeX2+udCjw=\", false, function () {\n  return [useQueryClient];\n});\nexport const useUserInformation = () => {\n  _s13();\n  return useQuery(['user-info'], getUserInformation);\n};\n_s13(useUserInformation, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useCheckActivateFunction = config => {\n  _s14();\n  const project = getProject();\n  return useQuery(['activation', project], () => sdk.get(`api/v1/projects/${project}/functions/status`).then(res => res.data), config);\n};\n_s14(useCheckActivateFunction, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nexport const useActivateFunction = config => {\n  _s15();\n  const client = useQueryClient();\n  const project = getProject();\n  return useMutation(() => sdk.post(`/api/v1/projects/${project}/functions/status`).then(res => res.data), {\n    ...config,\n    onSuccess: data => {\n      client.setQueryData(['activation', project], data);\n    }\n  });\n};\n_s15(useActivateFunction, \"N9hHMCery2qbpCs8Wlv5Qz9CRK4=\", false, function () {\n  return [useQueryClient, useMutation];\n});","map":{"version":3,"names":["useQuery","useMutation","useQueryClient","camelCase","mapKeys","sdk","getUserInformation","getProject","getCalls","getCall","getResponse","getLogs","getLatestCalls","getScheduleData","allFunctionsKey","allSchedulesKey","callKey","callsKey","functionKey","logsKey","responseKey","sortFunctionKey","limitsKey","useFunctions","config","cache","get","then","r","data","items","onSuccess","functions","forEach","fn","setQueryData","id","useFunction","useSchedules","params","limit","useRetriveScheduleInputData","scheduleId","useLimits","vendor","_","key","useCalls","args","useMultipleCalls","useCall","useResponse","useLogs","useSDK","assetType","method","useRefreshApp","client","invalidateQueries","useUserInformation","useCheckActivateFunction","project","res","useActivateFunction","post"],"sources":["/Volumes/csvol/fusion/apps/functions-ui/src/utils/hooks.ts"],"sourcesContent":["import {\n  useQuery,\n  useMutation,\n  QueryOptions,\n  useQueryClient,\n  QueryObserverOptions,\n} from '@tanstack/react-query';\nimport camelCase from 'lodash/camelCase';\nimport mapKeys from 'lodash/mapKeys';\n\nimport sdk, { getUserInformation } from '@cognite/cdf-sdk-singleton';\nimport { getProject } from '@cognite/cdf-utilities';\n\nimport {\n  CogFunction,\n  GetCallsArgs,\n  Call,\n  GetCallArgs,\n  CallResponse,\n  Log,\n  Schedule,\n  CogFunctionLimit,\n} from '../types';\n\nimport {\n  getCalls,\n  getCall,\n  getResponse,\n  getLogs,\n  getLatestCalls,\n  getScheduleData,\n} from './api';\nimport {\n  allFunctionsKey,\n  allSchedulesKey,\n  callKey,\n  callsKey,\n  functionKey,\n  logsKey,\n  responseKey,\n  sortFunctionKey,\n  limitsKey,\n} from './queryKeys';\n\nexport const useFunctions = (\n  config?: QueryObserverOptions<CogFunction[], unknown>\n) => {\n  const cache = useQueryClient();\n  return useQuery<CogFunction[]>(\n    [allFunctionsKey],\n    () =>\n      sdk\n        .get(`/api/v1/projects/${getProject()}/functions`)\n        .then((r) => r.data?.items),\n    {\n      onSuccess: (functions) => {\n        functions.forEach((fn) => {\n          cache.setQueryData(functionKey({ id: fn.id }), fn);\n        });\n      },\n      ...config,\n    }\n  );\n};\nexport const useFunction = (\n  id: number,\n  config?: QueryOptions<CogFunction, unknown>\n) =>\n  useQuery<CogFunction>(\n    functionKey({ id }),\n    () =>\n      sdk\n        .get(`/api/v1/projects/${getProject()}/functions/${id}`)\n        .then((r) => r.data),\n    config\n  );\nexport const useSchedules = (config?: QueryOptions<Schedule[], unknown>) =>\n  useQuery<Schedule[]>(\n    [allSchedulesKey],\n    () =>\n      sdk\n        .get(`/api/v1/projects/${getProject()}/functions/schedules`, {\n          params: { limit: 1000 },\n        })\n        .then((r) => r.data?.items),\n    config\n  );\n\ntype ObjectType = Record<string, any>;\nexport const useRetriveScheduleInputData = (\n  scheduleId: number,\n  config?: QueryOptions<ObjectType, unknown>\n) => {\n  return useQuery<ObjectType>(\n    [allSchedulesKey, scheduleId],\n    () => getScheduleData(scheduleId),\n    config\n  );\n};\nexport const useLimits = (config?: QueryOptions<CogFunctionLimit, unknown>) =>\n  useQuery<CogFunctionLimit>(\n    [limitsKey],\n    () =>\n      sdk\n        .get(`/api/v1/projects/${getProject()}/functions/limits`, {\n          params: { vendor: true },\n        })\n        .then(\n          (r) => mapKeys(r.data, (_, key) => camelCase(key)) as CogFunctionLimit\n        ),\n    config\n  );\nexport const useCalls = (\n  args: GetCallsArgs,\n  config?: QueryOptions<Call[], unknown>\n) =>\n  useQuery<Call[]>(\n    callsKey(args),\n    () => getCalls(callsKey(args), args),\n    config\n  );\n\nexport const useMultipleCalls = (\n  args: GetCallsArgs[],\n  config?: QueryOptions<{ [id: number]: Call | undefined }, unknown>\n) =>\n  useQuery<{ [id: number]: Call | undefined }>(\n    [sortFunctionKey, args],\n    () => getLatestCalls([sortFunctionKey, args], args),\n    config\n  );\n\nexport const useCall = (\n  args: GetCallArgs,\n  config?: QueryOptions<Call, unknown>\n) => useQuery<Call>(callKey(args), () => getCall(callKey(args), args), config);\n\nexport const useResponse = (\n  args: GetCallArgs,\n  config?: QueryOptions<CallResponse, unknown>\n) =>\n  useQuery<CallResponse>(\n    responseKey(args),\n    () => getResponse(responseKey(args), args),\n    config\n  );\n\nexport const useLogs = (\n  args: GetCallArgs,\n  config?: QueryOptions<Log[], unknown>\n) => useQuery<Log[]>(logsKey(args), () => getLogs(logsKey(args), args), config);\n\ntype AssetType = 'files';\ntype Method = 'retrieve' | 'filter';\nexport const useSDK = <T>(assetType: AssetType, method: Method, data: any) =>\n  useQuery<T>(['sdk', assetType, data], () =>\n    // @ts-ignore\n    sdk[assetType][method](data)\n  );\n\nexport const useRefreshApp = () => {\n  const client = useQueryClient();\n  return () => {\n    client.invalidateQueries();\n  };\n};\n\nexport const useUserInformation = () => {\n  return useQuery(['user-info'], getUserInformation);\n};\n\ntype ActivationResponse = {\n  status: 'activated' | 'inactive' | 'requested';\n};\ntype ActivationError = {\n  message: string;\n};\n\nexport const useCheckActivateFunction = (\n  config?: QueryOptions<ActivationResponse, ActivationError>\n) => {\n  const project = getProject();\n  return useQuery<ActivationResponse, ActivationError>(\n    ['activation', project],\n    () =>\n      sdk\n        .get(`api/v1/projects/${project}/functions/status`)\n        .then((res) => res.data),\n    config\n  );\n};\n\nexport const useActivateFunction = (\n  config?: QueryOptions<ActivationResponse, ActivationError>\n) => {\n  const client = useQueryClient();\n  const project = getProject();\n  return useMutation<ActivationResponse, ActivationError>(\n    () =>\n      sdk\n        .post(`/api/v1/projects/${project}/functions/status`)\n        .then((res) => res.data),\n    {\n      ...config,\n      onSuccess: (data) => {\n        client.setQueryData(['activation', project], data);\n      },\n    }\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}