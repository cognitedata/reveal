{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useMutation } from '@tanstack/react-query';\nimport { useSDK } from '@cognite/sdk-provider';\nimport { getFileIdFromExtendedAnnotation, getResourceIdFromExtendedAnnotation, isAssetAnnotation, isExtendedAnnotationAnnotation, isExtendedLocalAnnotation } from '../../utils';\nexport const useDeleteAnnotation = options => {\n  _s();\n  const sdk = useSDK();\n  const {\n    mutate\n  } = useMutation(async annotation => {\n    const deleteAnnotationPromise = (() => {\n      if (isExtendedAnnotationAnnotation(annotation)) {\n        return sdk.annotations.delete([{\n          id: annotation.metadata.id\n        }]);\n      }\n      return undefined;\n    })();\n    const removeAssetIdFromFilePromise = (() => {\n      if (isExtendedLocalAnnotation(annotation)) {\n        return;\n      }\n      if (!isAssetAnnotation(annotation)) {\n        return;\n      }\n      const fileId = getFileIdFromExtendedAnnotation(annotation);\n      const resourceId = getResourceIdFromExtendedAnnotation(annotation);\n      if (!fileId || !resourceId) {\n        return;\n      }\n      return sdk.files.update([{\n        id: fileId,\n        update: {\n          assetIds: {\n            remove: [resourceId]\n          }\n        }\n      }]);\n    })();\n    return Promise.all([deleteAnnotationPromise, removeAssetIdFromFilePromise]);\n  }, options);\n  return mutate;\n};\n_s(useDeleteAnnotation, \"5CKvRoSLrTsxDJgpsa4x7mNWqQQ=\", false, function () {\n  return [useSDK, useMutation];\n});","map":{"version":3,"names":["useMutation","useSDK","getFileIdFromExtendedAnnotation","getResourceIdFromExtendedAnnotation","isAssetAnnotation","isExtendedAnnotationAnnotation","isExtendedLocalAnnotation","useDeleteAnnotation","options","sdk","mutate","annotation","deleteAnnotationPromise","annotations","delete","id","metadata","undefined","removeAssetIdFromFilePromise","fileId","resourceId","files","update","assetIds","remove","Promise","all"],"sources":["/Volumes/csvol/fusion/libs/data-exploration/domain-layer/src/annotations/service/actions/useDeleteAnnotation.ts"],"sourcesContent":["import { useMutation } from '@tanstack/react-query';\n\nimport { useSDK } from '@cognite/sdk-provider';\n\nimport { ExtendedAnnotation } from '@data-exploration-lib/core';\n\nimport {\n  getFileIdFromExtendedAnnotation,\n  getResourceIdFromExtendedAnnotation,\n  isAssetAnnotation,\n  isExtendedAnnotationAnnotation,\n  isExtendedLocalAnnotation,\n} from '../../utils';\n\nexport const useDeleteAnnotation = (options: any) => {\n  const sdk = useSDK();\n  const { mutate } = useMutation(async (annotation: ExtendedAnnotation) => {\n    const deleteAnnotationPromise = (() => {\n      if (isExtendedAnnotationAnnotation(annotation)) {\n        return sdk.annotations.delete([{ id: annotation.metadata.id }]);\n      }\n\n      return undefined;\n    })();\n\n    const removeAssetIdFromFilePromise = (() => {\n      if (isExtendedLocalAnnotation(annotation)) {\n        return;\n      }\n\n      if (!isAssetAnnotation(annotation)) {\n        return;\n      }\n\n      const fileId = getFileIdFromExtendedAnnotation(annotation);\n      const resourceId = getResourceIdFromExtendedAnnotation(annotation);\n      if (!fileId || !resourceId) {\n        return;\n      }\n\n      return sdk.files.update([\n        {\n          id: fileId,\n          update: {\n            assetIds: {\n              remove: [resourceId],\n            },\n          },\n        },\n      ]);\n    })();\n\n    return Promise.all([deleteAnnotationPromise, removeAssetIdFromFilePromise]);\n  }, options);\n\n  return mutate;\n};\n"],"mappings":";AAAA,SAASA,WAAW,QAAQ,uBAAuB;AAEnD,SAASC,MAAM,QAAQ,uBAAuB;AAI9C,SACEC,+BAA+B,EAC/BC,mCAAmC,EACnCC,iBAAiB,EACjBC,8BAA8B,EAC9BC,yBAAyB,QACpB,aAAa;AAEpB,OAAO,MAAMC,mBAAmB,GAAIC,OAAY,IAAK;EAAA;EACnD,MAAMC,GAAG,GAAGR,MAAM,EAAE;EACpB,MAAM;IAAES;EAAO,CAAC,GAAGV,WAAW,CAAC,MAAOW,UAA8B,IAAK;IACvE,MAAMC,uBAAuB,GAAG,CAAC,MAAM;MACrC,IAAIP,8BAA8B,CAACM,UAAU,CAAC,EAAE;QAC9C,OAAOF,GAAG,CAACI,WAAW,CAACC,MAAM,CAAC,CAAC;UAAEC,EAAE,EAAEJ,UAAU,CAACK,QAAQ,CAACD;QAAG,CAAC,CAAC,CAAC;MACjE;MAEA,OAAOE,SAAS;IAClB,CAAC,GAAG;IAEJ,MAAMC,4BAA4B,GAAG,CAAC,MAAM;MAC1C,IAAIZ,yBAAyB,CAACK,UAAU,CAAC,EAAE;QACzC;MACF;MAEA,IAAI,CAACP,iBAAiB,CAACO,UAAU,CAAC,EAAE;QAClC;MACF;MAEA,MAAMQ,MAAM,GAAGjB,+BAA+B,CAACS,UAAU,CAAC;MAC1D,MAAMS,UAAU,GAAGjB,mCAAmC,CAACQ,UAAU,CAAC;MAClE,IAAI,CAACQ,MAAM,IAAI,CAACC,UAAU,EAAE;QAC1B;MACF;MAEA,OAAOX,GAAG,CAACY,KAAK,CAACC,MAAM,CAAC,CACtB;QACEP,EAAE,EAAEI,MAAM;QACVG,MAAM,EAAE;UACNC,QAAQ,EAAE;YACRC,MAAM,EAAE,CAACJ,UAAU;UACrB;QACF;MACF,CAAC,CACF,CAAC;IACJ,CAAC,GAAG;IAEJ,OAAOK,OAAO,CAACC,GAAG,CAAC,CAACd,uBAAuB,EAAEM,4BAA4B,CAAC,CAAC;EAC7E,CAAC,EAAEV,OAAO,CAAC;EAEX,OAAOE,MAAM;AACf,CAAC;AAAC,GA1CWH,mBAAmB;EAAA,QAClBN,MAAM,EACCD,WAAW;AAAA"},"metadata":{},"sourceType":"module"}