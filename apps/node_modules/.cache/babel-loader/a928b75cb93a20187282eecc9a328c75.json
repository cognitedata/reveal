{"ast":null,"code":"import _styled from \"styled-components\";\nvar _jsxFileName = \"/Volumes/csvol/fusion/libs/copilot-core/src/app/components/ChatUI.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport Highlight from 'react-highlight';\nimport { BotUI, BotUIMessageList, BotUIAction, useBotUI, useBotUIAction } from '@botui/react';\nimport { createBot } from 'botui';\nimport { Body, Button, Flex, Icon, Modal, Textarea } from '@cognite/cogs.js';\nimport { getActions } from '../../lib/getActions';\nimport { processMessage } from '../../lib/processMessage';\nimport zIndex from '../utils/zIndex';\nimport { Editor } from './Editor/Editor';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst TextAction = () => {\n  _s();\n  const textActionProps = useBotUIAction();\n  const {\n    meta: {\n      feature\n    }\n  } = textActionProps;\n  const bot = useBotUI(); // current instance\n\n  const [value, setValue] = useState('');\n  const [actions, setActions] = useState();\n  const ref = useRef(null);\n  useEffect(() => {\n    if (ref.current) {\n      ref.current.focus();\n    }\n  }, []);\n  useEffect(() => {\n    bot.message.getAll().then(async messages => {\n      const newActions = await getActions(feature, messages.map(el => ({\n        ...el.data,\n        source: el.meta.previous ? 'user' : 'bot'\n      })), async message => {\n        await bot.next(message);\n      });\n      setActions(newActions);\n    });\n  }, [bot, feature]);\n  return /*#__PURE__*/_jsxDEV(Flex, {\n    gap: 4,\n    direction: \"column\",\n    children: [/*#__PURE__*/_jsxDEV(Textarea, {\n      ref: ref,\n      value: value,\n      onChange: e => setValue(e.target.value),\n      placeholder: \"Ask CogPilot anything...\",\n      style: {\n        height: 100,\n        width: '100%',\n        margin: 0\n      },\n      onKeyDown: e => {\n        if (!e.shiftKey && e.keyCode === 13) {\n          bot.next({\n            content: value,\n            type: 'text'\n          });\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Flex, {\n      gap: 4,\n      children: actions?.map(action => /*#__PURE__*/_jsxDEV(Button, {\n        onClick: action.onClick,\n        size: \"small\",\n        children: action.content\n      }, action.content, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n_s(TextAction, \"Ya83eAuvXweFsrBIdSDKdEQQjOY=\", false, function () {\n  return [useBotUIAction, useBotUI];\n});\n_c = TextAction;\nconst WaitComponent = () => /*#__PURE__*/_jsxDEV(Flex, {\n  style: {\n    position: 'relative',\n    width: '100%'\n  },\n  children: [/*#__PURE__*/_jsxDEV(Textarea, {\n    placeholder: \"Ask CogPilot anything...\",\n    style: {\n      height: 100,\n      width: '100%',\n      margin: 0\n    },\n    disabled: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(Flex, {\n    children: /*#__PURE__*/_jsxDEV(Button, {\n      style: {\n        opacity: 0\n      },\n      disabled: true,\n      size: \"small\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 99,\n  columnNumber: 3\n}, this);\n_c2 = WaitComponent;\nconst actionRenderers = {\n  text: TextAction,\n  wait: WaitComponent\n};\nconst TextMessage = ({\n  message: {\n    data: {\n      content,\n      actions\n    }\n  }\n}) => {\n  return /*#__PURE__*/_jsxDEV(Flex, {\n    direction: \"column\",\n    gap: 4,\n    children: [/*#__PURE__*/_jsxDEV(Body, {\n      level: 2,\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), actions && /*#__PURE__*/_jsxDEV(Flex, {\n      gap: 4,\n      children: actions.map(el => /*#__PURE__*/_jsxDEV(Button, {\n        onClick: el.onClick,\n        children: el.content\n      }, el.content, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this);\n};\n_c3 = TextMessage;\nconst CodeMessage = ({\n  message: {\n    data: {\n      content,\n      language,\n      actions,\n      prevContent\n    }\n  }\n}) => {\n  _s2();\n  const [open, setOpen] = useState(false);\n  const [showDiff, setShowDiff] = useState(false);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Flex, {\n      direction: \"column\",\n      gap: 4,\n      children: [/*#__PURE__*/_jsxDEV(Body, {\n        level: 2,\n        children: \"Click to view the follow code in full screen\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Flex, {\n        style: {\n          overflow: 'hidden',\n          cursor: 'pointer',\n          position: 'relative',\n          maxHeight: 200\n        },\n        onClick: () => setOpen(true),\n        children: [/*#__PURE__*/_jsxDEV(Flex, {\n          style: {\n            position: 'absolute',\n            width: '100%',\n            height: '100%'\n          },\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Icon, {\n            type: \"Expand\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Highlight, {\n          className: language,\n          children: content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this), actions && /*#__PURE__*/_jsxDEV(Flex, {\n        gap: 4,\n        children: actions.map(el => /*#__PURE__*/_jsxDEV(Button, {\n          onClick: el.onClick,\n          children: el.content\n        }, el.content, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      visible: open,\n      title: \"Code preview\",\n      size: \"x-large\",\n      onCancel: () => setOpen(false),\n      hideFooter: true,\n      hidePaddings: true,\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        direction: \"column\",\n        gap: 16,\n        style: {\n          padding: 16\n        },\n        children: [/*#__PURE__*/_jsxDEV(Flex, {\n          style: {\n            flex: 1\n          },\n          children: /*#__PURE__*/_jsxDEV(Editor, {\n            language: language,\n            code: content,\n            prevCode: showDiff ? prevContent : undefined\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Flex, {\n          gap: 4,\n          children: [prevContent && /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => setShowDiff(!showDiff),\n            children: showDiff ? 'Hide Diff' : 'Show Diff'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 15\n          }, this), actions?.map(el => /*#__PURE__*/_jsxDEV(Button, {\n            onClick: el.onClick,\n            children: el.content\n          }, el.content, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s2(CodeMessage, \"Ff3YjFGh+kjVsJFReEXgLkGYTrM=\");\n_c4 = CodeMessage;\nconst messageRenderer = {\n  text: TextMessage,\n  code: CodeMessage\n};\nexport const ChatUI = ({\n  onClose,\n  feature\n}) => {\n  _s3();\n  const messages = useRef([]);\n  const [bot, setBot] = useState();\n  const addMessageForBot = useCallback(async (chatBot, result) => {\n    messages.current.push({\n      ...result,\n      source: 'bot'\n    });\n    await chatBot.message.add(result, {\n      messageType: result.type\n    });\n    // because linters think this is some special async func, but is actually just a wait function\n    // eslint-disable-next-line testing-library/await-async-utils\n    chatBot.wait();\n  }, []);\n  useEffect(() => {\n    setTimeout(() => {\n      const newBot = createBot();\n      newBot.wait({\n        waitTime: 100\n      }).then(() => {\n        setBot(newBot);\n      });\n    }, 100);\n  }, []);\n  useEffect(() => {\n    if (bot) {\n      const promptUser = () => {\n        bot.action.set({\n          feature\n        }, {\n          actionType: 'text',\n          feature\n        }).then(({\n          content\n        }) => {\n          messages.current.push({\n            content: content,\n            type: 'text',\n            source: 'user'\n          });\n          processMessage(feature, content, messages.current, message => addMessageForBot(bot, message)).then(shouldPrompt => {\n            if (shouldPrompt) {\n              promptUser();\n            }\n          });\n          // because linters think this is some special async func, but is actually just a wait function\n          // eslint-disable-next-line testing-library/await-async-utils\n          bot.wait();\n        });\n      };\n      processMessage(feature, '', messages.current, message => addMessageForBot(bot, message)).then(shouldPrompt => {\n        if (shouldPrompt) {\n          promptUser();\n        }\n      });\n    }\n  }, [bot, feature, addMessageForBot]);\n  return /*#__PURE__*/_jsxDEV(Wrapper, {\n    children: [/*#__PURE__*/_jsxDEV(Flex, {\n      className: \"header\",\n      gap: 6,\n      alignItems: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        icon: \"Close\",\n        type: \"ghost\",\n        onClick: onClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), bot ? /*#__PURE__*/_jsxDEV(BotUI, {\n      bot: bot,\n      children: [/*#__PURE__*/_jsxDEV(Flex, {\n        direction: \"column\",\n        style: {\n          overflow: 'auto',\n          marginBottom: 8,\n          flex: 1\n        },\n        children: /*#__PURE__*/_jsxDEV(BotUIMessageList, {\n          renderer: messageRenderer\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(BotUIAction, {\n        renderer: actionRenderers\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Icon, {\n      type: \"Loader\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 285,\n    columnNumber: 5\n  }, this);\n};\n_s3(ChatUI, \"HWgSPlYOxIaYiG8JYZn+Iwviaw4=\");\n_c5 = ChatUI;\nconst Wrapper = /*#__PURE__*/_styled.div.withConfig({\n  displayName: \"ChatUI__Wrapper\",\n  componentId: \"sc-lm5la4-0\"\n})([\"z-index:\", \";position:fixed;bottom:70px;right:10px;background:#fff;margin-top:16px;padding:16px;width:320px;height:400px;border-radius:10px;box-shadow:0px 1px 16px 4px rgba(79,82,104,0.1),0px 1px 8px rgba(79,82,104,0.08),0px 1px 2px rgba(79,82,104,0.24);display:flex;flex-direction:column;.header .cogs-icon--type-cognite{width:32px;color:black;}.botui_message{margin:0;margin-bottom:8px;}.botui_message_content{overflow:auto;}.botui_app_container{width:100%;overflow:hidden;flex:1;position:relative;display:flex;}.botui_container{height:auto;position:relative;overflow:hidden;display:flex;flex-direction:column;}.botui_message_list{padding:0;width:100%;> div{}}.botui_action_container{padding:0;.botui_action{padding:0;}}.cogs-textarea{flex:1;height:100px;}.botui_message_content{background:#dadffc;}.botui_message_content.human{background:#f5f5f5;}.cogs-textarea{width:100%;textarea{color:black !important;}}pre{overflow:hidden;margin-bottom:0;}\"], zIndex.MAXIMUM);\n_c6 = Wrapper;\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"TextAction\");\n$RefreshReg$(_c2, \"WaitComponent\");\n$RefreshReg$(_c3, \"TextMessage\");\n$RefreshReg$(_c4, \"CodeMessage\");\n$RefreshReg$(_c5, \"ChatUI\");\n$RefreshReg$(_c6, \"Wrapper\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","Highlight","BotUI","BotUIMessageList","BotUIAction","useBotUI","useBotUIAction","createBot","Body","Button","Flex","Icon","Modal","Textarea","getActions","processMessage","zIndex","Editor","TextAction","textActionProps","meta","feature","bot","value","setValue","actions","setActions","ref","current","focus","message","getAll","then","messages","newActions","map","el","data","source","previous","next","e","target","height","width","margin","shiftKey","keyCode","content","type","action","onClick","WaitComponent","position","opacity","actionRenderers","text","wait","TextMessage","CodeMessage","language","prevContent","open","setOpen","showDiff","setShowDiff","overflow","cursor","maxHeight","padding","flex","undefined","messageRenderer","code","ChatUI","onClose","setBot","addMessageForBot","chatBot","result","push","add","messageType","setTimeout","newBot","waitTime","promptUser","set","actionType","shouldPrompt","marginBottom","Wrapper","styled","div","MAXIMUM"],"sources":["/Volumes/csvol/fusion/libs/copilot-core/src/app/components/ChatUI.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport Highlight from 'react-highlight';\n\nimport {\n  BotUI,\n  BotUIMessageList,\n  BotUIAction,\n  useBotUI,\n  useBotUIAction,\n} from '@botui/react';\nimport { BotuiInterface, createBot } from 'botui';\nimport styled from 'styled-components/macro';\n\nimport { Body, Button, Flex, Icon, Modal, Textarea } from '@cognite/cogs.js';\n\nimport { getActions } from '../../lib/getActions';\nimport { processMessage } from '../../lib/processMessage';\nimport {\n  CopilotAction,\n  CopilotBotMessage,\n  CopilotCodeMessage,\n  CopilotMessage,\n  CopilotTextMessage,\n  CopilotSupportedFeatureType,\n} from '../../lib/types';\nimport zIndex from '../utils/zIndex';\n\nimport { Editor } from './Editor/Editor';\n\nconst TextAction = () => {\n  const textActionProps = useBotUIAction();\n\n  const {\n    meta: { feature },\n  } = textActionProps!;\n\n  const bot = useBotUI(); // current instance\n\n  const [value, setValue] = useState('');\n  const [actions, setActions] = useState<CopilotAction[]>();\n\n  const ref = useRef<HTMLTextAreaElement>(null);\n\n  useEffect(() => {\n    if (ref.current) {\n      ref.current.focus();\n    }\n  }, []);\n\n  useEffect(() => {\n    bot.message.getAll().then(async (messages) => {\n      const newActions = await getActions(\n        feature as CopilotSupportedFeatureType,\n        messages.map(\n          (el) =>\n            ({\n              ...(el.data as CopilotMessage),\n              source: el.meta.previous ? 'user' : 'bot',\n            } as CopilotMessage)\n        ),\n        async (message) => {\n          await bot.next(message);\n        }\n      );\n      setActions(newActions);\n    });\n  }, [bot, feature]);\n\n  return (\n    <Flex gap={4} direction=\"column\">\n      <Textarea\n        ref={ref}\n        value={value}\n        onChange={(e) => setValue(e.target.value)}\n        placeholder=\"Ask CogPilot anything...\"\n        style={{\n          height: 100,\n          width: '100%',\n          margin: 0,\n        }}\n        onKeyDown={(e) => {\n          if (!e.shiftKey && e.keyCode === 13) {\n            bot.next({ content: value, type: 'text' });\n          }\n        }}\n      />\n      <Flex gap={4}>\n        {actions?.map((action) => (\n          <Button onClick={action.onClick} size=\"small\" key={action.content}>\n            {action.content}\n          </Button>\n        ))}\n      </Flex>\n    </Flex>\n  );\n};\n\nconst WaitComponent = () => (\n  <Flex style={{ position: 'relative', width: '100%' }}>\n    <Textarea\n      placeholder=\"Ask CogPilot anything...\"\n      style={{\n        height: 100,\n        width: '100%',\n        margin: 0,\n      }}\n      disabled\n    />\n    <Flex>\n      <Button style={{ opacity: 0 }} disabled size=\"small\" />\n    </Flex>\n  </Flex>\n);\nconst actionRenderers = {\n  text: TextAction,\n  wait: WaitComponent,\n};\n\nconst TextMessage = ({\n  message: {\n    data: { content, actions },\n  },\n}: {\n  message: { data: CopilotTextMessage };\n}) => {\n  return (\n    <Flex direction=\"column\" gap={4}>\n      <Body level={2}>{content}</Body>\n      {actions && (\n        <Flex gap={4}>\n          {actions.map((el) => (\n            <Button onClick={el.onClick} key={el.content}>\n              {el.content}\n            </Button>\n          ))}\n        </Flex>\n      )}\n    </Flex>\n  );\n};\nconst CodeMessage = ({\n  message: {\n    data: { content, language, actions, prevContent },\n  },\n}: {\n  message: { data: CopilotCodeMessage };\n}) => {\n  const [open, setOpen] = useState(false);\n  const [showDiff, setShowDiff] = useState(false);\n  return (\n    <>\n      <Flex direction=\"column\" gap={4}>\n        <Body level={2}>Click to view the follow code in full screen</Body>\n        <Flex\n          style={{\n            overflow: 'hidden',\n            cursor: 'pointer',\n            position: 'relative',\n            maxHeight: 200,\n          }}\n          onClick={() => setOpen(true)}\n        >\n          <Flex\n            style={{ position: 'absolute', width: '100%', height: '100%' }}\n            justifyContent=\"center\"\n            alignItems=\"center\"\n          >\n            <Icon type=\"Expand\" />\n          </Flex>\n          <Highlight className={language}>{content}</Highlight>\n        </Flex>\n        {actions && (\n          <Flex gap={4}>\n            {actions.map((el) => (\n              <Button onClick={el.onClick} key={el.content}>\n                {el.content}\n              </Button>\n            ))}\n          </Flex>\n        )}\n      </Flex>\n      <Modal\n        visible={open}\n        title=\"Code preview\"\n        size=\"x-large\"\n        onCancel={() => setOpen(false)}\n        hideFooter\n        hidePaddings\n      >\n        <Flex direction=\"column\" gap={16} style={{ padding: 16 }}>\n          <Flex style={{ flex: 1 }}>\n            <Editor\n              language={language}\n              code={content}\n              prevCode={showDiff ? prevContent : undefined}\n            />\n          </Flex>\n          <Flex gap={4}>\n            {prevContent && (\n              <Button onClick={() => setShowDiff(!showDiff)}>\n                {showDiff ? 'Hide Diff' : 'Show Diff'}\n              </Button>\n            )}\n            {actions?.map((el) => (\n              <Button onClick={el.onClick} key={el.content}>\n                {el.content}\n              </Button>\n            ))}\n          </Flex>\n        </Flex>\n      </Modal>\n    </>\n  );\n};\n\nconst messageRenderer = {\n  text: TextMessage,\n  code: CodeMessage,\n};\n\nexport const ChatUI = ({\n  onClose,\n  feature,\n}: {\n  onClose: () => void;\n  feature: CopilotSupportedFeatureType;\n}) => {\n  const messages = useRef<CopilotMessage[]>([]);\n  const [bot, setBot] = useState<BotuiInterface | undefined>();\n\n  const addMessageForBot = useCallback(\n    async (chatBot: BotuiInterface, result: CopilotBotMessage) => {\n      messages.current.push({ ...result, source: 'bot' });\n      await chatBot.message.add(result, { messageType: result.type });\n      // because linters think this is some special async func, but is actually just a wait function\n      // eslint-disable-next-line testing-library/await-async-utils\n      chatBot.wait();\n    },\n    []\n  );\n\n  useEffect(() => {\n    setTimeout(() => {\n      const newBot = createBot();\n      newBot.wait({ waitTime: 100 }).then(() => {\n        setBot(newBot);\n      });\n    }, 100);\n  }, []);\n\n  useEffect(() => {\n    if (bot) {\n      const promptUser = () => {\n        bot.action\n          .set({ feature }, { actionType: 'text', feature })\n          .then(({ content }: { content: string }) => {\n            messages.current.push({\n              content: content,\n              type: 'text',\n              source: 'user',\n            });\n            processMessage(feature, content, messages.current, (message) =>\n              addMessageForBot(bot, message)\n            ).then((shouldPrompt) => {\n              if (shouldPrompt) {\n                promptUser();\n              }\n            });\n            // because linters think this is some special async func, but is actually just a wait function\n            // eslint-disable-next-line testing-library/await-async-utils\n            bot.wait();\n          });\n      };\n      processMessage(feature, '', messages.current, (message) =>\n        addMessageForBot(bot, message)\n      ).then((shouldPrompt) => {\n        if (shouldPrompt) {\n          promptUser();\n        }\n      });\n    }\n  }, [bot, feature, addMessageForBot]);\n\n  return (\n    <Wrapper>\n      <Flex className=\"header\" gap={6} alignItems=\"center\">\n        <div style={{ flex: 1 }} />\n        <Button icon=\"Close\" type=\"ghost\" onClick={onClose} />\n      </Flex>\n\n      {bot ? (\n        <BotUI bot={bot}>\n          <Flex\n            direction=\"column\"\n            style={{ overflow: 'auto', marginBottom: 8, flex: 1 }}\n          >\n            <BotUIMessageList renderer={messageRenderer} />\n          </Flex>\n          <BotUIAction renderer={actionRenderers} />\n        </BotUI>\n      ) : (\n        <Icon type=\"Loader\" />\n      )}\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  z-index: ${zIndex.MAXIMUM};\n  position: fixed;\n  bottom: 70px;\n  right: 10px;\n  background: #fff;\n  margin-top: 16px;\n  padding: 16px;\n  width: 320px;\n  height: 400px;\n  border-radius: 10px;\n  box-shadow: 0px 1px 16px 4px rgba(79, 82, 104, 0.1),\n    0px 1px 8px rgba(79, 82, 104, 0.08), 0px 1px 2px rgba(79, 82, 104, 0.24);\n  display: flex;\n  flex-direction: column;\n\n  .header .cogs-icon--type-cognite {\n    width: 32px;\n    color: black;\n  }\n  .botui_message {\n    margin: 0;\n    margin-bottom: 8px;\n  }\n  .botui_message_content {\n    overflow: auto;\n  }\n  .botui_app_container {\n    width: 100%;\n    overflow: hidden;\n    flex: 1;\n    position: relative;\n    display: flex;\n  }\n  .botui_container {\n    height: auto;\n    position: relative;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n  }\n  .botui_message_list {\n    padding: 0;\n    width: 100%;\n    > div {\n      /* height: 100%;\n      overflow: auto; */\n    }\n  }\n  .botui_action_container {\n    padding: 0;\n    .botui_action {\n      padding: 0;\n    }\n  }\n  .cogs-textarea {\n    flex: 1;\n    height: 100px;\n  }\n  .botui_message_content {\n    background: #dadffc;\n  }\n  .botui_message_content.human {\n    background: #f5f5f5;\n  }\n  .cogs-textarea {\n    width: 100%;\n    textarea {\n      color: black !important;\n    }\n  }\n  pre {\n    overflow: hidden;\n    margin-bottom: 0;\n  }\n`;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}