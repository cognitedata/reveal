System.register([],(function(e,t){return{execute:function(){e((()=>{var e={8149:(e,t,r)=>{"use strict";function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}r.r(t),r.d(t,{Auth0Client:()=>te,AuthenticationError:()=>u,CacheKey:()=>C,GenericError:()=>d,InMemoryCache:()=>x,LocalStorageCache:()=>z,MfaRequiredError:()=>m,MissingRefreshTokenError:()=>f,PopupCancelledError:()=>p,PopupTimeoutError:()=>h,TimeoutError:()=>l,User:()=>ie,createAuth0Client:()=>X});var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e,t){return e(t={exports:{}},t.exports),t.exports}var a=s((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,r){var n=e.locked.get(t);void 0===n?void 0===r?e.locked.set(t,[]):e.locked.set(t,[r]):void 0!==r&&(n.unshift(r),e.locked.set(t,n))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(r,n){e.isLocked(t)?e.addToLocked(t,r):(e.addToLocked(t),r())}))},this.unlock=function(t){var r=e.locked.get(t);if(void 0!==r&&0!==r.length){var n=r.pop();e.locked.set(t,r),void 0!==n&&setTimeout(n,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return r.getInstance()}}));i(a);var c=i(s((function(e,t){var r=o&&o.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=o&&o.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i="browser-tabs-lock-key";function s(e){return new Promise((function(t){return setTimeout(t,e)}))}function c(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",n=0;n<e;n++)r+=t[Math.floor(61*Math.random())];return r}var g=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+c(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,o){return void 0===o&&(o=5e3),r(this,void 0,void 0,(function(){var r,a,g,y,v,w;return n(this,(function(n){switch(n.label){case 0:r=Date.now()+c(4),a=Date.now()+o,g=i+"-"+t,y=window.localStorage,n.label=1;case 1:return Date.now()<a?[4,s(30)]:[3,8];case 2:return n.sent(),null!==y.getItem(g)?[3,5]:(v=this.id+"-"+t+"-"+r,[4,s(Math.floor(25*Math.random()))]);case 3:return n.sent(),y.setItem(g,JSON.stringify({id:this.id,iat:r,timeoutKey:v,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,s(30)];case 4:return n.sent(),null!==(w=y.getItem(g))&&(w=JSON.parse(w)).id===this.id&&w.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(g,r),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(a)];case 6:n.sent(),n.label=7;case 7:return r=Date.now()+c(4),[3,1];case 8:return[2,!1]}}))}))},e.prototype.refreshLockWhileAcquired=function(e,t){return r(this,void 0,void 0,(function(){var o=this;return n(this,(function(i){return setTimeout((function(){return r(o,void 0,void 0,(function(){var r,o;return n(this,(function(n){switch(n.label){case 0:return[4,a.default().lock(t)];case 1:return n.sent(),this.acquiredIatSet.has(t)?(r=window.localStorage,null===(o=r.getItem(e))?(a.default().unlock(t),[2]):((o=JSON.parse(o)).timeRefreshed=Date.now(),r.setItem(e,JSON.stringify(o)),a.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(a.default().unlock(t),[2])}}))}))}),1e3),[2]}))}))},e.prototype.waitForSomethingToChange=function(t){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){var n=!1,o=Date.now(),i=!1;function s(){if(i||(window.removeEventListener("storage",s),e.removeFromWaiting(s),clearTimeout(a),i=!0),!n){n=!0;var t=50-(Date.now()-o);t>0?setTimeout(r,t):r()}}window.addEventListener("storage",s),e.addToWaiting(s);var a=setTimeout(s,Math.max(0,t-Date.now()))}))];case 1:return r.sent(),[2]}}))}))},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter((function(e){return e!==t})))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach((function(e){return e()}))},e.prototype.releaseLock=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.releaseLock__private__=function(t){return r(this,void 0,void 0,(function(){var r,o,s;return n(this,(function(n){switch(n.label){case 0:return r=window.localStorage,o=i+"-"+t,null===(s=r.getItem(o))?[2]:(s=JSON.parse(s)).id!==this.id?[3,2]:[4,a.default().lock(s.iat)];case 1:n.sent(),this.acquiredIatSet.delete(s.iat),r.removeItem(o),a.default().unlock(s.iat),e.notifyWaiters(),n.label=2;case 2:return[2]}}))}))},e.lockCorrector=function(){for(var t=Date.now()-5e3,r=window.localStorage,n=Object.keys(r),o=!1,s=0;s<n.length;s++){var a=n[s];if(a.includes(i)){var c=r.getItem(a);null!==c&&(void 0===(c=JSON.parse(c)).timeRefreshed&&c.timeAcquired<t||void 0!==c.timeRefreshed&&c.timeRefreshed<t)&&(r.removeItem(a),o=!0)}}o&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=g})));const g={timeoutInSeconds:60},y={name:"auth0-spa-js",version:"2.0.4"},v=()=>Date.now();class d extends Error{constructor(e,t){super(t),this.error=e,this.error_description=t,Object.setPrototypeOf(this,d.prototype)}static fromPayload({error:e,error_description:t}){return new d(e,t)}}class u extends d{constructor(e,t,r,n=null){super(e,t),this.state=r,this.appState=n,Object.setPrototypeOf(this,u.prototype)}}class l extends d{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,l.prototype)}}class h extends l{constructor(e){super(),this.popup=e,Object.setPrototypeOf(this,h.prototype)}}class p extends d{constructor(e){super("cancelled","Popup closed"),this.popup=e,Object.setPrototypeOf(this,p.prototype)}}class m extends d{constructor(e,t,r){super(e,t),this.mfa_token=r,Object.setPrototypeOf(this,m.prototype)}}class f extends d{constructor(e,t){super("missing_refresh_token",`Missing Refresh Token (audience: '${w(e,["default"])}', scope: '${w(t)}')`),this.audience=e,this.scope=t,Object.setPrototypeOf(this,f.prototype)}}function w(e,t=[]){return e&&!t.includes(e)?e:""}const _=()=>window.crypto,b=()=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let t="";return Array.from(_().getRandomValues(new Uint8Array(43))).forEach((r=>t+=e[r%66])),t},E=e=>btoa(e),S=e=>{var{clientId:t}=e,r=n(e,["clientId"]);return new URLSearchParams((e=>Object.keys(e).filter((t=>void 0!==e[t])).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{}))(Object.assign({client_id:t},r))).toString()},T=e=>(e=>decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))(e.replace(/_/g,"/").replace(/-/g,"+")),I=async(e,t)=>{const r=await fetch(e,t);return{ok:r.ok,json:await r.json()}},k=async(e,t,r,n,o,i,s=1e4)=>o?(async(e,t,r,n,o,i,s)=>{return a={auth:{audience:t,scope:r},timeout:o,fetchUrl:e,fetchOptions:n,useFormData:s},c=i,new Promise((function(e,t){const r=new MessageChannel;r.port1.onmessage=function(n){n.data.error?t(new Error(n.data.error)):e(n.data),r.port1.close()},c.postMessage(a,[r.port2])}));var a,c})(e,t,r,n,s,o,i):(async(e,t,r)=>{const n=new AbortController;let o;return t.signal=n.signal,Promise.race([I(e,t),new Promise(((e,t)=>{o=setTimeout((()=>{n.abort(),t(new Error("Timeout when executing 'fetch'"))}),r)}))]).finally((()=>{clearTimeout(o)}))})(e,n,s);async function A(e,t){var{baseUrl:r,timeout:o,audience:i,scope:s,auth0Client:a,useFormData:c}=e,g=n(e,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const v=c?S(g):JSON.stringify(g);return await async function(e,t,r,o,i,s,a){let c,g=null;for(let E=0;E<3;E++)try{c=await k(e,r,o,i,s,a,t),g=null;break}catch(n){g=n}if(g)throw g;const y=c.json,{error:v,error_description:w}=y,_=n(y,["error","error_description"]),{ok:b}=c;if(!b){const t=w||`HTTP error. Unable to fetch ${e}`;if("mfa_required"===v)throw new m(v,t,_.mfa_token);if("missing_refresh_token"===v)throw new f(r,o);throw new d(v||"request_error",t)}return _}(`${r}/oauth/token`,o,i||"default",s,{method:"POST",body:v,headers:{"Content-Type":c?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(a||y))}},t,c)}const R=(...e)=>{return(t=e.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(t))).join(" ");var t};class C{constructor(e,t="@@auth0spajs@@",r){this.prefix=t,this.suffix=r,this.clientId=e.clientId,this.scope=e.scope,this.audience=e.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(e){const[t,r,n,o]=e.split("::");return new C({clientId:r,scope:o,audience:n},t)}static fromCacheEntry(e){const{scope:t,audience:r,client_id:n}=e;return new C({scope:t,audience:r,clientId:n})}}class z{set(e,t){localStorage.setItem(e,JSON.stringify(t))}get(e){const t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return}}remove(e){localStorage.removeItem(e)}allKeys(){return Object.keys(window.localStorage).filter((e=>e.startsWith("@@auth0spajs@@")))}}class x{constructor(){this.enclosedCache=function(){let e={};return{set(t,r){e[t]=r},get(t){const r=e[t];if(r)return r},remove(t){delete e[t]},allKeys:()=>Object.keys(e)}}()}}class P{constructor(e,t,r){this.cache=e,this.keyManifest=t,this.nowProvider=r||v}async setIdToken(e,t,r){var n;const o=this.getIdTokenCacheKey(e);await this.cache.set(o,{id_token:t,decodedToken:r}),await(null===(n=this.keyManifest)||void 0===n?void 0:n.add(o))}async getIdToken(e){const t=await this.cache.get(this.getIdTokenCacheKey(e.clientId));if(!t&&e.scope&&e.audience){const t=await this.get(e);if(!t)return;if(!t.id_token||!t.decodedToken)return;return{id_token:t.id_token,decodedToken:t.decodedToken}}if(t)return{id_token:t.id_token,decodedToken:t.decodedToken}}async get(e,t=0){var r;let n=await this.cache.get(e.toKey());if(!n){const t=await this.getCacheKeys();if(!t)return;const r=this.matchExistingCacheKey(e,t);r&&(n=await this.cache.get(r))}if(!n)return;const o=await this.nowProvider(),i=Math.floor(o/1e3);return n.expiresAt-t<i?n.body.refresh_token?(n.body={refresh_token:n.body.refresh_token},await this.cache.set(e.toKey(),n),n.body):(await this.cache.remove(e.toKey()),void(await(null===(r=this.keyManifest)||void 0===r?void 0:r.remove(e.toKey())))):n.body}async set(e){var t;const r=new C({clientId:e.client_id,scope:e.scope,audience:e.audience}),n=await this.wrapCacheEntry(e);await this.cache.set(r.toKey(),n),await(null===(t=this.keyManifest)||void 0===t?void 0:t.add(r.toKey()))}async clear(e){var t;const r=await this.getCacheKeys();r&&(await r.filter((t=>!e||t.includes(e))).reduce((async(e,t)=>{await e,await this.cache.remove(t)}),Promise.resolve()),await(null===(t=this.keyManifest)||void 0===t?void 0:t.clear()))}async wrapCacheEntry(e){const t=await this.nowProvider();return{body:e,expiresAt:Math.floor(t/1e3)+e.expires_in}}async getCacheKeys(){var e;return this.keyManifest?null===(e=await this.keyManifest.get())||void 0===e?void 0:e.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(e){return new C({clientId:e},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(e,t){return t.filter((t=>{var r;const n=C.fromKey(t),o=new Set(n.scope&&n.scope.split(" ")),i=(null===(r=e.scope)||void 0===r?void 0:r.split(" "))||[],s=n.scope&&i.reduce(((e,t)=>e&&o.has(t)),!0);return"@@auth0spajs@@"===n.prefix&&n.clientId===e.clientId&&n.audience===e.audience&&s}))[0]}}class Z{constructor(e,t){this.storage=e,this.clientId=t,this.storageKey=`a0.spajs.txs.${this.clientId}`,this.transaction=this.storage.get(this.storageKey)}create(e){this.transaction=e,this.storage.save(this.storageKey,e,{daysUntilExpire:1})}get(){return this.transaction}remove(){delete this.transaction,this.storage.remove(this.storageKey)}}const O=e=>"number"==typeof e,N=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"];var U=s((function(e,t){var r=o&&o.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e,t){if(!t)return"";var r="; "+e;return!0===t?r:r+"="+t}function i(e,t,r){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return n("Expires",e.expires?e.expires.toUTCString():"")+n("Domain",e.domain)+n("Path",e.path)+n("Secure",e.secure)+n("SameSite",e.sameSite)}(r)}function s(e){for(var t={},r=e?e.split("; "):[],n=/(%[\dA-F]{2})+/gi,o=0;o<r.length;o++){var i=r[o].split("="),s=i.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{t[i[0].replace(n,decodeURIComponent)]=s.replace(n,decodeURIComponent)}catch(e){}}return t}function a(){return s(document.cookie)}function c(e,t,n){document.cookie=i(e,t,r({path:"/"},n))}t.__esModule=!0,t.encode=i,t.parse=s,t.getAll=a,t.get=function(e){return a()[e]},t.set=c,t.remove=function(e,t){c(e,"",r(r({},t),{expires:-1}))}}));i(U),U.encode,U.parse,U.getAll;var M=U.get,q=U.set,L=U.remove;const j={get(e){const t=M(e);if(void 0!==t)return JSON.parse(t)},save(e,t,r){let n={};"https:"===window.location.protocol&&(n={secure:!0,sameSite:"none"}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),(null==r?void 0:r.cookieDomain)&&(n.domain=r.cookieDomain),q(e,JSON.stringify(t),n)},remove(e,t){let r={};(null==t?void 0:t.cookieDomain)&&(r.domain=t.cookieDomain),L(e,r)}},H={get:e=>j.get(e)||j.get(`_legacy_${e}`),save(e,t,r){let n={};"https:"===window.location.protocol&&(n={secure:!0}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),(null==r?void 0:r.cookieDomain)&&(n.domain=r.cookieDomain),q(`_legacy_${e}`,JSON.stringify(t),n),j.save(e,t,r)},remove(e,t){let r={};(null==t?void 0:t.cookieDomain)&&(r.domain=t.cookieDomain),L(e,r),j.remove(e,t),j.remove(`_legacy_${e}`,t)}},F={get(e){if("undefined"==typeof sessionStorage)return;const t=sessionStorage.getItem(e);return null!=t?JSON.parse(t):void 0},save(e,t){sessionStorage.setItem(e,JSON.stringify(t))},remove(e){sessionStorage.removeItem(e)}};var K,D=("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9Y29uc3Qgcz1lPT57dmFye2NsaWVudElkOnR9PWUscj1mdW5jdGlvbihlLHQpe3ZhciByPXt9O2Zvcih2YXIgcyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHMpJiZ0LmluZGV4T2Yocyk8MCYmKHJbc109ZVtzXSk7aWYobnVsbCE9ZSYmImZ1bmN0aW9uIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKHM9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPHMubGVuZ3RoO28rKyl0LmluZGV4T2Yoc1tvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsc1tvXSkmJihyW3Nbb11dPWVbc1tvXV0pfXJldHVybiByfShlLFsiY2xpZW50SWQiXSk7cmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMoKGU9Pk9iamVjdC5rZXlzKGUpLmZpbHRlcigodD0+dm9pZCAwIT09ZVt0XSkpLnJlZHVjZSgoKHQscik9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3JdOmVbcl19KSkse30pKShPYmplY3QuYXNzaWduKHtjbGllbnRfaWQ6dH0scikpKS50b1N0cmluZygpfTtsZXQgbz17fTtjb25zdCBuPShlLHQpPT5gJHtlfXwke3R9YDthZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoYXN5bmMoe2RhdGE6e3RpbWVvdXQ6ZSxhdXRoOnIsZmV0Y2hVcmw6aSxmZXRjaE9wdGlvbnM6Yyx1c2VGb3JtRGF0YTphfSxwb3J0czpbZl19KT0+e2xldCBwO2NvbnN0e2F1ZGllbmNlOmwsc2NvcGU6dX09cnx8e307dHJ5e2NvbnN0IHI9YT8oZT0+e2NvbnN0IHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyhlKSxyPXt9O3JldHVybiB0LmZvckVhY2goKChlLHQpPT57clt0XT1lfSkpLHJ9KShjLmJvZHkpOkpTT04ucGFyc2UoYy5ib2R5KTtpZighci5yZWZyZXNoX3Rva2VuJiYicmVmcmVzaF90b2tlbiI9PT1yLmdyYW50X3R5cGUpe2NvbnN0IGU9KChlLHQpPT5vW24oZSx0KV0pKGwsdSk7aWYoIWUpdGhyb3cgbmV3IHQobCx1KTtjLmJvZHk9YT9zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpOkpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpfWxldCBkLGc7ImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGQ9bmV3IEFib3J0Q29udHJvbGxlcixjLnNpZ25hbD1kLnNpZ25hbCk7dHJ5e2c9YXdhaXQgUHJvbWlzZS5yYWNlKFsoaD1lLG5ldyBQcm9taXNlKChlPT5zZXRUaW1lb3V0KGUsaCkpKSksZmV0Y2goaSxPYmplY3QuYXNzaWduKHt9LGMpKV0pfWNhdGNoKGUpe3JldHVybiB2b2lkIGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfWlmKCFnKXJldHVybiBkJiZkLmFib3J0KCksdm9pZCBmLnBvc3RNZXNzYWdlKHtlcnJvcjoiVGltZW91dCB3aGVuIGV4ZWN1dGluZyAnZmV0Y2gnIn0pO3A9YXdhaXQgZy5qc29uKCkscC5yZWZyZXNoX3Rva2VuPygoKGUsdCxyKT0+e29bbih0LHIpXT1lfSkocC5yZWZyZXNoX3Rva2VuLGwsdSksZGVsZXRlIHAucmVmcmVzaF90b2tlbik6KChlLHQpPT57ZGVsZXRlIG9bbihlLHQpXX0pKGwsdSksZi5wb3N0TWVzc2FnZSh7b2s6Zy5vayxqc29uOnB9KX1jYXRjaChlKXtmLnBvc3RNZXNzYWdlKHtvazohMSxqc29uOntlcnJvcjplLmVycm9yLGVycm9yX2Rlc2NyaXB0aW9uOmUubWVzc2FnZX19KX12YXIgaH0pKX0oKTsKCg==",null,!1,function(e){return K=K||function(e,t,r){var n=void 0===t?null:t,o=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),o=0,i=r.length;o<i;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(e,void 0!==r&&r),i=o.indexOf("\n",10)+1,s=o.substring(i)+(n?"//# sourceMappingURL="+n:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9Y29uc3Qgcz1lPT57dmFye2NsaWVudElkOnR9PWUscj1mdW5jdGlvbihlLHQpe3ZhciByPXt9O2Zvcih2YXIgcyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHMpJiZ0LmluZGV4T2Yocyk8MCYmKHJbc109ZVtzXSk7aWYobnVsbCE9ZSYmImZ1bmN0aW9uIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKHM9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPHMubGVuZ3RoO28rKyl0LmluZGV4T2Yoc1tvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsc1tvXSkmJihyW3Nbb11dPWVbc1tvXV0pfXJldHVybiByfShlLFsiY2xpZW50SWQiXSk7cmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMoKGU9Pk9iamVjdC5rZXlzKGUpLmZpbHRlcigodD0+dm9pZCAwIT09ZVt0XSkpLnJlZHVjZSgoKHQscik9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3JdOmVbcl19KSkse30pKShPYmplY3QuYXNzaWduKHtjbGllbnRfaWQ6dH0scikpKS50b1N0cmluZygpfTtsZXQgbz17fTtjb25zdCBuPShlLHQpPT5gJHtlfXwke3R9YDthZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoYXN5bmMoe2RhdGE6e3RpbWVvdXQ6ZSxhdXRoOnIsZmV0Y2hVcmw6aSxmZXRjaE9wdGlvbnM6Yyx1c2VGb3JtRGF0YTphfSxwb3J0czpbZl19KT0+e2xldCBwO2NvbnN0e2F1ZGllbmNlOmwsc2NvcGU6dX09cnx8e307dHJ5e2NvbnN0IHI9YT8oZT0+e2NvbnN0IHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyhlKSxyPXt9O3JldHVybiB0LmZvckVhY2goKChlLHQpPT57clt0XT1lfSkpLHJ9KShjLmJvZHkpOkpTT04ucGFyc2UoYy5ib2R5KTtpZighci5yZWZyZXNoX3Rva2VuJiYicmVmcmVzaF90b2tlbiI9PT1yLmdyYW50X3R5cGUpe2NvbnN0IGU9KChlLHQpPT5vW24oZSx0KV0pKGwsdSk7aWYoIWUpdGhyb3cgbmV3IHQobCx1KTtjLmJvZHk9YT9zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpOkpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpfWxldCBkLGc7ImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGQ9bmV3IEFib3J0Q29udHJvbGxlcixjLnNpZ25hbD1kLnNpZ25hbCk7dHJ5e2c9YXdhaXQgUHJvbWlzZS5yYWNlKFsoaD1lLG5ldyBQcm9taXNlKChlPT5zZXRUaW1lb3V0KGUsaCkpKSksZmV0Y2goaSxPYmplY3QuYXNzaWduKHt9LGMpKV0pfWNhdGNoKGUpe3JldHVybiB2b2lkIGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfWlmKCFnKXJldHVybiBkJiZkLmFib3J0KCksdm9pZCBmLnBvc3RNZXNzYWdlKHtlcnJvcjoiVGltZW91dCB3aGVuIGV4ZWN1dGluZyAnZmV0Y2gnIn0pO3A9YXdhaXQgZy5qc29uKCkscC5yZWZyZXNoX3Rva2VuPygoKGUsdCxyKT0+e29bbih0LHIpXT1lfSkocC5yZWZyZXNoX3Rva2VuLGwsdSksZGVsZXRlIHAucmVmcmVzaF90b2tlbik6KChlLHQpPT57ZGVsZXRlIG9bbihlLHQpXX0pKGwsdSksZi5wb3N0TWVzc2FnZSh7b2s6Zy5vayxqc29uOnB9KX1jYXRjaChlKXtmLnBvc3RNZXNzYWdlKHtvazohMSxqc29uOntlcnJvcjplLmVycm9yLGVycm9yX2Rlc2NyaXB0aW9uOmUubWVzc2FnZX19KX12YXIgaH0pKX0oKTsKCg==",null,false),new Worker(K,e)});const G={};class B{constructor(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(e){var t;const r=new Set((null===(t=await this.cache.get(this.manifestKey))||void 0===t?void 0:t.keys)||[]);r.add(e),await this.cache.set(this.manifestKey,{keys:[...r]})}async remove(e){const t=await this.cache.get(this.manifestKey);if(t){const r=new Set(t.keys);return r.delete(e),r.size>0?await this.cache.set(this.manifestKey,{keys:[...r]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(e){return`@@auth0spajs@@::${e}`}}const W={memory:()=>(new x).enclosedCache,localstorage:()=>new z},V=e=>W[e],Y=e=>{const{openUrl:t,onRedirect:r}=e,o=n(e,["openUrl","onRedirect"]);return Object.assign(Object.assign({},o),{openUrl:!1===t||t?t:r})},J=new c;class te{constructor(e){let t,r;if(this.userCache=(new x).enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await J.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),e),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),e.authorizationParams)}),"undefined"!=typeof window&&(()=>{if(!_())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===_().subtle)throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")})(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)r=e.cache;else{if(t=e.cacheLocation||"memory",!V(t))throw new Error(`Invalid cache location "${t}"`);r=V(t)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===e.legacySameSiteCookie?j:H,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(e=>`auth0.${this.options.clientId}.is.authenticated`)(),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;const n=e.useCookiesForTransactions?this.cookieStorage:F;var o;this.scope=R("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new Z(n,this.options.clientId),this.nowProvider=this.options.nowProvider||v,this.cacheManager=new P(r,r.allKeys?void 0:new B(r,this.options.clientId),this.nowProvider),this.domainUrl=(o=this.options.domain,/^https?:\/\//.test(o)?o:`https://${o}`),this.tokenIssuer=((e,t)=>e?e.startsWith("https://")?e:`https://${e}/`:`${t}/`)(this.options.issuer,this.domainUrl),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&"memory"===t&&(this.worker=new D)}_url(e){const t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||y)));return`${this.domainUrl}${e}&auth0Client=${t}`}_authorizeUrl(e){return this._url(`/authorize?${S(e)}`)}async _verifyIdToken(e,t,r){const n=await this.nowProvider();return(e=>{if(!e.id_token)throw new Error("ID token is required but missing");const t=(e=>{const t=e.split("."),[r,n,o]=t;if(3!==t.length||!r||!n||!o)throw new Error("ID token could not be decoded");const i=JSON.parse(T(n)),s={__raw:e},a={};return Object.keys(i).forEach((e=>{s[e]=i[e],N.includes(e)||(a[e]=i[e])})),{encoded:{header:r,payload:n,signature:o},header:JSON.parse(T(r)),claims:s,user:a}})(e.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${e.iss}", found "${t.claims.iss}"`);if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error(`Signature algorithm of "${t.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but was not one of "${t.claims.aud.join(", ")}"`);if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${e.aud}", found "${t.claims.azp}"`)}}else if(t.claims.aud!==e.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but found "${t.claims.aud}"`);if(e.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${e.nonce}", found "${t.claims.nonce}"`)}if(e.max_age&&!O(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(null==t.claims.exp||!O(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!O(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const r=e.leeway||60,n=new Date(e.now||Date.now()),o=new Date(0);if(o.setUTCSeconds(t.claims.exp+r),n>o)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${n}) is after expiration time (${o})`);if(null!=t.claims.nbf&&O(t.claims.nbf)){const e=new Date(0);if(e.setUTCSeconds(t.claims.nbf-r),n<e)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${n}) is before ${e}`)}if(null!=t.claims.auth_time&&O(t.claims.auth_time)){const o=new Date(0);if(o.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+r),n>o)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${n}) is after last auth at ${o}`)}if(e.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${e.organizationId}", found "${t.claims.org_id}"`)}return t})({iss:this.tokenIssuer,aud:this.options.clientId,id_token:e,nonce:t,organizationId:r,leeway:this.options.leeway,max_age:(o=this.options.authorizationParams.max_age,"string"!=typeof o?o:parseInt(o,10)||void 0),now:n});var o}_processOrgIdHint(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(e,t,r){const n=E(b()),o=E(b()),i=b(),s=(e=>{const t=new Uint8Array(e);return(e=>{const t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,(e=>t[e]))})(window.btoa(String.fromCharCode(...Array.from(t))))})(await(async e=>{const t=_().subtle.digest({name:"SHA-256"},(new TextEncoder).encode(e));return await t})(i)),a=((e,t,r,n,o,i,s,a)=>Object.assign(Object.assign(Object.assign({client_id:e.clientId},e.authorizationParams),r),{scope:R(t,r.scope),response_type:"code",response_mode:a||"query",state:n,nonce:o,redirect_uri:s||e.authorizationParams.redirect_uri,code_challenge:i,code_challenge_method:"S256"}))(this.options,this.scope,e,n,o,s,e.redirect_uri||this.options.authorizationParams.redirect_uri||r,null==t?void 0:t.response_mode),c=this._authorizeUrl(a);return{nonce:o,code_verifier:i,scope:a.scope,audience:a.audience||"default",redirect_uri:a.redirect_uri,state:n,url:c}}async loginWithPopup(e,t){var r;if(e=e||{},!(t=t||{}).popup&&(t.popup=(e=>{const t=window.screenX+(window.innerWidth-400)/2,r=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup",`left=${t},top=${r},width=400,height=600,resizable,scrollbars=yes,status=1`)})(),!t.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const n=await this._prepareAuthorizeUrl(e.authorizationParams||{},{response_mode:"web_message"},window.location.origin);t.popup.location.href=n.url;const o=await(e=>new Promise(((t,r)=>{let n;const o=setInterval((()=>{e.popup&&e.popup.closed&&(clearInterval(o),clearTimeout(i),window.removeEventListener("message",n,!1),r(new p(e.popup)))}),1e3),i=setTimeout((()=>{clearInterval(o),r(new h(e.popup)),window.removeEventListener("message",n,!1)}),1e3*(e.timeoutInSeconds||60));n=function(s){if(s.data&&"authorization_response"===s.data.type){if(clearTimeout(i),clearInterval(o),window.removeEventListener("message",n,!1),e.popup.close(),s.data.response.error)return r(d.fromPayload(s.data.response));t(s.data.response)}},window.addEventListener("message",n)})))(Object.assign(Object.assign({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(n.state!==o.state)throw new Error("Invalid state");const i=(null===(r=e.authorizationParams)||void 0===r?void 0:r.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:n.audience,scope:n.scope,code_verifier:n.code_verifier,grant_type:"authorization_code",code:o.code,redirect_uri:n.redirect_uri},{nonceIn:n.nonce,organizationId:i})}async getUser(){var e;const t=await this._getIdTokenFromCache();return null===(e=null==t?void 0:t.decodedToken)||void 0===e?void 0:e.user}async getIdTokenClaims(){var e;const t=await this._getIdTokenFromCache();return null===(e=null==t?void 0:t.decodedToken)||void 0===e?void 0:e.claims}async loginWithRedirect(e={}){var t;const r=Y(e),{openUrl:o,fragment:i,appState:s}=r,a=n(r,["openUrl","fragment","appState"]),c=(null===(t=a.authorizationParams)||void 0===t?void 0:t.organization)||this.options.authorizationParams.organization,g=await this._prepareAuthorizeUrl(a.authorizationParams||{}),{url:y}=g,v=n(g,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},v),{appState:s}),c&&{organizationId:c}));const w=i?`${y}#${i}`:y;o?await o(w):window.location.assign(w)}async handleRedirectCallback(e=window.location.href){const t=e.split("?").slice(1);if(0===t.length)throw new Error("There are no query params available for parsing.");const{state:r,code:n,error:o,error_description:i}=(e=>{e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));const t=new URLSearchParams(e);return{state:t.get("state"),code:t.get("code")||void 0,error:t.get("error")||void 0,error_description:t.get("error_description")||void 0}})(t.join("")),s=this.transactionManager.get();if(!s)throw new Error("Invalid state");if(this.transactionManager.remove(),o)throw new u(o,i||o,r,s.appState);if(!s.code_verifier||s.state&&s.state!==r)throw new Error("Invalid state");const a=s.organizationId,c=s.nonce,g=s.redirect_uri;return await this._requestToken(Object.assign({audience:s.audience,scope:s.scope,code_verifier:s.code_verifier,grant_type:"authorization_code",code:n},g?{redirect_uri:g}:{}),{nonceIn:c,organizationId:a}),{appState:s.appState}}async checkSession(e){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(e)}catch(e){}}async getTokenSilently(e={}){var t;const r=Object.assign(Object.assign({cacheMode:"on"},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:R(this.scope,null===(t=e.authorizationParams)||void 0===t?void 0:t.scope)})}),n=await((e,t)=>{let r=G[t];return r||(r=e().finally((()=>{delete G[t],r=null})),G[t]=r),r})((()=>this._getTokenSilently(r)),`${this.options.clientId}::${r.authorizationParams.audience}::${r.authorizationParams.scope}`);return e.detailedResponse?n:null==n?void 0:n.access_token}async _getTokenSilently(e){const{cacheMode:t}=e,r=n(e,["cacheMode"]);if("off"!==t){const e=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(e)return e}if("cache-only"!==t){if(!(await(async(e,t=3)=>{for(let r=0;r<t;r++)if(await e())return!0;return!1})((()=>J.acquireLock("auth0.lock.getTokenSilently",5e3)),10)))throw new l;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),"off"!==t){const e=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(e)return e}const e=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(r):await this._getTokenFromIFrame(r),{id_token:n,access_token:o,oauthTokenScope:i,expires_in:s}=e;return Object.assign(Object.assign({id_token:n,access_token:o},i?{scope:i}:null),{expires_in:s})}finally{await J.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(e={},t={}){var r;const n=Object.assign(Object.assign({},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:R(this.scope,null===(r=e.authorizationParams)||void 0===r?void 0:r.scope)})});return t=Object.assign(Object.assign({},g),t),await this.loginWithPopup(n,t),(await this.cacheManager.get(new C({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!(await this.getUser())}_buildLogoutUrl(e){null!==e.clientId?e.clientId=e.clientId||this.options.clientId:delete e.clientId;const t=e.logoutParams||{},{federated:r}=t,o=n(t,["federated"]),i=r?"&federated":"";return this._url(`/v2/logout?${S(Object.assign({clientId:e.clientId},o))}`)+i}async logout(e={}){const t=Y(e),{openUrl:r}=t,o=n(t,["openUrl"]);null===e.clientId?await this.cacheManager.clear():await this.cacheManager.clear(e.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const i=this._buildLogoutUrl(o);r?await r(i):!1!==r&&window.location.assign(i)}async _getTokenFromIFrame(e){const t=Object.assign(Object.assign({},e.authorizationParams),{prompt:"none"}),r=this.cookieStorage.get(this.orgHintCookieName);r&&!t.organization&&(t.organization=r);const{url:n,state:o,nonce:i,code_verifier:s,redirect_uri:a,scope:c,audience:g}=await this._prepareAuthorizeUrl(t,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new d("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const t=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,r=await((e,t,r=60)=>new Promise(((n,o)=>{const i=window.document.createElement("iframe");i.setAttribute("width","0"),i.setAttribute("height","0"),i.style.display="none";const s=()=>{window.document.body.contains(i)&&(window.document.body.removeChild(i),window.removeEventListener("message",a,!1))};let a;const c=setTimeout((()=>{o(new l),s()}),1e3*r);a=function(e){if(e.origin!=t)return;if(!e.data||"authorization_response"!==e.data.type)return;const r=e.source;r&&r.close(),e.data.response.error?o(d.fromPayload(e.data.response)):n(e.data.response),clearTimeout(c),window.removeEventListener("message",a,!1),setTimeout(s,2e3)},window.addEventListener("message",a,!1),window.document.body.appendChild(i),i.setAttribute("src",e)})))(n,this.domainUrl,t);if(o!==r.state)throw new Error("Invalid state");const y=await this._requestToken(Object.assign(Object.assign({},e.authorizationParams),{code_verifier:s,code:r.code,grant_type:"authorization_code",redirect_uri:a,timeout:e.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:i});return Object.assign(Object.assign({},y),{scope:c,oauthTokenScope:y.scope,audience:g})}catch(e){throw"login_required"===e.error&&this.logout({openUrl:!1}),e}}async _getTokenUsingRefreshToken(e){const t=await this.cacheManager.get(new C({scope:e.authorizationParams.scope,audience:e.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(t&&t.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw new f(e.authorizationParams.audience||"default",e.authorizationParams.scope)}const r=e.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,n="number"==typeof e.timeoutInSeconds?1e3*e.timeoutInSeconds:null;try{const o=await this._requestToken(Object.assign(Object.assign(Object.assign({},e.authorizationParams),{grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:r}),n&&{timeout:n}));return Object.assign(Object.assign({},o),{scope:e.authorizationParams.scope,oauthTokenScope:o.scope,audience:e.authorizationParams.audience||"default"})}catch(t){if((t.message.indexOf("Missing Refresh Token")>-1||t.message&&t.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw t}}async _saveEntryInCache(e){const{id_token:t,decodedToken:r}=e,o=n(e,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:t,decodedToken:r}),await this.cacheManager.setIdToken(this.options.clientId,e.id_token,e.decodedToken),await this.cacheManager.set(o)}async _getIdTokenFromCache(){const e=this.options.authorizationParams.audience||"default",t=await this.cacheManager.getIdToken(new C({clientId:this.options.clientId,audience:e,scope:this.scope})),r=this.userCache.get("@@user@@");return t&&t.id_token===(null==r?void 0:r.id_token)?r:(this.userCache.set("@@user@@",t),t)}async _getEntryFromCache({scope:e,audience:t,clientId:r}){const n=await this.cacheManager.get(new C({scope:e,audience:t,clientId:r}),60);if(n&&n.access_token){const{access_token:e,oauthTokenScope:t,expires_in:r}=n,o=await this._getIdTokenFromCache();return o&&Object.assign(Object.assign({id_token:o.id_token,access_token:e},t?{scope:t}:null),{expires_in:r})}}async _requestToken(e,t){const{nonceIn:r,organizationId:n}=t||{},o=await A(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},e),this.worker),i=await this._verifyIdToken(o.id_token,r,n);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},o),{decodedToken:i,scope:e.scope,audience:e.audience||"default"}),o.scope?{oauthTokenScope:o.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgIdHint(i.claims.org_id),Object.assign(Object.assign({},o),{decodedToken:i})}}class ie{}async function X(e){const t=new te(e);return await t.checkSession(),t}},8297:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AccountEntity:()=>Re,ApiId:()=>Je,AuthError:()=>ye,AuthErrorMessage:()=>me,AuthenticationHeaderParser:()=>dn,AuthenticationScheme:()=>$,AzureCloudInstance:()=>Et,BrowserAuthError:()=>et,BrowserAuthErrorMessage:()=>$e,BrowserCacheLocation:()=>Ge,BrowserConfigurationAuthError:()=>ft,BrowserConfigurationAuthErrorMessage:()=>pt,BrowserUtils:()=>ar,CacheLookupPolicy:()=>ct,ClientAuthError:()=>we,ClientAuthErrorMessage:()=>ve,ClientConfigurationError:()=>Se,ClientConfigurationErrorMessage:()=>Ee,DEFAULT_IFRAME_TIMEOUT_MS:()=>Tr,EventMessageUtils:()=>un,EventType:()=>Xt,InteractionRequiredAuthError:()=>Kt,InteractionRequiredAuthErrorMessage:()=>Ft,InteractionStatus:()=>Xe,InteractionType:()=>Ze,LogLevel:()=>_t,Logger:()=>St,NavigationClient:()=>Cr,OIDC_DEFAULT_SCOPES:()=>U,PerformanceEvents:()=>dt,ProtocolMode:()=>Yt,PublicClientApplication:()=>an,ServerError:()=>Nt,SignedHttpRequest:()=>ln,StringUtils:()=>Ce,UrlString:()=>yt,WrapperSKU:()=>it,internals:()=>n,stubbedPublicClientApplication:()=>cn,version:()=>or});var n={};r.r(n),r.d(n,{BrowserCacheManager:()=>wt,BrowserConstants:()=>tt,BrowserPerformanceClient:()=>$r,BrowserPerformanceMeasurement:()=>Qr,CryptoOps:()=>Zr,EventHandler:()=>Pr,NativeAuthError:()=>gr,NativeInteractionClient:()=>wr,NativeMessageHandler:()=>_r,PopupClient:()=>Er,RedirectClient:()=>br,RedirectHandler:()=>dr,SilentCacheClient:()=>vr,SilentIframeClient:()=>Ar,SilentRefreshClient:()=>Rr,StandardInteractionClient:()=>ur,TemporaryCacheKeys:()=>ze});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function i(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function g(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}var w=function(e,t){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},w(e,t)};function _(e,t){function r(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var b=function(){return b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},b.apply(this,arguments)};function E(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function S(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function T(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}var I,k,A,R,O,N={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},U=[N.OPENID_SCOPE,N.PROFILE_SCOPE,N.OFFLINE_ACCESS_SCOPE],M=T(U,[N.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(I||(I={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(k||(k={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(A||(A={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(R||(R={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(O||(O={}));var q,L={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(q||(q={}));var j,H,F,K,D,G,W={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(j||(j={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(H||(H={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(F||(F={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(K||(K={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(D||(D={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(G||(G={}));var V,Y="appmetadata",J="1",X="authority-metadata",Q=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(V||(V={}));var $,ee={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}($||($={}));var re,ne,oe,se,ae,ce,ue=60,le=3600,de="throttling",he="retry-after, h429",pe="invalid_grant",fe="client_mismatch";!function(e){e.username="username",e.password="password"}(re||(re={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(ne||(ne={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(oe||(oe={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(se||(se={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(ae||(ae={})),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(ce||(ce={}));var ge,me={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},ye=function(e){function t(r,n,o){var i=this,s=n?r+": "+n:r;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||N.EMPTY_STRING,i.errorMessage=n||N.EMPTY_STRING,i.subError=o||N.EMPTY_STRING,i.name="AuthError",i}return _(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(me.unexpectedError.code,me.unexpectedError.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(me.postRequestFailed.code,me.postRequestFailed.desc+": "+e)},t}(Error),ve={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},we=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return _(t,e),t.createClientInfoDecodingError=function(e){return new t(ve.clientInfoDecodingError.code,ve.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(ve.clientInfoEmptyError.code,""+ve.clientInfoEmptyError.desc)},t.createTokenParsingError=function(e){return new t(ve.tokenParsingError.code,ve.tokenParsingError.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(ve.nullOrEmptyToken.code,ve.nullOrEmptyToken.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(ve.endpointResolutionError.code,ve.endpointResolutionError.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(ve.networkError.code,ve.networkError.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(ve.unableToGetOpenidConfigError.code,ve.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(ve.hashNotDeserialized.code,ve.hashNotDeserialized.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(ve.invalidStateError.code,ve.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(ve.stateMismatchError.code,ve.stateMismatchError.desc)},t.createStateNotFoundError=function(e){return new t(ve.stateNotFoundError.code,ve.stateNotFoundError.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(ve.nonceMismatchError.code,ve.nonceMismatchError.desc)},t.createAuthTimeNotFoundError=function(){return new t(ve.authTimeNotFoundError.code,ve.authTimeNotFoundError.desc)},t.createMaxAgeTranspiredError=function(){return new t(ve.maxAgeTranspiredError.code,ve.maxAgeTranspiredError.desc)},t.createNonceNotFoundError=function(e){return new t(ve.nonceNotFoundError.code,ve.nonceNotFoundError.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(ve.multipleMatchingTokens.code,ve.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(ve.multipleMatchingAccounts.code,ve.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(ve.multipleMatchingAppMetadata.code,ve.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(ve.tokenRequestCannotBeMade.code,ve.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(ve.appendEmptyScopeError.code,ve.appendEmptyScopeError.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(ve.removeEmptyScopeError.code,ve.removeEmptyScopeError.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(ve.appendScopeSetError.code,ve.appendScopeSetError.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(ve.emptyInputScopeSetError.code,""+ve.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(ve.DeviceCodePollingCancelled.code,""+ve.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(ve.DeviceCodeExpired.code,""+ve.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(ve.DeviceCodeUnknownError.code,""+ve.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(ve.NoAccountInSilentRequest.code,""+ve.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(ve.invalidCacheRecord.code,ve.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(ve.invalidCacheEnvironment.code,ve.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(ve.noAccountFound.code,ve.noAccountFound.desc)},t.createCachePluginError=function(){return new t(ve.CachePluginError.code,""+ve.CachePluginError.desc)},t.createNoCryptoObjectError=function(e){return new t(ve.noCryptoObj.code,""+ve.noCryptoObj.desc+e)},t.createInvalidCacheTypeError=function(){return new t(ve.invalidCacheType.code,""+ve.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(ve.unexpectedAccountType.code,""+ve.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(ve.unexpectedCredentialType.code,""+ve.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(ve.invalidAssertion.code,""+ve.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(ve.invalidClientCredential.code,""+ve.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(ve.tokenRefreshRequired.code,ve.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(ve.userTimeoutReached.code,ve.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(ve.tokenClaimsRequired.code,ve.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(ve.noAuthorizationCodeFromServer.code,ve.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(ve.bindingKeyNotRemovedError.code,ve.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(ve.logoutNotSupported.code,ve.logoutNotSupported.desc)},t.createKeyIdMissingError=function(){return new t(ve.keyIdMissing.code,ve.keyIdMissing.desc)},t.createNoNetworkConnectivityError=function(){return new t(ve.noNetworkConnectivity.code,ve.noNetworkConnectivity.desc)},t.createUserCanceledError=function(){return new t(ve.userCanceledError.code,ve.userCanceledError.desc)},t}(ye),_e=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case D.ID_TOKEN:return G.ID_TOKEN;case D.ACCESS_TOKEN:case D.ACCESS_TOKEN_WITH_AUTH_SCHEME:return G.ACCESS_TOKEN;case D.REFRESH_TOKEN:return G.REFRESH_TOKEN;default:throw we.createUnexpectedCredentialTypeError()}},e.generateCredentialCacheKey=function(e,t,r,n,o,i,s,a,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,s),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(a)].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===D.REFRESH_TOKEN&&n||t,r||N.EMPTY_STRING].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||N.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||N.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==$.BEARER.toLowerCase()?e.toLowerCase():N.EMPTY_STRING},e}(),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.createIdTokenEntity=function(e,r,n,o,i){var s=new t;return s.credentialType=D.ID_TOKEN,s.homeAccountId=e,s.environment=r,s.clientId=o,s.secret=n,s.realm=i,s},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===D.ID_TOKEN)},t}(_e),Ee={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},Se=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return _(t,e),t.createRedirectUriEmptyError=function(){return new t(Ee.redirectUriNotSet.code,Ee.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Ee.postLogoutUriNotSet.code,Ee.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(e){return new t(Ee.claimsRequestParsingError.code,Ee.claimsRequestParsingError.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Ee.authorityUriInsecure.code,Ee.authorityUriInsecure.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(Ee.urlParseError.code,Ee.urlParseError.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Ee.urlEmptyError.code,Ee.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(Ee.emptyScopesError.code,""+Ee.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(e){return new t(Ee.clientIdSingleScopeError.code,Ee.clientIdSingleScopeError.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(Ee.invalidPrompt.code,Ee.invalidPrompt.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Ee.invalidClaimsRequest.code,Ee.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(Ee.logoutRequestEmptyError.code,Ee.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(Ee.tokenRequestEmptyError.code,Ee.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(Ee.invalidCodeChallengeMethod.code,Ee.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(Ee.invalidCodeChallengeParams.code,Ee.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Ee.invalidCloudDiscoveryMetadata.code,Ee.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(Ee.invalidAuthorityMetadata.code,Ee.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(Ee.untrustedAuthority.code,Ee.untrustedAuthority.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(Ee.invalidAzureCloudInstance.code,Ee.invalidAzureCloudInstance.desc)},t.createMissingSshJwkError=function(){return new t(Ee.missingSshJwk.code,Ee.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(Ee.missingSshKid.code,Ee.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(Ee.missingNonceAuthenticationHeader.code,Ee.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(Ee.invalidAuthenticationHeader.code,Ee.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+r)},t}(we),Ce=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw we.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw we.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(n){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(t){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),Te=function(){function e(e){var t=this,r=e?Ce.trimArrayEntries(T(e)):[],n=r?Ce.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||N.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){var r=new e(t);return r.containsOnlyOIDCScopes()?r.removeScope(N.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Se.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!Ce.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return M.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){Ce.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(r){throw we.createAppendScopeSetError(r)}},e.prototype.removeScope=function(e){if(Ce.isEmpty(e))throw we.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;M.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw we.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw we.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):N.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function Ie(e,t){if(Ce.isEmpty(e))throw we.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(n){throw we.createClientInfoDecodingError(n.message)}}function ke(e){if(Ce.isEmpty(e))throw we.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(K.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?N.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(ge||(ge={}));var Ae,Re=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case F.ADFS_ACCOUNT_TYPE:return G.ADFS;case F.MSAV1_ACCOUNT_TYPE:return G.MSA;case F.MSSTS_ACCOUNT_TYPE:return G.MSSTS;case F.GENERIC_ACCOUNT_TYPE:return G.GENERIC;default:throw we.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||N.EMPTY_STRING,e.tenantId||N.EMPTY_STRING].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,s,a,c){var g,y,v,w,_,b,E=new e;E.authorityType=F.MSSTS_ACCOUNT_TYPE,E.clientInfo=t,E.homeAccountId=r,E.nativeAccountId=c;var S=a||o&&o.getPreferredCache();if(!S)throw we.createInvalidCacheEnvironmentError();if(E.environment=S,E.realm=(null===(g=null==n?void 0:n.claims)||void 0===g?void 0:g.tid)||N.EMPTY_STRING,n){E.idTokenClaims=n.claims,E.localAccountId=(null===(y=null==n?void 0:n.claims)||void 0===y?void 0:y.oid)||(null===(v=null==n?void 0:n.claims)||void 0===v?void 0:v.sub)||N.EMPTY_STRING;var T=null===(w=null==n?void 0:n.claims)||void 0===w?void 0:w.preferred_username,I=(null===(_=null==n?void 0:n.claims)||void 0===_?void 0:_.emails)?n.claims.emails[0]:null;E.username=T||I||N.EMPTY_STRING,E.name=null===(b=null==n?void 0:n.claims)||void 0===b?void 0:b.name}return E.cloudGraphHostName=i,E.msGraphHost=s,E},e.createGenericAccount=function(t,r,n,o,i,s){var a,c,g,y,v=new e;v.authorityType=n&&n.authorityType===ge.Adfs?F.ADFS_ACCOUNT_TYPE:F.GENERIC_ACCOUNT_TYPE,v.homeAccountId=t,v.realm=N.EMPTY_STRING;var w=s||n&&n.getPreferredCache();if(!w)throw we.createInvalidCacheEnvironmentError();return r&&(v.localAccountId=(null===(a=null==r?void 0:r.claims)||void 0===a?void 0:a.oid)||(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.sub)||N.EMPTY_STRING,v.username=(null===(g=null==r?void 0:r.claims)||void 0===g?void 0:g.upn)||N.EMPTY_STRING,v.name=(null===(y=null==r?void 0:r.claims)||void 0===y?void 0:y.name)||N.EMPTY_STRING,v.idTokenClaims=null==r?void 0:r.claims),v.environment=w,v.cloudGraphHostName=o,v.msGraphHost=i,v},e.generateHomeAccountId=function(e,t,r,n,o){var i,s=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:N.EMPTY_STRING;if(t===ge.Adfs||t===ge.Dsts)return s;if(e)try{var a=Ie(e,n);if(!Ce.isEmpty(a.uid)&&!Ce.isEmpty(a.utid))return""+a.uid+K.CLIENT_INFO_SEPARATOR+a.utid}catch(c){}return r.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),Pe=function(){function e(t,r){if(Ce.isEmpty(t))throw we.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=Ce.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(i){throw we.createTokenParsingError(i)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw we.createMaxAgeTranspiredError()},e}(),Oe="@azure/msal-common",Ne="12.1.0",Ue=function(){function e(e,t,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(Oe,Ne)}return e.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var r=t.reduce((function(t,r){var n=e.getAccount(r);return n?(t.push(n),t):t}),[]);return r.length<1?[]:r.map((function(t){return e.getAccountInfoFromEntity(t)}))},e.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},e.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),r=this.getIdToken(t);return r&&(t.idToken=r.secret,t.idTokenClaims=new Pe(r.secret,this.cryptoImpl).claims),t},e.prototype.saveCacheRecord=function(e){return E(this,void 0,void 0,(function(){return S(this,(function(t){switch(t.label){case 0:if(!e)throw we.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return E(this,void 0,void 0,(function(){var t,r,n,o,i=this;return S(this,(function(s){switch(s.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=Te.fromString(e.target),o=[],r.accessToken.forEach((function(e){if(i.accessTokenKeyMatchesFilter(e,t,!1)){var r=i.getAccessTokenCredential(e);if(r&&i.credentialMatchesFilter(r,t))Te.fromString(r.target).intersectingScopeSets(n)&&o.push(i.removeAccessToken(e))}})),[4,Promise.all(o)];case 1:return s.sent(),this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){var t=this,r=this.getAccountKeys(),n=[];return r.forEach((function(r){if(t.isAccountKey(r,e.homeAccountId,e.realm)){var o=t.getAccount(r);o&&(e.homeAccountId&&!t.matchHomeAccountId(o,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(o,e.localAccountId)||e.username&&!t.matchUsername(o,e.username)||e.environment&&!t.matchEnvironment(o,e.environment)||e.realm&&!t.matchRealm(o,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(o,e.nativeAccountId)||n.push(o))}})),n},e.prototype.isAccountKey=function(e,t,r){return!(e.split(K.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))},e.prototype.isCredentialKey=function(e){if(e.split(K.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(D.ID_TOKEN.toLowerCase())&&-1===t.indexOf(D.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(D.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(D.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(D.REFRESH_TOKEN.toLowerCase())>-1){var r=""+D.REFRESH_TOKEN+K.CACHE_KEY_SEPARATOR+this.clientId+K.CACHE_KEY_SEPARATOR,n=""+D.REFRESH_TOKEN+K.CACHE_KEY_SEPARATOR+J+K.CACHE_KEY_SEPARATOR;if(-1===t.indexOf(r.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0},e.prototype.credentialMatchesFilter=function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===D.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===$.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return E(this,void 0,void 0,(function(){var e,t,r=this;return S(this,(function(n){switch(n.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.removeAccount=function(e){return E(this,void 0,void 0,(function(){var t;return S(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw we.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return r.sent(),this.removeItem(e),[2]}}))}))},e.prototype.removeAccountContext=function(e){return E(this,void 0,void 0,(function(){var t,r,n,o=this;return S(this,(function(i){switch(i.label){case 0:return t=this.getTokenKeys(),r=e.generateAccountId(),n=[],t.idToken.forEach((function(e){0===e.indexOf(r)&&o.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(r)&&n.push(o.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(r)&&o.removeRefreshToken(e)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},e.prototype.removeAccessToken=function(e){return E(this,void 0,void 0,(function(){var t,r;return S(this,(function(n){switch(n.label){case 0:if(!(t=this.getAccessTokenCredential(e)))return[2];if(t.credentialType.toLowerCase()!==D.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==$.POP)return[3,4];if(!(r=t.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),we.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},e.prototype.readCacheRecord=function(e,t,r){var n=this.getTokenKeys(),o=this.readAccountFromCache(e),i=this.getIdToken(e,n),s=this.getAccessToken(e,t,n),a=this.getRefreshToken(e,!1,n),c=this.readAppMetadataFromCache(r);return o&&i&&(o.idTokenClaims=new Pe(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:s,refreshToken:a,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=Re.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.getIdToken=function(e,t){this.commonLogger.trace("CacheManager - getIdToken called");var r={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:D.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(r,t),o=n.length;if(o<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(o>1)throw we.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0]},e.prototype.getIdTokensByFilter=function(e,t){var r=this,n=t&&t.idToken||this.getTokenKeys().idToken,o=[];return n.forEach((function(t){if(r.idTokenKeyMatchesFilter(t,b({clientId:r.clientId},e))){var n=r.getIdTokenCredential(t);n&&r.credentialMatchesFilter(n,e)&&o.push(n)}})),o},e.prototype.idTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.removeIdToken=function(e){this.removeItem(e)},e.prototype.removeRefreshToken=function(e){this.removeItem(e)},e.prototype.getAccessToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getAccessToken called");var o=Te.createSearchScopes(t.scopes),i=t.authenticationScheme||$.BEARER,s=i&&i.toLowerCase()!==$.BEARER.toLowerCase()?D.ACCESS_TOKEN_WITH_AUTH_SCHEME:D.ACCESS_TOKEN,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:e.tenantId,target:o,tokenType:i,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=r&&r.accessToken||this.getTokenKeys().accessToken,g=[];c.forEach((function(e){if(n.accessTokenKeyMatchesFilter(e,a,!0)){var t=n.getAccessTokenCredential(e);t&&n.credentialMatchesFilter(t,a)&&g.push(t)}}));var y=g.length;if(y<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(y>1)throw we.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),g[0]},e.prototype.accessTokenKeyMatchesFilter=function(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var o=t.target.asArray(),i=0;i<o.length;i++){if(r&&!n.includes(o[i].toLowerCase()))return!1;if(!r&&n.includes(o[i].toLowerCase()))return!0}return!0},e.prototype.getAccessTokensByFilter=function(e){var t=this,r=this.getTokenKeys(),n=[];return r.accessToken.forEach((function(r){if(t.accessTokenKeyMatchesFilter(r,e,!0)){var o=t.getAccessTokenCredential(r);o&&t.credentialMatchesFilter(o,e)&&n.push(o)}})),n},e.prototype.getRefreshToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var o=t?J:void 0,i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:D.REFRESH_TOKEN,clientId:this.clientId,familyId:o},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,a=[];return s.forEach((function(e){if(n.refreshTokenKeyMatchesFilter(e,i)){var t=n.getRefreshTokenCredential(e);t&&n.credentialMatchesFilter(t,i)&&a.push(t)}})),a.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),a[0])},e.prototype.refreshTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))},e.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((function(e){return r[e]})),o=n.length;if(o<1)return null;if(o>1)throw we.createMultipleMatchingAppMetadataInCacheError();return n[0]},e.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==J)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchLocalAccountId=function(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)},e.prototype.matchUsername=function(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){return!(e.credentialType!==D.ACCESS_TOKEN&&e.credentialType!==D.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Te.fromString(e.target).containsScopeSet(t)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(Y)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(X)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return X+"-"+this.clientId+"-"+e},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.prototype.setAccount=function(){throw ye.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ye.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ye.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ye.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ye.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ye.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ye.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ye.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ye.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ye.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ye.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ye.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ye.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ye.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw ye.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw ye.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",ye.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw ye.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(Ue),xe=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,s,a,c,g,y,v,w,_,b,E){var S,T,I=new t;I.homeAccountId=e,I.credentialType=D.ACCESS_TOKEN,I.secret=n;var k=xe.nowSeconds();if(I.cachedAt=k.toString(),I.expiresOn=a.toString(),I.extendedExpiresOn=c.toString(),y&&(I.refreshOn=y.toString()),I.environment=r,I.clientId=o,I.realm=i,I.target=s,I.userAssertionHash=w,I.tokenType=Ce.isEmpty(v)?$.BEARER:v,b&&(I.requestedClaims=b,I.requestedClaimsHash=E),(null===(S=I.tokenType)||void 0===S?void 0:S.toLowerCase())!==$.BEARER.toLowerCase())switch(I.credentialType=D.ACCESS_TOKEN_WITH_AUTH_SCHEME,I.tokenType){case $.POP:var A=Pe.extractTokenClaims(n,g);if(!(null===(T=null==A?void 0:A.cnf)||void 0===T?void 0:T.kid))throw we.createTokenClaimsRequiredError();I.keyId=A.cnf.kid;break;case $.SSH:I.keyId=_}return I},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===D.ACCESS_TOKEN||e.credentialType===D.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(_e),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,s){var a=new t;return a.clientId=o,a.credentialType=D.REFRESH_TOKEN,a.environment=r,a.homeAccountId=e,a.secret=n,a.userAssertionHash=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===D.REFRESH_TOKEN)},t}(_e),je=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[Y,e,t].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(Y)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),He=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(ee.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),Fe=function(){function e(){this.expiresAt=xe.nowSeconds()+Q}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=xe.nowSeconds()+Q},e.prototype.isExpired=function(){return this.expiresAt<=xe.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(X)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}(),Ke=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(de));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),De=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return Ce.isEmpty(r)?o:""+o+N.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw we.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw we.createNoCryptoObjectError("parseRequestState");if(Ce.isEmpty(t))throw we.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(N.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(N.RESOURCE_DELIM):N.EMPTY_STRING,i=e.base64Decode(n),s=JSON.parse(i);return{userRequestState:Ce.isEmpty(o)?N.EMPTY_STRING:o,libraryState:s}}catch(a){throw we.createInvalidStateError(t,a)}},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Ae||(Ae={}));var Be,Ge,We,ze,Ve,Ye,Je,Ze,Xe,Qe={createNewGuid:function(){throw ye.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ye.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ye.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",ye.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",ye.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",ye.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",ye.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",ye.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - hashString() has not been implemented",ye.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},$e={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},et=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return i(t,e),t.createPkceNotGeneratedError=function(e){return new t($e.pkceNotGenerated.code,$e.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t($e.cryptoDoesNotExist.code,$e.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t($e.httpMethodNotImplementedError.code,$e.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t($e.emptyNavigateUriError.code,$e.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t($e.hashEmptyError.code,$e.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t($e.hashDoesNotContainStateError.code,$e.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t($e.hashDoesNotContainKnownPropertiesError.code,$e.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t($e.unableToParseStateError.code,$e.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t($e.stateInteractionTypeMismatchError.code,$e.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t($e.interactionInProgress.code,$e.interactionInProgress.desc)},t.createPopupWindowError=function(e){var r=$e.popupWindowError.desc;return r=Ce.isEmpty(e)?r:r+" Details: "+e,new t($e.popupWindowError.code,r)},t.createEmptyWindowCreatedError=function(){return new t($e.emptyWindowError.code,$e.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t($e.userCancelledError.code,$e.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t($e.monitorPopupTimeoutError.code,$e.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t($e.monitorIframeTimeoutError.code,$e.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t($e.redirectInIframeError.code,$e.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t($e.blockTokenRequestsInHiddenIframeError.code,$e.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t($e.blockAcquireTokenInPopupsError.code,$e.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t($e.iframeClosedPrematurelyError.code,$e.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t($e.silentLogoutUnsupportedError.code,$e.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t($e.noAccountError.code,$e.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t($e.silentPromptValueError.code,$e.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t($e.unableToParseTokenRequestCacheError.code,$e.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t($e.noTokenRequestCacheError.code,$e.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t($e.authRequestNotSet.code,$e.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t($e.noCachedAuthorityError.code,$e.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t($e.invalidCacheType.code,""+$e.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t($e.notInBrowserEnvironment.code,$e.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t($e.databaseNotOpen.code,$e.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t($e.noNetworkConnectivity.code,$e.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(e,r){return new t($e.postRequestFailed.code,$e.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t($e.getRequestFailed.code,$e.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t($e.failedToParseNetworkResponse.code,$e.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t($e.unableToLoadTokenError.code,$e.unableToLoadTokenError.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t($e.signingKeyNotFoundInStorage.code,$e.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t($e.authCodeRequired.code,$e.authCodeRequired.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t($e.authCodeOrNativeAccountRequired.code,$e.authCodeOrNativeAccountRequired.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t($e.spaCodeAndNativeAccountPresent.code,$e.spaCodeAndNativeAccountPresent.desc)},t.createDatabaseUnavailableError=function(){return new t($e.databaseUnavailable.code,$e.databaseUnavailable.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t($e.unableToAcquireTokenFromNativePlatform.code,$e.unableToAcquireTokenFromNativePlatform.desc)},t.createNativeHandshakeTimeoutError=function(){return new t($e.nativeHandshakeTimeout.code,$e.nativeHandshakeTimeout.desc)},t.createNativeExtensionNotInstalledError=function(){return new t($e.nativeExtensionNotInstalled.code,$e.nativeExtensionNotInstalled.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t($e.nativeConnectionNotEstablished.code,$e.nativeConnectionNotEstablished.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t($e.nativeBrokerCalledBeforeInitialize.code,$e.nativeBrokerCalledBeforeInitialize.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t($e.nativePromptNotSupported.code,$e.nativePromptNotSupported.desc)},t}(ye),tt={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},rt="53ee284d-920a-4b59-9d30-a60315b26836",nt="ppnbnpeolgkicgegkbkbjmhlideopiji",ot="MATS";!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(Be||(Be={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(Ge||(Ge={})),function(e){e.GET="GET",e.POST="POST"}(We||(We={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(ze||(ze={})),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(Ve||(Ve={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(Ye||(Ye={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(Je||(Je={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Ze||(Ze={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Xe||(Xe={}));var it,st={scopes:U},at="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(it||(it={}));var ct,ut="msal.db",lt=ut+".keys";!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(ct||(ct={}));var dt,ht,pt={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},ft=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return i(t,e),t.createRedirectUriEmptyError=function(){return new t(pt.redirectUriNotSet.code,pt.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(pt.postLogoutUriNotSet.code,pt.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(pt.storageNotSupportedError.code,pt.storageNotSupportedError.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(pt.noRedirectCallbacksSet.code,pt.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(pt.stubPcaInstanceCalled.code,pt.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(pt.inMemRedirectUnavailable.code,pt.inMemRedirectUnavailable.desc)},t.createEntropyNotProvided=function(){return new t(pt.entropyNotProvided.code,pt.entropyNotProvided.desc)},t}(ye),gt=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==Ge.LocalStorage&&e!==Ge.SessionStorage)throw ft.createStorageNotSupportedError(e);if(!!!window[e])throw ft.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),mt=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),yt=function(){function e(t){if(this._urlString=t,Ce.isEmpty(this._urlString))throw Se.createUrlEmptyError();Ce.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return Ce.endsWith(t,"?")?t=t.slice(0,-1):Ce.endsWith(t,"?/")&&(t=t.slice(0,-2)),Ce.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw Se.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw Se.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Se.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return Ce.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==A.COMMON&&n[0]!==A.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Se.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!Ce.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Se.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===N.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):N.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):N.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(Ce.isEmpty(t))return{};var r=e.parseHash(t),n=Ce.queryStringToObject(Ce.isEmpty(r)?t:r);if(!n)throw we.createHashNotDeserializedError(JSON.stringify(n));return n},e.getDeserializedQueryString=function(t){if(Ce.isEmpty(t))return{};var r=e.parseQueryString(t),n=Ce.queryStringToObject(Ce.isEmpty(r)?t:r);if(!n)throw we.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(Ce.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),vt=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(Ce.isEmpty(t))return null;try{return De.parseRequestState(e,t).libraryState.meta}catch(r){throw we.createInvalidStateError(t,r)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new yt(e);return yt.getDeserializedHash(t.getHash())},e}(),wt=function(e){function t(t,r,n,o){var i=e.call(this,t,n,o)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new mt,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),r.cacheMigrationEnabled&&(i.migrateCacheEntries(),i.createKeyMaps()),i}return i(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case Ge.LocalStorage:case Ge.SessionStorage:try{return new gt(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=Ge.MemoryStorage,new mt},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case Ge.LocalStorage:case Ge.SessionStorage:try{return new gt(Ge.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case Ge.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=N.CACHE_PREFIX+"."+k.ID_TOKEN,r=N.CACHE_PREFIX+"."+k.CLIENT_INFO,n=N.CACHE_PREFIX+"."+k.ERROR,o=N.CACHE_PREFIX+"."+k.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[k.ID_TOKEN,k.CLIENT_INFO,k.ERROR,k.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.createKeyMaps=function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(Ve.ACCOUNT_KEYS),r=this.getItem(Ve.TOKEN_KEYS+"."+this.clientId);t&&r?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var r;if(e.isCredentialKey(t)&&(r=e.getItem(t))){var n=e.validateAndParseJson(r);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case D.ID_TOKEN:if(be.isIdTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map");var o=Ue.toObject(new be,n),i=e.updateCredentialCacheKey(t,o);return void e.addTokenKey(i,D.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case D.ACCESS_TOKEN:case D.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(qe.isAccessTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map");var s=Ue.toObject(new qe,n);i=e.updateCredentialCacheKey(t,s);return void e.addTokenKey(i,D.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case D.REFRESH_TOKEN:if(Le.isRefreshTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map");var a=Ue.toObject(new Le,n);i=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(i,D.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}if(e.isAccountKey(t)&&(r=e.getItem(t))){var c=e.validateAndParseJson(r);c&&Re.isAccountEntity(c)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}}))},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(r){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var r=this.validateAndParseJson(t);return r&&Re.isAccountEntity(r)?Ue.toObject(new Re,r):(this.removeAccountKeyFromMap(e),null)},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},t.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(Ve.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},t.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(Ve.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},t.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(Ve.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},t.prototype.removeAccount=function(t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return e.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]}))}))},t.prototype.removeIdToken=function(t){e.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,D.ID_TOKEN)},t.prototype.removeAccessToken=function(t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return e.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,D.ACCESS_TOKEN),[2]}))}))},t.prototype.removeRefreshToken=function(t){e.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,D.REFRESH_TOKEN)},t.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(Ve.TOKEN_KEYS+"."+this.clientId);if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},t.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var r=this.getTokenKeys();switch(t){case D.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case D.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case D.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),we.createUnexpectedCredentialTypeError()}this.setItem(Ve.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var r=this.getTokenKeys();switch(t){case D.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case D.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map");var o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case D.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map");var i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),we.createUnexpectedCredentialTypeError()}this.setItem(Ve.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,D.ID_TOKEN),null;var r=this.validateAndParseJson(t);return r&&be.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Ue.toObject(new be,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,D.ID_TOKEN),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,D.ID_TOKEN)},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,D.ACCESS_TOKEN),null;var r=this.validateAndParseJson(t);return r&&qe.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Ue.toObject(new qe,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,D.ACCESS_TOKEN),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,D.ACCESS_TOKEN)},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,D.REFRESH_TOKEN),null;var r=this.validateAndParseJson(t);return r&&Le.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Ue.toObject(new Le,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,D.REFRESH_TOKEN),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,D.REFRESH_TOKEN)},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&je.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Ue.toObject(new je,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&He.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Ue.toObject(new He,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Fe.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Ue.toObject(new Fe,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(Ye.WRAPPER_SKU,e),this.internalStorage.setItem(Ye.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Ye.WRAPPER_SKU)||N.EMPTY_STRING,this.internalStorage.getItem(Ye.WRAPPER_VER)||N.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(k.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var r=this.generateCacheKey(k.ACTIVE_ACCOUNT),n=this.getItem(r);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var o=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o),o):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(k.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(k.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var n=r.idTokenClaims&&r.idTokenClaims.sid;return t===n}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw we.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ke.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Ue.toObject(new Ke,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===Ge.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return v(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return c(this,void 0,void 0,(function(){var e=this;return g(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(N.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return N.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=N.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,N.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Ce.startsWith(e,N.CACHE_PREFIX)||Ce.startsWith(e,k.ADAL_ID_TOKEN)?e:N.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=De.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ze.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=De.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ze.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=De.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ze.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,r,!1),o){var c={credential:o.homeAccountId,type:Ae.HOME_ACCOUNT_ID};this.setTemporaryCache(ze.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!Ce.isEmpty(n)){c={credential:n,type:Ae.UPN};this.setTemporaryCache(ze.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),Ce.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(ze.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(ze.ORIGIN_URI)),this.removeItem(this.generateCacheKey(ze.URL_HASH)),this.removeItem(this.generateCacheKey(ze.CORRELATION_ID)),this.removeItem(this.generateCacheKey(ze.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(ze.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||N.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(ze.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=vt.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(ze.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(ze.REQUEST_PARAMS,!0);if(!r)throw et.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw et.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(ze.REQUEST_PARAMS)),Ce.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw et.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(ze.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=N.CACHE_PREFIX+"."+ze.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=N.CACHE_PREFIX+"."+ze.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw et.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(k.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(k.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(k.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(k.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new Pe(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(ze.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(ze.REDIRECT_CONTEXT,e,!0)},t}(Ue);!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake"}(dt||(dt={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(ht||(ht={}));var _t,bt=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(_t||(_t={}));var Et,St=function(){function e(t,r,n){this.level=_t.Info;var o=t||e.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||function(){},this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level="number"==typeof o.logLevel?o.logLevel:_t.Info,this.correlationId=o.correlationId||N.EMPTY_STRING,this.packageName=r||N.EMPTY_STRING,this.packageVersion=n||N.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:_t.Info}},e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Ce.isEmpty(t.correlationId)?Ce.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+_t[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:_t.Error,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:_t.Error,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:_t.Warning,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:_t.Warning,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:_t.Info,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:_t.Info,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:_t.Verbose,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:_t.Verbose,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:_t.Trace,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:_t.Trace,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}();!function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(Et||(Et={}));var Ct={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Tt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:_t.Info,correlationId:N.EMPTY_STRING},It={sendGetRequestAsync:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",ye.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",ye.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},kt={sku:N.SKU,version:Ne,cpu:N.EMPTY_STRING,os:N.EMPTY_STRING},At={clientSecret:N.EMPTY_STRING,clientAssertion:void 0},Rt={azureCloudInstance:Et.None,tenant:""+N.DEFAULT_COMMON_TENANT},Pt={application:{appName:"",appVersion:""}};var Ot,Nt=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return _(t,e),t}(ye),Ut=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return de+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o);throw new Nt((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||N.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[I.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(I.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||ue),r+le))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i)},e}(),Mt=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return E(this,void 0,void 0,(function(){var n,o;return S(this,(function(i){switch(i.label){case 0:Ut.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof ye?o:we.createNetworkError(t,o);case 4:return Ut.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),xt=function(){function e(){}return e.validateRedirectUri=function(e){if(Ce.isEmpty(e))throw Se.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in L)t.push(L[r]);if(t.indexOf(e)<0)throw Se.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(t){throw Se.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(Ce.isEmpty(e)||Ce.isEmpty(t))throw Se.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([W.PLAIN,W.S256].indexOf(e)<0)throw Se.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),qt=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(R.RESPONSE_TYPE,encodeURIComponent(N.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(R.RESPONSE_TYPE,encodeURIComponent(N.TOKEN_RESPONSE_TYPE+" "+N.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(R.RESPONSE_MODE,encodeURIComponent(e||j.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(R.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?T(e||[],U):e||[],n=new Te(r);this.parameters.set(R.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(R.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){xt.validateRedirectUri(e),this.parameters.set(R.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){xt.validateRedirectUri(e),this.parameters.set(R.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(R.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(q.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(q.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(I.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(I.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(q.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);xt.validateClaims(r),this.parameters.set(R.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(R.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(R.X_CLIENT_SKU,e.sku),this.parameters.set(R.X_CLIENT_VER,e.version),e.os&&this.parameters.set(R.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(R.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(R.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(R.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){xt.validatePrompt(e),this.parameters.set(""+R.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){Ce.isEmpty(e)||this.parameters.set(R.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(R.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(xt.validateCodeChallengeParams(e,t),!e||!t)throw Se.createInvalidCodeChallengeParamsError();this.parameters.set(R.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(R.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(R.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(R.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(R.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(R.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(R.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){Ce.isEmpty(e)||this.parameters.set(R.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){Ce.isEmpty(e)||this.parameters.set(R.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(R.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(R.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(R.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,r=xt.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(n){throw Se.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(O.ACCESS_TOKEN)||(r[O.ACCESS_TOKEN]={}),r[O.ACCESS_TOKEN][O.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(re.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(re.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){Ce.isEmpty(e)||(this.parameters.set(R.TOKEN_TYPE,$.POP),this.parameters.set(R.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){Ce.isEmpty(e)||(this.parameters.set(R.TOKEN_TYPE,$.SSH),this.parameters.set(R.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(R.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(R.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(R.X_MS_LIB_CAPABILITY,he)},e.prototype.addLogoutHint=function(e){this.parameters.set(R.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),Lt=function(){function e(e,t){var r,n,o,i,s,a,c,g,y,v,w,_,E,S,T;this.config=(o=(r=e).authOptions,i=r.systemOptions,s=r.loggerOptions,a=r.storageInterface,c=r.networkInterface,g=r.cryptoInterface,y=r.clientCredentials,v=r.libraryInfo,w=r.telemetry,_=r.serverTelemetryManager,E=r.persistencePlugin,S=r.serializableCache,T=b(b({},Tt),s),{authOptions:(n=o,b({clientCapabilities:[],azureCloudOptions:Rt,skipAuthorityMetadataCache:!1},n)),systemOptions:b(b({},Ct),i),loggerOptions:T,storageInterface:a||new Me(o.clientId,Qe,new St(T)),networkInterface:c||It,cryptoInterface:g||Qe,clientCredentials:y||At,libraryInfo:b(b({},kt),v),telemetry:b(b({},Pt),w),serverTelemetryManager:_||null,persistencePlugin:E||null,serializableCache:S||null}),this.logger=new St(this.config.loggerOptions,Oe,Ne),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Mt(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[I.CONTENT_TYPE]=N.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Ae.HOME_ACCOUNT_ID:try{var r=ke(e.credential);t[I.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Ae.UPN:t[I.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return E(this,void 0,void 0,(function(){var o;return S(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw we.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new qt;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),jt=["interaction_required","consent_required","login_required"],Ht=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Ft={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},Kt=function(e){function t(r,n,o,i,s,a,c){var g=e.call(this,r,n,o)||this;return Object.setPrototypeOf(g,t.prototype),g.timestamp=i||N.EMPTY_STRING,g.traceId=s||N.EMPTY_STRING,g.correlationId=a||N.EMPTY_STRING,g.claims=c||N.EMPTY_STRING,g.name="InteractionRequiredAuthError",g}return _(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&jt.indexOf(e)>-1,o=!!r&&Ht.indexOf(r)>-1,i=!!t&&jt.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t(Ft.noTokensFoundError.code,Ft.noTokensFoundError.desc)},t.createNativeAccountUnavailableError=function(){return new t(Ft.native_account_unavailable.code,Ft.native_account_unavailable.desc)},t}(ye),Dt=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null};!function(e){e.SW="sw",e.UHW="uhw"}(Ot||(Ot={}));var Bt=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,r;return E(this,void 0,void 0,(function(){var n,o,i;return S(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.PopTokenGenerateCnf,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=s.sent(),o=this.cryptoUtils.base64Encode(JSON.stringify(n)),i={kid:n.kid,reqCnfString:o},[4,this.cryptoUtils.hashString(o)];case 2:return[2,(i.reqCnfHash=s.sent(),i)]}}))}))},e.prototype.generateKid=function(e){var t;return E(this,void 0,void 0,(function(){return S(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:Ot.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return E(this,void 0,void 0,(function(){return S(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return E(this,void 0,void 0,(function(){var o,i,s,a,c,g;return S(this,(function(y){switch(y.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,s=r.shrClaims,a=r.shrNonce,c=i?new yt(i):void 0,g=null==c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(b({at:e,ts:xe.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==g?void 0:g.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null==g?void 0:g.AbsolutePath,q:(null==g?void 0:g.QueryString)?[[],g.QueryString]:void 0,client_claims:s||void 0},n),t,r.correlationId)];case 1:return[2,y.sent()]}}))}))},e}(),Gt=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),Wt=function(){function e(e,t,r,n,o,i,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=s}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?we.createStateNotFoundError("Cached State"):we.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw we.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Kt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Kt(e.error||N.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||N.EMPTY_STRING,e.trace_id||N.EMPTY_STRING,e.correlation_id||N.EMPTY_STRING,e.claims||N.EMPTY_STRING);throw new Nt(e.error||N.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Ie(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Kt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Kt(e.error,e.error_description,e.suberror,e.timestamp||N.EMPTY_STRING,e.trace_id||N.EMPTY_STRING,e.correlation_id||N.EMPTY_STRING,e.claims||N.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Nt(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,s,a,c,g){var y;return E(this,void 0,void 0,(function(){var v,w,_,b,E,T;return S(this,(function(S){switch(S.label){case 0:if(null===(y=this.performanceClient)||void 0===y||y.addQueueMeasurement(dt.HandleServerTokenResponse,t.correlation_id),t.id_token){if(v=new Pe(t.id_token||N.EMPTY_STRING,this.cryptoObj),i&&!Ce.isEmpty(i.nonce)&&v.claims.nonce!==i.nonce)throw we.createNonceMismatchError();if(o.maxAge||0===o.maxAge){if(!(w=v.claims.auth_time))throw we.createAuthTimeNotFoundError();Pe.checkMaxAge(w,o.maxAge)}}this.homeAccountIdentifier=Re.generateHomeAccountId(t.client_info||N.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,v),i&&i.state&&(_=De.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||o.sshKid||void 0,b=this.generateCacheRecord(t,r,n,o,v,s,i),S.label=1;case 1:return S.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),E=new Gt(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(E)]):[3,3];case 2:S.sent(),S.label=3;case 3:return!a||c||!b.account||(T=b.account.generateAccountKey(),this.cacheStorage.getAccount(T))?[4,this.cacheStorage.saveCacheRecord(b)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,b,!1,o,v,_,void 0,g)]);case 4:return S.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&E?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(E)]):[3,7];case 6:S.sent(),S.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,b,!1,o,v,_,t,g)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,s){var a,c,g=t.getPreferredCache();if(Ce.isEmpty(g))throw we.createInvalidCacheEnvironmentError();!Ce.isEmpty(e.id_token)&&o&&(a=be.createIdTokenEntity(this.homeAccountIdentifier,g,e.id_token||N.EMPTY_STRING,this.clientId,o.claims.tid||N.EMPTY_STRING),c=this.generateAccountEntity(e,o,t,s));var y=null;if(!Ce.isEmpty(e.access_token)){var v=e.scope?Te.fromString(e.scope):new Te(n.scopes||[]),w=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,_=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,b=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,E=r+w,S=E+_,T=b&&b>0?r+b:void 0;y=qe.createAccessTokenEntity(this.homeAccountIdentifier,g,e.access_token||N.EMPTY_STRING,this.clientId,o?o.claims.tid||N.EMPTY_STRING:t.tenant,v.printScopes(),E,S,this.cryptoObj,T,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var I=null;Ce.isEmpty(e.refresh_token)||(I=Le.createRefreshTokenEntity(this.homeAccountIdentifier,g,e.refresh_token||N.EMPTY_STRING,this.clientId,e.foci,i));var k=null;return Ce.isEmpty(e.foci)||(k=je.createAppMetadataEntity(this.clientId,g,e.foci)),new Dt(c,a,y,I,k)},e.prototype.generateAccountEntity=function(e,t,r,n){var o=r.authorityType,i=n?n.cloud_graph_host_name:N.EMPTY_STRING,s=n?n.msgraph_host:N.EMPTY_STRING;if(o===ge.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Re.createGenericAccount(this.homeAccountIdentifier,t,r,i,s);if(Ce.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw we.createClientInfoEmptyError();return e.client_info?Re.createAccount(e.client_info,this.homeAccountIdentifier,t,r,i,s):Re.createGenericAccount(this.homeAccountIdentifier,t,r,i,s)},e.generateAuthenticationResult=function(e,t,r,n,o,i,s,a,c){var g,y,v;return E(this,void 0,void 0,(function(){var w,_,b,E,T,I,k,A,R,O,U;return S(this,(function(S){switch(S.label){case 0:if(w=N.EMPTY_STRING,_=[],b=null,T=N.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==$.POP)return[3,2];if(I=new Bt(e),k=r.accessToken,A=k.secret,!(R=k.keyId))throw we.createKeyIdMissingError();return[4,I.signPopToken(A,R,o)];case 1:return w=S.sent(),[3,3];case 2:w=r.accessToken.secret,S.label=3;case 3:_=Te.fromString(r.accessToken.target).asArray(),b=new Date(1e3*Number(r.accessToken.expiresOn)),E=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),S.label=4;case 4:return r.appMetadata&&(T=r.appMetadata.familyId===J?J:N.EMPTY_STRING),O=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||N.EMPTY_STRING,U=(null==i?void 0:i.claims.tid)||N.EMPTY_STRING,(null==a?void 0:a.spa_accountid)&&r.account&&(r.account.nativeAccountId=null==a?void 0:a.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:O,tenantId:U,scopes:_,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:N.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:w,fromCache:n,expiresOn:b,correlationId:o.correlationId,requestId:c||N.EMPTY_STRING,extExpiresOn:E,familyId:T,tokenType:(null===(g=r.accessToken)||void 0===g?void 0:g.tokenType)||N.EMPTY_STRING,state:s?s.userRequestState:N.EMPTY_STRING,cloudGraphHostName:(null===(y=r.account)||void 0===y?void 0:y.cloudGraphHostName)||N.EMPTY_STRING,msGraphHost:(null===(v=r.account)||void 0===v?void 0:v.msGraphHost)||N.EMPTY_STRING,code:null==a?void 0:a.spa_code,fromNativeBroker:!1}]}}))}))},e}(),zt=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.includeRedirectUri=!0,n}return _(t,e),t.prototype.getAuthCodeUrl=function(e){var t,r;return E(this,void 0,void 0,(function(){var n;return S(this,(function(o){switch(o.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.GetAuthCodeUrl,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return n=o.sent(),[2,yt.appendQueryString(this.authority.authorizationEndpoint,n)]}}))}))},t.prototype.acquireToken=function(e,t){var r,n,o,i,s,a;return E(this,void 0,void 0,(function(){var c,g,y,v,w,_,b=this;return S(this,(function(E){switch(E.label){case 0:if(!e||!e.code)throw we.createTokenRequestCannotBeMadeError();return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.AuthClientAcquireToken,e.correlationId),c=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),g=xe.nowSeconds(),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return y=E.sent(),v=null===(i=y.headers)||void 0===i?void 0:i[I.X_MS_REQUEST_ID],(w=null===(s=y.headers)||void 0===s?void 0:s[I.X_MS_HTTP_VERSION])&&(null==c||c.addStaticFields({httpVerAuthority:w})),(_=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(y.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(dt.HandleServerTokenResponse,e.correlationId),[2,_.handleServerTokenResponse(y.body,this.authority,g,e,t,void 0,void 0,void 0,v).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw b.logger.verbose("Error in fetching token in ACC",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new yt(e),o=yt.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw we.createNoAuthCodeInServerResponseError();return b(b({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw Se.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return yt.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){var r,n;return E(this,void 0,void 0,(function(){var o,i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.AuthClientExecuteTokenRequest,t.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.AuthClientCreateTokenRequestBody,t.correlationId),o=this.createTokenQueryParameters(t),i=yt.appendQueryString(e.tokenEndpoint,o),[4,this.createTokenRequestBody(t)];case 1:if(s=v.sent(),a=void 0,t.clientInfo)try{c=Ie(t.clientInfo,this.cryptoUtils),a={credential:""+c.uid+K.CLIENT_INFO_SEPARATOR+c.utid,type:Ae.HOME_ACCOUNT_ID}}catch(w){this.logger.verbose("Could not parse client info for CCS Header: "+w)}return g=this.createTokenRequestHeaders(a||t.ccsCredential),y={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(i,s,g,y)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r;return E(this,void 0,void 0,(function(){var n,o,i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthClientCreateTokenRequestBody,e.correlationId),(n=new qt).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):xt.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,n.addClientAssertion(o.assertion),n.addClientAssertionType(o.assertionType)),n.addGrantType(H.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme!==$.POP?[3,2]:(i=new Bt(this.cryptoUtils,this.performanceClient),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.PopTokenGenerateCnf,e.correlationId),[4,i.generateCnf(e)]);case 1:return s=v.sent(),n.addPopToken(s.reqCnfString),[3,3];case 2:if(e.authenticationScheme===$.SSH){if(!e.sshJwk)throw Se.createMissingSshJwkError();n.addSshJwk(e.sshJwk)}v.label=3;case 3:if(a=e.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(a),(!Ce.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),c=void 0,e.clientInfo)try{g=Ie(e.clientInfo,this.cryptoUtils),c={credential:""+g.uid+K.CLIENT_INFO_SEPARATOR+g.utid,type:Ae.HOME_ACCOUNT_ID}}catch(w){this.logger.verbose("Could not parse client info for CCS Header: "+w)}else c=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case Ae.HOME_ACCOUNT_ID:try{g=ke(c.credential),n.addCcsOid(g)}catch(w){this.logger.verbose("Could not parse home account ID for CCS Header: "+w)}break;case Ae.UPN:n.addCcsUpn(c.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[R.RETURN_SPA_CODE]||n.addExtraQueryParameters(((y={})[R.RETURN_SPA_CODE]="1",y)),[2,n.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return E(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return S(this,(function(g){switch(g.label){case 0:if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthClientCreateQueryString,e.correlationId),(r=new qt).addClientId(this.config.authOptions.clientId),n=T(e.scopes||[],e.extraScopesToConsent||[]),r.addScopes(n),r.addRedirectUri(e.redirectUri),o=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(o),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==L.SELECT_ACCOUNT)if(e.sid&&e.prompt===L.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){if(i=this.extractAccountSid(e.account),s=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(s);try{a=ke(e.account.homeAccountId),r.addCcsOid(a)}catch(y){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===L.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(i);try{a=ke(e.account.homeAccountId),r.addCcsOid(a)}catch(y){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{a=ke(e.account.homeAccountId),r.addCcsOid(a)}catch(y){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(!Ce.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(r.addNativeBroker(),e.authenticationScheme!==$.POP?[3,2]:[4,new Bt(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:c=g.sent(),r.addPopToken(c.reqCnfHash),g.label=2;case 2:return[2,r.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new qt;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},t.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},t}(Lt);function Vt(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}var Yt,Jt={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},Zt={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};!function(e){e.AAD="AAD",e.OIDC="OIDC"}(Yt||(Yt={}));var Xt,Qt,$t=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,o,i,s;return E(this,void 0,void 0,(function(){var a,c,g,y,v;return S(this,(function(w){switch(w.label){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(dt.RegionDiscoveryDetectRegion,this.correlationId),a=t)return[3,8];c=e.IMDS_OPTIONS,w.label=1;case 1:return w.trys.push([1,6,,7]),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(N.IMDS_VERSION,c)];case 2:return(g=w.sent()).status===ne.httpSuccess&&(a=g.body,r.region_source=oe.IMDS),g.status!==ne.httpBadRequest?[3,5]:(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(dt.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(c)]);case 3:return(y=w.sent())?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(dt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(y,c)]):(r.region_source=oe.FAILED_AUTO_DETECTION,[2,null]);case 4:(v=w.sent()).status===ne.httpSuccess&&(a=v.body,r.region_source=oe.IMDS),w.label=5;case 5:return[3,7];case 6:return w.sent(),r.region_source=oe.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=oe.ENVIRONMENT_VARIABLE,w.label=9;case 9:return a||(r.region_source=oe.FAILED_AUTO_DETECTION),[2,a||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return E(this,void 0,void 0,(function(){return S(this,(function(n){return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(N.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,N.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return E(this,void 0,void 0,(function(){var r;return S(this,(function(n){switch(n.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(N.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===ne.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),er=function(){function e(e,t,r,n,o,i,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=i,this.correlationId=s,this.regionDiscovery=new $t(t,this.performanceClient,this.correlationId)}return Object.defineProperty(e.prototype,"authorityType",{get:function(){if(this.canonicalAuthorityUrlComponents.HostNameAndPort.endsWith(N.CIAM_AUTH_URL))return ge.Ciam;var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length)switch(e[0].toLowerCase()){case N.ADFS:return ge.Adfs;case N.DSTS:return ge.Dsts}return ge.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new yt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw we.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(e)}throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new yt(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===ge.Adfs||this.authorityType===ge.Dsts||this.protocolMode===Yt.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e,t,r;return E(this,void 0,void 0,(function(){var n,o,i,s;return S(this,(function(a){switch(a.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(dt.AuthorityResolveEndpointsAsync,this.correlationId),(n=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(n=new Fe).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(dt.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(n)];case 1:return o=a.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(n)];case 2:return i=a.sent(),o!==V.CACHE&&i!==V.CACHE&&(n.resetExpiresAt(),n.updateCanonicalAuthority(this.canonicalAuthority)),s=this.cacheManager.generateAuthorityMetadataCacheKey(n.preferred_cache),this.cacheManager.setAuthorityMetadata(s,n),this.metadata=n,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,r,n,o,i,s;return E(this,void 0,void 0,(function(){var a,c;return S(this,(function(g){switch(g.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthorityUpdateEndpointMetadata,this.correlationId),(a=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(a,!1),[2,V.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,V.CACHE]:(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(a=g.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(a)]):[3,3]:[3,4];case 2:a=g.sent(),g.label=3;case 3:return e.updateEndpointMetadata(a,!0),[2,V.NETWORK];case 4:return!(c=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(dt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(c)]):[3,6];case 5:c=g.sent(),g.label=6;case 6:return e.updateEndpointMetadata(c,!1),[2,V.HARDCODED_VALUES];case 7:throw we.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new yt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Se.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return E(this,void 0,void 0,(function(){var t,r;return S(this,(function(n){switch(n.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(dt.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,Vt((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in Jt?Jt[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var r,n,o,i,s,a,c;return E(this,void 0,void 0,(function(){var g,y;return S(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata)];case 1:return g=v.sent(),y=(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)===N.AZURE_REGION_AUTO_DISCOVER_FLAG?g:null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion,(null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.azureRegion)===N.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=g?se.AUTO_DETECTION_REQUESTED_SUCCESSFUL:se.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=g?(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.azureRegion)===g?se.CONFIGURED_MATCHES_DETECTED:se.CONFIGURED_NOT_DETECTED:se.CONFIGURED_NO_AUTO_DETECTION,y?(this.regionDiscoveryMetadata.region_used=y,[2,e.replaceWithRegionalInformation(t,y)]):[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t,r;return E(this,void 0,void 0,(function(){var n,o,i;return S(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||N.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||N.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||N.NOT_APPLICABLE)),(n=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(n,!1),[2,V.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),o=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found metadata in the cache."),[2,V.CACHE]):(o&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(n=s.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(n,!0),[2,V.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(i=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(i,!1),[2,V.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Se.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===ge.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(n){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Se.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return E(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g;return S(this,(function(y){switch(y.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+N.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},o=null,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(i=y.sent(),s=void 0,a=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(i.body))s=i.body,a=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+i.status),(s=i.body).error===N.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=e.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return(c=y.sent())instanceof ye?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+c.errorCode+"\nError Description: "+c.errorMessage):(g=c,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+g.name+"\nError Description: "+g.message)),[2,null];case 4:return o||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),o=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,o]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in Zt?Zt[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return yt.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==Et.None){var n=t.tenant?t.tenant:N.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw we.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return N.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new yt(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+N.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=yt.constructAuthorityUriFromObject(b(b({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?s+"?"+r:s},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,N.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e.transformCIAMAuthority=function(e){var t=e,r=new yt(e).getUrlComponents();0===r.PathSegments.length&&r.HostNameAndPort.endsWith(N.CIAM_AUTH_URL)&&(t=""+t+r.HostNameAndPort.split(".")[0]+N.AAD_TENANT_DOMAIN_SUFFIX);return t},e}(),tr=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o,i,s,a){return E(this,void 0,void 0,(function(){var c,g,y;return S(this,(function(v){switch(v.label){case 0:null==s||s.addQueueMeasurement(dt.AuthorityFactoryCreateDiscoveredInstance,a),c=er.transformCIAMAuthority(t),g=e.createInstance(c,r,n,o,i,s,a),v.label=1;case 1:return v.trys.push([1,3,,4]),null==s||s.setPreQueueTime(dt.AuthorityResolveEndpointsAsync,a),[4,g.resolveEndpointsAsync()];case 2:return v.sent(),[2,g];case 3:throw y=v.sent(),we.createEndpointDiscoveryIncompleteError(y);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,o,i,s){if(Ce.isEmpty(e))throw Se.createUrlEmptyError();return new er(e,t,r,n,o,i,s)},e}(),rr=function(){function e(e,t){this.cacheOutcome=ae.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||N.EMPTY_STRING,this.wrapperVer=e.wrapperVer||N.EMPTY_STRING,this.telemetryCacheKey=ee.CACHE_KEY+K.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+ee.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(ee.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(ee.VALUE_SEPARATOR);return[ee.SCHEMA_VERSION,r,t].join(ee.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(ee.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(ee.VALUE_SEPARATOR),i=t.errors.length,s=[i,r<i?ee.OVERFLOW_TRUE:ee.OVERFLOW_FALSE].join(ee.VALUE_SEPARATOR);return[ee.SCHEMA_VERSION,t.cacheHits,n,o,s].join(ee.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=ee.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),Ce.isEmpty(e.subError)?Ce.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(ee.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new He;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new He;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||N.EMPTY_STRING,s=e.failedRequests[2*t+1]||N.EMPTY_STRING,a=e.errors[t]||N.EMPTY_STRING;if(!((n+=i.toString().length+s.toString().length+a.length+3)<ee.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||N.EMPTY_STRING),e.push(this.regionSource||N.EMPTY_STRING),e.push(this.regionOutcome||N.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),nr="@azure/msal-browser",or="2.35.0",ir=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o;return g(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:We.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?et.createGetRequestFailedError(n,e):et.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),et.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i;return g(this,(function(s){switch(s.label){case 0:r=t&&t.body||N.EMPTY_STRING,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:We.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=s.sent(),[3,4];case 3:throw o=s.sent(),window.navigator.onLine?et.createPostRequestFailedError(o,e):et.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=s.sent(),i.status=n.status,i)];case 6:throw s.sent(),et.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),sr=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.sendRequestAsync(e,We.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.sendRequestAsync(e,We.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),n.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===We.POST?i(et.createPostRequestFailedError("Failed with status "+s.status,e)):i(et.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),a={headers:n.getHeaderDict(s),body:r,status:s.status};o(a)}catch(c){i(et.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===We.POST?i(et.createPostRequestFailedError("Failed with status "+s.status,e)):i(et.createGetRequestFailedError("Failed with status "+s.status,e)):i(et.createNoNetworkConnectivityError())},t===We.POST&&r&&r.body)s.send(r.body);else{if(t!==We.GET)throw et.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),ar=function(){function e(){}return e.clearHash=function(e){e.location.hash=N.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,N.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):N.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(tt.POPUP_NAME_PREFIX+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new yt(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new ir:new sr},e.blockReloadInHiddenIframes=function(){if(yt.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw et.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===Ze.Redirect&&n&&!r)throw et.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw et.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw et.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw et.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),cr=function(){function e(e,t,r,n,o,i,s,a,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=a,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=n.clone(tt.MSAL_SKU,or,this.correlationId),this.performanceClient=s}return e.prototype.clearCacheOnLogout=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];Re.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Re.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o;return g(this,(function(i){switch(i.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=v(e&&e.scopes||[]),(n=s(s({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(n.authenticationScheme===$.SSH){if(!e.sshJwk)throw Se.createMissingSshJwkError();if(!e.sshKid)throw Se.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}else n.authenticationScheme=$.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||Ce.isEmpty(e.claims)?[3,2]:(o=n,[4,this.browserCrypto.hashString(e.claims)]);case 1:o.requestedClaimsHash=i.sent(),i.label=2;case 2:return[2,n]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||ar.getCurrentUri();return yt.getAbsoluteUrl(t,ar.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new rr(r,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,tr.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,tr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}}))}))},e}(),ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=s(s({},e),{redirectUri:e.redirectUri,code:N.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=N.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=s({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=yt.getAbsoluteUrl(e.postLogoutRedirectUri,ar.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=yt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ar.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=yt.getAbsoluteUrl(ar.getCurrentUri(),ar.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return c(this,void 0,void 0,(function(){var n;return g(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new zt(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o;return g(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=i.sent(),o=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:tt.MSAL_SKU,version:or,cpu:N.EMPTY_STRING,os:N.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw et.createHashDoesNotContainStateError();var n=vt.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw et.createUnableToParseStateError();if(n.interactionType!==t)throw et.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return c(this,void 0,void 0,(function(){var n,o,i,s;return g(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,s=er.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(dt.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,tr.createDiscoveredInstance(s,this.config.system.networkClient,this.browserStorage,o,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,a.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i,a,c,y;return g(this,(function(g){switch(g.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=De.setRequestState(this.browserCrypto,e&&e.state||N.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(dt.InitializeBaseRequest,this.correlationId),a=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=s.apply(void 0,[s.apply(void 0,a.concat([g.sent()])),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:j.FRAGMENT}]),(c=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+c.homeAccountId,this.correlationId),i.account=c),Ce.isEmpty(i.loginHint)&&!c&&(y=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=y),[2,i]}}))}))},t}(cr),lr=function(){function e(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i,s;return g(this,(function(a){if(this.performanceClient.addQueueMeasurement(dt.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),Ce.isEmpty(e))throw et.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw we.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,i)}catch(c){throw c instanceof Nt&&c.subError===$e.userCancelledError.code?et.createUserCancelledError():c}return this.performanceClient.setPreQueueTime(dt.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(s,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,o){return void 0===o&&(o=!0),c(this,void 0,void 0,(function(){var i,s,a,c,y,v;return g(this,(function(g){switch(g.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw we.createStateNotFoundError("Cached State");return a=this.browserStorage.generateNonceKey(s),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(dt.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];case 1:g.sent(),g.label=2;case 2:return o&&(e.nonce=c||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(y=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=y),this.performanceClient.setPreQueueTime(dt.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return v=g.sent(),this.browserStorage.cleanRequestByState(t),[2,v]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o;return g(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(dt.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,tr.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(ze.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),dr=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r,n,o,s)||this;return a.browserCrypto=i,a}return i(t,e),t.prototype.initiateAuthRequest=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(n.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),Ce.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ze.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(ze.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:Je.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return n.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),et.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i,s,a,c,y,v;return g(this,(function(g){switch(g.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),Ce.isEmpty(e))throw et.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw we.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,i)}catch(w){throw w instanceof Nt&&w.subError===$e.userCancelledError.code?et.createUserCancelledError():w}return a=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,n)]:[3,2];case 1:g.sent(),g.label=2;case 2:return s.nonce=c||void 0,s.state=i,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(y=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=y),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return v=g.sent(),this.browserStorage.cleanRequestByState(t),[2,v]}}))}))},t}(lr);!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Xt||(Xt={})),function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(Qt||(Qt={}));var hr={code:"ContentError"},pr={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},fr={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},gr=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=o,i}return i(t,e),t.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==Qt.PERSISTENT_ERROR&&this.ext.status!==Qt.DISABLED)||this.errorCode===hr.code},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case Qt.ACCOUNT_UNAVAILABLE:return Kt.createNativeAccountUnavailableError();case Qt.USER_INTERACTION_REQUIRED:return new Kt(e,r);case Qt.USER_CANCEL:return et.createUserCancelledError();case Qt.NO_NETWORK:return et.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(pr.code,pr.desc)},t.createTokensNotFoundInCacheError=function(){return new t(fr.code,fr.desc)},t}(ye),mr=function(e){function t(t,r){return e.call(this,t,r)||this}return _(t,e),t.prototype.acquireToken=function(e){var t,r,n,o,i,s,a;return E(this,void 0,void 0,(function(){var c,g,y,v,w,_,b=this;return S(this,(function(E){switch(E.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RefreshTokenClientAcquireToken,e.correlationId),c=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),g=xe.nowSeconds(),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return y=E.sent(),v=null===(o=y.headers)||void 0===o?void 0:o[I.X_MS_HTTP_VERSION],null==c||c.addStaticFields({refreshTokenSize:(null===(i=y.body.refresh_token)||void 0===i?void 0:i.length)||0}),v&&(null==c||c.addStaticFields({httpVerToken:v})),w=null===(s=y.headers)||void 0===s?void 0:s[I.X_MS_REQUEST_ID],(_=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(y.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(dt.HandleServerTokenResponse,e.correlationId),[2,_.handleServerTokenResponse(y.body,this.authority,g,e,void 0,void 0,!0,e.forceCache,w).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw b.logger.verbose("Error in fetching refresh token",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,r,n,o;return E(this,void 0,void 0,(function(){var i,s;return S(this,(function(a){if(!e)throw Se.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw we.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(c){if(i=c instanceof Kt&&c.errorCode===Ft.noTokensFoundError.code,s=c instanceof Nt&&c.errorCode===pe&&c.subError===fe,i||s)return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw c}return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var r,n,o;return E(this,void 0,void 0,(function(){var i,s,a;return S(this,(function(c){if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),!(s=this.cacheManager.getRefreshToken(e.account,t)))throw null==i||i.discardMeasurement(),Kt.createNoTokensFoundError();return null==i||i.endMeasurement({success:!0}),a=b(b({},e),{refreshToken:s.secret,authenticationScheme:e.authenticationScheme||$.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Ae.HOME_ACCOUNT_ID}}),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(a)]}))}))},t.prototype.executeTokenRequest=function(e,t){var r,n,o;return E(this,void 0,void 0,(function(){var i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.RefreshTokenClientExecuteTokenRequest,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(dt.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RefreshTokenClientCreateTokenRequestBody,e.correlationId),s=this.createTokenQueryParameters(e),a=yt.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(e)];case 1:return c=v.sent(),g=this.createTokenRequestHeaders(e.ccsCredential),y={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(a,c,g,y).then((function(e){return null==i||i.endMeasurement({success:!0}),e})).catch((function(e){throw null==i||i.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r,n;return E(this,void 0,void 0,(function(){var o,i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RefreshTokenClientCreateTokenRequestBody,e.correlationId),o=e.correlationId,i=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.BaseClientCreateTokenRequestHeaders,o),(s=new qt).addClientId(this.config.authOptions.clientId),s.addScopes(e.scopes),s.addGrantType(H.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&s.addServerTelemetry(this.serverTelemetryManager),s.addCorrelationId(o),s.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(a=this.config.clientCredentials.clientAssertion,s.addClientAssertion(a.assertion),s.addClientAssertionType(a.assertionType)),e.authenticationScheme!==$.POP?[3,2]:(c=new Bt(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.PopTokenGenerateCnf,e.correlationId),[4,c.generateCnf(e)]);case 1:return g=v.sent(),s.addPopToken(g.reqCnfString),[3,3];case 2:if(e.authenticationScheme===$.SSH){if(!e.sshJwk)throw null==i||i.endMeasurement({success:!1}),Se.createMissingSshJwkError();s.addSshJwk(e.sshJwk)}v.label=3;case 3:if((!Ce.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Ae.HOME_ACCOUNT_ID:try{y=ke(e.ccsCredential.credential),s.addCcsOid(y)}catch(w){this.logger.verbose("Could not parse home account ID for CCS Header: "+w)}break;case Ae.UPN:s.addCcsUpn(e.ccsCredential.credential)}return null==i||i.endMeasurement({success:!0}),[2,s.createQueryString()]}}))}))},t}(Lt),yr=function(e){function t(t,r){return e.call(this,t,r)||this}return _(t,e),t.prototype.acquireToken=function(e){return E(this,void 0,void 0,(function(){var t;return S(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof we&&t.errorCode===ve.tokenRefreshRequired.code)return[2,new mr(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return E(this,void 0,void 0,(function(){var i,s;return S(this,(function(a){switch(a.label){case 0:if(!e)throw Se.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(ae.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),we.createRefreshRequiredError();if(!e.account)throw we.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(s=this.cacheManager.readCacheRecord(e.account,e,i)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(ae.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),we.createRefreshRequiredError();if(xe.wasClockTurnedBack(s.accessToken.cachedAt)||xe.isTokenExpired(s.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(ae.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),we.createRefreshRequiredError();if(s.accessToken.refreshOn&&xe.isTokenExpired(s.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(ae.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),we.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(s,e)];case 1:return[2,a.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return E(this,void 0,void 0,(function(){var r,n;return S(this,(function(o){switch(o.label){case 0:if(e.idToken&&(r=new Pe(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null==r?void 0:r.claims.auth_time))throw we.createAuthTimeNotFoundError();Pe.checkMaxAge(n,t.maxAge)}return[4,Wt.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}}))}))},t}(Lt),vr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i;return g(this,(function(s){switch(s.label){case 0:return t=this.performanceClient.startMeasurement(dt.SilentCacheClientAcquireToken,e.correlationId),r=this.initializeServerTelemetryManager(Je.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,e.authority,e.azureCloudOptions)];case 1:n=s.sent(),this.logger.verbose("Silent auth client created"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,n.acquireCachedToken(e)];case 3:return o=s.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,o];case 4:throw(i=s.sent())instanceof et&&i.errorCode===$e.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:i instanceof ye&&i.errorCode||void 0,subErrorCode:i instanceof ye&&i.subError||void 0,success:!1}),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return c(this,void 0,void 0,(function(){var n;return g(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new yr(n,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(dt.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(dt.InitializeBaseRequest,this.correlationId),r=[s({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,s.apply(void 0,[s.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(ur),wr=function(e){function t(t,r,n,o,i,s,a,c,g,y,v,w){var _=e.call(this,t,r,n,o,i,s,c,g,w)||this;return _.apiId=a,_.accountId=y,_.nativeMessageHandler=g,_.nativeStorageManager=v,_.silentCacheClient=new vr(t,_.nativeStorageManager,n,o,i,s,c,g,w),_}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s,a;return g(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(dt.NativeInteractionClientAcquireToken,e.correlationId),r=xe.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return o=c.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,o];case 4:return c.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:Be.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return s=c.sent(),a=this.validateNativeResponse(s),[2,this.handleNativeResponse(a,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Te.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return c(this,void 0,void 0,(function(){var r,n;return g(this,(function(o){switch(o.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),we.createNoAccountFoundError();if(!(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw we.createNoAccountFoundError();o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.createSilentCacheRequest(t,r),[4,this.silentCacheClient.acquireToken(n)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s;return g(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=a.sent(),r={method:Be.GetToken,request:t},a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return n=a.sent(),this.validateNativeResponse(n),[3,5];case 4:if((o=a.sent())instanceof gr&&o.isFatal())throw o;return[3,5];case 5:return this.browserStorage.setTemporaryCache(ze.NATIVE_REQUEST,JSON.stringify(t),!0),i={apiId:Je.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(s,i)];case 6:return a.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return c(this,void 0,void 0,(function(){var e,t,r,n,o,i,s,c;return g(this,(function(g){switch(g.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,r=a(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ze.NATIVE_REQUEST)),n={method:Be.GetToken,request:r},o=xe.nowSeconds(),g.label=1;case 1:return g.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return i=g.sent(),this.validateNativeResponse(i),s=this.handleNativeResponse(i,r,o),this.browserStorage.setInteractionInProgress(!1),[2,s];case 3:throw c=g.sent(),this.browserStorage.setInteractionInProgress(!1),c;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o,i,s,a,c;return g(this,(function(g){switch(g.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw gr.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return n=g.sent(),o=n.getPreferredCache(),i=this.createIdTokenObj(e),s=this.createHomeAccountIdentifier(e,i),a=this.createAccountEntity(e,s,i,o),[4,this.generateAuthenticationResult(e,t,i,a,n.canonicalAuthority,r)];case 2:return c=g.sent(),this.cacheAccount(a),this.cacheNativeTokens(e,t,s,i,c.accessToken,c.tenantId,r),[2,c]}}))}))},t.prototype.createIdTokenObj=function(e){return new Pe(e.id_token||N.EMPTY_STRING,this.browserCrypto)},t.prototype.createHomeAccountIdentifier=function(e,t){return Re.generateHomeAccountId(e.client_info||N.EMPTY_STRING,ge.Default,this.logger,this.browserCrypto,t)},t.prototype.createAccountEntity=function(e,t,r,n){return Re.createAccount(e.client_info,t,r,void 0,void 0,void 0,n,e.account.id)},t.prototype.generateScopes=function(e,t){return e.scope?Te.fromString(e.scope):Te.fromString(t.scope)},t.prototype.generatePopAccessToken=function(e,t){return c(this,void 0,void 0,(function(){var r,n;return g(this,(function(o){switch(o.label){case 0:if(t.tokenType!==$.POP)return[3,2];if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,e.shr];if(r=new Bt(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw we.createKeyIdMissingError();return[4,r.signPopToken(e.access_token,t.keyId,n)];case 1:return[2,o.sent()];case 2:return[2,e.access_token]}}))}))},t.prototype.generateAuthenticationResult=function(e,t,r,n,o,i){return c(this,void 0,void 0,(function(){var s,a,c,y,v,w,_;return g(this,(function(g){switch(g.label){case 0:return s=this.addTelemetryFromNativeResponse(e),a=e.scope?Te.fromString(e.scope):Te.fromString(t.scope),c=e.account.properties||{},y=c.UID||r.claims.oid||r.claims.sub||N.EMPTY_STRING,v=c.TenantId||r.claims.tid||N.EMPTY_STRING,[4,this.generatePopAccessToken(e,t)];case 1:return w=g.sent(),_=t.tokenType===$.POP?$.POP:$.BEARER,[2,{authority:o,uniqueId:y,tenantId:v,scopes:a.asArray(),account:n.getAccountInfo(),idToken:e.id_token,idTokenClaims:r.claims,accessToken:w,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:_,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}]}}))}))},t.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},t.prototype.cacheNativeTokens=function(e,t,r,n,o,i,s){var a=be.createIdTokenEntity(r,t.authority,e.id_token||N.EMPTY_STRING,t.clientId,n.claims.tid||N.EMPTY_STRING);this.nativeStorageManager.setIdTokenCredential(a);var c=s+(t.tokenType===$.POP?N.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),g=this.generateScopes(e,t),y=qe.createAccessTokenEntity(r,t.authority,o,t.clientId,i,g.printScopes(),c,0,this.browserCrypto);this.nativeStorageManager.setAccessTokenCredential(y)},t.prototype.addTelemetryFromNativeResponse=function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw gr.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,c,y,v,w,_=this;return g(this,(function(g){switch(g.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,(r=new yt(t)).validateAsUri(),n=e.scopes,o=a(e,["scopes"]),(i=new Te(n||[])).appendScopes(U),c=function(){switch(_.apiId){case Je.ssoSilent:case Je.acquireTokenSilent_silentFlow:return _.logger.trace("initializeNativeRequest: silent request sets prompt to none"),L.NONE}if(e.prompt)switch(e.prompt){case L.NONE:case L.CONSENT:case L.LOGIN:return _.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw _.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),et.createNativePromptParameterNotSupportedError()}else _.logger.trace("initializeNativeRequest: prompt was not provided")},y=s(s({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:c(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:s(s(s({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:ot}),extendedExpiryToken:!1}),e.authenticationScheme!==$.POP?[3,2]:(v={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new Bt(this.browserCrypto).generateCnf(v)]);case 1:w=g.sent(),y.reqCnf=w.reqCnfHash,y.keyId=w.kid,g.label=2;case 2:return[2,y]}}))}))},t}(cr),_r=function(){function e(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(dt.NativeMessageHandlerHandshake)}return e.prototype.sendMessage=function(e){return c(this,void 0,void 0,(function(){var t,r=this;return g(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:rt,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},e.createProvider=function(t,r,n){return c(this,void 0,void 0,(function(){var o,i;return g(this,(function(s){switch(s.label){case 0:t.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),[4,(o=new e(t,r,n,nt)).sendHandshakeRequest()];case 2:return s.sent(),[2,o];case 3:return s.sent(),[4,(i=new e(t,r,n)).sendHandshakeRequest()];case 4:return s.sent(),[2,i];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return c(this,void 0,void 0,(function(){var e,t=this;return g(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:rt,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Be.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(et.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===rt&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Be.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),r.reject(et.createNativeExtensionNotInstalledError()))}}},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if(o===Be.Response){if(!r)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(i)),"Success"!==i.status)r.reject(gr.createError(i.code,i.description,i.ext));else{if(!i.result)throw ye.createUnexpectedError("Event does not contain result.");i.result.code&&i.result.description?r.reject(gr.createError(i.result.code,i.result.description,i.result.ext)):r.resolve(i.result)}this.resolvers.delete(t.responseId)}else if(o===Be.HandshakeResponse){if(!n)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(s){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+s.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(s):n&&n.reject(s)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case $.BEARER:case $.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),br=function(e){function t(t,r,n,o,i,s,a,c,g,y){var v=e.call(this,t,r,n,o,i,s,a,g,y)||this;return v.nativeStorage=c,v}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,y,v,w=this;return g(this,(function(g){switch(g.label){case 0:return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ze.Redirect)];case 1:t=g.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||N.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(Je.acquireTokenRedirect),n=function(e){e.persisted&&(w.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),w.browserStorage.cleanRequestByState(t.state))},g.label=2;case 2:return g.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return o=g.sent(),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return i=g.sent(),this.logger.verbose("Auth code client created"),a=new dr(i,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),[4,i.getAuthCodeUrl(s(s({},t),{nativeBroker:_r.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return c=g.sent(),y=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+y),window.addEventListener("pageshow",n),[4,a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:y,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,g.sent()];case 7:throw(v=g.sent())instanceof ye&&v.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),r.cacheFailedRequest(v),this.browserStorage.cleanRequestByState(t.state),v;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,y,v,w,_;return g(this,(function(g){switch(g.label){case 0:t=this.initializeServerTelemetryManager(Je.handleRedirectPromise),g.label=1;case 1:if(g.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Ze.Redirect),[2,null];n=void 0;try{o=yt.getDeserializedHash(r),n=this.validateAndExtractStateFromHash(o,Ze.Redirect),this.logger.verbose("State extracted from hash")}catch(b){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+b),this.browserStorage.cleanRequestByInteractionType(Ze.Redirect),[2,null]}return i=this.browserStorage.getTemporaryCache(ze.ORIGIN_URI,!0)||N.EMPTY_STRING,s=yt.removeHashFromUrl(i),a=yt.removeHashFromUrl(window.location.href),s===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return c=g.sent(),i.indexOf("#")>-1&&ar.replaceHash(i),[2,c];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return ar.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(ze.URL_HASH,r,!0),y={apiId:Je.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},v=!0,i&&"null"!==i?[3,6]:(w=ar.getHomepage(),this.browserStorage.setTemporaryCache(ze.ORIGIN_URI,w,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(w,y)]));case 5:return v=g.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+i),[4,this.navigationClient.navigateInternal(i,y)];case 7:v=g.sent(),g.label=8;case 8:if(!v)return[2,this.handleHash(r,n,t)];g.label=9;case 9:return[2,null];case 10:throw(_=g.sent())instanceof ye&&_.setCorrelationId(this.correlationId),t.cacheFailedRequest(_),this.browserStorage.cleanRequestByInteractionType(Ze.Redirect),_;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),yt.hashContainsKnownProperties(e))return ar.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(ze.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ze.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o,i,a,c,y,v=this;return g(this,(function(g){switch(g.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(o=yt.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw et.createNativeConnectionNotEstablishedError();return i=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,o.accountId,this.browserStorage,n.correlationId),a=De.parseRequestState(this.browserCrypto,t).userRequestState,[2,i.acquireToken(s(s({},n),{state:a,prompt:void 0})).finally((function(){v.browserStorage.cleanRequestByState(t)}))]}if(!(c=this.browserStorage.getCachedAuthority(t)))throw et.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(r,c)];case 1:return y=g.sent(),this.logger.verbose("Auth code client created"),Ut.removeThrottle(this.browserStorage,this.config.auth.clientId,n),[4,new dr(y,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,y.authority,this.networkClient)];case 2:return[2,g.sent()]}}))}))},t.prototype.logout=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s;return g(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Je.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(Xt.LOGOUT_START,Ze.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),n={apiId:Je.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(Xt.LOGOUT_SUCCESS,Ze.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return a.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(s=a.sent())instanceof ye&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.eventHandler.emitEvent(Xt.LOGOUT_FAILURE,Ze.Redirect,null,s),this.eventHandler.emitEvent(Xt.LOGOUT_END,Ze.Redirect),s;case 11:return this.eventHandler.emitEvent(Xt.LOGOUT_END,Ze.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return yt.getAbsoluteUrl(t,ar.getCurrentUri())},t}(ur),Er=function(e){function t(t,r,n,o,i,s,a,c,g,y){var v=e.call(this,t,r,n,o,i,s,a,g,y)||this;return v.unloadWindow=v.unloadWindow.bind(v),v.nativeStorage=c,v}return i(t,e),t.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||U,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}catch(o){return Promise.reject(o)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var s=this.openSizedPopup("about:blank",r,i);return this.logoutPopupAsync(t,r,i,n,s,o)}catch(a){return Promise.reject(a)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i,a,c,y,v,w,_,b,E,S,T,I,k,A,R,O=this;return g(this,(function(g){switch(g.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(Je.acquireTokenPopup),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ze.Popup)];case 1:i=g.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||N.EMPTY_STRING,i.account||null),g.label=2;case 2:return g.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return a=g.sent(),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(o,i.authority,i.azureCloudOptions)];case 4:return c=g.sent(),this.logger.verbose("Auth code client created"),y=_r.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),v=void 0,y&&(v=this.performanceClient.startMeasurement(dt.FetchAccountIdWithNativeBroker,e.correlationId)),[4,c.getAuthCodeUrl(s(s({},i),{nativeBroker:y}))];case 5:return w=g.sent(),_=new lr(c,this.browserStorage,a,this.logger,this.performanceClient),b={popup:n,popupName:t,popupWindowAttributes:r},E=this.initiateAuthRequest(w,b),this.eventHandler.emitEvent(Xt.POPUP_OPENED,Ze.Popup,{popupWindow:E},null),[4,this.monitorPopupForHash(E)];case 6:if(S=g.sent(),T=yt.getDeserializedHash(S),I=this.validateAndExtractStateFromHash(T,Ze.Popup,i.correlationId),Ut.removeThrottle(this.browserStorage,this.config.auth.clientId,a),T.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),v&&v.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw et.createNativeConnectionNotEstablishedError();return k=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,T.accountId,this.nativeStorage,i.correlationId),A=De.parseRequestState(this.browserCrypto,I).userRequestState,[2,k.acquireToken(s(s({},i),{state:A,prompt:void 0})).finally((function(){O.browserStorage.cleanRequestByState(I)}))]}return[4,_.handleCodeResponseFromHash(S,I,c.authority,this.networkClient)];case 7:return[2,g.sent()];case 8:throw R=g.sent(),n&&n.close(),R instanceof ye&&R.setCorrelationId(this.correlationId),o.cacheFailedRequest(R),this.browserStorage.cleanRequestByState(i.state),R;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,o,i){return c(this,void 0,void 0,(function(){var s,a,c,y,v,w,_;return g(this,(function(g){switch(g.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Xt.LOGOUT_START,Ze.Popup,e),s=this.initializeServerTelemetryManager(Je.logoutPopup),g.label=1;case 1:return g.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return g.sent(),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(s,n)];case 3:return a=g.sent(),this.logger.verbose("Auth code client created"),c=a.getLogoutUri(e),this.eventHandler.emitEvent(Xt.LOGOUT_SUCCESS,Ze.Popup,e),y=this.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:o}),this.eventHandler.emitEvent(Xt.POPUP_OPENED,Ze.Popup,{popupWindow:y},null),[4,this.waitForLogoutPopup(y)];case 4:return g.sent(),i?(v={apiId:Je.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},w=yt.getAbsoluteUrl(i,ar.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+w),this.navigationClient.navigateInternal(w,v)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw _=g.sent(),o&&o.close(),_ instanceof ye&&_.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Xt.LOGOUT_FAILURE,Ze.Popup,null,_),this.eventHandler.emitEvent(Xt.LOGOUT_END,Ze.Popup),s.cacheFailedRequest(_),_;case 6:return this.eventHandler.emitEvent(Xt.LOGOUT_END,Ze.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(Ce.isEmpty(e))throw this.logger.error("Navigate url is empty"),et.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var o=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,i=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var s=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(s),void n(et.createUserCancelledError());var a=N.EMPTY_STRING,c=N.EMPTY_STRING;try{a=e.location.href,c=e.location.hash}catch(g){}Ce.isEmpty(a)||"about:blank"===a||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i++,c?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(s),t.cleanPopup(e),yt.hashContainsKnownProperties(c)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(c)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+c),n(et.createHashDoesNotContainKnownPropertiesError()))):i>o&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(s),n(et.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var o=N.EMPTY_STRING;try{o=e.location.href}catch(i){}Ce.isEmpty(o)||"about:blank"===o||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw et.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),et.createPopupWindowError(n.toString())}},t.prototype.openSizedPopup=function(e,t,r){var n,o,i,s,a=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,g=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,y=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,v=null===(n=r.popupSize)||void 0===n?void 0:n.width,w=null===(o=r.popupSize)||void 0===o?void 0:o.height,_=null===(i=r.popupPosition)||void 0===i?void 0:i.top,b=null===(s=r.popupPosition)||void 0===s?void 0:s.left;return(!v||v<0||v>g)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),v=tt.POPUP_WIDTH),(!w||w<0||w>y)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),w=tt.POPUP_HEIGHT),(!_||_<0||_>y)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),_=Math.max(0,y/2-tt.POPUP_HEIGHT/2+c)),(!b||b<0||b>g)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),b=Math.max(0,g/2-tt.POPUP_WIDTH/2+a)),window.open(e,t,"width="+v+", height="+w+", top="+_+", left="+b+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(Ze.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return tt.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return tt.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},t}(ur),Sr={sendGetRequestAsync:function(){return Promise.reject(ye.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ye.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},Cr=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),Tr=6e3;var Ir,kr=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r,n,o,s)||this;return a.navigateFrameWait=i.navigateFrameWait,a.pollIntervalMilliseconds=i.pollIntervalMilliseconds,a}return i(t,e),t.prototype.initiateAuthRequest=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),Ce.isEmpty(e))throw this.logger.info("Navigate url is empty"),et.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(dt.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(dt.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,o){t<Tr&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Tr+"ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(s),void o(et.createMonitorIframeTimeoutError());var t=N.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:N.EMPTY_STRING}catch(g){}if(!Ce.isEmpty(t)){var c=a?a.location.hash:N.EMPTY_STRING;return yt.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(s),void n(c)):void 0}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(dt.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(lr),Ar=function(e){function t(t,r,n,o,i,s,a,c,g,y,v){var w=e.call(this,t,r,n,o,i,s,c,y,v)||this;return w.apiId=a,w.nativeStorage=g,w}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i;return g(this,(function(a){switch(a.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(dt.SilentIframeClientAcquireToken,e.correlationId),Ce.isEmpty(e.loginHint)&&Ce.isEmpty(e.sid)&&(!e.account||Ce.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==L.NONE&&e.prompt!==L.NO_SESSION)throw t.endMeasurement({success:!1}),et.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(s(s({},e),{prompt:e.prompt||L.NONE}),Ze.Silent)];case 1:r=a.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||N.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(dt.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(o,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,a.sent()];case 5:throw(i=a.sent())instanceof ye&&i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:i instanceof ye&&i.errorCode||void 0,subErrorCode:i instanceof ye&&i.subError||void 0,success:!1}),i;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i,a,c,y,v,w,_=this;return g(this,(function(g){switch(g.label){case 0:return this.performanceClient.addQueueMeasurement(dt.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=g.sent(),this.performanceClient.setPreQueueTime(dt.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(s(s({},t),{nativeBroker:_r.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return n=g.sent(),o=new kr(e,this.browserStorage,r,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(dt.SilentHandlerInitiateAuthRequest,t.correlationId),[4,o.initiateAuthRequest(n)];case 3:return i=g.sent(),this.performanceClient.setPreQueueTime(dt.SilentHandlerMonitorIframeForHash,t.correlationId),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 4:if(a=g.sent(),c=yt.getDeserializedHash(a),y=this.validateAndExtractStateFromHash(c,Ze.Silent,r.correlationId),c.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw et.createNativeConnectionNotEstablishedError();return v=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,c.accountId,this.browserStorage,this.correlationId),w=De.parseRequestState(this.browserCrypto,y).userRequestState,[2,v.acquireToken(s(s({},t),{state:w,prompt:t.prompt||L.NONE})).finally((function(){_.browserStorage.cleanRequestByState(y)}))]}return this.performanceClient.setPreQueueTime(dt.HandleCodeResponseFromHash,t.correlationId),[2,o.handleCodeResponseFromHash(a,y,e.authority,this.networkClient)]}}))}))},t}(ur),Rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return g(this,(function(c){switch(c.label){case 0:return this.performanceClient.addQueueMeasurement(dt.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(dt.InitializeBaseRequest,e.correlationId),r=[s({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=s.apply(void 0,r.concat([c.sent()])),n=this.performanceClient.startMeasurement(dt.SilentRefreshClientAcquireToken,t.correlationId),o=this.initializeServerTelemetryManager(Je.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(o,t.authority,t.azureCloudOptions)];case 2:return i=c.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(dt.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,i.acquireTokenByRefreshToken(t).then((function(e){return n.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof ye&&e.setCorrelationId(a.correlationId),o.cacheFailedRequest(e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return c(this,void 0,void 0,(function(){var n;return g(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new mr(n,this.performanceClient)]}}))}))},t}(ur),Pr=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!Re.isAccountEntity(r))return;var n=Ue.toObject(new Re,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Xt.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Xt.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),Or={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},Nr={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Ur=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,t.prototype),o}return _(t,e),t.createMissingKidError=function(){return new t(Or.code,Or.desc)},t.createMissingAlgError=function(){return new t(Nr.code,Nr.desc)},t}(ye),Mr=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw Ur.createMissingKidError();if(!t.alg)throw Ur.createMissingAlgError();var r=new e({typ:t.typ||ce.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)},e}(),xr=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),qr=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,xr.decimalToHex(e[0])+xr.decimalToHex(e[1])+xr.decimalToHex(e[2])+xr.decimalToHex(e[3])+"-"+xr.decimalToHex(e[4])+xr.decimalToHex(e[5])+"-"+xr.decimalToHex(e[6])+xr.decimalToHex(e[7])+"-"+xr.decimalToHex(e[8])+xr.decimalToHex(e[9])+"-"+xr.decimalToHex(e[10])+xr.decimalToHex(e[11])+xr.decimalToHex(e[12])+xr.decimalToHex(e[13])+xr.decimalToHex(e[14])+xr.decimalToHex(e[15])}catch(s){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o=N.EMPTY_STRING,i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Lr=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t=N.EMPTY_STRING,r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),jr=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,N.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,N.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Lr.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=N.EMPTY_STRING,n=void 0,o=e.length,i=0,s=0;s<o;s++)n=s%3,i|=e[s]<<(16>>>n&24),2!==n&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Hr=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Lr.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,N.EMPTY_STRING),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),s=void 0,a=void 0,c=0,g=0,y=0;y<n;y++)if(a=3&y,c|=this.b64ToUint6(r.charCodeAt(y))<<18-6*a,3===a||n-y==1){for(s=0;s<3&&g<o;s++,g++)i[g]=c>>>(16>>>s&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Fr=function(){function e(e){this.base64Encode=new jr,this.cryptoObj=e}return e.prototype.generateCodes=function(){return c(this,void 0,void 0,(function(){var e,t;return g(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(t){throw et.createPkceNotGeneratedError(t)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),et.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),Kr=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,window.crypto.subtle.exportKey(at,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return c(this,void 0,void 0,(function(){return g(this,(function(o){return[2,window.crypto.subtle.importKey(at,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),Dr=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(v(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,window.msrCrypto.subtle.exportKey(at,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return c(this,void 0,void 0,(function(){return g(this,(function(o){return[2,window.msrCrypto.subtle.importKey(at,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),Br=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.exportKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(at,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Lr.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,N.EMPTY_STRING).replace(/\n/g,N.EMPTY_STRING).replace(/\t/g,N.EMPTY_STRING).split(" ").join(N.EMPTY_STRING).replace("\0",N.EMPTY_STRING);try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i;return g(this,(function(s){return o=Lr.getSortedObjectString(e),i=Lr.stringToArrayBuffer(o),[2,new Promise((function(e,o){var s=window.msCrypto.subtle.importKey(at,i,t,r,n);s.addEventListener("complete",(function(t){e(t.target.result)})),s.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.digest=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Gr="SHA-256",Wr=new Uint8Array([1,0,1]),zr=function(){function e(e,t){var r,n;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Kr;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Br;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),et.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new Dr}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),ft.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Gr,modulusLength:2048,publicExponent:Wr}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=Lr.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Gr},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),Vr=function(){function e(){this.dbName=ut,this.version=1,this.tableName=lt,this.dbOpen=!1}return e.prototype.open=function(){return c(this,void 0,void 0,(function(){var e=this;return g(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(et.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return c(this,void 0,void 0,(function(){var t=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(et.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return c(this,void 0,void 0,(function(){var r=this;return g(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!r.db)return o(et.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(){r.closeConnection(),n()})),i.addEventListener("error",(function(e){r.closeConnection(),o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return c(this,void 0,void 0,(function(){var t=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(et.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){t.closeConnection(),r()})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return c(this,void 0,void 0,(function(){var e=this;return g(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(et.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){var n=r;e.closeConnection(),t(n.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return c(this,void 0,void 0,(function(){var t=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(et.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(1===n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(ut);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Yr=function(){function e(e,t){this.inMemoryCache=new mt,this.indexedDBCache=new Vr,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof et&&e.errorCode===$e.databaseUnavailable.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return c(this,void 0,void 0,(function(){var e,t;return g(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return c(this,void 0,void 0,(function(){var e,t;return g(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(Ir||(Ir={}));var Jr=function(){function e(e){this.logger=e,this.asymmetricKeys=new Yr(this.logger,Ir.asymmetricKeys),this.symmetricKeys=new Yr(this.logger,Ir.symmetricKeys)}return e.prototype.clear=function(){return c(this,void 0,void 0,(function(){var e;return g(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),Zr=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new zr(this.logger,r),this.b64Encode=new jr,this.b64Decode=new Hr,this.guidGenerator=new qr(this.browserCrypto),this.pkceGenerator=new Fr(this.browserCrypto),this.cache=new Jr(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return c(this,void 0,void 0,(function(){var n,o,i,s,a,c,y,v;return g(this,(function(g){switch(g.label){case 0:return n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return o=g.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=g.sent(),s={e:i.e,kty:i.kty,n:i.n},a=Lr.getSortedObjectString(s),[4,this.hashString(a)];case 3:return c=g.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return y=g.sent(),[4,this.browserCrypto.importJwk(y,!1,["sign"])];case 5:return v=g.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:v,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return g.sent(),n&&n.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.removeTokenBindingKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return c(this,void 0,void 0,(function(){var o,i,s,a,c,y,v,w,_,b,E,S,T;return g(this,(function(g){switch(g.label){case 0:return o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(dt.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(i=g.sent()))throw et.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return s=g.sent(),a=Lr.getSortedObjectString(s),c=this.b64Encode.urlEncode(JSON.stringify({kid:t})),y=Mr.getShrHeaderString({kid:c,alg:s.alg}),v=this.b64Encode.urlEncode(y),e.cnf={jwk:JSON.parse(a)},w=this.b64Encode.urlEncode(JSON.stringify(e)),_=v+"."+w,b=Lr.stringToArrayBuffer(_),[4,this.browserCrypto.sign(i.privateKey,b)];case 3:return E=g.sent(),S=this.b64Encode.urlEncodeArr(new Uint8Array(E)),T=_+"."+S,o&&o.endMeasurement({success:!0}),[2,T]}}))}))},e.prototype.hashString=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}(),Xr=function(){function e(e,t,r,n,o,i){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return bt},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r,n){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var o={eventName:e,queueTime:r,manuallyCompleted:n},i=this.queueMeasurements.get(t);if(i)i.push(o),this.queueMeasurements.set(t,i);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var s=[o];this.queueMeasurements.set(t,s)}this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r,n,o=this,i=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",i),this.logger.trace("PerformanceClient: Performance measurement started for "+e,i);var s=this.startPerformanceMeasuremeant(e,i);s.startMeasurement();var a={eventId:this.generateId(),status:ht.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:i,appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appVersion};return this.cacheEventByCorrelationId(a),{endMeasurement:function(e){return o.endMeasurement(b(b({},a),e),s)},discardMeasurement:function(){return o.discardMeasurements(a.correlationId)},addStaticFields:function(e){return o.addStaticFields(e,a.correlationId)},increment:function(e){return o.increment(e,a.correlationId)},measurement:s,event:a}},e.prototype.endMeasurement=function(e,t){var r,n,o=this,i=this.eventsByCorrelationId.get(e.correlationId);if(!i)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var s=e.eventId===i.eventId,a={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};s?(a=this.getQueueInfo(e.correlationId),this.discardCache(i.correlationId)):null===(r=i.incompleteSubMeasurements)||void 0===r||r.delete(e.eventId),null==t||t.endMeasurement();var c=null==t?void 0:t.flushMeasurement();if(!c)return this.logger.trace("PerformanceClient: Performance measurement not taken",i.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+c+" ms",e.correlationId),!s)return i[e.name+"DurationMs"]=Math.floor(c),b({},i);var g=b(b({},i),e),y=0;return null===(n=g.incompleteSubMeasurements)||void 0===n||n.forEach((function(t){o.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,g.correlationId),y++})),g.incompleteSubMeasurements=void 0,g=b(b({},g),{durationMs:Math.round(c),queuedTimeMs:a.totalQueueTime,queuedCount:a.totalQueueCount,queuedManuallyCompletedCount:a.manuallyCompletedCount,status:ht.Completed,incompleteSubsCount:y}),this.truncateIntegralFields(g,this.getIntFields()),this.emitEvents([g],e.correlationId),g},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,b(b({},r),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var r=this.eventsByCorrelationId.get(t);if(r)for(var n in e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,b({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var r=0,n=0,o=0;return null==t||t.forEach((function(e){r+=e.queueTime,n++,o+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:o}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,o){r.logger.trace("PerformanceClient: Emitting event to callback "+o,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),Qr=function(){function e(t,r){this.correlationId=r,this.measureName=e.makeMeasureName(t,r),this.startMark=e.makeStartMark(t,r),this.endMark=e.makeEndMark(t,r)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,r){if(e.supportsBrowserPerformance())try{r.forEach((function(r){var n=e.makeMeasureName(r.name,t);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(e.makeStartMark(n,t)),window.performance.clearMarks(e.makeEndMark(n,t)))}))}catch(n){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(n){}return null},e}(),$r=function(e){function t(t,r,n,o,i,s,a){var c=e.call(this,t,r,n,o,i,s)||this;return c.browserCrypto=new zr(c.logger,a),c.guidGenerator=new qr(c.browserCrypto),c}return i(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new Qr(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),r=t&&t.eventId===e.event.eventId,n=[];r&&(null==t?void 0:t.incompleteSubMeasurements)&&t.incompleteSubMeasurements.forEach((function(e){n.push(s({},e))})),n.length>0&&Qr.flushMeasurements(e.event.correlationId,n)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,o=this.getPageVisibility(),i=e.prototype.startMeasurement.call(this,t,r);return s(s({},i),{endMeasurement:function(e){var t=i.endMeasurement(s({startPageVisibility:o,endPageVisibility:n.getPageVisibility()},e));return n.deleteIncompleteSubMeasurements(i),t},discardMeasurement:function(){i.discardMeasurement(),n.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+r.name+" found",t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r,n,o){if(this.supportsBrowserPerformanceNow())if(r){var i=e.prototype.getPreQueueTime.call(this,t,r);if(i){var s=window.performance.now(),a=n||e.prototype.calculateQueuedTime.call(this,i,s);return e.prototype.addQueueMeasurement.call(this,t,r,a,o)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(Xr),en=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new en},t.prototype.startPerformanceMeasurement=function(){return new en},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(Xr),rn=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw et.createUnableToLoadTokenError("Please ensure server response includes id token.");var n,o,i=new Pe(t.id_token,this.cryptoObj);if(e.account){var s=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new Dt(s,this.loadIdToken(i,s.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,s.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,s.homeAccountId,e.account.environment))}else{if(!e.authority)throw et.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var a=er.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(o=new er(a,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");s=this.loadAccount(i,o.hostnameAndPort,r.clientInfo,o.authorityType);n=new Dt(s,this.loadIdToken(i,s.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,s.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,s.homeAccountId,o.hostnameAndPort))}else{if(!t.client_info)throw et.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");s=this.loadAccount(i,o.hostnameAndPort,t.client_info,o.authorityType);n=new Dt(s,this.loadIdToken(i,s.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,s.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,s.homeAccountId,o.hostnameAndPort))}}return this.generateAuthenticationResult(e,i,n,o)},e.prototype.loadAccount=function(e,t,r,n,o){var i;if(o?i=o:void 0!==n&&r&&(i=Re.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!i)throw et.createUnableToLoadTokenError("Unexpected missing homeAccountId");var s=r?Re.createAccount(r,i,e,void 0,void 0,void 0,t):Re.createGenericAccount(i,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(s),s;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){var o=be.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(o),o;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw et.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw et.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new Te(e.scopes).printScopes(),a=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn,g=qe.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,s,a,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(g),g;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var o=Le.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(o),o;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var o,i,s,a,c=N.EMPTY_STRING,g=[],y=null;(null==r?void 0:r.accessToken)&&(c=r.accessToken.secret,g=Te.fromString(r.accessToken.target).asArray(),y=new Date(1e3*Number(r.accessToken.expiresOn)),a=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));var v=(null==t?void 0:t.claims.oid)||(null==t?void 0:t.claims.sub)||N.EMPTY_STRING,w=(null==t?void 0:t.claims.tid)||N.EMPTY_STRING;return{authority:n?n.canonicalAuthority:N.EMPTY_STRING,uniqueId:v,tenantId:w,scopes:g,account:(null==r?void 0:r.account)?r.account.getAccountInfo():null,idToken:t?t.rawToken:N.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:c,fromCache:!0,expiresOn:y,correlationId:e.correlationId||N.EMPTY_STRING,requestId:N.EMPTY_STRING,extExpiresOn:a,familyId:N.EMPTY_STRING,tokenType:(null===(o=null==r?void 0:r.accessToken)||void 0===o?void 0:o.tokenType)||N.EMPTY_STRING,state:N.EMPTY_STRING,cloudGraphHostName:(null===(i=null==r?void 0:r.account)||void 0===i?void 0:i.cloudGraphHostName)||N.EMPTY_STRING,msGraphHost:(null===(s=null==r?void 0:r.account)||void 0===s?void 0:s.msGraphHost)||N.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),nn=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return i(t,e),t}(zt),on=function(e){function t(t,r,n,o,i,s,a,c,g,y){var v=e.call(this,t,r,n,o,i,s,c,g,y)||this;return v.apiId=a,v}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a;return g(this,(function(c){switch(c.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw et.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ze.Silent)];case 1:t=c.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||N.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),c.label=2;case 2:return c.trys.push([2,4,,5]),n=s(s({},t),{code:e.code}),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(r,t.authority)];case 3:return o=c.sent(),i=new nn(o),this.logger.verbose("Auth code client created"),[2,new kr(i,this.browserStorage,n,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(a=c.sent())instanceof ye&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(t.state),a;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t}(ur),sn=function(){function e(e){var t,r,n;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,o=e.system,i=e.telemetry,a={clientId:N.EMPTY_STRING,authority:""+N.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:N.EMPTY_STRING,authorityMetadata:N.EMPTY_STRING,redirectUri:N.EMPTY_STRING,postLogoutRedirectUri:N.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Yt.AAD,azureCloudOptions:{azureCloudInstance:Et.None,tenant:N.EMPTY_STRING},skipAuthorityMetadataCache:!1},c={cacheLocation:Ge.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==Ge.LocalStorage)},g={loggerCallback:function(){},logLevel:_t.Info,piiLoggingEnabled:!1},y=s(s({},Ct),{loggerOptions:g,networkClient:t?ar.getBrowserNetworkClient():Sr,navigationClient:new Cr,loadFrameTimeout:0,windowHashTimeout:(null==o?void 0:o.loadFrameTimeout)||6e4,iframeHashTimeout:(null==o?void 0:o.loadFrameTimeout)||Tr,navigateFrameWait:t&&ar.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==o?void 0:o.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:tt.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),v=s(s({},o),{loggerOptions:(null==o?void 0:o.loggerOptions)||g}),w={application:{appName:N.EMPTY_STRING,appVersion:N.EMPTY_STRING}};return{auth:s(s({},a),r),cache:s(s({},c),n),system:s(s({},y),v),telemetry:s(s({},w),i)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new St(this.config.system.loggerOptions,nr,or),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new $r(this.config.auth.clientId,this.config.auth.authority,this.logger,nr,or,this.config.telemetry.application,this.config.system.cryptoOptions):new tn(this.config.auth.clientId,this.config.auth.authority,this.logger,nr,or,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Zr(this.logger,this.performanceClient,this.config.system.cryptoOptions):Qe,this.eventHandler=new Pr(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new wt(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(t=this.config.auth.clientId,r=this.logger,n={cacheLocation:Ge.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1},new wt(t,n,Qe,r));var o={cacheLocation:Ge.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1};this.nativeInternalStorage=new wt(this.config.auth.clientId,o,this.browserCrypto,this.logger),this.tokenCache=new rn(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return c(this,void 0,void 0,(function(){var e,t,r,n;return g(this,(function(o){switch(o.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(dt.InitializeClientApplication),this.eventHandler.emitEvent(Xt.INITIALIZE_START),!e)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this,[4,_r.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return r.nativeExtensionProvider=o.sent(),[3,4];case 3:return n=o.sent(),this.logger.verbose(n),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(Xt.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,y=this;return g(this,(function(g){return this.logger.verbose("handleRedirectPromise called"),ar.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||N.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(Xt.HANDLE_REDIRECT_START,Ze.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getCachedNativeRequest(),i=void 0,o&&_r.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId),i=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),a=this.browserStorage.getTemporaryCache(ze.CORRELATION_ID,!0)||N.EMPTY_STRING,c=this.createRedirectClient(a),i=c.handleRedirectPromise(e)),n=i.then((function(e){e&&(t.length<y.getAllAccounts().length?(y.eventHandler.emitEvent(Xt.LOGIN_SUCCESS,Ze.Redirect,e),y.logger.verbose("handleRedirectResponse returned result, login success")):(y.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_SUCCESS,Ze.Redirect,e),y.logger.verbose("handleRedirectResponse returned result, acquire token success")));return y.eventHandler.emitEvent(Xt.HANDLE_REDIRECT_END,Ze.Redirect),e})).catch((function(e){throw t.length>0?y.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_FAILURE,Ze.Redirect,null,e):y.eventHandler.emitEvent(Xt.LOGIN_FAILURE,Ze.Redirect,null,e),y.eventHandler.emitEvent(Xt.HANDLE_REDIRECT_END,Ze.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s=this;return g(this,(function(a){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(Ze.Redirect),(r=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_START,Ze.Redirect,e):this.eventHandler.emitEvent(Xt.LOGIN_START,Ze.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(o=new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),n=o.acquireTokenRedirect(e).catch((function(t){if(t instanceof gr&&t.isFatal())return s.nativeExtensionProvider=void 0,s.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof Kt)return s.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),s.createRedirectClient(e.correlationId).acquireToken(e);throw s.browserStorage.setInteractionInProgress(!1),t}))):(i=this.createRedirectClient(e.correlationId),n=i.acquireToken(e)),[2,n.catch((function(e){throw r?s.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_FAILURE,Ze.Redirect,null,e):s.eventHandler.emitEvent(Xt.LOGIN_FAILURE,Ze.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(dt.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(Ze.Popup)}catch(s){return Promise.reject(s)}var o,i=this.getAllAccounts();(i.length>0?this.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_START,Ze.Popup,e):this.eventHandler.emitEvent(Xt.LOGIN_START,Ze.Popup,e),this.canUseNative(e))?o=this.acquireTokenNative(e,Je.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),n.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(r){if(r instanceof gr&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(r instanceof Kt)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):o=this.createPopupClient(e.correlationId).acquireToken(e);return o.then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(Xt.LOGIN_SUCCESS,Ze.Popup,e):t.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_SUCCESS,Ze.Popup,e),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return i.length>0?t.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_FAILURE,Ze.Popup,null,e):t.eventHandler.emitEvent(Xt.LOGIN_FAILURE,Ze.Popup,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return c(this,void 0,void 0,(function(){var r,n,o,i,a=this;return g(this,(function(c){return r=this.getRequestCorrelationId(e),n=s(s({},e),{prompt:e.prompt,correlationId:r}),this.preflightBrowserEnvironmentCheck(Ze.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(dt.SsoSilent,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(Xt.SSO_SILENT_START,Ze.Silent,n),this.canUseNative(n)?o=this.acquireTokenNative(n,Je.ssoSilent).catch((function(e){if(e instanceof gr&&e.isFatal())return a.nativeExtensionProvider=void 0,a.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):(i=this.createSilentIframeClient(n.correlationId),o=i.acquireToken(n)),[2,o.then((function(e){var t,r;return a.eventHandler.emitEvent(Xt.SSO_SILENT_SUCCESS,Ze.Silent,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(r=a.ssoSilentMeasurement)||void 0===r||r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw a.eventHandler.emitEvent(Xt.SSO_SILENT_FAILURE,Ze.Silent,null,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",a.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i=this;return g(this,(function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Ze.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_BY_CODE_START,Ze.Silent,e),r=this.performanceClient.startMeasurement(dt.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw et.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return n=e.code,(o=this.hybridAuthCodeResponses.get(n))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(s(s({},e),{correlationId:t})).then((function(e){return i.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Ze.Silent,e),i.hybridAuthCodeResponses.delete(n),r.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw i.hybridAuthCodeResponses.delete(n),i.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ze.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(n,o)),[2,o];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,Je.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof gr&&e.isFatal()&&(i.nativeExtensionProvider=void 0),e}))];throw et.createUnableToAcquireTokenFromNativePlatformError()}throw et.createAuthCodeOrNativeAccountIdRequiredError()}catch(c){throw this.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ze.Silent,null,c),r.endMeasurement({errorCode:c instanceof ye&&c.errorCode||void 0,subErrorCode:c instanceof ye&&c.subError||void 0,success:!1}),c}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return c(this,void 0,void 0,(function(){var r=this;return g(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(dt.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){switch(this.performanceClient.addQueueMeasurement(dt.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case ct.Default:case ct.AccessToken:case ct.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw we.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(this.performanceClient.addQueueMeasurement(dt.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case ct.Default:case ct.AccessTokenAndRefreshToken:case ct.RefreshToken:case ct.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(dt.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw we.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return this.performanceClient.addQueueMeasurement(dt.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(dt.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(s({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Ze.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(Ze.Popup),this.createPopupClient(t).logout(e)}catch(r){return Promise.reject(r)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),ar.blockNonBrowserEnvironment(this.isBrowserEnvironment),ar.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),ar.blockReloadInHiddenIframes(),ar.blockAcquireTokenInPopups(),ar.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===Ze.Redirect&&this.config.cache.cacheLocation===Ge.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw ft.createInMemoryRedirectUnavailableError();e!==Ze.Redirect&&e!==Ze.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),ar.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw et.createNativeConnectionNotEstablishedError();return[2,new wr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!_r.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case L.NONE:case L.CONSENT:case L.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},e.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new Er(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new br(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new Ar(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new vr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new Rr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():N.EMPTY_STRING},e}(),an=function(e){function t(t){var r=e.call(this,t)||this;return r.astsAsyncMeasurement=void 0,r.activeSilentTokenRequests=new Map,r.trackPageVisibility=r.trackPageVisibility.bind(r),r}return i(t,e),t.prototype.loginRedirect=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(s({correlationId:t},e||st))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(s({correlationId:t},e||st))},t.prototype.acquireTokenSilent=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,y=this;return g(this,(function(g){if(t=this.getRequestCorrelationId(e),(r=this.performanceClient.startMeasurement(dt.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Ze.Silent),this.logger.verbose("acquireTokenSilent called",t),!(n=e.account||this.getActiveAccount()))throw et.createNoAccountError();return o={clientId:this.config.auth.clientId,authority:e.authority||N.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},i=JSON.stringify(o),void 0===(a=this.activeSilentTokenRequests.get(i))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(dt.AcquireTokenSilentAsync,t),c=this.acquireTokenSilentAsync(s(s({},e),{correlationId:t}),n).then((function(t){return y.activeSilentTokenRequests.delete(i),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t})).catch((function(e){throw y.activeSilentTokenRequests.delete(i),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(i,c),[2,c]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discardMeasurement(),[2,a])}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var r;return c(this,void 0,void 0,(function(){var n,o,i,a,y,v=this;return g(this,(function(w){switch(w.label){case 0:return this.performanceClient.addQueueMeasurement(dt.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_START,Ze.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(dt.AcquireTokenSilentAsync,e.correlationId),null===(r=this.astsAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),_r.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),o=s(s({},e),{account:t}),n=this.acquireTokenNative(o,Je.acquireTokenSilent_silentFlow).catch((function(t){return c(v,void 0,void 0,(function(){return g(this,(function(r){if(t instanceof gr&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),i=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(dt.InitializeSilentRequest,e.correlationId),[4,i.initializeSilentRequest(e,t)];case 2:a=w.sent(),y=s(s({},e),{cacheLookupPolicy:e.cacheLookupPolicy||ct.Default}),this.performanceClient.setPreQueueTime(dt.AcquireTokenFromCache,a.correlationId),n=this.acquireTokenFromCache(i,a,y).catch((function(t){if(y.cacheLookupPolicy===ct.AccessToken)throw t;return ar.blockReloadInHiddenIframes(),v.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_NETWORK_START,Ze.Silent,a),v.performanceClient.setPreQueueTime(dt.AcquireTokenByRefreshToken,a.correlationId),v.acquireTokenByRefreshToken(a,y).catch((function(t){var r=t instanceof Nt,n=t instanceof Kt,o=t.errorCode===tt.INVALID_GRANT_ERROR;if((!r||!o||n||y.cacheLookupPolicy===ct.AccessTokenAndRefreshToken||y.cacheLookupPolicy===ct.RefreshToken)&&y.cacheLookupPolicy!==ct.Skip)throw t;return v.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),v.performanceClient.setPreQueueTime(dt.AcquireTokenBySilentIframe,a.correlationId),v.acquireTokenBySilentIframe(a)}))})),w.label=3;case 3:return[2,n.then((function(e){var t;return v.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_SUCCESS,Ze.Silent,e),null===(t=v.astsAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw v.eventHandler.emitEvent(Xt.ACQUIRE_TOKEN_FAILURE,Ze.Silent,null,e),null===(t=v.astsAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",v.trackPageVisibility)}))]}}))}))},t}(sn),cn={initialize:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenPopup:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenRedirect:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenSilent:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenByCode:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},loginPopup:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},loginRedirect:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},logout:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},logoutRedirect:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},logoutPopup:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},ssoSilent:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},addEventCallback:function(){return null},removeEventCallback:function(){},addPerformanceCallback:function(){return""},removePerformanceCallback:function(){return!1},enableAccountStorageEvents:function(){},disableAccountStorageEvents:function(){},getTokenCache:function(){throw ft.createStubPcaInstanceCalledError()},getLogger:function(){throw ft.createStubPcaInstanceCalledError()},setLogger:function(){},setActiveAccount:function(){},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){},setNavigationClient:function(){},getConfiguration:function(){throw ft.createStubPcaInstanceCalledError()}},un=function(){function e(){}return e.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case Xt.LOGIN_START:return Xe.Login;case Xt.SSO_SILENT_START:return Xe.SsoSilent;case Xt.ACQUIRE_TOKEN_START:if(e.interactionType===Ze.Redirect||e.interactionType===Ze.Popup)return Xe.AcquireToken;break;case Xt.HANDLE_REDIRECT_START:return Xe.HandleRedirect;case Xt.LOGOUT_START:return Xe.Logout;case Xt.SSO_SILENT_SUCCESS:case Xt.SSO_SILENT_FAILURE:if(t&&t!==Xe.SsoSilent)break;return Xe.None;case Xt.LOGOUT_END:if(t&&t!==Xe.Logout)break;return Xe.None;case Xt.HANDLE_REDIRECT_END:if(t&&t!==Xe.HandleRedirect)break;return Xe.None;case Xt.LOGIN_SUCCESS:case Xt.LOGIN_FAILURE:case Xt.ACQUIRE_TOKEN_SUCCESS:case Xt.ACQUIRE_TOKEN_FAILURE:if(e.interactionType===Ze.Redirect||e.interactionType===Ze.Popup){if(t&&t!==Xe.Login&&t!==Xe.AcquireToken)break;return Xe.None}}return null},e}(),ln=function(){function e(e,t){var r=t&&t.loggerOptions||{};this.logger=new St(r,nr,or),this.cryptoOps=new Zr(this.logger),this.popTokenGenerator=new Bt(this.cryptoOps),this.shrParameters=e}return e.prototype.generatePublicKeyThumbprint=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return[2,e.sent().kid]}}))}))},e.prototype.signRequest=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)]}))}))},e.prototype.removeKeys=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}}))}))},e}(),dn=function(){function e(e){this.headers=e}return e.prototype.getShrNonce=function(){var e=this.headers[I.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw Se.createInvalidAuthenticationHeaderError(I.AuthenticationInfo,"nextnonce challenge is missing.")}var r=this.headers[I.WWWAuthenticate];if(r){var n=this.parseChallenges(r);if(n.nonce)return n.nonce;throw Se.createInvalidAuthenticationHeaderError(I.WWWAuthenticate,"nonce challenge is missing.")}throw Se.createMissingNonceAuthenticationHeadersError()},e.prototype.parseChallenges=function(e){var t=e.indexOf(" "),r=e.substr(t+1).split(","),n={};return r.forEach((function(e){var t=e.split("="),r=t[0],o=t[1];n[r]=unescape(o.replace(/['"]+/g,N.EMPTY_STRING))})),n},e}()},6986:(e,t,r)=>{"use strict";var n,o=Object.create,i=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,c=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,y=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of a(t))g.call(e,o)||o===r||i(e,o,{get:()=>t[o],enumerable:!(n=s(t,o))||n.enumerable});return e},v=(e,t,r)=>(r=null!=e?o(c(e)):{},y(!t&&e&&e.__esModule?r:i(r,"default",{value:e,enumerable:!0}),e)),w={};((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})(w,{AccessTokenEvents:()=>D,CheckSessionIFrame:()=>G,ErrorResponse:()=>F,ErrorTimeout:()=>K,InMemoryWebStorage:()=>W,Log:()=>R,Logger:()=>O,MetadataService:()=>Y,OidcClient:()=>ae,OidcClientSettingsStore:()=>X,SessionMonitor:()=>ce,SigninResponse:()=>oe,SigninState:()=>ne,SignoutResponse:()=>se,State:()=>re,User:()=>ue,UserManager:()=>be,UserManagerSettingsStore:()=>ye,Version:()=>Ee,WebStorageStateStore:()=>J}),e.exports=(n=w,y(i({},"__esModule",{value:!0}),n));var _,b,E,S=v(r(3724)),T=v(r(287)),I=v(r(4676)),k=v(r(7154)),A={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},R=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(R||{});(E=R||(R={})).reset=function(){_=3,b=A},E.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");_=e},E.setLogger=function(e){b=e};var O=class{constructor(e){this._name=e}debug(...e){_>=4&&b.debug(O._format(this._name,this._method),...e)}info(...e){_>=3&&b.info(O._format(this._name,this._method),...e)}warn(...e){_>=2&&b.warn(O._format(this._name,this._method),...e)}error(...e){_>=1&&b.error(O._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const r=new O(`${e}.${t}`);return r.debug("begin"),r}static _format(e,t){const r=`[${e}]`;return t?`${r} ${t}:`:r}static debug(e,...t){_>=4&&b.debug(O._format(e),...t)}static info(e,...t){_>=3&&b.info(O._format(e),...t)}static warn(e,...t){_>=2&&b.warn(O._format(e),...t)}static error(e,...t){_>=1&&b.error(O._format(e),...t)}};R.reset();var N=class{static _randomWord(){return S.default.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^N._randomWord()&15>>+e/4).toString(16))).replace(/-/g,"")}static generateCodeVerifier(){return N.generateUUIDv4()+N.generateUUIDv4()+N.generateUUIDv4()}static generateCodeChallenge(e){try{const t=(0,T.default)(e);return I.default.stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw O.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const r=k.default.parse([e,t].join(":"));return I.default.stringify(r)}},U=class{constructor(e){this._name=e,this._logger=new O(`Event('${this._name}')`),this._callbacks=[]}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}raise(...e){this._logger.debug("raise:",...e);for(const t of this._callbacks)t(...e)}},M=v(r(612)),q=class{static decode(e){try{return(0,M.default)(e)}catch(t){throw O.error("JwtUtils.decode",t),t}}},L=class{static center({...e}){var t;return null==e.width&&(e.width=null!=(t=[800,720,600,480].find((e=>e<=window.outerWidth/1.618)))?t:360),null!=e.left||(e.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-e.width)/2))),null!=e.height&&(null!=e.top||(e.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-e.height)/2)))),e}static serialize(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${e}=${"boolean"!=typeof t?t:t?"yes":"no"}`)).join(",")}},j=class extends U{constructor(){super(...arguments),this._logger=new O(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-j.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=j.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const r=j.getEpochTime()+e;if(this.expiration===r&&this._timerHandle)return void t.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),t.debug("using duration",e),this._expiration=r;const n=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*n)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},H=class{static readParams(e,t="query"){if(!e)throw new TypeError("Invalid URL");const r=new URL(e,window.location.origin)["fragment"===t?"hash":"search"];return new URLSearchParams(r.slice(1))}},F=class extends Error{constructor(e,t){var r,n,o;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw O.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(r=e.error_description)?r:null,this.error_uri=null!=(n=e.error_uri)?n:null,this.state=e.userState,this.session_state=null!=(o=e.session_state)?o:null}},K=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},D=class{constructor(e){this._logger=new O("AccessTokenEvents"),this._expiringTimer=new j("Access token expiring"),this._expiredTimer=new j("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){let e=r-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;t.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}},G=class{constructor(e,t,r,n,o){this._callback=e,this._client_id=t,this._intervalInSeconds=n,this._stopOnError=o,this._logger=new O("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const i=new URL(r);this._frame_origin=i.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=i.href}load(){return new Promise((e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)}))}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},W=class{constructor(){this._logger=new O("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create(`getItem('${e}')`),this._data[e]}setItem(e,t){this._logger.create(`setItem('${e}')`),this._data[e]=t}removeItem(e){this._logger.create(`removeItem('${e}')`),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},V=class{constructor(e=[],t=null){this._jwtHandler=t,this._logger=new O("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e,t={}){const{timeoutInSeconds:r,...n}=t;if(!r)return await fetch(e,n);const o=new AbortController,i=setTimeout((()=>o.abort()),1e3*r);try{return await fetch(e,{...t,signal:o.signal})}catch(s){if(s instanceof DOMException&&"AbortError"===s.name)throw new K("Network timed out");throw s}finally{clearTimeout(i)}}async getJson(e,{token:t,credentials:r}={}){const n=this._logger.create("getJson"),o={Accept:this._contentTypes.join(", ")};let i;t&&(n.debug("token passed, setting Authorization header"),o.Authorization="Bearer "+t);try{n.debug("url:",e),i=await this.fetchWithTimeout(e,{method:"GET",headers:o,credentials:r})}catch(c){throw n.error("Network Error"),c}n.debug("HTTP response received, status",i.status);const s=i.headers.get("Content-Type");if(s&&!this._contentTypes.find((e=>s.startsWith(e)))&&n.throw(new Error(`Invalid response Content-Type: ${null!=s?s:"undefined"}, from URL: ${e}`)),i.ok&&this._jwtHandler&&(null==s?void 0:s.startsWith("application/jwt")))return await this._jwtHandler(await i.text());let a;try{a=await i.json()}catch(c){if(n.error("Error parsing JSON response",c),i.ok)throw c;throw new Error(`${i.statusText} (${i.status})`)}if(!i.ok){if(n.error("Error from server:",a),a.error)throw new F(a);throw new Error(`${i.statusText} (${i.status}): ${JSON.stringify(a)}`)}return a}async postForm(e,{body:t,basicAuth:r,timeoutInSeconds:n,initCredentials:o}){const i=this._logger.create("postForm"),s={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};let a;void 0!==r&&(s.Authorization="Basic "+r);try{i.debug("url:",e),a=await this.fetchWithTimeout(e,{method:"POST",headers:s,body:t,timeoutInSeconds:n,credentials:o})}catch(v){throw i.error("Network error"),v}i.debug("HTTP response received, status",a.status);const c=a.headers.get("Content-Type");if(c&&!this._contentTypes.find((e=>c.startsWith(e))))throw new Error(`Invalid response Content-Type: ${null!=c?c:"undefined"}, from URL: ${e}`);const g=await a.text();let y={};if(g)try{y=JSON.parse(g)}catch(v){if(i.error("Error parsing JSON response",v),a.ok)throw v;throw new Error(`${a.statusText} (${a.status})`)}if(!a.ok){if(i.error("Error from server:",y),y.error)throw new F(y,t);throw new Error(`${a.statusText} (${a.status}): ${JSON.stringify(y)}`)}return y}},Y=class{constructor(e){this._settings=e,this._logger=new O("MetadataService"),this._jsonService=new V(["application/jwk-set+json"]),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,t),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(e=!0){return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(e=!0){return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(e=!0){return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e,t=!1){const r=this._logger.create(`_getMetadataProperty('${e}')`),n=await this.getMetadata();if(r.debug("resolved"),void 0===n[e]){if(!0===t)return void r.warn("Metadata does not contain optional property");r.throw(new Error("Metadata does not contain property "+e))}return n[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const r=await this._jsonService.getJson(t);if(e.debug("got key set",r),!Array.isArray(r.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}},J=class{constructor({prefix:e="oidc.",store:t=localStorage}={}){this._logger=new O("WebStorageStateStore"),this._store=t,this._prefix=e}async set(e,t){this._logger.create(`set('${e}')`),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create(`get('${e}')`),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create(`remove('${e}')`),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let r=0;r<e;r++){const e=await this._store.key(r);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}},X=class{constructor({authority:e,metadataUrl:t,metadata:r,signingKeys:n,metadataSeed:o,client_id:i,client_secret:s,response_type:a="code",scope:c="openid",redirect_uri:g,post_logout_redirect_uri:y,client_authentication:v="client_secret_post",prompt:w,display:_,max_age:b,ui_locales:E,acr_values:S,resource:T,response_mode:I="query",filterProtocolClaims:k=!0,loadUserInfo:A=!1,staleStateAgeInSeconds:R=900,clockSkewInSeconds:O=300,userInfoJwtIssuer:N="OP",mergeClaims:U=!1,disablePKCE:M=!1,stateStore:q,refreshTokenCredentials:L,revokeTokenAdditionalContentTypes:j,fetchRequestCredentials:H,refreshTokenAllowedScope:F,extraQueryParams:K={},extraTokenParams:D={}}){if(this.authority=e,t?this.metadataUrl=t:(this.metadataUrl=e,e&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=o,this.signingKeys=n,this.client_id=i,this.client_secret=s,this.response_type=a,this.scope=c,this.redirect_uri=g,this.post_logout_redirect_uri=y,this.client_authentication=v,this.prompt=w,this.display=_,this.max_age=b,this.ui_locales=E,this.acr_values=S,this.resource=T,this.response_mode=I,this.filterProtocolClaims=null==k||k,this.loadUserInfo=!!A,this.staleStateAgeInSeconds=R,this.clockSkewInSeconds=O,this.userInfoJwtIssuer=N,this.mergeClaims=!!U,this.disablePKCE=!!M,this.revokeTokenAdditionalContentTypes=j,H&&L&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=H||(L||"same-origin"),q)this.stateStore=q;else{const e="undefined"!=typeof window?window.localStorage:new W;this.stateStore=new J({store:e})}this.refreshTokenAllowedScope=F,this.extraQueryParams=K,this.extraTokenParams=D}},Q=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new O("TokenClient"),this._jsonService=new V(this._settings.revokeTokenAdditionalContentTypes)}async exchangeCode({grant_type:e="authorization_code",redirect_uri:t=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,...o}){const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),t||i.throw(new Error("A redirect_uri is required")),o.code||i.throw(new Error("A code is required"));const s=new URLSearchParams({grant_type:e,redirect_uri:t});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;a=N.generateBasicAuth(r,n);break;case"client_secret_post":s.append("client_id",r),n&&s.append("client_secret",n)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeCredentials({grant_type:e="password",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...o}){const i=this._logger.create("exchangeCredentials");t||i.throw(new Error("A client_id is required"));const s=new URLSearchParams({grant_type:e,scope:n});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=N.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeRefreshToken({grant_type:e="refresh_token",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,...o}){const i=this._logger.create("exchangeRefreshToken");t||i.throw(new Error("A client_id is required")),o.refresh_token||i.throw(new Error("A refresh_token is required"));const s=new URLSearchParams({grant_type:e});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=N.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async revoke(e){var t;const r=this._logger.create("revoke");e.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${null!=(t=e.token_type_hint)?t:"default token type"}`);const o=new URLSearchParams;for(const[i,s]of Object.entries(e))null!=s&&o.set(i,s);o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:o}),r.debug("got response")}},$=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],ee=["sub","iss","aud","exp","iat"],re=class{constructor(e){this.id=e.id||N.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=j.getEpochTime(),this.request_type=e.request_type}toStorageString(){return new O("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})}static fromStorageString(e){return O.createStatic("State","fromStorageString"),new re(JSON.parse(e))}static async clearStaleState(e,t){const r=O.createStatic("State","clearStaleState"),n=j.getEpochTime()-t,o=await e.getAllKeys();r.debug("got keys",o);for(let s=0;s<o.length;s++){const t=o[s],a=await e.get(t);let c=!1;if(a)try{const e=re.fromStorageString(a);r.debug("got item from key:",t,e.created),e.created<=n&&(c=!0)}catch(i){r.error("Error parsing state for key:",t,i),c=!0}else r.debug("no item in storage for key:",t),c=!0;c&&(r.debug("removed item for key:",t),e.remove(t))}}},ne=class extends re{constructor(e){super(e),!0===e.code_verifier?this.code_verifier=N.generateCodeVerifier():e.code_verifier&&(this.code_verifier=e.code_verifier),this.code_verifier&&(this.code_challenge=N.generateCodeChallenge(this.code_verifier)),this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}toStorageString(){return new O("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){O.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return new ne(t)}},oe=class{constructor(e){this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-j.getEpochTime()}set expires_in(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+j.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},se=class{constructor(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}},ae=class{constructor(e){this._logger=new O("OidcClient"),this.settings=new X(e),this.metadataService=new Y(this.settings),this._validator=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new O("ResponseValidator"),this._userInfoService=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new O("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const r=q.decode(e);return t.debug("JWT decoding successful"),r}catch(r){throw t.error("Error parsing JWT response"),r}},this._jsonService=new V(void 0,this._getClaimsFromJwt)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:e,credentials:this._settings.fetchRequestCredentials});return t.debug("got claims",n),n}}(this._settings,this._metadataService),this._tokenClient=new Q(this._settings,this._metadataService)}async validateSigninResponse(e,t){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const r=this._logger.create("validateCredentialsResponse");e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,t,e.isOpenId),r.debug("claims processed")}async validateRefreshResponse(e,t){const r=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),r.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const n=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,n),r.debug("claims processed")}validateSignoutResponse(e,t){const r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new F(e)}_processSigninState(e,t){const r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new F(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}async _processClaims(e,t=!1,r=!0){const n=this._logger.create("_processClaims");if(e.profile=this._filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void n.debug("not loading user info");n.debug("loading user info");const o=await this._userInfoService.getClaims(e.access_token);n.debug("user info claims received from user info endpoint"),r&&o.sub!==e.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._mergeClaims(e.profile,this._filterProtocolClaims(o)),n.debug("user info claims received, updated profile:",e.profile)}_mergeClaims(e,t){const r={...e};for(const[n,o]of Object.entries(t))for(const e of Array.isArray(o)?o:[o]){const t=r[n];t?Array.isArray(t)?t.includes(e)||t.push(e):r[n]!==e&&("object"==typeof e&&this._settings.mergeClaims?r[n]=this._mergeClaims(t,e):r[n]=[t,e]):r[n]=e}return r}_filterProtocolClaims(e){const t={...e};if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:$;for(const r of e)ee.includes(r)||delete t[r]}return t}async _processCode(e,t){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,...t.extraTokenParams});Object.assign(e,n)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const o=q.decode(null!=(r=e.id_token)?r:"");if(o.sub||n.throw(new Error("ID Token is missing a subject claim")),t){const e=q.decode(t);e.sub!==o.sub&&n.throw(new Error("sub in id_token does not match current sub")),e.auth_time&&e.auth_time!==o.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),e.azp&&e.azp!==o.azp&&n.throw(new Error("azp in id_token does not match original azp")),!e.azp&&o.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=o}}(this.settings,this.metadataService),this._tokenClient=new Q(this.settings,this.metadataService)}async createSigninRequest({state:e,request:t,request_uri:r,request_type:n,id_token_hint:o,login_hint:i,skipUserInfo:s,nonce:a,response_type:c=this.settings.response_type,scope:g=this.settings.scope,redirect_uri:y=this.settings.redirect_uri,prompt:v=this.settings.prompt,display:w=this.settings.display,max_age:_=this.settings.max_age,ui_locales:b=this.settings.ui_locales,acr_values:E=this.settings.acr_values,resource:S=this.settings.resource,response_mode:T=this.settings.response_mode,extraQueryParams:I=this.settings.extraQueryParams,extraTokenParams:k=this.settings.extraTokenParams}){const A=this._logger.create("createSigninRequest");if("code"!==c)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const R=await this.metadataService.getAuthorizationEndpoint();A.debug("Received authorization endpoint",R);const N=new class{constructor({url:e,authority:t,client_id:r,redirect_uri:n,response_type:o,scope:i,state_data:s,response_mode:a,request_type:c,client_secret:g,nonce:y,resource:v,skipUserInfo:w,extraQueryParams:_,extraTokenParams:b,disablePKCE:E,...S}){if(this._logger=new O("SigninRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!o)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!i)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!t)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new ne({data:s,request_type:c,code_verifier:!E,client_id:r,authority:t,redirect_uri:n,response_mode:a,client_secret:g,scope:i,extraTokenParams:b,skipUserInfo:w});const T=new URL(e);T.searchParams.append("client_id",r),T.searchParams.append("redirect_uri",n),T.searchParams.append("response_type",o),T.searchParams.append("scope",i),y&&T.searchParams.append("nonce",y),T.searchParams.append("state",this.state.id),this.state.code_challenge&&(T.searchParams.append("code_challenge",this.state.code_challenge),T.searchParams.append("code_challenge_method","S256")),v&&(Array.isArray(v)?v:[v]).forEach((e=>T.searchParams.append("resource",e)));for(const[I,k]of Object.entries({response_mode:a,...S,..._}))null!=k&&T.searchParams.append(I,k.toString());this.url=T.href}}({url:R,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:y,response_type:c,scope:g,state_data:e,prompt:v,display:w,max_age:_,ui_locales:b,id_token_hint:o,login_hint:i,acr_values:E,resource:S,request:t,request_uri:r,extraQueryParams:I,extraTokenParams:k,request_type:n,response_mode:T,client_secret:this.settings.client_secret,skipUserInfo:s,nonce:a,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const U=N.state;return await this.settings.stateStore.set(U.id,U.toStorageString()),N}async readSigninResponseState(e,t=!1){const r=this._logger.create("readSigninResponseState"),n=new oe(H.readParams(e,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:ne.fromStorageString(o),response:n}}async processSigninResponse(e){const t=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(e,!0);return t.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r=!1,extraTokenParams:n={}}){const o=await this._tokenClient.exchangeCredentials({username:e,password:t,...n}),i=new oe(new URLSearchParams);return Object.assign(i,o),await this._validator.validateCredentialsResponse(i,r),i}async useRefreshToken({state:e,timeoutInSeconds:t}){var r;const n=this._logger.create("useRefreshToken");let o;if(void 0===this.settings.refreshTokenAllowedScope)o=e.scope;else{const t=this.settings.refreshTokenAllowedScope.split(" ");o=((null==(r=e.scope)?void 0:r.split(" "))||[]).filter((e=>t.includes(e))).join(" ")}const i=await this._tokenClient.exchangeRefreshToken({refresh_token:e.refresh_token,scope:o,timeoutInSeconds:t}),s=new oe(new URLSearchParams);return Object.assign(s,i),n.debug("validating response",s),await this._validator.validateRefreshResponse(s,{...e,scope:o}),s}async createSignoutRequest({state:e,id_token_hint:t,request_type:r,post_logout_redirect_uri:n=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}={}){const i=this._logger.create("createSignoutRequest"),s=await this.metadataService.getEndSessionEndpoint();if(!s)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",s);const a=new class{constructor({url:e,state_data:t,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:o,request_type:i}){if(this._logger=new O("SignoutRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");const s=new URL(e);r&&s.searchParams.append("id_token_hint",r),n&&(s.searchParams.append("post_logout_redirect_uri",n),t&&(this.state=new re({data:t,request_type:i}),s.searchParams.append("state",this.state.id)));for(const[a,c]of Object.entries({...o}))null!=c&&s.searchParams.append(a,c.toString());this.url=s.href}}({url:s,id_token_hint:t,post_logout_redirect_uri:n,state_data:e,extraQueryParams:o,request_type:r});await this.clearStaleState();const c=a.state;return c&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(c.id,c.toStorageString())),a}async readSignoutResponseState(e,t=!1){const r=this._logger.create("readSignoutResponseState"),n=new se(H.readParams(e,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new F(n);return{state:void 0,response:n}}const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:re.fromStorageString(o),response:n}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(e,!0);return r?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):t.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),re.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}},ce=class{constructor(e){this._userManager=e,this._logger=new O("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const r=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,r.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,r.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){r.debug("initializing check session iframe");const n=this._userManager.settings.client_id,o=this._userManager.settings.checkSessionIntervalInSeconds,i=this._userManager.settings.stopCheckSessionOnError,s=new G(this._callback,n,e,o,i);await s.load(),this._checkSessionIFrame=s,s.start(t)}else r.warn("no check session iframe found in the metadata")}catch(n){r.error("Error from getCheckSessionIframe:",n instanceof Error?n.message:n)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval((async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}catch(r){e.error("error from querySessionStatus",r instanceof Error?r.message:r)}}),1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let r=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(r=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",t.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),r?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((e=>{this._logger.error(e)}))}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}}},ue=class{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-j.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+j.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new O("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return O.createStatic("User","fromStorageString"),new ue(JSON.parse(e))}},le="oidc-client",de=class{constructor(){this._abort=new U("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:r,keepOpen:n}=await new Promise(((r,n)=>{const o=o=>{var i;const s=o.data,a=null!=(i=e.scriptOrigin)?i:window.location.origin;if(o.origin===a&&(null==s?void 0:s.source)===le){try{const r=H.readParams(s.url,e.response_mode).get("state");if(r||t.warn("no state found in response url"),o.source!==this._window&&r!==e.state)return}catch(c){this._dispose(),n(new Error("Invalid response from window"))}r(s)}};window.addEventListener("message",o,!1),this._disposeHandlers.add((()=>window.removeEventListener("message",o,!1))),this._disposeHandlers.add(this._abort.addHandler((e=>{this._dispose(),n(e)})))}));return t.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t,r=!1,n=window.location.origin){e.postMessage({source:le,url:t,keepOpen:r},n)}},he={location:!1,toolbar:!1,height:640},pe="_blank",fe=60,ge=2,me=10,ye=class extends X{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:r=e.post_logout_redirect_uri,popupWindowFeatures:n=he,popupWindowTarget:o=pe,redirectMethod:i="assign",redirectTarget:s="self",iframeNotifyParentOrigin:a=e.iframeNotifyParentOrigin,iframeScriptOrigin:c=e.iframeScriptOrigin,silent_redirect_uri:g=e.redirect_uri,silentRequestTimeoutInSeconds:y=me,automaticSilentRenew:v=!0,validateSubOnSilentRenew:w=!0,includeIdTokenInSilentRenew:_=!1,monitorSession:b=!1,monitorAnonymousSession:E=!1,checkSessionIntervalInSeconds:S=ge,query_status_response_type:T="code",stopCheckSessionOnError:I=!0,revokeTokenTypes:k=["access_token","refresh_token"],revokeTokensOnSignout:A=!1,includeIdTokenInSilentSignout:R=!1,accessTokenExpiringNotificationTimeInSeconds:O=fe,userStore:N}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=o,this.redirectMethod=i,this.redirectTarget=s,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=c,this.silent_redirect_uri=g,this.silentRequestTimeoutInSeconds=y,this.automaticSilentRenew=v,this.validateSubOnSilentRenew=w,this.includeIdTokenInSilentRenew=_,this.monitorSession=b,this.monitorAnonymousSession=E,this.checkSessionIntervalInSeconds=S,this.stopCheckSessionOnError=I,this.query_status_response_type=T,this.revokeTokenTypes=k,this.revokeTokensOnSignout=A,this.includeIdTokenInSilentSignout=R,this.accessTokenExpiringNotificationTimeInSeconds=O,N)this.userStore=N;else{const e="undefined"!=typeof window?window.sessionStorage:new W;this.userStore=new J({store:e})}}},ve=class extends de{constructor({silentRequestTimeoutInSeconds:e=me}){super(),this._logger=new O("IFrameWindow"),this._timeoutInSeconds=e,this._frame=ve.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout((()=>this._abort.raise(new K("IFrame timed out without a response"))),1e3*this._timeoutInSeconds);return this._disposeHandlers.add((()=>clearTimeout(t))),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(e=>{var t;const r=e.target;null==(t=r.parentNode)||t.removeChild(r),this._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},we=class extends de{constructor({popupWindowTarget:e=pe,popupWindowFeatures:t={}}){super(),this._logger=new O("PopupWindow");const r=L.center({...he,...t});this._window=window.open(void 0,e,L.serialize(r))}async navigate(e){var t;null==(t=this._window)||t.focus();const r=setInterval((()=>{this._window&&!this._window.closed||this._abort.raise(new Error("Popup closed by user"))}),500);return this._disposeHandlers.add((()=>clearInterval(r))),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,t)}},_e=class extends D{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new O("UserManagerEvents"),this._userLoaded=new U("User loaded"),this._userUnloaded=new U("User unloaded"),this._silentRenewError=new U("Silent renew error"),this._userSignedIn=new U("User signed in"),this._userSignedOut=new U("User signed out"),this._userSessionChanged=new U("User session changed")}load(e,t=!0){super.load(e),t&&this._userLoaded.raise(e)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}_raiseSilentRenewError(e){this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},be=class{constructor(e){this._logger=new O("UserManager"),this.settings=new ye(e),this._client=new ae(e),this._redirectNavigator=new class{constructor(e){this._settings=e,this._logger=new O("RedirectNavigator")}async prepare({redirectMethod:e=this._settings.redirectMethod,redirectTarget:t=this._settings.redirectTarget}){var r;this._logger.create("prepare");let n=window.self;"top"===t&&(n=null!=(r=window.top)?r:window.self);const o=n.location[e].bind(n.location);let i;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise(((e,t)=>{i=t}));return o(e.url),await t},close:()=>{this._logger.create("close"),null==i||i(new Error("Redirect aborted")),n.stop()}}}}(this.settings),this._popupNavigator=new class{constructor(e){this._settings=e,this._logger=new O("PopupNavigator")}async prepare({popupWindowFeatures:e=this._settings.popupWindowFeatures,popupWindowTarget:t=this._settings.popupWindowTarget}){return new we({popupWindowFeatures:e,popupWindowTarget:t})}async callback(e,t=!1){this._logger.create("callback"),we.notifyOpener(e,t)}}(this.settings),this._iframeNavigator=new class{constructor(e){this._settings=e,this._logger=new O("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:e=this._settings.silentRequestTimeoutInSeconds}){return new ve({silentRequestTimeoutInSeconds:e})}async callback(e){this._logger.create("callback"),ve.notifyParent(e,this._settings.iframeNotifyParentOrigin)}}(this.settings),this._events=new _e(this.settings),this._silentRenewService=new class{constructor(e){this._userManager=e,this._logger=new O("SilentRenewService"),this._isStarted=!1,this._retryTimer=new j("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof K)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new ce(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),this._events.load(t,!1),t):(e.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),this._events.unload()}async signinRedirect(e={}){this._logger.create("signinRedirect");const{redirectMethod:t,...r}=e,n=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(e=window.location.href){const t=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(e);return r.profile&&r.profile.sub?t.info("success, signed in subject",r.profile.sub):t.info("no subject"),r}async signinResourceOwnerCredentials({username:e,password:t,skipUserInfo:r=!1}){const n=this._logger.create("signinResourceOwnerCredential"),o=await this._client.processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});n.debug("got signin response");const i=await this._buildUser(o);return i.profile&&i.profile.sub?n.info("success, signed in subject",i.profile.sub):n.info("no subject"),i}async signinPopup(e={}){const t=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_redirect_uri;i||t.throw(new Error("No popup_redirect_uri configured"));const s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),a=await this._signin({request_type:"si:p",redirect_uri:i,display:"popup",...o},s);return a&&(a.profile&&a.profile.sub?t.info("success, signed in subject",a.profile.sub):t.info("no subject")),a}async signinPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async signinSilent(e={}){var t;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,...o}=e;let i=await this._loadUser();if(null==i?void 0:i.refresh_token){r.debug("using refresh token");const e=new class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}}(i);return await this._useRefreshToken(e)}const s=this.settings.silent_redirect_uri;let a;s||r.throw(new Error("No silent_redirect_uri configured")),i&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",i.profile.sub),a=i.profile.sub);const c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return i=await this._signin({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,...o},c,a),i&&((null==(t=i.profile)?void 0:t.sub)?r.info("success, signed in subject",i.profile.sub):r.info("no subject")),i}async _useRefreshToken(e){const t=await this._client.useRefreshToken({state:e,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new ue({...e,...t});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(e=window.location.href){const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(e=window.location.href){const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":return await this.signinPopupCallback(e);case"si:s":return await this.signinSilentCallback(e);default:throw new Error("invalid response_type in state")}}async signoutCallback(e=window.location.href,t=!1){const{state:r}=await this._client.readSignoutResponseState(e);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(e);break;case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(e={}){const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=e,o=this.settings.silent_redirect_uri;o||t.throw(new Error("No silent_redirect_uri configured"));const i=await this._loadUser(),s=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),a=await this._signinStart({request_type:"si:s",redirect_uri:o,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},s);try{const e=await this._client.processSigninResponse(a.url);return t.debug("got signin response"),e.session_state&&e.profile.sub?(t.info("success for subject",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid}):(t.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof F)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:c.session_state}}throw c}}async _signin(e,t,r){const n=await this._signinStart(e,t);return await this._signinEnd(n.url,r)}async _signinStart(e,t){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(e);return r.debug("got signin request"),await t.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(n){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),n}}async _signinEnd(e,t){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(e);r.debug("got signin response");return await this._buildUser(n,t)}async _buildUser(e,t){const r=this._logger.create("_buildUser"),n=new ue(e);if(t){if(t!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new F({...e,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(e={}){const t=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=e,o=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},o),t.info("success")}async signoutRedirectCallback(e=window.location.href){const t=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(e);return t.info("success"),r}async signoutPopup(e={}){const t=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_post_logout_redirect_uri,s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:i,state:null==i?void 0:{},...o},s),t.info("success")}async signoutPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async _signout(e,t){const r=await this._signoutStart(e,t);return await this._signoutEnd(r.url)}async _signoutStart(e={},t){var r;const n=this._logger.create("_signoutStart");try{const o=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(o);const i=e.id_token_hint||o&&o.id_token;i&&(n.debug("setting id_token_hint in signout request"),e.id_token_hint=i),await this.removeUser(),n.debug("user removed, creating signout request");const s=await this._client.createSignoutRequest(e);return n.debug("got signout request"),await t.navigate({url:s.url,state:null==(r=s.state)?void 0:r.id})}catch(o){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),o}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(e);return t.debug("got signout response"),r}async signoutSilent(e={}){var t;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...o}=e,i=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,s=this.settings.popup_post_logout_redirect_uri,a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:s,id_token_hint:i,...o},a),r.info("success")}async signoutSilentCallback(e=window.location.href){const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e,t=this.settings.revokeTokenTypes){const r=this._logger.create("_revokeInternal");if(!e)return;const n=t.filter((t=>"string"==typeof e[t]));if(n.length){for(const t of n)await this._client.revokeToken(e[t],t),r.info(`${t} revoked successfully`),"access_token"!==t&&(e[t]=null);await this.storeUser(e),r.debug("user stored"),this._events.load(e)}else r.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),ue.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const r=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}},Ee="2.2.2"},4752:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AadService=void 0;const n=r(1110),o=r(676),i=r(9739),s=r(3797),a=r(1075),c=r(250),g=e=>0===Object.keys(e).length,y="@cognite/auth-react/aad-stored-account",v=e=>{localStorage.setItem(y,JSON.stringify(e))};t.AadService=class AadService{client;authority;redirectUri=`${window.location.origin}/signin`;storedAccount=(()=>{const e=localStorage.getItem(y);return e?JSON.parse(e):null})();constructor(e,t){this.client=(0,o.getPca)(e,t,this.redirectUri),this.authority=t,this.client.initialize()}handlePromiseSilent=async(e,t)=>{let r=e?.account;const o={scopes:["User.Read"]};if(this.storedAccount&&(o.account=this.storedAccount),t&&o.scopes?.push(...(0,n.getAadScopes)(t)),!r){r=(await this.client.ssoSilent(o)).account}const i={redirectUri:this.redirectUri,authority:this.authority,scopes:[]};if(t){const e=(0,n.getAadScopes)(t);i.scopes.push(...e)}return r&&(i.account=r,this.client.setActiveAccount(r),this.storedAccount=r,v(r)),await this.client.acquireTokenSilent(i)};handlePromiseRedirect=async e=>{const t=this.client.getActiveAccount(),r={prompt:"select_account",authority:this.authority,redirectUri:this.redirectUri,scopes:[]};if(e){const t=(0,n.getAadScopes)(e);r.scopes.push(...t)}return t&&(r.account=t,this.client.setActiveAccount(t),this.storedAccount=t,v(t)),await this.client.acquireTokenRedirect(r)};handlePromiseRedirectNoPrompt=async e=>{const t={prompt:"none",scopes:[]};if(e){const r=(0,n.getAadScopes)(e);t.scopes.push(...r)}return await this.client.loginRedirect(t)};acquireTokenSilent=async e=>{const t=await this.client.handleRedirectPromise().then((t=>this.handlePromiseSilent(t,e))).catch((()=>this.handlePromiseRedirectNoPrompt())),r=t?.accessToken;if(!r)throw new i.TokenInvalidError;return r};acquireTokenSilentOrRedirect=async e=>{const t=await this.client.handleRedirectPromise().then((t=>this.handlePromiseSilent(t,e))).catch((()=>this.handlePromiseRedirect(e))),r=t?.accessToken;if(!r)throw new i.TokenInvalidError;return r};getUser=async()=>{let e=this.client.getActiveAccount();if(!e){if(e=(await this.client.ssoSilent({scopes:["User.Read"]})).account,!e)throw new s.UserNotFoundError}const t={scopes:["User.Read"]};let r;if(e&&(t.account=e),e?.idTokenClaims&&!g(e?.idTokenClaims)&&(r=e?.idTokenClaims),!r){const e=await this.client.acquireTokenSilent(t);r=e?.idTokenClaims}if(!r||g(r))throw new s.UserNotFoundError;return{id:r?.oid||r?.sub,name:r?.name,email:r?.email||r?.preferred_username,preferred_username:r?.preferred_username}};redirectToConsent=async e=>{this.client.loginRedirect({scopes:["User.Read",...(0,n.getAadScopes)(e)],prompt:"consent"})};logout=async(e=!1)=>{const t=this.client.getActiveAccount()||this.storedAccount,r={account:t,postLogoutRedirectUri:(0,a.generateRedirectUri)(),onRedirectNavigate:()=>!1},n=t?.idTokenClaims?.login_hint;n&&(r.logoutHint=n),e&&(r.onRedirectNavigate=()=>!0),this.client.setActiveAccount(null),(0,c.clearLoginHints)(),this.client.logoutRedirect(r)}}},1110:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAadScopes=void 0;t.getAadScopes=e=>e?[`https://${e}/IDENTITY`,`https://${e}/user_impersonation`]:[]},676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPca=void 0;const n=r(8297);t.getPca=(e,t,r)=>{const o=new n.PublicClientApplication({auth:{clientId:e,authority:t,redirectUri:r},cache:{cacheLocation:"memoryStorage",storeAuthStateInCookie:!0}});return!o.getActiveAccount()&&o.getAllAccounts().length>0&&o.setActiveAccount(o.getAllAccounts()[0]),o.enableAccountStorageEvents(),o.addEventCallback((e=>{if(e.eventType===n.EventType.LOGIN_SUCCESS||e.eventType===n.EventType.SSO_SILENT_SUCCESS||e.eventType===n.EventType.ACQUIRE_TOKEN_SUCCESS||e.eventType===n.EventType.ACQUIRE_TOKEN_BY_CODE_SUCCESS){const{account:t}=e.payload;t&&o.setActiveAccount(t)}})),o}},8450:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPca=t.getAadScopes=t.AadService=void 0;var n=r(4752);Object.defineProperty(t,"AadService",{enumerable:!0,get:function(){return n.AadService}});var o=r(1110);Object.defineProperty(t,"getAadScopes",{enumerable:!0,get:function(){return o.getAadScopes}});var i=r(676);Object.defineProperty(t,"getPca",{enumerable:!0,get:function(){return i.getPca}})},5947:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Auth0Service=void 0;const n=r(8149),o=r(9739),i=r(3797),s=r(250),a=r(1075);t.Auth0Service=class Auth0Service{clientId;authority;audience;redirectUri=window.location.href;constructor(e,t,r){this.clientId=e,this.authority=t,r&&(this.audience=r)}getClient=async()=>{const e={domain:this.authority,clientId:this.clientId,authorizationParams:{audience:this.audience,redirect_uri:this.redirectUri}};return await(0,n.createAuth0Client)(e)};acquireTokenSilent=async()=>{const e=await this.getClient(),t=await e.getTokenSilently();if(!t)throw new o.TokenInvalidError;return t};acquireTokenSilentOrRedirect=async e=>{const t=await this.getClient();let r="";try{r=await t.getTokenSilently()}catch(n){console.error(n)}try{r||await t.loginWithRedirect()}catch{throw new o.TokenInvalidError}return r};getUser=async()=>{const e=await this.getClient();await e.getTokenSilently({detailedResponse:!0,authorizationParams:{scope:"openid profile email user_metadata",audience:this.audience}});const t=await e.getIdTokenClaims();if(!t)throw new i.UserNotFoundError;return{id:t?.sub,name:t?.name,preferred_username:t?.nickname,email:t?.email}};logout=async()=>{const e=await this.getClient();(0,s.clearLoginHints)(),await e.logout({logoutParams:{returnTo:(0,a.generateRedirectUri)()}})}}},1667:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Auth0Service=void 0;var n=r(5947);Object.defineProperty(t,"Auth0Service",{enumerable:!0,get:function(){return n.Auth0Service}})},7066:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CogniteIdpService=void 0;const n=r(6986),o=r(9739),i=r(1075),s=r(250);let a;t.CogniteIdpService=class CogniteIdpService{client;redirectUri=`${window.location.origin}/signin`;userManagerSettings;prefix;constructor(e,t,r){this.prefix=`oidc:state:${t}`,this.userManagerSettings={authority:t,client_id:e,redirect_uri:this.redirectUri,scope:"openid profile email offline",extraQueryParams:{audience:"https://cognitedata.com",...r&&{organization_hint:r}},userStore:new n.WebStorageStateStore({store:new n.InMemoryWebStorage,prefix:this.prefix})},this.client=new n.UserManager(this.userManagerSettings)}getTokenPromise=async()=>{if(a)return a;return a=(async()=>{try{let e=await this.client.getUser();e?.expired&&(e=await this.client.signinSilent());let t=e?.access_token;return t||(e=await this.client.signinRedirectCallback(),t=e?.access_token),t}catch(e){throw new o.TokenInvalidError}finally{this.client.clearStaleState()}})(),a.then((()=>{a=void 0})).catch((e=>{e instanceof o.TokenInvalidError&&this.client.signinRedirect()})),a};acquireTokenSilent=async()=>this.getTokenPromise();acquireTokenSilentOrRedirect=async()=>this.getTokenPromise();getUser=async()=>{const e=await this.client.getUser();return{id:e?.profile?.sub,email:e?.profile?.email,name:e?.profile?.name,picture:e?.profile?.picture}};logout=async()=>{(0,s.clearLoginHints)(),this.client.signoutRedirect({post_logout_redirect_uri:(0,i.generateRedirectUri)()})}}},1377:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CogniteIdpService=void 0;var n=r(7066);Object.defineProperty(t,"CogniteIdpService",{enumerable:!0,get:function(){return n.CogniteIdpService}})},5139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdpNotFoundError=void 0;class IdpNotFoundError extends Error{idpInternalId;constructor(e){super(`Idp with internalId (${e}) not found`),this.idpInternalId=e,Object.setPrototypeOf(this,IdpNotFoundError.prototype)}}t.IdpNotFoundError=IdpNotFoundError},9449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDlc=void 0;const n=r(6760);t.getDlc=async e=>{const t=await fetch(`https://app-login-configuration-lookup.cognite.ai/${encodeURIComponent((0,n.getDlcApp)())}/${encodeURIComponent(e)}`);if(!t.ok){const e=await t.json();return Promise.reject({...e,status:t.status})}return await t.json()}},6760:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDlcApp=void 0;t.getDlcApp=()=>{const e=["apps.cognite.com","apps-staging.cognite.com","apps-preview.cognite.com"];return t=window.location.origin,e.find((e=>t.includes(e)))?"fusion":"fusion-dev";var t}},8388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIdp=void 0,t.getIdp=function(e,t){return e.find((e=>e.internalId===t))}},9720:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdpNotFoundError=t.getIdp=t.getDlc=void 0;var n=r(9449);Object.defineProperty(t,"getDlc",{enumerable:!0,get:function(){return n.getDlc}});var o=r(8388);Object.defineProperty(t,"getIdp",{enumerable:!0,get:function(){return o.getIdp}});var i=r(5139);Object.defineProperty(t,"IdpNotFoundError",{enumerable:!0,get:function(){return i.IdpNotFoundError}})},1903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAadError=t.AadError=t.OidcService=t.useLoginHints=t.readLoginHints=t.persistLoginHints=t.clearUrlLoginHints=t.getUrlLoginHints=t.clearLoginHints=t.loginHintKeys=t.SAuthService=t.KeycloakService=t.getIdp=t.getDlc=t.Auth0Service=t.getPca=t.getAadScopes=t.AadService=void 0;var n=r(8450);Object.defineProperty(t,"AadService",{enumerable:!0,get:function(){return n.AadService}}),Object.defineProperty(t,"getAadScopes",{enumerable:!0,get:function(){return n.getAadScopes}}),Object.defineProperty(t,"getPca",{enumerable:!0,get:function(){return n.getPca}});var o=r(1667);Object.defineProperty(t,"Auth0Service",{enumerable:!0,get:function(){return o.Auth0Service}});var i=r(9720);Object.defineProperty(t,"getDlc",{enumerable:!0,get:function(){return i.getDlc}}),Object.defineProperty(t,"getIdp",{enumerable:!0,get:function(){return i.getIdp}});var s=r(326);Object.defineProperty(t,"KeycloakService",{enumerable:!0,get:function(){return s.KeycloakService}});var a=r(5307);Object.defineProperty(t,"SAuthService",{enumerable:!0,get:function(){return a.SAuthService}});var c=r(250);Object.defineProperty(t,"loginHintKeys",{enumerable:!0,get:function(){return c.loginHintKeys}}),Object.defineProperty(t,"clearLoginHints",{enumerable:!0,get:function(){return c.clearLoginHints}}),Object.defineProperty(t,"getUrlLoginHints",{enumerable:!0,get:function(){return c.getUrlLoginHints}}),Object.defineProperty(t,"clearUrlLoginHints",{enumerable:!0,get:function(){return c.clearUrlLoginHints}}),Object.defineProperty(t,"persistLoginHints",{enumerable:!0,get:function(){return c.persistLoginHints}}),Object.defineProperty(t,"readLoginHints",{enumerable:!0,get:function(){return c.readLoginHints}}),Object.defineProperty(t,"useLoginHints",{enumerable:!0,get:function(){return c.useLoginHints}});var g=r(9739);Object.defineProperty(t,"OidcService",{enumerable:!0,get:function(){return g.OidcService}}),Object.defineProperty(t,"AadError",{enumerable:!0,get:function(){return g.AadError}}),Object.defineProperty(t,"isAadError",{enumerable:!0,get:function(){return g.isAadError}})},4681:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeycloakService=void 0;const n=r(6986),o=r(9739),i=r(1075),s=r(250);let a;t.KeycloakService=class KeycloakService{client;redirectUri=window.location.href;userManagerSettings;prefix;constructor(e,t,r,o){this.prefix=`oidc:state:${t}/realms/${r}`,this.userManagerSettings={authority:`${t}/realms/${r}`,client_id:e,redirect_uri:this.redirectUri,scope:`openid profile https://${o} user_impersonation IDENTITY`,automaticSilentRenew:!1,userStore:new n.WebStorageStateStore({store:new n.InMemoryWebStorage,prefix:this.prefix})},this.client=new n.UserManager(this.userManagerSettings)}changeCluster=e=>{this.userManagerSettings.scope=`openid profile https://${e} user_impersonation IDENTITY`,this.client=new n.UserManager(this.userManagerSettings)};getTokenPromise=async()=>{if(a)return a;return a=(async()=>{try{let e=await this.client.getUser();e?.expired&&(e=await this.client.signinSilent());let t=e?.access_token;return t||(e=await this.client.signinRedirectCallback(),t=e?.access_token),t}catch(e){throw new o.TokenInvalidError}finally{this.client.clearStaleState()}})(),a.then((()=>{a=void 0})).catch((e=>{e instanceof o.TokenInvalidError&&this.client.signinRedirect()})),a};acquireTokenSilent=async()=>this.getTokenPromise();acquireTokenSilentOrRedirect=async e=>(e&&this.changeCluster(e),this.getTokenPromise());getUser=async()=>{const e=await this.client.getUser();return{id:e?.profile?.sid,preferred_username:e?.profile?.preferred_username,email:e?.profile?.email,name:e?.profile?.name}};logout=async()=>{(0,s.clearLoginHints)(),this.client.signoutRedirect({post_logout_redirect_uri:(0,i.generateRedirectUri)()})}}},326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeycloakService=void 0;var n=r(4681);Object.defineProperty(t,"KeycloakService",{enumerable:!0,get:function(){return n.KeycloakService}})},8762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearLoginHints=void 0;const n=r(2537);t.clearLoginHints=()=>{window.localStorage.removeItem(n.LOGIN_HINTS_LS_KEY)}},4602:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearUrlLoginHints=void 0;t.clearUrlLoginHints=()=>{const e=new URLSearchParams(window.location.search);e.delete("project"),e.delete("cluster"),e.delete("idpInternalId"),e.delete("organization"),window.location.search=e.toString()}},7046:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlLoginHints=void 0;t.getUrlLoginHints=()=>{const e=new URLSearchParams(window.location.search),t=e.get("project"),r=e.get("cluster"),n=e.get("idpInternalId"),o=e.get("organization"),i={};return o&&(i.organization=o),t&&(i.project=t),r&&(i.cluster=r),n&&(i.idpInternalId=n),i}},250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLoginHints=t.readLoginHints=t.persistLoginHints=t.loginHintKeys=t.clearUrlLoginHints=t.getUrlLoginHints=t.clearLoginHints=void 0;var n=r(8762);Object.defineProperty(t,"clearLoginHints",{enumerable:!0,get:function(){return n.clearLoginHints}});var o=r(7046);Object.defineProperty(t,"getUrlLoginHints",{enumerable:!0,get:function(){return o.getUrlLoginHints}});var i=r(4602);Object.defineProperty(t,"clearUrlLoginHints",{enumerable:!0,get:function(){return i.clearUrlLoginHints}});var s=r(3995);Object.defineProperty(t,"loginHintKeys",{enumerable:!0,get:function(){return s.loginHintKeys}});var a=r(2198);Object.defineProperty(t,"persistLoginHints",{enumerable:!0,get:function(){return a.persistLoginHints}});var c=r(2182);Object.defineProperty(t,"readLoginHints",{enumerable:!0,get:function(){return c.readLoginHints}});var g=r(7962);Object.defineProperty(t,"useLoginHints",{enumerable:!0,get:function(){return g.useLoginHints}})},3995:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loginHintKeys=void 0,t.loginHintKeys={organization:"organization",project:"project",cluster:"cluster",idpInternalId:"idpInternalId"}},2537:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOGIN_HINTS_LS_KEY=void 0,t.LOGIN_HINTS_LS_KEY="@cognite/auth-react/login-hints"},2198:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.persistLoginHints=void 0;const n=r(2537),o=r(2182);t.persistLoginHints=e=>{const t={...(0,o.readLoginHints)()};Object.entries(e).forEach((([e,r])=>{r&&(t[e]=r)})),window.localStorage.setItem(n.LOGIN_HINTS_LS_KEY,JSON.stringify(t))}},2182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readLoginHints=void 0;const n=r(2537);t.readLoginHints=()=>{try{const e=JSON.parse(window.localStorage.getItem(n.LOGIN_HINTS_LS_KEY)||"{}");if(Object.entries(e).length>0)return e}catch(e){return}}},7962:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLoginHints=void 0;const n=r(7046),o=r(2182),i=(e,t={})=>{Object.entries(t).forEach((([t,r])=>{const n=t;!e[n]&&r&&(e[n]=r)}))};t.useLoginHints=()=>{const e=(0,n.getUrlLoginHints)(),t=(0,o.readLoginHints)(),r={};return i(r,t),i(r,e),r}},1262:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AadError=void 0;class AadError extends Error{errorCode;errorMessage;constructor(e,t){super(),this.errorCode=e,this.errorMessage=t,this.name="AadError"}}t.AadError=AadError},8602:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcService=void 0;const n=r(612),o=r(8450),i=r(1667),s=r(326),a=r(5307),c=r(1377);t.OidcService=class OidcService{idp;service;constructor(e,t,r){switch(this.idp=e,"KEYCLOAK"===e?.type&&""===e?.realm&&(e.type="S_AUTH"),e?.type){case"AZURE_AD":this.service=new o.AadService(e?.appConfiguration.clientId,e.authority);break;case"AUTH0":{const t=e;this.service=new i.Auth0Service(t?.appConfiguration.clientId,t?.authority,t?.appConfiguration.audience);break}case"KEYCLOAK":{const t=e;this.service=new s.KeycloakService(t?.appConfiguration?.clientId,t?.authority,t?.realm,r||t?.clusters[0]);break}case"S_AUTH":{const t=e;this.service=new a.SAuthService(t?.appConfiguration.clientId,t?.authority,t?.appConfiguration.audience);break}case"COGNITE_IDP":{const r=e;this.service=new c.CogniteIdpService(r?.appConfiguration?.clientId,r?.authority,t);break}default:this.service=null}}acquireTokenSilent=async(e=this.idp.clusters[0])=>{let t;if(this.service&&(t=await(this.service?.acquireTokenSilent(e))),!t)throw new n.InvalidTokenError;return t};acquireTokenSilentOrRedirect=async e=>{let t;if(this.service&&(t=await(this.service?.acquireTokenSilentOrRedirect(e))),!t)throw new n.InvalidTokenError;return t};getUser=()=>this.service?this.service?.getUser():Promise.resolve({});logout=(e=!1)=>this.service?this.service.logout(e):Promise.resolve(void 0);redirectToConsent=e=>{const t=this.service;return t?t.redirectToConsent(e):Promise.resolve(void 0)}}},7940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenInvalidError=void 0;class TokenInvalidError extends Error{constructor(){super(),this.message="Access token not found"}}t.TokenInvalidError=TokenInvalidError},3797:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserNotFoundError=void 0;class UserNotFoundError extends Error{constructor(){super(),this.message="User not found"}}t.UserNotFoundError=UserNotFoundError},9739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAadError=t.AadError=t.TokenInvalidError=t.OidcService=void 0;var n=r(8602);Object.defineProperty(t,"OidcService",{enumerable:!0,get:function(){return n.OidcService}});var o=r(7940);Object.defineProperty(t,"TokenInvalidError",{enumerable:!0,get:function(){return o.TokenInvalidError}});var i=r(1262);Object.defineProperty(t,"AadError",{enumerable:!0,get:function(){return i.AadError}});var s=r(8240);Object.defineProperty(t,"isAadError",{enumerable:!0,get:function(){return s.isAadError}})},8240:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAadError=void 0;t.isAadError=e=>void 0!==e?.errorCode&&void 0!==e?.errorMessage},6883:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SAuthService=void 0;const n=r(6986),o=r(9739),i=r(1075),s=r(250);let a;t.SAuthService=class SAuthService{client;redirectUri=`${window.location.origin}/signin`;userManagerSettings;prefix;constructor(e,t,r){this.prefix=`oidc:state:${t}`,this.userManagerSettings={authority:t,client_id:e,redirect_uri:this.redirectUri,scope:r,automaticSilentRenew:!1,userStore:new n.WebStorageStateStore({store:new n.InMemoryWebStorage,prefix:this.prefix})},this.client=new n.UserManager(this.userManagerSettings)}getTokenPromise=async()=>{if(a)return a;return a=(async()=>{try{let e=await this.client.getUser();e?.expired&&(e=await this.client.signinSilent());let t=e?.access_token;return t||(e=await this.client.signinRedirectCallback(),t=e?.access_token),t}catch(e){throw new o.TokenInvalidError}finally{this.client.clearStaleState()}})(),a.then((()=>{a=void 0})).catch((e=>{e instanceof o.TokenInvalidError&&this.client.signinRedirect()})),a};acquireTokenSilent=async()=>this.getTokenPromise();acquireTokenSilentOrRedirect=async e=>this.getTokenPromise();getUser=async()=>{const e=await this.client.getUser();return{id:e?.profile?.sid,preferred_username:e?.profile?.preferred_username,email:e?.profile?.email,name:e?.profile?.name}};logout=async()=>{(0,s.clearLoginHints)(),this.client.signoutRedirect({post_logout_redirect_uri:(0,i.generateRedirectUri)()})}}},5307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SAuthService=void 0;var n=r(6883);Object.defineProperty(t,"SAuthService",{enumerable:!0,get:function(){return n.SAuthService}})},1075:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRedirectUri=void 0;const n=r(1903),o=["apps.cognite.com","apps-staging.cognite.com","apps-test.cognite.com","apps-preview.cognite.com"];t.generateRedirectUri=()=>{let e=new URL("https://apps.cognite.com/signin");const t=o.findIndex((e=>window.location.hostname===e));o.includes(window.location.hostname)&&(e=new URL(`https://${[o[t]]}/signin`)),(0,n.clearUrlLoginHints)();const r=window.location.href;return e.searchParams.set("redirectUri",r),e.href}},9675:(e,t,r)=>{"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(8906)),i=n(r(5973)),s=n(r(7236)),a=n(r(8998)),c=n(r(3382)),g=n(r(4461)),y=n(r(3839)),v=r(1662),w=r(9456),_=n(w),b=r(511),E=n(r(6291)),S=n(r(1273)),T=n(r(3581)),I="cognitedata.com",k="https://api."+I,A="Authorization",R="api-key",O="x-cdp-app",N="x-cdp-sdk",U="x-request-id",M=Object.freeze({__proto__:null,DEFAULT_CLUSTER:"api",DEFAULT_DOMAIN:I,BASE_URL:k,AUTHORIZATION_HEADER:A,API_KEY_HEADER:R,X_CDF_APP_HEADER:O,X_CDF_SDK_HEADER:N,X_REQUEST_ID:U,LOCAL_STORAGE_PREFIX:"@cognite/sdk:"}),q=function(){var e=this;this.add=function(t){e.data.unshift(t)},this.remove=function(){e.data.pop()},this.first=function(){return e.data[0]},this.last=function(){return e.data[e.data.length-1]},this.size=function(){return e.data.length},this.data=[]};var L=Object.freeze({__proto__:null,topologicalSort:function(e){var t=new q,r=[],n=function(e){var t=new Map;return e.forEach((function(e){t.set(e,[])})),e.forEach((function(e){var r=e.parentNode;r&&t.get(r).push(e)})),t}(e);for(e.forEach((function(e){e.parentNode||t.add(e)}));0!==t.size();){var o=t.last();t.remove(),r.push(o);var i=n.get(o);i&&i.forEach(t.add)}if(r.length!==e.length)throw Error("Impossible to topological sort nodes");return r}}),j=function(e,t){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},j(e,t)};function H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var F=function(){return F=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},F.apply(this,arguments)};function K(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function D(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function G(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function W(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(G(arguments[t]));return e}function V(e){var t,r=e,n=0;function o(e){return n<e.items.length?{value:e.items[n++],done:!1}:e.next?(n=0,(r=e.next()).then(o)):{value:void 0,done:!0}}function i(){return K(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,r];case 1:return[2,o(e.sent())]}}))}))}var s=function(e){return function(t){return K(this,void 0,void 0,(function(){function r(){return K(this,void 0,void 0,(function(){var n,o;return D(this,(function(i){switch(i.label){case 0:return[4,e()];case 1:return(n=i.sent()).done?[2]:(o=n.value,[4,t(o)]);case 2:return!1===i.sent()?[2]:[4,r()];case 3:return i.sent(),[2]}}))}))}return D(this,(function(e){switch(e.label){case 0:return[4,r()];case 1:return e.sent(),[2]}}))}))}}(i),a=function(e){return function(t){return K(this,void 0,void 0,(function(){var r,n,o=this;return D(this,(function(i){switch(i.label){case 0:return-1===(r=t&&t.limit||25)&&(r=1/0),n=[],[4,e((function(e){return K(o,void 0,void 0,(function(){return D(this,(function(t){return n.push(e),n.length>=r?[2,!1]:[2]}))}))}))];case 1:return i.sent(),[2,n]}}))}))}}(s),c=((t={autoPagingEach:s,autoPagingToArray:a,next:i,return:function(){return{}}})[Symbol.asyncIterator]=function(){return c},t);return c}void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.for("asyncIterator"));var Y=function(e){function t(r,n,o,i){void 0===i&&(i={});var s=this,a=r+" | code: "+n;o&&(a+=" | X-Request-ID: "+o);var c=i.missing,g=i.duplicated,y=i.extra;return(c||g)&&(a+="\n"+JSON.stringify(i,null,2)),s=e.call(this,a)||this,Object.setPrototypeOf(s,t.prototype),s.errorMessage=r,s.status=n,s.requestId=o,s.missing=c,s.duplicated=g,s.extra=y,Error.captureStackTrace?Error.captureStackTrace(s,s.constructor):s.stack=new Error(a).stack,s}return H(t,e),t.prototype.toJSON=function(){var e={status:this.status,message:this.errorMessage};return this.requestId&&(e.requestId=this.requestId),this.missing&&(e.missing=this.missing),this.duplicated&&(e.duplicated=this.duplicated),this.extra&&(e.extra=this.extra),e},t}(Error);function J(e){return e.map((function(e){if(e instanceof Y)return e;var t=e.message;return{name:e.name,message:t,stack:e.stack}}))}var X=function(e){function t(r){var n,o,i=r.succeded,s=r.responses,a=r.failed,c=r.errors,g=e.call(this,"The API Failed to process some items\n"+JSON.stringify({succeded:i,responses:s,failed:a,errors:J(c)},null,2))||this;g.missing=[],g.duplicated=[],g.statuses=[],g.requestIds=[],g.responses=[],Object.setPrototypeOf(g,t.prototype),g.responses=s.map((function(e){return e.data})),g.errors=c,g.succeded=i.reduce((function(e,t){return e.concat(t)}),[]),g.failed=a.reduce((function(e,t){return e.concat(t)}),[]),g.status=c[0].status,g.requestId=c[0].requestId;try{for(var y=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(c),v=y.next();!v.done;v=y.next()){var w=v.value;w instanceof Y&&(w.missing&&(g.missing=g.missing.concat(w.missing)),w.duplicated&&(g.duplicated=g.duplicated.concat(w.duplicated)),w.requestId&&g.requestIds.push(w.requestId),g.statuses.push(w.status))}}catch(_){n={error:_}}finally{try{v&&!v.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}return Error.captureStackTrace?Error.captureStackTrace(g,g.constructor):g.stack=new Error(g.message).stack,g}return H(t,e),t}(Error);function Q(e){return e||k}var $=function(e){return void 0===e&&(e="v1"),"/api/"+e};function ee(e){return"Bearer "+e}function re(){return"undefined"!=typeof window&&void 0!==window.document}function ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=window.location.href;e.forEach((function(e){r=function(e,t){return e.replace(new RegExp("[?#&]"+t+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?#&])"+t+"=[^&]*&"),"$1")}(r,e)})),window.history.replaceState(null,"",r)}function oe(e){return(s(e)||i(e))&&!a(e)&&!(e instanceof ArrayBuffer)&&!(e instanceof Date)}function se(e){return new Promise((function(t){setTimeout(t,e)}))}function ae(e,t){return K(this,void 0,void 0,(function(){var r,n,o,i,s,a;return D(this,(function(c){switch(c.label){case 0:return r=[],n=[],o=[],i=[],s=e.map(t),a=s.map((function(t,r){return new Promise((function(n){t.then((function(t){n({succeded:e[r],response:t})})).catch((function(t){n({failed:e[r],error:t})}))}))})),[4,Promise.all(a)];case 1:if(c.sent().forEach((function(e){r.push.apply(r,W(e.failed?[e.failed]:[])),n.push.apply(n,W(e.succeded?[e.succeded]:[])),o.push.apply(o,W(e.response?[e.response]:[])),i.push.apply(i,W(e.error?[e.error]:[]))})),r.length)throw{succeded:n,responses:o,failed:r,errors:i};return[2,o]}}))}))}function ce(e,t,r){return K(this,void 0,void 0,(function(){var n;return D(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),r?[4,ue(e,t)]:[3,2];case 1:case 3:return[2,o.sent()];case 2:return[4,ae(e,t)];case 4:return[3,6];case 5:throw n=o.sent(),new X(n);case 6:return[2]}}))}))}function ue(e,t){return K(this,void 0,void 0,(function(){var r=this;return D(this,(function(n){return[2,e.reduce((function(n,o,i){return K(r,void 0,void 0,(function(){var r,s,a;return D(this,(function(c){switch(c.label){case 0:return[4,n];case 1:r=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),a=(s=r).concat,[4,t(o)];case 3:return[2,a.apply(s,[c.sent()])];case 4:throw{errors:[c.sent()],failed:e.slice(i),succeded:e.slice(0,i),responses:r};case 5:return[2]}}))}))}),Promise.resolve(new Array))]}))}))}function le(e,t){return t?t(e):e}function de(){return re()&&"https:"===location.protocol.toLowerCase()}var he,pe=function(){function e(e,t){var r=this;this.path=e,this.datePropNames=t,this.isDatePropName=function(e){return"string"==typeof e&&-1!=r.datePropNames.indexOf(e)},this.isPath=function(e){return"string"==typeof e&&-1!=r.path.indexOf(e)}}return e.prototype.parseToDates=function(e){var t=this;return c(e,(function(e,r,n){return t.isDatePropName(r)?new Date(e):void 0===r||t.isPath(r)||n instanceof Array?void 0:e}))},e.parseFromDates=function(e){return c(e,(function(e){if(e instanceof Date)return e.getTime()}))},e}(),fe=function(){function e(e,t,r){var n=this;this.resourcePath=e,this.httpClient=t,this.map=r,this.get=this.requestWrapper(this.httpClient.get.bind(this.httpClient)),this.post=this.requestWrapper(this.httpClient.post.bind(this.httpClient)),this.put=this.requestWrapper(this.httpClient.put.bind(this.httpClient)),this.callListEndpointWithGet=function(e){return K(n,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.get(this.listGetUrl,{params:e})];case 1:return[2,t.sent()]}}))}))},this.callListEndpointWithPost=function(e){return K(n,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.post(this.listPostUrl,{data:e||{}})];case 1:return[2,t.sent()]}}))}))},this.dateParser=new(pe.bind.apply(pe,W([void 0],this.getDateProps())))}return Object.defineProperty(e.prototype,"listGetUrl",{get:function(){return this.url("")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listPostUrl",{get:function(){return this.url("list")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"byIdsUrl",{get:function(){return this.url("byids")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateUrl",{get:function(){return this.url("update")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"searchUrl",{get:function(){return this.url("search")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deleteUrl",{get:function(){return this.url("delete")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aggregateUrl",{get:function(){return this.url("aggregate")},enumerable:!1,configurable:!0}),e.chunk=function(e,t){return 0===e.length?[[]]:o(e,t)},e.prototype.getMetadataMap=function(){return this.map},e.prototype.getDateProps=function(){return[[],[]]},e.prototype.pickDateProps=function(e,t){return[e,t]},e.prototype.url=function(e){return void 0===e&&(e=""),this.resourcePath+"/"+e},e.prototype.requestWrapper=function(e){var t=this;return function(r,n){return K(t,void 0,void 0,(function(){var t;return D(this,(function(o){switch(o.label){case 0:return void 0!==n&&(n=F(F({},n),{params:pe.parseFromDates(n.params),data:pe.parseFromDates(n.data)})),[4,e(r,n)];case 1:return t=o.sent(),[2,F(F({},t),{data:this.dateParser.parseToDates(t.data)})]}}))}))}},e.prototype.createEndpoint=function(e,t,r,n){return void 0===t&&(t=this.url()),K(this,void 0,void 0,(function(){var o=this;return D(this,(function(i){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return o.callCreateEndpoint(e,t)}),r,n)]}))}))},e.prototype.cursorBasedEndpoint=function(e,t){var r=this,n=e(t).then((function(n){return r.addNextPageFunction(e.bind(r),n.data,t)})),o=V(n);return Object.assign(n,o)},e.prototype.listEndpoint=function(e,t){return this.cursorBasedEndpoint(e,t)},e.prototype.retrieveEndpoint=function(e,t,r){return K(this,void 0,void 0,(function(){var n=this;return D(this,(function(o){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return n.callRetrieveEndpoint(e,r,t)}))]}))}))},e.prototype.updateEndpoint=function(e,t){return K(this,void 0,void 0,(function(){var r=this;return D(this,(function(n){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return r.callUpdateEndpoint(e,t)}))]}))}))},e.prototype.searchEndpoint=function(e,t,r){return K(this,void 0,void 0,(function(){var n=this;return D(this,(function(o){return[2,this.callEndpointWithTransform(e,(function(e){return n.callSearchEndpoint(e,t,r)}))]}))}))},e.prototype.deleteEndpoint=function(e,t,r){return K(this,void 0,void 0,(function(){var n;return D(this,(function(o){switch(o.label){case 0:return[4,this.callDeleteEndpoint(e,t,r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn({},n[0])]}}))}))},e.prototype.aggregateEndpoint=function(e,t){return K(this,void 0,void 0,(function(){var r;return D(this,(function(n){switch(n.label){case 0:return[4,this.callAggregateEndpoint(e,t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},e.prototype.callRetrieveEndpoint=function(e,t,r){return void 0===t&&(t=this.byIdsUrl),K(this,void 0,void 0,(function(){return D(this,(function(n){return[2,this.postInParallelWithAutomaticChunking({params:r,path:t,items:e})]}))}))},e.prototype.callUpdateEndpoint=function(e,t){return void 0===t&&(t=this.updateUrl),K(this,void 0,void 0,(function(){return D(this,(function(r){return[2,this.postInParallelWithAutomaticChunking({path:t,items:e})]}))}))},e.prototype.callSearchEndpoint=function(e,t,r){return void 0===t&&(t=this.searchUrl),K(this,void 0,void 0,(function(){return D(this,(function(n){return[2,this.post(t,{data:e,params:r})]}))}))},e.prototype.callDeleteEndpoint=function(e,t,r){return void 0===r&&(r=this.deleteUrl),this.postInParallelWithAutomaticChunking({path:r,items:e,params:t})},e.prototype.callAggregateEndpoint=function(e,t){return void 0===t&&(t=this.aggregateUrl),K(this,void 0,void 0,(function(){return D(this,(function(r){return[2,this.post(t,{data:e})]}))}))},e.prototype.addToMapAndReturn=function(e,t){return this.map.addAndReturn(e,t)},e.prototype.callEndpointWithMergeAndTransform=function(e,t,r,n){return K(this,void 0,void 0,(function(){var o,i,s,a;return D(this,(function(c){switch(c.label){case 0:return o=le(e,r),[4,t.bind(this)(o)];case 1:return i=c.sent(),s=this.mergeItemsFromItemsResponse(i),a=le(s,n),[2,this.addToMapAndReturn(a,i[0])]}}))}))},e.prototype.callEndpointWithTransform=function(e,t){return K(this,void 0,void 0,(function(){var r;return D(this,(function(n){switch(n.label){case 0:return[4,t.bind(this)(e)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},e.prototype.mergeItemsFromItemsResponse=function(e){return e.map((function(e){return e.data.items})).reduce((function(e,t){return W(e,t)}),[])},e.prototype.addNextPageFunction=function(e,t,r){var n=this;void 0===r&&(r={});var o=t.nextCursor,i=o?function(){return e(F(F({},r),{cursor:o})).then((function(t){return n.addNextPageFunction(e,t.data,r)}))}:void 0;return F(F({},t),{next:i})},e.prototype.postInParallelWithAutomaticChunking=function(t){var r=this,n=t.path,o=t.items,i=t.params,s=t.queryParams,a=t.chunkSize,c=void 0===a?1e3:a;return ce(e.chunk(o,c),(function(e){return r.post(n,{data:F(F({},i),{items:e}),params:s})}),!1)},e.prototype.callCreateEndpoint=function(e,t){return K(this,void 0,void 0,(function(){return D(this,(function(r){return[2,this.postInSequenceWithAutomaticChunking(t,e)]}))}))},e.prototype.postInSequenceWithAutomaticChunking=function(t,r,n){var o=this;return ce(e.chunk(r,1e3),(function(e){return o.post(t,{data:{items:e},params:n})}),!0)},e}(),ge=function(e){function t(r,n,o){var i=e.call(this,"Request failed | status code: "+r)||this;return i.status=r,i.data=n,i.headers=o,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace?Error.captureStackTrace(i,i.constructor):i.stack=new Error(i.message).stack,i}return H(t,e),t}(Error),me=function(){function e(e){var t=this;this.baseUrl=e,this.defaultHeaders={},this.setCluster=function(e){t.baseUrl="https://"+e+"."+I}}return e.validateStatusCode=function(e){return e>=200&&e<300},e.throwCustomErrorResponse=function(e){throw new ge(e.status,e.data,e.headers)},e.jsonResponseHandler=function(e){return e.json()},e.textResponseHandler=function(e){return e.text()},e.arrayBufferResponseHandler=function(e){return e.blob().then((function(e){return new w.Response(e).arrayBuffer()}))},e.getResponseHandler=function(t){switch(t){case ye.ArrayBuffer:return e.arrayBufferResponseHandler;case ye.Text:return e.textResponseHandler;default:return e.jsonResponseHandler}},e.convertFetchHeaders=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e.transformRequestBody=function(e){return oe(e)?JSON.stringify(e,null,2):e},e.resolveUrl=function(e,t){return e.replace(/\/$/,"")+(("/"===t[0]?"":"/")+t).replace(/\/+$/,"")},e.prototype.setDefaultHeader=function(e,t){return this.defaultHeaders[e]=t,this},e.prototype.getDefaultHeaders=function(){return F({},this.defaultHeaders)},e.prototype.setBaseUrl=function(e){this.baseUrl=e},e.prototype.getBaseUrl=function(){return this.baseUrl},e.prototype.get=function(e,r){return void 0===r&&(r={}),this.request(F(F({},r),{path:e,method:t.HttpMethod.Get}))},e.prototype.post=function(e,r){return void 0===r&&(r={}),this.request(F(F({},r),{path:e,method:t.HttpMethod.Post}))},e.prototype.put=function(e,r){return void 0===r&&(r={}),this.request(F(F({},r),{path:e,method:t.HttpMethod.Put}))},e.prototype.delete=function(e,r){return void 0===r&&(r={}),this.request(F(F({},r),{path:e,method:t.HttpMethod.Delete}))},e.prototype.patch=function(e,r){return void 0===r&&(r={}),this.request(F(F({},r),{path:e,method:t.HttpMethod.Patch}))},e.prototype.preRequest=function(e){return K(this,void 0,void 0,(function(){var t;return D(this,(function(r){return t=this.populateDefaultHeaders(e.headers),[2,F(F({},e),{headers:t})]}))}))},e.prototype.postRequest=function(t,r,n){return K(this,void 0,void 0,(function(){return D(this,(function(r){return e.validateStatusCode(t.status)||e.throwCustomErrorResponse(t),[2,t]}))}))},e.prototype.populateDefaultHeaders=function(e){return void 0===e&&(e={}),F(F({},this.defaultHeaders),e)},e.prototype.rawRequest=function(t){return K(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g,y;return D(this,(function(v){switch(v.label){case 0:return r=this.constructUrl(t.path,t.params),n=function(e,t,r){void 0===e&&(e={});var n=function(e){var t=[];for(var r in e)t.push(r.toLowerCase());return t}(e),o=t.toLowerCase();n.includes(o)||(e[t]=r);return e}(t.headers,"Accept","application/json"),oe(o=t.data)&&(o=e.transformRequestBody(o),n["Content-Type"]="application/json"),[4,_(r,{body:o,method:t.method,headers:n})];case 1:return i=v.sent(),s=e.getResponseHandler(t.responseType),a=i.clone(),[4,Promise.all([s(i).catch((function(){})),a.text()])];case 2:return c=G.apply(void 0,[v.sent(),2]),g=c[0],y=c[1],[2,{headers:e.convertFetchHeaders(i.headers),status:i.status,data:g||y}]}}))}))},e.prototype.request=function(e){return K(this,void 0,void 0,(function(){var t,r;return D(this,(function(n){switch(n.label){case 0:return[4,this.preRequest(e)];case 1:return t=n.sent(),[4,this.rawRequest(t)];case 2:return r=n.sent(),[2,this.postRequest(r,e,t)]}}))}))},e.prototype.constructUrl=function(t,r){void 0===r&&(r={});var n=t;return Object.keys(r).length>0&&(n+="?"+b.stringify(r)),null!==n.match(/^https?:\/\//i)?n:e.resolveUrl(this.baseUrl,n)},e}();(he=t.HttpMethod||(t.HttpMethod={})).Get="GET",he.Post="POST",he.Put="PUT",he.Delete="DELETE",he.Patch="PATCH";var ye={Json:"json",ArrayBuffer:"arraybuffer",Text:"text"},ve=function(e){return void 0===e&&(e=5),function(t,r,n){if(n>=e)return!1;if(429===r.status)return!0;return!(-1===["GET","HEAD","OPTIONS","DELETE","PUT"].indexOf(t.method.toUpperCase()))&&we(r.status)}};function we(e){return E(e,100,200)||E(e,429,430)||E(e,500,600)}var _e=function(e){function t(t,r){var n=e.call(this,t)||this;return n.retryValidator=r,n}return H(t,e),t.calculateRetryDelayInMs=function(e){return 250+(Math.pow(2,e)-1)/2*1e3},t.prototype.get=function(t,r){return void 0===r&&(r={}),e.prototype.get.call(this,t,r)},t.prototype.post=function(t,r){return void 0===r&&(r={}),e.prototype.post.call(this,t,r)},t.prototype.put=function(t,r){return void 0===r&&(r={}),e.prototype.put.call(this,t,r)},t.prototype.delete=function(t,r){return void 0===r&&(r={}),e.prototype.delete.call(this,t,r)},t.prototype.patch=function(t,r){return void 0===r&&(r={}),e.prototype.patch.call(this,t,r)},t.prototype.preRequest=function(t){return K(this,void 0,void 0,(function(){return D(this,(function(r){return[2,e.prototype.preRequest.call(this,t)]}))}))},t.prototype.postRequest=function(t,r,n){return K(this,void 0,void 0,(function(){return D(this,(function(o){return[2,e.prototype.postRequest.call(this,t,r,n)]}))}))},t.prototype.rawRequest=function(r){return K(this,void 0,void 0,(function(){var n,o,i;return D(this,(function(s){switch(s.label){case 0:n=0,s.label=1;case 1:return[4,e.prototype.rawRequest.call(this,r)];case 2:return o=s.sent(),i=y(r.retryValidator)?r.retryValidator:this.retryValidator,n<5&&!1!==r.retryValidator&&i(r,o,n)?[4,se(t.calculateRetryDelayInMs(n))]:[2,o];case 3:return s.sent(),n++,[3,1];case 4:return[2]}}))}))},t.prototype.request=function(t){return K(this,void 0,void 0,(function(){return D(this,(function(r){return[2,e.prototype.request.call(this,t)]}))}))},t}(me),be=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.oneTimeHeaders={},n.setBearerToken=function(e){n.setDefaultHeader(A,ee(e))},n.response401Handler=function(e,t,r,n){return n()},n}return H(t,e),t.serializeQueryParameters=function(e){return void 0===e&&(e={}),Object.keys(e).reduce((function(t,r){var n=e[r];return t[r]=oe(n)?JSON.stringify(n):n,t}),{})},t.isSameOrigin=function(e,t){var r=v.parse(e),n=r.protocol,o=r.host,i=v.parse(v.resolve(e,t)),s=i.protocol,a=i.host;return n===s&&o===a},t.filterHeaders=function(e,r){return r.reduce((function(e,r){return t.filterHeader(e,r)}),e)},t.filterHeader=function(e,t){var r=F({},e);return delete r[t],r},t.prototype.addOneTimeHeader=function(e,t){return this.oneTimeHeaders[e]=t,this},t.prototype.set401ResponseHandler=function(e){this.response401Handler=e},t.prototype.preRequest=function(e){return K(this,void 0,void 0,(function(){var r,n,o,i;return D(this,(function(s){return r=this.populateDefaultHeaders(e.headers),n=e.withCredentials?r:this.preventTokenLeakage(r,e.path),o=e.data,i=t.serializeQueryParameters(e.params),[2,F(F({},e),{data:o,headers:n,params:i})]}))}))},t.prototype.request=function(t){return K(this,void 0,void 0,(function(){return D(this,(function(r){return t.headers=this.enrichWithOneTimeHeaders(t.headers),[2,e.prototype.request.call(this,t)]}))}))},t.prototype.postRequest=function(t,r,n){return K(this,void 0,void 0,(function(){var o,i=this;return D(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.prototype.postRequest.call(this,t,r,n)];case 1:return[2,s.sent()];case 2:if(401===(o=s.sent()).status&&!this.isLoginOrLogoutApi(r.path)&&!this.isTokenInspect(r.path))return[2,new Promise((function(e,t){i.response401Handler(o,n,(function(){return e(i.request(r))}),(function(){return t(o)}))}))];throw function(e){var t,r,n,o,i,s;try{t=e.status,r=e.data.error.duplicated,o=e.data.error.message,i=e.data.error.missing,n=e.data.error.extra,s=function(e,t){var r=t.toLowerCase();for(var n in e)if(n.toLowerCase()==r)return e[n]}(e.headers||{},U)}catch(a){throw e}throw new Y(o,t,s,{duplicated:r,extra:n,missing:i})}(o);case 3:return[2]}}))}))},t.prototype.enrichWithOneTimeHeaders=function(e){var t=this.oneTimeHeaders;return this.oneTimeHeaders={},F(F({},e),t)},t.prototype.preventTokenLeakage=function(e,r){return t.isSameOrigin(this.baseUrl,r)?e:t.filterHeaders(e,[A,R,O,N])},t.prototype.isLoginOrLogoutApi=function(e){var t=e.toLowerCase();return-1!==t.indexOf("/logout/url")||-1!==t.indexOf("/login/status")},t.prototype.isTokenInspect=function(e){return-1!==e.toLowerCase().indexOf("/token/inspect")},t}(_e),Ee=function(e){function t(t){var r=e.call(this,t||"Not able to login")||this;return Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=new Error(r.message).stack,r}return H(t,e),t}(Error),Se="cognite-js-sdk-auth-popup",Ce="access_token",Te="id_token",Ie="error",ke="error_description",Ae=["appId","project"],Re=[{method:"api",field:"apiKey"},{method:"client_credentials",field:"authority"},{method:"client_credentials",field:"client_id"},{method:"client_credentials",field:"client_secret"},{method:"client_credentials",field:"scope"},{method:"client_credentials",field:"grant_type"},{method:"device",field:"authority"},{method:"device",field:"client_id"},{method:"device",field:"scope"},{method:"implicit",field:"authority"},{method:"implicit",field:"client_id"},{method:"implicit",field:"scope"},{method:"pkce",field:"authority"},{method:"pkce",field:"client_id"},{method:"pkce",field:"scope"}];function Pe(){return window.name===Se}function Oe(e,t){return K(this,void 0,void 0,(function(){var r;return D(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e("/logout/url",{params:t})];case 1:return[2,n.sent().data.data.url];case 2:if(401===(r=n.sent()).status)return[2,null];throw r;case 3:return[2]}}))}))}function Ne(e){var t=b.parse(e),r=t[Ce],n=t[Te],o=t[Ie],i=t[ke];if(void 0!==o)throw Error(o+": "+i);return g(r)&&g(n)?{accessToken:r,idToken:n}:null}function Ue(e){return new Promise((function(t,r){var n=function(e,t){return window.open(e,t,"height=500,width=400,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes")}(xe(e),Se);if(null!==n){var o=function(e){e.source===n&&(e.data&&!e.data.error?(window.removeEventListener("message",o),t(e.data)):r(new Ee))};window.addEventListener("message",o,!1)}else r(new Ee("Failed to create login popup window"))}))}function Me(e,t,r,n){return void 0===r&&(r="silentLoginIframe"),void 0===n&&(n="hash"),K(this,void 0,void 0,(function(){return D(this,(function(o){return[2,new Promise((function(o,i){var s=function(e,t){var r=document.createElement("iframe");return r.name=t,r.style.width="0",r.style.height="0",r.style.border="0",r.style.border="none",r.style.visibility="hidden",r.setAttribute("id",t),r.setAttribute("aria-hidden","true"),r.src=e,r}(e,r);s.onload=function(){try{var e=t(s.contentWindow.location[n]);if(null===e)throw Error("Failed to login silently");o(e)}catch(r){i(r)}finally{document.body.removeChild(s)}},document.body.appendChild(s)}))]}))}))}function xe(e){var t=e.project,r=e.baseUrl,n=e.redirectUrl,o={project:t,redirectUrl:n,errorRedirectUrl:e.errorRedirectUrl||n};return r+"/login/redirect?"+b.stringify(o)}var qe="POPUP";function Le(e,t){return K(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return D(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),[4,e("/login/status",{headers:t})];case 1:return r=g.sent(),n=r.data.data,o=n.loggedIn,i=n.user,s=n.project,a=n.projectId,o?[2,{user:i,project:s,projectId:a}]:[2,null];case 2:if(401===(c=g.sent()).status)return[2,null];throw c;case 3:return[2]}}))}))}var je=function(){function e(e){var t=e.project,r=e.baseUrl;if(!g(t))throw Error("options.project is required and must be of type string");this.baseUrl=r||Q(r),this.httpClient=new be(this.baseUrl,ve()),this.project=t}return e.prototype.login=function(e){var t=this,r=e.onAuthenticate,n=r===qe?Fe:y(r)?r:He;return new Promise((function(e,r){var o={skip:function(){e(null)},redirect:function(e){(function(e){return new Promise((function(){var t=xe(e);window.location.assign(t)}))})(F({baseUrl:t.baseUrl,project:t.project},e)).catch(r)},popup:function(n){return K(t,void 0,void 0,(function(){var t,o,i;return D(this,(function(s){switch(s.label){case 0:t=F({baseUrl:this.baseUrl,project:this.project},n),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Ue(t)];case 2:return(o=s.sent())?(this.setTokens(o),e(o)):r(new Ee),[3,4];case 3:return i=s.sent(),r(i),[3,4];case 4:return[2]}}))}))}};n(o)}))},e.prototype.getCDFToken=function(){return K(this,void 0,void 0,(function(){var e,t,r;return D(this,(function(n){switch(n.label){case 0:return this.authTokens?(e=this.authTokens,t=e.accessToken,r=e.idToken,[4,Ke(this.httpClient,this.project,{accessToken:t,idToken:r})]):[3,2];case 1:if(n.sent())return[2,{accessToken:t,idToken:r}];n.label=2;case 2:return[2,null]}}))}))},e.prototype.handleLoginRedirect=function(){return K(this,void 0,void 0,(function(){var e,t;return D(this,(function(r){switch(r.label){case 0:return de()||re()&&"localhost"===location.hostname?(e=function(){try{var e=Ne(window.location.search);return ne(Ce,Te),e}catch(t){throw ne(Ie,ke),t}}(),(t=null!==e)?[4,Ke(this.httpClient,this.project,e)]:[3,2]):[2,null];case 1:t=r.sent(),r.label=2;case 2:return t?(ne(Ce,Te),this.setTokens(e),[2,e]):[2,null]}}))}))},e.prototype.setTokens=function(e){var t=e.accessToken,r=e.idToken;this.authTokens={accessToken:t,idToken:r}},e}();function He(e){e.redirect({redirectUrl:window.location.href})}function Fe(e){e.popup({redirectUrl:window.location.href})}function Ke(e,t,r){return K(this,void 0,void 0,(function(){var n;return D(this,(function(o){switch(o.label){case 0:return[4,De(e,r.accessToken)];case 1:return[2,null!==(n=o.sent())&&(i=n.project,s=t,i.toLowerCase()===s.toLowerCase())]}var i,s}))}))}function De(e,t){var r;return Le(e.get.bind(e),((r={})[A]=ee(t),r))}var Be=function(e){function t(t,r){var n=e.call(this,"",t,r)||this;return n.status=function(){return Le(n.get,{})},n}return H(t,e),t}(fe),Ge=function(e){function t(t,r){var n=e.call(this,"",t,r)||this;return n.getUrl=function(e){return void 0===e&&(e={}),Oe(n.get,e)},n}return H(t,e),t}(fe),We=function(){function e(){this.map=new WeakMap}return e.prototype.addAndReturn=function(e,t){return this.map.set(e,{status:t.status,headers:t.headers}),e},e.prototype.get=function(e){return this.map.get(e)},e}(),ze=function(){function e(e,t,r){var n=this;this.httpClient=e,this.credentials=t,this.authProvider=r,this.tokenCredentials={},this.authenticate=function(){return K(n,void 0,void 0,(function(){var e,t,r,n,o;return D(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),this.credentials?"api"===this.credentials.method?(e=this.credentials.apiKey,this.httpClient.setDefaultHeader(R,e),[2,e]):(this.tokenCredentials.refresh_token&&(this.tokenCredentials.access_token=""),this.credentials.authContext?[3,2]:(t=this,[4,this.authProvider.load(this.credentials.method,this.credentials).login(this.isRefreshToken())])):[2];case 1:return t.tokenCredentials=i.sent(),[3,4];case 2:return r=this,[4,this.authProvider.load(this.credentials.method,this.credentials.authContext).login(this.isRefreshToken())];case 3:r.tokenCredentials=i.sent(),i.label=4;case 4:return n=void 0,void 0!==this.tokenCredentials.access_token&&""!==this.tokenCredentials.access_token&&(n=this.tokenCredentials.access_token,this.httpClient.setDefaultHeader(A,ee(n))),[2,n];case 5:return o=i.sent(),console.error("An error ocurred while attempting to authenticate",o),[2];case 6:return[2]}}))}))},this.process()}return e.prototype.process=function(){var e;if(this.credentials&&(this.authProvider&&y(this.authProvider.requires)?this.authProvider.requires(this.credentials):function(e){if(!i(e))throw Error("options.credentials is required");if(!e.method)throw Error("options.credentials.method is required and must be of type string with one of this values: api, client_credentials, device, implicit, pkce");for(var t=0;t<Re.length;t++){var r=Re[t];if(e.method&&e.method===r.method&&!e[r.field])throw Error("options.credentials."+r.field+" is required and must be of type string")}}(this.credentials),"api"!==(null===(e=this.credentials)||void 0===e?void 0:e.method)&&!this.authProvider))throw Error("options.authentication.authProvider is required and must be a class that implements a static load method and can call a login method.");if(this.authProvider&&!y(this.authProvider.load))throw Error("The authProvider needs to have a load method.");if(this.authProvider&&!y(this.authProvider.load().login))throw Error("The authProvider load method needs to be able to call call a login method.");if(void 0!==this.authProvider&&this.credentials){if(!(this.credentials.authContext||this.authProvider.load(!0,!0).method||this.authProvider.load(!0,!0).settings))throw Error("Please, use the recommended authProvider: @cognite/auth-wrapper");if(this.credentials.authContext&&!this.authProvider.load(!0,!0).method&&!this.authProvider.load(!0,!0).authContext)throw Error("Please, use the recommended authProvider: @cognite/react-auth-wrapper")}},e.prototype.isRefreshToken=function(){var e,t;return("device"===(null===(e=this.credentials)||void 0===e?void 0:e.method)||"pkce"===(null===(t=this.credentials)||void 0===t?void 0:t.method))&&this.tokenCredentials.refresh_token},e.prototype.isApiKeyMode=function(){var e;return"api"===(null===(e=this.credentials)||void 0===e?void 0:e.method)},e}();var Ve=function(){function e(e,t){var r,n,o=this;if(void 0===t&&(t="v1"),this.authenticate=function(){return K(o,void 0,void 0,(function(){var e,t;return D(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.authenticateGetToken()];case 1:return void 0!==(e=r.sent())?[2,e]:[4,null===(t=this.credentialsAuth)||void 0===t?void 0:t.authenticate()];case 2:return[2,e=r.sent()];case 3:return r.sent(),[2];case 4:return[2]}}))}))},this.authenticateGetToken=function(){return K(o,void 0,void 0,(function(){var e,t;return D(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.tokenPromise&&!this.isTokenPromiseFulfilled||(this.isTokenPromiseFulfilled=!1,this.tokenPromise=this.getToken()),[4,this.tokenPromise];case 1:return e=r.sent(),this.isTokenPromiseFulfilled=!0,void 0===e||this.noAuthMode?[2,e]:this.apiKeyMode?(this.httpClient.setDefaultHeader(R,e),[2,e]):(t=ee(e),this.httpClient.setDefaultHeader(A,t),[2,e]);case 2:return r.sent(),[2];case 3:return[2]}}))}))},this.getMetadata=function(e){return o.metadataMap.get(e)},this.get=function(e,t){return o.httpClient.get(e,t)},this.put=function(e,t){return o.httpClient.put(e,t)},this.post=function(e,t){return o.httpClient.post(e,t)},this.delete=function(e,t){return o.httpClient.delete(e,t)},this.patch=function(e,t){return o.httpClient.patch(e,t)},this.apiFactory=function(e,t){return new e(o.projectUrl+"/"+t,o.httpClient,o.metadataMap)},function(e){if(!i(e))throw Error("`CogniteClient` is missing parameter `options`");for(var t=0;t<Ae.length;t++){var r=Ae[t];if(!g(e[r]))throw Error("options."+r+" is required and must be of type string")}}(e),e&&!(null===(r=e.authentication)||void 0===r?void 0:r.credentials)&&!e.getToken&&!e.noAuthMode)throw Error("options.authentication.credentials is required or options.getToken is request and must be of type () => Promise<string>");var s=e.baseUrl;if(this.retryValidator=null!==(n=e.retryValidator)&&void 0!==n?n:ve(),this.http=this.initializeCDFHttpClient(s,e),e.authentication){var a=e.authentication,c=a.credentials,y=a.provider;this.credentialsAuth=new ze(this.httpClient,c,y)}!re()||de()||e.noAuthMode||console.warn("You should use SSL (https) when you login with OAuth since CDF only allows redirecting back to an HTTPS site"),this.metadata=new We,this.loginApi=new Be(this.httpClient,this.metadataMap),this.logoutApi=new Ge(this.httpClient,this.metadataMap),this.apiVersion=t,this.project=e.project,this.apiKeyMode=!!e.apiKeyMode,this.noAuthMode=!!e.noAuthMode,this.getToken=function(){return K(o,void 0,void 0,(function(){return D(this,(function(t){return[2,e.getToken?e.getToken():void 0]}))}))},this.initAPIs()}return Object.defineProperty(e.prototype,"login",{get:function(){return this.loginApi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logout",{get:function(){return this.logoutApi},enumerable:!1,configurable:!0}),e.prototype.initializeCDFHttpClient=function(e,t){var r=this,n=new be(Q(e),this.getRetryValidator());return n.setDefaultHeader(O,t.appId).setDefaultHeader(N,"CogniteJavaScriptSDK:"+this.version),n.set401ResponseHandler((function(e,t,n,o){return K(r,void 0,void 0,(function(){var e,r,i,s;return D(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),e=this.retrieveTokenValueFromHeader(t.headers),[4,this.tokenPromise];case 1:return(r=a.sent())===e?[3,2]:(s=r,[3,4]);case 2:return[4,this.authenticate()];case 3:s=a.sent(),a.label=4;case 4:return(i=s)&&i!==e?n():o(),[3,6];case 5:return a.sent(),o(),[3,6];case 6:return[2]}}))}))})),n},e.prototype.retrieveTokenValueFromHeader=function(e){var t;return void 0!==(t=this.apiKeyMode?null==e?void 0:e[R]:null==e?void 0:e[A])?t.replace("Bearer ",""):t},e.prototype.getBaseUrl=function(){return this.httpClient.getBaseUrl()},e.prototype.getDefaultRequestHeaders=function(){return F({},this.httpClient.getDefaultHeaders())},e.prototype.initAPIs=function(){},e.prototype.getRetryValidator=function(){return this.retryValidator},Object.defineProperty(e.prototype,"version",{get:function(){return"4.9.0-core"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectUrl",{get:function(){return function(e,t){return void 0===t&&(t="v1"),$(t)+"/projects/"+encodeURIComponent(e)}(this.project,this.apiVersion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadataMap",{get:function(){return this.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this.http},enumerable:!1,configurable:!0}),e}(),Ye="TEST_PROJECT",Je="user@example.com",Ze={data:{loggedIn:!0,user:Je,project:Ye,projectId:123}},Xe="https://example.com";function Qe(e){return void 0===e&&(e=k),new Ve({appId:"JS SDK integration tests",project:"",apiKeyMode:!0,getToken:function(){return Promise.resolve({COGNITE_PROJECT:""}.COGNITE_CREDENTIALS)},baseUrl:e})}var $e=function(e,t){return e-t};var et=Object.freeze({__proto__:null,apiKey:"TEST_KEY",project:Ye,projectId:123,user:Je,loggedInResponse:Ze,notLoggedInResponse:{data:{loggedIn:!1,user:"",project:""}},mockBaseUrl:Xe,authTokens:{accessToken:"abc",idToken:"def"},setupClient:Qe,setupLoggedInClient:function(){return jest.setTimeout(6e4),Qe()},setupMockableClient:function(){return Qe(Xe)},retryInSeconds:function(e,t,r,n){return void 0===t&&(t=3),void 0===r&&(r=404),void 0===n&&(n=300),K(this,void 0,void 0,(function(){var o,i;return D(this,(function(s){switch(s.label){case 0:o=Date.now(),s.label=1;case 1:if(!(Date.now()-o<1e3*n))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,e()];case 3:return[2,s.sent()];case 4:if(i=s.sent(),Number(i.status)!==r)throw i;return[4,se(1e3*t)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:throw new Error("Time limit has been exceeded")}}))}))},runTestWithRetryWhenFailing:function(e){return K(this,void 0,void 0,(function(){var t,r,n,o,i,s;return D(this,(function(a){switch(a.label){case 0:jest.setTimeout(18e4),t=15,r=2,n=500,o=0,a.label=1;case 1:return a.trys.push([1,3,,5]),[4,e()];case 2:return a.sent(),[2];case 3:return s=a.sent(),i=s,[4,se(n)];case 4:return a.sent(),n*=r,o++,[3,5];case 5:if(o<t)return[3,1];a.label=6;case 6:throw i}}))}))},simpleCompare:$e,getSortedPropInArray:function(e,t){return e.map((function(e){return e[t]})).sort($e)},string2arrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,o=e.length;n<o;n++)r[n]=e.charCodeAt(n);return t},randomInt:function(){return Math.floor(1e10*Math.random())}}),tt={clientId:"client_id",scope:"scope",redirectUri:"redirect_uri",responseMode:"response_mode",responseType:"response_type",resource:"resource"},rt="access_token",nt="id_token",ot="expires_in",it=function(){function e(e){var t=e.authority,r=e.requestParams;this.token=null,this.authority=t,this.queryParams=this.getADFSQueryParams(r),this.sessionKey=t+"_"+r.clientId+"_"+r.resource}return e.prototype.login=function(){return K(this,void 0,void 0,(function(){var e,t=this;return D(this,(function(r){switch(r.label){case 0:return[4,this.acquireTokenSilently()];case 1:return e=r.sent(),[2,new Promise((function(r){e&&r(e.accessToken);var n=t.authority+"?"+t.getADFSQueryParamString(t.queryParams);window.location.href=n}))]}}))}))},e.prototype.handleLoginRedirect=function(){try{var e=window.location.hash;if(!e)return null;var t=st(e);return ne(rt,nt,ot,"scope","token_type"),this.setToken(t),t}catch(r){console.error(r)}return null},e.prototype.getCDFToken=function(){return K(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.acquireTokenSilently()];case 1:return[2,(e=t.sent())?e.accessToken:this.token?this.token.accessToken:null]}}))}))},e.prototype.getIdToken=function(){return K(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.acquireTokenSilently()];case 1:return[2,(e=t.sent())?e.idToken:this.token?this.token.idToken:null]}}))}))},e.prototype.acquireTokenSilently=function(){return K(this,void 0,void 0,(function(){var e,t;return D(this,(function(r){switch(r.label){case 0:if(e=this.getToken())return[2,e];t=this.authority+"?prompt=none&"+this.getADFSQueryParamString(this.queryParams),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Me(t,st,"adfsSilentLoginIframe")];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),T(),[3,4];case 4:return e&&this.setToken(e),[2,e]}}))}))},e.prototype.getADFSQueryParams=function(e){var t=e.resource,r={clientId:e.clientId,scope:"user_impersonation IDENTITY",responseMode:"fragment",responseType:"id_token token",resource:t,redirectUri:window.location.href};return Object.entries(r).reduce((function(e,t){var r=G(t,2),n=r[0],o=r[1];return e[tt[n]]=o,e}),{})},e.prototype.getADFSQueryParamString=function(e){return Object.entries(e).reduce((function(e,t){var r=G(t,2),n=r[0],o=r[1];return e+(e.length>1?"&":"")+n+"="+o}),"")},e.prototype.setToken=function(e){this.token=e,e?sessionStorage.setItem(this.sessionKey,JSON.stringify(e)):sessionStorage.removeItem(this.sessionKey)},e.prototype.getToken=function(){var e=sessionStorage.getItem(this.sessionKey);if(!e)return null;try{var t=JSON.parse(e);if(t.expiresIn<=Date.now())throw new Error("token expired "+t.expiresIn);return t}catch(r){return console.error(r),sessionStorage.removeItem(this.sessionKey),null}},e}();function st(e){var t=b.parse(e),r=t[rt],n=t[nt],o=t[ot];return g(r)&&g(n)?{accessToken:r,idToken:n,expiresIn:Date.now()+1e3*Number(o)}:null}var at=function(e){var t=this;this.sortFunction=e,this.originalIndexMap=new Map,this.sort=function(e){return t.originalIndexMap=new Map,t.originalArray=e,e.forEach((function(e,r){t.originalIndexMap.set(e,r)})),t.sortedArray=t.sortFunction(e),t.sortedArray},this.unsort=function(e){if(!t.originalArray||!t.sortedArray)throw Error("Impossible to unsort. Call sort(...) first.");if(e.length!==t.originalArray.length)throw Error("Impossible to unsort. Input array has a different length from original.");var r=[];return t.sortedArray.forEach((function(n,o){var i=t.originalIndexMap.get(n);r[i]=e[o]})),r}};t.ADFS=it,t.BaseCogniteClient=Ve,t.BaseResourceAPI=fe,t.BasicHttpClient=me,t.CDFHttpClient=be,t.CogniteAuthentication=je,t.CogniteError=Y,t.CogniteLoginError=Ee,t.CogniteMultiError=X,t.Constants=M,t.DateParser=pe,t.GraphUtils=L,t.HttpError=ge,t.HttpResponseType=ye,t.MetadataMap=We,t.POPUP=qe,t.REDIRECT="REDIRECT",t.RetryableHttpClient=_e,t.RevertableArraySorter=at,t.TestUtils=et,t.accessApi=function(e){if(void 0===e)throw Error("API not found");return e},t.apiUrl=$,t.createRetryValidator=function(e,t){void 0===t&&(t=5);var r=ve(t);return function(n,o,i){if(i>=t)return!1;if(!we(o.status))return!1;if(r(n,o,i))return!0;var s=e[n.method]||[];return!!function(e,t){return S(t,(function(t){return function(e,t){return-1!==e.toUpperCase().indexOf(t.toUpperCase())}(e,t)}))}(n.path,s)}},t.createUniversalRetryValidator=ve,t.getIdInfo=Le,t.getLogoutUrl=Oe,t.isLoginPopupWindow=Pe,t.loginPopupHandler=function(){if(Pe())try{var e=Ne(window.location.search);window.opener.postMessage(e)}catch(t){window.opener.postMessage({error:t.message})}finally{window.close()}},t.promiseAllAtOnce=ae,t.promiseAllWithData=ce,t.promiseEachInSequence=ue,t.sleepPromise=se},511:(e,t,r)=>{"use strict";var n=r(2889),o=r(4516),i=r(1133);function s(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"==typeof e?a(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function c(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function g(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return function(e,r,n){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=o({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),o=t.shift(),s=t.length>0?t.join("="):void 0;s=void 0===s?null:i(s),r(i(o),s,n)})),Object.keys(n).sort().reduce((function(e,t){var r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=a(r):e[t]=r,e}),Object.create(null))):n}t.extract=c,t.parse=g,t.stringify=function(e,t){!1===(t=o({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var r=function(e){switch(e.arrayFormat){case"index":return function(t,r,n){return null===r?[s(t,e),"[",n,"]"].join(""):[s(t,e),"[",s(n,e),"]=",s(r,e)].join("")};case"bracket":return function(t,r){return null===r?s(t,e):[s(t,e),"[]=",s(r,e)].join("")};default:return function(t,r){return null===r?s(t,e):[s(t,e),"=",s(r,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(n){var o=e[n];if(void 0===o)return"";if(null===o)return s(n,t);if(Array.isArray(o)){var i=[];return o.slice().forEach((function(e){void 0!==e&&i.push(r(n,e,i.length))})),i.join("&")}return s(n,t)+"="+s(o,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:g(c(e),t)}}},2889:e=>{"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},1054:(e,t,r)=>{"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var o=r(9675),i=n(r(5161)),s=n(r(6334)),a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},a(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var g=function(){return g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)};function y(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function v(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function w(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function _(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.list=function(r,n,o){var i=t.encodeUrl(r,n);return e.prototype.listEndpoint.call(t,(function(e){return t.get(i,{params:e})}),o)},t.filter=function(r,n,o){var i=t.encodeUrl(r,n)+"/list";return e.prototype.listEndpoint.call(t,(function(e){return t.post(i,{data:e})}),o)},t.create=function(r,n,o){var i=t.encodeUrl(r,n);return e.prototype.createEndpoint.call(t,o,i)},t.delete=function(r,n,o){var i=t.encodeUrl(r,n)+"/delete";return e.prototype.deleteEndpoint.call(t,o,void 0,i)},t}return c(t,e),t.prototype.encodeUrl=function(e,t){return this.url(e+"/revisions/"+t+"/mappings")},t}(o.BaseResourceAPI),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url(""+e),[4,this.get(t,{responseType:o.HttpResponseType.ArrayBuffer})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}return c(t,e),t}(o.BaseResourceAPI),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithGet,r)},t.retrieve=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url(""+e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(r,n,o){var i=t.url(r+"/revisions/"+n+"/nodes/byids");return e.prototype.retrieveEndpoint.call(t,o,{},i)},t}return c(t,e),t.prototype.list=function(t,r,n){var o=this,i=this.url(t+"/revisions/"+r+"/nodes");return e.prototype.listEndpoint.call(this,(function(e){return o.get(i,{params:e})}),n)},t.prototype.filter=function(t,r,n){var o=this,i=this.url(t+"/revisions/"+r+"/nodes/list");return e.prototype.listEndpoint.call(this,(function(e){return o.post(i,{data:e})}),n)},t.prototype.listAncestors=function(t,r,n,o){var i=this,s=this.url(t+"/revisions/"+r+"/nodes/"+n+"/ancestors");return e.prototype.listEndpoint.call(this,(function(e){return i.get(s,{params:e})}),o)},t}(o.BaseResourceAPI),k=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.create=function(t,r){return e.prototype.createEndpoint.call(o,r,o.url(t+"/revisions"))},o.list=function(t,r){var n=o.url(t+"/revisions");return e.prototype.listEndpoint.call(o,(function(e){return o.get(n,{params:e})}),r)},o.retrieve=function(e,t){return v(o,void 0,void 0,(function(){var r,n;return w(this,(function(o){switch(o.label){case 0:return r=this.url(e+"/revisions/"+t),[4,this.get(r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},o.update=function(t,r){var n=o.url(t+"/revisions/update");return e.prototype.updateEndpoint.call(o,r,n)},o.delete=function(t,r){var n=o.url(t+"/revisions/delete");return e.prototype.deleteEndpoint.call(o,r,void 0,n)},o.updateThumbnail=function(e,t,r){return v(o,void 0,void 0,(function(){var n,o;return w(this,(function(i){switch(i.label){case 0:return n=this.url(e+"/revisions/"+t+"/thumbnail"),[4,this.post(n,{data:{fileId:r}})];case 1:return o=i.sent(),[2,this.addToMapAndReturn({},o)]}}))}))},o.list3DNodes=function(e,t,r){return o.nodes3DApi.list(e,t,r)},o.filter3DNodes=function(e,t,r){return o.nodes3DApi.filter(e,t,r)},o.retrieve3DNodes=function(e,t,r){return o.nodes3DApi.retrieve(e,t,r)},o.list3DNodeAncestors=function(e,t,r,n){return o.nodes3DApi.listAncestors(e,t,r,n)},o.nodes3DApi=new I(t,r,n),o}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.list=function(t,r,n){var o=this,i=this.encodeUrl(t,r);return e.prototype.listEndpoint.call(this,(function(e){return o.get(i,{params:e})}),n)},t.prototype.listAncestors=function(t,r,n,o){var i=this,s=this.encodeUrl(t,r)+"/"+n+"/ancestors";return e.prototype.listEndpoint.call(this,(function(e){return i.get(s,{params:e})}),o)},t.prototype.encodeUrl=function(e,t){return this.url("models/"+e+"/revisions/"+t+"/nodes")},t}(o.BaseResourceAPI),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t.prototype.retrieve=function(e,t){return v(this,void 0,void 0,(function(){var r,n;return w(this,(function(o){switch(o.label){case 0:return r=this.url("models/"+e+"/revisions/"+t),[4,this.get(r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}(o.BaseResourceAPI),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.list=function(t,r,n){var o=this,i=this.url("models/"+t+"/revisions/"+r+"/sectors");return e.prototype.listEndpoint.call(this,(function(e){return o.get(i,{params:e})}),n)},t}(o.BaseResourceAPI),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t.prototype.retrieve=function(e,t){return v(this,void 0,void 0,(function(){var r,n;return w(this,(function(o){switch(o.label){case 0:return r=this.url("models/"+e+"/revisions/"+t),[4,this.get(r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}(o.BaseResourceAPI),U=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;o.retrieveRevealRevision3D=function(e,t){return o.revealRevisions3DAPI.retrieve(e,t)},o.listRevealNodes3D=function(e,t,r){return o.revealNodes3DAPI.list(e,t,r)},o.listRevealNode3DAncestors=function(e,t,r,n){return o.revealNodes3DAPI.listAncestors(e,t,r,n)},o.listRevealSectors3D=function(e,t,r){return o.revealSectors3DAPI.list(e,t,r)},o.retrieveUnrealRevision3D=function(e,t){return o.unrealRevisions3DAPI.retrieve(e,t)};var i=t+"/reveal",s=t+"/unreal";return o.revealRevisions3DAPI=new R(i,r,n),o.revealNodes3DAPI=new A(i,r,n),o.revealSectors3DAPI=new O(i,r,n),o.unrealRevisions3DAPI=new N(s,r,n),o}return c(t,e),t}(o.BaseResourceAPI),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.get(t,{params:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI);function q(e){var t=function(e){var t=new Map,r=e.map((function(e){return{data:e}}));return r.forEach((function(e){var r=e.data.externalId;r&&t.set(r,e)})),r.forEach((function(e){var r=e.data.parentExternalId;r&&t.has(r)&&(e.parentNode=t.get(r))})),r}(e);return o.GraphUtils.topologicalSort(t).map((function(e){return e.data}))}var L,j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){var n=new o.RevertableArraySorter(q),i=n.sort,s=n.unsort;return e.prototype.createEndpoint.call(t,r,void 0,i,s)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.aggregate=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.retrieve=function(r,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(t,r,n)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.search=function(r){return e.prototype.searchEndpoint.call(t,r)},t.delete=function(r,n){void 0===n&&(n={});var o=g(g({},n),{ignoreUnknownIds:!0});return e.prototype.deleteEndpoint.call(t,r,o)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.insert=function(e){return t.insertEndpoint(e)},t.retrieve=function(e){return t.retrieveDatapointsEndpoint(e)},t.retrieveLatest=function(e,r){return void 0===r&&(r={}),t.retrieveLatestEndpoint(e,r)},t.delete=function(e){return t.deleteDatapointsEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","datapoints"],["timestamp"])},t.prototype.insertEndpoint=function(e){return v(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.postInParallelWithAutomaticChunking({path:t,items:e})];case 1:return r.sent(),[2,{}]}}))}))},t.prototype.retrieveDatapointsEndpoint=function(e){return v(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.listPostUrl,[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.prototype.retrieveLatestEndpoint=function(e,t){return v(this,void 0,void 0,(function(){var r,n;return w(this,(function(o){switch(o.label){case 0:return r=this.url("latest"),[4,this.post(r,{data:g({items:e},t)})];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t.prototype.deleteDatapointsEndpoint=function(e){return v(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.postInParallelWithAutomaticChunking({chunkSize:1e4,items:e,path:this.deleteUrl})];case 1:return t.sent(),[2,{}]}}))}))},t}(o.BaseResourceAPI),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.aggregate=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.retrieve=function(r){return e.prototype.retrieveEndpoint.call(t,r)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.documentAsPdf=function(e){return t.pdfPreviewEndpoint(e)},t.documentAsImage=function(e,r){return t.imagePreviewEndpoint(e,r)},t.pdfTemporaryLink=function(e){return t.pdfTemporaryLinkEndpoint(e)},t.pdfBuildPreviewURI=function(e){return""+t.url()+e.toString()+"/preview/pdf"},t.imageBuildPreviewURI=function(e,r){return void 0===r&&(r=1),""+t.url()+e.toString()+"/preview/image/pages/"+r.toString()},t.pdfBuildTemporaryLinkURI=function(e){return""+t.url()+e.toString()+"/preview/pdf/temporarylink"},t}return c(t,e),t.prototype.pdfPreviewEndpoint=function(e){return v(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return t=this.pdfBuildPreviewURI(e),[4,this.get(t,{responseType:o.HttpResponseType.ArrayBuffer,headers:{Accept:"application/pdf"}})];case 1:return[2,r.sent().data]}}))}))},t.prototype.imagePreviewEndpoint=function(e,t){return void 0===t&&(t=1),v(this,void 0,void 0,(function(){var r;return w(this,(function(n){switch(n.label){case 0:return r=this.imageBuildPreviewURI(e,t),[4,this.get(r,{responseType:o.HttpResponseType.ArrayBuffer,headers:{Accept:"image/png"}})];case 1:return[2,n.sent().data]}}))}))},t.prototype.pdfTemporaryLinkEndpoint=function(e){return v(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return t=this.pdfBuildTemporaryLinkURI(e),[4,this.get(t)];case 1:return[2,r.sent().data]}}))}))},t}(o.BaseResourceAPI),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=function(e){return t.aggregate(g(g({},e),{aggregate:"count"})).then((function(e){return e[0].count}))},t.uniqueValues=function(e){return t.aggregate(g(g({},e),{aggregate:"uniqueValues"}))},t.allUniqueValues=function(e){return t.cursorBasedEndpoint(t.callAggregateCursorEndpointWithPost,g(g({},e),{aggregate:"allUniqueValues"}))},t.callAggregateCursorEndpointWithPost=function(e){return v(t,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.post(this.url(),{data:e})];case 1:return[2,t.sent()]}}))}))},t}return c(t,e),t.prototype.aggregate=function(e){return v(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return[4,this.post(this.url(),{data:e})];case 1:return t=r.sent(),[2,this.addToMapAndReturn(t.data.items,t)]}}))}))},t}(o.BaseResourceAPI),G=function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,b(t))||this;n.search=function(e){return n.searchDocuments(e)},n.list=function(e){return n.listEndpoint(n.callListEndpointWithPost,e)},n.content=function(e){return n.documentContent(e)};var o=_(t,3),i=o[0],s=o[1],a=o[2];return n.previewAPI=new K(i,s,a),n.aggregateAPI=new D(i+"/aggregate",s,a),n}return c(t,e),Object.defineProperty(t.prototype,"preview",{get:function(){return this.previewAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"aggregate",{get:function(){return this.aggregateAPI},enumerable:!1,configurable:!0}),t.prototype.searchDocuments=function(e){return v(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return[4,this.post(this.searchUrl,{data:e})];case 1:return t=r.sent(),[2,this.addToMapAndReturn(t.data,t)]}}))}))},t.prototype.documentContent=function(e){return v(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.get(this.url(e+"/content"),{headers:{accept:"text/plain"}})];case 1:return[2,t.sent().data]}}))}))},t}(o.BaseResourceAPI),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.retrieve=function(r){return e.prototype.retrieveEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.delete=function(r){return v(t,void 0,void 0,(function(){return w(this,(function(t){return[2,e.prototype.deleteEndpoint.call(this,r)]}))}))},t.predict=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url("predict"),[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.predictResult=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url("jobs/"+e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.refit=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url("refit"),[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","startTime","statusTime"])},t}(o.BaseResourceAPI),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.uniqueValues=function(r){return e.prototype.aggregateEndpoint.call(t,g(g({},r),{aggregate:"uniqueValues"}))},t}return c(t,e),t}(o.BaseResourceAPI),Y=function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,b(t))||this;return n.create=function(t){return e.prototype.createEndpoint.call(n,t)},n.list=function(t){var r=t||{},o=r.sort,i=void 0===o?{}:o,s=y(r,["sort"]),a=g({sort:n.convertSortObjectToArray(i)},s);return e.prototype.listEndpoint.call(n,n.callListEndpointWithPost,a)},n.retrieve=function(t,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(n,t,r)},n.update=function(t){return e.prototype.updateEndpoint.call(n,t)},n.search=function(t){return e.prototype.searchEndpoint.call(n,t)},n.delete=function(t){return e.prototype.deleteEndpoint.call(n,t)},n.aggregateAPI=new(V.bind.apply(V,b([void 0],t))),n}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},Object.defineProperty(t.prototype,"aggregate",{get:function(){return this.aggregateAPI},enumerable:!1,configurable:!0}),t.prototype.convertSortObjectToArray=function(e){return Object.entries(e).map((function(e){var t=_(e,2);return t[0]+":"+t[1]}))},t}(o.BaseResourceAPI),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upload=function(e,r,n,o){return void 0===n&&(n=!1),void 0===o&&(o=!1),t.uploadEndpoint(e,r,n,o)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.aggregate=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.retrieve=function(r,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(t,r,n)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.search=function(r){return e.prototype.searchEndpoint.call(t,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t.getDownloadUrls=function(e){return t.getDownloadUrlsEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime","sourceCreatedTime","sourceModifiedTime","uploadedTime"])},t.prototype.uploadEndpoint=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),v(this,void 0,void 0,(function(){var o,i,s,a,c;return w(this,(function(g){switch(g.label){case 0:if(!(null!=t)&&n)throw Error("Don't set waitUntilAcknowledged to true when you are not uploading a file");return o={overwrite:r},i=this.url(),[4,this.post(i,{params:o,data:e})];case 1:return s=g.sent(),a=s.data,null==t?[3,3]:[4,this.uploadFile(a.uploadUrl,t,e.mimeType)];case 2:g.sent(),g.label=3;case 3:return n?[4,this.waitUntilFileIsUploaded(a.id)]:[3,5];case 4:return c=g.sent(),[2,this.addToMapAndReturn(c,s)];case 5:return[2,this.addToMapAndReturn(a,s)]}}))}))},t.prototype.uploadFile=function(e,t,r){var n={"Content-Type":r||"application/octet-stream"};return this.put(e,{headers:n,data:t})},t.prototype.waitUntilFileIsUploaded=function(e){return v(this,void 0,void 0,(function(){var t,r,n,i,s;return w(this,(function(a){switch(a.label){case 0:t=10,r=500,n=0,a.label=1;case 1:return[4,this.retrieve([{id:e}])];case 2:return i=_.apply(void 0,[a.sent(),1]),(s=i[0]).uploaded?[2,s]:(n++,[4,o.sleepPromise(r)]);case 3:a.sent(),a.label=4;case 4:if(n<t)return[3,1];a.label=5;case 5:throw Error("File never marked as 'uploaded'")}}))}))},t.prototype.getDownloadUrlsEndpoint=function(e){return v(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url("downloadlink"),[4,this.post(t,{data:{items:e}})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t}(o.BaseResourceAPI),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.get(t,{params:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t.listServiceAccounts=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.encodeServiceAccountUrl(e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.addServiceAccounts=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return w(this,(function(o){switch(o.label){case 0:return t=this.encodeServiceAccountUrl(e),[4,this.post(t,{data:{items:r}})];case 1:return n=o.sent(),[2,this.addToMapAndReturn({},n)]}}))}))},t.removeServiceAccounts=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return w(this,(function(o){switch(o.label){case 0:return t=this.encodeServiceAccountUrl(e)+"/remove",[4,this.post(t,{data:{items:r}})];case 1:return n=o.sent(),[2,this.addToMapAndReturn({},n)]}}))}))},t.encodeServiceAccountUrl=function(e){return t.url(e+"/serviceaccounts")},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["deletedTime"])},t}(o.BaseResourceAPI),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI),$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(e){return v(t,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return t=this.encodeUrl(e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.update=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return w(this,(function(o){switch(o.label){case 0:return t=this.encodeUrl(e),[4,this.put(t,{data:r})];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.updateProject=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return w(this,(function(o){switch(o.label){case 0:return t=this.encodeUrl(e)+"/update",[4,this.post(t,{data:r})];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}return c(t,e),t.prototype.encodeUrl=function(e){return this.url("projects/"+encodeURIComponent(e))},t}(o.BaseResourceAPI),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["lastUpdatedTime"])},t.prototype.insert=function(e,t,r,n){return void 0===n&&(n=!1),v(this,void 0,void 0,(function(){var o;return w(this,(function(i){switch(i.label){case 0:return o=this.encodeUrl(e,t)+"/rows",[4,this.postInParallelWithAutomaticChunking({path:o,items:r,chunkSize:5e3,queryParams:{ensureParent:n}})];case 1:return i.sent(),[2,{}]}}))}))},t.prototype.list=function(t,r,n){var o=this;void 0===n&&(n={});var i=n.onlyRowKeys,s=n.columns,a=y(n,["onlyRowKeys","columns"]);i&&(a.columns=","),s&&(a.columns=s.join(","));var c=this.encodeUrl(t,r)+"/rows";return e.prototype.listEndpoint.call(this,(function(e){return v(o,void 0,void 0,(function(){return w(this,(function(t){return[2,this.get(c,{params:e})]}))}))}),a)},t.prototype.retrieve=function(e,t,r){return v(this,void 0,void 0,(function(){var n,o;return w(this,(function(i){switch(i.label){case 0:return n=this.encodeUrl(e,t)+"/rows/"+encodeURIComponent(r),[4,this.get(n)];case 1:return o=i.sent(),[2,this.addToMapAndReturn(o.data,o)]}}))}))},t.prototype.delete=function(e,t,r){return v(this,void 0,void 0,(function(){var n;return w(this,(function(o){switch(o.label){case 0:return n=this.encodeUrl(e,t)+"/rows/delete",[4,this.postInParallelWithAutomaticChunking({path:n,items:r})];case 1:return o.sent(),[2,{}]}}))}))},t.prototype.encodeUrl=function(e,t){return this.url(encodeURIComponent(e)+"/tables/"+encodeURIComponent(t))},t}(o.BaseResourceAPI),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.create=function(e,t,r){return void 0===r&&(r=!1),v(this,void 0,void 0,(function(){var n,o;return w(this,(function(i){switch(i.label){case 0:return n=this.encodeUrl(e)+"/tables",[4,this.postInParallelWithAutomaticChunking({queryParams:{ensureParent:r},items:t,path:n})];case 1:return o=i.sent(),[2,this.mergeItemsFromItemsResponse(o)]}}))}))},t.prototype.list=function(t,r){var n=this,o=this.encodeUrl(t)+"/tables";return e.prototype.listEndpoint.call(this,(function(e){return v(n,void 0,void 0,(function(){return w(this,(function(t){return[2,this.get(o,{params:e})]}))}))}),r)},t.prototype.delete=function(e,t){var r=this.encodeUrl(e)+"/tables/delete";return this.deleteEndpoint(t,{},r)},t.prototype.encodeUrl=function(e){return this.url(""+encodeURIComponent(e))},t}(o.BaseResourceAPI),ne=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.createDatabases=function(t){return e.prototype.createEndpoint.call(o,t)},o.listDatabases=function(t){return e.prototype.listEndpoint.call(o,o.callListEndpointWithGet,t)},o.deleteDatabases=function(t,r){return e.prototype.deleteEndpoint.call(o,t,r)},o.createTables=function(e,t,r){return void 0===r&&(r=!1),o.rawTablesApi.create(e,t,r)},o.listTables=function(e,t){return o.rawTablesApi.list(e,t)},o.deleteTables=function(e,t){return o.rawTablesApi.delete(e,t)},o.insertRows=function(e,t,r,n){return void 0===n&&(n=!1),o.rawRowsApi.insert(e,t,r,n)},o.listRows=function(e,t,r){return o.rawRowsApi.list(e,t,r)},o.retrieveRow=function(e,t,r){return o.rawRowsApi.retrieve(e,t,r)},o.deleteRows=function(e,t,r){return o.rawRowsApi.delete(e,t,r)},o.rawTablesApi=new re(t,r,n),o.rawRowsApi=new ee(t,r,n),o}return c(t,e),t}(o.BaseResourceAPI),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.retrieve=function(r,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(t,r,n)},t.delete=function(r,n){return void 0===n&&(n={}),e.prototype.deleteEndpoint.call(t,r,n)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithGet,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t}(o.BaseResourceAPI),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.insert=function(e){return v(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.postInParallelWithAutomaticChunking({path:this.url(),items:e,chunkSize:1e4})];case 1:return t.sent(),[2,{}]}}))}))},t.prototype.retrieve=function(t){var r=this;return e.prototype.listEndpoint.call(this,(function(e){return r.post(r.listPostUrl,{data:e}).then(r.transformRetrieveResponse)}),t)},t.prototype.delete=function(e){return this.deleteEndpoint(e)},t.prototype.transformRetrieveResponse=function(e){var t=e.data,r=t.rows,n=t.nextCursor,o=t.columns,i=r.map((function(e){var t=e.rowNumber,r=e.values;return{columns:o,rowNumber:t,values:r}}));return g(g({},e),{data:{items:i,nextCursor:n}})},t}(o.BaseResourceAPI),ce=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.create=function(t){return e.prototype.createEndpoint.call(o,t)},o.list=function(t){return e.prototype.listEndpoint.call(o,o.callListEndpointWithPost,t)},o.aggregate=function(t){return e.prototype.aggregateEndpoint.call(o,t)},o.retrieve=function(t,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(o,t,r)},o.update=function(t){return e.prototype.updateEndpoint.call(o,t)},o.search=function(t){return e.prototype.searchEndpoint.call(o,t)},o.delete=function(t){return e.prototype.deleteEndpoint.call(o,t)},o.insertRows=function(e){return o.sequenceRowsAPI.insert(e)},o.retrieveRows=function(e){return o.sequenceRowsAPI.retrieve(e)},o.deleteRows=function(e){return o.sequenceRowsAPI.delete(e)},o.sequenceRowsAPI=new ae(o.url()+"data",r,n),o}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","columns"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(){return v(t,void 0,void 0,(function(){var e,t;return w(this,(function(r){switch(r.label){case 0:return e=this.url(),[4,this.get(e)];case 1:return t=r.sent(),[2,this.addToMapAndReturn(t.data.items,t)]}}))}))},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["deletedTime"])},t}(o.BaseResourceAPI),le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.compute=function(e){return v(t,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.post(t,{data:e})];case 1:return[2,r.sent().data]}}))}))},t}return c(t,e),t}(o.BaseResourceAPI),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(e){return t.listEndpoint(t.callListEndpointWithGet,e)},t.delete=function(e){return t.deleteEndpoint(e)},t}return c(t,e),t}(o.BaseResourceAPI),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e,r){return t.createEndpoint(r,t.url(e+"/features"))},t.retrieve=function(e,r,n){return t.callEndpointWithMergeAndTransform(r,(function(r){return t.postInParallelWithAutomaticChunking({path:t.url(e+"/features/byids"),items:r,params:n})}))},t.update=function(e,r){return t.updateEndpoint(r,t.url(e+"/features/update"))},t.delete=function(e,r){return t.deleteEndpoint(r,{},t.url(e+"/features/delete"))},t.search=function(e,r){return void 0===r&&(r={}),t.searchEndpoint(r,t.url(e+"/features/search"))},t.searchStream=function(e,r){return void 0===r&&(r={}),t.callSearchEndpoint(r,t.url(e+"/features/search-streaming")).then((function(e){return e.data}))},t.aggregate=function(e,r){return t.aggregateEndpoint(r,t.url(e+"/features/aggregate"))},t.list=function(e,r){void 0===r&&(r={});var n=t.url(e+"/features/list");return t.listEndpoint((function(e){return v(t,void 0,void 0,(function(){return w(this,(function(t){return[2,this.post(n,{data:e})]}))}))}),r)},t}return c(t,e),t}(o.BaseResourceAPI),pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(){return t.listEndpoint(t.callListEndpointWithPost)},t.delete=function(e,r){return void 0===r&&(r={}),t.deleteEndpoint(e,r)},t.update=function(e){return t.updateEndpoint(e)},t}return c(t,e),t}(o.BaseResourceAPI),fe=function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,b(t))||this,o=_(t,3),i=o[1],s=o[2];return n.computeAPI=new le(n.url("compute"),i,s),n.crsAPI=new de(n.url("crs"),i,s),n.featureTypeAPI=new pe(n.url("featuretypes"),i,s),n.featureAPI=new he(n.url("featuretypes"),i,s),n}return c(t,e),Object.defineProperty(t.prototype,"compute",{get:function(){return this.computeAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"crs",{get:function(){return this.crsAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"feature",{get:function(){return this.featureAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"featureType",{get:function(){return this.featureTypeAPI},enumerable:!1,configurable:!0}),t}(o.BaseResourceAPI),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.suggest=function(e){return t.createEndpoint(e,t.suggestUrl)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(e){return t.listEndpoint(t.callListEndpointWithPost,e)},t.delete=function(e){return t.deleteEndpoint(e)},t.update=function(e){return t.updateEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},Object.defineProperty(t.prototype,"suggestUrl",{get:function(){return this.url("suggest")},enumerable:!1,configurable:!0}),t}(o.BaseResourceAPI),me=["Completed","Failed"],ye=["IndustrialObjectDetection","PersonalProtectiveEquipmentDetection"],ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.extract=function(e,r,n){return v(t,void 0,void 0,(function(){var t,o,i,s;return w(this,(function(a){switch(a.label){case 0:return t=this.url("extract"),o={},(i=e.filter((function(e){return ye.includes(e)}))).length>0&&(console.warn("Features '"+i+"' are in beta and are still in development"),o=g(g({},o),{"cdf-version":"beta"})),[4,this.post(t,{data:{features:e,items:r,parameters:n},headers:o})];case 1:return s=a.sent(),[2,this.addToMapAndReturn(s.data,s)]}}))}))},t.getExtractJob=function(e,r,n,o){return void 0===r&&(r=!0),void 0===n&&(n=1e3),void 0===o&&(o=600),v(t,void 0,void 0,(function(){var t,i,s,a=this;return w(this,(function(c){return t=this.url("extract/"+e),i=function(){return v(a,void 0,void 0,(function(){var e;return w(this,(function(r){switch(r.label){case 0:return[4,this.get(t)];case 1:return e=r.sent(),[2,this.addToMapAndReturn(e.data,e)]}}))}))},s=function(e){return me.includes(e.status)},[2,r?this.waitForJobToCompleteAndReturn(i,s,n,o):i()]}))}))},t}return c(t,e),t.prototype.waitForJobToCompleteAndReturn=function(e,t,r,n){return v(this,void 0,void 0,(function(){var i,s;return w(this,(function(a){switch(a.label){case 0:i=0,a.label=1;case 1:return[4,e()];case 2:return s=a.sent(),t(s)?[2,s]:[4,o.sleepPromise(r)];case 3:a.sent(),i++,a.label=4;case 4:if(i<n)return[3,1];a.label=5;case 5:throw new Error("Timed out while waiting for vision job to complete.")}}))}))},t}(o.BaseResourceAPI),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.runQuery=function(e){var r=e.query,n=e.variables,o=e.operationName;return v(t,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return[4,this.post(this.url(),{data:{query:r,variables:n,operationName:o}})];case 1:return[2,e.sent().data]}}))}))},t}return c(t,e),t}(o.BaseResourceAPI),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upsert=function(e){return t.post(t.url("upsert"),{data:e}).then((function(e){return e.data}))},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.delete=function(e){return t.post(t.url("delete"),{data:{version:e}})},t}return c(t,e),t}(o.BaseResourceAPI),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.upsert=function(r){return e.prototype.createEndpoint.call(t,r,t.url("upsert"))},t.retrieve=function(r,n){return e.prototype.retrieveEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.delete=function(r,n){return e.prototype.deleteEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t}return c(t,e),t}(o.BaseResourceAPI);(L=t.Br||(t.Br={})).Patch="Patch",L.Update="Update",L.Force="Force";var Ee,Se=function(e){this.type="constant",this.value=e},Ce=function(e,t,r,n){this.type="raw",this.dbName=e,this.tableName=t,this.rowKey=r,this.columnName=n},Te=function(e,t,r,n,o,i,s){this.type="syntheticTimeSeries",this.expression=e,this.name=t,this.metadata=r,this.description=n,this.isStep=o,this.isString=i,this.unit=s},Ie=function(e,t){this.type="view",this.externalId=e,this.input=t},ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,Ae.encodeTemplateInstances(r)).then(Ae.decodeTemplateInstances)},t.upsert=function(r){return e.prototype.createEndpoint.call(t,Ae.encodeTemplateInstances(r),t.url("upsert")).then(Ae.decodeTemplateInstances)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r.map(Ae.encodePatch)).then(Ae.decodeTemplateInstances)},t.retrieve=function(r,n){return e.prototype.retrieveEndpoint.call(t,r,n||{ignoreUnknownIds:!1}).then(Ae.decodeTemplateInstances)},t.list=function(r){return e.prototype.listEndpoint.call(t,(function(e){return v(t,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:return[4,this.callListEndpointWithPost(e)];case 1:return t=r.sent(),[2,g(g({},t),{data:g(g({},t.data),{items:Ae.decodeTemplateInstances(t.data.items)})})]}}))}))}),r)},t.delete=function(r,n){return e.prototype.deleteEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t}return c(t,e),t}(o.BaseResourceAPI),Ae=function(){function e(){}return e.encodeTemplateInstances=function(t){return t.map((function(t){return g(g({},t),{fieldResolvers:e.encodeFieldResolvers(t.fieldResolvers)})}))},e.encodePatch=function(t){return g(g({},t),{update:{fieldResolvers:{add:"add"in t.update.fieldResolvers?e.encodeFieldResolvers(t.update.fieldResolvers.add):void 0,remove:"remove"in t.update.fieldResolvers?t.update.fieldResolvers.remove:void 0,set:"set"in t.update.fieldResolvers?e.encodeFieldResolvers(t.update.fieldResolvers.set):void 0}}})},e.encodeFieldResolvers=function(e){var t=this,r=s(e).map((function(e){var r=_(e,2),n=r[0],o=r[1];return void 0===o||t.isFieldResolver(o)?[n,o]:[n,new Se(o)]}));return i(r)},e.decodeTemplateInstances=function(t){return t.map((function(t){return g(g({},t),{fieldResolvers:e.decodeFieldResolvers(t.fieldResolvers)})}))},e.decodeFieldResolvers=function(t){var r=s(t).map((function(t){var r=_(t,2),n=r[0],o=r[1];return[n,e.decodeFieldResolver(o)]}));return i(r)},e.decodeFieldResolver=function(e){switch(e.type){case"constant":return e.value;case"raw":return new Ce(e.dbName,e.tableName,e.rowKey,e.columnName);case"syntheticTimeSeries":return new Te(e.expression,e.name,e.metadata,e.description,e.isStep,e.isString,e.unit);case"view":return new Ie(e.externalId,e.input);default:throw new Error("Unknown field resolver type")}},e.isFieldResolver=function(e){return"constant"===e.type||"raw"===e.type||"syntheticTimeSeries"===e.type||"view"===e.type},e}(),Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.upsert=function(e){return t.createEndpoint(e,t.url("upsert"))},t.list=function(e){return t.listEndpoint(t.callListEndpointWithPost,e)},t.resolve=function(e){return t.listEndpoint((function(e){return v(t,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.post(this.url("resolve"),{data:e||{}})];case 1:return[2,t.sent()]}}))}))}),e)},t.delete=function(r,n){return e.prototype.deleteEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t}return c(t,e),t}(o.BaseResourceAPI),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.query=function(e){return t.querySyntheticEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","datapoints"],["timestamp"])},t.prototype.querySyntheticEndpoint=function(e){return v(this,void 0,void 0,(function(){var t,r=this;return w(this,(function(n){return t=this.url("query"),[2,this.callEndpointWithMergeAndTransform(e,(function(e){return r.postInParallelWithAutomaticChunking({path:t,items:e,chunkSize:10})}))]}))}))},t}(o.BaseResourceAPI),Oe=function(e){function t(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.apply(this,b([t],r))||this;return o.create=function(t){return e.prototype.createEndpoint.call(o,t)},o.list=function(t){return e.prototype.listEndpoint.call(o,o.callListEndpointWithPost,t)},o.aggregate=function(t){return e.prototype.aggregateEndpoint.call(o,t)},o.retrieve=function(t,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(o,t,r)},o.update=function(t){return e.prototype.updateEndpoint.call(o,t)},o.search=function(t){return e.prototype.searchEndpoint.call(o,t)},o.delete=function(t){return e.prototype.deleteEndpoint.call(o,t)},o.syntheticQuery=function(e){return o.syntheticTimeseriesApi.query(e)},o.syntheticTimeseriesApi=new(Pe.bind.apply(Pe,b([void 0,o.url("synthetic")],r))),o}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),Ne=((Ee={})[o.HttpMethod.Post]=["/assets/list","/assets/byids","/assets/search","/events/list","/events/byids","/events/search","/files/list","/files/byids","/files/search","/files/initupload","/files/downloadlink","/timeseries/byids","/timeseries/search","/timeseries/data","/timeseries/data/list","/timeseries/data/latest","/timeseries/data/delete","/timeseries/synthetic/query"],Ee),Ue=o.createRetryValidator(Ne),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),Object.defineProperty(t.prototype,"assets",{get:function(){return o.accessApi(this.assetsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeseries",{get:function(){return o.accessApi(this.timeSeriesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datapoints",{get:function(){return o.accessApi(this.dataPointsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sequences",{get:function(){return o.accessApi(this.sequencesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return o.accessApi(this.eventsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return o.accessApi(this.filesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labels",{get:function(){return o.accessApi(this.labelsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return o.accessApi(this.rawApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projects",{get:function(){return o.accessApi(this.projectsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return o.accessApi(this.groupsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"securityCategories",{get:function(){return o.accessApi(this.securityCategoriesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceAccounts",{get:function(){return o.accessApi(this.serviceAccountsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"models3D",{get:function(){return o.accessApi(this.models3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"revisions3D",{get:function(){return o.accessApi(this.revisions3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"files3D",{get:function(){return o.accessApi(this.files3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasets",{get:function(){return o.accessApi(this.datasetsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"assetMappings3D",{get:function(){return o.accessApi(this.assetMappings3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewer3D",{get:function(){return o.accessApi(this.viewer3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiKeys",{get:function(){return o.accessApi(this.apiKeysApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relationships",{get:function(){return o.accessApi(this.relationshipsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityMatching",{get:function(){return o.accessApi(this.entityMatchingApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"geospatial",{get:function(){return o.accessApi(this.geospatialApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"documents",{get:function(){return o.accessApi(this.documentsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"annotations",{get:function(){return o.accessApi(this.annotationsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vision",{get:function(){return o.accessApi(this.visionApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"templates",{get:function(){var e=this;return{groups:o.accessApi(this.apiFactory(be,"templategroups")),group:function(r){var n="templategroups/"+t.urlEncodeExternalId(r)+"/versions";return{versions:o.accessApi(e.apiFactory(_e,n)),version:function(t){var r=n+"/"+t,i=e.apiFactory(we,r+"/graphql");return{instances:o.accessApi(e.apiFactory(ke,r+"/instances")),runQuery:function(t){return v(e,void 0,void 0,(function(){return w(this,(function(e){return[2,i.runQuery(t)]}))}))},views:o.accessApi(e.apiFactory(Re,r+"/views"))}}}}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return"7.19.1"},enumerable:!1,configurable:!0}),t.prototype.getRetryValidator=function(){return Ue},t.prototype.initAPIs=function(){var e="3d/models";this.httpClient.setDefaultHeader("cdf-version","V20210406"),this.assetsApi=this.apiFactory(j,"assets"),this.timeSeriesApi=this.apiFactory(Oe,"timeseries"),this.dataPointsApi=this.apiFactory(H,"timeseries/data"),this.sequencesApi=this.apiFactory(ce,"sequences"),this.eventsApi=this.apiFactory(Y,"events"),this.filesApi=this.apiFactory(J,"files"),this.labelsApi=this.apiFactory(Q,"labels"),this.datasetsApi=this.apiFactory(F,"datasets"),this.rawApi=this.apiFactory(ne,"raw/dbs"),this.groupsApi=this.apiFactory(X,"groups"),this.securityCategoriesApi=this.apiFactory(se,"securitycategories"),this.serviceAccountsApi=this.apiFactory(ue,"serviceaccounts"),this.apiKeysApi=this.apiFactory(M,"apikeys"),this.models3DApi=this.apiFactory(T,e),this.relationshipsApi=this.apiFactory(oe,"relationships"),this.entityMatchingApi=this.apiFactory(W,"context/entitymatching"),this.revisions3DApi=this.apiFactory(k,e),this.files3DApi=this.apiFactory(S,"3d/files"),this.assetMappings3DApi=this.apiFactory(E,e),this.viewer3DApi=this.apiFactory(U,"3d"),this.projectsApi=new $(o.apiUrl(),this.httpClient,this.metadataMap),this.geospatialApi=this.apiFactory(fe,"geospatial"),this.documentsApi=this.apiFactory(G,"documents"),this.annotationsApi=this.apiFactory(ge,"annotations"),this.visionApi=this.apiFactory(ve,"context/vision")},t.urlEncodeExternalId=function(e){return encodeURIComponent(e)},t}(o.BaseCogniteClient);Object.defineProperty(t,"tU",{enumerable:!0,get:function(){return o.CogniteAuthentication}}),Object.defineProperty(t,"RQ",{enumerable:!0,get:function(){return o.REDIRECT}}),t.c6=Me},7737:(e,t,r)=>{"use strict";var n=r(1528),o=r(3235),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},3235:(e,t,r)=>{"use strict";var n=r(7156),o=r(1528),i=o("%Function.prototype.apply%"),s=o("%Function.prototype.call%"),a=o("%Reflect.apply%",!0)||n.call(s,i),c=o("%Object.getOwnPropertyDescriptor%",!0),g=o("%Object.defineProperty%",!0),y=o("%Math.max%");if(g)try{g({},"a",{value:1})}catch(w){g=null}e.exports=function(e){var t=a(n,s,arguments);c&&g&&(c(t,"length").configurable&&g(t,"length",{value:1+y(0,e.length-(arguments.length-1))}));return t};var v=function(){return a(n,i,arguments)};g?g(e.exports,"apply",{value:v}):e.exports.apply=v},9456:function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function g(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function y(e){return"string"!=typeof e&&(e=String(e)),e}function v(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function w(e){this.map={},e instanceof w?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function b(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function E(e){var t=new FileReader,r=b(t);return t.readAsArrayBuffer(e),r}function S(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=S(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=S(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(E)}),this.text=function(){var e,t,r,n=_(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=b(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(A)}),this.json=function(){return this.text().then(JSON.parse)},this}w.prototype.append=function(e,t){e=g(e),t=y(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},w.prototype.delete=function(e){delete this.map[g(e)]},w.prototype.get=function(e){return e=g(e),this.has(e)?this.map[e]:null},w.prototype.has=function(e){return this.map.hasOwnProperty(g(e))},w.prototype.set=function(e,t){this.map[g(e)]=y(t)},w.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},w.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),v(e)},w.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),v(e)},w.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),v(e)},n&&(w.prototype[Symbol.iterator]=w.prototype.entries);var I=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(e,t){var r,n,o=(t=t||{}).body;if(e instanceof k){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new w(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new w(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),I.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function A(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function R(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new w(t.headers),this.url=t.url||"",this._initBody(e)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})},T.call(k.prototype),T.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},R.error=function(){var e=new R(null,{status:0,statusText:""});return e.type="error",e};var O=[301,302,303,307,308];R.redirect=function(e,t){if(-1===O.indexOf(t))throw new RangeError("Invalid status code");return new R(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(U){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function N(e,r){return new Promise((function(n,i){var s=new k(e,r);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new w,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;n(new R(o,r))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}N.polyfill=!0,e.fetch||(e.fetch=N,e.Headers=w,e.Request=k,e.Response=R),t.Headers=w,t.Request=k,t.Response=R,t.fetch=N,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},3724:function(e,t,r){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!=typeof global&&global.crypto&&(n=global.crypto),!n)try{n=r(8056)}catch(S){}var o=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(S){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(S){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},g=a.WordArray=c.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||v).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var s=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=s<<24-(n+i)%4*8}else for(var a=0;a<o;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(o());return new g.init(t,e)}}),y=s.enc={},v=y.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new g.init(r,t/2)}},w=y.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new g.init(r,t)}},_=y.Utf8={stringify:function(e){try{return decodeURIComponent(escape(w.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return w.parse(unescape(encodeURIComponent(e)))}},b=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=_.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,o=n.words,i=n.sigBytes,s=this.blockSize,a=i/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,y=e.min(4*c,i);if(c){for(var v=0;v<c;v+=s)this._doProcessBlock(o,v);r=o.splice(0,c),n.sigBytes-=y}return new g.init(r,y)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),E=(a.Hasher=b.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new E.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math),n)},4676:function(e,t,r){var n;e.exports=(n=r(3724),function(){var e=n,t=e.lib.WordArray;function r(e,r,n){for(var o=[],i=0,s=0;s<r;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return t.create(o,i)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var o=[],i=0;i<r;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<r;a++)o.push(n.charAt(s>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return r(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)},7154:function(e,t,r){var n;e.exports=(n=r(3724),n.enc.Utf8)},287:function(e,t,r){var n;e.exports=(n=r(3724),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,o=0;o<64;)t(n)&&(o<8&&(a[o]=r(e.pow(n,.5))),c[o]=r(e.pow(n,1/3)),o++),n++}();var g=[],y=s.SHA256=i.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],s=r[3],a=r[4],y=r[5],v=r[6],w=r[7],_=0;_<64;_++){if(_<16)g[_]=0|e[t+_];else{var b=g[_-15],E=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,S=g[_-2],T=(S<<15|S>>>17)^(S<<13|S>>>19)^S>>>10;g[_]=E+g[_-7]+T+g[_-16]}var I=n&o^n&i^o&i,k=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),A=w+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&y^~a&v)+c[_]+g[_];w=v,v=y,y=a,a=s+A|0,s=i,i=o,o=n,n=A+(k+I)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+y|0,r[6]=r[6]+v|0,r[7]=r[7]+w|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return r[o>>>5]|=128<<24-o%32,r[14+(o+64>>>9<<4)]=e.floor(n/4294967296),r[15+(o+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(y),t.HmacSHA256=i._createHmacHelper(y)}(Math),n.SHA256)},1133:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp("("+t+")|([^%]+?)","gi"),n=new RegExp("("+t+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(i){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function i(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(r)||[],n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var r={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},o=n.exec(e);o;){try{r[o[0]]=decodeURIComponent(o[0])}catch(t){var s=i(o[0]);s!==o[0]&&(r[o[0]]=s)}o=n.exec(e)}r["%C2"]="\ufffd";for(var a=Object.keys(r),c=0;c<a.length;c++){var g=a[c];e=e.replace(new RegExp(g,"g"),r[g])}return e}(e)}}},6068:e=>{"use strict";e.exports=function(e,t){for(var r={},n=Object.keys(e),o=Array.isArray(t),i=0;i<n.length;i++){var s=n[i],a=e[s];(o?-1!==t.indexOf(s):t(s,a,e))&&(r[s]=a)}return r}},2521:e=>{"use strict";var t=Array.prototype.slice,r=Object.prototype.toString;e.exports=function(e){var n=this;if("function"!=typeof n||"[object Function]"!==r.call(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var o,i=t.call(arguments,1),s=Math.max(0,n.length-i.length),a=[],c=0;c<s;c++)a.push("$"+c);if(o=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var r=n.apply(this,i.concat(t.call(arguments)));return Object(r)===r?r:this}return n.apply(e,i.concat(t.call(arguments)))})),n.prototype){var g=function(){};g.prototype=n.prototype,o.prototype=new g,g.prototype=null}return o}},7156:(e,t,r)=>{"use strict";var n=r(2521);e.exports=Function.prototype.bind||n},1528:(e,t,r)=>{"use strict";var n,o=SyntaxError,i=Function,s=TypeError,a=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(t){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(F){c=null}var g=function(){throw new s},y=c?function(){try{return g}catch(e){try{return c(arguments,"callee").get}catch(t){return g}}}():g,v=r(465)(),w=r(1209)(),_=Object.getPrototypeOf||(w?function(e){return e.__proto__}:null),b={},E="undefined"!=typeof Uint8Array&&_?_(Uint8Array):n,S={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":v&&_?_([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":v&&_?_(_([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&v&&_?_((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&v&&_?_((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":v&&_?_(""[Symbol.iterator]()):n,"%Symbol%":v?Symbol:n,"%SyntaxError%":o,"%ThrowTypeError%":y,"%TypedArray%":E,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(_)try{null.error}catch(F){var T=_(_(F));S["%Error.prototype%"]=T}var I=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&_&&(r=_(o.prototype))}return S[t]=r,r},k={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},A=r(7156),R=r(8776),O=A.call(Function.call,Array.prototype.concat),N=A.call(Function.apply,Array.prototype.splice),U=A.call(Function.call,String.prototype.replace),M=A.call(Function.call,String.prototype.slice),q=A.call(Function.call,RegExp.prototype.exec),L=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,j=/\\(\\)?/g,H=function(e,t){var r,n=e;if(R(k,n)&&(n="%"+(r=k[n])[0]+"%"),R(S,n)){var i=S[n];if(i===b&&(i=I(n)),void 0===i&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===q(/^%?[^%]*%?$/,e))throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=M(e,0,1),r=M(e,-1);if("%"===t&&"%"!==r)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var n=[];return U(e,L,(function(e,t,r,o){n[n.length]=r?U(o,j,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=H("%"+n+"%",t),a=i.name,g=i.value,y=!1,v=i.alias;v&&(n=v[0],N(r,O([0,1],v)));for(var w=1,_=!0;w<r.length;w+=1){var b=r[w],E=M(b,0,1),T=M(b,-1);if(('"'===E||"'"===E||"`"===E||'"'===T||"'"===T||"`"===T)&&E!==T)throw new o("property names with quotes must have matching quotes");if("constructor"!==b&&_||(y=!0),R(S,a="%"+(n+="."+b)+"%"))g=S[a];else if(null!=g){if(!(b in g)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&w+1>=r.length){var I=c(g,b);g=(_=!!I)&&"get"in I&&!("originalValue"in I.get)?I.get:g[b]}else _=R(g,b),g=g[b];_&&!y&&(S[a]=g)}}return g}},1209:e=>{"use strict";var t={foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof r)}},465:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,o=r(6073);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&o())))}},6073:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},8776:(e,t,r)=>{"use strict";var n=r(7156);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},8998:e=>{e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},612:(e,t,r)=>{"use strict";function n(e){this.message=e}r.r(t),r.d(t,{InvalidTokenError:()=>s,default:()=>a}),n.prototype=new Error,n.prototype.name="InvalidCharacterError";var o="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,i=0,s=0,a="";o=t.charAt(s++);~o&&(r=i%4?64*r+o:o,i++%4)?a+=String.fromCharCode(255&r>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return a};function i(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(o(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return o(t)}}function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidTokenError";const a=function(e,t){if("string"!=typeof e)throw new s("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(i(e.split(".")[r]))}catch(e){throw new s("Invalid token specified: "+e.message)}}},5549:(e,t,r)=>{var n=r(4457)(r(441),"DataView");e.exports=n},4613:(e,t,r)=>{var n=r(8145),o=r(9096),i=r(5239),s=r(8228),a=r(5920);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},131:(e,t,r)=>{var n=r(7168),o=r(6582),i=r(3867),s=r(9557),a=r(2726);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},4438:(e,t,r)=>{var n=r(4457)(r(441),"Map");e.exports=n},278:(e,t,r)=>{var n=r(7076),o=r(2530),i=r(4858),s=r(6265),a=r(9909);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},385:(e,t,r)=>{var n=r(4457)(r(441),"Promise");e.exports=n},9902:(e,t,r)=>{var n=r(4457)(r(441),"Set");e.exports=n},1124:(e,t,r)=>{var n=r(278),o=r(6718),i=r(6996);function s(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}s.prototype.add=s.prototype.push=o,s.prototype.has=i,e.exports=s},4281:(e,t,r)=>{var n=r(131),o=r(560),i=r(8282),s=r(6638),a=r(4270),c=r(3229);function g(e){var t=this.__data__=new n(e);this.size=t.size}g.prototype.clear=o,g.prototype.delete=i,g.prototype.get=s,g.prototype.has=a,g.prototype.set=c,e.exports=g},4690:(e,t,r)=>{var n=r(441).Symbol;e.exports=n},5982:(e,t,r)=>{var n=r(441).Uint8Array;e.exports=n},8965:(e,t,r)=>{var n=r(4457)(r(441),"WeakMap");e.exports=n},6758:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},9037:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[o++]=s)}return i}},6222:(e,t,r)=>{var n=r(5092),o=r(6981),i=r(7236),s=r(8752),a=r(4363),c=r(4812),g=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),y=!r&&o(e),v=!r&&!y&&s(e),w=!r&&!y&&!v&&c(e),_=r||y||v||w,b=_?n(e.length,String):[],E=b.length;for(var S in e)!t&&!g.call(e,S)||_&&("length"==S||v&&("offset"==S||"parent"==S)||w&&("buffer"==S||"byteLength"==S||"byteOffset"==S)||a(S,E))||b.push(S);return b}},6460:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},3848:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},4793:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},7596:(e,t,r)=>{var n=r(999),o=r(6530),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var s=e[t];i.call(e,t)&&o(s,r)&&(void 0!==r||t in e)||n(e,t,r)}},3833:(e,t,r)=>{var n=r(6530);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},5615:(e,t,r)=>{var n=r(6051),o=r(2635);e.exports=function(e,t){return e&&n(t,o(t),e)}},3238:(e,t,r)=>{var n=r(6051),o=r(5850);e.exports=function(e,t){return e&&n(t,o(t),e)}},999:(e,t,r)=>{var n=r(9346);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},2327:(e,t,r)=>{var n=r(4281),o=r(6758),i=r(7596),s=r(5615),a=r(3238),c=r(8172),g=r(6438),y=r(3746),v=r(3989),w=r(6094),_=r(5559),b=r(6686),E=r(6019),S=r(7621),T=r(3905),I=r(7236),k=r(8752),A=r(9656),R=r(5973),O=r(6925),N=r(2635),U=r(5850),M="[object Arguments]",q="[object Function]",L="[object Object]",j={};j[M]=j["[object Array]"]=j["[object ArrayBuffer]"]=j["[object DataView]"]=j["[object Boolean]"]=j["[object Date]"]=j["[object Float32Array]"]=j["[object Float64Array]"]=j["[object Int8Array]"]=j["[object Int16Array]"]=j["[object Int32Array]"]=j["[object Map]"]=j["[object Number]"]=j[L]=j["[object RegExp]"]=j["[object Set]"]=j["[object String]"]=j["[object Symbol]"]=j["[object Uint8Array]"]=j["[object Uint8ClampedArray]"]=j["[object Uint16Array]"]=j["[object Uint32Array]"]=!0,j["[object Error]"]=j[q]=j["[object WeakMap]"]=!1,e.exports=function e(t,r,H,F,K,D){var G,W=1&r,V=2&r,Y=4&r;if(H&&(G=K?H(t,F,K,D):H(t)),void 0!==G)return G;if(!R(t))return t;var J=I(t);if(J){if(G=E(t),!W)return g(t,G)}else{var X=b(t),Q=X==q||"[object GeneratorFunction]"==X;if(k(t))return c(t,W);if(X==L||X==M||Q&&!K){if(G=V||Q?{}:T(t),!W)return V?v(t,a(G,t)):y(t,s(G,t))}else{if(!j[X])return K?t:{};G=S(t,X,W)}}D||(D=new n);var $=D.get(t);if($)return $;D.set(t,G),O(t)?t.forEach((function(n){G.add(e(n,r,H,n,t,D))})):A(t)&&t.forEach((function(n,o){G.set(o,e(n,r,H,o,t,D))}));var ee=J?void 0:(Y?V?_:w:V?U:N)(t);return o(ee||t,(function(n,o){ee&&(n=t[o=n]),i(G,o,e(n,r,H,o,t,D))})),G}},7372:(e,t,r)=>{var n=r(5973),o=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(o)return o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},6671:(e,t,r)=>{var n=r(5897),o=r(4741)(n);e.exports=o},641:(e,t,r)=>{var n=r(2630)();e.exports=n},5897:(e,t,r)=>{var n=r(641),o=r(2635);e.exports=function(e,t){return e&&n(e,t,o)}},166:(e,t,r)=>{var n=r(8422),o=r(8780);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[o(t[r++])];return r&&r==i?e:void 0}},9329:(e,t,r)=>{var n=r(3848),o=r(7236);e.exports=function(e,t,r){var i=t(e);return o(e)?i:n(i,r(e))}},4318:(e,t,r)=>{var n=r(4690),o=r(7077),i=r(1954),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},7:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},956:e=>{var t=Math.max,r=Math.min;e.exports=function(e,n,o){return e>=r(n,o)&&e<t(n,o)}},8520:(e,t,r)=>{var n=r(4318),o=r(3387);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},1071:(e,t,r)=>{var n=r(7229),o=r(3387);e.exports=function e(t,r,i,s,a){return t===r||(null==t||null==r||!o(t)&&!o(r)?t!=t&&r!=r:n(t,r,i,s,e,a))}},7229:(e,t,r)=>{var n=r(4281),o=r(2503),i=r(6001),s=r(8784),a=r(6686),c=r(7236),g=r(8752),y=r(4812),v="[object Arguments]",w="[object Array]",_="[object Object]",b=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,E,S,T){var I=c(e),k=c(t),A=I?w:a(e),R=k?w:a(t),O=(A=A==v?_:A)==_,N=(R=R==v?_:R)==_,U=A==R;if(U&&g(e)){if(!g(t))return!1;I=!0,O=!1}if(U&&!O)return T||(T=new n),I||y(e)?o(e,t,r,E,S,T):i(e,t,A,r,E,S,T);if(!(1&r)){var M=O&&b.call(e,"__wrapped__"),q=N&&b.call(t,"__wrapped__");if(M||q){var L=M?e.value():e,j=q?t.value():t;return T||(T=new n),S(L,j,r,E,T)}}return!!U&&(T||(T=new n),s(e,t,r,E,S,T))}},4368:(e,t,r)=>{var n=r(6686),o=r(3387);e.exports=function(e){return o(e)&&"[object Map]"==n(e)}},9157:(e,t,r)=>{var n=r(4281),o=r(1071);e.exports=function(e,t,r,i){var s=r.length,a=s,c=!i;if(null==e)return!a;for(e=Object(e);s--;){var g=r[s];if(c&&g[2]?g[1]!==e[g[0]]:!(g[0]in e))return!1}for(;++s<a;){var y=(g=r[s])[0],v=e[y],w=g[1];if(c&&g[2]){if(void 0===v&&!(y in e))return!1}else{var _=new n;if(i)var b=i(v,w,y,e,t,_);if(!(void 0===b?o(w,v,3,i,_):b))return!1}}return!0}},2987:(e,t,r)=>{var n=r(3839),o=r(7275),i=r(5973),s=r(6822),a=/^\[object .+?Constructor\]$/,c=Function.prototype,g=Object.prototype,y=c.toString,v=g.hasOwnProperty,w=RegExp("^"+y.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?w:a).test(s(e))}},4642:(e,t,r)=>{var n=r(6686),o=r(3387);e.exports=function(e){return o(e)&&"[object Set]"==n(e)}},3749:(e,t,r)=>{var n=r(4318),o=r(9216),i=r(3387),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!s[n(e)]}},8904:(e,t,r)=>{var n=r(8418),o=r(4555),i=r(5362),s=r(7236),a=r(1651);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?o(e[0],e[1]):n(e):a(e)}},8803:(e,t,r)=>{var n=r(5003),o=r(1466),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},2578:(e,t,r)=>{var n=r(5973),o=r(5003),i=r(4904),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=o(e),r=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&r.push(a);return r}},8418:(e,t,r)=>{var n=r(9157),o=r(9182),i=r(7375);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},4555:(e,t,r)=>{var n=r(1071),o=r(3795),i=r(3646),s=r(3266),a=r(1457),c=r(7375),g=r(8780);e.exports=function(e,t){return s(e)&&a(t)?c(g(e),t):function(r){var s=o(r,e);return void 0===s&&s===t?i(r,e):n(t,s,3)}}},1712:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},4815:(e,t,r)=>{var n=r(166);e.exports=function(e){return function(t){return n(t,e)}}},4293:e=>{e.exports=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}},7802:(e,t,r)=>{var n=r(6671);e.exports=function(e,t){var r;return n(e,(function(e,n,o){return!(r=t(e,n,o))})),!!r}},5092:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},94:(e,t,r)=>{var n=r(6460);e.exports=function(e,t){return n(t,(function(t){return[t,e[t]]}))}},454:(e,t,r)=>{var n=r(4690),o=r(6460),i=r(7236),s=r(2945),a=n?n.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(s(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r}},3349:(e,t,r)=>{var n=r(5720),o=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(o,""):e}},6535:e=>{e.exports=function(e){return function(t){return e(t)}}},555:e=>{e.exports=function(e,t){return e.has(t)}},8422:(e,t,r)=>{var n=r(7236),o=r(3266),i=r(3879),s=r(1119);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:i(s(e))}},3632:(e,t,r)=>{var n=r(5982);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},8172:(e,t,r)=>{e=r.nmd(e);var n=r(441),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o?n.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}},9841:(e,t,r)=>{var n=r(3632);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},2769:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},9130:(e,t,r)=>{var n=r(4690),o=n?n.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},2215:(e,t,r)=>{var n=r(3632);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},6438:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},6051:(e,t,r)=>{var n=r(7596),o=r(999);e.exports=function(e,t,r,i){var s=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var g=t[a],y=i?i(r[g],e[g],g,r,e):void 0;void 0===y&&(y=e[g]),s?o(r,g,y):n(r,g,y)}return r}},3746:(e,t,r)=>{var n=r(6051),o=r(5904);e.exports=function(e,t){return n(e,o(e),t)}},3989:(e,t,r)=>{var n=r(6051),o=r(2511);e.exports=function(e,t){return n(e,o(e),t)}},8507:(e,t,r)=>{var n=r(441)["__core-js_shared__"];e.exports=n},4741:(e,t,r)=>{var n=r(1580);e.exports=function(e,t){return function(r,o){if(null==r)return r;if(!n(r))return e(r,o);for(var i=r.length,s=t?i:-1,a=Object(r);(t?s--:++s<i)&&!1!==o(a[s],s,a););return r}}},2630:e=>{e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),s=n(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===r(i[c],c,i))break}return t}}},9891:(e,t,r)=>{var n=r(94),o=r(6686),i=r(2876),s=r(7639);e.exports=function(e){return function(t){var r=o(t);return"[object Map]"==r?i(t):"[object Set]"==r?s(t):n(t,e(t))}}},9346:(e,t,r)=>{var n=r(4457),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=o},2503:(e,t,r)=>{var n=r(1124),o=r(4793),i=r(555);e.exports=function(e,t,r,s,a,c){var g=1&r,y=e.length,v=t.length;if(y!=v&&!(g&&v>y))return!1;var w=c.get(e),_=c.get(t);if(w&&_)return w==t&&_==e;var b=-1,E=!0,S=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++b<y;){var T=e[b],I=t[b];if(s)var k=g?s(I,T,b,t,e,c):s(T,I,b,e,t,c);if(void 0!==k){if(k)continue;E=!1;break}if(S){if(!o(t,(function(e,t){if(!i(S,t)&&(T===e||a(T,e,r,s,c)))return S.push(t)}))){E=!1;break}}else if(T!==I&&!a(T,I,r,s,c)){E=!1;break}}return c.delete(e),c.delete(t),E}},6001:(e,t,r)=>{var n=r(4690),o=r(5982),i=r(6530),s=r(2503),a=r(2876),c=r(6350),g=n?n.prototype:void 0,y=g?g.valueOf:void 0;e.exports=function(e,t,r,n,g,v,w){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!v(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var _=a;case"[object Set]":var b=1&n;if(_||(_=c),e.size!=t.size&&!b)return!1;var E=w.get(e);if(E)return E==t;n|=2,w.set(e,t);var S=s(_(e),_(t),n,g,v,w);return w.delete(e),S;case"[object Symbol]":if(y)return y.call(e)==y.call(t)}return!1}},8784:(e,t,r)=>{var n=r(6094),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,s,a){var c=1&r,g=n(e),y=g.length;if(y!=n(t).length&&!c)return!1;for(var v=y;v--;){var w=g[v];if(!(c?w in t:o.call(t,w)))return!1}var _=a.get(e),b=a.get(t);if(_&&b)return _==t&&b==e;var E=!0;a.set(e,t),a.set(t,e);for(var S=c;++v<y;){var T=e[w=g[v]],I=t[w];if(i)var k=c?i(I,T,w,t,e,a):i(T,I,w,e,t,a);if(!(void 0===k?T===I||s(T,I,r,i,a):k)){E=!1;break}S||(S="constructor"==w)}if(E&&!S){var A=e.constructor,R=t.constructor;A==R||!("constructor"in e)||!("constructor"in t)||"function"==typeof A&&A instanceof A&&"function"==typeof R&&R instanceof R||(E=!1)}return a.delete(e),a.delete(t),E}},4414:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},6094:(e,t,r)=>{var n=r(9329),o=r(5904),i=r(2635);e.exports=function(e){return n(e,i,o)}},5559:(e,t,r)=>{var n=r(9329),o=r(2511),i=r(5850);e.exports=function(e){return n(e,i,o)}},2907:(e,t,r)=>{var n=r(7620);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},9182:(e,t,r)=>{var n=r(1457),o=r(2635);e.exports=function(e){for(var t=o(e),r=t.length;r--;){var i=t[r],s=e[i];t[r]=[i,s,n(s)]}return t}},4457:(e,t,r)=>{var n=r(2987),o=r(9741);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},1407:(e,t,r)=>{var n=r(3717)(Object.getPrototypeOf,Object);e.exports=n},7077:(e,t,r)=>{var n=r(4690),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(c){}var o=s.call(e);return n&&(t?e[a]=r:delete e[a]),o}},5904:(e,t,r)=>{var n=r(9037),o=r(7471),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),n(s(e),(function(t){return i.call(e,t)})))}:o;e.exports=a},2511:(e,t,r)=>{var n=r(3848),o=r(1407),i=r(5904),s=r(7471),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,i(e)),e=o(e);return t}:s;e.exports=a},6686:(e,t,r)=>{var n=r(5549),o=r(4438),i=r(385),s=r(9902),a=r(8965),c=r(4318),g=r(6822),y="[object Map]",v="[object Promise]",w="[object Set]",_="[object WeakMap]",b="[object DataView]",E=g(n),S=g(o),T=g(i),I=g(s),k=g(a),A=c;(n&&A(new n(new ArrayBuffer(1)))!=b||o&&A(new o)!=y||i&&A(i.resolve())!=v||s&&A(new s)!=w||a&&A(new a)!=_)&&(A=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?g(r):"";if(n)switch(n){case E:return b;case S:return y;case T:return v;case I:return w;case k:return _}return t}),e.exports=A},9741:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},7383:(e,t,r)=>{var n=r(8422),o=r(6981),i=r(7236),s=r(4363),a=r(9216),c=r(8780);e.exports=function(e,t,r){for(var g=-1,y=(t=n(t,e)).length,v=!1;++g<y;){var w=c(t[g]);if(!(v=null!=e&&r(e,w)))break;e=e[w]}return v||++g!=y?v:!!(y=null==e?0:e.length)&&a(y)&&s(w,y)&&(i(e)||o(e))}},8145:(e,t,r)=>{var n=r(5148);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},9096:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5239:(e,t,r)=>{var n=r(5148),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},8228:(e,t,r)=>{var n=r(5148),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},5920:(e,t,r)=>{var n=r(5148);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},6019:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},7621:(e,t,r)=>{var n=r(3632),o=r(9841),i=r(2769),s=r(9130),a=r(2215);e.exports=function(e,t,r){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return o(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,r);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return i(e);case"[object Symbol]":return s(e)}}},3905:(e,t,r)=>{var n=r(7372),o=r(1407),i=r(5003);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(o(e))}},4363:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=r??9007199254740991)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},3108:(e,t,r)=>{var n=r(6530),o=r(1580),i=r(4363),s=r(5973);e.exports=function(e,t,r){if(!s(r))return!1;var a=typeof t;return!!("number"==a?o(r)&&i(t,r.length):"string"==a&&t in r)&&n(r[t],e)}},3266:(e,t,r)=>{var n=r(7236),o=r(2945),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||(s.test(e)||!i.test(e)||null!=t&&e in Object(t))}},7620:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},7275:(e,t,r)=>{var n,o=r(8507),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},5003:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},1457:(e,t,r)=>{var n=r(5973);e.exports=function(e){return e==e&&!n(e)}},7168:e=>{e.exports=function(){this.__data__=[],this.size=0}},6582:(e,t,r)=>{var n=r(3833),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},3867:(e,t,r)=>{var n=r(3833);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},9557:(e,t,r)=>{var n=r(3833);e.exports=function(e){return n(this.__data__,e)>-1}},2726:(e,t,r)=>{var n=r(3833);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},7076:(e,t,r)=>{var n=r(4613),o=r(131),i=r(4438);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},2530:(e,t,r)=>{var n=r(2907);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},4858:(e,t,r)=>{var n=r(2907);e.exports=function(e){return n(this,e).get(e)}},6265:(e,t,r)=>{var n=r(2907);e.exports=function(e){return n(this,e).has(e)}},9909:(e,t,r)=>{var n=r(2907);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},2876:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},7375:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},7085:(e,t,r)=>{var n=r(427);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},5148:(e,t,r)=>{var n=r(4457)(Object,"create");e.exports=n},1466:(e,t,r)=>{var n=r(3717)(Object.keys,Object);e.exports=n},4904:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},1782:(e,t,r)=>{e=r.nmd(e);var n=r(4414),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o&&n.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=a},1954:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},3717:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},441:(e,t,r)=>{var n=r(4414),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},6718:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6996:e=>{e.exports=function(e){return this.__data__.has(e)}},6350:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},7639:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}},560:(e,t,r)=>{var n=r(131);e.exports=function(){this.__data__=new n,this.size=0}},8282:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},6638:e=>{e.exports=function(e){return this.__data__.get(e)}},4270:e=>{e.exports=function(e){return this.__data__.has(e)}},3229:(e,t,r)=>{var n=r(131),o=r(4438),i=r(278);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var s=r.__data__;if(!o||s.length<199)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(s)}return r.set(e,t),this.size=r.size,this}},3879:(e,t,r)=>{var n=r(7085),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,r,n,o){t.push(n?o.replace(i,"$1"):r||e)})),t}));e.exports=s},8780:(e,t,r)=>{var n=r(2945);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},6822:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(r){}try{return e+""}catch(r){}}return""}},5720:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},8906:(e,t,r)=>{var n=r(4293),o=r(3108),i=r(5225),s=Math.ceil,a=Math.max;e.exports=function(e,t,r){t=(r?o(e,t,r):void 0===t)?1:a(i(t),0);var c=null==e?0:e.length;if(!c||t<1)return[];for(var g=0,y=0,v=Array(s(c/t));g<c;)v[y++]=n(e,g,g+=t);return v}},3382:(e,t,r)=>{var n=r(2327);e.exports=function(e,t){return n(e,5,t="function"==typeof t?t:void 0)}},6530:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},5161:e=>{e.exports=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var o=e[t];n[o[0]]=o[1]}return n}},3795:(e,t,r)=>{var n=r(166);e.exports=function(e,t,r){var o=null==e?void 0:n(e,t);return void 0===o?r:o}},3646:(e,t,r)=>{var n=r(7),o=r(7383);e.exports=function(e,t){return null!=e&&o(e,t,n)}},5362:e=>{e.exports=function(e){return e}},6291:(e,t,r)=>{var n=r(956),o=r(992),i=r(8746);e.exports=function(e,t,r){return t=o(t),void 0===r?(r=t,t=0):r=o(r),e=i(e),n(e,t,r)}},6981:(e,t,r)=>{var n=r(8520),o=r(3387),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},7236:e=>{var t=Array.isArray;e.exports=t},1580:(e,t,r)=>{var n=r(3839),o=r(9216);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},8752:(e,t,r)=>{e=r.nmd(e);var n=r(441),o=r(7149),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,a=s&&s.exports===i?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;e.exports=c},3839:(e,t,r)=>{var n=r(4318),o=r(5973);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},9216:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},9656:(e,t,r)=>{var n=r(4368),o=r(6535),i=r(1782),s=i&&i.isMap,a=s?o(s):n;e.exports=a},5973:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3387:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},6925:(e,t,r)=>{var n=r(4642),o=r(6535),i=r(1782),s=i&&i.isSet,a=s?o(s):n;e.exports=a},4461:(e,t,r)=>{var n=r(4318),o=r(7236),i=r(3387);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==n(e)}},2945:(e,t,r)=>{var n=r(4318),o=r(3387);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},4812:(e,t,r)=>{var n=r(3749),o=r(6535),i=r(1782),s=i&&i.isTypedArray,a=s?o(s):n;e.exports=a},2635:(e,t,r)=>{var n=r(6222),o=r(8803),i=r(1580);e.exports=function(e){return i(e)?n(e):o(e)}},5850:(e,t,r)=>{var n=r(6222),o=r(2578),i=r(1580);e.exports=function(e){return i(e)?n(e,!0):o(e)}},427:(e,t,r)=>{var n=r(278);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=e.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(o.Cache||n),r}o.Cache=n,e.exports=o},3581:e=>{e.exports=function(){}},1651:(e,t,r)=>{var n=r(1712),o=r(4815),i=r(3266),s=r(8780);e.exports=function(e){return i(e)?n(s(e)):o(e)}},1273:(e,t,r)=>{var n=r(4793),o=r(8904),i=r(7802),s=r(7236),a=r(3108);e.exports=function(e,t,r){var c=s(e)?n:i;return r&&a(e,t,r)&&(t=void 0),c(e,o(t,3))}},7471:e=>{e.exports=function(){return[]}},7149:e=>{e.exports=function(){return!1}},992:(e,t,r)=>{var n=r(8746),o=1/0;e.exports=function(e){return e?(e=n(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},5225:(e,t,r)=>{var n=r(992);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},8746:(e,t,r)=>{var n=r(3349),o=r(5973),i=r(2945),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,g=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?g(e.slice(2),r?2:8):s.test(e)?NaN:+e}},6334:(e,t,r)=>{var n=r(9891)(r(2635));e.exports=n},1119:(e,t,r)=>{var n=r(454);e.exports=function(e){return null==e?"":n(e)}},4516:e=>{"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}()?Object.assign:function(e,o){for(var i,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var g in i=Object(arguments[c]))r.call(i,g)&&(a[g]=i[g]);if(t){s=t(i);for(var y=0;y<s.length;y++)n.call(i,s[y])&&(a[s[y]]=i[s[y]])}}return a}},3970:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,o=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,i=n&&o&&"function"==typeof o.get?o.get:null,s=n&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,g=a&&c&&"function"==typeof c.get?c.get:null,y=a&&Set.prototype.forEach,v="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,w="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,_="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,b=Boolean.prototype.valueOf,E=Object.prototype.toString,S=Function.prototype.toString,T=String.prototype.match,I=String.prototype.slice,k=String.prototype.replace,A=String.prototype.toUpperCase,R=String.prototype.toLowerCase,O=RegExp.prototype.test,N=Array.prototype.concat,U=Array.prototype.join,M=Array.prototype.slice,q=Math.floor,L="function"==typeof BigInt?BigInt.prototype.valueOf:null,j=Object.getOwnPropertySymbols,H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,F="function"==typeof Symbol&&"object"==typeof Symbol.iterator,K="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===F||"symbol")?Symbol.toStringTag:null,D=Object.prototype.propertyIsEnumerable,G=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function W(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||O.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-q(-e):q(e);if(n!==e){var o=String(n),i=I.call(t,o.length+1);return k.call(o,r,"$&_")+"."+k.call(k.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return k.call(t,r,"$&_")}var V=r(5503),Y=V.custom,J=re(Y)?Y:null;function X(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function Q(e){return k.call(String(e),/"/g,"&quot;")}function $(e){return!("[object Array]"!==se(e)||K&&"object"==typeof e&&K in e)}function ee(e){return!("[object RegExp]"!==se(e)||K&&"object"==typeof e&&K in e)}function re(e){if(F)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!H)return!1;try{return H.call(e),!0}catch(t){}return!1}e.exports=function e(t,r,n,o){var a=r||{};if(oe(a,"quoteStyle")&&"single"!==a.quoteStyle&&"double"!==a.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(oe(a,"maxStringLength")&&("number"==typeof a.maxStringLength?a.maxStringLength<0&&a.maxStringLength!==1/0:null!==a.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=!oe(a,"customInspect")||a.customInspect;if("boolean"!=typeof c&&"symbol"!==c)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(oe(a,"indent")&&null!==a.indent&&"\t"!==a.indent&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(oe(a,"numericSeparator")&&"boolean"!=typeof a.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var E=a.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return ce(t,a);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var A=String(t);return E?W(t,A):A}if("bigint"==typeof t){var O=String(t)+"n";return E?W(t,O):O}var q=void 0===a.depth?5:a.depth;if(void 0===n&&(n=0),n>=q&&q>0&&"object"==typeof t)return $(t)?"[Array]":"[Object]";var j=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=U.call(Array(e.indent+1)," ")}return{base:r,prev:U.call(Array(t+1),r)}}(a,n);if(void 0===o)o=[];else if(ae(o,t)>=0)return"[Circular]";function Y(t,r,i){if(r&&(o=M.call(o)).push(r),i){var s={depth:a.depth};return oe(a,"quoteStyle")&&(s.quoteStyle=a.quoteStyle),e(t,s,n+1,o)}return e(t,a,n+1,o)}if("function"==typeof t&&!ee(t)){var ne=function(e){if(e.name)return e.name;var t=T.call(S.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),ue=fe(t,Y);return"[Function"+(ne?": "+ne:" (anonymous)")+"]"+(ue.length>0?" { "+U.call(ue,", ")+" }":"")}if(re(t)){var ge=F?k.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):H.call(t);return"object"!=typeof t||F?ge:le(ge)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var me="<"+R.call(String(t.nodeName)),ye=t.attributes||[],ve=0;ve<ye.length;ve++)me+=" "+ye[ve].name+"="+X(Q(ye[ve].value),"double",a);return me+=">",t.childNodes&&t.childNodes.length&&(me+="..."),me+="</"+R.call(String(t.nodeName))+">"}if($(t)){if(0===t.length)return"[]";var we=fe(t,Y);return j&&!function(e){for(var t=0;t<e.length;t++)if(ae(e[t],"\n")>=0)return!1;return!0}(we)?"["+pe(we,j)+"]":"[ "+U.call(we,", ")+" ]"}if(function(e){return!("[object Error]"!==se(e)||K&&"object"==typeof e&&K in e)}(t)){var _e=fe(t,Y);return"cause"in Error.prototype||!("cause"in t)||D.call(t,"cause")?0===_e.length?"["+String(t)+"]":"{ ["+String(t)+"] "+U.call(_e,", ")+" }":"{ ["+String(t)+"] "+U.call(N.call("[cause]: "+Y(t.cause),_e),", ")+" }"}if("object"==typeof t&&c){if(J&&"function"==typeof t[J]&&V)return V(t,{depth:q-n});if("symbol"!==c&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!i||!e||"object"!=typeof e)return!1;try{i.call(e);try{g.call(e)}catch(me){return!0}return e instanceof Map}catch(t){}return!1}(t)){var be=[];return s&&s.call(t,(function(e,r){be.push(Y(r,t,!0)+" => "+Y(e,t))})),he("Map",i.call(t),be,j)}if(function(e){if(!g||!e||"object"!=typeof e)return!1;try{g.call(e);try{i.call(e)}catch(t){return!0}return e instanceof Set}catch(r){}return!1}(t)){var Ee=[];return y&&y.call(t,(function(e){Ee.push(Y(e,t))})),he("Set",g.call(t),Ee,j)}if(function(e){if(!v||!e||"object"!=typeof e)return!1;try{v.call(e,v);try{w.call(e,w)}catch(me){return!0}return e instanceof WeakMap}catch(t){}return!1}(t))return de("WeakMap");if(function(e){if(!w||!e||"object"!=typeof e)return!1;try{w.call(e,w);try{v.call(e,v)}catch(me){return!0}return e instanceof WeakSet}catch(t){}return!1}(t))return de("WeakSet");if(function(e){if(!_||!e||"object"!=typeof e)return!1;try{return _.call(e),!0}catch(t){}return!1}(t))return de("WeakRef");if(function(e){return!("[object Number]"!==se(e)||K&&"object"==typeof e&&K in e)}(t))return le(Y(Number(t)));if(function(e){if(!e||"object"!=typeof e||!L)return!1;try{return L.call(e),!0}catch(t){}return!1}(t))return le(Y(L.call(t)));if(function(e){return!("[object Boolean]"!==se(e)||K&&"object"==typeof e&&K in e)}(t))return le(b.call(t));if(function(e){return!("[object String]"!==se(e)||K&&"object"==typeof e&&K in e)}(t))return le(Y(String(t)));if(!function(e){return!("[object Date]"!==se(e)||K&&"object"==typeof e&&K in e)}(t)&&!ee(t)){var Se=fe(t,Y),Ce=G?G(t)===Object.prototype:t instanceof Object||t.constructor===Object,Te=t instanceof Object?"":"null prototype",Ie=!Ce&&K&&Object(t)===t&&K in t?I.call(se(t),8,-1):Te?"Object":"",ke=(Ce||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(Ie||Te?"["+U.call(N.call([],Ie||[],Te||[]),": ")+"] ":"");return 0===Se.length?ke+"{}":j?ke+"{"+pe(Se,j)+"}":ke+"{ "+U.call(Se,", ")+" }"}return String(t)};var ne=Object.prototype.hasOwnProperty||function(e){return e in this};function oe(e,t){return ne.call(e,t)}function se(e){return E.call(e)}function ae(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function ce(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return ce(I.call(e,0,t.maxStringLength),t)+n}return X(k.call(k.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,ue),"single",t)}function ue(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+A.call(t.toString(16))}function le(e){return"Object("+e+")"}function de(e){return e+" { ? }"}function he(e,t,r,n){return e+" ("+t+") {"+(n?pe(r,n):U.call(r,", "))+"}"}function pe(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+U.call(e,","+r)+"\n"+t.prev}function fe(e,t){var r=$(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=oe(e,o)?t(e[o],e):""}var i,s="function"==typeof j?j(e):[];if(F){i={};for(var a=0;a<s.length;a++)i["$"+s[a]]=s[a]}for(var c in e)oe(e,c)&&(r&&String(Number(c))===c&&c<e.length||F&&i["$"+c]instanceof Symbol||(O.call(/[^\w$]/,c)?n.push(t(c,e)+": "+t(e[c],e)):n.push(c+": "+t(e[c],e))));if("function"==typeof j)for(var g=0;g<s.length;g++)D.call(e,s[g])&&n.push("["+t(s[g])+"]: "+t(e[s[g]],e));return n}},2490:e=>{"use strict";var t=String.prototype.replace,r=/%20/g,n="RFC1738",o="RFC3986";e.exports={default:o,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:n,RFC3986:o}},3348:(e,t,r)=>{"use strict";var n=r(7530),o=r(8429),i=r(2490);e.exports={formats:i,parse:o,stringify:n}},8429:(e,t,r)=>{"use strict";var n=r(3422),o=Object.prototype.hasOwnProperty,i=Array.isArray,s={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},g=function(e,t,r,n){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,a=r.depth>0&&/(\[[^[\]]*])/.exec(i),g=a?i.slice(0,a.index):i,y=[];if(g){if(!r.plainObjects&&o.call(Object.prototype,g)&&!r.allowPrototypes)return;y.push(g)}for(var v=0;r.depth>0&&null!==(a=s.exec(i))&&v<r.depth;){if(v+=1,!r.plainObjects&&o.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;y.push(a[1])}return a&&y.push("["+i.slice(a.index)+"]"),function(e,t,r,n){for(var o=n?t:c(t,r),i=e.length-1;i>=0;--i){var s,a=e[i];if("[]"===a&&r.parseArrays)s=[].concat(o);else{s=r.plainObjects?Object.create(null):{};var g="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,y=parseInt(g,10);r.parseArrays||""!==g?!isNaN(y)&&a!==g&&String(y)===g&&y>=0&&r.parseArrays&&y<=r.arrayLimit?(s=[])[y]=o:"__proto__"!==g&&(s[g]=o):s={0:o}}o=s}return o}(y,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return s;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?s.charset:e.charset;return{allowDots:void 0===e.allowDots?s.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:s.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:s.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:s.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:s.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:s.comma,decoder:"function"==typeof e.decoder?e.decoder:s.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:s.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:s.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:s.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:s.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:s.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:s.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var y="string"==typeof e?function(e,t){var r,g={__proto__:null},y=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,v=t.parameterLimit===1/0?void 0:t.parameterLimit,w=y.split(t.delimiter,v),_=-1,b=t.charset;if(t.charsetSentinel)for(r=0;r<w.length;++r)0===w[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===w[r]?b="utf-8":"utf8=%26%2310003%3B"===w[r]&&(b="iso-8859-1"),_=r,r=w.length);for(r=0;r<w.length;++r)if(r!==_){var E,S,T=w[r],I=T.indexOf("]="),k=-1===I?T.indexOf("="):I+1;-1===k?(E=t.decoder(T,s.decoder,b,"key"),S=t.strictNullHandling?null:""):(E=t.decoder(T.slice(0,k),s.decoder,b,"key"),S=n.maybeMap(c(T.slice(k+1),t),(function(e){return t.decoder(e,s.decoder,b,"value")}))),S&&t.interpretNumericEntities&&"iso-8859-1"===b&&(S=a(S)),T.indexOf("[]=")>-1&&(S=i(S)?[S]:S),o.call(g,E)?g[E]=n.combine(g[E],S):g[E]=S}return g}(e,r):e,v=r.plainObjects?Object.create(null):{},w=Object.keys(y),_=0;_<w.length;++_){var b=w[_],E=g(b,y[b],r,"string"==typeof e);v=n.merge(v,E,r)}return!0===r.allowSparse?v:n.compact(v)}},7530:(e,t,r)=>{"use strict";var n=r(2538),o=r(3422),i=r(2490),s=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,g=Array.prototype.push,y=function(e,t){g.apply(e,c(t)?t:[t])},v=Date.prototype.toISOString,w=i.default,_={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:o.encode,encodeValuesOnly:!1,format:w,formatter:i.formatters[w],indices:!1,serializeDate:function(e){return v.call(e)},skipNulls:!1,strictNullHandling:!1},b={},E=function e(t,r,i,s,a,g,v,w,E,S,T,I,k,A,R,O){for(var N,U=t,M=O,q=0,L=!1;void 0!==(M=M.get(b))&&!L;){var j=M.get(t);if(q+=1,void 0!==j){if(j===q)throw new RangeError("Cyclic object value");L=!0}void 0===M.get(b)&&(q=0)}if("function"==typeof w?U=w(r,U):U instanceof Date?U=T(U):"comma"===i&&c(U)&&(U=o.maybeMap(U,(function(e){return e instanceof Date?T(e):e}))),null===U){if(a)return v&&!A?v(r,_.encoder,R,"key",I):r;U=""}if("string"==typeof(N=U)||"number"==typeof N||"boolean"==typeof N||"symbol"==typeof N||"bigint"==typeof N||o.isBuffer(U))return v?[k(A?r:v(r,_.encoder,R,"key",I))+"="+k(v(U,_.encoder,R,"value",I))]:[k(r)+"="+k(String(U))];var H,F=[];if(void 0===U)return F;if("comma"===i&&c(U))A&&v&&(U=o.maybeMap(U,v)),H=[{value:U.length>0?U.join(",")||null:void 0}];else if(c(w))H=w;else{var K=Object.keys(U);H=E?K.sort(E):K}for(var D=s&&c(U)&&1===U.length?r+"[]":r,G=0;G<H.length;++G){var W=H[G],V="object"==typeof W&&void 0!==W.value?W.value:U[W];if(!g||null!==V){var Y=c(U)?"function"==typeof i?i(D,W):D:D+(S?"."+W:"["+W+"]");O.set(t,q);var J=n();J.set(b,O),y(F,e(V,Y,i,s,a,g,"comma"===i&&A&&c(U)?null:v,w,E,S,T,I,k,A,R,J))}}return F};e.exports=function(e,t){var r,o=e,g=function(e){if(!e)return _;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||_.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i.default;if(void 0!==e.format){if(!s.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=i.formatters[r],o=_.filter;return("function"==typeof e.filter||c(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:_.addQueryPrefix,allowDots:void 0===e.allowDots?_.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:_.charsetSentinel,delimiter:void 0===e.delimiter?_.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:_.encode,encoder:"function"==typeof e.encoder?e.encoder:_.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:_.encodeValuesOnly,filter:o,format:r,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:_.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:_.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:_.strictNullHandling}}(t);"function"==typeof g.filter?o=(0,g.filter)("",o):c(g.filter)&&(r=g.filter);var v,w=[];if("object"!=typeof o||null===o)return"";v=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var b=a[v];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var S="comma"===b&&t&&t.commaRoundTrip;r||(r=Object.keys(o)),g.sort&&r.sort(g.sort);for(var T=n(),I=0;I<r.length;++I){var k=r[I];g.skipNulls&&null===o[k]||y(w,E(o[k],k,b,S,g.strictNullHandling,g.skipNulls,g.encode?g.encoder:null,g.filter,g.sort,g.allowDots,g.serializeDate,g.format,g.formatter,g.encodeValuesOnly,g.charset,T))}var A=w.join(g.delimiter),R=!0===g.addQueryPrefix?"?":"";return g.charsetSentinel&&("iso-8859-1"===g.charset?R+="utf8=%26%2310003%3B&":R+="utf8=%E2%9C%93&"),A.length>0?R+A:""}},3422:(e,t,r)=>{"use strict";var n=r(2490),o=Object.prototype.hasOwnProperty,i=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],s=o.obj[o.prop],a=Object.keys(s),c=0;c<a.length;++c){var g=a[c],y=s[g];"object"==typeof y&&null!==y&&-1===r.indexOf(y)&&(t.push({obj:s,prop:g}),r.push(y))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(o){return n}},encode:function(e,t,r,o,i){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var c="",g=0;g<a.length;++g){var y=a.charCodeAt(g);45===y||46===y||95===y||126===y||y>=48&&y<=57||y>=65&&y<=90||y>=97&&y<=122||i===n.RFC1738&&(40===y||41===y)?c+=a.charAt(g):y<128?c+=s[y]:y<2048?c+=s[192|y>>6]+s[128|63&y]:y<55296||y>=57344?c+=s[224|y>>12]+s[128|y>>6&63]+s[128|63&y]:(g+=1,y=65536+((1023&y)<<10|1023&a.charCodeAt(g)),c+=s[240|y>>18]+s[128|y>>12&63]+s[128|y>>6&63]+s[128|63&y])}return c},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(i(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(i(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!o.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var s=t;return i(t)&&!i(r)&&(s=a(t,n)),i(t)&&i(r)?(r.forEach((function(r,i){if(o.call(t,i)){var s=t[i];s&&"object"==typeof s&&r&&"object"==typeof r?t[i]=e(s,r,n):t.push(r)}else t[i]=r})),t):Object.keys(r).reduce((function(t,i){var s=r[i];return o.call(t,i)?t[i]=e(t[i],s,n):t[i]=s,t}),s)}}},2124:(e,t,r)=>{"use strict";const n=r(4111),o=r(1133),i=r(4867),s=r(6068),a=Symbol("encodeFragmentIdentifier");function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function g(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function y(e,t){return t.decode?o(e):e}function v(e){return Array.isArray(e)?e.sort():"object"==typeof e?v(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function w(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function _(e){const t=(e=w(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function b(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function E(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const o="string"==typeof r&&r.includes(e.arrayFormatSeparator),i="string"==typeof r&&!o&&y(r,e).includes(e.arrayFormatSeparator);r=i?y(r,e):r;const s=o||i?r.split(e.arrayFormatSeparator).map((t=>y(t,e))):null===r?r:y(r,e);n[t]=s};case"bracket-separator":return(t,r,n)=>{const o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!o)return void(n[t]=r?y(r,e):r);const i=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>y(t,e)));void 0!==n[t]?n[t]=[].concat(n[t],i):n[t]=i};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const o of e.split("&")){if(""===o)continue;let[e,s]=i(t.decode?o.replace(/\+/g," "):o,"=");s=void 0===s?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:y(s,t),r(y(e,t),s,n)}for(const o of Object.keys(n)){const e=n[o];if("object"==typeof e&&null!==e)for(const r of Object.keys(e))e[r]=b(e[r],t);else n[o]=b(e,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=v(r):e[t]=r,e}),Object.create(null))}t.extract=_,t.parse=E,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const o=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[g(t,e),"[",o,"]"].join("")]:[...r,[g(t,e),"[",g(o,e),"]=",g(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[g(t,e),"[]"].join("")]:[...r,[g(t,e),"[]=",g(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[g(t,e),":list="].join("")]:[...r,[g(t,e),":list=",g(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?n:(o=null===o?"":o,0===n.length?[[g(r,e),t,g(o,e)].join("")]:[[n,g(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,g(t,e)]:[...r,[g(t,e),"=",g(n,e)].join("")]}}(t),o={};for(const s of Object.keys(e))r(s)||(o[s]=e[s]);const i=Object.keys(o);return!1!==t.sort&&i.sort(t.sort),i.map((r=>{const o=e[r];return void 0===o?"":null===o?g(r,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?g(r,t)+"[]":o.reduce(n(r),[]).join("&"):g(r,t)+"="+g(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=i(e,"#");return Object.assign({url:r.split("?")[0]||"",query:E(_(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:y(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0,[a]:!0},r);const n=w(e.url).split("?")[0]||"",o=t.extract(e.url),i=t.parse(o,{sort:!1}),s=Object.assign(i,e.query);let c=t.stringify(s,r);c&&(c=`?${c}`);let y=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(y=`#${r[a]?g(e.fragmentIdentifier,r):e.fragmentIdentifier}`),`${n}${c}${y}`},t.pick=(e,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[a]:!1},n);const{url:o,query:i,fragmentIdentifier:c}=t.parseUrl(e,n);return t.stringifyUrl({url:o,query:s(i,r),fragmentIdentifier:c},n)},t.exclude=(e,r,n)=>{const o=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return t.pick(e,o,n)}},2538:(e,t,r)=>{"use strict";var n=r(1528),o=r(7737),i=r(3970),s=n("%TypeError%"),a=n("%WeakMap%",!0),c=n("%Map%",!0),g=o("WeakMap.prototype.get",!0),y=o("WeakMap.prototype.set",!0),v=o("WeakMap.prototype.has",!0),w=o("Map.prototype.get",!0),_=o("Map.prototype.set",!0),b=o("Map.prototype.has",!0),E=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new s("Side channel does not contain "+i(e))},get:function(n){if(a&&n&&("object"==typeof n||"function"==typeof n)){if(e)return g(e,n)}else if(c){if(t)return w(t,n)}else if(r)return function(e,t){var r=E(e,t);return r&&r.value}(r,n)},has:function(n){if(a&&n&&("object"==typeof n||"function"==typeof n)){if(e)return v(e,n)}else if(c){if(t)return b(t,n)}else if(r)return function(e,t){return!!E(e,t)}(r,n);return!1},set:function(n,o){a&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new a),y(e,n,o)):c?(t||(t=new c),_(t,n,o)):(r||(r={key:{},next:null}),function(e,t,r){var n=E(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,o))}};return n}},4867:e=>{"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},4111:e=>{"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},7968:(e,t,r)=>{const n=r(1577).R;t.s=function(e){if(e||(e=1),!r.y.meta||!r.y.meta.url)throw console.error("__system_context__",r.y),Error("systemjs-webpack-interop was provided an unknown SystemJS context. Expected context.meta.url, but none was provided");r.p=n(r.y.meta.url,e)}},1577:(e,t,r)=>{function n(e,t){var r=document.createElement("a");r.href=e;for(var n="/"===r.pathname[0]?r.pathname:"/"+r.pathname,o=0,i=n.length;o!==t&&i>=0;){"/"===n[--i]&&o++}if(o!==t)throw Error("systemjs-webpack-interop: rootDirectoryLevel ("+t+") is greater than the number of directories ("+o+") in the URL path "+e);var s=n.slice(0,i+1);return r.protocol+"//"+r.host+s}t.m=function(e,t){if(t||(t=1),"string"!=typeof e||0===e.trim().length)throw Error("systemjs-webpack-interop: setPublicPath(systemjsModuleName) must be called with a non-empty string 'systemjsModuleName'");if("number"!=typeof t||t<=0||isNaN(t)||!o(t))throw Error("systemjs-webpack-interop: setPublicPath(systemjsModuleName, rootDirectoryLevel) must be called with a positive integer 'rootDirectoryLevel'");var i;try{if(!(i=window.System.resolve(e)))throw Error()}catch(s){throw Error("systemjs-webpack-interop: There is no such module '"+e+"' in the SystemJS registry. Did you misspell the name of your module?")}r.p=n(i,t)},t.R=n;var o=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},7333:function(e,t,r){var n;e=r.nmd(e),function(o){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof global&&global;i.global!==i&&i.window!==i&&i.self;var s,a=2147483647,c=36,g=1,y=26,v=38,w=700,_=72,b=128,E="-",S=/^xn--/,T=/[^\x20-\x7E]/,I=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=c-g,R=Math.floor,O=String.fromCharCode;function N(e){throw new RangeError(k[e])}function U(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function M(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+U((e=e.replace(I,".")).split("."),t).join(".")}function q(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function L(e){return U(e,(function(e){var t="";return e>65535&&(t+=O((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=O(e)})).join("")}function j(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function H(e,t,r){var n=0;for(e=r?R(e/w):e>>1,e+=R(e/t);e>A*y>>1;n+=c)e=R(e/A);return R(n+(A+1)*e/(e+v))}function F(e){var t,r,n,o,i,s,v,w,S,T,I,k=[],A=e.length,O=0,U=b,M=_;for((r=e.lastIndexOf(E))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&N("not-basic"),k.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<A;){for(i=O,s=1,v=c;o>=A&&N("invalid-input"),((w=(I=e.charCodeAt(o++))-48<10?I-22:I-65<26?I-65:I-97<26?I-97:c)>=c||w>R((a-O)/s))&&N("overflow"),O+=w*s,!(w<(S=v<=M?g:v>=M+y?y:v-M));v+=c)s>R(a/(T=c-S))&&N("overflow"),s*=T;M=H(O-i,t=k.length+1,0==i),R(O/t)>a-U&&N("overflow"),U+=R(O/t),O%=t,k.splice(O++,0,U)}return L(k)}function K(e){var t,r,n,o,i,s,v,w,S,T,I,k,A,U,M,L=[];for(k=(e=q(e)).length,t=b,r=0,i=_,s=0;s<k;++s)(I=e[s])<128&&L.push(O(I));for(n=o=L.length,o&&L.push(E);n<k;){for(v=a,s=0;s<k;++s)(I=e[s])>=t&&I<v&&(v=I);for(v-t>R((a-r)/(A=n+1))&&N("overflow"),r+=(v-t)*A,t=v,s=0;s<k;++s)if((I=e[s])<t&&++r>a&&N("overflow"),I==t){for(w=r,S=c;!(w<(T=S<=i?g:S>=i+y?y:S-i));S+=c)M=w-T,U=c-T,L.push(O(j(T+M%U,0))),w=R(M/U);L.push(O(j(w,0))),i=H(r,A,n==o),r=0,++n}++r,++t}return L.join("")}s={version:"1.4.1",ucs2:{decode:q,encode:L},decode:F,encode:K,toASCII:function(e){return M(e,(function(e){return T.test(e)?"xn--"+K(e):e}))},toUnicode:function(e){return M(e,(function(e){return S.test(e)?F(e.slice(4).toLowerCase()):e}))}},void 0===(n=(function(){return s}).call(t,r,t,e))||(e.exports=n)}()},1662:(e,t,r)=>{"use strict";var n=r(7333);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var i=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),g=["'"].concat(c),y=["%","/","?",";","#"].concat(g),v=["/","?","#"],w=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},T=r(3348);function I(e,t,r){if(e&&"object"==typeof e&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var I=e=c.join(s);if(I=I.trim(),!r&&1===e.split("#").length){var k=a.exec(I);if(k)return this.path=I,this.href=I,this.pathname=k[1],k[2]?(this.search=k[2],this.query=t?T.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var A=i.exec(I);if(A){var R=(A=A[0]).toLowerCase();this.protocol=R,I=I.substr(A.length)}if(r||A||I.match(/^\/\/[^@/]+@[^@/]+/)){var O="//"===I.substr(0,2);!O||A&&E[A]||(I=I.substr(2),this.slashes=!0)}if(!E[A]&&(O||A&&!S[A])){for(var N,U,M=-1,q=0;q<v.length;q++){-1!==(L=I.indexOf(v[q]))&&(-1===M||L<M)&&(M=L)}-1!==(U=-1===M?I.lastIndexOf("@"):I.lastIndexOf("@",M))&&(N=I.slice(0,U),I=I.slice(U+1),this.auth=decodeURIComponent(N)),M=-1;for(q=0;q<y.length;q++){var L;-1!==(L=I.indexOf(y[q]))&&(-1===M||L<M)&&(M=L)}-1===M&&(M=I.length),this.host=I.slice(0,M),I=I.slice(M),this.parseHost(),this.hostname=this.hostname||"";var j="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!j)for(var H=this.hostname.split(/\./),F=(q=0,H.length);q<F;q++){var K=H[q];if(K&&!K.match(w)){for(var D="",G=0,W=K.length;G<W;G++)K.charCodeAt(G)>127?D+="x":D+=K[G];if(!D.match(w)){var V=H.slice(0,q),Y=H.slice(q+1),J=K.match(_);J&&(V.push(J[1]),Y.unshift(J[2])),Y.length&&(I="/"+Y.join(".")+I),this.hostname=V.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),j||(this.hostname=n.toASCII(this.hostname));var X=this.port?":"+this.port:"",Q=this.hostname||"";this.host=Q+X,this.href+=this.host,j&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==I[0]&&(I="/"+I))}if(!b[R])for(q=0,F=g.length;q<F;q++){var $=g[q];if(-1!==I.indexOf($)){var ee=encodeURIComponent($);ee===$&&(ee=escape($)),I=I.split($).join(ee)}}var re=I.indexOf("#");-1!==re&&(this.hash=I.substr(re),I=I.slice(0,re));var ne=I.indexOf("?");if(-1!==ne?(this.search=I.substr(ne),this.query=I.substr(ne+1),t&&(this.query=T.parse(this.query)),I=I.slice(0,ne)):t&&(this.search="",this.query={}),I&&(this.pathname=I),S[R]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){X=this.pathname||"";var oe=this.search||"";this.path=X+oe}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(i=T.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||S[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(I(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if("string"==typeof e){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var g=a[c];"protocol"!==g&&(r[g]=e[g])}return S[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!S[e.protocol]){for(var y=Object.keys(e),v=0;v<y.length;v++){var w=y[v];r[w]=e[w]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||E[e.protocol])r.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),r.pathname=_.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var b=r.pathname||"",T=r.search||"";r.path=b+T}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var I=r.pathname&&"/"===r.pathname.charAt(0),k=e.host||e.pathname&&"/"===e.pathname.charAt(0),A=k||I||r.host&&e.pathname,R=A,O=r.pathname&&r.pathname.split("/")||[],N=(_=e.pathname&&e.pathname.split("/")||[],r.protocol&&!S[r.protocol]);if(N&&(r.hostname="",r.port=null,r.host&&(""===O[0]?O[0]=r.host:O.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),A=A&&(""===_[0]||""===O[0])),k)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,O=_;else if(_.length)O||(O=[]),O.pop(),O=O.concat(_),r.search=e.search,r.query=e.query;else if(null!=e.search){if(N)r.host=O.shift(),r.hostname=r.host,(j=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=j.shift(),r.hostname=j.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!O.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var U=O.slice(-1)[0],M=(r.host||e.host||O.length>1)&&("."===U||".."===U)||""===U,q=0,L=O.length;L>=0;L--)"."===(U=O[L])?O.splice(L,1):".."===U?(O.splice(L,1),q++):q&&(O.splice(L,1),q--);if(!A&&!R)for(;q--;q)O.unshift("..");!A||""===O[0]||O[0]&&"/"===O[0].charAt(0)||O.unshift(""),M&&"/"!==O.join("/").substr(-1)&&O.push("");var j,H=""===O[0]||O[0]&&"/"===O[0].charAt(0);N&&(r.hostname=H?"":O.length?O.shift():"",r.host=r.hostname,(j=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=j.shift(),r.hostname=j.shift(),r.host=r.hostname));return(A=A||r.host&&O.length)&&!H&&O.unshift(""),O.length>0?r.pathname=O.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=I,t.resolve=function(e,t){return I(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?I(e,!1,!0).resolveObject(t):t},t.format=function(e){return"string"==typeof e&&(e=I(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o},8056:()=>{},5503:()=>{}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.y=t,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="";var o={};return(0,n(7968).s)(1),(()=>{"use strict";n.r(o),n.d(o,{createSdkClient:()=>Up,default:()=>Dp,getFlow:()=>Hp,getSDK:()=>qp,getToken:()=>Fp,getUserInformation:()=>jp,isUsingUnifiedSignin:()=>oo,loginAndAuthIfNeeded:()=>Gp,logout:()=>Kp,unifiedSignInAppName:()=>no});function e(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(Eo){i(Eo)}}function a(e){try{c(n.throw(e))}catch(Eo){i(Eo)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var t=n(1054);const r="@cognite/fusion/selected-idp-details",i=["COGNITE_AUTH","AZURE_AD","ADFS2016","AUTH0","AAD_B2C","KEYCLOAK","COGNITE_IDP"],s=()=>{var e;try{const t=null!==(e=localStorage.getItem(r))&&void 0!==e?e:"",n=JSON.parse(t);if("string"!=typeof(null==n?void 0:n.internalId))throw new Error("Idp internalId is invalid");if(!i.includes(null==n?void 0:n.type))throw new Error("Idp type is invalid");return n}catch(t){return}};var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},a(e,t)};function c(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var g=function(){return g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)};function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(Eo){i(Eo)}}function a(e){try{c(n.throw(e))}catch(Eo){i(Eo)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(Eo){i=[6,Eo],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function w(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}var b=function(e,t){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},b(e,t)};function E(e,t){function r(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var S=function(){return S=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},S.apply(this,arguments)};function T(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(Eo){i(Eo)}}function a(e){try{c(n.throw(e))}catch(Eo){i(Eo)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function I(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(Eo){i=[6,Eo],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function k(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}var A,R,O,N,U,M="msal.js.common",q="msal",L="https://login.microsoftonline.com/common/",j="adfs",H="https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",F="|",K="openid",D="profile",G="offline_access",W="code",V="S256",Y="application/x-www-form-urlencoded;charset=utf-8",J="authorization_pending",X="not_defined",Q="",$="/";!function(e){e.CONTENT_TYPE="Content-Type",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.RETRY_AFTER="Retry-After",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_MS_LIB_CAPABILITY_VALUE="retry-after, h429"}(A||(A={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description"}(R||(R={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(O||(O={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci"}(N||(N={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(U||(U={}));var ee,re={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(ee||(ee={}));ee.SID,ee.LOGIN_HINT;var ne,oe,se,ae,ce,ue,le,de={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(ne||(ne={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(oe||(oe={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(se||(se={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(ae||(ae={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken"}(ce||(ce={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(ue||(ue={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(le||(le={}));var he,pe="appmetadata",fe="1",ge="authority-metadata",me=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(he||(he={}));var ye,ve={SCHEMA_VERSION:2,MAX_HEADER_BYTES:4e3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.POP="pop",e.BEARER="Bearer"}(ye||(ye={}));var we,_e=60,be=3600,Ee="throttling",Se="invalid_grant",Ce="client_mismatch";!function(e){e.username="username",e.password="password"}(we||(we={}));var Te,Ie={code:"unexpected_error",desc:"Unexpected error in authentication."},ke=function(e){function t(r,n,o){var i=this,s=n?r+": "+n:r;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||Q,i.errorMessage=n||"",i.subError=o||"",i.name="AuthError",i}return E(t,e),t.createUnexpectedError=function(e){return new t(Ie.code,Ie.desc+": "+e)},t}(Error),Ae={createNewGuid:function(){throw ke.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ke.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ke.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return T(this,void 0,void 0,(function(){return I(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",ke.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return T(this,void 0,void 0,(function(){return I(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",ke.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},signJwt:function(){return T(this,void 0,void 0,(function(){return I(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",ke.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))}},Re={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},Pe={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},Oe={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},Ne={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},Ue={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},Me={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},xe={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},qe={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},Le={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},je={code:"state_not_found",desc:"State not found"},He={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},Fe={code:"nonce_not_found",desc:"nonce not found"},Ke={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},De={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},Be={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},Ge={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},We={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},ze={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},Ve={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},Ye={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},Je={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},Ze={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Xe={code:"device_code_expired",desc:"Device code is expired."},Qe={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},$e={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},et={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},tt={code:"no_account_found",desc:"No account found in cache for given key."},rt={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},nt={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},ot={code:"invalid_cache_type",desc:"Invalid cache type"},it={code:"unexpected_account_type",desc:"Unexpected account type."},st={code:"unexpected_credential_type",desc:"Unexpected credential type."},at={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},ct={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},ut={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},lt={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},dt={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},ht={code:"authorization_code_missing_from_server_response",desc:"Srver response does not contain an authorization code to proceed"},pt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return E(t,e),t.createClientInfoDecodingError=function(e){return new t(Re.code,Re.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(Pe.code,""+Pe.desc)},t.createTokenParsingError=function(e){return new t(Oe.code,Oe.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(Ne.code,Ne.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(Ue.code,Ue.desc+" Detail: "+e)},t.createUnableToGetOpenidConfigError=function(e){return new t(Me.code,Me.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(xe.code,xe.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(qe.code,qe.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(Le.code,Le.desc)},t.createStateNotFoundError=function(e){return new t(je.code,je.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(He.code,He.desc)},t.createNonceNotFoundError=function(e){return new t(Fe.code,Fe.desc+":  "+e)},t.createNoTokensFoundError=function(){return new t(Ke.code,Ke.desc)},t.createMultipleMatchingTokensInCacheError=function(){return new t(De.code,De.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(Be.code,Be.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(Ge.code,Ge.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(We.code,We.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(ze.code,ze.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(Ve.code,Ve.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(Ye.code,Ye.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(e){return new t(Je.code,Je.desc+" Given ScopeSet: "+e)},t.createDeviceCodeCancelledError=function(){return new t(Ze.code,""+Ze.desc)},t.createDeviceCodeExpiredError=function(){return new t(Xe.code,""+Xe.desc)},t.createNoAccountInSilentRequestError=function(){return new t(Qe.code,""+Qe.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t($e.code,$e.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(et.code,et.desc)},t.createNoAccountFoundError=function(){return new t(tt.code,tt.desc)},t.createCachePluginError=function(){return new t(rt.code,""+rt.desc)},t.createNoCryptoObjectError=function(e){return new t(nt.code,""+nt.desc+e)},t.createInvalidCacheTypeError=function(){return new t(ot.code,""+ot.desc)},t.createUnexpectedAccountTypeError=function(){return new t(it.code,""+it.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(st.code,""+st.desc)},t.createInvalidAssertionError=function(){return new t(at.code,""+at.desc)},t.createInvalidCredentialError=function(){return new t(ct.code,""+ct.desc)},t.createRefreshRequiredError=function(){return new t(ut.code,ut.desc)},t.createUserTimeoutReachedError=function(){return new t(lt.code,lt.desc)},t.createTokenClaimsRequiredError=function(){return new t(dt.code,dt.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(ht.code,ht.desc)},t}(ke),ft=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw pt.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw pt.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(Eo){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\*/g,"[^ ]*")).test(t)},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Te||(Te={}));var gt,mt=function(){function e(e,t,r){this.level=Te.Info;this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=e.logLevel||Te.Info,this.packageName=t||Q,this.packageVersion=r||Q}return e.prototype.clone=function(t,r){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(ft.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+Te[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:Te.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:Te.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:Te.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:Te.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:Te.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:Te.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:Te.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:Te.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),yt="3.1.0",vt=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},e.prototype.generateType=function(){switch(this.credentialType){case ce.ID_TOKEN:return le.ID_TOKEN;case ce.ACCESS_TOKEN:return le.ACCESS_TOKEN;case ce.REFRESH_TOKEN:return le.REFRESH_TOKEN;default:throw pt.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(ce.ACCESS_TOKEN.toLowerCase())?ce.ACCESS_TOKEN:-1!==e.indexOf(ce.ID_TOKEN.toLowerCase())?ce.ID_TOKEN:-1!==e.indexOf(ce.REFRESH_TOKEN.toLowerCase())?ce.REFRESH_TOKEN:X},e.generateCredentialCacheKey=function(e,t,r,n,o,i,s){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,s),this.generateTargetForCacheKey(i)].join(ae.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(ae.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===ce.REFRESH_TOKEN&&n||t,r||""].join(ae.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),wt={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},_t={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},bt={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Et={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},St={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Ct={code:"empty_url_error",desc:"URL was empty or null."},Tt={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},It={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},kt={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},At={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Rt={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},Pt={code:"token_request_empty",desc:"Token request was empty and not found in cache."},Ot={code:"logout_request_empty",desc:"The logout request was null or undefined."},Nt={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},Ut={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},Mt={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},xt={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a JSON object containing authorization_endpoint, token_endpoint, end_session_endpoint, issuer fields."},qt={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},Lt={code:"resourceRequest_parameters_required",desc:"resourceRequestMethod and resourceRequestUri are required"},jt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return E(t,e),t.createRedirectUriEmptyError=function(){return new t(wt.code,wt.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(_t.code,_t.desc)},t.createClaimsRequestParsingError=function(e){return new t(bt.code,bt.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Et.code,Et.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(St.code,St.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Ct.code,Ct.desc)},t.createScopesNonArrayError=function(e){return new t(It.code,It.desc+" Given Scopes: "+e)},t.createEmptyScopesArrayError=function(e){return new t(Tt.code,Tt.desc+" Given Scopes: "+e)},t.createClientIdSingleScopeError=function(e){return new t(kt.code,kt.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(At.code,At.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Rt.code,Rt.desc)},t.createEmptyLogoutRequestError=function(){return new t(Ot.code,Ot.desc)},t.createEmptyTokenRequestError=function(){return new t(Pt.code,Pt.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(Nt.code,Nt.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(Ut.code,Ut.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Mt.code,Mt.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(xt.code,xt.desc)},t.createUntrustedAuthorityError=function(){return new t(qt.code,qt.desc)},t.createResourceRequestParametersRequiredError=function(){return new t(Lt.code,Lt.desc)},t}(pt),Ht=function(){function e(e){var t=this,r=e?ft.trimArrayEntries(k(e)):[],n=r?ft.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t=t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw jt.createEmptyScopesArrayError(e)},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!ft.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyDefaultScopes=function(){var e=0;return this.containsScope(K)&&(e+=1),this.containsScope(D)&&(e+=1),this.containsScope(G)&&(e+=1),this.scopes.size===e},e.prototype.appendScope=function(e){ft.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(Eo){throw pt.createAppendScopeSetError(Eo)}},e.prototype.removeScope=function(e){if(ft.isEmpty(e))throw pt.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeDefaultScopes=function(){this.scopes.delete(G),this.scopes.delete(K),this.scopes.delete(D)},e.prototype.unionScopeSets=function(e){if(!e)throw pt.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw pt.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e);e.containsOnlyDefaultScopes()||e.removeDefaultScopes();var r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function Ft(e,t){if(ft.isEmpty(e))throw pt.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(Eo){throw pt.createClientInfoDecodingError(Eo)}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(gt||(gt={}));var Kt=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(ae.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case se.ADFS_ACCOUNT_TYPE:return le.ADFS;case se.MSAV1_ACCOUNT_TYPE:return le.MSA;case se.MSSTS_ACCOUNT_TYPE:return le.MSSTS;case se.GENERIC_ACCOUNT_TYPE:return le.GENERIC;default:throw pt.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(ae.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,s,a){var c,g,y,v,w,_,b=new e;b.authorityType=se.MSSTS_ACCOUNT_TYPE,b.clientInfo=t,b.homeAccountId=r;var E=n.getPreferredCache();if(ft.isEmpty(E))throw pt.createInvalidCacheEnvironmentError();return b.environment=E,b.realm=(null===(c=null==o?void 0:o.claims)||void 0===c?void 0:c.tid)||"",b.oboAssertion=i,o&&(b.idTokenClaims=o.claims,b.localAccountId=(null===(g=null==o?void 0:o.claims)||void 0===g?void 0:g.oid)||(null===(y=null==o?void 0:o.claims)||void 0===y?void 0:y.sub)||"",b.username=(null===(v=null==o?void 0:o.claims)||void 0===v?void 0:v.preferred_username)||((null===(w=null==o?void 0:o.claims)||void 0===w?void 0:w.emails)?o.claims.emails[0]:""),b.name=null===(_=null==o?void 0:o.claims)||void 0===_?void 0:_.name),b.cloudGraphHostName=s,b.msGraphHost=a,b},e.createGenericAccount=function(t,r,n,o,i,s){var a,c,g,y,v=new e;v.authorityType=t.authorityType===gt.Adfs?se.ADFS_ACCOUNT_TYPE:se.GENERIC_ACCOUNT_TYPE,v.homeAccountId=r,v.realm="",v.oboAssertion=o;var w=t.getPreferredCache();if(ft.isEmpty(w))throw pt.createInvalidCacheEnvironmentError();return n&&(v.localAccountId=(null===(a=null==n?void 0:n.claims)||void 0===a?void 0:a.oid)||(null===(c=null==n?void 0:n.claims)||void 0===c?void 0:c.sub)||"",v.username=(null===(g=null==n?void 0:n.claims)||void 0===g?void 0:g.upn)||"",v.name=(null===(y=null==n?void 0:n.claims)||void 0===y?void 0:y.name)||"",v.idTokenClaims=null==n?void 0:n.claims),v.environment=w,v.cloudGraphHostName=i,v.msGraphHost=s,v},e.generateHomeAccountId=function(e,t,r,n,o){var i,s=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:Q;if(t===gt.Adfs)return s;if(e){var a=Ft(e,n);if(!ft.isEmpty(a.uid)&&!ft.isEmpty(a.utid))return""+a.uid+ae.CLIENT_INFO_SEPARATOR+a.utid}return r.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t){return!(!e||!t)&&(e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment)},e}(),Dt=function(){function e(t,r){if(ft.isEmpty(t))throw pt.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=ft.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(i){throw pt.createTokenParsingError(i)}},e}(),Bt=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new Kt,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idTokenClaims=new Dt(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){if(!e)throw pt.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},e.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:ce.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=Ht.fromString(e.target),o=Object.keys(r.accessTokens).map((function(e){return r.accessTokens[e]}));o&&o.forEach((function(e){Ht.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)})),this.setAccessTokenCredential(e)},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var s=n.getAccount(o);s&&(e&&!n.matchHomeAccountId(s,e)||t&&!n.matchEnvironment(s,t)||r&&!n.matchRealm(s,r)||(i[o]=s))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i,s,a){var c=this,g=this.getKeys(),y={idTokens:{},accessTokens:{},refreshTokens:{}};return g.forEach((function(g){var v=vt.getCredentialType(g);if(v!==X){var w=c.getSpecificCredential(g,v);if(w&&(!a||c.matchOboAssertion(w,a))&&(!e||c.matchHomeAccountId(w,e))&&(!t||c.matchEnvironment(w,t))&&(!i||c.matchRealm(w,i))&&(!r||c.matchCredentialType(w,r))&&(!n||c.matchClientId(w,n))&&(!o||c.matchFamilyId(w,o))&&(!s||c.matchTarget(w,s)))switch(v){case ce.ID_TOKEN:y.idTokens[g]=w;break;case ce.ACCESS_TOKEN:y.accessTokens[g]=w;break;case ce.REFRESH_TOKEN:y.refreshTokens[g]=w}}})),y},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach((function(t){e.getAccount(t)&&e.removeAccount(t)})),!0},e.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw pt.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,ue.ACCOUNT)},e.prototype.removeAccountContext=function(e){var t=this,r=this.getKeys(),n=e.generateAccountId();return r.forEach((function(e){var r=vt.getCredentialType(e);if(r!==X){var o=t.getSpecificCredential(e,r);o&&n===o.generateAccountId()&&t.removeCredential(o)}})),!0},e.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,ue.CREDENTIAL)},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,ue.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n){var o=this.readAccountFromCache(e),i=this.readIdTokenFromCache(t,e),s=this.readAccessTokenFromCache(t,e,r),a=this.readRefreshTokenFromCache(t,e,!1),c=this.readAppMetadataFromCache(n,t);return o&&i&&(o.idTokenClaims=new Dt(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:s,refreshToken:a,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=Kt.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:ce.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),i=o.length;if(i<1)return null;if(i>1)throw pt.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.readAccessTokenFromCache=function(e,t,r){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:ce.ACCESS_TOKEN,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},o=this.getCredentialsFilteredBy(n),i=Object.keys(o.accessTokens).map((function(e){return o.accessTokens[e]})),s=i.length;if(s<1)return null;if(s>1)throw pt.createMultipleMatchingTokensInCacheError();return i[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?fe:void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:ce.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),s=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return s.length<1?null:s[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw pt.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==fe)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==ce.ACCESS_TOKEN||!e.target)return!1;var r=Ht.fromString(e.target),n=Ht.fromString(t);return n.containsOnlyDefaultScopes()||n.removeDefaultScopes(),r.containsScopeSet(n)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(pe)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(ge)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return ge+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case ce.ID_TOKEN:return this.getIdTokenCredential(e);case ce.ACCESS_TOKEN:return this.getAccessTokenCredential(e);case ce.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),Gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.prototype.setAccount=function(){throw ke.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ke.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ke.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ke.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ke.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ke.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ke.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ke.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ke.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ke.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ke.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ke.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ke.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ke.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ke.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ke.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ke.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ke.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ke.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ke.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){throw ke.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},t}(Bt),Wt={tokenRenewalOffsetSeconds:300},zt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Te.Info},Vt={sendGetRequestAsync:function(){return T(this,void 0,void 0,(function(){return I(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",ke.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return T(this,void 0,void 0,(function(){return I(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",ke.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Yt={sku:M,version:yt,cpu:"",os:""},Jt={clientSecret:"",clientAssertion:void 0};var Zt,Xt=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return E(t,e),t}(ke),Qt=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return Ee+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o,ue.THROTTLING);throw new Xt((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||Q,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[A.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(A.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){e<=0&&(e=0);var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||_e),t+be))},e.removeThrottle=function(e,t,r,n,o){var i={clientId:t,authority:r,scopes:n,homeAccountIdentifier:o},s=this.generateThrottlingStorageKey(i);return e.removeItem(s,ue.THROTTLING)},e}(),$t=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return T(this,void 0,void 0,(function(){var n;return I(this,(function(o){switch(o.label){case 0:return Qt.preProcess(this.cacheManager,e),[4,this.networkClient.sendPostRequestAsync(t,r)];case 1:return n=o.sent(),Qt.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),er=function(){function e(e){this.config=function(e){var t,r=e.authOptions,n=e.systemOptions,o=e.loggerOptions,i=e.storageInterface,s=e.networkInterface,a=e.cryptoInterface,c=e.clientCredentials,g=e.libraryInfo,y=e.serverTelemetryManager,v=e.persistencePlugin,w=e.serializableCache;return{authOptions:(t=r,S({clientCapabilities:[]},t)),systemOptions:S(S({},Wt),n),loggerOptions:S(S({},zt),o),storageInterface:i||new Gt(r.clientId,Ae),networkInterface:s||Vt,cryptoInterface:a||Ae,clientCredentials:c||Jt,libraryInfo:S(S({},Yt),g),serverTelemetryManager:y||null,persistencePlugin:v||null,serializableCache:w||null}}(e),this.logger=new mt(this.config.loggerOptions,"@azure/msal-common",yt),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new $t(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[A.CONTENT_TYPE]=Y,e[A.X_MS_LIB_CAPABILITY]=A.X_MS_LIB_CAPABILITY_VALUE,this.serverTelemetryManager&&(e[A.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[A.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},e.prototype.createDefaultLibraryHeaders=function(){var e={};return e[N.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[N.X_CLIENT_VER]=this.config.libraryInfo.version,e[N.X_CLIENT_OS]=this.config.libraryInfo.os,e[N.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return T(this,void 0,void 0,(function(){var o;return I(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw pt.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),tr=function(){function e(){}return e.validateRedirectUri=function(e){if(ft.isEmpty(e))throw jt.createRedirectUriEmptyError()},e.validatePrompt=function(e){if([re.LOGIN,re.SELECT_ACCOUNT,re.CONSENT,re.NONE].indexOf(e)<0)throw jt.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(Eo){throw jt.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(ft.isEmpty(e)||ft.isEmpty(t))throw jt.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([de.PLAIN,de.S256].indexOf(e)<0)throw jt.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),rr=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(N.RESPONSE_TYPE,encodeURIComponent(W))},e.prototype.addResponseMode=function(e){this.parameters.set(N.RESPONSE_MODE,encodeURIComponent(e||ne.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?k(e||[],[K,D]):e||[],n=new Ht(r);this.parameters.set(N.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(N.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){tr.validateRedirectUri(e),this.parameters.set(N.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){tr.validateRedirectUri(e),this.parameters.set(N.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(N.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(ee.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(ee.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addSid=function(e){this.parameters.set(ee.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);tr.validateClaims(r),this.parameters.set(N.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(N.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(N.X_CLIENT_SKU,e.sku),this.parameters.set(N.X_CLIENT_VER,e.version),this.parameters.set(N.X_CLIENT_OS,e.os),this.parameters.set(N.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){tr.validatePrompt(e),this.parameters.set(""+N.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){ft.isEmpty(e)||this.parameters.set(N.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(N.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(tr.validateCodeChallengeParams(e,t),!e||!t)throw jt.createInvalidCodeChallengeParamsError();this.parameters.set(N.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(N.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(N.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(N.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(N.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(N.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(N.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(N.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(N.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(N.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(N.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(N.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;tr.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(Eo){throw jt.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(U.ACCESS_TOKEN)||(r[U.ACCESS_TOKEN]={}),r[U.ACCESS_TOKEN][U.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(we.username,e)},e.prototype.addPassword=function(e){this.parameters.set(we.password,e)},e.prototype.addPopToken=function(e){ft.isEmpty(e)||(this.parameters.set(N.TOKEN_TYPE,ye.POP),this.parameters.set(N.REQ_CNF,encodeURIComponent(e)))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.createIdTokenEntity=function(e,r,n,o,i,s){var a=new t;return a.credentialType=ce.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=o,a.secret=n,a.realm=i,a.oboAssertion=s,a},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===ce.ID_TOKEN)},t}(vt),or=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e}(),ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,s,a,c,g,y){var v=new t;v.homeAccountId=e,v.credentialType=ce.ACCESS_TOKEN,v.secret=n;var w=or.nowSeconds();return v.cachedAt=w.toString(),v.expiresOn=a.toString(),v.extendedExpiresOn=c.toString(),v.environment=r,v.clientId=o,v.realm=i,v.target=s,v.oboAssertion=y,v.tokenType=ft.isEmpty(g)?ye.BEARER:g,v},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===ce.ACCESS_TOKEN)},t}(vt),sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,s){var a=new t;return a.clientId=o,a.credentialType=ce.REFRESH_TOKEN,a.environment=r,a.homeAccountId=e,a.secret=n,a.oboAssertion=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===ce.REFRESH_TOKEN)},t}(vt),ar=["interaction_required","consent_required","login_required"],cr=["message_only","additional_action","basic_action","user_password_expired","consent_required"],ur=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return E(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&ar.indexOf(e)>-1,o=!!r&&cr.indexOf(r)>-1,i=!!t&&ar.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t}(Xt),lr=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},dr=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return ft.isEmpty(r)?o:""+o+F+r},e.generateLibraryState=function(e,t){if(!e)throw pt.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw pt.createNoCryptoObjectError("parseRequestState");if(ft.isEmpty(t))throw pt.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(F),n=r[0],o=r.length>1?r.slice(1).join(F):"",i=e.base64Decode(n),s=JSON.parse(i);return{userRequestState:ft.isEmpty(o)?"":o,libraryState:s}}catch(Eo){throw pt.createInvalidStateError(t,Eo)}},e}(),hr=function(){function e(t){if(this._urlString=t,ft.isEmpty(this._urlString))throw jt.createUrlEmptyError();ft.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),e.canonicalizeUri=function(e){return e&&(e=e.toLowerCase(),ft.endsWith(e,"?")?e=e.slice(0,-1):ft.endsWith(e,"?/")&&(e=e.slice(0,-2)),ft.endsWith(e,"/")||(e+="/")),e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(Eo){throw jt.createUrlParseError(Eo)}if(!e.HostNameAndPort||!e.PathSegments)throw jt.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw jt.createInsecureAuthorityUriError(this.urlString)},e.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==O.COMMON&&n[0]!==O.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw jt.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!ft.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw jt.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===$){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(ft.isEmpty(t))return{};var r=e.parseHash(t),n=ft.queryStringToObject(ft.isEmpty(r)?t:r);if(!n)throw pt.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(ft.isEmpty(t))return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}();!function(e){e.SW="sw",e.UHW="uhw"}(Zt||(Zt={}));var pr,fr=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e,t){return T(this,void 0,void 0,(function(){var r,n;return I(this,(function(o){switch(o.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e,t)];case 1:return r=o.sent(),n={kid:r,xms_ksl:Zt.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(n))]}}))}))},e.prototype.signPopToken=function(e,t,r){var n;return T(this,void 0,void 0,(function(){var o,i,s;return I(this,(function(a){switch(a.label){case 0:if(o=Dt.extractTokenClaims(e,this.cryptoUtils),i=new hr(r),s=i.getUrlComponents(),!(null===(n=null==o?void 0:o.cnf)||void 0===n?void 0:n.kid))throw pt.createTokenClaimsRequiredError();return[4,this.cryptoUtils.signJwt({at:e,ts:""+or.nowSeconds(),m:t.toUpperCase(),u:s.HostNameAndPort||"",nonce:this.cryptoUtils.createNewGuid(),p:s.AbsolutePath,q:[[],s.QueryString]},o.cnf.kid)];case 1:return[2,a.sent()]}}))}))},e}(),gr=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[pe,e,t].join(ae.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(pe)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),mr=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!0,configurable:!0}),e}(),yr=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?pt.createStateNotFoundError("Cached State"):pt.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw pt.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(ur.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new ur(e.error||Q,e.error_description,e.suberror);throw new Xt(e.error||Q,e.error_description,e.suberror)}e.client_info&&Ft(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(ur.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new ur(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Xt(e.error,t)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,s,a,c,g){return T(this,void 0,void 0,(function(){var y,v,w,_,b;return I(this,(function(E){switch(E.label){case 0:if(t.id_token&&(y=new Dt(t.id_token||Q,this.cryptoObj),s&&!ft.isEmpty(s.nonce)&&y.claims.nonce!==s.nonce))throw pt.createNonceMismatchError();this.homeAccountIdentifier=Kt.generateHomeAccountId(t.client_info||Q,r.authorityType,this.logger,this.cryptoObj,y),s&&s.state&&(v=dr.parseRequestState(this.cryptoObj,s.state)),w=this.generateCacheRecord(t,r,n,y,a,c,s),E.label=1;case 1:return E.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),_=new mr(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(_)]):[3,3];case 2:E.sent(),E.label=3;case 3:return!g||!w.account||(b=w.account.generateAccountKey(),this.cacheStorage.getAccount(b))?(this.cacheStorage.saveCacheRecord(w),[3,7]):(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,w,!1,y,v,o,i)]);case 4:return this.persistencePlugin&&this.serializableCache&&_?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(_)]):[3,6];case 5:E.sent(),E.label=6;case 6:return[7];case 7:return[2,e.generateAuthenticationResult(this.cryptoObj,r,w,!1,y,v,o,i)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,s){var a,c,g=t.getPreferredCache();if(ft.isEmpty(g))throw pt.createInvalidCacheEnvironmentError();!ft.isEmpty(e.id_token)&&n&&(a=nr.createIdTokenEntity(this.homeAccountIdentifier,g,e.id_token||Q,this.clientId,n.claims.tid||Q,i),c=this.generateAccountEntity(e,n,t,i,s));var y=null;if(!ft.isEmpty(e.access_token)){var v=e.scope?Ht.fromString(e.scope):new Ht(o||[]),w=r+(e.expires_in||0),_=w+(e.ext_expires_in||0);y=ir.createAccessTokenEntity(this.homeAccountIdentifier,g,e.access_token||Q,this.clientId,n?n.claims.tid||Q:t.tenant,v.printScopes(),w,_,e.token_type,i)}var b=null;ft.isEmpty(e.refresh_token)||(b=sr.createRefreshTokenEntity(this.homeAccountIdentifier,g,e.refresh_token||Q,this.clientId,e.foci,i));var E=null;return ft.isEmpty(e.foci)||(E=gr.createAppMetadataEntity(this.clientId,g,e.foci)),new lr(c,a,y,b,E)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,s=o?o.cloud_graph_host_name:"",a=o?o.msgraph_host:"";if(i===gt.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Kt.createGenericAccount(r,this.homeAccountIdentifier,t,n,s,a);if(ft.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw pt.createClientInfoEmptyError();return e.client_info?Kt.createAccount(e.client_info,this.homeAccountIdentifier,r,t,n,s,a):Kt.createGenericAccount(r,this.homeAccountIdentifier,t,n,s,a)},e.generateAuthenticationResult=function(e,t,r,n,o,i,s,a){var c,g,y;return T(this,void 0,void 0,(function(){var v,w,_,b,E,S,T,k;return I(this,(function(I){switch(I.label){case 0:if(v="",w=[],_=null,E=Q,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==ye.POP)return[3,2];if(S=new fr(e),!s||!a)throw jt.createResourceRequestParametersRequiredError();return[4,S.signPopToken(r.accessToken.secret,s,a)];case 1:return v=I.sent(),[3,3];case 2:v=r.accessToken.secret,I.label=3;case 3:w=Ht.fromString(r.accessToken.target).asArray(),_=new Date(1e3*Number(r.accessToken.expiresOn)),b=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),I.label=4;case 4:return r.appMetadata&&(E=r.appMetadata.familyId===fe?fe:Q),T=(null==o?void 0:o.claims.oid)||(null==o?void 0:o.claims.sub)||Q,k=(null==o?void 0:o.claims.tid)||Q,[2,{authority:t.canonicalAuthority,uniqueId:T,tenantId:k,scopes:w,account:r.account?r.account.getAccountInfo():null,idToken:o?o.rawToken:Q,idTokenClaims:o?o.claims:{},accessToken:v,fromCache:n,expiresOn:_,extExpiresOn:b,familyId:E,tokenType:(null===(c=r.accessToken)||void 0===c?void 0:c.tokenType)||Q,state:i?i.userRequestState:Q,cloudGraphHostName:(null===(g=r.account)||void 0===g?void 0:g.cloudGraphHostName)||Q,msGraphHost:(null===(y=r.account)||void 0===y?void 0:y.msGraphHost)||Q}]}}))}))},e}(),vr=function(e){function t(t){return e.call(this,t)||this}return E(t,e),t.prototype.getAuthCodeUrl=function(e){return T(this,void 0,void 0,(function(){var t;return I(this,(function(r){return t=this.createAuthCodeUrlQueryString(e),[2,this.authority.authorizationEndpoint+"?"+t]}))}))},t.prototype.acquireToken=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o;return I(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||ft.isEmpty(e.code))throw pt.createTokenRequestCannotBeMadeError();return r=or.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),[4,o.handleServerTokenResponse(n.body,this.authority,r,e.resourceRequestMethod,e.resourceRequestUri,t)];case 2:return[2,i.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new hr(e),o=hr.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw pt.createNoAuthCodeInServerResponseError();return S(S({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw jt.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(Kt.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return ft.isEmpty(t)?this.authority.endSessionEndpoint:this.authority.endSessionEndpoint+"?"+t},t.prototype.executeTokenRequest=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o;return I(this,(function(i){switch(i.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},[4,this.createTokenRequestBody(t)];case 1:return n=i.sent(),o=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(e.tokenEndpoint,n,o,r)]}}))}))},t.prototype.createTokenRequestBody=function(e){return T(this,void 0,void 0,(function(){var t,r,n,o;return I(this,(function(i){switch(i.label){case 0:return(t=new rr).addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(oe.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===ye.POP&&e.resourceRequestMethod&&e.resourceRequestUri?[4,new fr(this.cryptoUtils).generateCnf(e.resourceRequestMethod,e.resourceRequestUri)]:[3,2];case 1:n=i.sent(),t.addPopToken(n),i.label=2;case 2:return o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new rr;t.addClientId(this.config.authOptions.clientId);var r=k(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.sid?t.addSid(e.sid):e.loginHint?t.addLoginHint(e.loginHint):e.account&&e.account.username&&t.addLoginHint(e.account.username),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new rr;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},t}(er),wr=(function(e){function t(t){return e.call(this,t)||this}E(t,e),t.prototype.acquireToken=function(e){return T(this,void 0,void 0,(function(){var t,r,n,o;return I(this,(function(i){switch(i.label){case 0:return[4,this.getDeviceCode(e)];case 1:return t=i.sent(),e.deviceCodeCallback(t),r=or.nowSeconds(),[4,this.acquireTokenWithDeviceCode(e,t)];case 2:return n=i.sent(),(o=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n),[4,o.handleServerTokenResponse(n,this.authority,r,e.resourceRequestMethod,e.resourceRequestUri)];case 3:return[2,i.sent()]}}))}))},t.prototype.getDeviceCode=function(e){return T(this,void 0,void 0,(function(){var t,r,n;return I(this,(function(o){return t=this.createQueryString(e),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r,n)]}))}))},t.prototype.executePostRequestToDeviceCodeEndpoint=function(e,t,r,n){return T(this,void 0,void 0,(function(){var o,i,s,a,c,g,y;return I(this,(function(v){switch(v.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=v.sent().body,i=o.user_code,s=o.device_code,a=o.verification_uri,c=o.expires_in,g=o.interval,y=o.message,[2,{userCode:i,deviceCode:s,verificationUri:a,expiresIn:c,interval:g,message:y}]}}))}))},t.prototype.createQueryString=function(e){var t=new rr;return t.addScopes(e.scopes),t.addClientId(this.config.authOptions.clientId),(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},t.prototype.acquireTokenWithDeviceCode=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o,i,s,a=this;return I(this,(function(c){return r=this.createTokenRequestBody(e,t),n=this.createDefaultTokenRequestHeaders(),o=e.timeout?or.nowSeconds()+e.timeout:void 0,i=or.nowSeconds()+t.expiresIn,s=1e3*t.interval,[2,new Promise((function(t,c){var g=setInterval((function(){return T(a,void 0,void 0,(function(){var s,a,y;return I(this,(function(v){switch(v.label){case 0:return v.trys.push([0,6,,7]),e.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(g),c(pt.createDeviceCodeCancelledError()),[3,5]):[3,1];case 1:return o&&o<i&&or.nowSeconds()>o?(this.logger.error("User defined timeout for device code polling reached. The timeout was set for "+o),clearInterval(g),c(pt.createUserTimeoutReachedError()),[3,5]):[3,2];case 2:return or.nowSeconds()>i?(o&&this.logger.verbose("User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for "+o),this.logger.error("Device code expired. Expiration time of device code was "+i),clearInterval(g),c(pt.createDeviceCodeExpiredError()),[3,5]):[3,3];case 3:return s={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,r,n,s)];case 4:(a=v.sent()).body&&a.body.error===J?this.logger.info(a.body.error_description||"no_error_description"):(clearInterval(g),t(a.body)),v.label=5;case 5:return[3,7];case 6:return y=v.sent(),clearInterval(g),c(y),[3,7];case 7:return[2]}}))}))}),s)}))]}))}))},t.prototype.createTokenRequestBody=function(e,t){var r=new rr;r.addScopes(e.scopes),r.addClientId(this.config.authOptions.clientId),r.addGrantType(oe.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(n),r.addClientInfo(),(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()}}(er),function(e){function t(t){return e.call(this,t)||this}return E(t,e),t.prototype.acquireToken=function(e){return T(this,void 0,void 0,(function(){var t,r,n;return I(this,(function(o){switch(o.label){case 0:return t=or.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t,e.resourceRequestMethod,e.resourceRequestUri,void 0,[],void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return T(this,void 0,void 0,(function(){var t,r;return I(this,(function(n){if(!e)throw jt.createEmptyTokenRequestError();if(!e.account)throw pt.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(Eo){if(t=Eo instanceof pt&&Eo.errorCode===Ke.code,r=Eo instanceof Xt&&Eo.errorCode===Se&&Eo.subError===Ce,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw Eo}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return T(this,void 0,void 0,(function(){var r,n;return I(this,(function(o){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw pt.createNoTokensFoundError();return n=S(S({},e),{refreshToken:r.secret,authenticationScheme:ye.BEARER}),[2,this.acquireToken(n)]}))}))},t.prototype.executeTokenRequest=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o;return I(this,(function(i){switch(i.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=i.sent(),n=this.createDefaultTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes},[2,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n,o)]}}))}))},t.prototype.createTokenRequestBody=function(e){return T(this,void 0,void 0,(function(){var t,r,n,o,i,s;return I(this,(function(a){switch(a.label){case 0:if((t=new rr).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(oe.REFRESH_TOKEN_GRANT),t.addClientInfo(),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),e.authenticationScheme!==ye.POP)return[3,2];if(o=new fr(this.cryptoUtils),!e.resourceRequestMethod||!e.resourceRequestUri)throw jt.createResourceRequestParametersRequiredError();return s=(i=t).addPopToken,[4,o.generateCnf(e.resourceRequestMethod,e.resourceRequestUri)];case 1:s.apply(i,[a.sent()]),a.label=2;case 2:return(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}}))}))},t}(er)),_r=(function(e){function t(t){return e.call(this,t)||this}E(t,e),t.prototype.acquireToken=function(e){return T(this,void 0,void 0,(function(){var t;return I(this,(function(r){switch(r.label){case 0:return this.scopeSet=new Ht(e.scopes||[]),e.skipCache?[4,this.executeTokenRequest(e,this.authority)]:[3,2];case 1:case 5:return[2,r.sent()];case 2:return[4,this.getCachedAuthenticationResult()];case 3:return(t=r.sent())?[2,t]:[3,4];case 4:return[4,this.executeTokenRequest(e,this.authority)]}}))}))},t.prototype.getCachedAuthenticationResult=function(){return T(this,void 0,void 0,(function(){var e;return I(this,(function(t){switch(t.label){case 0:return!(e=this.readAccessTokenFromCache())||or.isTokenExpired(e.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:[4,yr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:null,idToken:null,accessToken:e,refreshToken:null,appMetadata:null},!0)];case 1:return[2,t.sent()]}}))}))},t.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ce.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),r=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]}));if(r.length<1)return null;if(r.length>1)throw pt.createMultipleMatchingTokensInCacheError();return r[0]},t.prototype.executeTokenRequest=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o,i,s,a;return I(this,(function(c){switch(c.label){case 0:return r=this.createTokenRequestBody(e),n=this.createDefaultTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},i=or.nowSeconds(),[4,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n,o)];case 1:return s=c.sent(),(a=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(s.body),[4,a.handleServerTokenResponse(s.body,this.authority,i,e.resourceRequestMethod,e.resourceRequestUri,void 0,e.scopes)];case 2:return[2,c.sent()]}}))}))},t.prototype.createTokenRequestBody=function(e){var t=new rr;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes,!1),t.addGrantType(oe.CLIENT_CREDENTIALS_GRANT);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}(er),function(e){function t(t){return e.call(this,t)||this}E(t,e),t.prototype.acquireToken=function(e){return T(this,void 0,void 0,(function(){var t;return I(this,(function(r){switch(r.label){case 0:return this.scopeSet=new Ht(e.scopes||[]),e.skipCache?[4,this.executeTokenRequest(e,this.authority)]:[3,2];case 1:case 5:return[2,r.sent()];case 2:return[4,this.getCachedAuthenticationResult(e)];case 3:return(t=r.sent())?[2,t]:[3,4];case 4:return[4,this.executeTokenRequest(e,this.authority)]}}))}))},t.prototype.getCachedAuthenticationResult=function(e){return T(this,void 0,void 0,(function(){var t,r,n,o,i,s;return I(this,(function(a){switch(a.label){case 0:return!(t=this.readAccessTokenFromCache(e))||or.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:(r=this.readIdTokenFromCache(e),o=null,r&&(n=new Dt(r.secret,this.config.cryptoInterface),i=n.claims.oid?n.claims.oid:n.claims.sub,s={homeAccountId:r.homeAccountId,environment:r.environment,tenantId:r.realm,username:Q,localAccountId:i||""},o=this.readAccountFromCache(s)),[4,yr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:o,accessToken:t,idToken:r,refreshToken:null,appMetadata:null},!0,n)]);case 1:return[2,a.sent()]}}))}))},t.prototype.readAccessTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ce.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase(),oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.accessTokens).map((function(e){return r.accessTokens[e]})),o=n.length;if(o<1)return null;if(o>1)throw pt.createMultipleMatchingTokensInCacheError();return n[0]},t.prototype.readIdTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ce.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.idTokens).map((function(e){return r.idTokens[e]}));return n.length<1?null:n[0]},t.prototype.readAccountFromCache=function(e){return this.cacheManager.readAccountFromCache(e)},t.prototype.executeTokenRequest=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o,i,s,a;return I(this,(function(c){switch(c.label){case 0:return r=this.createTokenRequestBody(e),n=this.createDefaultTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},i=or.nowSeconds(),[4,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n,o)];case 1:return s=c.sent(),(a=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(s.body),[4,a.handleServerTokenResponse(s.body,this.authority,i,e.resourceRequestMethod,e.resourceRequestUri,void 0,e.scopes,e.oboAssertion)];case 2:return[2,c.sent()]}}))}))},t.prototype.createTokenRequestBody=function(e){var t=new rr;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(oe.JWT_BEARER),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addRequestTokenUse(N.ON_BEHALF_OF),t.addOboAssertion(e.oboAssertion),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return t.createQueryString()}}(er),function(e){function t(t){return e.call(this,t)||this}return E(t,e),t.prototype.acquireToken=function(e){return T(this,void 0,void 0,(function(){var t;return I(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof pt&&t.errorCode===ut.code)return[2,new wr(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){return T(this,void 0,void 0,(function(){var t,r,n;return I(this,(function(o){switch(o.label){case 0:if(!e)throw jt.createEmptyTokenRequestError();if(!e.account)throw pt.createNoAccountInSilentRequestError();if(t=new Ht(e.scopes||[]),r=e.authority||this.authority.getPreferredCache(),n=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,t,r),!this.isRefreshRequired(e,n.accessToken))return[3,1];throw pt.createRefreshRequiredError();case 1:return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,e.resourceRequestMethod,e.resourceRequestUri)];case 2:return[2,o.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t,r){return T(this,void 0,void 0,(function(){var n;return I(this,(function(o){switch(o.label){case 0:return e.idToken&&(n=new Dt(e.idToken.secret,this.config.cryptoInterface)),[4,yr.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,n,void 0,t,r)];case 1:return[2,o.sent()]}}))}))},t.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims)||!(t&&!or.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},t}(er));!function(e){function t(t){return e.call(this,t)||this}E(t,e),t.prototype.acquireToken=function(e){return T(this,void 0,void 0,(function(){var t,r,n;return I(this,(function(o){switch(o.label){case 0:return this.logger.info("in acquireToken call"),t=or.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return r=o.sent(),(n=new yr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t)]}}))}))},t.prototype.executeTokenRequest=function(e,t){return T(this,void 0,void 0,(function(){var r,n,o;return I(this,(function(i){return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},n=this.createTokenRequestBody(t),o=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(e.tokenEndpoint,n,o,r)]}))}))},t.prototype.createTokenRequestBody=function(e){var t=new rr;t.addClientId(this.config.authOptions.clientId),t.addUsername(e.username),t.addPassword(e.password),t.addScopes(e.scopes),t.addGrantType(oe.RESOURCE_OWNER_PASSWORD_GRANT),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(r),(!ft.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}(er);function br(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("end_session_endpoint")&&e.hasOwnProperty("issuer")}!function(e){e.AAD="AAD",e.OIDC="OIDC"}(pr||(pr={}));var Er=function(){function e(){this.expiresAt=or.nowSeconds()+me}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=or.nowSeconds()+me},e.prototype.isExpired=function(){return this.expiresAt<=or.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(ge)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("end_session_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt"))},e}();var Sr,Cr,Tr,Ir,kr,Ar,Rr=function(){function e(e,t,r,n){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===j?gt.Adfs:gt.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new hr(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw pt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw pt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw pt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw pt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw pt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new hr(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===gt.Adfs||this.protocolMode===pr.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return T(this,void 0,void 0,(function(){var e,t,r,n;return I(this,(function(o){switch(o.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new Er).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=o.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=o.sent(),t!==he.CACHE&&r!==he.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){return T(this,void 0,void 0,(function(){var t;return I(this,(function(r){switch(r.label){case 0:return(t=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(t,!1),[2,he.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,he.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateEndpointMetadata(t,!0),[2,he.NETWORK];throw pt.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new hr(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(Eo){throw jt.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return T(this,void 0,void 0,(function(){var e;return I(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,br((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return T(this,void 0,void 0,(function(){var t;return I(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,he.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,he.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,he.NETWORK];throw jt.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(Eo){throw jt.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return T(this,void 0,void 0,(function(){var t,r,n,o;return I(this,(function(i){switch(i.label){case 0:t=""+H+this.canonicalAuthority+"oauth2/v2.0/authorize",r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return n=i.sent(),o=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body)?n.body.metadata:[],r=e.getCloudDiscoveryMetadataFromNetworkResponse(o,this.hostnameAndPort),[3,4];case 3:return i.sent(),[2,null];case 4:return r||(r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return hr.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw pt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e}(),Pr=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o){return T(this,void 0,void 0,(function(){var i,s;return I(this,(function(a){switch(a.label){case 0:i=e.createInstance(t,r,n,o),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i.resolveEndpointsAsync()];case 2:return a.sent(),[2,i];case 3:throw s=a.sent(),pt.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n){if(ft.isEmpty(e))throw jt.createUrlEmptyError();return new Rr(e,t,r,n)},e}(),Or=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(ve.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),Nr=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(Ee));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),Ur={sendGetRequestAsync:function(){return Promise.reject(ke.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ke.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},Mr=function(){function e(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.wrapperSKU=e.wrapperSKU||Q,this.wrapperVer=e.wrapperVer||Q,this.telemetryCacheKey=ve.CACHE_KEY+ae.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+ve.VALUE_SEPARATOR+e,r=[this.wrapperSKU,this.wrapperVer].join(ve.VALUE_SEPARATOR);return[ve.SCHEMA_VERSION,t,r].join(ve.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(ve.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(ve.VALUE_SEPARATOR),i=t.errors.length,s=[i,r<i?ve.OVERFLOW_TRUE:ve.OVERFLOW_FALSE].join(ve.VALUE_SEPARATOR);return[ve.SCHEMA_VERSION,t.cacheHits,n,o,s].join(ve.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),ft.isEmpty(e.subError)?ft.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(ve.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new Or;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new Or;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||Q,s=e.failedRequests[2*t+1]||Q,a=e.errors[t]||Q;if(!((n+=i.toString().length+s.toString().length+a.length+3)<ve.MAX_HEADER_BYTES))break;r+=1}return r},e}(),xr="interaction_in_progress",qr="invalid_grant",Lr=483,jr=600,Hr=50,Fr="msal.js.browser";!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(Sr||(Sr={})),function(e){e.GET="GET",e.POST="POST"}(Cr||(Cr={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status"}(Tr||(Tr={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout"}(Ir||(Ir={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(kr||(kr={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Ar||(Ar={}));var Kr,Dr={scopes:[K,D]},Br="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(Kr||(Kr={}));var Gr=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),Wr=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Gr.decimalToHex(e[0])+Gr.decimalToHex(e[1])+Gr.decimalToHex(e[2])+Gr.decimalToHex(e[3])+"-"+Gr.decimalToHex(e[4])+Gr.decimalToHex(e[5])+"-"+Gr.decimalToHex(e[6])+Gr.decimalToHex(e[7])+"-"+Gr.decimalToHex(e[8])+Gr.decimalToHex(e[9])+"-"+Gr.decimalToHex(e[10])+Gr.decimalToHex(e[11])+Gr.decimalToHex(e[12])+Gr.decimalToHex(e[13])+Gr.decimalToHex(e[14])+Gr.decimalToHex(e[15])}catch(s){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),zr=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e}(),Vr=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=zr.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,s=0;s<o;s++)n=s%3,i|=e[s]<<(16>>>n&24),2!==n&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Yr=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return zr.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),s=void 0,a=void 0,c=0,g=0,y=0;y<n;y++)if(a=3&y,c|=this.b64ToUint6(r.charCodeAt(y))<<18-6*a,3===a||n-y==1){for(s=0;s<3&&g<o;s++,g++)i[g]=c>>>(16>>>s&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Jr={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},Zr={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Xr={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},Qr={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},$r={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},en={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},tn={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},rn={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},nn={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},on={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},sn={code:"empty_window_error",desc:"window.open returned null or undefined window object."},an={code:"user_cancelled",desc:"User cancelled the flow."},cn={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},un={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout."},ln={code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},dn={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},hn={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},pn={code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},fn={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},gn={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},mn={code:"no_token_request_cache_error",desc:"No token request in found in cache."},yn={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},vn={code:"no_cached_authority_error",desc:"No cached authority found."},wn={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},_n={code:"invalid_cache_type",desc:"Invalid cache type"},bn={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},En={code:"database_not_open",desc:"Database is not open!"},Sn=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return c(t,e),t.createPkceNotGeneratedError=function(e){return new t(Jr.code,Jr.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Zr.code,Zr.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Xr.code,Xr.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Qr.code,Qr.desc)},t.createEmptyHashError=function(e){return new t($r.code,$r.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(en.code,en.desc)},t.createUnableToParseStateError=function(){return new t(tn.code,tn.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(rn.code,rn.desc)},t.createInteractionInProgressError=function(){return new t(nn.code,nn.desc)},t.createPopupWindowError=function(e){var r=on.desc;return r=ft.isEmpty(e)?r:r+" Details: "+e,new t(on.code,r)},t.createEmptyWindowCreatedError=function(){return new t(sn.code,sn.desc)},t.createUserCancelledError=function(){return new t(an.code,an.desc)},t.createMonitorPopupTimeoutError=function(){return new t(cn.code,cn.desc)},t.createMonitorIframeTimeoutError=function(){return new t(un.code,un.desc)},t.createRedirectInIframeError=function(e){return new t(ln.code,ln.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(dn.code,dn.desc)},t.createIframeClosedPrematurelyError=function(){return new t(hn.code,hn.desc)},t.createSilentSSOInsufficientInfoError=function(){return new t(pn.code,pn.desc)},t.createNoAccountError=function(){return new t(fn.code,fn.desc)},t.createSilentPromptValueError=function(e){return new t(gn.code,gn.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(yn.code,yn.desc)},t.createNoTokenRequestCacheError=function(){return new t(mn.code,mn.desc)},t.createAuthRequestNotSetError=function(){return new t(wn.code,wn.desc)},t.createNoCachedAuthorityError=function(){return new t(vn.code,vn.desc)},t.createInvalidCacheTypeError=function(){return new t(_n.code,""+_n.desc)},t.createNonBrowserEnvironmentError=function(){return new t(bn.code,bn.desc)},t.createDatabaseNotOpenError=function(){return new t(En.code,En.desc)},t}(ke),Cn=function(){function e(e){this.base64Encode=new Vr,this.cryptoObj=e}return e.prototype.generateCodes=function(){return y(this,void 0,void 0,(function(){var e,t;return v(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(Eo){throw Sn.createPkceNotGeneratedError(Eo)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return y(this,void 0,void 0,(function(){var t,r;return v(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),Sn.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),Tn="SHA-256",In=new Uint8Array([1,0,1]),kn=function(){function e(){if(!this.hasCryptoAPI())throw Sn.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Tn,modulusLength:2048,publicExponent:In}}return e.prototype.sha256Digest=function(e){return y(this,void 0,void 0,(function(){var t;return v(this,(function(r){return t=zr.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(Tn,t):this.getSubtleCryptoDigest(Tn,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw Sn.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return y(this,void 0,void 0,(function(){return v(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return y(this,void 0,void 0,(function(){return v(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(Br,e)]}))}))},e.prototype.importJwk=function(t,r,n){return y(this,void 0,void 0,(function(){var o,i;return v(this,(function(s){return o=e.getJwkString(t),i=zr.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,r,n):window.crypto.subtle.importKey(Br,t,this._keygenAlgorithmOptions,r,n)]}))}))},e.prototype.sign=function(e,t){return y(this,void 0,void 0,(function(){return v(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return y(this,void 0,void 0,(function(){return v(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return y(this,void 0,void 0,(function(){return v(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return y(this,void 0,void 0,(function(){var r=this;return v(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return y(this,void 0,void 0,(function(){return v(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(Br,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=zr.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,r){return y(this,void 0,void 0,(function(){var n=this;return v(this,(function(o){return[2,new Promise((function(o,i){var s=window.msCrypto.subtle.importKey(Br,e,n._keygenAlgorithmOptions,t,r);s.addEventListener("complete",(function(e){o(e.target.result)})),s.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return y(this,void 0,void 0,(function(){var r=this;return v(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),An=function(){function e(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}return e.prototype.open=function(){return y(this,void 0,void 0,(function(){var e=this;return v(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(e){return r(e)}))}))]}))}))},e.prototype.get=function(e){return y(this,void 0,void 0,(function(){var t=this;return v(this,(function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise((function(r,n){if(!t.db)return n(Sn.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.put=function(e,t){return y(this,void 0,void 0,(function(){var r=this;return v(this,(function(n){switch(n.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:n.sent(),n.label=2;case 2:return[2,new Promise((function(n,o){if(!r.db)return o(Sn.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){return o(e)}))}))]}}))}))},e}(),Rn=function(){function e(){this.browserCrypto=new kn,this.b64Encode=new Vr,this.b64Decode=new Yr,this.guidGenerator=new Wr(this.browserCrypto),this.pkceGenerator=new Cn(this.browserCrypto),this.cache=new An(e.DB_NAME,e.TABLE_NAME,e.DB_VERSION)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return y(this,void 0,void 0,(function(){return v(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t,r){return y(this,void 0,void 0,(function(){var n,o,i,s,a,c,g,y;return v(this,(function(v){switch(v.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return n=v.sent(),[4,this.browserCrypto.exportJwk(n.publicKey)];case 2:return o=v.sent(),i={e:o.e,kty:o.kty,n:o.n},s=kn.getJwkString(i),[4,this.browserCrypto.sha256Digest(s)];case 3:return a=v.sent(),c=this.b64Encode.urlEncodeArr(new Uint8Array(a)),[4,this.browserCrypto.exportJwk(n.privateKey)];case 4:return g=v.sent(),[4,this.browserCrypto.importJwk(g,!1,["sign"])];case 5:return y=v.sent(),this.cache.put(c,{privateKey:y,publicKey:n.publicKey,requestMethod:t,requestUri:r}),[2,c]}}))}))},e.prototype.signJwt=function(e,t){return y(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g,y,w;return v(this,(function(v){switch(v.label){case 0:return[4,this.cache.get(t)];case 1:return r=v.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=v.sent(),o=kn.getJwkString(n),i={alg:n.alg,type:Br},s=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(o)},a=this.b64Encode.urlEncode(JSON.stringify(e)),c=s+"."+a,g=zr.stringToArrayBuffer(c),[4,this.browserCrypto.sign(r.privateKey,g)];case 3:return y=v.sent(),w=this.b64Encode.urlEncodeArr(new Uint8Array(y)),[2,c+"."+w]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e.DB_VERSION=1,e.DB_NAME="msal.db",e.TABLE_NAME=e.DB_NAME+".keys",e}(),Pn={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},On={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Nn={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},Un={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Mn={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},xn={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider."},qn={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},Ln=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return c(t,e),t.createRedirectUriEmptyError=function(){return new t(Pn.code,Pn.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(On.code,On.desc)},t.createStorageNotSupportedError=function(e){return new t(Nn.code,Nn.desc+" Given Location: "+e)},t.createInvalidCallbackObjectError=function(e){return new t(Mn.code,Mn.desc+" Given value for callback function: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Un.code,Un.desc)},t.createStubPcaInstanceCalledError=function(){return new t(xn.code,xn.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(qn.code,qn.desc)},t}(ke),jn=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==Sr.LocalStorage&&e!==Sr.SessionStorage)throw Ln.createStorageNotSupportedError(e);if(!!!window[e])throw Ln.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),Hn=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),Fn=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(ft.isEmpty(t))return null;try{return dr.parseRequestState(e,t).libraryState.meta}catch(Eo){throw pt.createInvalidStateError(t,Eo)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new hr(e);return hr.getDeserializedHash(t.getHash())},e}(),Kn=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new Hn,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return c(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case Sr.LocalStorage:case Sr.SessionStorage:try{return new jn(e)}catch(Eo){this.logger.verbose(Eo);break}case Sr.MemoryStorage:}return this.cacheConfig.cacheLocation=Sr.MemoryStorage,new Hn},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case Sr.LocalStorage:case Sr.SessionStorage:try{return new jn(Sr.SessionStorage)}catch(Eo){return this.logger.verbose(Eo),this.internalStorage}case Sr.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=q+"."+R.ID_TOKEN,r=q+"."+R.CLIENT_INFO,n=q+"."+R.ERROR,o=q+"."+R.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[R.ID_TOKEN,R.CLIENT_INFO,R.ERROR,R.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(r){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new Kt,r);return Kt.isAccountEntity(n)?n:null},t.prototype.setAccount=function(e){var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new nr,r);return nr.isIdTokenEntity(n)?n:null},t.prototype.setIdTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new ir,r);return ir.isAccessTokenEntity(n)?n:null},t.prototype.setAccessTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new sr,r);return sr.isRefreshTokenEntity(n)?n:null},t.prototype.setRefreshTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new gr,r);return gr.isAppMetadataEntity(e,n)?n:null},t.prototype.setAppMetadata=function(e){var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new Or,r);return Or.isServerTelemetryEntity(e,n)?n:null},t.prototype.setServerTelemetry=function(e,t){this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&Er.isAuthorityMetadataEntity(e,r)?Bt.toObject(new Er,r):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setAuthorityMetadata=function(e,t){this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Bt.toObject(new Nr,r);return Nr.isThrottlingEntity(e,n)?n:null},t.prototype.setThrottlingCache=function(e,t){this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return n}var o=this.temporaryCacheStorage.getItem(r);return o||null},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(n,t)},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return _(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){var e=this;this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(q)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear()},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):ft.startsWith(e,q)||ft.startsWith(e,R.ADAL_ID_TOKEN)?e:q+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=dr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Tr.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=dr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Tr.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=dr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Tr.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r){var n=this.generateStateKey(e);this.setTemporaryCache(n,e,!1);var o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);var i=this.generateAuthorityKey(e);this.setTemporaryCache(i,r,!1)},t.prototype.resetRequestCache=function(e){var t=this;this.getKeys().forEach((function(r){ft.isEmpty(e)||-1===r.indexOf(e)||t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(Tr.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Tr.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Tr.URL_HASH)),this.removeItem(this.generateCacheKey(Tr.INTERACTION_STATUS_KEY))},t.prototype.cleanRequestByState=function(e){if(e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.info("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.getKeys().forEach((function(r){if(-1!==r.indexOf(Tr.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=Fn.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.info("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}}))},t.prototype.cacheCodeRequest=function(e,t){var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(Tr.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){var r=this.getTemporaryCache(Tr.REQUEST_PARAMS,!0);if(!r)throw Sn.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw Sn.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Tr.REQUEST_PARAMS)),ft.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Sn.createNoCachedAuthorityError();n.authority=i}return n},t}(Bt),Dn=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return y(this,void 0,void 0,(function(){var r,n;return v(this,(function(o){switch(o.label){case 0:return[4,fetch(e,{method:Cr.GET,headers:this.getFetchHeaders(t)})];case 1:return r=o.sent(),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(n.body=o.sent(),n.status=r.status,n)]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return y(this,void 0,void 0,(function(){var r,n,o;return v(this,(function(i){switch(i.label){case 0:return r=t&&t.body||"",[4,fetch(e,{method:Cr.POST,headers:this.getFetchHeaders(t),body:r})];case 1:return n=i.sent(),o={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 2:return[2,(o.body=i.sent(),o.status=n.status,o)]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),Bn=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return y(this,void 0,void 0,(function(){return v(this,(function(r){return[2,this.sendRequestAsync(e,Cr.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return y(this,void 0,void 0,(function(){return v(this,(function(r){return[2,this.sendRequestAsync(e,Cr.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),n.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&i(s.responseText);try{var e=JSON.parse(s.responseText),t={headers:n.getHeaderDict(s),body:e,status:s.status};o(t)}catch(Eo){i(s.responseText)}},s.onerror=function(){i(s.status)},"POST"===t&&r&&r.body)s.send(r.body);else{if("GET"!==t)throw Sn.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),Gn=function(){function e(){}return e.navigateWindow=function(e,t,r,n){return n?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){r.warning("Expected to navigate away from the current page but timeout occurred."),e()}),t)}))},e.clearHash=function(){"function"==typeof history.replaceState?history.replaceState(null,Q,""+window.location.pathname+window.location.search):window.location.hash=""},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new hr(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new Dn:new Bn},e.blockReloadInHiddenIframes=function(){if(hr.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw Sn.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===kr.Redirect&&n&&!r)throw Sn.createRedirectInIframeError(n)},e.blockNonBrowserEnvironment=function(e){if(!e)throw Sn.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),Wn=6e4,zn=6e3;var Vn,Yn=function(){function e(e,t,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r}return e.prototype.handleCodeResponse=function(e,t,r,n){return y(this,void 0,void 0,(function(){var o,i,s,a,c,g;return v(this,(function(y){switch(y.label){case 0:if(ft.isEmpty(e))throw Sn.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw pt.createStateNotFoundError("Cached State");return s=this.authModule.handleFragmentResponse(e,i),a=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,n)]:[3,2];case 1:y.sent(),y.label=2;case 2:return s.nonce=c||void 0,s.state=i,[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return g=y.sent(),this.browserStorage.cleanRequestByState(t),[2,g]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return y(this,void 0,void 0,(function(){var n,o;return v(this,(function(i){switch(i.label){case 0:return n="https://"+e+"/"+t.tenant+"/",[4,Pr.createDiscoveredInstance(n,r,this.browserStorage,t.options)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e}(),Jn=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n)||this;return i.browserCrypto=o,i}return c(t,e),t.prototype.initiateAuthRequest=function(e,t){if(ft.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Sn.createEmptyNavigationUriError();return t.redirectStartPage&&this.browserStorage.setTemporaryCache(Tr.ORIGIN_URI,t.redirectStartPage,!0),this.browserStorage.setTemporaryCache(Tr.INTERACTION_STATUS_KEY,xr,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.authModule.logger.infoPii("Navigate to:"+e),"function"==typeof t.onRedirectNavigate?(this.authModule.logger.verbose("Invoking onRedirectNavigate callback"),!1!==t.onRedirectNavigate(e)?(this.authModule.logger.verbose("onRedirectNavigate did not return false, navigating"),Gn.navigateWindow(e,t.redirectTimeout,this.authModule.logger)):(this.authModule.logger.verbose("onRedirectNavigate returned false, stopping navigation"),Promise.resolve())):(this.authModule.logger.verbose("Navigating window to navigate url"),Gn.navigateWindow(e,t.redirectTimeout,this.authModule.logger))},t.prototype.handleCodeResponse=function(e,t,r,n,o){return y(this,void 0,void 0,(function(){var i,s,a,c,g,y;return v(this,(function(v){switch(v.label){case 0:if(ft.isEmpty(e))throw Sn.createEmptyHashError(e);if(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Tr.INTERACTION_STATUS_KEY)),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw pt.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,s),c=this.browserStorage.generateNonceKey(s),g=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:v.sent(),v.label=2;case 2:return a.nonce=g||void 0,a.state=s,o&&Qt.removeThrottle(this.browserStorage,o,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return y=v.sent(),this.browserStorage.cleanRequestByState(t),[2,y]}}))}))},t}(Yn),Zn=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.unloadWindow=o.unloadWindow.bind(o),o}return c(t,e),t.prototype.initiateAuthRequest=function(e,t){if(ft.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),Sn.createEmptyNavigationUriError();return this.browserStorage.setTemporaryCache(Tr.INTERACTION_STATUS_KEY,xr,!0),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,t.popupName,t.popup)},t.prototype.monitorPopupForHash=function(e,t){var r=this;return new Promise((function(n,o){t<Wn&&r.authModule.logger.warning("system.loadFrameTimeout or system.windowHashTimeout set to lower ("+t+"ms) than the default ("+Wn+"ms). This may result in timeouts.");var i=t/Hr,s=0,a=setInterval((function(){if(e.closed)return r.cleanPopup(),clearInterval(a),void o(Sn.createUserCancelledError());var t=Q;try{t=e.location.href}catch(Eo){}if(!ft.isEmpty(t)&&"about:blank"!==t){s++;var c=e.location.hash;return hr.hashContainsKnownProperties(c)?(r.cleanPopup(e),clearInterval(a),void n(c)):s>i?(r.cleanPopup(e),clearInterval(a),void o(Sn.createMonitorPopupTimeoutError())):void 0}}),Hr)}))},t.prototype.openPopup=function(e,r,n){try{var o=void 0;if(n?(o=n).location.assign(e):void 0===n&&(o=t.openSizedPopup(e,r)),!o)throw Sn.createEmptyWindowCreatedError();return o.focus&&o.focus(),this.currentWindow=o,window.addEventListener("beforeunload",this.unloadWindow),o}catch(Eo){throw this.authModule.logger.error("error opening popup "+Eo.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Tr.INTERACTION_STATUS_KEY)),Sn.createPopupWindowError(Eo.toString())}},t.openSizedPopup=function(e,t){var r=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=Math.max(0,o/2-Lr/2+r),a=Math.max(0,i/2-jr/2+n);return window.open(e,t,"width="+Lr+", height="+jr+", top="+a+", left="+s)},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(kr.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Tr.INTERACTION_STATUS_KEY))},t.generatePopupName=function(e,t){return"msal."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},t}(Yn),Xn=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n)||this;return i.navigateFrameWait=o,i}return c(t,e),t.prototype.initiateAuthRequest=function(e){return y(this,void 0,void 0,(function(){var t;return v(this,(function(r){switch(r.label){case 0:if(ft.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Sn.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,o){t<zn&&r.authModule.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+zn+"ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(s),void o(Sn.createMonitorIframeTimeoutError());var t=Q,a=e.contentWindow;try{t=a?a.location.href:Q}catch(Eo){}if(!ft.isEmpty(t)){var c=a?a.location.hash:Q;return hr.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(s),void n(c)):void 0}}),Hr)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(Yn),Qn="2.11.0";!function(e){e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure"}(Vn||(Vn={}));var $n=function(){function e(e){if(this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,o=e.system,i={clientId:"",authority:""+L,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:pr.AAD},s={cacheLocation:Sr.SessionStorage,storeAuthStateInCookie:!1},a={loggerCallback:function(){},logLevel:Te.Info,piiLoggingEnabled:!1},c=g(g({},Wt),{loggerOptions:a,networkClient:t?Gn.getBrowserNetworkClient():Ur,loadFrameTimeout:0,windowHashTimeout:o&&o.loadFrameTimeout||Wn,iframeHashTimeout:o&&o.loadFrameTimeout||zn,navigateFrameWait:t&&Gn.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1});return{auth:g(g({},i),r),cache:g(g({},s),n),system:g(g({},c),o)}}(e,this.isBrowserEnvironment),this.activeLocalAccountId=null,this.eventCallbacks=new Map,this.logger=new mt(this.config.system.loggerOptions,"@azure/msal-browser",Qn),this.networkClient=this.config.system.networkClient,!this.isBrowserEnvironment)return this.browserStorage=function(e,t){var r={cacheLocation:Sr.MemoryStorage,storeAuthStateInCookie:!1};return new Kn(e,r,Ae,t)}(this.config.auth.clientId,this.logger),void(this.browserCrypto=Ae);this.browserCrypto=new Rn,this.browserStorage=new Kn(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger)}return e.prototype.handleRedirectPromise=function(e){return y(this,void 0,void 0,(function(){var t,r=this;return v(this,(function(n){return this.emitEvent(Vn.HANDLE_REDIRECT_START,kr.Redirect),t=this.getAllAccounts(),this.isBrowserEnvironment?[2,this.handleRedirectResponse(e).then((function(e){e&&(t.length<r.getAllAccounts().length?r.emitEvent(Vn.LOGIN_SUCCESS,kr.Redirect,e):r.emitEvent(Vn.ACQUIRE_TOKEN_SUCCESS,kr.Redirect,e));return r.emitEvent(Vn.HANDLE_REDIRECT_END,kr.Redirect),e})).catch((function(e){throw t.length>0?r.emitEvent(Vn.ACQUIRE_TOKEN_FAILURE,kr.Redirect,null,e):r.emitEvent(Vn.LOGIN_FAILURE,kr.Redirect,null,e),r.emitEvent(Vn.HANDLE_REDIRECT_END,kr.Redirect),e}))]:[2,null]}))}))},e.prototype.handleRedirectResponse=function(e){return y(this,void 0,void 0,(function(){var t,r,n,o,i,s,a;return v(this,(function(c){switch(c.label){case 0:if(!this.interactionInProgress())return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(kr.Redirect),[2,null];try{r=this.validateAndExtractStateFromHash(t,kr.Redirect),Gn.clearHash()}catch(Eo){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+Eo),this.browserStorage.cleanRequestByInteractionType(kr.Redirect),[2,null]}return n=this.browserStorage.getTemporaryCache(Tr.ORIGIN_URI,!0)||"",o=hr.removeHashFromUrl(n),i=hr.removeHashFromUrl(window.location.href),o===i&&this.config.auth.navigateToLoginRequestUrl?[4,this.handleHash(t,r)]:[3,2];case 1:return s=c.sent(),n.indexOf("#")>-1&&Gn.replaceHash(n),[2,s];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:[2,this.handleHash(t,r)];case 3:return Gn.isInIframe()?[3,7]:(this.browserStorage.setTemporaryCache(Tr.URL_HASH,t,!0),n&&"null"!==n?[3,5]:(a=Gn.getHomepage(),this.browserStorage.setTemporaryCache(Tr.ORIGIN_URI,a,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,Gn.navigateWindow(a,this.config.system.redirectNavigationTimeout,this.logger,!0)]));case 4:return c.sent(),[3,7];case 5:return[4,Gn.navigateWindow(n,this.config.system.redirectNavigationTimeout,this.logger,!0)];case 6:c.sent(),c.label=7;case 7:return[2,null]}}))}))},e.prototype.getRedirectResponseHash=function(e){var t=hr.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(Tr.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Tr.URL_HASH)),t?e:r},e.prototype.validateAndExtractStateFromHash=function(e,t){var r=hr.getDeserializedHash(e);if(!r.state)throw Sn.createHashDoesNotContainStateError();var n=Fn.extractBrowserRequestState(this.browserCrypto,r.state);if(!n)throw Sn.createUnableToParseStateError();if(n.interactionType!==t)throw Sn.createStateInteractionTypeMismatchError();return r.state},e.prototype.handleHash=function(e,t){return y(this,void 0,void 0,(function(){var r,n,o,i,s;return v(this,(function(a){switch(a.label){case 0:r=this.browserStorage.getCachedRequest(t,this.browserCrypto),n=this.initializeServerTelemetryManager(Ir.handleRedirectPromise,r.correlationId),a.label=1;case 1:if(a.trys.push([1,4,,5]),!(o=this.browserStorage.getCachedAuthority(t)))throw Sn.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(n,o)];case 2:return i=a.sent(),[4,new Jn(i,this.browserStorage,r,this.browserCrypto).handleCodeResponse(e,t,i.authority,this.networkClient,this.config.auth.clientId)];case 3:return[2,a.sent()];case 4:throw s=a.sent(),n.cacheFailedRequest(s),this.browserStorage.cleanRequestByInteractionType(kr.Redirect),s;case 5:return[2]}}))}))},e.prototype.acquireTokenRedirect=function(e){return y(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g;return v(this,(function(y){switch(y.label){case 0:this.preflightBrowserEnvironmentCheck(kr.Redirect),(t=this.getAllAccounts().length>0)?this.emitEvent(Vn.ACQUIRE_TOKEN_START,kr.Redirect,e):this.emitEvent(Vn.LOGIN_START,kr.Redirect,e),r=this.preflightInteractiveRequest(e,kr.Redirect),n=this.initializeServerTelemetryManager(Ir.acquireTokenRedirect,r.correlationId),y.label=1;case 1:return y.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=y.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 3:return i=y.sent(),s=new Jn(i,this.browserStorage,o,this.browserCrypto),[4,i.getAuthCodeUrl(r)];case 4:return a=y.sent(),c=this.getRedirectStartPage(e.redirectStartPage),[2,s.initiateAuthRequest(a,{redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 5:throw g=y.sent(),t?this.emitEvent(Vn.ACQUIRE_TOKEN_FAILURE,kr.Redirect,null,g):this.emitEvent(Vn.LOGIN_FAILURE,kr.Redirect,null,g),n.cacheFailedRequest(g),this.browserStorage.cleanRequestByState(r.state),g;case 6:return[2]}}))}))},e.prototype.acquireTokenPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck(kr.Popup),t=this.preflightInteractiveRequest(e,kr.Popup)}catch(Eo){return Promise.reject(Eo)}var r=Zn.generatePopupName(this.config.auth.clientId,t);if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(t,r);var n=Zn.openSizedPopup("about:blank",r);return this.acquireTokenPopupAsync(t,r,n)},e.prototype.acquireTokenPopupAsync=function(e,t,r){return y(this,void 0,void 0,(function(){var n,o,i,s,a,c,g,y,w,_,b,E;return v(this,(function(v){switch(v.label){case 0:(n=this.getAllAccounts()).length>0?this.emitEvent(Vn.ACQUIRE_TOKEN_START,kr.Popup,e):this.emitEvent(Vn.LOGIN_START,kr.Popup,e),o=this.initializeServerTelemetryManager(Ir.acquireTokenPopup,e.correlationId),v.label=1;case 1:return v.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return i=v.sent(),[4,this.createAuthCodeClient(o,e.authority)];case 3:return[4,(s=v.sent()).getAuthCodeUrl(e)];case 4:return a=v.sent(),c=new Zn(s,this.browserStorage,i),g={popup:r,popupName:t},y=c.initiateAuthRequest(a,g),[4,c.monitorPopupForHash(y,this.config.system.windowHashTimeout)];case 5:return w=v.sent(),_=this.validateAndExtractStateFromHash(w,kr.Popup),Qt.removeThrottle(this.browserStorage,this.config.auth.clientId,i.authority,i.scopes),[4,c.handleCodeResponse(w,_,s.authority,this.networkClient)];case 6:return b=v.sent(),n.length<this.getAllAccounts().length?this.emitEvent(Vn.LOGIN_SUCCESS,kr.Popup,b):this.emitEvent(Vn.ACQUIRE_TOKEN_SUCCESS,kr.Popup,b),[2,b];case 7:throw E=v.sent(),n.length>0?this.emitEvent(Vn.ACQUIRE_TOKEN_FAILURE,kr.Popup,null,E):this.emitEvent(Vn.LOGIN_FAILURE,kr.Popup,null,E),o.cacheFailedRequest(E),this.browserStorage.cleanRequestByState(e.state),E;case 8:return[2]}}))}))},e.prototype.ssoSilent=function(e){return y(this,void 0,void 0,(function(){var t,r;return v(this,(function(n){switch(n.label){case 0:this.preflightBrowserEnvironmentCheck(kr.Silent),this.emitEvent(Vn.SSO_SILENT_START,kr.Silent,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(e)];case 2:return t=n.sent(),this.emitEvent(Vn.SSO_SILENT_SUCCESS,kr.Silent,t),[2,t];case 3:throw r=n.sent(),this.emitEvent(Vn.SSO_SILENT_FAILURE,kr.Silent,null,r),r;case 4:return[2]}}))}))},e.prototype.acquireTokenByIframe=function(e){return y(this,void 0,void 0,(function(){var t,r,n,o,i,s;return v(this,(function(a){switch(a.label){case 0:if(ft.isEmpty(e.loginHint)&&ft.isEmpty(e.sid)&&(!e.account||ft.isEmpty(e.account.username)))throw Sn.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==re.NONE)throw Sn.createSilentPromptValueError(e.prompt);t=this.initializeAuthorizationRequest(g(g({},e),{prompt:re.NONE}),kr.Silent),r=this.initializeServerTelemetryManager(Ir.ssoSilent,t.correlationId),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=a.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(o=a.sent()).getAuthCodeUrl(t)];case 4:return i=a.sent(),[4,this.silentTokenHelper(i,n,o)];case 5:return[2,a.sent()];case 6:throw s=a.sent(),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 7:return[2]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return y(this,void 0,void 0,(function(){var t,r,n,o,i,s;return v(this,(function(a){switch(a.label){case 0:this.emitEvent(Vn.ACQUIRE_TOKEN_NETWORK_START,kr.Silent,e),Gn.blockReloadInHiddenIframes(),t=g(g({},e),this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(Ir.acquireTokenSilent_silentFlow,t.correlationId),a.label=1;case 1:return a.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(r,t.authority)];case 2:return[4,a.sent().acquireTokenByRefreshToken(t)];case 3:return[2,a.sent()];case 4:return n=a.sent(),r.cacheFailedRequest(n),o=n instanceof Xt,i=n instanceof ur,s=n.errorCode===qr,o&&s&&!i?[4,this.acquireTokenByIframe(e)]:[3,6];case 5:return[2,a.sent()];case 6:throw n;case 7:return[2]}}))}))},e.prototype.silentTokenHelper=function(e,t,r){return y(this,void 0,void 0,(function(){var n,o,i,s;return v(this,(function(a){switch(a.label){case 0:return[4,(n=new Xn(r,this.browserStorage,t,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return o=a.sent(),[4,n.monitorIframeForHash(o,this.config.system.iframeHashTimeout)];case 2:return i=a.sent(),s=this.validateAndExtractStateFromHash(i,kr.Silent),[2,n.handleCodeResponse(i,s,r.authority,this.networkClient)]}}))}))},e.prototype.logout=function(e){return y(this,void 0,void 0,(function(){var t,r,n,o,i;return v(this,(function(s){switch(s.label){case 0:this.preflightBrowserEnvironmentCheck(kr.Redirect),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Ir.logout,t.correlationId),s.label=1;case 1:return s.trys.push([1,3,,4]),this.emitEvent(Vn.LOGOUT_START,kr.Redirect,e),[4,this.createAuthCodeClient(r,e&&e.authority)];case 2:return n=s.sent(),o=n.getLogoutUri(t),this.emitEvent(Vn.LOGOUT_SUCCESS,kr.Redirect,t),t.account&&!Kt.accountInfoIsEqual(t.account,this.getActiveAccount())||this.setActiveAccount(null),e&&"function"==typeof e.onRedirectNavigate?!1!==e.onRedirectNavigate(o)?(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[2,Gn.navigateWindow(o,this.config.system.redirectNavigationTimeout,this.logger)]):(this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),[3,4]):[2,Gn.navigateWindow(o,this.config.system.redirectNavigationTimeout,this.logger)];case 3:throw i=s.sent(),r.cacheFailedRequest(i),this.emitEvent(Vn.LOGOUT_FAILURE,kr.Redirect,null,i),i;case 4:return[2]}}))}))},e.prototype.getAllAccounts=function(){return this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!ft.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!ft.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.homeAccountId===e}))[0]||null},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!ft.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.localAccountId===e}))[0]||null},e.prototype.setActiveAccount=function(e){this.activeLocalAccountId=e?e.localAccountId:null},e.prototype.getActiveAccount=function(){return this.activeLocalAccountId?this.getAccountByLocalId(this.activeLocalAccountId):null},e.prototype.getRedirectUri=function(e){var t=e||this.config.auth.redirectUri||Gn.getCurrentUri();return hr.getAbsoluteUrl(t,Gn.getCurrentUri())},e.prototype.getPostLogoutRedirectUri=function(e){var t=e||this.config.auth.postLogoutRedirectUri||Gn.getCurrentUri();return hr.getAbsoluteUrl(t,Gn.getCurrentUri())},e.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return hr.getAbsoluteUrl(t,Gn.getCurrentUri())},e.prototype.getDiscoveredAuthority=function(e){return y(this,void 0,void 0,(function(){var t;return v(this,(function(r){switch(r.label){case 0:return t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?[4,Pr.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]:[3,2];case 1:case 3:return[2,r.sent()];case 2:return[4,Pr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)]}}))}))},e.prototype.interactionInProgress=function(){return this.browserStorage.getTemporaryCache(Tr.INTERACTION_STATUS_KEY,!0)===xr},e.prototype.createAuthCodeClient=function(e,t){return y(this,void 0,void 0,(function(){var r;return v(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new vr(r)]}}))}))},e.prototype.createSilentFlowClient=function(e,t){return y(this,void 0,void 0,(function(){var r;return v(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new _r(r)]}}))}))},e.prototype.createRefreshTokenClient=function(e,t){return y(this,void 0,void 0,(function(){var r;return v(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new wr(r)]}}))}))},e.prototype.getClientConfiguration=function(e,t){return y(this,void 0,void 0,(function(){var r;return v(this,(function(n){switch(n.label){case 0:return[4,this.getDiscoveredAuthority(t)];case 1:return r=n.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:r,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Fr,version:Qn,cpu:"",os:""}}]}}))}))},e.prototype.preflightInteractiveRequest=function(e,t){if(Gn.blockReloadInHiddenIframes(),this.interactionInProgress())throw Sn.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(Gn.blockNonBrowserEnvironment(this.isBrowserEnvironment),Gn.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Gn.blockReloadInHiddenIframes(),e===kr.Redirect&&this.config.cache.cacheLocation===Sr.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Ln.createInMemoryRedirectUnavailableError()},e.prototype.initializeBaseRequest=function(e){var t=e.authority||this.config.auth.authority,r=_(e&&e.scopes||[]),n=e&&e.correlationId||this.browserCrypto.createNewGuid();return g(g({},e),{correlationId:n,authority:t,scopes:r})},e.prototype.initializeServerTelemetryManager=function(e,t,r){var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1,wrapperSKU:this.wrapperSKU,wrapperVer:this.wrapperVer};return new Mr(n,this.browserStorage)},e.prototype.initializeAuthorizationRequest=function(e,t){var r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=dr.setRequestState(this.browserCrypto,e&&e.state||"",n),i=e.authenticationScheme||ye.BEARER,s=g(g({},this.initializeBaseRequest(e)),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:ne.FRAGMENT,authenticationScheme:i}),a=e.account||this.getActiveAccount();if(a&&(s.account=a),ft.isEmpty(s.loginHint)){var c=this.browserStorage.getTemporaryCache(R.ADAL_ID_TOKEN);if(c){var y=new Dt(c,this.browserCrypto);this.browserStorage.removeItem(R.ADAL_ID_TOKEN),y.claims&&y.claims.upn&&(s.loginHint=y.claims.upn)}}return this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority),s},e.prototype.initializeAuthorizationCodeRequest=function(e){return y(this,void 0,void 0,(function(){var t,r;return v(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=g(g({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=V,[2,r]}}))}))},e.prototype.initializeLogoutRequest=function(e){var t=g({correlationId:this.browserCrypto.createNewGuid()},e);return t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},e.prototype.emitEvent=function(e,t,r,n){var o=this;if(this.isBrowserEnvironment){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.addEventCallback=function(e){if(this.isBrowserEnvironment){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.wrapperSKU=e,this.wrapperVer=t},e}(),eo=function(e){function t(t){return e.call(this,t)||this}return c(t,e),t.prototype.loginRedirect=function(e){return y(this,void 0,void 0,(function(){return v(this,(function(t){return[2,this.acquireTokenRedirect(e||Dr)]}))}))},t.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||Dr)},t.prototype.acquireTokenSilent=function(e){return y(this,void 0,void 0,(function(){var t,r,n,o,i,s;return v(this,(function(a){switch(a.label){case 0:if(this.preflightBrowserEnvironmentCheck(kr.Silent),!(t=e.account||this.getActiveAccount()))throw Sn.createNoAccountError();r=g(g(g({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1}),this.emitEvent(Vn.ACQUIRE_TOKEN_START,kr.Silent,e),a.label=1;case 1:return a.trys.push([1,4,,9]),n=this.initializeServerTelemetryManager(Ir.acquireTokenSilent_silentFlow,r.correlationId),[4,this.createSilentFlowClient(n,r.authority)];case 2:return[4,a.sent().acquireCachedToken(r)];case 3:return o=a.sent(),this.emitEvent(Vn.ACQUIRE_TOKEN_SUCCESS,kr.Silent,o),[2,o];case 4:a.sent(),a.label=5;case 5:return a.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(r)];case 6:return i=a.sent(),this.emitEvent(Vn.ACQUIRE_TOKEN_SUCCESS,kr.Silent,i),[2,i];case 7:throw s=a.sent(),this.emitEvent(Vn.ACQUIRE_TOKEN_FAILURE,kr.Silent,null,s),s;case 8:return[3,9];case 9:return[2]}}))}))},t}($n),to=(function(){function e(){}e.getInteractionStatusFromEvent=function(e){switch(e.eventType){case Vn.LOGIN_START:return Ar.Login;case Vn.SSO_SILENT_START:return Ar.SsoSilent;case Vn.ACQUIRE_TOKEN_START:if(e.interactionType===kr.Redirect||e.interactionType===kr.Popup)return Ar.AcquireToken;break;case Vn.HANDLE_REDIRECT_START:return Ar.HandleRedirect;case Vn.LOGOUT_START:return Ar.Logout;case Vn.LOGIN_SUCCESS:case Vn.SSO_SILENT_SUCCESS:case Vn.HANDLE_REDIRECT_END:case Vn.LOGIN_FAILURE:case Vn.SSO_SILENT_FAILURE:case Vn.LOGOUT_FAILURE:return Ar.None;case Vn.ACQUIRE_TOKEN_SUCCESS:case Vn.ACQUIRE_TOKEN_FAILURE:if(e.interactionType===kr.Redirect||e.interactionType===kr.Popup)return Ar.None}return null}}(),n(2124));const ro=["apps.cognite.com","apps-staging.cognite.com","apps-test.cognite.com","apps-preview.cognite.com","localhost:8080"],no="cdf",oo=()=>ro.includes(window.location.host)&&window.location.pathname.startsWith(`/${no}`),io=e=>{var t,r;return null!==(r=(null!==(t=to.parse(window.location.search))&&void 0!==t?t:{})[e])&&void 0!==r?r:""},so=()=>{const e=oo()?2:1;return new URL(window.location.href).pathname.split("/")[e]},ao=()=>{const e=io("cluster");return Array.isArray(e)?e[0]:e},co=()=>{const e=io("env");return Array.isArray(e)?e[0]:e},uo=(e,t="https")=>{let r=e;return e.substr(0,t.length)!==t&&(r=`${t}://${e}`),r};function lo(){var t;return e(this,void 0,void 0,(function*(){if(oo()){let e=localStorage.getItem("@cognite/auth-react/login-hints");return e?(e=JSON.parse(e),Promise.resolve(e.idpInternalId)):Promise.reject(new Error("IDP not selected"))}const{internalId:e}=null!==(t=s())&&void 0!==t?t:{},{idps:r=[],legacyProjects:n=[]}=yield fetch("/_api/login_info").then((e=>e.json()));if(!e&&1===r.length)return r[0];if(!e)return Promise.reject(new Error("IDP not selected"));const o=r.find((t=>t.internalId===e))||n.find((t=>t.internalId===e));return o||Promise.reject(new Error("IDP not found"))}))}const ho=()=>e(void 0,void 0,void 0,(function*(){const t=ao();if(t)return uo(t);const r=yield e(void 0,void 0,void 0,(function*(){try{const e=yield lo(),t="COGNITE_AUTH"!==e.type?null==e?void 0:e.clusters:void 0;return 1===(null==t?void 0:t.length)?t[0]:void 0}catch(Ld){return}}));return r?uo(r):Promise.reject(new Error("cluster not found"))}));class WrappedSdkClient{constructor(e){this.instance=e}overrideInstance(e){this.instance=e}}const po=(e,t)=>({clientId:t,authority:e,redirectUri:`https://${window.location.host}`}),fo={cacheLocation:"localStorage",storeAuthStateInCookie:!1};var go=n(9675);const mo=ao(),yo=co(),vo=so(),wo=()=>`cognite-app-adfs-access-token_${null!=mo?mo:yo}_${vo}`;function _o(t,r){return e(this,void 0,void 0,(function*(){const n=wo(),o=sessionStorage.getItem(n),i=yield ho();if(o)try{const e=`${i}/api/v1/token/inspect`,t=yield fetch(e,{headers:{Authorization:`Bearer ${o}`}}).then((e=>200===e.status?e.json():Promise.reject(new Error("invalid token"))));if(t.subject)return o;throw new Error("expired token")}catch(Eo){sessionStorage.removeItem(n)}return function(t,r){return e(this,void 0,void 0,(function*(){const e=yield ho(),n=new go.ADFS({authority:t,requestParams:{clientId:r,resource:e}}),o=yield n.getCDFToken();if(!o){const e=yield n.login();return e||Promise.reject(new Error("token not found"))}return sessionStorage.setItem(wo(),o),o}))}(t,r)}))}function bo(t){return e(this,void 0,void 0,(function*(){localStorage.removeItem(r),sessionStorage.clear(),window.location.href=`${t}/logout`}))}var Eo=function(e,t){return Eo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Eo(e,t)};function So(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Eo(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Co=function(){return Co=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Co.apply(this,arguments)};function To(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function Io(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function ko(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function Ao(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Ro(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}var Po="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Oo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function No(e,t){return e(t={exports:{}},t.exports),t.exports}var Uo,Mo,xo=function(e){return e&&e.Math==Math&&e},qo=xo("object"==typeof globalThis&&globalThis)||xo("object"==typeof window&&window)||xo("object"==typeof self&&self)||xo("object"==typeof Po&&Po)||function(){return this}()||Function("return this")(),Lo=function(e){try{return!!e()}catch(e){return!0}},jo=!Lo((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Ho=!Lo((function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),Fo=Function.prototype.call,Ko=Ho?Fo.bind(Fo):function(){return Fo.apply(Fo,arguments)},Do={}.propertyIsEnumerable,Bo=Object.getOwnPropertyDescriptor,Go=Bo&&!Do.call({1:2},1)?function(e){var t=Bo(this,e);return!!t&&t.enumerable}:Do,Wo={f:Go},zo=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Vo=Function.prototype,Yo=Vo.bind,Jo=Vo.call,Zo=Ho&&Yo.bind(Jo,Jo),Xo=Ho?function(e){return e&&Zo(e)}:function(e){return e&&function(){return Jo.apply(e,arguments)}},Qo=Xo({}.toString),$o=Xo("".slice),ei=function(e){return $o(Qo(e),8,-1)},ti=qo.Object,ri=Xo("".split),ni=Lo((function(){return!ti("z").propertyIsEnumerable(0)}))?function(e){return"String"==ei(e)?ri(e,""):ti(e)}:ti,oi=qo.TypeError,ii=function(e){if(null==e)throw oi("Can't call method on "+e);return e},si=function(e){return ni(ii(e))},ai=function(e){return"function"==typeof e},ci=function(e){return"object"==typeof e?null!==e:ai(e)},ui=function(e,t){return arguments.length<2?function(e){return ai(e)?e:void 0}(qo[e]):qo[e]&&qo[e][t]},li=Xo({}.isPrototypeOf),di=ui("navigator","userAgent")||"",hi=qo.process,pi=qo.Deno,fi=hi&&hi.versions||pi&&pi.version,gi=fi&&fi.v8;gi&&(Mo=(Uo=gi.split("."))[0]>0&&Uo[0]<4?1:+(Uo[0]+Uo[1])),!Mo&&di&&(!(Uo=di.match(/Edge\/(\d+)/))||Uo[1]>=74)&&(Uo=di.match(/Chrome\/(\d+)/))&&(Mo=+Uo[1]);var mi=Mo,yi=!!Object.getOwnPropertySymbols&&!Lo((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&mi&&mi<41})),vi=yi&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,wi=qo.Object,_i=vi?function(e){return"symbol"==typeof e}:function(e){var t=ui("Symbol");return ai(t)&&li(t.prototype,wi(e))},bi=qo.String,Ei=function(e){try{return bi(e)}catch(e){return"Object"}},Si=qo.TypeError,Ci=function(e){if(ai(e))return e;throw Si(Ei(e)+" is not a function")},Ti=function(e,t){var r=e[t];return null==r?void 0:Ci(r)},Ii=qo.TypeError,ki=Object.defineProperty,Ai=function(e,t){try{ki(qo,e,{value:t,configurable:!0,writable:!0})}catch(Co){qo[e]=t}return t},Ri=qo["__core-js_shared__"]||Ai("__core-js_shared__",{}),Pi=No((function(e){(e.exports=function(e,t){return Ri[e]||(Ri[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.0",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),Oi=qo.Object,Ni=function(e){return Oi(ii(e))},Ui=Xo({}.hasOwnProperty),Mi=Object.hasOwn||function(e,t){return Ui(Ni(e),t)},xi=0,qi=Math.random(),Li=Xo(1..toString),ji=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Li(++xi+qi,36)},Hi=Pi("wks"),Fi=qo.Symbol,Ki=Fi&&Fi.for,Di=vi?Fi:Fi&&Fi.withoutSetter||ji,Bi=function(e){if(!Mi(Hi,e)||!yi&&"string"!=typeof Hi[e]){var t="Symbol."+e;yi&&Mi(Fi,e)?Hi[e]=Fi[e]:Hi[e]=vi&&Ki?Ki(t):Di(t)}return Hi[e]},Gi=qo.TypeError,Wi=Bi("toPrimitive"),zi=function(e){var t=function(e,t){if(!ci(e)||_i(e))return e;var r,n=Ti(e,Wi);if(n){if(void 0===t&&(t="default"),r=Ko(n,e,t),!ci(r)||_i(r))return r;throw Gi("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,n;if("string"===t&&ai(r=e.toString)&&!ci(n=Ko(r,e)))return n;if(ai(r=e.valueOf)&&!ci(n=Ko(r,e)))return n;if("string"!==t&&ai(r=e.toString)&&!ci(n=Ko(r,e)))return n;throw Ii("Can't convert object to primitive value")}(e,t)}(e,"string");return _i(t)?t:t+""},Vi=qo.document,Yi=ci(Vi)&&ci(Vi.createElement),Ji=function(e){return Yi?Vi.createElement(e):{}},Zi=!jo&&!Lo((function(){return 7!=Object.defineProperty(Ji("div"),"a",{get:function(){return 7}}).a})),Xi=Object.getOwnPropertyDescriptor,Qi={f:jo?Xi:function(e,t){if(e=si(e),t=zi(t),Zi)try{return Xi(e,t)}catch(e){}if(Mi(e,t))return zo(!Ko(Wo.f,e,t),e[t])}},$i=jo&&Lo((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),es=qo.String,ts=qo.TypeError,rs=function(e){if(ci(e))return e;throw ts(es(e)+" is not an object")},ns=qo.TypeError,os=Object.defineProperty,is=Object.getOwnPropertyDescriptor,ss={f:jo?$i?function(e,t,r){if(rs(e),t=zi(t),rs(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var n=is(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return os(e,t,r)}:os:function(e,t,r){if(rs(e),t=zi(t),rs(r),Zi)try{return os(e,t,r)}catch(e){}if("get"in r||"set"in r)throw ns("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},as=jo?function(e,t,r){return ss.f(e,t,zo(1,r))}:function(e,t,r){return e[t]=r,e},cs=Xo(Function.toString);ai(Ri.inspectSource)||(Ri.inspectSource=function(e){return cs(e)});var us,ls,ds,hs=Ri.inspectSource,ps=qo.WeakMap,fs=ai(ps)&&/native code/.test(hs(ps)),gs=Pi("keys"),ms=function(e){return gs[e]||(gs[e]=ji(e))},ys={},vs=qo.TypeError,ws=qo.WeakMap;if(fs||Ri.state){var _s=Ri.state||(Ri.state=new ws),bs=Xo(_s.get),Es=Xo(_s.has),Ss=Xo(_s.set);us=function(e,t){if(Es(_s,e))throw new vs("Object already initialized");return t.facade=e,Ss(_s,e,t),t},ls=function(e){return bs(_s,e)||{}},ds=function(e){return Es(_s,e)}}else{var Cs=ms("state");ys[Cs]=!0,us=function(e,t){if(Mi(e,Cs))throw new vs("Object already initialized");return t.facade=e,as(e,Cs,t),t},ls=function(e){return Mi(e,Cs)?e[Cs]:{}},ds=function(e){return Mi(e,Cs)}}var Ts={set:us,get:ls,has:ds,enforce:function(e){return ds(e)?ls(e):us(e,{})},getterFor:function(e){return function(t){var r;if(!ci(t)||(r=ls(t)).type!==e)throw vs("Incompatible receiver, "+e+" required");return r}}},Is=Function.prototype,ks=jo&&Object.getOwnPropertyDescriptor,As=Mi(Is,"name"),Rs={EXISTS:As,PROPER:As&&"something"===(function(){}).name,CONFIGURABLE:As&&(!jo||jo&&ks(Is,"name").configurable)},Ps=No((function(e){var t=Rs.CONFIGURABLE,r=Ts.get,n=Ts.enforce,o=String(String).split("String");(e.exports=function(e,r,i,s){var a,c=!!s&&!!s.unsafe,g=!!s&&!!s.enumerable,y=!!s&&!!s.noTargetGet,v=s&&void 0!==s.name?s.name:r;ai(i)&&("Symbol("===String(v).slice(0,7)&&(v="["+String(v).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Mi(i,"name")||t&&i.name!==v)&&as(i,"name",v),(a=n(i)).source||(a.source=o.join("string"==typeof v?v:""))),e!==qo?(c?!y&&e[r]&&(g=!0):delete e[r],g?e[r]=i:as(e,r,i)):g?e[r]=i:Ai(r,i)})(Function.prototype,"toString",(function(){return ai(this)&&r(this).source||hs(this)}))})),Os=Math.ceil,Ns=Math.floor,Us=function(e){var t=+e;return t!=t||0===t?0:(t>0?Ns:Os)(t)},Ms=Math.max,xs=Math.min,qs=function(e,t){var r=Us(e);return r<0?Ms(r+t,0):xs(r,t)},Ls=Math.min,js=function(e){return e>0?Ls(Us(e),9007199254740991):0},Hs=function(e){return js(e.length)},Fs=function(e){return function(t,r,n){var o,i=si(t),s=Hs(i),a=qs(n,s);if(e&&r!=r){for(;s>a;)if((o=i[a++])!=o)return!0}else for(;s>a;a++)if((e||a in i)&&i[a]===r)return e||a||0;return!e&&-1}},Ks={includes:Fs(!0),indexOf:Fs(!1)},Ds=Ks.indexOf,Bs=Xo([].push),Gs=function(e,t){var r,n=si(e),o=0,i=[];for(r in n)!Mi(ys,r)&&Mi(n,r)&&Bs(i,r);for(;t.length>o;)Mi(n,r=t[o++])&&(~Ds(i,r)||Bs(i,r));return i},Ws=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],zs=Ws.concat("length","prototype"),Vs={f:Object.getOwnPropertyNames||function(e){return Gs(e,zs)}},Ys={f:Object.getOwnPropertySymbols},Js=Xo([].concat),Zs=ui("Reflect","ownKeys")||function(e){var t=Vs.f(rs(e)),r=Ys.f;return r?Js(t,r(e)):t},Xs=function(e,t,r){for(var n=Zs(t),o=ss.f,i=Qi.f,s=0;s<n.length;s++){var a=n[s];Mi(e,a)||r&&Mi(r,a)||o(e,a,i(t,a))}},Qs=/#|\.prototype\./,$s=function(e,t){var r=ta[ea(e)];return r==na||r!=ra&&(ai(t)?Lo(t):!!t)},ea=$s.normalize=function(e){return String(e).replace(Qs,".").toLowerCase()},ta=$s.data={},ra=$s.NATIVE="N",na=$s.POLYFILL="P",oa=$s,ia=Qi.f,sa=function(e,t){var r,n,o,i,s,a=e.target,c=e.global,g=e.stat;if(r=c?qo:g?qo[a]||Ai(a,{}):(qo[a]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(s=ia(r,n))&&s.value:r[n],!oa(c?n:a+(g?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Xs(i,o)}(e.sham||o&&o.sham)&&as(i,"sham",!0),Ps(r,n,i,e)}},aa={};aa[Bi("toStringTag")]="z";var ca,ua="[object z]"===String(aa),la=Bi("toStringTag"),da=qo.Object,ha="Arguments"==ei(function(){return arguments}()),pa=ua?ei:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=da(e),la))?r:ha?ei(t):"Object"==(n=ei(t))&&ai(t.callee)?"Arguments":n},fa=qo.String,ga=function(e){if("Symbol"===pa(e))throw TypeError("Cannot convert a Symbol value to a string");return fa(e)},ma=Bi("match"),ya=qo.TypeError,va=function(e){if(function(e){var t;return ci(e)&&(void 0!==(t=e[ma])?!!t:"RegExp"==ei(e))}(e))throw ya("The method doesn't accept regular expressions");return e},wa=Bi("match"),_a=function(e){var t=/./;try{"/./"[e](t)}catch(Co){try{return t[wa]=!1,"/./"[e](t)}catch(e){}}return!1},ba=Qi.f,Ea=Xo("".startsWith),Sa=Xo("".slice),Ca=Math.min,Ta=_a("startsWith"),Ia=!(Ta||(ca=ba(String.prototype,"startsWith"),!ca||ca.writable));sa({target:"String",proto:!0,forced:!Ia&&!Ta},{startsWith:function(e){var t=ga(ii(this));va(e);var r=js(Ca(arguments.length>1?arguments[1]:void 0,t.length)),n=ga(e);return Ea?Ea(t,n,r):Sa(t,r,r+n.length)===n}});var ka=function(e,t){return Xo(qo[e].prototype[t])};ka("String","startsWith");var Aa=Array.isArray||function(e){return"Array"==ei(e)},Ra=function(e,t,r){var n=zi(t);n in e?ss.f(e,n,zo(0,r)):e[n]=r},Pa=function(){},Oa=[],Na=ui("Reflect","construct"),Ua=/^\s*(?:class|function)\b/,Ma=Xo(Ua.exec),xa=!Ua.exec(Pa),qa=function(e){if(!ai(e))return!1;try{return Na(Pa,Oa,e),!0}catch(e){return!1}},La=function(e){if(!ai(e))return!1;switch(pa(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return xa||!!Ma(Ua,hs(e))}catch(e){return!0}};La.sham=!0;var ja=!Na||Lo((function(){var e;return qa(qa.call)||!qa(Object)||!qa((function(){e=!0}))||e}))?La:qa,Ha=Bi("species"),Fa=qo.Array,Ka=function(e,t){return new(function(e){var t;return Aa(e)&&(t=e.constructor,(ja(t)&&(t===Fa||Aa(t.prototype))||ci(t)&&null===(t=t[Ha]))&&(t=void 0)),void 0===t?Fa:t}(e))(0===t?0:t)},Da=Bi("species"),Ba=Bi("isConcatSpreadable"),Ga=qo.TypeError,Wa=mi>=51||!Lo((function(){var e=[];return e[Ba]=!1,e.concat()[0]!==e})),za=("concat",mi>=51||!Lo((function(){var e=[];return(e.constructor={})[Da]=function(){return{foo:1}},1!==e.concat(Boolean).foo}))),Va=function(e){if(!ci(e))return!1;var t=e[Ba];return void 0!==t?!!t:Aa(e)};sa({target:"Array",proto:!0,forced:!Wa||!za},{concat:function(e){var t,r,n,o,i,s=Ni(this),a=Ka(s,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(Va(i=-1===t?s:arguments[t])){if(c+(o=Hs(i))>9007199254740991)throw Ga("Maximum allowed index exceeded");for(r=0;r<o;r++,c++)r in i&&Ra(a,c,i[r])}else{if(c>=9007199254740991)throw Ga("Maximum allowed index exceeded");Ra(a,c++,i)}return a.length=c,a}});var Ya=ua?{}.toString:function(){return"[object "+pa(this)+"]"};ua||Ps(Object.prototype,"toString",Ya,{unsafe:!0});var Ja,Za=Function.prototype,Xa=Za.apply,Qa=Za.call,$a="object"==typeof Reflect&&Reflect.apply||(Ho?Qa.bind(Xa):function(){return Qa.apply(Xa,arguments)}),ec=Object.keys||function(e){return Gs(e,Ws)},tc=jo&&!$i?Object.defineProperties:function(e,t){rs(e);for(var r,n=si(t),o=ec(t),i=o.length,s=0;i>s;)ss.f(e,r=o[s++],n[r]);return e},rc={f:tc},nc=ui("document","documentElement"),oc=ms("IE_PROTO"),ic=function(){},sc=function(e){return"<script>"+e+"<\/script>"},ac=function(e){e.write(sc("")),e.close();var t=e.parentWindow.Object;return e=null,t},cc=function(){try{Ja=new ActiveXObject("htmlfile")}catch(e){}var e,t;cc="undefined"!=typeof document?document.domain&&Ja?ac(Ja):((t=Ji("iframe")).style.display="none",nc.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(sc("document.F=Object")),e.close(),e.F):ac(Ja);for(var r=Ws.length;r--;)delete cc.prototype[Ws[r]];return cc()};ys[oc]=!0;var uc=Object.create||function(e,t){var r;return null!==e?(ic.prototype=rs(e),r=new ic,ic.prototype=null,r[oc]=e):r=cc(),void 0===t?r:rc.f(r,t)},lc=qo.Array,dc=Math.max,hc=Vs.f,pc="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],fc={f:function(e){return pc&&"Window"==ei(e)?function(e){try{return hc(e)}catch(e){return function(e,t,r){for(var n=Hs(e),o=qs(void 0,n),i=qs(n,n),s=lc(dc(i-o,0)),a=0;o<i;o++,a++)Ra(s,a,e[o]);return s.length=a,s}(pc)}}(e):hc(si(e))}},gc=Xo([].slice),mc={f:Bi},yc=qo,vc=ss.f,wc=function(e){var t=yc.Symbol||(yc.Symbol={});Mi(t,e)||vc(t,e,{value:mc.f(e)})},_c=ss.f,bc=Bi("toStringTag"),Ec=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Mi(e,bc)&&_c(e,bc,{configurable:!0,value:t})},Sc=Xo(Xo.bind),Cc=function(e,t){return Ci(e),void 0===t?e:Ho?Sc(e,t):function(){return e.apply(t,arguments)}},Tc=Xo([].push),Ic=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,i=6==e,s=7==e,a=5==e||i;return function(c,g,y,v){for(var w,_,b=Ni(c),E=ni(b),S=Cc(g,y),T=Hs(E),I=0,k=v||Ka,A=t?k(c,T):r||s?k(c,0):void 0;T>I;I++)if((a||I in E)&&(_=S(w=E[I],I,b),e))if(t)A[I]=_;else if(_)switch(e){case 3:return!0;case 5:return w;case 6:return I;case 2:Tc(A,w)}else switch(e){case 4:return!1;case 7:Tc(A,w)}return i?-1:n||o?o:A}},kc=[Ic(0),Ic(1),Ic(2),Ic(3),Ic(4),Ic(5),Ic(6),Ic(7)][0],Ac=ms("hidden"),Rc=Bi("toPrimitive"),Pc=Ts.set,Oc=Ts.getterFor("Symbol"),Nc=Object.prototype,Uc=qo.Symbol,Mc=Uc&&Uc.prototype,xc=qo.TypeError,qc=qo.QObject,Lc=ui("JSON","stringify"),jc=Qi.f,Hc=ss.f,Fc=fc.f,Kc=Wo.f,Dc=Xo([].push),Bc=Pi("symbols"),Gc=Pi("op-symbols"),Wc=Pi("string-to-symbol-registry"),zc=Pi("symbol-to-string-registry"),Vc=Pi("wks"),Yc=!qc||!qc.prototype||!qc.prototype.findChild,Jc=jo&&Lo((function(){return 7!=uc(Hc({},"a",{get:function(){return Hc(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=jc(Nc,t);n&&delete Nc[t],Hc(e,t,r),n&&e!==Nc&&Hc(Nc,t,n)}:Hc,Zc=function(e,t){var r=Bc[e]=uc(Mc);return Pc(r,{type:"Symbol",tag:e,description:t}),jo||(r.description=t),r},Xc=function(e,t,r){e===Nc&&Xc(Gc,t,r),rs(e);var n=zi(t);return rs(r),Mi(Bc,n)?(r.enumerable?(Mi(e,Ac)&&e[Ac][n]&&(e[Ac][n]=!1),r=uc(r,{enumerable:zo(0,!1)})):(Mi(e,Ac)||Hc(e,Ac,zo(1,{})),e[Ac][n]=!0),Jc(e,n,r)):Hc(e,n,r)},Qc=function(e,t){rs(e);var r=si(t),n=ec(r).concat(ru(r));return kc(n,(function(t){jo&&!Ko($c,r,t)||Xc(e,t,r[t])})),e},$c=function(e){var t=zi(e),r=Ko(Kc,this,t);return!(this===Nc&&Mi(Bc,t)&&!Mi(Gc,t))&&(!(r||!Mi(this,t)||!Mi(Bc,t)||Mi(this,Ac)&&this[Ac][t])||r)},eu=function(e,t){var r=si(e),n=zi(t);if(r!==Nc||!Mi(Bc,n)||Mi(Gc,n)){var o=jc(r,n);return!o||!Mi(Bc,n)||Mi(r,Ac)&&r[Ac][n]||(o.enumerable=!0),o}},tu=function(e){var t=Fc(si(e)),r=[];return kc(t,(function(e){Mi(Bc,e)||Mi(ys,e)||Dc(r,e)})),r},ru=function(e){var t=e===Nc,r=Fc(t?Gc:si(e)),n=[];return kc(r,(function(e){!Mi(Bc,e)||t&&!Mi(Nc,e)||Dc(n,Bc[e])})),n};if(yi||(Mc=(Uc=function(){if(li(Mc,this))throw xc("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?ga(arguments[0]):void 0,t=ji(e),r=function(e){this===Nc&&Ko(r,Gc,e),Mi(this,Ac)&&Mi(this[Ac],t)&&(this[Ac][t]=!1),Jc(this,t,zo(1,e))};return jo&&Yc&&Jc(Nc,t,{configurable:!0,set:r}),Zc(t,e)}).prototype,Ps(Mc,"toString",(function(){return Oc(this).tag})),Ps(Uc,"withoutSetter",(function(e){return Zc(ji(e),e)})),Wo.f=$c,ss.f=Xc,rc.f=Qc,Qi.f=eu,Vs.f=fc.f=tu,Ys.f=ru,mc.f=function(e){return Zc(Bi(e),e)},jo&&(Hc(Mc,"description",{configurable:!0,get:function(){return Oc(this).description}}),Ps(Nc,"propertyIsEnumerable",$c,{unsafe:!0}))),sa({global:!0,wrap:!0,forced:!yi,sham:!yi},{Symbol:Uc}),kc(ec(Vc),(function(e){wc(e)})),sa({target:"Symbol",stat:!0,forced:!yi},{for:function(e){var t=ga(e);if(Mi(Wc,t))return Wc[t];var r=Uc(t);return Wc[t]=r,zc[r]=t,r},keyFor:function(e){if(!_i(e))throw xc(e+" is not a symbol");if(Mi(zc,e))return zc[e]},useSetter:function(){Yc=!0},useSimple:function(){Yc=!1}}),sa({target:"Object",stat:!0,forced:!yi,sham:!jo},{create:function(e,t){return void 0===t?uc(e):Qc(uc(e),t)},defineProperty:Xc,defineProperties:Qc,getOwnPropertyDescriptor:eu}),sa({target:"Object",stat:!0,forced:!yi},{getOwnPropertyNames:tu,getOwnPropertySymbols:ru}),sa({target:"Object",stat:!0,forced:Lo((function(){Ys.f(1)}))},{getOwnPropertySymbols:function(e){return Ys.f(Ni(e))}}),Lc){var nu=!yi||Lo((function(){var e=Uc();return"[null]"!=Lc([e])||"{}"!=Lc({a:e})||"{}"!=Lc(Object(e))}));sa({target:"JSON",stat:!0,forced:nu},{stringify:function(e,t,r){var n=gc(arguments),o=t;if((ci(t)||void 0!==e)&&!_i(e))return Aa(t)||(t=function(e,t){if(ai(o)&&(t=Ko(o,this,e,t)),!_i(t))return t}),n[1]=t,$a(Lc,null,n)}})}if(!Mc[Rc]){var ou=Mc.valueOf;Ps(Mc,Rc,(function(e){return Ko(ou,this)}))}Ec(Uc,"Symbol"),ys[Ac]=!0,wc("asyncIterator");var iu=ss.f,su=qo.Symbol,au=su&&su.prototype;if(jo&&ai(su)&&(!("description"in au)||void 0!==su().description)){var cu={},uu=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:ga(arguments[0]),t=li(au,this)?new su(e):void 0===e?su():su(e);return""===e&&(cu[t]=!0),t};Xs(uu,su),uu.prototype=au,au.constructor=uu;var lu="Symbol(test)"==String(su("test")),du=Xo(au.toString),hu=Xo(au.valueOf),pu=/^Symbol\((.*)\)[^)]+$/,fu=Xo("".replace),gu=Xo("".slice);iu(au,"description",{configurable:!0,get:function(){var e=hu(this),t=du(e);if(Mi(cu,e))return"";var r=lu?gu(t,7,-1):fu(t,pu,"$1");return""===r?void 0:r}}),sa({global:!0,forced:!0},{Symbol:uu})}wc("hasInstance"),wc("isConcatSpreadable"),wc("iterator"),wc("match"),wc("matchAll"),wc("replace"),wc("search"),wc("species"),wc("split"),wc("toPrimitive"),wc("toStringTag"),wc("unscopables"),Ec(qo.JSON,"JSON",!0),Ec(Math,"Math",!0),sa({global:!0},{Reflect:{}}),Ec(qo.Reflect,"Reflect",!0),yc.Symbol;var mu,yu,vu,wu=Xo("".charAt),_u=Xo("".charCodeAt),bu=Xo("".slice),Eu=function(e){return function(t,r){var n,o,i=ga(ii(t)),s=Us(r),a=i.length;return s<0||s>=a?e?"":void 0:(n=_u(i,s))<55296||n>56319||s+1===a||(o=_u(i,s+1))<56320||o>57343?e?wu(i,s):n:e?bu(i,s,s+2):o-56320+(n-55296<<10)+65536}},Su={codeAt:Eu(!1),charAt:Eu(!0)},Cu=!Lo((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Tu=ms("IE_PROTO"),Iu=qo.Object,ku=Iu.prototype,Au=Cu?Iu.getPrototypeOf:function(e){var t=Ni(e);if(Mi(t,Tu))return t[Tu];var r=t.constructor;return ai(r)&&t instanceof r?r.prototype:t instanceof Iu?ku:null},Ru=Bi("iterator"),Pu=!1;[].keys&&("next"in(vu=[].keys())?(yu=Au(Au(vu)))!==Object.prototype&&(mu=yu):Pu=!0);var Ou=null==mu||Lo((function(){var e={};return mu[Ru].call(e)!==e}));Ou&&(mu={}),ai(mu[Ru])||Ps(mu,Ru,(function(){return this}));var Nu={IteratorPrototype:mu,BUGGY_SAFARI_ITERATORS:Pu},Uu={},Mu=Nu.IteratorPrototype,xu=function(){return this},qu=qo.String,Lu=qo.TypeError,ju=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Xo(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return rs(r),function(e){if("object"==typeof e||ai(e))return e;throw Lu("Can't set "+qu(e)+" as a prototype")}(n),t?e(r,n):r.__proto__=n,r}}():void 0),Hu=Rs.PROPER,Fu=Rs.CONFIGURABLE,Ku=Nu.IteratorPrototype,Du=Nu.BUGGY_SAFARI_ITERATORS,Bu=Bi("iterator"),Gu=function(){return this},Wu=function(e,t,r,n,o,i,s){!function(e,t,r,n){var o=t+" Iterator";e.prototype=uc(Mu,{next:zo(1,r)}),Ec(e,o,!1),Uu[o]=xu}(r,t,n);var a,c,g,y=function(e){if(e===o&&E)return E;if(!Du&&e in _)return _[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},v=t+" Iterator",w=!1,_=e.prototype,b=_[Bu]||_["@@iterator"]||o&&_[o],E=!Du&&b||y(o),S="Array"==t&&_.entries||b;if(S&&(a=Au(S.call(new e)))!==Object.prototype&&a.next&&(Au(a)!==Ku&&(ju?ju(a,Ku):ai(a[Bu])||Ps(a,Bu,Gu)),Ec(a,v,!0)),Hu&&"values"==o&&b&&"values"!==b.name&&(Fu?as(_,"name","values"):(w=!0,E=function(){return Ko(b,this)})),o)if(c={values:y("values"),keys:i?E:y("keys"),entries:y("entries")},s)for(g in c)(Du||w||!(g in _))&&Ps(_,g,c[g]);else sa({target:t,proto:!0,forced:Du||w},c);return _[Bu]!==E&&Ps(_,Bu,E,{name:o}),Uu[t]=E,c},zu=Su.charAt,Vu=Ts.set,Yu=Ts.getterFor("String Iterator");Wu(String,"String",(function(e){Vu(this,{type:"String Iterator",string:ga(e),index:0})}),(function(){var e,t=Yu(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=zu(r,n),t.index+=e.length,{value:e,done:!1})}));var Ju=function(e,t,r){var n,o;rs(e);try{if(!(n=Ti(e,"return"))){if("throw"===t)throw r;return r}n=Ko(n,e)}catch(e){o=!0,n=e}if("throw"===t)throw r;if(o)throw n;return rs(n),r},Zu=function(e,t,r,n){try{return n?t(rs(r)[0],r[1]):t(r)}catch(t){Ju(e,"throw",t)}},Xu=Bi("iterator"),Qu=Array.prototype,$u=function(e){return void 0!==e&&(Uu.Array===e||Qu[Xu]===e)},el=Bi("iterator"),tl=function(e){if(null!=e)return Ti(e,el)||Ti(e,"@@iterator")||Uu[pa(e)]},rl=qo.TypeError,nl=function(e,t){var r=arguments.length<2?tl(e):t;if(Ci(r))return rs(Ko(r,e));throw rl(Ei(e)+" is not iterable")},ol=qo.Array,il=Bi("iterator"),sl=!1;try{var al=0,cl={next:function(){return{done:!!al++}},return:function(){sl=!0}};cl[il]=function(){return this},Array.from(cl,(function(){throw 2}))}catch(Eo){}var ul=function(e,t){if(!t&&!sl)return!1;var r=!1;try{var n={};n[il]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},ll=!ul((function(e){Array.from(e)}));sa({target:"Array",stat:!0,forced:ll},{from:function(e){var t=Ni(e),r=ja(this),n=arguments.length,o=n>1?arguments[1]:void 0,i=void 0!==o;i&&(o=Cc(o,n>2?arguments[2]:void 0));var s,a,c,g,y,v,w=tl(t),_=0;if(!w||this==ol&&$u(w))for(s=Hs(t),a=r?new this(s):ol(s);s>_;_++)v=i?o(t[_],_):t[_],Ra(a,_,v);else for(y=(g=nl(t,w)).next,a=r?new this:[];!(c=Ko(y,g)).done;_++)v=i?Zu(g,o,[c.value,_],!0):c.value,Ra(a,_,v);return a.length=_,a}}),yc.Array.from;var dl,hl,pl,fl="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,gl=ss.f,ml=qo.Int8Array,yl=ml&&ml.prototype,vl=qo.Uint8ClampedArray,wl=vl&&vl.prototype,_l=ml&&Au(ml),bl=yl&&Au(yl),El=Object.prototype,Sl=qo.TypeError,Cl=Bi("toStringTag"),Tl=ji("TYPED_ARRAY_TAG"),Il=ji("TYPED_ARRAY_CONSTRUCTOR"),kl=fl&&!!ju&&"Opera"!==pa(qo.opera),Al=!1,Rl={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Pl={BigInt64Array:8,BigUint64Array:8},Ol=function(e){if(!ci(e))return!1;var t=pa(e);return Mi(Rl,t)||Mi(Pl,t)};for(dl in Rl)(pl=(hl=qo[dl])&&hl.prototype)?as(pl,Il,hl):kl=!1;for(dl in Pl)(pl=(hl=qo[dl])&&hl.prototype)&&as(pl,Il,hl);if((!kl||!ai(_l)||_l===Function.prototype)&&(_l=function(){throw Sl("Incorrect invocation")},kl))for(dl in Rl)qo[dl]&&ju(qo[dl],_l);if((!kl||!bl||bl===El)&&(bl=_l.prototype,kl))for(dl in Rl)qo[dl]&&ju(qo[dl].prototype,bl);if(kl&&Au(wl)!==bl&&ju(wl,bl),jo&&!Mi(bl,Cl))for(dl in Al=!0,gl(bl,Cl,{get:function(){return ci(this)?this[Tl]:void 0}}),Rl)qo[dl]&&as(qo[dl],Tl,dl);var Nl={NATIVE_ARRAY_BUFFER_VIEWS:kl,TYPED_ARRAY_CONSTRUCTOR:Il,TYPED_ARRAY_TAG:Al&&Tl,aTypedArray:function(e){if(Ol(e))return e;throw Sl("Target is not a typed array")},aTypedArrayConstructor:function(e){if(ai(e)&&(!ju||li(_l,e)))return e;throw Sl(Ei(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(jo){if(r)for(var o in Rl){var i=qo[o];if(i&&Mi(i.prototype,e))try{delete i.prototype[e]}catch(r){try{i.prototype[e]=t}catch(e){}}}bl[e]&&!r||Ps(bl,e,r?t:kl&&yl[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,o;if(jo){if(ju){if(r)for(n in Rl)if((o=qo[n])&&Mi(o,e))try{delete o[e]}catch(e){}if(_l[e]&&!r)return;try{return Ps(_l,e,r?t:kl&&_l[e]||t)}catch(e){}}for(n in Rl)!(o=qo[n])||o[e]&&!r||Ps(o,e,t)}},isView:function(e){if(!ci(e))return!1;var t=pa(e);return"DataView"===t||Mi(Rl,t)||Mi(Pl,t)},isTypedArray:Ol,TypedArray:_l,TypedArrayPrototype:bl},Ul=qo.TypeError,Ml=Bi("species"),xl=Nl.TYPED_ARRAY_CONSTRUCTOR,ql=Nl.aTypedArrayConstructor,Ll=Nl.aTypedArray;(0,Nl.exportTypedArrayMethod)("slice",(function(e,t){for(var r=gc(Ll(this),e,t),n=ql(function(e,t){var r,n=rs(e).constructor;return void 0===n||null==(r=rs(n)[Ml])?t:function(e){if(ja(e))return e;throw Ul(Ei(e)+" is not a constructor")}(r)}(this,this[xl])),o=0,i=r.length,s=new n(i);i>o;)s[o]=r[o++];return s}),Lo((function(){new Int8Array(1).slice()})));var jl=Bi("unscopables"),Hl=Array.prototype;null==Hl[jl]&&ss.f(Hl,jl,{configurable:!0,value:uc(null)});var Fl=function(e){Hl[jl][e]=!0},Kl=Ks.includes;sa({target:"Array",proto:!0},{includes:function(e){return Kl(this,e,arguments.length>1?arguments[1]:void 0)}}),Fl("includes"),ka("Array","includes");var Dl=Xo("".indexOf);sa({target:"String",proto:!0,forced:!_a("includes")},{includes:function(e){return!!~Dl(ga(ii(this)),ga(va(e)),arguments.length>1?arguments[1]:void 0)}}),ka("String","includes");var Bl=ss.f,Gl=Ts.set,Wl=Ts.getterFor("Array Iterator");Wu(Array,"Array",(function(e,t){Gl(this,{type:"Array Iterator",target:si(e),index:0,kind:t})}),(function(){var e=Wl(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");var zl=Uu.Arguments=Uu.Array;if(Fl("keys"),Fl("values"),Fl("entries"),jo&&"values"!==zl.name)try{Bl(zl,"name",{value:"values"})}catch(Eo){}var Vl=Lo((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),Yl=Object.isExtensible,Jl=Lo((function(){Yl(1)}))||Vl?function(e){return!!ci(e)&&(!Vl||"ArrayBuffer"!=ei(e))&&(!Yl||Yl(e))}:Yl,Zl=!Lo((function(){return Object.isExtensible(Object.preventExtensions({}))})),Xl=No((function(e){var t=ss.f,r=!1,n=ji("meta"),o=0,i=function(e){t(e,n,{value:{objectID:"O"+o++,weakData:{}}})},s=e.exports={enable:function(){s.enable=function(){},r=!0;var e=Vs.f,t=Xo([].splice),o={};o[n]=1,e(o).length&&(Vs.f=function(r){for(var o=e(r),i=0,s=o.length;i<s;i++)if(o[i]===n){t(o,i,1);break}return o},sa({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:fc.f}))},fastKey:function(e,t){if(!ci(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Mi(e,n)){if(!Jl(e))return"F";if(!t)return"E";i(e)}return e[n].objectID},getWeakData:function(e,t){if(!Mi(e,n)){if(!Jl(e))return!0;if(!t)return!1;i(e)}return e[n].weakData},onFreeze:function(e){return Zl&&r&&Jl(e)&&!Mi(e,n)&&i(e),e}};ys[n]=!0}));Xl.enable,Xl.fastKey,Xl.getWeakData,Xl.onFreeze;var Ql=qo.TypeError,$l=function(e,t){this.stopped=e,this.result=t},ed=$l.prototype,td=function(e,t,r){var n,o,i,s,a,c,g,y=r&&r.that,v=!(!r||!r.AS_ENTRIES),w=!(!r||!r.IS_ITERATOR),_=!(!r||!r.INTERRUPTED),b=Cc(t,y),E=function(e){return n&&Ju(n,"normal",e),new $l(!0,e)},S=function(e){return v?(rs(e),_?b(e[0],e[1],E):b(e[0],e[1])):_?b(e,E):b(e)};if(w)n=e;else{if(!(o=tl(e)))throw Ql(Ei(e)+" is not iterable");if($u(o)){for(i=0,s=Hs(e);s>i;i++)if((a=S(e[i]))&&li(ed,a))return a;return new $l(!1)}n=nl(e,o)}for(c=n.next;!(g=Ko(c,n)).done;){try{a=S(g.value)}catch(e){Ju(n,"throw",e)}if("object"==typeof a&&a&&li(ed,a))return a}return new $l(!1)},rd=qo.TypeError,nd=function(e,t){if(li(t,e))return e;throw rd("Incorrect invocation")},od=function(e,t,r){for(var n in t)Ps(e,n,t[n],r);return e},id=Bi("species"),sd=ss.f,ad=Xl.fastKey,cd=Ts.set,ud=Ts.getterFor,ld={getConstructor:function(e,t,r,n){var o=e((function(e,o){nd(e,i),cd(e,{type:t,index:uc(null),first:void 0,last:void 0,size:0}),jo||(e.size=0),null!=o&&td(o,e[n],{that:e,AS_ENTRIES:r})})),i=o.prototype,s=ud(t),a=function(e,t,r){var n,o,i=s(e),a=c(e,t);return a?a.value=r:(i.last=a={index:o=ad(t,!0),key:t,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=a),n&&(n.next=a),jo?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},c=function(e,t){var r,n=s(e),o=ad(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return od(i,{clear:function(){for(var e=s(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,jo?e.size=0:this.size=0},delete:function(e){var t=this,r=s(t),n=c(t,e);if(n){var o=n.next,i=n.previous;delete r.index[n.index],n.removed=!0,i&&(i.next=o),o&&(o.previous=i),r.first==n&&(r.first=o),r.last==n&&(r.last=i),jo?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=s(this),n=Cc(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),od(i,r?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),jo&&sd(i,"size",{get:function(){return s(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=ud(t),i=ud(n);Wu(e,t,(function(e,t){cd(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),function(e){var t=ui(e),r=ss.f;jo&&t&&!t[id]&&r(t,id,{configurable:!0,get:function(){return this}})}(t)}};function dd(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))}function hd(e){return new this((function(t,r){if(!e||void 0===e.length)return r(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,r){if(r&&("object"==typeof r||"function"==typeof r)){var s=r.then;if("function"==typeof s)return void s.call(r,(function(t){i(e,t)}),(function(r){n[e]={status:"rejected",reason:r},0==--o&&t(n)}))}n[e]={status:"fulfilled",value:r},0==--o&&t(n)}for(var s=0;s<n.length;s++)i(s,n[s])}))}!function(e,t,r){var n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),i=n?"set":"add",s=qo[e],a=s&&s.prototype,c=s,g={},y=function(e){var t=Xo(a[e]);Ps(a,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!ci(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return o&&!ci(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!ci(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(oa(e,!ai(s)||!(o||a.forEach&&!Lo((function(){(new s).entries().next()})))))c=r.getConstructor(t,e,n,i),Xl.enable();else if(oa(e,!0)){var v=new c,w=v[i](o?{}:-0,1)!=v,_=Lo((function(){v.has(1)})),b=ul((function(e){new s(e)})),E=!o&&Lo((function(){for(var e=new s,t=5;t--;)e[i](t,t);return!e.has(-0)}));b||((c=t((function(e,t){nd(e,a);var r=function(e,t,r){var n,o;return ju&&ai(n=t.constructor)&&n!==r&&ci(o=n.prototype)&&o!==r.prototype&&ju(e,o),e}(new s,e,c);return null!=t&&td(t,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=a,a.constructor=c),(_||E)&&(y("delete"),y("has"),n&&y("get")),(E||w)&&y(i),o&&a.clear&&delete a.clear}g[e]=c,sa({global:!0,forced:c!=s},g),Ec(c,e),o||r.setStrong(c,e,n)}("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),ld),yc.Set;var pd=setTimeout,fd="undefined"!=typeof setImmediate?setImmediate:null;function gd(e){return Boolean(e&&void 0!==e.length)}function md(){}function yd(e){if(!(this instanceof yd))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Sd(e,this)}function vd(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,yd._immediateFn((function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var n;try{n=r(e._value)}catch(e){return void _d(t.promise,e)}wd(t.promise,n)}else(1===e._state?wd:_d)(t.promise,e._value)}))):e._deferreds.push(t)}function wd(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof yd)return e._state=3,e._value=t,void bd(e);if("function"==typeof r)return void Sd((n=r,o=t,function(){n.apply(o,arguments)}),e)}e._state=1,e._value=t,bd(e)}catch(t){_d(e,t)}var n,o}function _d(e,t){e._state=2,e._value=t,bd(e)}function bd(e){2===e._state&&0===e._deferreds.length&&yd._immediateFn((function(){e._handled||yd._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)vd(e,e._deferreds[t]);e._deferreds=null}function Ed(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function Sd(e,t){var r=!1;try{e((function(e){r||(r=!0,wd(t,e))}),(function(e){r||(r=!0,_d(t,e))}))}catch(e){if(r)return;r=!0,_d(t,e)}}yd.prototype.catch=function(e){return this.then(null,e)},yd.prototype.then=function(e,t){var r=new this.constructor(md);return vd(this,new Ed(e,t,r)),r},yd.prototype.finally=dd,yd.all=function(e){return new yd((function(t,r){if(!gd(e))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,(function(t){i(e,t)}),r)}n[e]=s,0==--o&&t(n)}catch(e){r(e)}}for(var s=0;s<n.length;s++)i(s,n[s])}))},yd.allSettled=hd,yd.resolve=function(e){return e&&"object"==typeof e&&e.constructor===yd?e:new yd((function(t){t(e)}))},yd.reject=function(e){return new yd((function(t,r){r(e)}))},yd.race=function(e){return new yd((function(t,r){if(!gd(e))return r(new TypeError("Promise.race accepts an array"));for(var n=0,o=e.length;n<o;n++)yd.resolve(e[n]).then(t,r)}))},yd._immediateFn="function"==typeof fd&&function(e){fd(e)}||function(e){pd(e,0)},yd._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var Cd=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"function"!=typeof Cd.Promise?Cd.Promise=yd:(Cd.Promise.prototype.finally||(Cd.Promise.prototype.finally=dd),Cd.Promise.allSettled||(Cd.Promise.allSettled=hd)),function(e){function t(){}function r(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1===o.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}function n(e){for(var t=0,r=Math.min(65536,e.length+1),n=new Uint16Array(r),o=[],i=0;;){var s=t<e.length;if(!s||i>=r-1){if(o.push(String.fromCharCode.apply(null,n.subarray(0,i))),!s)return o.join("");e=e.subarray(t),i=t=0}if(0==(128&(s=e[t++])))n[i++]=s;else if(192==(224&s)){var a=63&e[t++];n[i++]=(31&s)<<6|a}else if(224==(240&s)){a=63&e[t++];var c=63&e[t++];n[i++]=(31&s)<<12|a<<6|c}else 240==(248&s)&&(65535<(s=(7&s)<<18|(a=63&e[t++])<<12|(c=63&e[t++])<<6|63&e[t++])&&(s-=65536,n[i++]=s>>>10&1023|55296,s=56320|1023&s),n[i++]=s)}}if(e.TextEncoder&&e.TextDecoder)return!1;var o=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var r=e.length,n=0,o=Math.max(32,r+(r>>>1)+7),i=new Uint8Array(o>>>3<<3);t<r;){var s=e.charCodeAt(t++);if(55296<=s&&56319>=s){if(t<r){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,s=((1023&s)<<10)+(1023&a)+65536)}if(55296<=s&&56319>=s)continue}if(n+4>i.length&&(o+=8,o=(o*=1+t/e.length*2)>>>3<<3,(a=new Uint8Array(o)).set(i),i=a),0==(4294967168&s))i[n++]=s;else{if(0==(4294965248&s))i[n++]=s>>>6&31|192;else if(0==(4294901760&s))i[n++]=s>>>12&15|224,i[n++]=s>>>6&63|128;else{if(0!=(4292870144&s))continue;i[n++]=s>>>18&7|240,i[n++]=s>>>12&63|128,i[n++]=s>>>6&63|128}i[n++]=63&s|128}}return i.slice?i.slice(0,n):i.subarray(0,n)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1});var i=n;"function"==typeof Buffer&&Buffer.from?i=function(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf-8")}:"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&(i=function(e){var t=URL.createObjectURL(new Blob([e],{type:"text/plain;charset=UTF-8"}));try{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.send(),r.responseText}catch(t){return n(e)}finally{URL.revokeObjectURL(t)}}),r.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");return e=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),i(e)},e.TextEncoder=t,e.TextDecoder=r}("undefined"!=typeof window?window:Po),function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=o(e);if(t){var i=o(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?s(e):t}(this,r)}}function c(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function g(e,t,r){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=c(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}},g(e,t,r||e)}var y=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return r(t,[{key:"addEventListener",value:function(e,t,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:r})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,o=r.length;n<o;n++)if(r[n].callback===t)return void r.splice(n,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),r=0,n=t.length;r<n;r++){var o=t[r];try{o.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),t}(),v=function(t){n(c,t);var i=a(c);function c(){var t;return e(this,c),(t=i.call(this)).listeners||y.call(s(t)),Object.defineProperty(s(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(s(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return r(c,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),g(o(c.prototype),"dispatchEvent",this).call(this,e)}}]),c}(y),w=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new v,writable:!0,configurable:!0})}return r(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(w.prototype[Symbol.toStringTag]="AbortController",v.prototype[Symbol.toStringTag]="AbortSignal"),function(e){(function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController})(e)&&(e.AbortController=w,e.AbortSignal=v)}("undefined"!=typeof self?self:Po)}();var Td=No((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,r){var n=e.locked.get(t);void 0===n?void 0===r?e.locked.set(t,[]):e.locked.set(t,[r]):void 0!==r&&(n.unshift(r),e.locked.set(t,n))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(r,n){e.isLocked(t)?e.addToLocked(t,r):(e.addToLocked(t),r())}))},this.unlock=function(t){var r=e.locked.get(t);if(void 0!==r&&0!==r.length){var n=r.pop();e.locked.set(t,r),void 0!==n&&setTimeout(n,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return r.getInstance()}}));Oo(Td);var Id=No((function(e,t){var r=Po&&Po.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=Po&&Po.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o="browser-tabs-lock-key";function i(e){return new Promise((function(t){return setTimeout(t,e)}))}function s(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",n=0;n<e;n++)r+=t[Math.floor(61*Math.random())];return r}var a=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+s(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,a){return void 0===a&&(a=5e3),r(this,void 0,void 0,(function(){var r,c,g,y,v,w;return n(this,(function(n){switch(n.label){case 0:r=Date.now()+s(4),c=Date.now()+a,g=o+"-"+t,y=window.localStorage,n.label=1;case 1:return Date.now()<c?[4,i(30)]:[3,8];case 2:return n.sent(),null!==y.getItem(g)?[3,5]:(v=this.id+"-"+t+"-"+r,[4,i(Math.floor(25*Math.random()))]);case 3:return n.sent(),y.setItem(g,JSON.stringify({id:this.id,iat:r,timeoutKey:v,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,i(30)];case 4:return n.sent(),null!==(w=y.getItem(g))&&(w=JSON.parse(w)).id===this.id&&w.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(g,r),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(c)];case 6:n.sent(),n.label=7;case 7:return r=Date.now()+s(4),[3,1];case 8:return[2,!1]}}))}))},e.prototype.refreshLockWhileAcquired=function(e,t){return r(this,void 0,void 0,(function(){var o=this;return n(this,(function(i){return setTimeout((function(){return r(o,void 0,void 0,(function(){var r,o;return n(this,(function(n){switch(n.label){case 0:return[4,Td.default().lock(t)];case 1:return n.sent(),this.acquiredIatSet.has(t)?(r=window.localStorage,null===(o=r.getItem(e))?(Td.default().unlock(t),[2]):((o=JSON.parse(o)).timeRefreshed=Date.now(),r.setItem(e,JSON.stringify(o)),Td.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(Td.default().unlock(t),[2])}}))}))}),1e3),[2]}))}))},e.prototype.waitForSomethingToChange=function(t){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){var n=!1,o=Date.now(),i=!1;function s(){if(i||(window.removeEventListener("storage",s),e.removeFromWaiting(s),clearTimeout(a),i=!0),!n){n=!0;var t=50-(Date.now()-o);t>0?setTimeout(r,t):r()}}window.addEventListener("storage",s),e.addToWaiting(s);var a=setTimeout(s,Math.max(0,t-Date.now()))}))];case 1:return r.sent(),[2]}}))}))},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter((function(e){return e!==t})))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach((function(e){return e()}))},e.prototype.releaseLock=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.releaseLock__private__=function(t){return r(this,void 0,void 0,(function(){var r,i,s;return n(this,(function(n){switch(n.label){case 0:return r=window.localStorage,i=o+"-"+t,null===(s=r.getItem(i))?[2]:(s=JSON.parse(s)).id!==this.id?[3,2]:[4,Td.default().lock(s.iat)];case 1:n.sent(),this.acquiredIatSet.delete(s.iat),r.removeItem(i),Td.default().unlock(s.iat),e.notifyWaiters(),n.label=2;case 2:return[2]}}))}))},e.lockCorrector=function(){for(var t=Date.now()-5e3,r=window.localStorage,n=Object.keys(r),i=!1,s=0;s<n.length;s++){var a=n[s];if(a.includes(o)){var c=r.getItem(a);null!==c&&(void 0===(c=JSON.parse(c)).timeRefreshed&&c.timeAcquired<t||void 0!==c.timeRefreshed&&c.timeRefreshed<t)&&(r.removeItem(a),i=!0)}}i&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=a})),kd=Oo(Id),Ad={timeoutInSeconds:60},Rd=["login_required","consent_required","interaction_required","account_selection_required","access_denied"],Pd={name:"auth0-spa-js",version:"1.20.0"},Od=function(){return Date.now()},Nd=function(e){function t(r,n){var o=e.call(this,n)||this;return o.error=r,o.error_description=n,Object.setPrototypeOf(o,t.prototype),o}return So(t,e),t.fromPayload=function(e){return new t(e.error,e.error_description)},t}(Error),Ud=function(e){function t(r,n,o,i){void 0===i&&(i=null);var s=e.call(this,r,n)||this;return s.state=o,s.appState=i,Object.setPrototypeOf(s,t.prototype),s}return So(t,e),t}(Nd),Md=function(e){function t(){var r=e.call(this,"timeout","Timeout")||this;return Object.setPrototypeOf(r,t.prototype),r}return So(t,e),t}(Nd),xd=function(e){function t(r){var n=e.call(this)||this;return n.popup=r,Object.setPrototypeOf(n,t.prototype),n}return So(t,e),t}(Md),qd=function(e){function t(r){var n=e.call(this,"cancelled","Popup closed")||this;return n.popup=r,Object.setPrototypeOf(n,t.prototype),n}return So(t,e),t}(Nd),Ld=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return i.mfa_token=o,Object.setPrototypeOf(i,t.prototype),i}return So(t,e),t}(Nd),jd=function(e){return new Promise((function(t,r){var n,o=setInterval((function(){e.popup&&e.popup.closed&&(clearInterval(o),clearTimeout(i),window.removeEventListener("message",n,!1),r(new qd(e.popup)))}),1e3),i=setTimeout((function(){clearInterval(o),r(new xd(e.popup)),window.removeEventListener("message",n,!1)}),1e3*(e.timeoutInSeconds||60));n=function(s){if(s.data&&"authorization_response"===s.data.type){if(clearTimeout(i),clearInterval(o),window.removeEventListener("message",n,!1),e.popup.close(),s.data.response.error)return r(Nd.fromPayload(s.data.response));t(s.data.response)}},window.addEventListener("message",n)}))},Hd=function(){return window.crypto||window.msCrypto},Fd=function(){var e=Hd();return e.subtle||e.webkitSubtle},Kd=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",t="";return Array.from(Hd().getRandomValues(new Uint8Array(43))).forEach((function(r){return t+=e[r%66]})),t},Dd=function(e){return btoa(e)},Bd=function(e){return Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},Gd=function(e){return Io(void 0,void 0,void 0,(function(){var t;return ko(this,(function(r){switch(r.label){case 0:return t=Fd().digest({name:"SHA-256"},(new TextEncoder).encode(e)),window.msCrypto?[2,new Promise((function(e,r){t.oncomplete=function(t){e(t.target.result)},t.onerror=function(e){r(e.error)},t.onabort=function(){r("The digest operation was aborted")}}))]:[4,t];case 1:return[2,r.sent()]}}))}))},Wd=function(e){return function(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(e.replace(/_/g,"/").replace(/-/g,"+"))},zd=function(e){var t=new Uint8Array(e);return function(e){var t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,(function(e){return t[e]}))}(window.btoa(String.fromCharCode.apply(String,Ro([],Ao(Array.from(t)),!1))))},Vd=function(e,t){return Io(void 0,void 0,void 0,(function(){var r,n;return ko(this,(function(o){switch(o.label){case 0:return[4,(i=e,s=t,s=s||{},new Promise((function(e,t){var r=new XMLHttpRequest,n=[],o=[],a={},c=function(){return{ok:2==(r.status/100|0),statusText:r.statusText,status:r.status,url:r.responseURL,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([r.response]))},clone:c,headers:{keys:function(){return n},entries:function(){return o},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var g in r.open(s.method||"get",i,!0),r.onload=function(){r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,r){n.push(t=t.toLowerCase()),o.push([t,r]),a[t]=a[t]?a[t]+","+r:r})),e(c())},r.onerror=t,r.withCredentials="include"==s.credentials,s.headers)r.setRequestHeader(g,s.headers[g]);r.send(s.body||null)})))];case 1:return r=o.sent(),n={ok:r.ok},[4,r.json()];case 2:return[2,(n.json=o.sent(),n)]}var i,s}))}))},Yd=function(e,t,r){return Io(void 0,void 0,void 0,(function(){var n,o;return ko(this,(function(i){return n=new AbortController,t.signal=n.signal,[2,Promise.race([Vd(e,t),new Promise((function(e,t){o=setTimeout((function(){n.abort(),t(new Error("Timeout when executing 'fetch'"))}),r)}))]).finally((function(){clearTimeout(o)}))]}))}))},Jd=function(e,t,r,n,o,i,s){return Io(void 0,void 0,void 0,(function(){return ko(this,(function(a){return[2,(c={auth:{audience:t,scope:r},timeout:o,fetchUrl:e,fetchOptions:n,useFormData:s},g=i,new Promise((function(e,t){var r=new MessageChannel;r.port1.onmessage=function(r){r.data.error?t(new Error(r.data.error)):e(r.data)},g.postMessage(c,[r.port2])})))];var c,g}))}))},Zd=function(e,t,r,n,o,i,s){return void 0===s&&(s=1e4),Io(void 0,void 0,void 0,(function(){return ko(this,(function(a){return o?[2,Jd(e,t,r,n,s,o,i)]:[2,Yd(e,n,s)]}))}))};function Xd(e,t,r,n,o,i,s){return Io(this,void 0,void 0,(function(){var a,c,g,y,v,w,_,b,E;return ko(this,(function(S){switch(S.label){case 0:a=null,g=0,S.label=1;case 1:if(!(g<3))return[3,6];S.label=2;case 2:return S.trys.push([2,4,,5]),[4,Zd(e,r,n,o,i,s,t)];case 3:return c=S.sent(),a=null,[3,6];case 4:return y=S.sent(),a=y,[3,5];case 5:return g++,[3,1];case 6:if(a)throw a.message=a.message||"Failed to fetch",a;if(v=c.json,w=v.error,_=v.error_description,b=To(v,["error","error_description"]),!c.ok){if(E=_||"HTTP error. Unable to fetch ".concat(e),"mfa_required"===w)throw new Ld(w,E,b.mfa_token);throw new Nd(w||"request_error",E)}return[2,b]}}))}))}function Qd(e,t){var r=e.baseUrl,n=e.timeout,o=e.audience,i=e.scope,s=e.auth0Client,a=e.useFormData,c=To(e,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);return Io(this,void 0,void 0,(function(){var e;return ko(this,(function(g){switch(g.label){case 0:return e=a?Bd(c):JSON.stringify(c),[4,Xd("".concat(r,"/oauth/token"),n,o||"default",i,{method:"POST",body:e,headers:{"Content-Type":a?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(s||Pd))}},t,a)];case 1:return[2,g.sent()]}}))}))}var $d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e){return Array.from(new Set(e))}(e.join(" ").trim().split(/\s+/)).join(" ")},eh=function(){function e(e,t){void 0===t&&(t="@@auth0spajs@@"),this.prefix=t,this.client_id=e.client_id,this.scope=e.scope,this.audience=e.audience}return e.prototype.toKey=function(){return"".concat(this.prefix,"::").concat(this.client_id,"::").concat(this.audience,"::").concat(this.scope)},e.fromKey=function(t){var r=Ao(t.split("::"),4),n=r[0],o=r[1],i=r[2];return new e({client_id:o,scope:r[3],audience:i},n)},e.fromCacheEntry=function(t){return new e({scope:t.scope,audience:t.audience,client_id:t.client_id})},e}(),th=function(){function e(){}return e.prototype.set=function(e,t){localStorage.setItem(e,JSON.stringify(t))},e.prototype.get=function(e){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return}},e.prototype.remove=function(e){localStorage.removeItem(e)},e.prototype.allKeys=function(){return Object.keys(window.localStorage).filter((function(e){return e.startsWith("@@auth0spajs@@")}))},e}(),rh=function(){var e;this.enclosedCache=(e={},{set:function(t,r){e[t]=r},get:function(t){var r=e[t];if(r)return r},remove:function(t){delete e[t]},allKeys:function(){return Object.keys(e)}})},nh=function(){function e(e,t,r){this.cache=e,this.keyManifest=t,this.nowProvider=r,this.nowProvider=this.nowProvider||Od}return e.prototype.get=function(e,t){var r;return void 0===t&&(t=0),Io(this,void 0,void 0,(function(){var n,o,i,s,a;return ko(this,(function(c){switch(c.label){case 0:return[4,this.cache.get(e.toKey())];case 1:return(n=c.sent())?[3,4]:[4,this.getCacheKeys()];case 2:return(o=c.sent())?(i=this.matchExistingCacheKey(e,o),[4,this.cache.get(i)]):[2];case 3:n=c.sent(),c.label=4;case 4:return n?[4,this.nowProvider()]:[2];case 5:return s=c.sent(),a=Math.floor(s/1e3),n.expiresAt-t<a?n.body.refresh_token?(n.body={refresh_token:n.body.refresh_token},[4,this.cache.set(e.toKey(),n)]):[3,7]:[3,10];case 6:return c.sent(),[2,n.body];case 7:return[4,this.cache.remove(e.toKey())];case 8:return c.sent(),[4,null===(r=this.keyManifest)||void 0===r?void 0:r.remove(e.toKey())];case 9:return c.sent(),[2];case 10:return[2,n.body]}}))}))},e.prototype.set=function(e){var t;return Io(this,void 0,void 0,(function(){var r,n;return ko(this,(function(o){switch(o.label){case 0:return r=new eh({client_id:e.client_id,scope:e.scope,audience:e.audience}),[4,this.wrapCacheEntry(e)];case 1:return n=o.sent(),[4,this.cache.set(r.toKey(),n)];case 2:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.add(r.toKey())];case 3:return o.sent(),[2]}}))}))},e.prototype.clear=function(e){var t;return Io(this,void 0,void 0,(function(){var r,n=this;return ko(this,(function(o){switch(o.label){case 0:return[4,this.getCacheKeys()];case 1:return(r=o.sent())?[4,r.filter((function(t){return!e||t.includes(e)})).reduce((function(e,t){return Io(n,void 0,void 0,(function(){return ko(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return r.sent(),[4,this.cache.remove(t)];case 2:return r.sent(),[2]}}))}))}),Promise.resolve())]:[2];case 2:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.clear()];case 3:return o.sent(),[2]}}))}))},e.prototype.clearSync=function(e){var t=this,r=this.cache.allKeys();r&&r.filter((function(t){return!e||t.includes(e)})).forEach((function(e){t.cache.remove(e)}))},e.prototype.wrapCacheEntry=function(e){return Io(this,void 0,void 0,(function(){var t,r,n;return ko(this,(function(o){switch(o.label){case 0:return[4,this.nowProvider()];case 1:return t=o.sent(),r=Math.floor(t/1e3)+e.expires_in,n=Math.min(r,e.decodedToken.claims.exp),[2,{body:e,expiresAt:n}]}}))}))},e.prototype.getCacheKeys=function(){var e;return Io(this,void 0,void 0,(function(){var t;return ko(this,(function(r){switch(r.label){case 0:return this.keyManifest?[4,this.keyManifest.get()]:[3,2];case 1:return t=null===(e=r.sent())||void 0===e?void 0:e.keys,[3,4];case 2:return[4,this.cache.allKeys()];case 3:t=r.sent(),r.label=4;case 4:return[2,t]}}))}))},e.prototype.matchExistingCacheKey=function(e,t){return t.filter((function(t){var r=eh.fromKey(t),n=new Set(r.scope&&r.scope.split(" ")),o=e.scope.split(" "),i=r.scope&&o.reduce((function(e,t){return e&&n.has(t)}),!0);return"@@auth0spajs@@"===r.prefix&&r.client_id===e.client_id&&r.audience===e.audience&&i}))[0]},e}(),oh=function(){function e(e,t){this.storage=e,this.clientId=t,this.storageKey="".concat("a0.spajs.txs",".").concat(this.clientId),this.transaction=this.storage.get(this.storageKey)}return e.prototype.create=function(e){this.transaction=e,this.storage.save(this.storageKey,e,{daysUntilExpire:1})},e.prototype.get=function(){return this.transaction},e.prototype.remove=function(){delete this.transaction,this.storage.remove(this.storageKey)},e}(),ih=function(e){return"number"==typeof e},sh=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],ah=function(e){if(!e.id_token)throw new Error("ID token is required but missing");var t=function(e){var t=e.split("."),r=Ao(t,3),n=r[0],o=r[1],i=r[2];if(3!==t.length||!n||!o||!i)throw new Error("ID token could not be decoded");var s=JSON.parse(Wd(o)),a={__raw:e},c={};return Object.keys(s).forEach((function(e){a[e]=s[e],sh.includes(e)||(c[e]=s[e])})),{encoded:{header:n,payload:o,signature:i},header:JSON.parse(Wd(n)),claims:a,user:c}}(e.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw new Error('Issuer (iss) claim mismatch in the ID token; expected "'.concat(e.iss,'", found "').concat(t.claims.iss,'"'));if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error('Signature algorithm of "'.concat(t.header.alg,'" is not supported. Expected the ID token to be signed with "RS256".'));if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(e.aud,'" but was not one of "').concat(t.claims.aud.join(", "),'"'));if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw new Error('Authorized Party (azp) claim mismatch in the ID token; expected "'.concat(e.aud,'", found "').concat(t.claims.azp,'"'))}}else if(t.claims.aud!==e.aud)throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(e.aud,'" but found "').concat(t.claims.aud,'"'));if(e.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw new Error('Nonce (nonce) claim mismatch in the ID token; expected "'.concat(e.nonce,'", found "').concat(t.claims.nonce,'"'))}if(e.max_age&&!ih(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(!ih(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!ih(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");var r=e.leeway||60,n=new Date(e.now||Date.now()),o=new Date(0),i=new Date(0),s=new Date(0);if(s.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+r),o.setUTCSeconds(t.claims.exp+r),i.setUTCSeconds(t.claims.nbf-r),n>o)throw new Error("Expiration Time (exp) claim error in the ID token; current time (".concat(n,") is after expiration time (").concat(o,")"));if(ih(t.claims.nbf)&&n<i)throw new Error("Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Currrent time (".concat(n,") is before ").concat(i));if(ih(t.claims.auth_time)&&n>s)throw new Error("Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Currrent time (".concat(n,") is after last auth at ").concat(s));if(e.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw new Error('Organization ID (org_id) claim mismatch in the ID token; expected "'.concat(e.organizationId,'", found "').concat(t.claims.org_id,'"'))}return t},ch=No((function(e,t){var r=Po&&Po.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e,t){if(!t)return"";var r="; "+e;return!0===t?r:r+"="+t}function o(e,t,r){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return n("Expires",e.expires?e.expires.toUTCString():"")+n("Domain",e.domain)+n("Path",e.path)+n("Secure",e.secure)+n("SameSite",e.sameSite)}(r)}function i(e){for(var t={},r=e?e.split("; "):[],n=/(%[\dA-F]{2})+/gi,o=0;o<r.length;o++){var i=r[o].split("="),s=i.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{t[i[0].replace(n,decodeURIComponent)]=s.replace(n,decodeURIComponent)}catch(e){}}return t}function s(){return i(document.cookie)}function a(e,t,n){document.cookie=o(e,t,r({path:"/"},n))}t.__esModule=!0,t.encode=o,t.parse=i,t.getAll=s,t.get=function(e){return s()[e]},t.set=a,t.remove=function(e,t){a(e,"",r(r({},t),{expires:-1}))}}));Oo(ch),ch.encode,ch.parse,ch.getAll;var uh=ch.get,lh=ch.set,dh=ch.remove,hh={get:function(e){var t=uh(e);if(void 0!==t)return JSON.parse(t)},save:function(e,t,r){var n={};"https:"===window.location.protocol&&(n={secure:!0,sameSite:"none"}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),lh(e,JSON.stringify(t),n)},remove:function(e){dh(e)}},ph={get:function(e){return hh.get(e)||hh.get("".concat("_legacy_").concat(e))},save:function(e,t,r){var n={};"https:"===window.location.protocol&&(n={secure:!0}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),lh("".concat("_legacy_").concat(e),JSON.stringify(t),n),hh.save(e,t,r)},remove:function(e){hh.remove(e),hh.remove("".concat("_legacy_").concat(e))}},fh={get:function(e){if("undefined"!=typeof sessionStorage){var t=sessionStorage.getItem(e);if(void 0!==t)return JSON.parse(t)}},save:function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},remove:function(e){sessionStorage.removeItem(e)}};var gh,mh=("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Ci8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uCgogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuCgogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgKICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULAogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NCiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUgogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovdmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHIsdD0xLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWZvcih2YXIgbyBpbiByPWFyZ3VtZW50c1t0XSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixvKSYmKGVbb109cltvXSk7cmV0dXJuIGV9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtmdW5jdGlvbiByKGUscix0LG4pe3JldHVybiBuZXcodHx8KHQ9UHJvbWlzZSkpKChmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHMoZSl7dHJ5e2Mobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBpKGUpe3RyeXtjKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGMoZSl7dmFyIHI7ZS5kb25lP28oZS52YWx1ZSk6KHI9ZS52YWx1ZSxyIGluc3RhbmNlb2YgdD9yOm5ldyB0KChmdW5jdGlvbihlKXtlKHIpfSkpKS50aGVuKHMsaSl9Yygobj1uLmFwcGx5KGUscnx8W10pKS5uZXh0KCkpfSkpfWZ1bmN0aW9uIHQoZSxyKXt2YXIgdCxuLG8sYSxzPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OmkoMCksdGhyb3c6aSgxKSxyZXR1cm46aSgyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBpKGEpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYodCl0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtzOyl0cnl7aWYodD0xLG4mJihvPTImYVswXT9uLnJldHVybjphWzBdP24udGhyb3d8fCgobz1uLnJldHVybikmJm8uY2FsbChuKSwwKTpuLm5leHQpJiYhKG89by5jYWxsKG4sYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKG49MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIHMubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6cy5sYWJlbCsrLG49YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1zLm9wcy5wb3AoKSxzLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89cy50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtzPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtzLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJnMubGFiZWw8b1sxXSl7cy5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZzLmxhYmVsPG9bMl0pe3MubGFiZWw9b1syXSxzLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJnMub3BzLnBvcCgpLHMudHJ5cy5wb3AoKTtjb250aW51ZX1hPXIuY2FsbChlLHMpfWNhdGNoKGUpe2E9WzYsZV0sbj0wfWZpbmFsbHl7dD1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLGldKX19fXZhciBuPXt9LG89ZnVuY3Rpb24oZSxyKXtyZXR1cm4iIi5jb25jYXQoZSwifCIpLmNvbmNhdChyKX07YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uKGEpe3ZhciBzPWEuZGF0YSxpPXMudGltZW91dCxjPXMuYXV0aCx1PXMuZmV0Y2hVcmwsZj1zLmZldGNoT3B0aW9ucyxsPXMudXNlRm9ybURhdGEsaD1mdW5jdGlvbihlLHIpe3ZhciB0PSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighdClyZXR1cm4gZTt2YXIgbixvLGE9dC5jYWxsKGUpLHM9W107dHJ5e2Zvcig7KHZvaWQgMD09PXJ8fHItLSA+MCkmJiEobj1hLm5leHQoKSkuZG9uZTspcy5wdXNoKG4udmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e24mJiFuLmRvbmUmJih0PWEucmV0dXJuKSYmdC5jYWxsKGEpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gc30oYS5wb3J0cywxKVswXTtyZXR1cm4gcih2b2lkIDAsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgcixhLHMscCx5LGIsZCx2LHcsZztyZXR1cm4gdCh0aGlzLChmdW5jdGlvbih0KXtzd2l0Y2godC5sYWJlbCl7Y2FzZSAwOnM9KGE9Y3x8e30pLmF1ZGllbmNlLHA9YS5zY29wZSx0LmxhYmVsPTE7Y2FzZSAxOmlmKHQudHJ5cy5wdXNoKFsxLDcsLDhdKSwhKHk9bD8oaz1mLmJvZHksUz1uZXcgVVJMU2VhcmNoUGFyYW1zKGspLF89e30sUy5mb3JFYWNoKChmdW5jdGlvbihlLHIpe19bcl09ZX0pKSxfKTpKU09OLnBhcnNlKGYuYm9keSkpLnJlZnJlc2hfdG9rZW4mJiJyZWZyZXNoX3Rva2VuIj09PXkuZ3JhbnRfdHlwZSl7aWYoYj1mdW5jdGlvbihlLHIpe3JldHVybiBuW28oZSxyKV19KHMscCksIWIpdGhyb3cgbmV3IEVycm9yKCJUaGUgd2ViIHdvcmtlciBpcyBtaXNzaW5nIHRoZSByZWZyZXNoIHRva2VuIik7Zi5ib2R5PWw/bmV3IFVSTFNlYXJjaFBhcmFtcyhlKGUoe30seSkse3JlZnJlc2hfdG9rZW46Yn0pKS50b1N0cmluZygpOkpTT04uc3RyaW5naWZ5KGUoZSh7fSx5KSx7cmVmcmVzaF90b2tlbjpifSkpfWQ9dm9pZCAwLCJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihkPW5ldyBBYm9ydENvbnRyb2xsZXIsZi5zaWduYWw9ZC5zaWduYWwpLHY9dm9pZCAwLHQubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHQudHJ5cy5wdXNoKFsyLDQsLDVdKSxbNCxQcm9taXNlLnJhY2UoWyhtPWksbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUpe3JldHVybiBzZXRUaW1lb3V0KGUsbSl9KSkpLGZldGNoKHUsZSh7fSxmKSldKV07Y2FzZSAzOnJldHVybiB2PXQuc2VudCgpLFszLDVdO2Nhc2UgNDpyZXR1cm4gdz10LnNlbnQoKSxoLnBvc3RNZXNzYWdlKHtlcnJvcjp3Lm1lc3NhZ2V9KSxbMl07Y2FzZSA1OnJldHVybiB2P1s0LHYuanNvbigpXTooZCYmZC5hYm9ydCgpLGgucG9zdE1lc3NhZ2Uoe2Vycm9yOiJUaW1lb3V0IHdoZW4gZXhlY3V0aW5nICdmZXRjaCcifSksWzJdKTtjYXNlIDY6cmV0dXJuKHI9dC5zZW50KCkpLnJlZnJlc2hfdG9rZW4/KGZ1bmN0aW9uKGUscix0KXtuW28ocix0KV09ZX0oci5yZWZyZXNoX3Rva2VuLHMscCksZGVsZXRlIHIucmVmcmVzaF90b2tlbik6ZnVuY3Rpb24oZSxyKXtkZWxldGUgbltvKGUscildfShzLHApLGgucG9zdE1lc3NhZ2Uoe29rOnYub2ssanNvbjpyfSksWzMsOF07Y2FzZSA3OnJldHVybiBnPXQuc2VudCgpLGgucG9zdE1lc3NhZ2Uoe29rOiExLGpzb246e2Vycm9yX2Rlc2NyaXB0aW9uOmcubWVzc2FnZX19KSxbMyw4XTtjYXNlIDg6cmV0dXJuWzJdfXZhciBtLGssUyxffSkpfSkpfSkpfSgpOwoK",null,!1,function(e){return gh=gh||function(e,t,r){var n=void 0===t?null:t,o=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),o=0,i=r.length;o<i;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(e,void 0!==r&&r),i=o.indexOf("\n",10)+1,s=o.substring(i)+(n?"//# sourceMappingURL="+n:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Ci8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uCgogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuCgogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgKICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULAogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NCiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUgogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovdmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHIsdD0xLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWZvcih2YXIgbyBpbiByPWFyZ3VtZW50c1t0XSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixvKSYmKGVbb109cltvXSk7cmV0dXJuIGV9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtmdW5jdGlvbiByKGUscix0LG4pe3JldHVybiBuZXcodHx8KHQ9UHJvbWlzZSkpKChmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHMoZSl7dHJ5e2Mobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBpKGUpe3RyeXtjKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGMoZSl7dmFyIHI7ZS5kb25lP28oZS52YWx1ZSk6KHI9ZS52YWx1ZSxyIGluc3RhbmNlb2YgdD9yOm5ldyB0KChmdW5jdGlvbihlKXtlKHIpfSkpKS50aGVuKHMsaSl9Yygobj1uLmFwcGx5KGUscnx8W10pKS5uZXh0KCkpfSkpfWZ1bmN0aW9uIHQoZSxyKXt2YXIgdCxuLG8sYSxzPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OmkoMCksdGhyb3c6aSgxKSxyZXR1cm46aSgyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBpKGEpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYodCl0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtzOyl0cnl7aWYodD0xLG4mJihvPTImYVswXT9uLnJldHVybjphWzBdP24udGhyb3d8fCgobz1uLnJldHVybikmJm8uY2FsbChuKSwwKTpuLm5leHQpJiYhKG89by5jYWxsKG4sYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKG49MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIHMubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6cy5sYWJlbCsrLG49YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1zLm9wcy5wb3AoKSxzLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89cy50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtzPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtzLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJnMubGFiZWw8b1sxXSl7cy5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZzLmxhYmVsPG9bMl0pe3MubGFiZWw9b1syXSxzLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJnMub3BzLnBvcCgpLHMudHJ5cy5wb3AoKTtjb250aW51ZX1hPXIuY2FsbChlLHMpfWNhdGNoKGUpe2E9WzYsZV0sbj0wfWZpbmFsbHl7dD1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLGldKX19fXZhciBuPXt9LG89ZnVuY3Rpb24oZSxyKXtyZXR1cm4iIi5jb25jYXQoZSwifCIpLmNvbmNhdChyKX07YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uKGEpe3ZhciBzPWEuZGF0YSxpPXMudGltZW91dCxjPXMuYXV0aCx1PXMuZmV0Y2hVcmwsZj1zLmZldGNoT3B0aW9ucyxsPXMudXNlRm9ybURhdGEsaD1mdW5jdGlvbihlLHIpe3ZhciB0PSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighdClyZXR1cm4gZTt2YXIgbixvLGE9dC5jYWxsKGUpLHM9W107dHJ5e2Zvcig7KHZvaWQgMD09PXJ8fHItLSA+MCkmJiEobj1hLm5leHQoKSkuZG9uZTspcy5wdXNoKG4udmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e24mJiFuLmRvbmUmJih0PWEucmV0dXJuKSYmdC5jYWxsKGEpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gc30oYS5wb3J0cywxKVswXTtyZXR1cm4gcih2b2lkIDAsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgcixhLHMscCx5LGIsZCx2LHcsZztyZXR1cm4gdCh0aGlzLChmdW5jdGlvbih0KXtzd2l0Y2godC5sYWJlbCl7Y2FzZSAwOnM9KGE9Y3x8e30pLmF1ZGllbmNlLHA9YS5zY29wZSx0LmxhYmVsPTE7Y2FzZSAxOmlmKHQudHJ5cy5wdXNoKFsxLDcsLDhdKSwhKHk9bD8oaz1mLmJvZHksUz1uZXcgVVJMU2VhcmNoUGFyYW1zKGspLF89e30sUy5mb3JFYWNoKChmdW5jdGlvbihlLHIpe19bcl09ZX0pKSxfKTpKU09OLnBhcnNlKGYuYm9keSkpLnJlZnJlc2hfdG9rZW4mJiJyZWZyZXNoX3Rva2VuIj09PXkuZ3JhbnRfdHlwZSl7aWYoYj1mdW5jdGlvbihlLHIpe3JldHVybiBuW28oZSxyKV19KHMscCksIWIpdGhyb3cgbmV3IEVycm9yKCJUaGUgd2ViIHdvcmtlciBpcyBtaXNzaW5nIHRoZSByZWZyZXNoIHRva2VuIik7Zi5ib2R5PWw/bmV3IFVSTFNlYXJjaFBhcmFtcyhlKGUoe30seSkse3JlZnJlc2hfdG9rZW46Yn0pKS50b1N0cmluZygpOkpTT04uc3RyaW5naWZ5KGUoZSh7fSx5KSx7cmVmcmVzaF90b2tlbjpifSkpfWQ9dm9pZCAwLCJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihkPW5ldyBBYm9ydENvbnRyb2xsZXIsZi5zaWduYWw9ZC5zaWduYWwpLHY9dm9pZCAwLHQubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHQudHJ5cy5wdXNoKFsyLDQsLDVdKSxbNCxQcm9taXNlLnJhY2UoWyhtPWksbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUpe3JldHVybiBzZXRUaW1lb3V0KGUsbSl9KSkpLGZldGNoKHUsZSh7fSxmKSldKV07Y2FzZSAzOnJldHVybiB2PXQuc2VudCgpLFszLDVdO2Nhc2UgNDpyZXR1cm4gdz10LnNlbnQoKSxoLnBvc3RNZXNzYWdlKHtlcnJvcjp3Lm1lc3NhZ2V9KSxbMl07Y2FzZSA1OnJldHVybiB2P1s0LHYuanNvbigpXTooZCYmZC5hYm9ydCgpLGgucG9zdE1lc3NhZ2Uoe2Vycm9yOiJUaW1lb3V0IHdoZW4gZXhlY3V0aW5nICdmZXRjaCcifSksWzJdKTtjYXNlIDY6cmV0dXJuKHI9dC5zZW50KCkpLnJlZnJlc2hfdG9rZW4/KGZ1bmN0aW9uKGUscix0KXtuW28ocix0KV09ZX0oci5yZWZyZXNoX3Rva2VuLHMscCksZGVsZXRlIHIucmVmcmVzaF90b2tlbik6ZnVuY3Rpb24oZSxyKXtkZWxldGUgbltvKGUscildfShzLHApLGgucG9zdE1lc3NhZ2Uoe29rOnYub2ssanNvbjpyfSksWzMsOF07Y2FzZSA3OnJldHVybiBnPXQuc2VudCgpLGgucG9zdE1lc3NhZ2Uoe29rOiExLGpzb246e2Vycm9yX2Rlc2NyaXB0aW9uOmcubWVzc2FnZX19KSxbMyw4XTtjYXNlIDg6cmV0dXJuWzJdfXZhciBtLGssUyxffSkpfSkpfSkpfSgpOwoK",null,false),new Worker(gh,e)}),yh={},vh=function(){function e(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}return e.prototype.add=function(e){var t;return Io(this,void 0,void 0,(function(){var r,n;return ko(this,(function(o){switch(o.label){case 0:return n=Set.bind,[4,this.cache.get(this.manifestKey)];case 1:return(r=new(n.apply(Set,[void 0,(null===(t=o.sent())||void 0===t?void 0:t.keys)||[]]))).add(e),[4,this.cache.set(this.manifestKey,{keys:Ro([],Ao(r),!1)})];case 2:return o.sent(),[2]}}))}))},e.prototype.remove=function(e){return Io(this,void 0,void 0,(function(){var t,r;return ko(this,(function(n){switch(n.label){case 0:return[4,this.cache.get(this.manifestKey)];case 1:return(t=n.sent())?((r=new Set(t.keys)).delete(e),r.size>0?[4,this.cache.set(this.manifestKey,{keys:Ro([],Ao(r),!1)})]:[3,3]):[3,5];case 2:case 4:return[2,n.sent()];case 3:return[4,this.cache.remove(this.manifestKey)];case 5:return[2]}}))}))},e.prototype.get=function(){return this.cache.get(this.manifestKey)},e.prototype.clear=function(){return this.cache.remove(this.manifestKey)},e.prototype.createManifestKeyFrom=function(e){return"".concat("@@auth0spajs@@","::").concat(e)},e}(),wh=new kd,_h={memory:function(){return(new rh).enclosedCache},localstorage:function(){return new th}},bh=function(e){return _h[e]},Eh=function(){function e(e){var t,r,n,o;if(this.options=e,"undefined"!=typeof window&&function(){if(!Hd())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===Fd())throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")}(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)n=e.cache;else{if(this.cacheLocation=e.cacheLocation||"memory",!bh(this.cacheLocation))throw new Error('Invalid cache location "'.concat(this.cacheLocation,'"'));n=bh(this.cacheLocation)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===e.legacySameSiteCookie?hh:ph,this.orgHintCookieName=(o=this.options.client_id,"auth0.".concat(o,".organization_hint")),this.isAuthenticatedCookieName=function(e){return"auth0.".concat(e,".is.authenticated")}(this.options.client_id),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;var i,s=e.useCookiesForTransactions?this.cookieStorage:fh;this.scope=this.options.scope,this.transactionManager=new oh(s,this.options.client_id),this.nowProvider=this.options.nowProvider||Od,this.cacheManager=new nh(n,n.allKeys?null:new vh(n,this.options.client_id),this.nowProvider),this.domainUrl=(i=this.options.domain,/^https?:\/\//.test(i)?i:"https://".concat(i)),this.tokenIssuer=function(e,t){return e?e.startsWith("https://")?e:"https://".concat(e,"/"):"".concat(t,"/")}(this.options.issuer,this.domainUrl),this.defaultScope=$d("openid",void 0!==(null===(r=null===(t=this.options)||void 0===t?void 0:t.advancedOptions)||void 0===r?void 0:r.defaultScope)?this.options.advancedOptions.defaultScope:"openid profile email"),this.options.useRefreshTokens&&(this.scope=$d(this.scope,"offline_access")),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&"memory"===this.cacheLocation&&!/Trident.*rv:11\.0/.test(navigator.userAgent)&&(this.worker=new mh),this.customOptions=function(e){return e.advancedOptions,e.audience,e.auth0Client,e.authorizeTimeoutInSeconds,e.cacheLocation,e.client_id,e.domain,e.issuer,e.leeway,e.max_age,e.redirect_uri,e.scope,e.useRefreshTokens,e.useCookiesForTransactions,e.useFormData,To(e,["advancedOptions","audience","auth0Client","authorizeTimeoutInSeconds","cacheLocation","client_id","domain","issuer","leeway","max_age","redirect_uri","scope","useRefreshTokens","useCookiesForTransactions","useFormData"])}(e)}return e.prototype._url=function(e){var t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||Pd)));return"".concat(this.domainUrl).concat(e,"&auth0Client=").concat(t)},e.prototype._getParams=function(e,t,r,n,o){var i=this.options;i.useRefreshTokens,i.useCookiesForTransactions,i.useFormData,i.auth0Client,i.cacheLocation,i.advancedOptions,i.detailedResponse,i.nowProvider,i.authorizeTimeoutInSeconds,i.legacySameSiteCookie,i.sessionCheckExpiryDays,i.domain,i.leeway,i.httpTimeoutInSeconds;var s=To(i,["useRefreshTokens","useCookiesForTransactions","useFormData","auth0Client","cacheLocation","advancedOptions","detailedResponse","nowProvider","authorizeTimeoutInSeconds","legacySameSiteCookie","sessionCheckExpiryDays","domain","leeway","httpTimeoutInSeconds"]);return Co(Co(Co({},s),e),{scope:$d(this.defaultScope,this.scope,e.scope),response_type:"code",response_mode:"query",state:t,nonce:r,redirect_uri:o||this.options.redirect_uri,code_challenge:n,code_challenge_method:"S256"})},e.prototype._authorizeUrl=function(e){return this._url("/authorize?".concat(Bd(e)))},e.prototype._verifyIdToken=function(e,t,r){return Io(this,void 0,void 0,(function(){var n;return ko(this,(function(o){switch(o.label){case 0:return[4,this.nowProvider()];case 1:return n=o.sent(),[2,ah({iss:this.tokenIssuer,aud:this.options.client_id,id_token:e,nonce:t,organizationId:r,leeway:this.options.leeway,max_age:this._parseNumber(this.options.max_age),now:n})]}}))}))},e.prototype._parseNumber=function(e){return"string"!=typeof e?e:parseInt(e,10)||void 0},e.prototype._processOrgIdHint=function(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays}):this.cookieStorage.remove(this.orgHintCookieName)},e.prototype.buildAuthorizeUrl=function(e){return void 0===e&&(e={}),Io(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y,v,w;return ko(this,(function(_){switch(_.label){case 0:return t=e.redirect_uri,r=e.appState,n=To(e,["redirect_uri","appState"]),o=Dd(Kd()),i=Dd(Kd()),s=Kd(),[4,Gd(s)];case 1:return a=_.sent(),c=zd(a),g=e.fragment?"#".concat(e.fragment):"",y=this._getParams(n,o,i,c,t),v=this._authorizeUrl(y),w=e.organization||this.options.organization,this.transactionManager.create(Co({nonce:i,code_verifier:s,appState:r,scope:y.scope,audience:y.audience||"default",redirect_uri:y.redirect_uri,state:o},w&&{organizationId:w})),[2,v+g]}}))}))},e.prototype.loginWithPopup=function(e,t){return Io(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g,y,v,w,_,b;return ko(this,(function(E){switch(E.label){case 0:return e=e||{},(t=t||{}).popup||(t.popup=function(e){var t=window.screenX+(window.innerWidth-400)/2,r=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup","left=".concat(t,",top=").concat(r,",width=").concat(400,",height=").concat(600,",resizable,scrollbars=yes,status=1"))}()),r=To(e,[]),n=Dd(Kd()),o=Dd(Kd()),i=Kd(),[4,Gd(i)];case 1:return s=E.sent(),a=zd(s),c=this._getParams(r,n,o,a,this.options.redirect_uri||window.location.origin),g=this._authorizeUrl(Co(Co({},c),{response_mode:"web_message"})),t.popup.location.href=g,[4,jd(Co(Co({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}))];case 2:if(y=E.sent(),n!==y.state)throw new Error("Invalid state");return[4,Qd({audience:c.audience,scope:c.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:i,code:y.code,grant_type:"authorization_code",redirect_uri:c.redirect_uri,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},this.worker)];case 3:return v=E.sent(),w=e.organization||this.options.organization,[4,this._verifyIdToken(v.id_token,o,w)];case 4:return _=E.sent(),b=Co(Co({},v),{decodedToken:_,scope:c.scope,audience:c.audience||"default",client_id:this.options.client_id}),[4,this.cacheManager.set(b)];case 5:return E.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),this._processOrgIdHint(_.claims.org_id),[2]}}))}))},e.prototype.getUser=function(e){return void 0===e&&(e={}),Io(this,void 0,void 0,(function(){var t,r,n;return ko(this,(function(o){switch(o.label){case 0:return t=e.audience||this.options.audience||"default",r=$d(this.defaultScope,this.scope,e.scope),[4,this.cacheManager.get(new eh({client_id:this.options.client_id,audience:t,scope:r}))];case 1:return[2,(n=o.sent())&&n.decodedToken&&n.decodedToken.user]}}))}))},e.prototype.getIdTokenClaims=function(e){return void 0===e&&(e={}),Io(this,void 0,void 0,(function(){var t,r,n;return ko(this,(function(o){switch(o.label){case 0:return t=e.audience||this.options.audience||"default",r=$d(this.defaultScope,this.scope,e.scope),[4,this.cacheManager.get(new eh({client_id:this.options.client_id,audience:t,scope:r}))];case 1:return[2,(n=o.sent())&&n.decodedToken&&n.decodedToken.claims]}}))}))},e.prototype.loginWithRedirect=function(e){return void 0===e&&(e={}),Io(this,void 0,void 0,(function(){var t,r,n;return ko(this,(function(o){switch(o.label){case 0:return t=e.redirectMethod,r=To(e,["redirectMethod"]),[4,this.buildAuthorizeUrl(r)];case 1:return n=o.sent(),window.location[t||"assign"](n),[2]}}))}))},e.prototype.handleRedirectCallback=function(e){return void 0===e&&(e=window.location.href),Io(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y;return ko(this,(function(v){switch(v.label){case 0:if(0===(t=e.split("?").slice(1)).length)throw new Error("There are no query params available for parsing.");if(r=function(e){e.indexOf("#")>-1&&(e=e.substr(0,e.indexOf("#")));var t=e.split("&"),r={};return t.forEach((function(e){var t=Ao(e.split("="),2),n=t[0],o=t[1];r[n]=decodeURIComponent(o)})),r.expires_in&&(r.expires_in=parseInt(r.expires_in)),r}(t.join("")),n=r.state,o=r.code,i=r.error,s=r.error_description,!(a=this.transactionManager.get()))throw new Error("Invalid state");if(this.transactionManager.remove(),i)throw new Ud(i,s,n,a.appState);if(!a.code_verifier||a.state&&a.state!==n)throw new Error("Invalid state");return c={audience:a.audience,scope:a.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:a.code_verifier,grant_type:"authorization_code",code:o,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},void 0!==a.redirect_uri&&(c.redirect_uri=a.redirect_uri),[4,Qd(c,this.worker)];case 1:return g=v.sent(),[4,this._verifyIdToken(g.id_token,a.nonce,a.organizationId)];case 2:return y=v.sent(),[4,this.cacheManager.set(Co(Co(Co(Co({},g),{decodedToken:y,audience:a.audience,scope:a.scope}),g.scope?{oauthTokenScope:g.scope}:null),{client_id:this.options.client_id}))];case 3:return v.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),this._processOrgIdHint(y.claims.org_id),[2,{appState:a.appState}]}}))}))},e.prototype.checkSession=function(e){return Io(this,void 0,void 0,(function(){var t;return ko(this,(function(r){switch(r.label){case 0:if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return[2];this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),this.cookieStorage.remove("auth0.is.authenticated")}r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getTokenSilently(e)];case 2:return r.sent(),[3,4];case 3:if(t=r.sent(),!Rd.includes(t.error))throw t;return[3,4];case 4:return[2]}}))}))},e.prototype.getTokenSilently=function(e){return void 0===e&&(e={}),Io(this,void 0,void 0,(function(){var t,r,n,o=this;return ko(this,(function(i){return t=Co(Co({audience:this.options.audience,ignoreCache:!1},e),{scope:$d(this.defaultScope,this.scope,e.scope)}),r=t.ignoreCache,n=To(t,["ignoreCache"]),[2,(s=function(){return o._getTokenSilently(Co({ignoreCache:r},n))},a="".concat(this.options.client_id,"::").concat(n.audience,"::").concat(n.scope),c=yh[a],c||(c=s().finally((function(){delete yh[a],c=null})),yh[a]=c),c)];var s,a,c}))}))},e.prototype._getTokenSilently=function(e){return void 0===e&&(e={}),Io(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g;return ko(this,(function(y){switch(y.label){case 0:return t=e.ignoreCache,r=To(e,["ignoreCache"]),t?[3,2]:[4,this._getEntryFromCache({scope:r.scope,audience:r.audience||"default",client_id:this.options.client_id,getDetailedEntry:e.detailedResponse})];case 1:if(n=y.sent())return[2,n];y.label=2;case 2:return[4,(v=function(){return wh.acquireLock("auth0.lock.getTokenSilently",5e3)},w=10,void 0===w&&(w=3),Io(void 0,void 0,void 0,(function(){var e;return ko(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<w?[4,v()]:[3,4];case 2:if(t.sent())return[2,!0];t.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}}))})))];case 3:if(!y.sent())return[3,15];y.label=4;case 4:return y.trys.push([4,,12,14]),t?[3,6]:[4,this._getEntryFromCache({scope:r.scope,audience:r.audience||"default",client_id:this.options.client_id,getDetailedEntry:e.detailedResponse})];case 5:if(n=y.sent())return[2,n];y.label=6;case 6:return this.options.useRefreshTokens?[4,this._getTokenUsingRefreshToken(r)]:[3,8];case 7:return i=y.sent(),[3,10];case 8:return[4,this._getTokenFromIFrame(r)];case 9:i=y.sent(),y.label=10;case 10:return o=i,[4,this.cacheManager.set(Co({client_id:this.options.client_id},o))];case 11:return y.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),e.detailedResponse?(s=o.id_token,a=o.access_token,c=o.oauthTokenScope,g=o.expires_in,[2,Co(Co({id_token:s,access_token:a},c?{scope:c}:null),{expires_in:g})]):[2,o.access_token];case 12:return[4,wh.releaseLock("auth0.lock.getTokenSilently")];case 13:return y.sent(),[7];case 14:return[3,16];case 15:throw new Md;case 16:return[2]}var v,w}))}))},e.prototype.getTokenWithPopup=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),Io(this,void 0,void 0,(function(){return ko(this,(function(r){switch(r.label){case 0:return e.audience=e.audience||this.options.audience,e.scope=$d(this.defaultScope,this.scope,e.scope),t=Co(Co({},Ad),t),[4,this.loginWithPopup(e,t)];case 1:return r.sent(),[4,this.cacheManager.get(new eh({scope:e.scope,audience:e.audience||"default",client_id:this.options.client_id}))];case 2:return[2,r.sent().access_token]}}))}))},e.prototype.isAuthenticated=function(){return Io(this,void 0,void 0,(function(){return ko(this,(function(e){switch(e.label){case 0:return[4,this.getUser()];case 1:return[2,!!e.sent()]}}))}))},e.prototype.buildLogoutUrl=function(e){void 0===e&&(e={}),null!==e.client_id?e.client_id=e.client_id||this.options.client_id:delete e.client_id;var t=e.federated,r=To(e,["federated"]),n=t?"&federated":"";return this._url("/v2/logout?".concat(Bd(r)))+n},e.prototype.logout=function(e){var t=this;void 0===e&&(e={});var r=e.localOnly,n=To(e,["localOnly"]);if(r&&n.federated)throw new Error("It is invalid to set both the `federated` and `localOnly` options to `true`");var o=function(){if(t.cookieStorage.remove(t.orgHintCookieName),t.cookieStorage.remove(t.isAuthenticatedCookieName),!r){var e=t.buildLogoutUrl(n);window.location.assign(e)}};if(this.options.cache)return this.cacheManager.clear().then((function(){return o()}));this.cacheManager.clearSync(),o()},e.prototype._getTokenFromIFrame=function(e){return Io(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y,v,w,_,b,E,S,T;return ko(this,(function(I){switch(I.label){case 0:return t=Dd(Kd()),r=Dd(Kd()),n=Kd(),[4,Gd(n)];case 1:o=I.sent(),i=zd(o),s=To(e,["detailedResponse"]),a=this._getParams(s,t,r,i,e.redirect_uri||this.options.redirect_uri||window.location.origin),(c=this.cookieStorage.get(this.orgHintCookieName))&&!a.organization&&(a.organization=c),g=this._authorizeUrl(Co(Co({},a),{prompt:"none",response_mode:"web_message"})),I.label=2;case 2:if(I.trys.push([2,6,,7]),window.crossOriginIsolated)throw new Nd("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");return y=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,[4,(k=g,A=this.domainUrl,R=y,void 0===R&&(R=60),new Promise((function(e,t){var r=window.document.createElement("iframe");r.setAttribute("width","0"),r.setAttribute("height","0"),r.style.display="none";var n,o=function(){window.document.body.contains(r)&&(window.document.body.removeChild(r),window.removeEventListener("message",n,!1))},i=setTimeout((function(){t(new Md),o()}),1e3*R);n=function(r){if(r.origin==A&&r.data&&"authorization_response"===r.data.type){var s=r.source;s&&s.close(),r.data.response.error?t(Nd.fromPayload(r.data.response)):e(r.data.response),clearTimeout(i),window.removeEventListener("message",n,!1),setTimeout(o,2e3)}},window.addEventListener("message",n,!1),window.document.body.appendChild(r),r.setAttribute("src",k)})))];case 3:if(v=I.sent(),t!==v.state)throw new Error("Invalid state");return w=e.scope,_=e.audience,b=To(e,["scope","audience","redirect_uri","ignoreCache","timeoutInSeconds","detailedResponse"]),[4,Qd(Co(Co(Co({},this.customOptions),b),{scope:w,audience:_,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:n,code:v.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:b.timeout||this.httpTimeoutMs}),this.worker)];case 4:return E=I.sent(),[4,this._verifyIdToken(E.id_token,r)];case 5:return S=I.sent(),this._processOrgIdHint(S.claims.org_id),[2,Co(Co({},E),{decodedToken:S,scope:a.scope,oauthTokenScope:E.scope,audience:a.audience||"default"})];case 6:throw"login_required"===(T=I.sent()).error&&this.logout({localOnly:!0}),T;case 7:return[2]}var k,A,R}))}))},e.prototype._getTokenUsingRefreshToken=function(e){return Io(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g;return ko(this,(function(y){switch(y.label){case 0:return e.scope=$d(this.defaultScope,this.options.scope,e.scope),[4,this.cacheManager.get(new eh({scope:e.scope,audience:e.audience||"default",client_id:this.options.client_id}))];case 1:return(t=y.sent())&&t.refresh_token||this.worker?[3,3]:[4,this._getTokenFromIFrame(e)];case 2:return[2,y.sent()];case 3:r=e.redirect_uri||this.options.redirect_uri||window.location.origin,o=e.scope,i=e.audience,s=To(e,["scope","audience","ignoreCache","timeoutInSeconds","detailedResponse"]),a="number"==typeof e.timeoutInSeconds?1e3*e.timeoutInSeconds:null,y.label=4;case 4:return y.trys.push([4,6,,9]),[4,Qd(Co(Co(Co(Co(Co({},this.customOptions),s),{audience:i,scope:o,baseUrl:this.domainUrl,client_id:this.options.client_id,grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:r}),a&&{timeout:a}),{auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs}),this.worker)];case 5:return n=y.sent(),[3,9];case 6:return"The web worker is missing the refresh token"===(c=y.sent()).message||c.message&&c.message.indexOf("invalid refresh token")>-1?[4,this._getTokenFromIFrame(e)]:[3,8];case 7:return[2,y.sent()];case 8:throw c;case 9:return[4,this._verifyIdToken(n.id_token)];case 10:return g=y.sent(),[2,Co(Co({},n),{decodedToken:g,scope:e.scope,oauthTokenScope:n.scope,audience:e.audience||"default"})]}}))}))},e.prototype._getEntryFromCache=function(e){var t=e.scope,r=e.audience,n=e.client_id,o=e.getDetailedEntry,i=void 0!==o&&o;return Io(this,void 0,void 0,(function(){var e,o,s,a,c;return ko(this,(function(g){switch(g.label){case 0:return[4,this.cacheManager.get(new eh({scope:t,audience:r,client_id:n}),60)];case 1:return(e=g.sent())&&e.access_token?i?(o=e.id_token,s=e.access_token,a=e.oauthTokenScope,c=e.expires_in,[2,Co(Co({id_token:o,access_token:s},a?{scope:a}:null),{expires_in:c})]):[2,e.access_token]:[2]}}))}))},e}();function Sh(e){return Io(this,void 0,void 0,(function(){var t;return ko(this,(function(r){switch(r.label){case 0:return[4,(t=new Eh(e)).checkSession()];case 1:return r.sent(),[2,t]}}))}))}var Ch,Th,Ih,kh=n(3724),Ah=n.n(kh),Rh=n(287),Ph=n.n(Rh),Oh=n(4676),Nh=n.n(Oh),Uh=n(7154),Mh=n.n(Uh),xh=n(612),qh={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},Lh=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(Lh||{});(Ih=Lh||(Lh={})).reset=function(){Ch=3,Th=qh},Ih.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");Ch=e},Ih.setLogger=function(e){Th=e};var jh=class{constructor(e){this._name=e}debug(...e){Ch>=4&&Th.debug(jh._format(this._name,this._method),...e)}info(...e){Ch>=3&&Th.info(jh._format(this._name,this._method),...e)}warn(...e){Ch>=2&&Th.warn(jh._format(this._name,this._method),...e)}error(...e){Ch>=1&&Th.error(jh._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const r=new jh(`${e}.${t}`);return r.debug("begin"),r}static _format(e,t){const r=`[${e}]`;return t?`${r} ${t}:`:r}static debug(e,...t){Ch>=4&&Th.debug(jh._format(e),...t)}static info(e,...t){Ch>=3&&Th.info(jh._format(e),...t)}static warn(e,...t){Ch>=2&&Th.warn(jh._format(e),...t)}static error(e,...t){Ch>=1&&Th.error(jh._format(e),...t)}};Lh.reset();var Hh=class{static _randomWord(){return Ah().lib.WordArray.random(1).words[0]}static generateUUIDv4(){const e="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^Hh._randomWord()&15>>+e/4).toString(16)));return e.replace(/-/g,"")}static generateCodeVerifier(){return Hh.generateUUIDv4()+Hh.generateUUIDv4()+Hh.generateUUIDv4()}static generateCodeChallenge(e){try{const t=Ph()(e);return Nh().stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw jh.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const r=Mh().parse([e,t].join(":"));return Nh().stringify(r)}},Fh=class{constructor(e){this._name=e,this._logger=new jh(`Event('${this._name}')`),this._callbacks=[]}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}raise(...e){this._logger.debug("raise:",...e);for(const t of this._callbacks)t(...e)}},Kh=class{static decode(e){try{return(0,xh.default)(e)}catch(t){throw jh.error("JwtUtils.decode",t),t}}},Dh=class{static center({...e}){var t;return null==e.width&&(e.width=null!=(t=[800,720,600,480].find((e=>e<=window.outerWidth/1.618)))?t:360),null!=e.left||(e.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-e.width)/2))),null!=e.height&&(null!=e.top||(e.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-e.height)/2)))),e}static serialize(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${e}=${"boolean"!=typeof t?t:t?"yes":"no"}`)).join(",")}},Bh=class extends Fh{constructor(){super(...arguments),this._logger=new jh(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-Bh.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=Bh.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const r=Bh.getEpochTime()+e;if(this.expiration===r&&this._timerHandle)return void t.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),t.debug("using duration",e),this._expiration=r;const n=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*n)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},Gh=class{static readParams(e,t="query"){if(!e)throw new TypeError("Invalid URL");const r=new URL(e,"http://127.0.0.1")["fragment"===t?"hash":"search"];return new URLSearchParams(r.slice(1))}},Wh=class extends Error{constructor(e,t){var r,n,o;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw jh.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(r=e.error_description)?r:null,this.error_uri=null!=(n=e.error_uri)?n:null,this.state=e.userState,this.session_state=null!=(o=e.session_state)?o:null}},zh=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},Vh=class{constructor(e){this._logger=new jh("AccessTokenEvents"),this._expiringTimer=new Bh("Access token expiring"),this._expiredTimer=new Bh("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){let e=r-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;t.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}},Yh=class{constructor(){this._logger=new jh("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create(`getItem('${e}')`),this._data[e]}setItem(e,t){this._logger.create(`setItem('${e}')`),this._data[e]=t}removeItem(e){this._logger.create(`removeItem('${e}')`),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},Jh=class{constructor(e=[],t=null,r={}){this._jwtHandler=t,this._extraHeaders=r,this._logger=new jh("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e,t={}){const{timeoutInSeconds:r,...n}=t;if(!r)return await fetch(e,n);const o=new AbortController,i=setTimeout((()=>o.abort()),1e3*r);try{return await fetch(e,{...t,signal:o.signal})}catch(s){if(s instanceof DOMException&&"AbortError"===s.name)throw new zh("Network timed out");throw s}finally{clearTimeout(i)}}async getJson(e,{token:t,credentials:r}={}){const n=this._logger.create("getJson"),o={Accept:this._contentTypes.join(", ")};let i;t&&(n.debug("token passed, setting Authorization header"),o.Authorization="Bearer "+t),this.appendExtraHeaders(o);try{n.debug("url:",e),i=await this.fetchWithTimeout(e,{method:"GET",headers:o,credentials:r})}catch(c){throw n.error("Network Error"),c}n.debug("HTTP response received, status",i.status);const s=i.headers.get("Content-Type");if(s&&!this._contentTypes.find((e=>s.startsWith(e)))&&n.throw(new Error(`Invalid response Content-Type: ${null!=s?s:"undefined"}, from URL: ${e}`)),i.ok&&this._jwtHandler&&(null==s?void 0:s.startsWith("application/jwt")))return await this._jwtHandler(await i.text());let a;try{a=await i.json()}catch(c){if(n.error("Error parsing JSON response",c),i.ok)throw c;throw new Error(`${i.statusText} (${i.status})`)}if(!i.ok){if(n.error("Error from server:",a),a.error)throw new Wh(a);throw new Error(`${i.statusText} (${i.status}): ${JSON.stringify(a)}`)}return a}async postForm(e,{body:t,basicAuth:r,timeoutInSeconds:n,initCredentials:o}){const i=this._logger.create("postForm"),s={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};let a;void 0!==r&&(s.Authorization="Basic "+r),this.appendExtraHeaders(s);try{i.debug("url:",e),a=await this.fetchWithTimeout(e,{method:"POST",headers:s,body:t,timeoutInSeconds:n,credentials:o})}catch(v){throw i.error("Network error"),v}i.debug("HTTP response received, status",a.status);const c=a.headers.get("Content-Type");if(c&&!this._contentTypes.find((e=>c.startsWith(e))))throw new Error(`Invalid response Content-Type: ${null!=c?c:"undefined"}, from URL: ${e}`);const g=await a.text();let y={};if(g)try{y=JSON.parse(g)}catch(v){if(i.error("Error parsing JSON response",v),a.ok)throw v;throw new Error(`${a.statusText} (${a.status})`)}if(!a.ok){if(i.error("Error from server:",y),y.error)throw new Wh(y,t);throw new Error(`${a.statusText} (${a.status}): ${JSON.stringify(y)}`)}return y}appendExtraHeaders(e){const t=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),n=["authorization","accept","content-type"];0!==r.length&&r.forEach((r=>{if(n.includes(r.toLocaleLowerCase()))return void t.warn("Protected header could not be overridden",r,n);const o="function"==typeof this._extraHeaders[r]?this._extraHeaders[r]():this._extraHeaders[r];o&&""!==o&&(e[r]=o)}))}},Zh=class{constructor({prefix:e="oidc.",store:t=localStorage}={}){this._logger=new jh("WebStorageStateStore"),this._store=t,this._prefix=e}async set(e,t){this._logger.create(`set('${e}')`),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create(`get('${e}')`),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create(`remove('${e}')`),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let r=0;r<e;r++){const e=await this._store.key(r);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}},Xh=class{constructor({authority:e,metadataUrl:t,metadata:r,signingKeys:n,metadataSeed:o,client_id:i,client_secret:s,response_type:a="code",scope:c="openid",redirect_uri:g,post_logout_redirect_uri:y,client_authentication:v="client_secret_post",prompt:w,display:_,max_age:b,ui_locales:E,acr_values:S,resource:T,response_mode:I="query",filterProtocolClaims:k=!0,loadUserInfo:A=!1,staleStateAgeInSeconds:R=900,clockSkewInSeconds:O=300,userInfoJwtIssuer:N="OP",mergeClaims:U=!1,disablePKCE:M=!1,stateStore:q,refreshTokenCredentials:L,revokeTokenAdditionalContentTypes:j,fetchRequestCredentials:H,refreshTokenAllowedScope:F,extraQueryParams:K={},extraTokenParams:D={},extraHeaders:G={}}){if(this.authority=e,t?this.metadataUrl=t:(this.metadataUrl=e,e&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=o,this.signingKeys=n,this.client_id=i,this.client_secret=s,this.response_type=a,this.scope=c,this.redirect_uri=g,this.post_logout_redirect_uri=y,this.client_authentication=v,this.prompt=w,this.display=_,this.max_age=b,this.ui_locales=E,this.acr_values=S,this.resource=T,this.response_mode=I,this.filterProtocolClaims=null==k||k,this.loadUserInfo=!!A,this.staleStateAgeInSeconds=R,this.clockSkewInSeconds=O,this.userInfoJwtIssuer=N,this.mergeClaims=!!U,this.disablePKCE=!!M,this.revokeTokenAdditionalContentTypes=j,H&&L&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=H||(L||"same-origin"),q)this.stateStore=q;else{const e="undefined"!=typeof window?window.localStorage:new Yh;this.stateStore=new Zh({store:e})}this.refreshTokenAllowedScope=F,this.extraQueryParams=K,this.extraTokenParams=D,this.extraHeaders=G}},Qh=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new jh("TokenClient"),this._jsonService=new Jh(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode({grant_type:e="authorization_code",redirect_uri:t=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,...o}){const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),t||i.throw(new Error("A redirect_uri is required")),o.code||i.throw(new Error("A code is required"));const s=new URLSearchParams({grant_type:e,redirect_uri:t});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;a=Hh.generateBasicAuth(r,n);break;case"client_secret_post":s.append("client_id",r),n&&s.append("client_secret",n)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeCredentials({grant_type:e="password",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...o}){const i=this._logger.create("exchangeCredentials");t||i.throw(new Error("A client_id is required"));const s=new URLSearchParams({grant_type:e,scope:n});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=Hh.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeRefreshToken({grant_type:e="refresh_token",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,...o}){const i=this._logger.create("exchangeRefreshToken");t||i.throw(new Error("A client_id is required")),o.refresh_token||i.throw(new Error("A refresh_token is required"));const s=new URLSearchParams({grant_type:e});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=Hh.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async revoke(e){var t;const r=this._logger.create("revoke");e.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${null!=(t=e.token_type_hint)?t:"default token type"}`);const o=new URLSearchParams;for(const[i,s]of Object.entries(e))null!=s&&o.set(i,s);o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:o}),r.debug("got response")}},$h=class{constructor(e){this.id=e.id||Hh.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=Bh.getEpochTime(),this.request_type=e.request_type}toStorageString(){return new jh("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})}static fromStorageString(e){return jh.createStatic("State","fromStorageString"),new $h(JSON.parse(e))}static async clearStaleState(e,t){const r=jh.createStatic("State","clearStaleState"),n=Bh.getEpochTime()-t,o=await e.getAllKeys();r.debug("got keys",o);for(let s=0;s<o.length;s++){const t=o[s],a=await e.get(t);let c=!1;if(a)try{const e=$h.fromStorageString(a);r.debug("got item from key:",t,e.created),e.created<=n&&(c=!0)}catch(i){r.error("Error parsing state for key:",t,i),c=!0}else r.debug("no item in storage for key:",t),c=!0;c&&(r.debug("removed item for key:",t),e.remove(t))}}},ep=class extends $h{constructor(e){super(e),!0===e.code_verifier?this.code_verifier=Hh.generateCodeVerifier():e.code_verifier&&(this.code_verifier=e.code_verifier),this.code_verifier&&(this.code_challenge=Hh.generateCodeChallenge(this.code_verifier)),this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}toStorageString(){return new jh("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){jh.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return new ep(t)}},tp=class{constructor(e){this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Bh.getEpochTime()}set expires_in(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+Bh.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},rp=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],np=["sub","iss","aud","exp","iat"],op=class{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Bh.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+Bh.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new jh("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return jh.createStatic("User","fromStorageString"),new op(JSON.parse(e))}},ip="oidc-client",sp=class{constructor(){this._abort=new Fh("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:r,keepOpen:n}=await new Promise(((r,n)=>{const o=o=>{var i;const s=o.data,a=null!=(i=e.scriptOrigin)?i:window.location.origin;if(o.origin===a&&(null==s?void 0:s.source)===ip){try{const r=Gh.readParams(s.url,e.response_mode).get("state");if(r||t.warn("no state found in response url"),o.source!==this._window&&r!==e.state)return}catch(c){this._dispose(),n(new Error("Invalid response from window"))}r(s)}};window.addEventListener("message",o,!1),this._disposeHandlers.add((()=>window.removeEventListener("message",o,!1))),this._disposeHandlers.add(this._abort.addHandler((e=>{this._dispose(),n(e)})))}));return t.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t,r=!1,n=window.location.origin){e.postMessage({source:ip,url:t,keepOpen:r},n)}},ap={location:!1,toolbar:!1,height:640},cp="_blank",up=60,lp=2,dp=10,hp=class extends Xh{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:r=e.post_logout_redirect_uri,popupWindowFeatures:n=ap,popupWindowTarget:o=cp,redirectMethod:i="assign",redirectTarget:s="self",iframeNotifyParentOrigin:a=e.iframeNotifyParentOrigin,iframeScriptOrigin:c=e.iframeScriptOrigin,silent_redirect_uri:g=e.redirect_uri,silentRequestTimeoutInSeconds:y=dp,automaticSilentRenew:v=!0,validateSubOnSilentRenew:w=!0,includeIdTokenInSilentRenew:_=!1,monitorSession:b=!1,monitorAnonymousSession:E=!1,checkSessionIntervalInSeconds:S=lp,query_status_response_type:T="code",stopCheckSessionOnError:I=!0,revokeTokenTypes:k=["access_token","refresh_token"],revokeTokensOnSignout:A=!1,includeIdTokenInSilentSignout:R=!1,accessTokenExpiringNotificationTimeInSeconds:O=up,userStore:N}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=o,this.redirectMethod=i,this.redirectTarget=s,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=c,this.silent_redirect_uri=g,this.silentRequestTimeoutInSeconds=y,this.automaticSilentRenew=v,this.validateSubOnSilentRenew=w,this.includeIdTokenInSilentRenew=_,this.monitorSession=b,this.monitorAnonymousSession=E,this.checkSessionIntervalInSeconds=S,this.stopCheckSessionOnError=I,this.query_status_response_type=T,this.revokeTokenTypes=k,this.revokeTokensOnSignout=A,this.includeIdTokenInSilentSignout=R,this.accessTokenExpiringNotificationTimeInSeconds=O,N)this.userStore=N;else{const e="undefined"!=typeof window?window.sessionStorage:new Yh;this.userStore=new Zh({store:e})}}},pp=class extends sp{constructor({silentRequestTimeoutInSeconds:e=dp}){super(),this._logger=new jh("IFrameWindow"),this._timeoutInSeconds=e,this._frame=pp.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout((()=>this._abort.raise(new zh("IFrame timed out without a response"))),1e3*this._timeoutInSeconds);return this._disposeHandlers.add((()=>clearTimeout(t))),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(e=>{var t;const r=e.target;null==(t=r.parentNode)||t.removeChild(r),this._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},fp=class extends sp{constructor({popupWindowTarget:e=cp,popupWindowFeatures:t={}}){super(),this._logger=new jh("PopupWindow");const r=Dh.center({...ap,...t});this._window=window.open(void 0,e,Dh.serialize(r))}async navigate(e){var t;null==(t=this._window)||t.focus();const r=setInterval((()=>{this._window&&!this._window.closed||this._abort.raise(new Error("Popup closed by user"))}),500);return this._disposeHandlers.add((()=>clearInterval(r))),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,t)}},gp=class extends Vh{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new jh("UserManagerEvents"),this._userLoaded=new Fh("User loaded"),this._userUnloaded=new Fh("User unloaded"),this._silentRenewError=new Fh("Silent renew error"),this._userSignedIn=new Fh("User signed in"),this._userSignedOut=new Fh("User signed out"),this._userSessionChanged=new Fh("User session changed")}load(e,t=!0){super.load(e),t&&this._userLoaded.raise(e)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}_raiseSilentRenewError(e){this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},mp=class{constructor(e){this._logger=new jh("UserManager"),this.settings=new hp(e),this._client=new class{constructor(e){this._logger=new jh("OidcClient"),this.settings=new Xh(e),this.metadataService=new class{constructor(e){this._settings=e,this._logger=new jh("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new Jh(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,t),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(e=!0){return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(e=!0){return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(e=!0){return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e,t=!1){const r=this._logger.create(`_getMetadataProperty('${e}')`),n=await this.getMetadata();if(r.debug("resolved"),void 0===n[e]){if(!0===t)return void r.warn("Metadata does not contain optional property");r.throw(new Error("Metadata does not contain property "+e))}return n[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const r=await this._jsonService.getJson(t);if(e.debug("got key set",r),!Array.isArray(r.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}}(this.settings),this._claimsService=new class{constructor(e){this._settings=e,this._logger=new jh("ClaimsService")}filterProtocolClaims(e){const t={...e};if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:rp;for(const r of e)np.includes(r)||delete t[r]}return t}mergeClaims(e,t){const r={...e};for(const[n,o]of Object.entries(t))for(const e of Array.isArray(o)?o:[o]){const t=r[n];t?Array.isArray(t)?t.includes(e)||t.push(e):r[n]!==e&&("object"==typeof e&&this._settings.mergeClaims?r[n]=this.mergeClaims(t,e):r[n]=[t,e]):r[n]=e}return r}}(this.settings),this._validator=new class{constructor(e,t,r){this._settings=e,this._metadataService=t,this._claimsService=r,this._logger=new jh("ResponseValidator"),this._userInfoService=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new jh("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const r=Kh.decode(e);return t.debug("JWT decoding successful"),r}catch(r){throw t.error("Error parsing JWT response"),r}},this._jsonService=new Jh(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:e,credentials:this._settings.fetchRequestCredentials});return t.debug("got claims",n),n}}(this._settings,this._metadataService),this._tokenClient=new Qh(this._settings,this._metadataService)}async validateSigninResponse(e,t){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const r=this._logger.create("validateCredentialsResponse");e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,t,e.isOpenId),r.debug("claims processed")}async validateRefreshResponse(e,t){const r=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),r.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const n=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,n),r.debug("claims processed")}validateSignoutResponse(e,t){const r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new Wh(e)}_processSigninState(e,t){const r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new Wh(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}async _processClaims(e,t=!1,r=!0){const n=this._logger.create("_processClaims");if(e.profile=this._claimsService.filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void n.debug("not loading user info");n.debug("loading user info");const o=await this._userInfoService.getClaims(e.access_token);n.debug("user info claims received from user info endpoint"),r&&o.sub!==e.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._claimsService.mergeClaims(e.profile,this._claimsService.filterProtocolClaims(o)),n.debug("user info claims received, updated profile:",e.profile)}async _processCode(e,t){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,...t.extraTokenParams});Object.assign(e,n)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const o=Kh.decode(null!=(r=e.id_token)?r:"");if(o.sub||n.throw(new Error("ID Token is missing a subject claim")),t){const e=Kh.decode(t);o.sub!==e.sub&&n.throw(new Error("sub in id_token does not match current sub")),o.auth_time&&o.auth_time!==e.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),o.azp&&o.azp!==e.azp&&n.throw(new Error("azp in id_token does not match original azp")),!o.azp&&e.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=o}}(this.settings,this.metadataService,this._claimsService),this._tokenClient=new Qh(this.settings,this.metadataService)}async createSigninRequest({state:e,request:t,request_uri:r,request_type:n,id_token_hint:o,login_hint:i,skipUserInfo:s,nonce:a,response_type:c=this.settings.response_type,scope:g=this.settings.scope,redirect_uri:y=this.settings.redirect_uri,prompt:v=this.settings.prompt,display:w=this.settings.display,max_age:_=this.settings.max_age,ui_locales:b=this.settings.ui_locales,acr_values:E=this.settings.acr_values,resource:S=this.settings.resource,response_mode:T=this.settings.response_mode,extraQueryParams:I=this.settings.extraQueryParams,extraTokenParams:k=this.settings.extraTokenParams}){const A=this._logger.create("createSigninRequest");if("code"!==c)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const R=await this.metadataService.getAuthorizationEndpoint();A.debug("Received authorization endpoint",R);const O=new class{constructor({url:e,authority:t,client_id:r,redirect_uri:n,response_type:o,scope:i,state_data:s,response_mode:a,request_type:c,client_secret:g,nonce:y,resource:v,skipUserInfo:w,extraQueryParams:_,extraTokenParams:b,disablePKCE:E,...S}){if(this._logger=new jh("SigninRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!o)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!i)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!t)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new ep({data:s,request_type:c,code_verifier:!E,client_id:r,authority:t,redirect_uri:n,response_mode:a,client_secret:g,scope:i,extraTokenParams:b,skipUserInfo:w});const T=new URL(e);T.searchParams.append("client_id",r),T.searchParams.append("redirect_uri",n),T.searchParams.append("response_type",o),T.searchParams.append("scope",i),y&&T.searchParams.append("nonce",y),T.searchParams.append("state",this.state.id),this.state.code_challenge&&(T.searchParams.append("code_challenge",this.state.code_challenge),T.searchParams.append("code_challenge_method","S256")),v&&(Array.isArray(v)?v:[v]).forEach((e=>T.searchParams.append("resource",e)));for(const[I,k]of Object.entries({response_mode:a,...S,..._}))null!=k&&T.searchParams.append(I,k.toString());this.url=T.href}}({url:R,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:y,response_type:c,scope:g,state_data:e,prompt:v,display:w,max_age:_,ui_locales:b,id_token_hint:o,login_hint:i,acr_values:E,resource:S,request:t,request_uri:r,extraQueryParams:I,extraTokenParams:k,request_type:n,response_mode:T,client_secret:this.settings.client_secret,skipUserInfo:s,nonce:a,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const N=O.state;return await this.settings.stateStore.set(N.id,N.toStorageString()),O}async readSigninResponseState(e,t=!1){const r=this._logger.create("readSigninResponseState"),n=new tp(Gh.readParams(e,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:ep.fromStorageString(o),response:n}}async processSigninResponse(e){const t=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(e,!0);return t.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r=!1,extraTokenParams:n={}}){const o=await this._tokenClient.exchangeCredentials({username:e,password:t,...n}),i=new tp(new URLSearchParams);return Object.assign(i,o),await this._validator.validateCredentialsResponse(i,r),i}async useRefreshToken({state:e,timeoutInSeconds:t}){var r;const n=this._logger.create("useRefreshToken");let o;if(void 0===this.settings.refreshTokenAllowedScope)o=e.scope;else{const t=this.settings.refreshTokenAllowedScope.split(" ");o=((null==(r=e.scope)?void 0:r.split(" "))||[]).filter((e=>t.includes(e))).join(" ")}const i=await this._tokenClient.exchangeRefreshToken({refresh_token:e.refresh_token,scope:o,timeoutInSeconds:t}),s=new tp(new URLSearchParams);return Object.assign(s,i),n.debug("validating response",s),await this._validator.validateRefreshResponse(s,{...e,scope:o}),s}async createSignoutRequest({state:e,id_token_hint:t,request_type:r,post_logout_redirect_uri:n=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}={}){const i=this._logger.create("createSignoutRequest"),s=await this.metadataService.getEndSessionEndpoint();if(!s)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",s);const a=new class{constructor({url:e,state_data:t,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:o,request_type:i}){if(this._logger=new jh("SignoutRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");const s=new URL(e);r&&s.searchParams.append("id_token_hint",r),n&&(s.searchParams.append("post_logout_redirect_uri",n),t&&(this.state=new $h({data:t,request_type:i}),s.searchParams.append("state",this.state.id)));for(const[a,c]of Object.entries({...o}))null!=c&&s.searchParams.append(a,c.toString());this.url=s.href}}({url:s,id_token_hint:t,post_logout_redirect_uri:n,state_data:e,extraQueryParams:o,request_type:r});await this.clearStaleState();const c=a.state;return c&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(c.id,c.toStorageString())),a}async readSignoutResponseState(e,t=!1){const r=this._logger.create("readSignoutResponseState"),n=new class{constructor(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}}(Gh.readParams(e,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new Wh(n);return{state:void 0,response:n}}const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:$h.fromStorageString(o),response:n}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(e,!0);return r?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):t.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),$h.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}}(e),this._redirectNavigator=new class{constructor(e){this._settings=e,this._logger=new jh("RedirectNavigator")}async prepare({redirectMethod:e=this._settings.redirectMethod,redirectTarget:t=this._settings.redirectTarget}){var r;this._logger.create("prepare");let n=window.self;"top"===t&&(n=null!=(r=window.top)?r:window.self);const o=n.location[e].bind(n.location);let i;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise(((e,t)=>{i=t}));return o(e.url),await t},close:()=>{this._logger.create("close"),null==i||i(new Error("Redirect aborted")),n.stop()}}}}(this.settings),this._popupNavigator=new class{constructor(e){this._settings=e,this._logger=new jh("PopupNavigator")}async prepare({popupWindowFeatures:e=this._settings.popupWindowFeatures,popupWindowTarget:t=this._settings.popupWindowTarget}){return new fp({popupWindowFeatures:e,popupWindowTarget:t})}async callback(e,t=!1){this._logger.create("callback"),fp.notifyOpener(e,t)}}(this.settings),this._iframeNavigator=new class{constructor(e){this._settings=e,this._logger=new jh("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:e=this._settings.silentRequestTimeoutInSeconds}){return new pp({silentRequestTimeoutInSeconds:e})}async callback(e){this._logger.create("callback"),pp.notifyParent(e,this._settings.iframeNotifyParentOrigin)}}(this.settings),this._events=new gp(this.settings),this._silentRenewService=new class{constructor(e){this._userManager=e,this._logger=new jh("SilentRenewService"),this._isStarted=!1,this._retryTimer=new Bh("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof zh)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new class{constructor(e){this._userManager=e,this._logger=new jh("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const r=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,r.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,r.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){r.debug("initializing check session iframe");const n=this._userManager.settings.client_id,o=this._userManager.settings.checkSessionIntervalInSeconds,i=this._userManager.settings.stopCheckSessionOnError,s=new class{constructor(e,t,r,n,o){this._callback=e,this._client_id=t,this._intervalInSeconds=n,this._stopOnError=o,this._logger=new jh("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const i=new URL(r);this._frame_origin=i.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=i.href}load(){return new Promise((e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)}))}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}}(this._callback,n,e,o,i);await s.load(),this._checkSessionIFrame=s,s.start(t)}else r.warn("no check session iframe found in the metadata")}catch(n){r.error("Error from getCheckSessionIframe:",n instanceof Error?n.message:n)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval((async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}catch(r){e.error("error from querySessionStatus",r instanceof Error?r.message:r)}}),1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let r=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(r=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",t.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),r?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((e=>{this._logger.error(e)}))}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}}}(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),this._events.load(t,!1),t):(e.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),this._events.unload()}async signinRedirect(e={}){this._logger.create("signinRedirect");const{redirectMethod:t,...r}=e,n=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(e=window.location.href){const t=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(e);return r.profile&&r.profile.sub?t.info("success, signed in subject",r.profile.sub):t.info("no subject"),r}async signinResourceOwnerCredentials({username:e,password:t,skipUserInfo:r=!1}){const n=this._logger.create("signinResourceOwnerCredential"),o=await this._client.processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});n.debug("got signin response");const i=await this._buildUser(o);return i.profile&&i.profile.sub?n.info("success, signed in subject",i.profile.sub):n.info("no subject"),i}async signinPopup(e={}){const t=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_redirect_uri;i||t.throw(new Error("No popup_redirect_uri configured"));const s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),a=await this._signin({request_type:"si:p",redirect_uri:i,display:"popup",...o},s);return a&&(a.profile&&a.profile.sub?t.info("success, signed in subject",a.profile.sub):t.info("no subject")),a}async signinPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async signinSilent(e={}){var t;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,...o}=e;let i=await this._loadUser();if(null==i?void 0:i.refresh_token){r.debug("using refresh token");const e=new class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}}(i);return await this._useRefreshToken(e)}const s=this.settings.silent_redirect_uri;let a;s||r.throw(new Error("No silent_redirect_uri configured")),i&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",i.profile.sub),a=i.profile.sub);const c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return i=await this._signin({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,...o},c,a),i&&((null==(t=i.profile)?void 0:t.sub)?r.info("success, signed in subject",i.profile.sub):r.info("no subject")),i}async _useRefreshToken(e){const t=await this._client.useRefreshToken({state:e,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new op({...e,...t});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(e=window.location.href){const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(e=window.location.href){const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":return await this.signinPopupCallback(e);case"si:s":return await this.signinSilentCallback(e);default:throw new Error("invalid response_type in state")}}async signoutCallback(e=window.location.href,t=!1){const{state:r}=await this._client.readSignoutResponseState(e);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(e);break;case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(e={}){const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=e,o=this.settings.silent_redirect_uri;o||t.throw(new Error("No silent_redirect_uri configured"));const i=await this._loadUser(),s=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),a=await this._signinStart({request_type:"si:s",redirect_uri:o,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},s);try{const e=await this._client.processSigninResponse(a.url);return t.debug("got signin response"),e.session_state&&e.profile.sub?(t.info("success for subject",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid}):(t.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof Wh)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:c.session_state}}throw c}}async _signin(e,t,r){const n=await this._signinStart(e,t);return await this._signinEnd(n.url,r)}async _signinStart(e,t){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(e);return r.debug("got signin request"),await t.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(n){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),n}}async _signinEnd(e,t){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(e);r.debug("got signin response");return await this._buildUser(n,t)}async _buildUser(e,t){const r=this._logger.create("_buildUser"),n=new op(e);if(t){if(t!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new Wh({...e,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(e={}){const t=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=e,o=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},o),t.info("success")}async signoutRedirectCallback(e=window.location.href){const t=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(e);return t.info("success"),r}async signoutPopup(e={}){const t=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_post_logout_redirect_uri,s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:i,state:null==i?void 0:{},...o},s),t.info("success")}async signoutPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async _signout(e,t){const r=await this._signoutStart(e,t);return await this._signoutEnd(r.url)}async _signoutStart(e={},t){var r;const n=this._logger.create("_signoutStart");try{const o=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(o);const i=e.id_token_hint||o&&o.id_token;i&&(n.debug("setting id_token_hint in signout request"),e.id_token_hint=i),await this.removeUser(),n.debug("user removed, creating signout request");const s=await this._client.createSignoutRequest(e);return n.debug("got signout request"),await t.navigate({url:s.url,state:null==(r=s.state)?void 0:r.id})}catch(o){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),o}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(e);return t.debug("got signout response"),r}async signoutSilent(e={}){var t;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...o}=e,i=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,s=this.settings.popup_post_logout_redirect_uri,a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:s,id_token_hint:i,...o},a),r.info("success")}async signoutSilentCallback(e=window.location.href){const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e,t=this.settings.revokeTokenTypes){const r=this._logger.create("_revokeInternal");if(!e)return;const n=t.filter((t=>"string"==typeof e[t]));if(n.length){for(const t of n)await this._client.revokeToken(e[t],t),r.info(`${t} revoked successfully`),"access_token"!==t&&(e[t]=null);await this.storeUser(e),r.debug("user stored"),this._events.load(e)}else r.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),op.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const r=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}};const yp=e=>new mp({authority:e.authority,client_id:e.client_id,redirect_uri:window.location.href,scope:"openid offline email profile",automaticSilentRenew:!0,userStore:new Zh({store:window.localStorage,prefix:`oidc:user:${e.authority}/`}),stateStore:new Zh({store:window.localStorage,prefix:`oidc:state:${e.authority}/`})}),vp=e=>new mp({authority:e.realm?`${e.authority}/realms/${e.realm}`:e.authority,client_id:e.client_id,redirect_uri:window.location.href,scope:e.realm?`openid profile https://${e.cluster} user_impersonation IDENTITY`:e.audience,automaticSilentRenew:!1,userStore:new Zh({store:window.localStorage,prefix:e.realm?`oidc:user:${e.authority}/realms/${e.realm}`:`oidc:user:${e.authority}/`}),stateStore:new Zh({store:window.localStorage,prefix:e.realm?`oidc:state:${e.authority}/realms/${e.realm}`:`oidc:state:${e.authority}/`})});let wp;const _p=ao(),bp=co(),Ep=so(),Sp=()=>`cognite-app-legacy-access-token_${null!=_p?_p:bp}_${Ep}`,Cp=()=>e(void 0,void 0,void 0,(function*(){const e=yield ho(),r=new t.tU({project:Ep,baseUrl:e});let n=yield r.handleLoginRedirect();if(n)return sessionStorage.setItem(Sp(),n.accessToken),n.accessToken;if(n=yield r.login({onAuthenticate:t.RQ}),n)return n.accessToken;throw new Error("could not get access token")}));class FusionTokenProvider{getAppId(){return"fusion.cognite.com"}getToken(){return e(this,void 0,void 0,(function*(){const t=yield lo();switch(t.type){case"AZURE_AD":return function(t,r){return e(this,void 0,void 0,(function*(){const e=yield ho(),n=[`${e}/IDENTITY`,`${e}/user_impersonation`],o=new eo({auth:po(t,r),cache:fo}),i=yield o.handleRedirectPromise();i&&o.setActiveAccount(i.account);const s=o.getActiveAccount();try{if(!s)throw new Error("no user found");const{accessToken:e}=yield o.acquireTokenSilent({account:s,scopes:n});return e}catch(Eo){yield o.loginRedirect({prompt:"select_account",scopes:n,redirectStartPage:window.location.href})}throw new Error("Access token was not found")}))}(t.authority,t.appConfiguration.clientId);case"COGNITE_AUTH":return function(){var t;return e(this,void 0,void 0,(function*(){const e=yield ho(),r=Sp(),n=sessionStorage.getItem(r);if(n)try{const r=`${e}/login/status`,o=null===(t=yield fetch(r,{headers:{Authorization:`Bearer ${n}`}}).then((e=>e.json())))||void 0===t?void 0:t.data;if(o.loggedIn)return n;throw new Error("expired token")}catch(Eo){return sessionStorage.removeItem(r),Cp()}return Cp()}))}();case"ADFS2016":return _o(`${t.authority}/authorize`,t.appConfiguration.clientId);case"AUTH0":return function(t,r,n){return e(this,void 0,void 0,(function*(){const e=yield Sh({domain:r,client_id:t,cacheLocation:"localstorage",audience:n,useRefreshTokens:!0,redirect_uri:window.location.href}),o=yield e.getTokenSilently();if(!o)throw new Error("Token not found");return o}))}(t.appConfiguration.clientId,t.authority,t.appConfiguration.audience);case"KEYCLOAK":{const e=t,n=yield(r={authority:e.authority,clientId:e.appConfiguration.clientId,cluster:e.clusters[0],realm:e.realm,audience:e.appConfiguration.audience},wp||(wp=new Promise(((e,t)=>{const n=vp(Object.assign({client_id:r.clientId},r));n.getUser().then((e=>(null==e?void 0:e.expired)?n.signinSilent():e)).then((t=>e(t.access_token))).catch((e=>{t(e)})).finally((()=>n.clearStaleState()))})),wp.then((()=>{wp=void 0})),wp));return n}case"COGNITE_IDP":{const r=t,n=yield(t=>e(void 0,void 0,void 0,(function*(){const e=yp({authority:t.authority,client_id:t.clientId});return(yield e.signinSilent()).access_token})))({authority:r.authority,clientId:r.appConfiguration.clientId});return n}default:throw new Error("Unknown login type")}var r}))}getUserInformation(){return e(this,void 0,void 0,(function*(){const t=yield lo();switch(t.type){case"AZURE_AD":return function(t,r){return e(this,void 0,void 0,(function*(){const e=new eo({auth:po(t,r),cache:fo}),n=e.getActiveAccount();if(!n)throw new Error("no user found");const o=yield e.acquireTokenSilent({account:n,scopes:["User.Read"]}),i=yield fetch("https://graph.microsoft.com/v1.0/me",{headers:{"content-type":"application/json",authorization:`Bearer ${o.accessToken}`}}).then((e=>e.json()));return i}))}(t.authority,t.appConfiguration.clientId);case"AUTH0":return function(t,r,n){return e(this,void 0,void 0,(function*(){const e=yield Sh({domain:r,client_id:t,cacheLocation:"localstorage",audience:n,useRefreshTokens:!0,redirect_uri:window.location.href}),o=yield e.getUser();return{id:o.sub,displayName:o.name,userPrincipalName:o.sub,mail:o.email}}))}(t.appConfiguration.clientId,t.authority,t.appConfiguration.audience);case"KEYCLOAK":{const n=t;return r={authority:n.authority,clientId:n.appConfiguration.clientId,cluster:n.clusters[0],realm:n.realm,audience:n.appConfiguration.audience},e(void 0,void 0,void 0,(function*(){const e=vp(Object.assign({client_id:r.clientId},r)),t=yield e.getUser();return{id:(null==t?void 0:t.profile.sid)||(null==t?void 0:t.profile.subid),displayName:(null==t?void 0:t.profile.preferred_username)||(null==t?void 0:t.profile.name),mail:null==t?void 0:t.profile.email,userPrincipalName:null==t?void 0:t.profile.sub}}))}case"COGNITE_IDP":{const r=t;return(t=>e(void 0,void 0,void 0,(function*(){const e=yp({authority:t.authority,client_id:t.clientId}),r=yield e.getUser();return{id:r.profile.sub,displayName:r.profile.name,mail:r.profile.email,userPrincipalName:r.profile.sub,profilePicture:r.profile.picture}})))({authority:r.authority,clientId:r.appConfiguration.clientId})}default:throw new Error("Unknown login type")}var r}))}getFlow(){var e;const{type:t}=null!==(e=s())&&void 0!==e?e:{};return console.log("getFlow",{flow:t}),{flow:t}}logout(){return e(this,void 0,void 0,(function*(){const t=yield lo();switch(t.type){case"AZURE_AD":yield function(t,r){return e(this,void 0,void 0,(function*(){const e=new eo({auth:po(t,r),cache:fo}),n=e.getActiveAccount();e.logoutRedirect({account:n,onRedirectNavigate:()=>!1}),e.setActiveAccount(null)}))}(t.authority,t.appConfiguration.clientId);break;case"AUTH0":yield function(t,r,n){return e(this,void 0,void 0,(function*(){const e=yield Sh({domain:r,client_id:t,cacheLocation:"localstorage",audience:n,useRefreshTokens:!0,redirect_uri:window.location.href});yield e.logout({returnTo:window.location.origin})}))}(t.appConfiguration.clientId,t.authority,t.appConfiguration.audience);break;case"ADFS2016":bo(t.authority);break;case"COGNITE_AUTH":!function(){const e=Sp();sessionStorage.removeItem(e)}();break;case"KEYCLOAK":{const n=t;yield(r={authority:n.authority,clientId:n.appConfiguration.clientId,cluster:n.clusters[0],realm:n.realm,audience:n.appConfiguration.audience},e(void 0,void 0,void 0,(function*(){const e=vp(Object.assign({client_id:r.clientId},r));yield e.signoutRedirect({post_logout_redirect_uri:window.location.origin})})));break}case"COGNITE_IDP":{const r=t;yield(t=>e(void 0,void 0,void 0,(function*(){const e=yp({authority:t.authority,client_id:t.clientId});yield e.signoutRedirect({post_logout_redirect_uri:window.location.origin})})))({authority:r.authority,clientId:r.appConfiguration.clientId});break}}var r;window.location.href="/"}))}}(0,n(1577).m)("@cognite/cdf-sdk-singleton");var Tp,Ip=n(1903);const{organization:kp,cluster:Ap,idpInternalId:Rp}=null!==(Tp=(0,Ip.readLoginHints)())&&void 0!==Tp?Tp:{};class UnifiedSigninTokenProvider{getAppId(){return"apps.cognite.com/cdf"}getToken(){return e(this,void 0,void 0,(function*(){return(yield this.getService()).acquireTokenSilent(Ap)}))}getUserInformation(){return e(this,void 0,void 0,(function*(){return(yield this.getService()).getUser()}))}getFlow(){return e(this,void 0,void 0,(function*(){return{flow:(yield this.getService()).idp.type}}))}logout(){return e(this,void 0,void 0,(function*(){(yield this.getService()).logout()}))}getService(){return e(this,void 0,void 0,(function*(){if(!this.service){if(!kp)return Promise.reject(new Error("Missing login hints"));const e=yield(0,Ip.getDlc)(kp),t=yield(0,Ip.getIdp)(e.idps,Rp);if(!t)return Promise.reject(new Error("Missing idp"));this.service=new Ip.OidcService(t,kp,Ap)}return this.service}))}}const Pp=ao(),Op=so();let Np=oo()?new UnifiedSigninTokenProvider:new FusionTokenProvider;const Up=(e,r)=>(Np=r||oo()?new UnifiedSigninTokenProvider:new FusionTokenProvider,new t.c6(Object.assign(Object.assign({},e),{appId:Np.getAppId(),getToken:Fp}))),Mp=(xp=Up({appId:Np.getAppId(),baseUrl:"localhost:8080"===window.location.host?"http://localhost:8080":Pp?uo(Pp):void 0,project:Op}),xp=Object(xp),new Proxy(new WrappedSdkClient(xp),{get:function(e,t,r){return"overrideInstance"===t?e.overrideInstance:e.instance[t]}}));var xp;const qp=r=>e(void 0,void 0,void 0,(function*(){const e=yield ho();return r?new t.c6(r):new t.c6({appId:Np.getAppId(),getToken:Fp,baseUrl:e,project:Op})})),Lp=Pp?Promise.resolve():ho().then((e=>{e&&e!==Mp.getBaseUrl()&&Mp.httpClient.setBaseUrl(uo(e))}));function jp(){return e(this,void 0,void 0,(function*(){return Np.getUserInformation()}))}function Hp(){return Np.getFlow()}function Fp(){return e(this,void 0,void 0,(function*(){return(null===window||void 0===window?void 0:window.testAuthOverrides)?window.testAuthOverrides.getToken():(yield Lp,Np.getToken())}))}function Kp(){return e(this,void 0,void 0,(function*(){return Np.logout()}))}const Dp=Mp;let Bp;function Gp(){return Bp||(Bp=Mp.authenticate().then((()=>{})).catch((()=>{window.location.href="/"}))),Bp}})(),o})())}}}));