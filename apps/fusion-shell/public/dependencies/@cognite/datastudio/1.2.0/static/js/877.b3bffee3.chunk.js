(self.webpackChunkdata_studio=self.webpackChunkdata_studio||[]).push([[877],{6828:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Zr}});var a=n(5954),l=n(16256),r=n(73890),i=n(53586),u=n(44936),o=n(29439),c=n(46926),d=n(58111),s=n(98991),f=n(3870);function m(e){var t=e.justify||"space-between";return a.default.createElement(s.Z,{justify:t,type:"flex",align:"middle",style:{background:"white",position:"fixed",zIndex:f.Z.BOTTOM_ROW,width:"100%",bottom:0,left:0,padding:"12px 16px",borderTop:"2px solid rgba(0, 0, 0, 0.1)",boxShadow:"rgba(0, 0, 0, 0.1) 0px -5px 10px 0px"}},e.children)}var p=n(1413),v=n(85134),g=n(95551),h=n(94072),E=n(50379),y=n(25269),x=n(94838),I=n(39292),w=n(64143),b=n.n(w),k=function(e){var t=e.onDataSetSelected,n=e.selectedDataSetIds,r=e.type,i=e.query,u=e.showAll,d=e.setShowAll,s=(0,l.I0)(),f=(0,l.v9)(v.l8),m=(0,l.v9)(v.fI),p=(0,l.v9)(v.hL),w=(0,a.useState)([]),k=(0,o.Z)(w,2),S=k[0],Z=k[1];(0,a.useEffect)((function(){if(f.length){var e=f.filter((function(e){return u?(0,I.No)(null==e?void 0:e.name,i):(0,I.No)(null==e?void 0:e.name,i)&&m[e.id][r]}));Z(e)}}),[i,f,r,m,u]),(0,a.useEffect)((function(){s((0,v.pb)())}),[s]);var C=(0,a.useMemo)((function(){return(0,E.P_)("datasetsAcl","READ")}),[]);if(!(0,l.v9)(C))return a.default.createElement(x.Z,{title:"Missing DataSetAcl.READ",content:"Go to Access management to enable access to DataSetAcl.READ"},a.default.createElement(y.iA,null));var D=function(e){e&&e.length?t(e):t([])},T={all:{value:"all",label:"All"},some:{value:"some",label:"Containing ".concat(r)}},_=[{title:"Data set name",key:"name",dataIndex:"name",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.name,null==t?void 0:t.name)},width:"20%"},{title:"ID",key:"id",dataIndex:"id",width:"15%"},{title:"Last modified",key:"lastUpdatedTime",sorter:(0,I.o8)((function(e){return e.lastUpdatedTime})),render:function(e){return b()(e.lastUpdatedTime).format("YYYY-MM-DD hh:mm")},width:"20%"},{title:function(){return a.default.createElement("div",{style:{width:"300px"}},a.default.createElement(c.Ph,{menuPortalTarget:(0,I.ZO)(),onClick:function(e){e.preventDefault(),e.stopPropagation()},title:"Data sets: ",onChange:function(e){d("all"===e.value)},defaultValue:T.some,value:u?T.all:T.some,options:Object.values(T),closeMenuOnSelect:!0}))},render:function(e){return a.default.createElement(g.Z,null,m[e.id][r]," ",r)},width:"30%"},{key:"ids",width:"15%",render:function(e){return a.default.createElement("div",null,a.default.createElement(c.A,{href:(0,I.EW)("/data-sets/data-set/".concat(e.id)),target:"_blank",rel:"noopener noreferrer"}," ",a.default.createElement(c.JO,{type:"EyeShow",className:"em-icon"})," View data set"))}}];return a.default.createElement(a.default.Fragment,null,a.default.createElement(y.iA,{loading:!(!p&&v.fI)&&{tip:"Loading data sets"},dataSource:S.sort((function(e,t){return m[e.id]&&m[t.id]?m[t.id][r]-m[e.id][r]:-1})),columns:_,rowKey:"id",locale:{emptyText:a.default.createElement("div",null,"No data sets found")},rowSelection:{selectedRowKeys:n,onChange:function(e){return D(e)},columnTitle:a.default.createElement(h.Z,{onChange:function(e){return e.target.checked?D(S.map((function(e){return e.id}))):D([])}})}}))},S=n(28759),Z=function(){var e,t,n=(0,r.UO)().kitId,l=(0,a.useContext)(u.d),i=l.matchingKits,d=l.updateMatchingKit,s=i[n],f=(0,a.useState)((null==s||null===(e=s.targets)||void 0===e||null===(t=e.dataSetIds)||void 0===t?void 0:t.map((function(e){return e.id})))||[]),m=(0,o.Z)(f,2),v=m[0],g=m[1],h=(0,a.useState)(""),E=(0,o.Z)(h,2),x=E[0],I=E[1],w=(0,a.useState)(!1),b=(0,o.Z)(w,2),Z=b[0],C=b[1];return(0,a.useEffect)((function(){var e,t;v.length!==((null==s||null===(e=s.targets)||void 0===e||null===(t=e.dataSetIds)||void 0===t?void 0:t.length)||0)&&d((0,p.Z)((0,p.Z)({},s),{},{targets:{dataSetIds:v.map((function(e){return{id:e}}))}}))}),[s,v,d]),a.default.createElement(a.default.Fragment,null,a.default.createElement(y.kC,{column:!0,style:{width:"30%",marginBottom:"24px"}},a.default.createElement("p",null,"Data set name"),a.default.createElement(S.Z,{prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter data sets by name",value:x,onChange:function(e){return I(e.currentTarget.value)}})),a.default.createElement(y.kC,{column:!0}," ",a.default.createElement(k,{type:"assets",onDataSetSelected:function(e){return g(e)},selectedDataSetIds:v,query:x,showAll:Z,setShowAll:C})))},C=n(93433),D=n(69394),T=n(37566),_=n(78108),N=n(85809),M=n(47521),F=function(e){var t=e.timeseries,n=e.actions,i=e.extras,u=e.disableSidebarToggle,o=void 0!==u&&u,d=(0,l.I0)(),s=(0,r.k6)();return a.default.createElement(y.Wr,{key:t.id,timeSeries:t,extras:i,actions:o?n:[a.default.createElement(c.zx,{icon:"Expand",key:"open",onClick:function(){return d((0,E.QJ)({timeseriesId:t.id,showSidebar:!0},s))}},"View")].concat((0,C.Z)(n||[]))})},A=function(e){return{filter:{assetSubtreeIds:[{id:e}]}}},O=function(e){var t=e.asset,n=e.actions,i=e.extras,u=e.disableSidebarToggle,o=void 0!==u&&u,d=e.renderResourceActions,s=void 0===d?function(){return[]}:d,f=(0,r.k6)(),m=(0,l.I0)(),p=(0,l.v9)(M.B5)(t?t.id:void 0).files,v=(0,l.v9)(N.gL)(A(t?t.id:-1),!1).items;return(0,a.useEffect)((function(){m((0,M.tp)(t.id)),m((0,N.pb)(A(t.id)))}),[t.id,m]),a.default.createElement(y.Ud,{key:t.id,asset:t,timeseries:v||[],files:p||[],extras:i,actions:o?n:[a.default.createElement(c.zx,{icon:"Expand",key:"open",onClick:function(){return m((0,E.QJ)({assetId:t.id,showSidebar:!0},f))}},"View")].concat((0,C.Z)(n||[])),timeseriesPreview:function(e,t){var n=s({timeseriesId:e.id});return a.default.createElement(y.J2,{key:e.id,content:a.default.createElement(F,{timeseries:e,actions:n})},a.default.createElement("div",{style:{position:"relative"}},t))}})},K=n(20259),z=n.n(K),P=n(74672),R=function(){var e,t,n=(0,r.UO)().kitId,l=(0,a.useContext)(u.d),i=l.matchingKits,d=l.updateMatchingKit,f=i[n],m=(0,a.useState)((null==f||null===(e=f.targets)||void 0===e||null===(t=e.assetSubtreeIds)||void 0===t?void 0:t.map((function(e){return e.id})))||[]),v=(0,o.Z)(m,2),g=v[0],E=v[1],y=(0,a.useState)(""),x=(0,o.Z)(y,2),I=x[0],w=x[1],b=function(e,t,n){var l=!!t&&t.length>0,r=(0,P.useInfiniteList)(e,50,n,{enabled:!l}),i=r.data,u=r.isFetched,o=r.hasNextPage,c=r.isFetchingNextPage,d=r.fetchNextPage,s=r.isFetching,f=(0,a.useMemo)((function(){var e;return null==i||null===(e=i.pages)||void 0===e?void 0:e.reduce((function(e,t){return e.concat(t.items)}),[])}),[i]),m=(0,P.useInfiniteSearch)(e,t,50,Object.keys(n).length>0?n:void 0,{enabled:l}),p=m.data,v=m.isFetched,g=m.isFetching,h=m.isFetchingNextPage,E=m.fetchNextPage,y=m.hasNextPage,x=(0,a.useMemo)((function(){return z()(null==p?void 0:p.pages)}),[p]);return{canFetchMore:l?y:o,fetchMore:l?E:d,isFetchingMore:l?h:c,isFetched:l?v:u,isFetching:l?g:s,items:l?x:f,searchEnabled:l}}("assets",I,{root:!0}),k=b.canFetchMore,Z=b.fetchMore,_=b.isFetchingMore,N=b.isFetching,M=b.items,F=void 0===M?[]:M;(0,a.useEffect)((function(){var e,t;g.length!==((null==f||null===(e=f.targets)||void 0===e||null===(t=e.assetSubtreeIds)||void 0===t?void 0:t.length)||0)&&d((0,p.Z)((0,p.Z)({},f),{},{targets:{assetSubtreeIds:g.map((function(e){return{id:e}}))}}))}),[f,g,d]);var A=function(){return a.default.createElement("div",{style:{display:"flex",justifyContent:"right"}},a.default.createElement(c.zx,{onClick:function(){return Z()},disabled:!k,loading:_,type:"primary"},"Load next page"))};return a.default.createElement(a.default.Fragment,null,a.default.createElement(s.Z,{type:"flex",gutter:[8,12],style:{marginBottom:"24px"}},a.default.createElement(D.Z,{span:6},a.default.createElement("p",null,"Root Asset name"),a.default.createElement(S.Z,{prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter root assets by name",value:I,onChange:function(e){return w(e.currentTarget.value)}}))),a.default.createElement(s.Z,null,a.default.createElement(T.Z,{loading:!(!N&&!_)&&{tip:"Loading assets "},dataSource:F,columns:L,rowKey:"id",locale:{emptyText:a.default.createElement("div",null,"No assets found")},pagination:!1,footer:function(){return a.default.createElement(A,null)},rowSelection:{selectedRowKeys:g,onChange:function(e){e&&e.length&&E((0,C.Z)(new Set([].concat((0,C.Z)(g),(0,C.Z)(e.map((function(e){return Number(e)})))))))},columnTitle:a.default.createElement(h.Z,{onChange:function(e){e.target.checked?E((0,C.Z)(new Set([].concat((0,C.Z)(g),(0,C.Z)(F.map((function(e){return e.id}))))))):E([])}})}})))},L=[{title:"Name",key:"name",dataIndex:"name",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.name,null==t?void 0:t.name)},width:"40%",render:function(e,t){return a.default.createElement(y.kC,{align:!0},a.default.createElement(_.Z,{style:{marginRight:"6px",display:"flex"},content:a.default.createElement(O,{asset:t})},a.default.createElement(c.JO,{type:"Assets"})),a.default.createElement("span",null,e||"<no name>"))}},{title:"Description",key:"description",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.description,null==t?void 0:t.description)},width:"40%",dataIndex:"description"},{title:"Last modified",key:"last-modified",width:"15%",sorter:(0,I.o8)((function(e){return null==e?void 0:e.lastUpdatedTime})),render:function(e){return b()(e.lastUpdatedTime).format("YYYY-MM-DD hh:mm")}}],Y=n(94850),B=n(77742),U=n(8208),W=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__wt6422-0"})(["&&&{background-color:white;padding:0;margin-bottom:90px;}"]),j=(0,d.default)(U.Z).withConfig({displayName:"datastudio__TabsStyled",componentId:"datastudio__wt6422-1"})(["&&&{width:100%;}&&& .ant-tabs-tab{padding:16px 0;}&&& .ant-tabs-ink-bar{background-color:",";height:4px;}"],c.wL["midblue-3"].hex()),q=function(){var e,t,n,l,i,d,s=(0,r.k6)(),f=(0,r.$B)("/:project/:path*"),p=(0,r.UO)().kitId,v=(0,a.useContext)(u.d).matchingKits[p],g=(0,a.useState)("dataSetIds"),h=(0,o.Z)(g,2),E=h[0],x=h[1];return v?a.default.createElement(W,null,a.default.createElement(c.Dx,{level:3,style:{marginTop:"20px"}},"Select Assets"),a.default.createElement(y.T,{height:4}),a.default.createElement(j,{activeKey:E,onChange:function(e){return x(e)}},a.default.createElement(j.TabPane,{key:"dataSetIds",tab:a.default.createElement(c.Dx,{level:5},"Group by data sets")},a.default.createElement(Z,null)),a.default.createElement(j.TabPane,{key:"assetSubtreeIds",tab:a.default.createElement(c.Dx,{level:5},"Group by root assets")},a.default.createElement(R,null))),a.default.createElement(m,null,a.default.createElement(c.zx,{type:"secondary",onClick:function(){return s.goBack()}},"Back"),a.default.createElement(c.zx,{type:"primary",onClick:function(){var e;(0,Y.t5)(Y.cY.assets,{modelId:null==v||null===(e=v.threeDModelSources)||void 0===e?void 0:e.modelId,filteredBy:E}),s.push((0,I.EW)("/".concat(null==f?void 0:f.params.path,"/configure")))},style:{marginLeft:"20px"},disabled:(i=null==v||null===(e=v.targets)||void 0===e||null===(t=e.dataSetIds)||void 0===t?void 0:t.length,d=null==v||null===(n=v.targets)||void 0===n||null===(l=n.assetSubtreeIds)||void 0===l?void 0:l.length,!i&&!d)},"Next"))):a.default.createElement(r.l_,{to:(0,I.EW)("/".concat(B.m,"/3d_matching"))})},J=n(99491),X=n(1560),H=function(e){var t,n=e.assetId,l=(0,P.useCdfItem)("assets",{id:n}),r=l.data,i=l.isFetched;return a.default.createElement(J.Z,{spinning:!i},a.default.createElement(y.J2,{content:a.default.createElement(X.b,{assetId:n})},a.default.createElement(g.Z,null,a.default.createElement(c.JO,{type:"Assets"})," ",null!==(t=null==r?void 0:r.name)&&void 0!==t?t:null==r?void 0:r.externalId)))},Q=["equipment","branch","structure","box","cylinder","facet group","curve","pyramid","line","of"],$=function(e){var t,n=e.dataSetId,l=(0,P.useCdfItem)("datasets",{id:n}),r=l.data,i=l.isFetched;return a.default.createElement(J.Z,{spinning:!i},a.default.createElement(y.J2,{content:a.default.createElement(y.v$,null,r?Object.keys(r).map((function(e){return a.default.createElement(y.ED,{title:e},function(e){try{return JSON.stringify(e)}catch(e){return"N/A"}}(r[e]))})):a.default.createElement(y.ED,null,"No details"))},a.default.createElement(g.Z,null,a.default.createElement(c.JO,{type:"Boards"})," ",null!==(t=null==r?void 0:r.name)&&void 0!==t?t:null==r?void 0:r.externalId)))},G=n(50470),V=function(){var e,t,n,l,r,i,o,d,s,f,m,p,v,h,E=(0,a.useContext)(u.d),x=E.matchingKits,w=E.toggleSummaryViewer,b=E.matchingSummaryVisible,k=x[(0,G.R)(window.location.href)||""];return k?a.default.createElement(c.dy,{visible:b,width:400,onCancel:function(){return w(!1)},getContainer:(0,I.ZO)(),footer:null,title:"3D matching summary"},a.default.createElement(y.v$,null,a.default.createElement(y.ED,{title:"3D model ID"},k.threeDModelSources.modelId),a.default.createElement(y.ED,{title:"Revision ID"},k.threeDModelSources.modelId),(null==k||null===(e=k.targets)||void 0===e||null===(t=e.assetSubtreeIds)||void 0===t?void 0:t.length)&&a.default.createElement(y.ED,{title:"Root assets"},a.default.createElement(ee,null,null!==(n=null==k||null===(l=k.targets)||void 0===l||null===(r=l.assetSubtreeIds)||void 0===r?void 0:r.map((function(e){var t=e.id;return a.default.createElement(H,{assetId:t})})))&&void 0!==n?n:"No root assets selected")),(null==k||null===(i=k.targets)||void 0===i||null===(o=i.dataSetIds)||void 0===o?void 0:o.length)&&a.default.createElement(y.ED,{title:"Asset data sets"},a.default.createElement(ee,null,null!==(d=null==k||null===(s=k.targets)||void 0===s||null===(f=s.dataSetIds)||void 0===f?void 0:f.map((function(e){var t=e.id;return a.default.createElement($,{dataSetId:t})})))&&void 0!==d?d:"No data set selected")),(null==k||null===(m=k.matchFields)||void 0===m?void 0:m.length)&&a.default.createElement(y.ED,{title:"Match fields"},a.default.createElement(a.default.Fragment,null,null!=k&&null!==(v=k.matchFields)&&void 0!==v&&v.length?null==k||null===(h=k.matchFields)||void 0===h?void 0:h.map((function(e){return a.default.createElement(y.kC,{row:!0},a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(g.Z,null,(0,I.aS)(e.source,10))),a.default.createElement(y.kC,{column:!0,style:{width:"20%"}},a.default.createElement(c.JO,{type:"ArrowRight"})),a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(g.Z,null,(0,I.aS)(e.target,10))))})):a.default.createElement("div",null))),a.default.createElement(y.ED,{title:"Model type"},a.default.createElement(a.default.Fragment,null,null!=k&&null!==(p=k.excludeSourcesKeywords)&&void 0!==p&&p.length?"PDMS":"Unfiltered")))):null},ee=d.default.div.withConfig({displayName:"datastudio__TagWrapper",componentId:"datastudio__sc-7245xx-0"})(["&&&{display:flex;flex-wrap:wrap;}"]),te=n(28384),ne=function(e){var t=e.title,n=e.description,l=e.marginTop,r=void 0===l?0:l,i=e.marginBottom,u=void 0===i?0:i;return a.default.createElement(te.default,{style:{marginTop:r,marginBottom:u}},a.default.createElement(c.Dx,{level:4,style:{paddingBottom:"4px"}},t),a.default.createElement(c.uT,{level:2,style:{paddingTop:"4px"}},n))},ae=n(15861),le=n(87757),re=n.n(le),ie=n(4942),ue=n(81939),oe=n(15137),ce=n.n(oe),de=n(28695),se=n(11809),fe=n(36095),me=n.n(fe);function pe(e){var t,n=e.dataKitId,r=e.onOptionSelect,i=e.id,u=e.value,o=(0,a.useMemo)((function(){return(0,se.Vu)(n,!1)}),[n]),c=(0,l.v9)(o)||[],d=Array.from(new Set(c.reduce((function(e,t){return t&&t.metadata?e.concat(Object.keys(null==t?void 0:t.metadata)):e}),[]))).map((function(e){return"metadata.".concat(e)})),s=(t=c.reduce((function(e,t){return Object.keys(t).forEach((function(n){e[n]||me()(t[n])&&(e[n]=n)})),e}),{}),Object.keys(t)).filter((function(e){return c.find((function(t){return!!t[e]}))})),f=[].concat((0,C.Z)(s),(0,C.Z)(d));return a.default.createElement(de.Z,{style:{width:"100%"},key:"select-".concat(i),showSearch:!0,placeholder:"Type property name here...",allowClear:!0,value:u,onSelect:function(e){return r(e)}},f.map((function(e){return a.default.createElement(de.Z.Option,{key:e,value:e},e)})))}function ve(e){var t=e.resourceDataKitId,n=e.assetsDataKitId,r=e.connectionId,i=e.canDelete,u=void 0===i||i,o=(0,l.I0)(),d=(0,l.v9)((function(e){return e.contextualization.predictions[t].config.connections.find((function(e){return e.id===r}))})),s=function(e,n){var a=(0,p.Z)((0,p.Z)({},d),{},(0,ie.Z)({},e,n));o((0,ue.Zl)(t,a))};return a.default.createElement(y.kC,{row:!0,align:!0,style:{width:"100%",margin:"4px 0"}},a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(pe,{id:"".concat(r,"-source"),dataKitId:t,value:null==d?void 0:d.source,onOptionSelect:function(e){return s("source",e)}})),a.default.createElement(y.kC,{column:!0,justify:!0,style:{width:"10%"}},a.default.createElement(c.JO,{type:"ArrowRight"})),a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(pe,{id:"".concat(r,"-target"),dataKitId:n,value:null==d?void 0:d.target,onOptionSelect:function(e){return s("target",e)}})),u&&a.default.createElement(y.kC,{column:!0,style:{width:"10%"}},a.default.createElement(c.zx,{size:"small",variant:"ghost",icon:"CloseLarge",onClick:function(){return o((0,ue.Rd)(t,r))}})))}var ge=(0,d.default)(c.uT).withConfig({displayName:"datastudio__ConnectionTitle",componentId:"datastudio__fr4zge-0"})(["&&&{color:",";}"],c.wL["greyscale-grey7"].hex());function he(e){var t=e.typeFrom,n=e.typeTo;return a.default.createElement(y.kC,{row:!0,align:!0,style:{width:"100%",margin:"16px 0"}},a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(ge,{level:2},ce()(t))),a.default.createElement(y.kC,{column:!0,style:{width:"10%"}}),a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(ge,{level:2},ce()(n))),a.default.createElement(y.kC,{column:!0,style:{width:"10%"}}))}var Ee=n(87253),ye=function(e){var t=e.value,n=e.onChange,l=e.options,r=e.id;return a.default.createElement(de.Z,{style:{width:"100%"},key:"select-".concat(r),showSearch:!0,placeholder:"Type property name here...",allowClear:!0,value:t,onSelect:n},l.map((function(e){return a.default.createElement(de.Z.Option,{key:e,value:e},e)})))},xe=function(){var e,t,n,l,i,d,s,f=(0,r.UO)().kitId,m=(0,a.useContext)(u.d),v=m.matchingKits,g=m.generatePossibleFields,h=m.updateMatchingKit,E=v[f],x=(E||{matchFields:[]}).matchFields,I=(e=(0,ae.Z)(re().mark((function e(){var t;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(f);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),t=[f,g],n={sources:[],targets:[]},l=(0,a.useState)(n),d=(i=(0,o.Z)(l,2))[0],s=i[1],(0,a.useEffect)((function(){var t=!1,n=e();if(null!=n)return n.then((function(e){t||s(e)})),function(){t=!0}}),t),d),w=function(e,t,n){var a=(x||[]).map((function(a){return a.id===n?{source:e,target:t,id:n}:a}));h((0,p.Z)((0,p.Z)({},E),{},{matchFields:a}))},b=function(e){var t=e.source,n=e.target,l=e.id;return a.default.createElement(y.kC,{row:!0,align:!0,style:{width:"100%",margin:"4px 0"}},a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(ye,{id:"".concat(l,"-node"),value:t,onChange:function(e){return w(e,n,l)},options:I.sources})),a.default.createElement(y.kC,{column:!0,justify:!0,style:{width:"10%"}},a.default.createElement(c.JO,{type:"ArrowRight"})),a.default.createElement(y.kC,{column:!0,style:{width:"40%"}},a.default.createElement(ye,{id:"".concat(l,"-asset"),value:n,onChange:function(e){return w(t,e,l)},options:I.targets})),a.default.createElement(y.kC,{column:!0,style:{width:"10%"}},a.default.createElement(c.zx,{size:"small",variant:"ghost",icon:"CloseLarge",onClick:function(){return function(e){var t=(x||[]).filter((function(t){return t.id!==e}));h((0,p.Z)((0,p.Z)({},E),{},{matchFields:t}))}(l)}})))};return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.Dx,{level:3,style:{padding:0}},"Configure model"),a.default.createElement(ne,{marginTop:24,title:"Select the fields for matching 3D nodes to assets",description:a.default.createElement(a.default.Fragment,null,"By default, the model uses the similarity between name and description when it searches for matches.",a.default.createElement("br",null),"Create new connections between name, description, and available metadata fields with ",a.default.createElement("strong",null,"Add fields"),".")}),a.default.createElement(y.kC,{column:!0},a.default.createElement(he,{typeFrom:"3D Node",typeTo:"Asset"}),null==x?void 0:x.map((function(e){return a.default.createElement(b,{source:e.source,target:e.target,id:e.id})})),a.default.createElement(c.zx,{type:"secondary",icon:"Plus",onClick:function(){return e=[].concat((0,C.Z)(x||[]),[{id:(0,Ee.Z)(),source:"",target:""}]),void h((0,p.Z)((0,p.Z)({},E),{},{matchFields:e}));var e},style:{alignSelf:"flex-start"}},"Add fields")))},Ie=function(){var e=(0,r.k6)(),t=(0,r.$B)("/:project/:path*"),n=(0,r.UO)().kitId,l=(0,a.useContext)(u.d),i=l.matchingKits,o=l.updateMatchingKit,d=i[n],s=(0,a.useMemo)((function(){var e;return null!=d&&null!==(e=d.excludeSourcesKeywords)&&void 0!==e&&e.length?"pdms":"none"}),[d]),f=function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(ne,{title:"3D model type",description:"The model type affects the nodes that are selected for the matching process.",marginTop:40,marginBottom:24}),a.default.createElement(y.kC,{row:!0},a.default.createElement(y.kC,{column:!0},a.default.createElement(y.Ee,{value:s,onChange:function(e){return t=e.target.value,void o("pdms"===t?(0,p.Z)((0,p.Z)({},d),{},{excludeSourcesKeywords:Q}):(0,p.Z)((0,p.Z)({},d),{},{excludeSourcesKeywords:[]}));var t}},a.default.createElement(y.EU,{value:"none"},a.default.createElement(c.Dx,{level:5,style:{marginBottom:"8px"}},"Unfiltered"),a.default.createElement(c.uT,{level:2},"All nodes in this model will be used to match assets.")),a.default.createElement(y.EU,{value:"pdms"},a.default.createElement(c.Dx,{level:5,style:{marginBottom:"8px"}},"PDMS"),a.default.createElement(c.uT,{level:2},"In a PDMS model (this model type is often used in the Industry), nodes that contain the following keywords are excluded in the matching process:",Q.map((function(e){return a.default.createElement(g.Z,{style:{margin:"6px"},key:e},e)}))))))))};return d?a.default.createElement(we,null,a.default.createElement(xe,null),a.default.createElement(f,null),a.default.createElement(m,null,a.default.createElement(c.zx,{type:"secondary",onClick:function(){return e.goBack()}},"Back"),a.default.createElement(c.zx,{type:"primary",onClick:function(){var n,a,l;(0,Y.t5)(Y.cY.modelType,{modelId:null==d||null===(n=d.threeDModelSources)||void 0===n?void 0:n.modelId,modelType:null!=d&&null!==(a=d.excludeSourcesKeywords)&&void 0!==a&&a.length?"PDMS":"unknown"}),(0,Y.t5)(Y.cY.matchFields,{modelId:null==d||null===(l=d.threeDModelSources)||void 0===l?void 0:l.modelId,matchingFields:null==d?void 0:d.matchFields}),e.push((0,I.EW)("/".concat(null==t?void 0:t.params.path,"/predict")))},style:{marginLeft:"20px"}},"Next"))):a.default.createElement(r.l_,{to:(0,I.EW)("/".concat(B.m,"/3d_matching"))})},we=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__jbtwgl-0"})(["&&&{background-color:white;padding:0;margin-bottom:90px;max-width:672px;}"]),be=n(15671),ke=n(43144),Se=n(60136),Ze=n(29388),Ce=function(e){(0,Se.Z)(n,e);var t=(0,Ze.Z)(n);function n(){var e;(0,be.Z)(this,n);for(var a=arguments.length,l=new Array(a),r=0;r<a;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={hasError:!1,error:void 0},e}return(0,ke.Z)(n,[{key:"render",value:function(){var e,t,n,l,r="fusion.cognite.com"===(null===(e=window)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.hostname);return this.state.hasError?a.default.createElement(a.default.Fragment,null,a.default.createElement("h1",null,"Something went wrong."),a.default.createElement("pre",null,null===(n=this.state.error)||void 0===n?void 0:n.message),!r&&a.default.createElement("pre",null,null===(l=this.state.error)||void 0===l?void 0:l.stack)):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(a.default.Component),De=n(51230);function Te(e){return(0,l.v9)((function(e){return e.app.loaded}))?e.children:a.default.createElement(De.Z,null)}var _e=d.default.div.withConfig({displayName:"datastudio__LocationCardWrapper",componentId:"datastudio__p8p08z-0"})(["&&&{width:300px;max-width:300px;background-color:",";box-sizing:border-box;padding:16px;border-radius:2px;margin:12px 0px;height:300px;}&&& .cogs-menu{border:none;box-shadow:none;padding:0;}&&& .cogs-menu .cogs-menu-item{padding-left:8px;padding-right:8px;font-weight:400;border-radius:2px;}&&& .cogs-menu .cogs-menu-item:hover{background:rgba(0,0,0,0.08);}"],c.wL.white.hex()),Ne=d.default.div.withConfig({displayName:"datastudio__TopImg",componentId:"datastudio__p8p08z-1"})(["&&&{width:100%;height:140px;overflow:hidden;position:relative;margin-bottom:16px;}&&& img{position:absolute;top:50%;left:50%;max-width:100%;transform:translate(-50%,-50%);}&&& svg{position:absolute;top:50%;left:50%;max-width:100%;transform:translate(-50%,-50%);}"]),Me=d.default.div.withConfig({displayName:"datastudio__LocationName",componentId:"datastudio__p8p08z-2"})(["&&&{font-weight:600;text-align:center;margin:0 8px 16px 8px;}"]),Fe=((0,d.default)(U.Z).withConfig({displayName:"datastudio__TabsStyled",componentId:"datastudio__p8p08z-3"})(["&&&{width:100%;}&&& .ant-tabs-tab{padding:16px 0;}&&& .ant-tabs-ink-bar{background-color:",";height:4px;}"],c.wL["midblue-3"].hex()),d.default.div.withConfig({displayName:"datastudio__PageWrapper",componentId:"datastudio__p8p08z-4"})(["&&&{background-color:white;padding-top:20px;padding-left:20px;margin-bottom:90px;}"]),n(2650)),Ae=function(e){var t=e.revision,n=function(e){var t=(0,a.useState)(),n=(0,o.Z)(t,2),l=n[0],r=n[1];return(0,a.useEffect)((function(){function t(){return n.apply(this,arguments)}function n(){return(n=(0,ae.Z)(re().mark((function t(){var n,a,l;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fe.default.files3D.retrieve(e);case 2:return n=t.sent,a=new Uint8Array(n),l=new Blob([a]),t.abrupt("return",window.URL.createObjectURL(l));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var a=function(){var n=(0,ae.Z)(re().mark((function n(){var a;return re().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e||l){n.next=5;break}return n.next=3,t();case 3:a=n.sent,r(a||"");case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();a()}),[e]),l}(Number(null==t?void 0:t.thumbnailThreedFileId));return n?a.default.createElement(Ne,null,a.default.createElement("img",{src:n,alt:""})):a.default.createElement(Ne,null,a.default.createElement(c.zs,{type:"ThreeDModel"})," ")},Oe=n(30759),Ke=function(e){var t=e.modelName,n=e.revisions,l=e.onItemClick,r=e.modelId;return a.default.createElement(_e,{className:"z-2 location"},a.default.createElement(Ae,{revision:n.find((function(e){return e.thumbnailThreedFileId}))}),a.default.createElement(Me,null,t),a.default.createElement(c.v2,null,n.map((function(e,t){return a.default.createElement(c.v2.Item,{key:e.id,appendIcon:"ChevronRightSmall",onClick:function(){return l(e.id)}},a.default.createElement(_.Z,{placement:"left",content:a.default.createElement(Oe.v$,null,a.default.createElement(Oe.ED,{title:"Revision ID"},e.id),a.default.createElement(Oe.ED,{title:"Published on",half:!0},b()(e.createdTime).format("YYYY-MM-DD hh:mm")),a.default.createElement(Oe.ED,{title:"Status",half:!0},e.status),a.default.createElement(Oe.ED,null,a.default.createElement(c.A,{href:(0,I.EW)("/3d-models/".concat(r,"/revisions/").concat(e.id)),onClick:function(e){return e.stopPropagation()},target:"_blank",rel:"noopener noreferrer"}," ",a.default.createElement(c.JO,{type:"EyeShow",className:"em-icon"})," View 3D revision")))},a.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",width:"100%"}},a.default.createElement("div",null,"Revision # ",n.length-t),a.default.createElement("div",null,a.default.createElement(c.Vp,{color:c.wL["lightblue-2"].hex()},e.assetMappingCount," assets")))))}))))},ze=n(62443),Pe=function(){var e=(0,r.k6)(),t=(0,r.$B)("/:project/:path*"),n=(0,a.useState)([]),l=(0,o.Z)(n,2),i=l[0],d=l[1],s=(0,a.useState)(""),f=(0,o.Z)(s,2),p=f[0],v=f[1],g=(0,a.useContext)(u.d),h=g.threeDModels,E=g.isLoadingModels,y=g.createMatchingKit,x=function(){var n=(0,ae.Z)(re().mark((function n(a,l){var r;return re().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((0,Y.t5)(Y.cY.selectModel,{modelId:a,revisionId:l}),!a||!l){n.next=8;break}return n.next=4,y(a,Number(l));case 4:r=n.sent,e.push((0,I.EW)("/".concat(null==t?void 0:t.params.path,"/").concat(r))),n.next=9;break;case 8:ze.Z.error({message:"Model and revisions must be selected"});case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return(0,a.useEffect)((function(){d(""!==p?h.filter((function(e){return(0,I.No)(e.name,p)})):h)}),[h,p]),a.default.createElement(J.Z,{spinning:E,tip:"Loading 3D models!"},a.default.createElement(Re,null,a.default.createElement(c.Dx,{level:4},"Select 3D model revision"),a.default.createElement(c.kC,null,a.default.createElement(c.II,{placeholder:"Search for 3D models by name",onChange:function(e){return v(e.currentTarget.value)},value:p,style:{width:"300px",marginTop:"20px"}})),a.default.createElement(c.kC,{justifyContent:"space-between",style:{flexWrap:"wrap"}},i.map((function(e){return a.default.createElement(c.kC,{key:e.id},a.default.createElement(Ke,{modelId:e.id,modelName:e.name,revisions:e.revisions,onItemClick:function(t){return x(e.id,t)}}))})))),a.default.createElement(m,null,a.default.createElement(c.zx,{type:"secondary",onClick:function(){return e.goBack()}},"Back")))},Re=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-19q5l8h-0"})(["&&&{background-color:white;padding-top:20px;padding-left:20px;margin-bottom:90px;display:flex;justify-content:space-between;flex-direction:column;max-width:100%;flex-wrap:wrap;}"]),Le=n(82043),Ye=n(8190),Be=n(20885),Ue=d.default.div.withConfig({displayName:"datastudio__StyledConfidence",componentId:"datastudio__sc-1l59hml-0"})(["&&&{color:",";background-color:",";border-radius:4px;padding:8px 29px;width:100px;font-weight:500;}"],c.wL["greyscale-grey9"].hex(),c.wL["greyscale-grey2"].hex());function We(e){var t=e.score,n=t?"".concat(Math.round(100*t),"%"):"0%";return a.default.createElement(Ue,null,n)}var je=n(45571),qe=n(5086),Je=n(93946),Xe=d.default.div.withConfig({displayName:"datastudio__ThreeDViewerStyled",componentId:"datastudio__sc-1r54i9d-0"})(["&&&{position:relative;display:flex;height:800px;}"]),He=d.default.div.withConfig({displayName:"datastudio__CanvasContainer",componentId:"datastudio__sc-1r54i9d-1"})(["&&&{flex-grow:1;}&&& canvas{height:100vh;width:100%;}"]);function Qe(e){var t,n=(0,a.useRef)(null),l=(0,r.UO)().kitId,i=(0,a.useContext)(u.d),d=i.selectedNodeId,s=i.setSelectedNodeId,f=i.recalibrating,m=i.results,p=(0,a.useState)(),v=(0,o.Z)(p,2),g=v[0],h=v[1],E=(0,a.useState)(),y=(0,o.Z)(E,2),x=y[0],I=y[1],w=(0,a.useState)(),b=(0,o.Z)(w,2),k=b[0],S=b[1],Z=(0,a.useState)(),C=(0,o.Z)(Z,2),D=C[0],T=C[1],_=(0,a.useRef)(),N=(0,a.useState)([]),M=(0,o.Z)(N,2),F=M[0],A=M[1],O=e.revisionId,K=e.modelId,z=function(e,t,n){return(0,je.useQuery)(["3d","node",n],(0,ae.Z)(re().mark((function a(){var l;return re().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!n){a.next=5;break}return a.next=3,Fe.default.revisions3D.retrieve3DNodes(e,t,[{id:n}]);case 3:return l=a.sent,a.abrupt("return",l[0]);case 5:return a.abrupt("return",void 0);case 6:case"end":return a.stop()}}),a)}))),{enabled:!!n})}(K,O,null!=d?d:void 0),P=z.data,R=z.isLoading,L=(null!==(t=m[l])&&void 0!==t?t:[]).selectedResults;!function(e){var t=e.model,n=e.selectedNodes,l=e.selectedNodeId,r=e.matchedAppearance,i=void 0===r?Le.DefaultNodeAppearance.Outlined:r,u=e.selectedAppearance,o=void 0===u?Le.DefaultNodeAppearance.Highlighted:u,c=(0,a.useRef)(new Le.TreeIndexNodeCollection),d=(0,a.useRef)(new Le.TreeIndexNodeCollection),s=(0,a.useCallback)((function(e){return void 0!==(null==t?void 0:t.styledNodeCollections.find((function(t){return t.nodeCollection===e})))}),[t]);(0,a.useEffect)((function(){var e=c.current,n=d.current;return t&&(s(e)||t.assignStyledNodeCollection(e,{}),s(n)||t.assignStyledNodeCollection(n,{})),function(){t&&e&&s(e)&&(t.unassignStyledNodeCollection(e),e.clear()),t&&n&&s(n)&&(t.unassignStyledNodeCollection(n),n.clear())}}),[s,t]),(0,a.useEffect)((function(){t&&(t.setDefaultNodeAppearance({color:[222,222,220]}),s(c.current)?t.updateStyledNodeCollection(c.current,i):t.assignStyledNodeCollection(c.current,i),s(d.current)?t.updateStyledNodeCollection(d.current,o):t.assignStyledNodeCollection(d.current,o))}),[t]);var f=a.default.useCallback((function(e){c.current&&c.current.updateSet(e)}),[]),m=a.default.useCallback((function(e){d.current&&d.current.updateSet(e)}),[]);(0,a.useEffect)((function(){var e=new Le.IndexSet(n.map((function(e){return e.treeIndex})));f(e)}),[n,f]),(0,a.useEffect)((function(){var e=function(){var e=(0,ae.Z)(re().mark((function e(){var n,a;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=6;break}return e.next=3,t.mapNodeIdToTreeIndex(l);case 3:n=e.sent,a=new Le.IndexSet([n]),m(a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[l,m])}({model:x||void 0,selectedNodes:F,selectedNodeId:d,matchedAppearance:{outlineColor:Le.NodeOutlineColor.Green,color:[94,235,52]},selectedAppearance:Le.DefaultNodeAppearance.Highlighted}),(0,a.useEffect)((function(){n.current&&n.current.scrollIntoView({behavior:"smooth",block:"start"})}),[]),(0,a.useEffect)((function(){var e;return(0,ae.Z)(re().mark((function t(){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.current){t.next=2;break}return t.abrupt("return");case 2:e=new Le.Cognite3DViewer({sdk:Fe.default,domElement:n.current}),S(e),_.current=new Ye.HtmlOverlayTool(e);case 5:case"end":return t.stop()}}),t)})))(),function(){var t;return null===(t=e)||void 0===t?void 0:t.dispose()}}),[O]),(0,a.useEffect)((function(){var e=function(){var e=(0,ae.Z)(re().mark((function e(){var t;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(x instanceof Le.Cognite3DModel)){e.next=6;break}if(null==L||!L.length){e.next=6;break}return e.next=4,x.mapNodeIdsToTreeIndices(null==L?void 0:L.map((function(e){var t;return null==e||null===(t=e.source)||void 0===t?void 0:t.id})).filter(Boolean));case 4:t=e.sent,A(L.map((function(e,n){var a;return{nodeId:null==e||null===(a=e.source)||void 0===a?void 0:a.id,treeIndex:t[n]}})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[L,x]),(0,a.useEffect)((function(){k&&k.on("click",function(){var e=(0,ae.Z)(re().mark((function e(t){var n,a;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getIntersectionFromPixel(t.offsetX,t.offsetY);case 2:if(!(n=e.sent)){e.next=10;break}if(!("treeIndex"in n)){e.next=10;break}return e.next=7,n.model.mapTreeIndexToNodeId(n.treeIndex);case 7:a=e.sent,s(a),T(n.point);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[k]),(0,a.useEffect)((function(){var e=function(){var e=(0,ae.Z)(re().mark((function e(){var t;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!k){e.next=18;break}return e.next=6,k.determineModelType(K,O);case 6:if("cad"!==e.sent){e.next=13;break}return e.next=10,k.addModel({modelId:K,revisionId:O});case 10:t=e.sent,e.next=16;break;case 13:return e.next=15,k.addPointCloudModel({modelId:K,revisionId:O});case 15:t=e.sent;case 16:"loadCameraFromModel"in k&&k.loadCameraFromModel(t),null!=n&&n.current&&t&&I(t);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),n.current&&h(e.t0);case 23:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(){return e.apply(this,arguments)}}();e()}),[k,K,O]);var Y=function(e){var t=document.createElement("div");t.style.cssText="\n    position: absolute;\n    /* Anchor to the center of the element and ignore events */\n    transform: translate(-50%, -50%);\n    pointer-events: none;\n    touch-action: none;   \n    /* Make it look nice */\n    padding: 10px;\n    minHeight: 50px;\n    color: #fff;\n    background: #232323da;\n    borderRadius: 0.25em;\n    border: #ffffff22 solid 2px;\n  ",t.innerHTML="".concat((0,qe.renderToStaticMarkup)(a.default.createElement(B,null))),_.current&&(_.current.clear(),_.current.add(t,e))};if((0,a.useEffect)((function(){var e=function(){var e=(0,ae.Z)(re().mark((function e(){var t;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d||R||!x){e.next=10;break}if(!D){e.next=6;break}Y(D),T(void 0),e.next=10;break;case 6:return e.next=8,x.getBoundingBoxByNodeId(d);case 8:t=e.sent,Y(t.getCenter(new Je.Vector3));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[d,D,R]),g)return a.default.createElement("div",null,"Modal could not viewed.");var B=function(){var e,t=null==L?void 0:L.find((function(e){return e.source.id===Number(d)}));return d?t?a.default.createElement("div",null,a.default.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},a.default.createElement(c.uT,{level:4,style:{color:"white"},strong:!0},null==P?void 0:P.name),a.default.createElement(c.JO,{type:"ArrowRight"}),a.default.createElement(c.uT,{style:{color:"white"},level:4},null==t||null===(e=t.matches[0].target)||void 0===e?void 0:e.name)),a.default.createElement(We,{score:null==t?void 0:t.matches[0].score})):R?a.default.createElement(c.aN,null):a.default.createElement(c.uT,{level:4},"Node ",a.default.createElement("b",null,null==P?void 0:P.name)," did not get any matches."):a.default.createElement(c.uT,{level:4},"Please click on a node to view its details")};return a.default.createElement(Be.Z,{title:a.default.createElement("div",{style:{height:"36px"}},"3D model"),bordered:!1},a.default.createElement(Xe,null,f?a.default.createElement(c.aN,null):a.default.createElement(He,{ref:n})))}var $e=n(90619),Ge=function(){var e,t=(0,r.UO)().kitId,n=(0,a.useContext)(u.d),l=n.selectedNodeId,i=n.setSelectedNodeId,d=n.results,s=(0,a.useState)([]),f=(0,o.Z)(s,2),m=f[0],p=f[1],v=(null!==(e=d[t])&&void 0!==e?e:{selectedResults:[]}).selectedResults;return(0,a.useEffect)((function(){var e,t=null!==(e=null==v?void 0:v.map((function(e){var t,n,a,r,i=e.source.id===l;return{nodeId:e.source.id,nodeName:e.source.name,assetId:(null===(t=e.matches[0])||void 0===t||null===(n=t.target)||void 0===n?void 0:n.id)||0,asset:(null===(a=e.matches[0])||void 0===a||null===(r=a.target)||void 0===r?void 0:r.name)||"",isSelected:i,score:"".concat(Math.floor(100*e.score),"%")}})))&&void 0!==e?e:[];p(t)}),[v,l]),a.default.createElement("div",{style:{marginTop:"40px"}},a.default.createElement(c.Dx,{level:4,style:{marginBottom:"12px"}},"Matching results"),a.default.createElement(c.iA,{dataSource:m.length?m:[{}],columns:[{Header:function(){return null},id:"isSelected",Cell:function(e){var t,n;return a.default.createElement(c.zx,{onClick:function(){var t,n;return i(Number(null==e||null===(t=e.row)||void 0===t||null===(n=t.original)||void 0===n?void 0:n.nodeId))},type:"ghost",icon:null!=e&&null!==(t=e.row)&&void 0!==t&&null!==(n=t.original)&&void 0!==n&&n.isSelected?"EyeShow":"EyeHide"})}},{Header:"Name",accessor:"nodeName",Filter:c.iA.InputFilter(),filter:"fuzzyText",filterIcon:"Search"},{Header:"Asset",accessor:"asset",Cell:function(e){var t,n,l,r;return a.default.createElement(c.A,{href:(0,I.EW)("/explore/asset/".concat(null==e||null===(t=e.row)||void 0===t||null===(n=t.original)||void 0===n?void 0:n.assetId)),target:"_blank",rel:"noopener noreferrer"},null==e||null===(l=e.row)||void 0===l||null===(r=l.original)||void 0===r?void 0:r.asset)},Filter:c.iA.InputFilter(),filter:"fuzzyText",filterIcon:"Search"},{Header:"Confidence score",accessor:"score",Filter:c.iA.InputFilter(),filter:"fuzzyText",filterIcon:"Search"}],pagination:!0,pageSize:5,onRow:function(e){return{onClick:function(){return i(Number(e.nodeId))}}},filterable:!0}))},Ve=function(e){var t=e.onNext,n=e.minConfidence,l=e.setMinConfidence,i=(0,r.UO)().kitId,o=(0,a.useContext)(u.d),d=o.matchingKits,f=o.results,m=d[i],p=f[i]||{selectedResults:[],results:[]},v=p.selectedResults,g=p.results,h=(null==g?void 0:g.filter((function(e){return e.matches.length})).length)||0,E=(null==v?void 0:v.length)||0;return(0,a.useEffect)((function(){h&&(0,Y.t5)(Y.cY.results.matches,{modelId:m.threeDModelSources.modelId,numOfMatches:h})}),[h,m]),a.default.createElement(Be.Z,{title:"Asset mapping results",extra:a.default.createElement(c.zx,{onClick:t,type:"primary",disabled:!E},"Save (",E,") matches to CDF"),bordered:!1},a.default.createElement(tt,null,a.default.createElement("div",null,a.default.createElement(nt,null,a.default.createElement(et,null,"Total # of matches ")," ",h),a.default.createElement(nt,null,a.default.createElement(et,null,"Selected # of matches ")," ",E)),a.default.createElement("div",null,a.default.createElement(c.u,{content:"Percentage of matches selected."},a.default.createElement($e.Z,{type:"circle",percent:Number((100*E/h).toFixed(2))||0,format:function(e){return"".concat(e,"%")}})))),a.default.createElement(ne,{title:"Confidence threshold",description:"Results with confidence levels above this threshold will be selected.",marginTop:10,marginBottom:24}),a.default.createElement(s.Z,{gutter:[0,24]},a.default.createElement(D.Z,null,a.default.createElement(c.iR,{min:10,max:100,step:10,value:n,onChange:l,includeMarks:!0})," ")),a.default.createElement(s.Z,null,a.default.createElement(Ge,null)))},et=d.default.span.withConfig({displayName:"datastudio__BolderText",componentId:"datastudio__sc-101fg1s-0"})(["&&&{font-weight:bold;margin-bottom:20px;}"]),tt=d.default.div.withConfig({displayName:"datastudio__InfoWrapper",componentId:"datastudio__sc-101fg1s-1"})(["&&&{display:flex;justify-content:space-between;font-align:center;}"]),nt=d.default.div.withConfig({displayName:"datastudio__TextBlock",componentId:"datastudio__sc-101fg1s-2"})(["&&&{margin-top:20px;}"]),at=n(83924),lt=n(31845),rt=n(46661),it=n(439),ut=n(14418),ot=at.Z.Text,ct={"":0,New:10,Scheduled:10,Queued:20,Running:40,Completed:100,Failed:100},dt=function(e){switch(e){case"New":case"Scheduled":case"Queued":case"Running":default:return"active";case"Completed":return"success";case"Failed":return"exception"}},st=function(){var e,t,n,l=(0,r.k6)(),i=(0,r.$B)("/:project/:path*"),o=(0,r.UO)().kitId,d=(0,a.useContext)(u.d),s=d.matchingKits,f=d.matchModel,m=d.getJobStatus,p=d.results,v=s[o],g=v.jobId,h=p[o]||{status:"New",error:!1,jobId:0,modelDone:!1},E=h.status,y=h.error,x=h.modelDone;return(0,a.useEffect)((function(){g||f(o)}),[f,v,o]),e=(0,ae.Z)(re().mark((function e(){var t;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=3;break}return e.next=3,m(o,null!==(t=Number(g))&&void 0!==t?t:0);case 3:case"end":return e.stop()}}),e)}))),t=x?null:5e3,n=(0,a.useRef)(),(0,a.useEffect)((function(){n.current=e}),[e]),(0,a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t]),v?a.default.createElement(lt.Z,{title:"Matching your model - this may take up to 10 minutes...",visible:!0,okText:"View results",okButtonProps:{disabled:!x},onOk:function(){g&&l.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/").concat(g)))},cancelText:"Go back",onCancel:function(){return l.push((0,I.EW)("/".concat(B.m,"/3d_matching")))},closable:!1},y?a.default.createElement(rt.Z,{type:"error",message:"Something went wrong, please try again. ".concat(String(y))}):a.default.createElement("div",null,a.default.createElement(ot,{strong:!0},"Running model: "),a.default.createElement(it.Z,{percent:ct[null!=E?E:""],status:dt(null!=E?E:"New")}),a.default.createElement(c.uT,{level:2,style:{marginTop:"40px",fontStyle:"italic",textAlign:"center"}},a.default.createElement("b",null,"Protip:")," You can bookmark this page to come back to it later.",a.default.createElement(ut.ZP,{href:window.location.href,title:"3D matching job"})))):a.default.createElement(r.l_,{to:(0,I.EW)("/".concat(B.m,"/3d_matching"))})},ft=function(){var e,t=(0,a.useState)(90),n=(0,o.Z)(t,2),l=n[0],i=n[1],c=function(e,t){var n=(0,a.useState)(e),l=(0,o.Z)(n,2),r=l[0],i=l[1];return(0,a.useEffect)((function(){var t=setTimeout((function(){i(e)}),1e3);return function(){return clearTimeout(t)}}),[1e3,e]),r}(l),d=(0,r.UO)().kitId,s=(0,a.useContext)(u.d),f=s.matchingKits,m=s.saveToCdf,p=s.updateSelectedResults,v=s.results,g=f[d],h=(v[d]?v[d]:{selectedResults:[]}).selectedResults,E=(null==g?void 0:g.threeDModelSources)||{modelId:0,revisionId:0},y=E.modelId,x=E.revisionId;return(0,a.useEffect)((function(){c&&p(d,c)}),[c]),v[d]&&null!==(e=v[d])&&void 0!==e&&e.modelDone?g?a.default.createElement("div",{style:{paddingTop:"20px"}},a.default.createElement(D.Z,{span:24},a.default.createElement(D.Z,{span:14},y&&x&&a.default.createElement(Qe,{modelId:y,revisionId:x})),a.default.createElement(D.Z,{span:10},a.default.createElement(Ve,{onNext:function(){(0,Y.t5)(Y.cY.results.saveToCdf,{modelId:y,numOfSelectedMatches:null==h?void 0:h.length,confidenceThreshold:l}),m(d)},setMinConfidence:i,minConfidence:l})))):a.default.createElement(r.l_,{to:(0,I.EW)("/".concat(B.m,"/3d_matching"))}):a.default.createElement(st,null)},mt=function(){var e=(0,r.$B)(),t=(0,a.useContext)(u.d),n=t.threeDModels,l=t.didFetchModels,o=t.fetch3dModels;return(0,a.useEffect)((function(){n.length||l||o()}),[n,l,o]),a.default.createElement(Te,null,a.default.createElement(Ce,null,a.default.createElement(V,null),a.default.createElement(r.rs,null,a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"3D Models"}),a.default.createElement(Pe,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/:kitId"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"3D Matching assets"}),a.default.createElement(q,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/:kitId/configure"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"3D matching config"}),a.default.createElement(Ie,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/:kitId/configure/predict"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"3D Matching Prediction"}),a.default.createElement(st,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/:kitId/configure/predict/:jobId"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"3D Matching Results"}),a.default.createElement(ft,null))}}))))},pt=function(e){var t=e.permissions,n=e.feature;return a.default.createElement("div",null,a.default.createElement(vt,null,a.default.createElement(gt,null,a.default.createElement(c.PJ.WarningFilled,null),a.default.createElement("div",null,"You have insufficient access rights to access ",n)),a.default.createElement(ht,null,"Check the access rights needed below and ask the person responsible for access management in your organization to grant them to you."),a.default.createElement(Et,{className:"z-4"},a.default.createElement(yt,null,t.map((function(e){return a.default.createElement("p",{key:"permission-".concat(e.type)},a.default.createElement("strong",null,e.acl," ")," : ",e.type)}))))))},vt=d.default.div.withConfig({displayName:"datastudio__NoAccessContent",componentId:"datastudio__sc-1wqtyr9-0"})(["&&&{margin:80px 50px;}"]),gt=d.default.div.withConfig({displayName:"datastudio__Warning",componentId:"datastudio__sc-1wqtyr9-1"})(["&&&{font-size:16px;color:var(--cogs-yellow-1);font-weight:bold;margin-bottom:14px;display:flex;align-items:center;}&&& svg{margin-right:1em;}"]),ht=d.default.div.withConfig({displayName:"datastudio__Instructions",componentId:"datastudio__sc-1wqtyr9-2"})(["&&&{margin-bottom:28px;}"]),Et=d.default.div.withConfig({displayName:"datastudio__AccessInfoWrapper",componentId:"datastudio__sc-1wqtyr9-3"})(["&&&{background-color:white;padding:14px;margin:14px;border-radius:4px;}"]),yt=d.default.div.withConfig({displayName:"datastudio__AccessInfo",componentId:"datastudio__sc-1wqtyr9-4"})(["&&&{color:var(--cogs-text-color);padding:7px 14px;width:100%;}&&& p:last-child{margin-bottom:0;}&&& strong{font-weight:bold;}"]),xt=n(50522),It=n(76237),wt=n(45987),bt=n(50698),kt=["children","tooltip"],St=function(e){var t=e.children,n=e.tooltip,l=(0,wt.Z)(e,kt);return a.default.createElement(c.u,{content:n,disabled:!n},a.default.createElement(Zt,l,t))},Zt=(0,d.default)(bt.ZP.Button).withConfig({displayName:"datastudio__StyledRadioButton",componentId:"datastudio__sc-1azyv3m-0"})(["&&&{display:flex;flex-direction:column;box-sizing:border-box;max-width:328px;height:100%;margin-bottom:10px;border-radius:5px;padding:15px 19px 15px;margin-right:8px;border:",";background-color:",";}&&&:hover{background-color:",";border-color:",";color:",";}"],(function(e){return e.disabled&&"none"}),(function(e){return e.disabled&&c.wL["greyscale-grey2"].hex()}),(function(e){return!e.disabled&&c.wL["midblue-8"].hex()}),(function(e){return!e.disabled&&c.wL["midblue-4"].hex()}),(function(e){return!e.disabled&&c.wL.black.hex()})),Ct=(0,d.default)(bt.ZP.Group).withConfig({displayName:"datastudio__RadioGroup",componentId:"datastudio__sc-1os80z7-0"})(["&&&{display:flex;flex-direction:row;flex-wrap:wrap;flex:1 1 auto;}&&& .ant-radio-button-wrapper:before{display:none;}&&& .ant-radio-button-wrapper-checked{border-color:",";background-color:",";}"],c.wL["midblue-3"].hex(),c.wL["midblue-8"].hex()),Dt={edit:{title:"Edit pipeline",save:"Save",cancel:"Cancel",skip:"Skip"},save:{title:"Save pipeline",save:"Save",cancel:"Cancel",skip:"Skip"},create:{title:"Create a new pipeline",save:"Start",cancel:"Cancel",skip:"Skip"}},Tt={create:Y.YY.pipeline.created,edit:Y.YY.pipeline.edit,save:Y.YY.pipeline.saveToPipeline,cancelCreate:Y.YY.pipeline.cancelCreate};function _t(e){var t=e.type,n=e.visible,l=e.pipeline,r=e.disabled,i=e.onOk,u=e.onCancel,d=e.onSkip,f="create"===t?"pipeline-".concat(Date.now()):"",m=(0,a.useState)(f),p=(0,o.Z)(m,2),v=p[0],g=p[1],h=(0,a.useState)(""),E=(0,o.Z)(h,2),y=E[0],x=E[1];(0,a.useEffect)((function(){var e,n;"create"!==t&&(g(null!==(e=null==l?void 0:l.name)&&void 0!==e?e:""),x(null!==(n=null==l?void 0:l.description)&&void 0!==n?n:""))}),[t,l]);var I=function(){var e;(0,Y.t5)(Tt[t],{pipelineId:null!==(e=null==l?void 0:l.id)&&void 0!==e?e:"id_not_known"}),i(v,y)},w=function(){(0,Y.t5)(Tt.cancelCreate),u()},b=d?a.default.createElement(Mt,null,a.default.createElement(c.zx,{key:"cancel",onClick:w,type:"secondary",variant:"ghost"},Dt[t].cancel),a.default.createElement(Ft,null,a.default.createElement(c.zx,{key:"skip",onClick:d,type:"secondary",variant:"ghost"},Dt[t].skip),a.default.createElement(c.zx,{key:"submit",onClick:I,type:"primary",disabled:r},Dt[t].save))):a.default.createElement(a.default.Fragment,null,a.default.createElement(c.zx,{key:"cancel",onClick:w,type:"secondary",variant:"ghost"},Dt[t].cancel),a.default.createElement(c.zx,{key:"submit",onClick:I,type:"primary",disabled:""===v},Dt[t].save));return a.default.createElement(lt.Z,{visible:n,onCancel:w,onOk:I,title:Dt[t].title,footer:[b]},a.default.createElement(s.Z,{gutter:[0,24],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:8},a.default.createElement(c.Dx,{level:6},"Name")),a.default.createElement(D.Z,{span:16},a.default.createElement(c.II,{size:"default",value:v,onChange:function(e){return g(e.target.value)},style:{width:"100%"}}))),a.default.createElement(s.Z,{gutter:[0,24],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:8},a.default.createElement(c.Dx,{level:6},"Description")),a.default.createElement(D.Z,{span:16},a.default.createElement(c.II,{size:"default",value:y,onChange:function(e){return x(e.target.value)},style:{width:"100%"}}))))}var Nt,Mt=d.default.div.withConfig({displayName:"datastudio__Footer",componentId:"datastudio__vvout2-0"})(["&&&{display:flex;flex-direction:row;justify-content:space-between;}"]),Ft=d.default.div.withConfig({displayName:"datastudio__FlexEnd",componentId:"datastudio__vvout2-1"})(["&&&{display:flex;justify-content:flex-end;}"]);function At(e){var t=e.disabledWorkflows,n=void 0===t?[]:t,i=(0,r.$B)("/:project/:path*"),u=(0,r.k6)(),d=(0,l.I0)(),s=(0,a.useState)(!1),f=(0,o.Z)(s,2),m=f[0],p=f[1],v=(0,a.useState)(),g=(0,o.Z)(v,2),h=g[0],E=g[1],y=(0,It.P5)("3D_CONTEXT",{fallback:!1,forceRerender:!0}),x=function(e){return n.includes(e)},w=function(){var e=(0,ae.Z)(re().mark((function e(t,n){return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(!1),d((0,xt.c2)({name:t,description:n,draft:!0})),u.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/pipeline")));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return a.default.createElement(Ot,null,a.default.createElement(c.zs,{type:"RuleMonitoring"}),a.default.createElement(c.Dx,{level:4,style:{marginTop:"8px"}},"Match your resources"),a.default.createElement(c.uT,{level:1},"You can read more about entity matching"),a.default.createElement(c.A,{href:"https://docs.cognite.com/cdf/integration/guides/contextualization/matching.html",isExternal:!0}," ","here in the documentation."),a.default.createElement(Kt,null,a.default.createElement(Ct,{onChange:function(e){return E(e.target.value)},value:h},a.default.createElement(St,{value:"quick-match",disabled:x(Nt.QUICK_MATCH),tooltip:x(Nt.QUICK_MATCH)?"Quick Match workflow is disabled.":void 0},a.default.createElement(c.Dx,{level:5,style:{marginBottom:"8px",textAlign:"left"}},a.default.createElement(c.JO,{type:"GanttChart"})," Quick match"),a.default.createElement(c.uT,{level:2},"This easy matching process allows you to quickly match resources, review suggested matches, and write them to CDF.")),a.default.createElement(St,{value:"pipeline",disabled:x(Nt.PIPELINES),tooltip:x(Nt.PIPELINES)?"Pipelines workflow is disabled.":void 0},a.default.createElement(c.Dx,{level:5,style:{marginBottom:"8px",textAlign:"left"}},a.default.createElement(c.JO,{type:"Share"})," Create new pipeline"),a.default.createElement(c.uT,{level:2},"A pipeline is a resource matching process that can be saved and manually rerun. At present, you can only match data sets.")),y&&a.default.createElement(St,{value:"3d",disabled:x(Nt.THREED_MODELS),tooltip:x(Nt.THREED_MODELS)?"3D model workflow is disabled.":void 0},a.default.createElement(c.Dx,{level:5,style:{marginBottom:"8px",textAlign:"left"}},a.default.createElement(c.JO,{type:"Cube"})," Match 3D models"),a.default.createElement(c.uT,{level:2},"Match nodes in a 3D model to their respective assets.")))),a.default.createElement(c.zx,{type:"primary",disabled:"pipeline"!==h&&"quick-match"!==h&&"3d"!==h,onClick:function(){"pipeline"===h?((0,Y.t5)(Y.YY.pipeline.start),p(!0)):"quick-match"===h?((0,Y.t5)(Y.YY.quickMatch.start),u.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/quick-match")))):"3d"===h&&u.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/3d_matching")))}},"Next"),a.default.createElement(_t,{type:"create",visible:m,onOk:w,onCancel:function(){return p(!1)}}))}!function(e){e.QUICK_MATCH="quick-match",e.PIPELINES="pipelines",e.THREED_MODELS="threed-models"}(Nt||(Nt={}));var Ot=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-1bwpo8g-0"})(["&&&{display:flex;width:100vw;height:500px;flex-direction:column;justify-content:center;align-items:center;}&&& > *{margin:4px 0;}"]),Kt=d.default.div.withConfig({displayName:"datastudio__PrimaryActionsWrapper",componentId:"datastudio__sc-1bwpo8g-1"})(["&&&{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:16px;}&&& > *{margin:20px 0 20px;}"]),zt=n(40862),Pt=d.default.span.withConfig({displayName:"datastudio__Red",componentId:"datastudio__sc-1eii4hv-0"})(["&&&{color:",";}"],c.wL["midorange-1"].hex());function Rt(e){var t=e.visible,n=e.onOk,l=e.onCancel;return a.default.createElement(lt.Z,{visible:t,onCancel:l,onOk:n,title:"Delete pipeline",footer:[a.default.createElement(a.default.Fragment,null,a.default.createElement(c.zx,{key:"back",onClick:l,type:"secondary",variant:"ghost"},"Cancel"),a.default.createElement(c.zx,{key:"delete",onClick:n,type:"primary"},"Delete"))]},"Are you sure you want to delete this pipeline?")}var Lt=function(e){var t=e.id,n=e.onEditPipelineClick,r=e.onOpenPipelineClick,i=(0,l.I0)(),u=(0,a.useState)(!1),d=(0,o.Z)(u,2),s=d[0],f=d[1];return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.v2,{onClick:function(e){return e.stopPropagation()}},a.default.createElement(c.v2.Item,{onClick:r},"Open"),a.default.createElement(c.v2.Item,{onClick:function(){return n(t)}},"Edit name & description"),a.default.createElement(c.v2.Item,{onClick:function(){(0,Y.t5)(Y.YY.pipeline.duplicate,{pipelineId:t}),i((0,xt.eJ)(t))}},"Duplicate"),a.default.createElement(c.v2.Item,{onClick:function(){return f(!0)}},a.default.createElement(Pt,null,"Delete"))),a.default.createElement(Rt,{visible:s,onOk:function(){(0,Y.t5)(Y.YY.pipeline.delete,{pipelineId:t}),i((0,xt.A4)(t))},onCancel:function(){return f(!1)}}))};function Yt(e){var t=e.query,n=e.setQuery,i=(0,r.$B)("/:project/:path*"),u=(0,r.k6)(),d=(0,l.I0)(),s=(0,a.useState)(!1),f=(0,o.Z)(s,2),m=f[0],p=f[1],v=(0,It.P5)("3D_CONTEXT",{fallback:!1,forceRerender:!0}),g=function(){var e=(0,ae.Z)(re().mark((function e(t,n){return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(!1),d((0,xt.c2)({name:t,description:n,draft:!0})),u.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/pipeline")));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return a.default.createElement(y.X2,{flex:!0,justify:"space-between",style:{margin:"20px 0"}},a.default.createElement(c.II,{placeholder:"Filter by name...",onChange:function(e){return n(e.currentTarget.value)},value:t}),a.default.createElement("div",{style:{display:"flex"}},a.default.createElement(y.hU,{type:"primary",icon:"GanttChart",style:{marginRight:"16px"},onClick:function(){(0,Y.t5)(Y.YY.quickMatch.start),u.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/quick-match")))}},"Quick match"),v&&a.default.createElement(y.hU,{type:"primary",icon:"Cube",style:{marginRight:"16px"},onClick:function(){return u.push((0,I.EW)("/".concat(null==i?void 0:i.params.path,"/3d_matching")))}},"3D matching"),a.default.createElement(y.hU,{type:"primary",icon:"Share",onClick:function(){(0,Y.t5)(Y.YY.pipeline.start),p(!0)}},"Create pipeline")),a.default.createElement(_t,{type:"create",visible:m,onOk:g,onCancel:function(){return p(!1)}}))}var Bt=n(85213),Ut={assets:"DataStudio",events:"Events",timeseries:"Timeseries",files:"Files",sequences:"Duplicate"},Wt=d.default.div.withConfig({displayName:"datastudio__DatasetsNumber",componentId:"datastudio__sc-1fiidqw-0"})(["&&&{margin:0 3px;font-weight:600;}"]);function jt(e){var t,n,r,i,u,o,d=e.pipeline,s=(0,l.v9)((function(e){return e.dataSets.items})),f=(0,l.v9)(v.hL),m=null===(t=d.sources)||void 0===t?void 0:t.resource,p=null===(n=d.targets)||void 0===n?void 0:n.resource,g=(null!==(r=null===(i=d.sources)||void 0===i?void 0:i.dataSetIds)&&void 0!==r?r:[]).filter((function(e){return s[e.id]})).map((function(e,t){var n,l,r=null!==(n=null===(l=s[e.id])||void 0===l?void 0:l.name)&&void 0!==n?n:"<unknown>";return t<1?a.default.createElement(y.Ct,{text:r,key:e.id,icon:m&&Ut[m]&&a.default.createElement(c.JO,{type:Ut[m]})}):r})),h=(null!==(u=null===(o=d.targets)||void 0===o?void 0:o.dataSetIds)&&void 0!==u?u:[]).filter((function(e){return s[e.id]})).map((function(e,t){var n,l,r=null!==(n=null===(l=s[e.id])||void 0===l?void 0:l.name)&&void 0!==n?n:"<unknown>";return t<1?a.default.createElement(y.Ct,{text:r,key:e.id,icon:p&&Ut[p]&&a.default.createElement(c.JO,{type:Ut[p]})}):r})),E=function(e){if(null!=e&&e.length){var t=e.slice(0,1),n=e.slice(1).join(", "),l=(null==e?void 0:e.length)>1&&"+".concat((null==e?void 0:e.length)-1);return a.default.createElement(a.default.Fragment,null,t,!!l&&a.default.createElement(c.u,{content:n},a.default.createElement(Wt,null,l)))}},x=!(null==g||!g.length)&&!(null==h||!h.length)&&a.default.createElement("span",{style:{margin:"0 3px"}},"and");return null!=g&&g.length||null!=h&&h.length?a.default.createElement(Bt.Z,{spinning:!!f},a.default.createElement(y.X2,{flex:!0,wrap:!0,align:"center",style:{fontSize:"0.9em",fontWeight:500}},E(g),x,E(h))):a.default.createElement(Bt.Z,{spinning:!!f},"—")}var qt=n(82427),Jt=n.n(qt),Xt=n(51689),Ht=n.n(Xt);Jt().extend(Ht());var Qt=d.default.div.withConfig({displayName:"datastudio__Badge",componentId:"datastudio__sc-1weukmz-0"})(["&&&{display:flex;flex-direction:row;align-items:center;white-space:nowrap;padding:4px 8px;border-radius:4px;font-weight:500;}"]),$t=(0,d.default)(Qt).attrs((function(e){var t=e.draft;return{style:{backgroundColor:t?c.wL["greyscale-grey2"].hex():c.wL["midblue-8"].hex(),color:t?c.wL["greyscale-grey7"].hex():c.wL["midblue-2"].hex()}}})).withConfig({displayName:"datastudio__LastRun",componentId:"datastudio__sc-1weukmz-1"})(["&&&{}"]),Gt=(0,d.default)(Qt).attrs((function(e){var t=e.status,n={};return"Queued"===t&&(n.backgroundColor=c.wL["yellow-7"].hex(),n.color=c.wL["greyscale-grey7"].hex()),"Running"===t&&(n.backgroundColor=c.wL["yellow-7"].hex(),n.color=c.wL["greyscale-grey7"].hex()),"Completed"===t&&(n.backgroundColor="#f0fcf8",n.color="#078d79"),"Failed"===t&&(n.backgroundColor=c.wL.danger.hex(),n.color=c.wL["greyscale-grey3"].hex()),{style:n}})).withConfig({displayName:"datastudio__Running",componentId:"datastudio__sc-1weukmz-2"})(["&&&{}"]);function Vt(e){var t=e.pipeline,n=e.draft,r=t.id,i=(0,l.v9)((function(e){var t,n,a;return null===(t=e.contextualization)||void 0===t||null===(n=t.pipelines)||void 0===n||null===(a=n.run[r])||void 0===a?void 0:a.status})),u=!!i,o=!!t.lastJobId,d=Jt()(),s=o&&(t.lastUpdatedTime||t.createdTime),f=s?Jt()(s).format("DD MMMM YYYY, HH:mm"):"Last run: never";if(!s&&!u)return a.default.createElement(y.X2,{flex:!0,wrap:!0,justify:"center",align:"center"},a.default.createElement($t,{key:"lastrun-".concat(d),draft:n},n&&"Draft",!n&&!o&&"never"));var m="Failed"===i?"The run failed. Try again in a few minutes.":f;return a.default.createElement(y.X2,{flex:!0,wrap:!0,justify:"center",align:"center"},a.default.createElement(c.u,{content:m},u?a.default.createElement(Gt,{status:i},function(){switch(i){case"Queued":return a.default.createElement(y.X2,{flex:!0,align:"center",justify:"center",style:{margin:0,padding:0}},a.default.createElement(c.JO,{type:"Info",style:{marginRight:"5px"}}),"Queued");case"Running":return a.default.createElement(y.X2,{flex:!0,align:"center",justify:"center",style:{margin:0,padding:0}},a.default.createElement(c.JO,{type:"Loader",style:{marginRight:"5px"}}),"Running");case"Completed":return a.default.createElement(y.X2,{flex:!0,align:"center",justify:"center",style:{margin:0,padding:0}},a.default.createElement(c.JO,{type:"Checkmark",style:{marginRight:"5px"}}),"Completed");case"Failed":return a.default.createElement(y.X2,{flex:!0,align:"center",justify:"center",style:{margin:0,padding:0}},a.default.createElement(c.JO,{type:"Warning",style:{marginRight:"5px"}}),"Failed");default:return"Unknown..."}}()):a.default.createElement($t,{key:"lastrun-".concat(null!=s?s:d),draft:n},n?"Draft":d.to(null!=s?s:d))))}var en=d.default.span.withConfig({displayName:"datastudio__Name",componentId:"datastudio__sc-1vq0h5a-0"})(["&&&{font-weight:bold;}"]),tn=(0,d.default)(zt.Z).withConfig({displayName:"datastudio__Dropdown",componentId:"datastudio__sc-1vq0h5a-1"})(["&&&{margin:0;padding:0;}"]);function nn(){var e=(0,l.I0)(),t=(0,r.k6)(),n=(0,r.$B)("/:project/:path*"),i=(0,a.useState)(!1),u=(0,o.Z)(i,2),d=u[0],s=u[1],f=(0,a.useState)(void 0),m=(0,o.Z)(f,2),p=m[0],g=m[1],h=(0,a.useState)(""),E=(0,o.Z)(h,2),x=E[0],w=E[1],b=(0,a.useState)([]),k=(0,o.Z)(b,2),S=k[0],Z=k[1],C=(0,l.v9)((function(e){return e.contextualization.pipelines})),D=(0,l.v9)((function(e){return e.contextualization.pipelines})),T=D.update,_=D.fetch,N=D.delete,M=(0,l.v9)((function(e){return e.contextualization.pipelines.run})),F=!C.items||0===C.items.length,A=!0===_.start,O=_.success,K=function(e){return!e.trueMatches&&!e.modelParameters&&!!e.rules};(0,a.useEffect)((function(){e((0,xt.pr)()),e((0,v.pb)())}),[e]),(0,a.useEffect)((function(){null!=T&&T.success&&(e((0,xt.Zs)("update")),P("info","Success!","Pipeline succesfully updated!"),s(!1)),null!=T&&T.error&&P("error","Error","Couldn't update pipeline.")}),[e,T]),(0,a.useEffect)((function(){null!=N&&N.success&&(e((0,xt.Zs)("delete")),P("info","Success!","Pipeline succesfully deleted!"),s(!1)),null!=N&&N.error&&P("error","Error","Couldn't delete pipeline.")}),[e,N]);var z=[{title:function(){return a.default.createElement(y.DV,null,"Name")},dataIndex:"name",key:"name",width:"20%",render:function(e){return a.default.createElement(en,{key:"name-".concat(e)},e||"—")},sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.name,null==t?void 0:t.name)}},{title:a.default.createElement(y.DV,null,"Description"),dataIndex:"description",key:"description",render:function(e){return e||"—"},sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.description,null==t?void 0:t.description)}},{title:a.default.createElement(y.DV,null,"Datasets"),key:"datasets",width:"25%",render:function(e){return a.default.createElement(jt,{pipeline:e})},sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.dataset,null==t?void 0:t.dataset)}},{title:a.default.createElement(y.DV,null,"Owner"),dataIndex:"owner",key:"owner",render:function(e){return a.default.createElement(en,null,e)},sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.owner,null==t?void 0:t.owner)}},{title:a.default.createElement(y.DV,null,"Last run"),dataIndex:"",key:"last-run",width:200,align:"center",render:function(e){return a.default.createElement(Vt,{pipeline:e,draft:K(e)})},sorter:function(e,t){var n=e.lastUpdatedTime||e.createdTime||0,a=t.lastUpdatedTime||t.createdTime||0;return(0,I.$K)(n.toString(),a.toString())},sortDirections:["descend","ascend"],defaultSortOrder:"descend"},{title:"",dataIndex:"",width:230,key:"run",render:function(e){var t,n=e.id,l=K(e),r=null===(t=M[n])||void 0===t?void 0:t.status,i="Queued"===r||"Running"===r,u=l?"Cannot rerun draft pipeline.":"Click here to rerun pipeline",o=l?"Draft pipeline has no results to view.":i?"Wait for the pipeline to finish running before reviewing results.":e.lastJobId?"View results from last run":"This pipeline does not have any latest run jobs.";return a.default.createElement(y.X2,{flex:!0,justify:"space-between",onClick:function(e){return e.stopPropagation()}},a.default.createElement(c.u,{content:a.default.createElement("span",{className:"z-12"},u)},a.default.createElement(y.hU,{icon:"ChevronRight",onClick:function(e){(0,Y.t5)(Y.YY.pipeline.rerun,{pipelineId:n}),e.stopPropagation(),U(n)},disabled:l||i,key:"run-".concat(n),style:{marginRight:"5px"}},"Rerun pipeline")),a.default.createElement(c.u,{content:a.default.createElement("span",{className:"z-12"},o)},a.default.createElement(y.hU,{icon:"EyeShow","aria-label":"View results button",onClick:function(t){t.stopPropagation(),W(e)},disabled:l||i||!e.lastJobId,key:"run-".concat(n),style:{marginRight:"5px"},square:!0})),a.default.createElement(tn,{overlay:a.default.createElement(Lt,{onOpenPipelineClick:function(){return R(e)},id:e.id,onEditPipelineClick:L}),trigger:["click"],className:"z-12",key:"dropdown-".concat(e.id)},a.default.createElement(y.hU,{icon:"EllipsisHorizontal","aria-label":"More actions",type:"ghost",square:!0})))}}];(0,a.useEffect)((function(){var e,t=null==C||null===(e=C.items)||void 0===e?void 0:e.filter((function(e){return(0,I.No)(null==e?void 0:e.name,x)}));Z(t)}),[C,x]);var P=function(e,t,n){return ze.Z[e]({message:t,description:n})},R=function(a){e((0,xt.PJ)(a)),t.push((0,I.EW)("/".concat(null==n?void 0:n.params.path,"/pipeline/").concat(a.id)))},L=function(e){var t=C.items.find((function(t){return t.id===e}));g(t),s(!0)},B=function(){var t=(0,ae.Z)(re().mark((function t(n,a){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((0,xt.xG)(p.id,{name:{set:n},description:{set:a}})),s(!1);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),U=function(t){e((0,xt.M_)(t))},W=function(e){K(e)||t.push((0,I.EW)("/".concat(null==n?void 0:n.params.path,"/pipeline/").concat(e.id,"/results")))},j=F?a.default.createElement(At,null):a.default.createElement(a.default.Fragment,null,a.default.createElement(Yt,{query:x,setQuery:w}),a.default.createElement(y.iA,{pagination:{pageSize:10,hideOnSinglePage:!0},dataSource:S,columns:z,size:"middle",rowKey:"id",onRow:function(e){return{onClick:function(){(0,Y.t5)(Y.YY.pipeline.open,{id:e.id}),R(e)}}}}));return a.default.createElement("div",null,a.default.createElement(y.V1,null,"Entity Matching pipelines"),A&&a.default.createElement(c.aN,null),!A&&O&&j,a.default.createElement(_t,{type:"edit",visible:d,pipeline:p,onOk:B,onCancel:function(){return s(!1)}}))}function an(){var e=(0,l.I0)(),t=(0,l.v9)((function(e){return e.contextualization.pipelines.fetch.error}));return(0,a.useEffect)((function(){e((0,xt.pr)())}),[e]),t?a.default.createElement(At,{disabledWorkflows:[Nt.PIPELINES]}):a.default.createElement(nn,null)}var ln=n(2200),rn=n(29184);function un(e){return(0,l.v9)(e.selector)?a.default.createElement(a.default.Fragment,null,e.children):a.default.createElement(a.default.Fragment,null,e.missingMessage)}var on=n(26823),cn=at.Z.Text;function dn(e){var t=e.id,n=(0,l.v9)((function(e){return e.selection.items[t]})).type,r=(0,a.useMemo)((function(){return(0,se.aX)(t)}),[t]),i=(0,a.useMemo)((function(){return(0,se._O)(t,!0)}),[t]),u=(0,l.v9)(i),o=(0,l.v9)(r),c=parseInt((100*(o?u/o:0)).toFixed(0),10);return a.default.createElement(a.default.Fragment,null,a.default.createElement(cn,{strong:!0},"Loading ","timeseries"===n?"time series":n," (",a.default.createElement(cn,{type:"secondary"},u),")"),a.default.createElement(it.Z,{percent:c,status:100===c?"success":"active"}))}var sn=at.Z.Text,fn=(0,d.default)(on.Z).withConfig({displayName:"datastudio__CircleAvatar",componentId:"datastudio__f5ow7i-0"})(["&&&{background-color:initial;color:#000000d9;border:1px solid #000000d9;}"]),mn={"":0,New:0,Scheduled:10,Queued:20,Running:40,Completed:100,Failed:100},pn=function(e){switch(e){case"New":case"Scheduled":case"Queued":case"Running":default:return"active";case"Completed":return"success";case"Failed":return"exception"}};function vn(e){var t=e.isPipeline,n=e.assetDataKitId,l=e.resourceDataKitId;return t?a.default.createElement(gn,{resourceDataKitId:l}):a.default.createElement(hn,{assetDataKitId:n,resourceDataKitId:l})}function gn(e){var t,n=e.resourceDataKitId,i=(0,r.k6)(),u=(0,r.$B)(),o=Number(null==u||null===(t=u.params)||void 0===t?void 0:t.pipelineId),d=(0,l.v9)((function(e){return e.contextualization.pipelines.byDataKitId[n]})),f=(0,l.v9)((function(e){return e.contextualization.pipelines.run[o]})),m=(0,l.v9)((function(e){var t=e.contextualization.pipelines.byDataKitId[n];return t.error?"Failed":t.success?"Completed":t.start?"Running":""})),p=(0,l.v9)((function(e){var t,n;return null!==(t=null===(n=e.contextualization.pipelines.run[o])||void 0===n?void 0:n.status)&&void 0!==t?t:""})),v=d.start||d.success||"Running"===(null==f?void 0:f.status),g=d.error||(null==f?void 0:f.error),h=a.default.createElement(s.Z,{type:"flex",justify:"end"},a.default.createElement(c.zx,{type:"primary",onClick:function(){return i.push((0,I.EW)("/".concat(B.m)))}},"Go back to the pipeline list"));return a.default.createElement(lt.Z,{title:"Please wait...",visible:v||g,closable:!0,footer:[h]},a.default.createElement(s.Z,{gutter:[0,30],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"1")),a.default.createElement(D.Z,{span:22},a.default.createElement(sn,{strong:!0},"Updating pipeline"),a.default.createElement(it.Z,{percent:mn[m]||0,status:pn(m)}))),a.default.createElement(s.Z,{gutter:[0,30],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"2")),a.default.createElement(D.Z,{span:22},a.default.createElement(sn,{strong:!0},"Running pipeline"),a.default.createElement(it.Z,{percent:mn[p]||0,status:pn(p)}))))}function hn(e){var t=e.assetDataKitId,n=e.resourceDataKitId,i=(0,l.I0)(),u=(0,r.$B)("/:project"),o=(0,a.useMemo)((function(){return(0,rn._r)(t,n)}),[t,n]),d=(0,l.v9)((function(e){return e.contextualization.models[t]}))||{status:"New",done:!1},f=d.status,m=d.error,p=d.id,v=(0,l.v9)((function(e){return e.contextualization.predictions[n]}))||{status:"New",done:!1},g=v.status,h=v.error,E=v.id,x=(0,l.v9)((function(e){return e.contextualization.rules[n]}))||{status:"New",done:!1},I=x.status,w=x.error,b=x.id,k=a.default.createElement(y.rU,{to:"/".concat(null==u?void 0:u.params.project,"/").concat(B.m,"/pipeline")},a.default.createElement(c.zx,{style:{marginRight:"8px"}},"Start over")),S=a.default.createElement(c.zx,{onClick:function(){p&&E&&b&&(i((0,rn.mc)(t,n)),i((0,rn.fq)(t,n,p.toString(),E.toString(),b.toString())))}},"Try again"),Z=(0,l.v9)(o),C=m||h;return a.default.createElement(lt.Z,{title:"Getting your data…",visible:Z||C,footer:null,closable:!1},a.default.createElement(s.Z,{gutter:[0,20],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"1")),a.default.createElement(D.Z,{span:22},a.default.createElement(dn,{id:t}))),a.default.createElement(s.Z,{gutter:[0,30],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"2")),a.default.createElement(D.Z,{span:22},a.default.createElement(dn,{id:n}))),a.default.createElement(s.Z,{gutter:[0,40],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"3")),a.default.createElement(D.Z,{span:22},a.default.createElement(sn,{strong:!0},"Training matching model based on provided data"),a.default.createElement(it.Z,{percent:mn[f]||0,status:pn(f)}))),a.default.createElement(s.Z,{gutter:[0,40],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"4")),a.default.createElement(D.Z,{span:22},a.default.createElement(sn,{strong:!0},"Generating predictions"),a.default.createElement(it.Z,{percent:mn[g]||0,status:pn(g)}))),a.default.createElement(s.Z,{gutter:[0,40],align:"middle",type:"flex"},a.default.createElement(D.Z,{span:2},a.default.createElement(fn,null,"5")),a.default.createElement(D.Z,{span:22},a.default.createElement(sn,{strong:!0},"Generating rules for predictions"),a.default.createElement(it.Z,{percent:mn[I]||0,status:pn(I)}))),m||h||w?a.default.createElement(s.Z,{gutter:[0,40],align:"middle",type:"flex",style:{textAlign:"center"}},a.default.createElement(D.Z,{span:22},a.default.createElement(rt.Z,{message:"There was an error!",type:"error",description:a.default.createElement("div",null,k,S)}))):null)}var En=[{title:"Resource",dataIndex:"resourceName"},{title:"Existing asset id",dataIndex:"oldAssetId"},{title:"New asset id",dataIndex:"assetId"}];function yn(e){var t=e.visible,n=e.confirmed,r=e.onClose,i=e.resourceDataKitId,u=e.assetsDSId,o=(0,a.useMemo)((function(){return(0,ue.GF)(i,u)}),[i,u]),c=(0,a.useMemo)((function(){return(0,se.Wi)(i,!0)}),[i]),d=(0,l.v9)(o),s=(0,l.v9)(c),f=d.map((function(e){var t=s[e.resourceId];return null!=t&&t.assetId&&(null==t?void 0:t.assetId)!==e.assetId?(0,p.Z)((0,p.Z)({},e),{},{oldAssetId:null==t?void 0:t.assetId}):(0,p.Z)((0,p.Z)({},e),{},{oldAssetId:void 0})})).filter((function(e){return!!e.oldAssetId}));return a.default.createElement(lt.Z,{title:"Confirm overwriting asset IDs",visible:t,onOk:function(){n(),r()},onCancel:function(){return r()},width:1e3},a.default.createElement("p",null,"The following resources already have an asset id that will be overwritten!"),a.default.createElement(T.Z,{rowKey:"resourceId",columns:En,dataSource:f,size:"small"}))}var xn=(0,d.default)(c.zx).withConfig({displayName:"datastudio__Button",componentId:"datastudio__z3ku6j-0"})(["&&&{padding:16px 32px;}"]);function In(){var e=(0,l.I0)(),t=(0,r.k6)(),n=(0,a.useState)(!1),i=(0,o.Z)(n,2),u=i[0],d=i[1],s=(0,r.UO)(),f=s.assetsDataKitId,p=s.resourceDataKitId,v=(0,a.useMemo)((function(){return(0,ue.GF)(p,f)}),[p,f]),g=(0,a.useMemo)((function(){return(0,se.Wi)(p,!0)}),[p]),h=(0,a.useMemo)((function(){return(0,ue.kS)(p)}),[p]),E=(0,l.v9)(h),y=E.writingChanges,x=E.writeError,I=(0,l.v9)(v),w=(0,l.v9)(g),b=(0,a.useState)(!1),k=(0,o.Z)(b,2),S=k[0],Z=k[1];(0,a.useEffect)((function(){u&&!y&&(!1===x&&(ze.Z.info({message:"Changes successfully saved to CDF!"}),d(!1)),!0===x&&(ze.Z.error({message:"An error occurred while trying to save to CDF."}),d(!1)))}),[u,y,x]);var C=I.filter((function(e){var t=w[e.resourceId];return(null==t?void 0:t.assetId)&&e.assetId!==(null==t?void 0:t.assetId)})).length>0,D=function(){(0,Y.t5)(Y.YY.quickMatch.saveToCdf,{stagedChangesCount:I.length,dataSetId:p}),d(!0),e((0,ue.eE)(p))},T=y||0===I.length;return a.default.createElement(m,{justify:"space-between"},a.default.createElement(yn,{visible:S,confirmed:function(){return D()},onClose:function(){return Z(!1)},resourceDataKitId:p,assetsDSId:f}),a.default.createElement(xn,{variant:"ghost",onClick:function(){return t.goBack()}},"Back"),a.default.createElement(c.u,{content:T?"You have no drafted changes to save to CDF":"Save all the drafted changes to CDF"},a.default.createElement(xn,{onClick:function(){C?Z(!0):D()},disabled:T,type:"primary",style:{marginLeft:"8px"}},"Save to CDF")))}var wn=function(e){var t;return null!=e&&null!==(t=e.assetIds)&&void 0!==t&&t.length?e.assetIds:[null==e?void 0:e.assetId].filter((function(e){return e}))},bn=function(e){var t=e.source,n=e.target,a=e.type,l=wn(t);return"previously-confirmed"===a?"Previously confirmed":null!=l&&l.length&&null!=n&&n.id&&!l.includes(n.id)?"Different recommendation":null!=l&&l.length?null!=l&&l.length?"Matched":a||"-":"Unmatched"},kn={all:{name:"All",filter:function(){return!0}},confirmed:{name:"Previously confirmed",filter:function(e){return"previously-confirmed"===e.type}},unmatched:{name:"Unmatched",filter:function(e){var t=e.source,n=wn(t);return!(null!=n&&n.length)}},matched:{name:"Matched",filter:function(e){var t=e.source,n=wn(t);return!(null==n||!n.length)}},diff:{name:"Different recommendation",filter:function(e){var t=e.source,n=e.target,a=wn(t);return!(null==a||!a.length)&&(null==n?void 0:n.id)&&!a.includes(n.id)}}};function Sn(e){var t=e.resourceDataKitId,n=e.mode,r=e.setMode,i=(0,a.useMemo)((function(){return(0,ue.zd)(t)}),[t]),u=(0,l.v9)(i),o=Object.values(u),c=function(e){return a.default.createElement(a.default.Fragment,null,a.default.createElement("span",{style:{fontWeight:600}},kn[e].name)," ",o.filter((function(t){return function(e,t){var n;return kn[t].filter({source:null==e?void 0:e.item,target:null==e||null===(n=e.matches[0])||void 0===n?void 0:n.target})}(t,e)})).length)};return a.default.createElement(de.Z,{value:n,defaultValue:"all",onChange:function(e){return r(e)},style:{width:"100%",fontSize:"14px"}},a.default.createElement(de.Z.Option,{value:"all"},c("all")),a.default.createElement(de.Z.Option,{value:"matched"},c("matched")),a.default.createElement(de.Z.Option,{value:"unmatched"},c("unmatched")),a.default.createElement(de.Z.Option,{value:"diff"},c("diff")))}function Zn(){var e=(0,l.I0)(),t=(0,r.UO)(),n=t.resourceDataKitId,i=t.assetsDataKitId,u=(0,a.useMemo)((function(){return(0,ue.kS)(n)}),[n]),o=(0,a.useMemo)((function(){return(0,ue.GF)(n,i)}),[n,i]),d=(0,l.v9)(o),s=(0,l.v9)(u).writingChanges||0===d.length;return a.default.createElement(c.u,{content:s?"You have no drafted changes to dismiss":"Dismiss all drafted matches. You can draft them again later"},a.default.createElement(c.zx,{disabled:s,onClick:function(){e((0,ue.P5)(n,d))},style:{padding:"12px 32px"}},"Unstage all"))}function Cn(e){var t=e.changeTab,n=(0,a.useState)(!1),l=(0,o.Z)(n,2),r=l[0],i=l[1];return(0,a.useEffect)((function(){t(r?"rules":"manual")}),[r,t]),a.default.createElement(a.default.Fragment,null,a.default.createElement(c.uT,{level:2},"Group by pattern"),a.default.createElement(c.rs,{name:"rules-switch",size:"small",value:r,onChange:i,style:{margin:"0 20px"}}))}var Dn=n(91791),Tn=n.n(Dn),_n=n(90284),Nn=n(4711);function Mn(e){return a.default.createElement(lt.Z,{footer:null,width:"80%",visible:!0,onOk:e.onClose,onCancel:e.onClose},a.default.createElement(Nn.n,{timeseriesId:e.timeseriesId}))}function Fn(e){return a.default.createElement(lt.Z,{footer:null,width:"80%",visible:!0,onOk:e.onClose,onCancel:e.onClose},a.default.createElement(X.b,{assetId:e.assetId}))}var An=d.default.div.withConfig({displayName:"datastudio__AdjustedColumn",componentId:"datastudio__sc-54fp51-0"})(["&&&{width:calc(30% + 25px);}"]);function On(e){var t=e.match,n=e.prediction,i=(0,r.UO)(),u=i.resourceDataKitId,o=i.pipelineId,d=(0,l.v9)((0,ue.HH)({resourceDataKitId:u,pipelineId:o}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(y.X2,{flex:!0},a.default.createElement(c.uT,{level:3,style:{fontWeight:500,marginLeft:"-20px"}},"Connected fields")),d.map((function(e){var l,r,i,u,d,s=o?null==t||null===(l=t.source)||void 0===l?void 0:l[null==e?void 0:e.source]:null==n||null===(r=n.source)||void 0===r?void 0:r[null==e?void 0:e.source],f=o?null==t||null===(i=t.target)||void 0===i?void 0:i[null==e?void 0:e.target]:null==n||null===(u=n.matches[0])||void 0===u||null===(d=u.target)||void 0===d?void 0:d[null==e?void 0:e.target];return a.default.createElement(y.X2,{flex:!0,justify:"flex-start",key:"".concat(e.source,"-").concat(null==e?void 0:e.target,"-connection")},a.default.createElement(An,null,a.default.createElement(c.F,{style:{userSelect:"none"}},e.source),a.default.createElement(c.uT,{level:2},null!=s?s:"-")),a.default.createElement(An,null,a.default.createElement(c.F,{style:{userSelect:"none"}},e.target)," ",a.default.createElement(c.uT,{level:2},null!=f?f:"-")))})))}function Kn(e){var t=e.dataSource,n=e.resourceDataKitId,i=e.assetsDataKitId,u=e.style,d=(0,l.I0)(),s=(0,a.useState)(),f=(0,o.Z)(s,2),m=f[0],p=f[1],v=(0,a.useState)(),g=(0,o.Z)(v,2),h=g[0],E=g[1],x=(0,r.UO)().pipelineId,I=(0,a.useMemo)((function(){return(0,ue.Mz)(n,i)}),[n,i]),w=(0,l.v9)((function(e){return e.selection.items[n]})).type,b=(0,l.v9)(I),k=(0,l.v9)((function(e){return e[w].items.items})),S=(0,l.v9)((function(e){return e.assets.items.items})),Z=t.filter((function(e){var t;return e.item&&(null===(t=e.matches)||void 0===t?void 0:t.length)>0})),C=[{title:"Does this resource match...",dataIndex:"source",key:"column-from",width:"30%",render:function(e){return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.F,{style:{userSelect:"none"}},"Name"),a.default.createElement(c.uT,{level:2,style:{fontWeight:500}},function(e){var t,n=k.find((function(t){return t.id===(null==e?void 0:e.id)})),l=null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"<no name>";return"timeseries"===w?a.default.createElement("a",{href:"#modal",onClick:function(t){p(e.id),t.preventDefault()},style:{color:"inherit"}},l):a.default.createElement("div",{style:{color:"inherit"}},l)}(e)))}},{title:"...to this asset?",dataIndex:"matches[0].target",key:"column-to",width:"30%",render:function(e){return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.F,{style:{userSelect:"none"}},"Name"),a.default.createElement(c.uT,{level:2,style:{fontWeight:500}}),function(e){var t,n=S.find((function(t){return(null==t?void 0:t.id)===(null==e?void 0:e.id)})),l=null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"<no name>";return a.default.createElement("a",{href:"#modal",onClick:function(t){E(e.id),t.preventDefault()},style:{color:"inherit "}},l)}(e))}},{title:"Type",dataIndex:"",key:"type",align:"center",render:function(e){var t,n=null==e?void 0:e.item,l=null==e||null===(t=e.matches[0])||void 0===t?void 0:t.target;return a.default.createElement(c.uT,{level:2},bn({source:n,target:l}))}},{title:"Confidence",dataIndex:"matches[0]",key:"confidence",width:130,align:"center",render:function(e){return a.default.createElement(We,{score:null==e?void 0:e.score})},sorter:function(e,t){var n,a,l,r;return(null!==(n=null===(a=e.matches[0])||void 0===a?void 0:a.score)&&void 0!==n?n:0)-(null!==(l=null===(r=t.matches[0])||void 0===r?void 0:r.score)&&void 0!==l?l:0)},sortDirections:["descend","ascend"],defaultSortOrder:"descend"},{title:"Confirm",dataIndex:"item",key:"confirmation",width:130,align:"center",render:function(e){return a.default.createElement(c.XZ,{name:"checkbox-".concat(e.id),value:(t=e.id,Object.prototype.hasOwnProperty.call(b,t)),onChange:function(t){t?(D(),function(e){var t,a,l,r,i,u,o=Z.find((function(t){return t.source.id===e.id}));o?((0,Y.t5)(Y.YY.manualMatching.apply,{resourceName:null!==(t=null===(a=o.source)||void 0===a?void 0:a.name)&&void 0!==t?t:"",assetName:null!==(l=null===(r=o.matches[0])||void 0===r||null===(i=r.target)||void 0===i?void 0:i.name)&&void 0!==l?l:"",dataSetId:n}),d((0,ue.m5)({resourceId:o.source.id,assetId:null===(u=o.matches[0])||void 0===u?void 0:u.target.id,rule:"Manual Matching"},n))):ze.Z.error({message:"Something went wrong."})}(e)):function(e){var t,a=Z.find((function(t){return t.source.id===e.id}));a?d((0,ue.P5)(n,[{resourceId:a.source.id,assetId:null===(t=a.matches[0])||void 0===t?void 0:t.target.id,rule:"Manual Matching"}])):ze.Z.error({message:"Something went wrong."})}(e)}});var t}}],D=function(){x?(0,Y.t5)(Y.YY.pipeline.byMatchItem,{pipelineId:x}):(0,Y.t5)(Y.YY.quickMatch.byMatchItem)};return a.default.createElement(a.default.Fragment,null,m&&a.default.createElement(Mn,{onClose:function(){return p(void 0)},timeseriesId:m}),h&&a.default.createElement(Fn,{onClose:function(){return E(void 0)},assetId:h}),a.default.createElement(y.iA,{pagination:{defaultPageSize:10},dataSource:Z,columns:C,expandedRowRender:function(e){return a.default.createElement(On,{key:"".concat(e.item.id,"-connection"),prediction:e})},expandIcon:function(e){return a.default.createElement(y.qp,{record:e})},rowKey:function(e){return e.source.id},style:u,options:e.options}))}function zn(e){var t=e.resourceDataKitId,n=e.assetsDataKitId,r=e.mode,i=e.queryFilter,u=(0,l.I0)(),c=(0,l.v9)(_n.O1),d=(0,a.useMemo)((function(){return(0,ue.zd)(t)}),[t]),s=(0,l.v9)(d).filter((function(e){var t;return kn[r].filter({source:e.item,target:null===(t=e.matches[0])||void 0===t?void 0:t.target})&&i(e)})),f=Tn()(s.map((function(e){var t;return null===(t=e.source)||void 0===t?void 0:t.id})).filter((function(e){return!!e}))).filter((function(e){return!c(e)})).map((function(e){return{id:e}})),m=(0,a.useState)(),p=(0,o.Z)(m,2),v=p[0],g=p[1];return(0,a.useEffect)((function(){u((0,_n.Jv)(f))}),[u,f]),a.default.createElement(a.default.Fragment,null,v&&a.default.createElement(Mn,{onClose:function(){return g(void 0)},timeseriesId:v}),a.default.createElement(Kn,{dataSource:s,resourceDataKitId:t,assetsDataKitId:n,options:{expandedRowPadding:!0}}))}var Pn=n(26629);function Rn(e){var t=e.rule,n=e.resourceDataKitId,l=e.assetsDataKitId;return a.default.createElement(a.default.Fragment,null,a.default.createElement(Kn,{dataSource:t.matches,resourceDataKitId:n,assetsDataKitId:l,style:{width:"100%"},options:{secondary:!0}}))}var Ln=n(35027),Yn=n.n(Ln);function Bn(e){var t=e.rule,n=e.inputPattern,l=["#e6194b","#3cb44b","#844700","#4363d8","#f58231","#911eb4","#206969","#f032e6","#405502","#6e5353","#008080","#e6beff","#9a6324","#424135","#800000","#42614b","#808000","#6b5137","#000075","#555555","#000000"],r=Yn()(t,/(\[[DL]\d+\])/g,(function(e,t){var r=e.match(/\d+/),i=parseInt(r[0],10)%l.length,u=l[i],o="".concat(u,"11");return a.default.createElement("span",{key:"".concat(n,"-").concat(t),style:{color:u,backgroundColor:o}},e)}));return a.default.createElement("span",{style:{fontFamily:"monospace"}},r)}function Un(e){var t,n,l=e.priorityConnection;return a.default.createElement(y.X2,{flex:!0,style:{padding:0}},a.default.createElement(y.aK,{content:a.default.createElement("div",null,"Pattern generated from ",a.default.createElement("span",{style:{fontWeight:"bold"}},null!==(t=null==l?void 0:l.source)&&void 0!==t?t:"unknown field"," →"," ",null!==(n=null==l?void 0:l.target)&&void 0!==n?n:"unknown field")," ",a.default.createElement("span",null," connection."))}))}function Wn(e){var t=(0,l.I0)(),n=e.resourceDataKitId,r=e.assetsDataKitId,i=e.mode,u=(0,a.useMemo)((function(){return(0,Pn.qR)(n)}),[n]),o=(0,a.useMemo)((function(){return(0,ue.Mz)(n,r)}),[n,r]),d=(0,l.v9)(o),s=(0,l.v9)(u).map((function(e){var t=e.matches.filter((function(e){var t;return kn[i].filter({source:null==e?void 0:e.item,target:null==e||null===(t=e.matches[0])||void 0===t?void 0:t.target})})),n=e.matches.filter((function(e){var t;return d[null==e||null===(t=e.source)||void 0===t?void 0:t.id]})).length;return(0,p.Z)((0,p.Z)({},e),{},{matched:null==t?void 0:t.length,matches:t,staged:n})})),f=(0,l.v9)((function(e){var t,a;return null===(t=e.contextualization.predictions[n])||void 0===t||null===(a=t.config)||void 0===a?void 0:a.connections[0]})),m=[{title:"#",dataIndex:"index",key:"pattern-index",width:20,render:function(e){return a.default.createElement(c.uT,{level:2,style:{color:c.wL["greyscale-grey6"].hex()}},e+1)}},{title:"Pattern",dataIndex:"",key:"pattern-pattern",width:"30%",render:function(e){return a.default.createElement(Bn,{rule:"".concat(e.inputPattern," -> ").concat(e.predictPattern),inputPattern:e.inputPattern})}},{title:"No. of matches",dataIndex:"",key:"pattern-matches-nr",align:"center",width:100,render:function(e){var t;return a.default.createElement(c.Ct,{text:null!==(t=null==e?void 0:e.numMatches)&&void 0!==t?t:"-",background:"greyscale-grey2",size:14})}},{title:"Average score",dataIndex:"",key:"pattern-score",align:"center",width:100,render:function(e){return a.default.createElement(We,{score:e.avgScore})}},{title:"Confirm",dataIndex:"",key:"pattern-confirm",align:"center",width:150,render:function(n){var l=n.staged===n.matched,r=0!==n.staged&&n.staged<n.matched;return a.default.createElement(y.X2,{flex:!0,justify:"space-between",align:"center",style:{padding:0}},a.default.createElement(y.X2,{flex:!0,justify:"flex-end",align:"center",style:{padding:0}},a.default.createElement(c.F,{strong:!0,style:{marginRight:"5px"}},n.staged),a.default.createElement(c.F,null,"confirmed")),a.default.createElement(c.XZ,{name:"".concat(n.inputPattern,"-").concat(n.predictPattern,"-confirm-all"),onChange:function(a){return function(n,a){var l=a.matches.filter((function(e){return e.matches.length>0})).map((function(e){var t;return{resourceId:e.source.id,assetId:null===(t=e.matches[0])||void 0===t?void 0:t.target.id,rule:"".concat(a.inputPattern," -> ").concat(a.predictPattern)}}));n?((0,Y.t5)(Y.YY.quickMatch.byPattern,{rule:a}),t((0,ue.Q3)(l,e.resourceDataKitId))):t((0,ue.P5)(e.resourceDataKitId,l))}(a,n)},value:l,indeterminate:r}))}}],v=s.filter((function(e){return e.matches.length>0})).map((function(e,t){return(0,p.Z)((0,p.Z)({},e),{},{index:t})}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(Un,{priorityConnection:f}),0===s.length&&a.default.createElement(rt.Z,{type:"info",message:"Connection chosen to generate prediction pattern didn't produce any relevant results."}),s.length>0&&a.default.createElement(y.iA,{pagination:{defaultPageSize:10},dataSource:v,columns:m,expandedRowRender:function(e){var t=e;return a.default.createElement(y.X2,{flex:!0,style:{margin:0}},a.default.createElement(Rn,{rule:t,resourceDataKitId:n,assetsDataKitId:r}))},expandIcon:function(e){return a.default.createElement(y.qp,{record:e})},rowKey:function(e){return"".concat(e.inputPattern,"-").concat(e.predictPattern,"-row")},options:{narrow:!0}}))}var jn=n(24335),qn=n(99118),Jn=n(22861),Xn=n(13062),Hn=n.n(Xn);function Qn(e){return a.default.createElement(qn.Z.Item,null,a.default.createElement(s.Z,{gutter:[0,24]},a.default.createElement(D.Z,{span:24},a.default.createElement(c.Dx,{level:6,style:{margin:0}},a.default.createElement("a",{href:"#modal",onClick:function(t){t.preventDefault(),e.onClick()}},e.highlight&&me()(e.name)?a.default.createElement(Hn(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[e.highlight],autoEscape:!0,textToHighlight:e.name}):e.name)),e.description)))}var $n=jn.Z.Panel,Gn=(0,d.default)($n).withConfig({displayName:"datastudio__CollapsePanel",componentId:"datastudio__sc-114yfqb-0"})(["&&& .ant-collapse-content > .ant-collapse-content-box{padding:0;}"]);function Vn(e){var t=(0,a.useState)(),n=(0,o.Z)(t,2),l=n[0],r=n[1],i=(0,a.useState)(),u=(0,o.Z)(i,2),d=u[0],s=u[1],f=(0,a.useState)(1),m=(0,o.Z)(f,2),p=m[0],v=m[1],g=e.stagedChanges,h=e.stagedRules,E=e.writeError,x=e.onDismissClick,I=e.resourceType;(0,a.useEffect)((function(){E&&ze.Z.error({message:"Error saving drafted changes",description:"An error occurred while writing updating one or more resources."})}),[E]);var w=[{title:"Resource",key:"resourceId",render:function(e){var t,n;return a.default.createElement(Qn,{onClick:function(){return"timeseries"===I&&s(e.resourceId)},name:a.default.createElement(c.u,{content:"Name of the resource you match to selected assets"},a.default.createElement("span",null,null!==(t=null==e?void 0:e.resourceName)&&void 0!==t?t:"-")),description:a.default.createElement(c.u,{content:"Resource's field used to generate pattern"},a.default.createElement("span",null,null!==(n=null==e?void 0:e.resourceSecondaryField)&&void 0!==n?n:"-"))})}},{title:"Asset",key:"assetId",render:function(e){var t,n;return a.default.createElement(Qn,{onClick:function(){return r(e.assetId)},name:a.default.createElement(c.u,{content:"Name of the asset you match your resources to"},a.default.createElement("span",null,null!==(t=null==e?void 0:e.assetName)&&void 0!==t?t:"-")),description:a.default.createElement(c.u,{content:"Asset's field used to generate pattern"},a.default.createElement("span",null,null!==(n=null==e?void 0:e.assetSecondaryField)&&void 0!==n?n:"-"))})}},{title:"Remove draft matches",key:"unStageChange",render:function(e){return a.default.createElement(y.X2,{flex:!0,justify:"center"},a.default.createElement(y.hU,{icon:"Close",square:!0,onClick:function(){x([e])}}))}}],b=a.default.createElement(a.default.Fragment,null,a.default.createElement(jn.Z,null,h.slice(15*(p-1),15*p).map((function(e){var t=g.filter((function(t){return t.rule===e})),n=e.split("->")[0],l=a.default.createElement(qn.Z.Item,{style:{display:"flex",alignItems:"center",padding:0}},a.default.createElement(Bn,{rule:e,inputPattern:n}),a.default.createElement(c.zx,{style:{marginLeft:"auto"},onClick:function(){return x(t)}},"Remove ",t.length," draft matches"));return a.default.createElement(Gn,{key:e,header:l,style:{padding:0}},a.default.createElement(y.iA,{rowKey:function(e){return e.resourceId.toString()},pagination:{pageSize:100},dataSource:t,columns:w}))}))),a.default.createElement(Jn.Z,{current:p,total:h.length,defaultPageSize:15,onChange:function(e){return v(e)}}));return a.default.createElement(a.default.Fragment,null,l&&a.default.createElement(Fn,{onClose:function(){return r(void 0)},assetId:l}),d&&a.default.createElement(Mn,{onClose:function(){return s(void 0)},timeseriesId:d}),b)}function ea(e){var t=e.resourceDataKitId,n=e.assetDataKitId,r=(0,a.useMemo)((function(){return(0,ue.GF)(t,n)}),[t,n]),i=(0,a.useMemo)((function(){return(0,ue.kS)(t)}),[t]),u=(0,l.v9)(r),o=(0,l.v9)(i).writeError,c=(0,l.v9)((function(e){return e.selection.items[t]})).type,d=Array.from(new Set(u.map((function(e){return e.rule})))),s=(0,l.I0)();return u.length>0?a.default.createElement(Vn,{stagedChanges:u,stagedRules:d,writeError:o,onDismissClick:function(e){s((0,ue.P5)(t,e))},resourceType:c}):a.default.createElement(y.aK,{content:'You have no drafted changes! Go to the "Unmatched Resources" tab and choose some resources.'})}function ta(){var e=(0,a.useState)("all"),t=(0,o.Z)(e,2),n=t[0],l=t[1],i=(0,a.useState)(!0),u=(0,o.Z)(i,2),d=u[0],f=u[1],m=(0,a.useState)("manual"),p=(0,o.Z)(m,2),v=p[0],g=p[1],h=(0,r.UO)(),E=h.resourceDataKitId,x=h.assetsDataKitId;return a.default.createElement(a.default.Fragment,null,a.default.createElement(y.X2,{flex:!0,justify:"space-between",align:"center",style:{margin:"4px 0 0 0",padding:0}},a.default.createElement(D.Z,{span:10},a.default.createElement(s.Z,{type:"flex",align:"middle",gutter:[0,24],justify:"space-between"},a.default.createElement(D.Z,{span:12},a.default.createElement(Sn,{resourceDataKitId:E,mode:n,setMode:l})),a.default.createElement(D.Z,{span:1}),a.default.createElement(D.Z,{span:11},a.default.createElement(y.X2,{flex:!0,direction:"row",align:"center"},a.default.createElement(c.uT,{level:2},"Show low confidence matches"),a.default.createElement(c.rs,{name:"confidence-switch",size:"small",value:d,onChange:f}))))),a.default.createElement(D.Z,{span:6},a.default.createElement(y.X2,{flex:!0,direction:"row",justify:"flex-end",align:"center"},a.default.createElement(Cn,{changeTab:function(e){return g(e)}}),a.default.createElement(Zn,null)))),a.default.createElement(y.X2,{flex:!0},a.default.createElement(U.Z,{renderTabBar:function(){return a.default.createElement(a.default.Fragment,null)},activeKey:v,style:{width:"100%"}},a.default.createElement(U.Z.TabPane,{key:"manual"},a.default.createElement(zn,{resourceDataKitId:E,assetsDataKitId:x,queryFilter:function(e){var t,n;return(null!==(t=null===(n=e.matches[0])||void 0===n?void 0:n.score)&&void 0!==t?t:0)>=.5||!!d},mode:n})),a.default.createElement(U.Z.TabPane,{key:"rules"},a.default.createElement(Wn,{resourceDataKitId:E,assetsDataKitId:x,mode:n})))))}function na(){var e=(0,r.UO)(),t=e.resourceDataKitId,n=e.assetsDataKitId;return a.default.createElement(ea,{resourceDataKitId:t,assetDataKitId:n})}var aa=(0,d.default)(U.Z).withConfig({displayName:"datastudio__TabsStyled",componentId:"datastudio__sc-14auqu9-0"})(["&&&{width:100%;}&&& .ant-tabs-tab{padding:16px 0;}&&& .ant-tabs-ink-bar{background-color:",";height:4px;}"],c.wL["midblue-3"].hex());function la(){var e=(0,r.k6)(),t=(0,l.I0)(),n=(0,r.UO)(),i=n.resourceDataKitId,u=n.assetsDataKitId,d=n.modelId,s=n.predictId,f=n.ruleId,m=n.changed,v=e.location.search,g=ln.parse(v).tab,h=void 0===g?"edit":g,E=(0,r.$B)("/:project/:path"),x=(0,a.useState)(h),I=(0,o.Z)(x,2),w=I[0],b=I[1],k=(0,a.useMemo)((function(){return(0,rn._r)(u,i)}),[u,i]),S=(0,a.useMemo)((function(){return(0,ue.Mz)(i,u)}),[i,u]),Z=(0,a.useMemo)((function(){return(0,se.Vu)(i,!0)}),[i]),C=(0,l.v9)(S),D=(0,l.v9)(k),T=(0,l.v9)(Z).filter((function(e){return!C[e.id]&&!e.assetId})).length;return(0,a.useEffect)((function(){(0,Y.t5)(Y.YY.results.tab,{activeTab:w})}),[w]),(0,a.useEffect)((function(){return function(){t((0,rn.mc)(u,i))}}),[t,u,i]),(0,a.useEffect)((function(){m?e.replace("/".concat(null==E?void 0:E.params.project,"/").concat(null==E?void 0:E.params.path,"/").concat(i,"/").concat(u)):t((0,rn.fq)(u,i,d,s,f))}),[u,i,d,s,f]),a.default.createElement(un,{selector:function(e){var t;return!!e.selection.items[u]&&!!e.selection.items[i]&&!(null===(t=e.contextualization.predictions[i])||void 0===t||!t.config)},missingMessage:a.default.createElement(rt.Z,{type:"error",message:"Could not find the specified Data Kit, please start the entity matching process from the beginning."})},a.default.createElement(vn,{assetDataKitId:u,resourceDataKitId:i}),D?void 0:a.default.createElement(a.default.Fragment,null,a.default.createElement(y.X2,{flex:!0},a.default.createElement(c.Dx,{level:3},"Review the results")),a.default.createElement(y.X2,{flex:!0},a.default.createElement(aa,{defaultActiveKey:"edit",onChange:function(t){var n=ln.parse(window.location.search);b(t),e.push({search:ln.stringify((0,p.Z)((0,p.Z)({},n),{},{tab:t}))})}},a.default.createElement(U.Z.TabPane,{key:"edit",tab:a.default.createElement(a.default.Fragment,null,a.default.createElement(c.Dx,{level:5},"Unmatched resources"),a.default.createElement(c.uT,{level:2},T))},a.default.createElement(ta,null)),a.default.createElement(U.Z.TabPane,{key:"draft",tab:a.default.createElement(a.default.Fragment,null,a.default.createElement(c.Dx,{level:5},"Drafted changes"),a.default.createElement(c.uT,{level:2},Object.keys(C).length))},a.default.createElement(na,null)))),a.default.createElement(In,null)))}var ra=(0,d.default)(c.Ph).withConfig({displayName:"datastudio__Select",componentId:"datastudio__sc-1clsb1x-0"})(["&&&{width:300px;font-size:14px;}"]),ia=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-1clsb1x-1"})(["&&&{}"]);function ua(e){var t=e.mode,n=e.setMode,r=(0,l.v9)((function(e){return e.contextualization.pipelines.active.matches})),i=function(e){return a.default.createElement(y.kC,{column:!0,style:{alignItems:"flex-start",lineHeight:"1em"}},a.default.createElement("span",{style:{fontWeight:600}},kn[e].name),a.default.createElement("span",{style:{fontSize:"0.8em"}},null==r?void 0:r.filter((function(t){return function(e,t){return kn[t].filter({source:e.source,target:e.target,type:e.matchType})}(t,e)})).length))},u={all:{value:"all",label:i("all")},confirmed:{value:"confirmed",label:i("confirmed")},matched:{value:"matched",label:i("matched")},unmatched:{value:"unmatched",label:i("unmatched")},diff:{value:"diff",label:i("diff")}};return a.default.createElement(sa,null,a.default.createElement(ra,{title:"Type",defaultValue:u.all,value:u[t],options:Object.values(u),onChange:function(e){n(e.value)},menuPortalTarget:(0,I.ZO)(),closeMenuOnSelect:!0,onClick:function(e){e.preventDefault(),e.stopPropagation()}}))}function oa(e){var t=e.onlyHighConfidence,n=e.setOnlyHighConfidence,l=t?"high":"all",r={all:{value:"all",label:"All scores"},high:{value:"high",label:"Only high score"}};return a.default.createElement(sa,null,a.default.createElement(ra,{title:"Confidence",defaultValue:r.high,value:r[l],options:Object.values(r),menuPortalTarget:(0,I.ZO)(),closeMenuOnSelect:!0,onChange:function(e){n("high"===e)},onClick:function(e){e.preventDefault(),e.stopPropagation()}}))}function ca(e){var t=e.pipelineId,n=(0,l.I0)(),r=(0,l.v9)((function(e){return e.contextualization.pipelines.active.stagedChanges&&e.contextualization.pipelines.active.stagedChanges.length>0}));return a.default.createElement(c.u,{content:r?"Dismiss all drafted matches. You can draft them again later":"You have no drafted changes to dismiss"},a.default.createElement(c.zx,{disabled:!r,onClick:function(){n((0,xt.kA)(t))},style:{padding:"12px 32px"}},"Unstage all"))}function da(e){var t=e.changeTab,n=(0,a.useState)(!1),l=(0,o.Z)(n,2),r=l[0],i=l[1];return(0,a.useEffect)((function(){t(r?"rules":"manual")}),[r,t]),a.default.createElement(a.default.Fragment,null,a.default.createElement(c.uT,{level:2},"Group by pattern"),a.default.createElement(c.rs,{name:"rules-switch",size:"small",value:r,onChange:i,style:{margin:"0 20px"}}))}function sa(e){var t=e.children;return a.default.createElement(ia,{onClick:function(e){e.preventDefault(),e.stopPropagation()}},t)}var fa=[{title:"Resource",dataIndex:"resourceName"},{title:"Existing asset id",dataIndex:"oldAssetId"},{title:"New asset id",dataIndex:"assetId"}];function ma(e){var t=e.visible,n=e.confirmed,l=e.onClose,r=[],i=[].map((function(e){var t=r[e.resourceId];return null!=t&&t.assetId&&(null==t?void 0:t.assetId)!==e.assetId?(0,p.Z)((0,p.Z)({},e),{},{oldAssetId:null==t?void 0:t.assetId}):(0,p.Z)((0,p.Z)({},e),{},{oldAssetId:void 0})})).filter((function(e){return!!e.oldAssetId}));return a.default.createElement(lt.Z,{title:"Confirm overwriting asset IDs",visible:t,onOk:function(){n(),l()},onCancel:function(){return l()},width:1e3},a.default.createElement("p",null,"The following resources already have an asset id that will be overwritten!"),a.default.createElement(T.Z,{rowKey:"resourceId",columns:fa,dataSource:i,size:"small"}))}var pa=(0,d.default)(c.zx).withConfig({displayName:"datastudio__Button",componentId:"datastudio__wl0ye-0"})(["&&&{padding:16px 32px;}"]);function va(){var e=(0,r.k6)(),t=(0,l.I0)(),n=(0,r.UO)().pipelineId,i=(0,a.useState)(!1),u=(0,o.Z)(i,2),d=u[0],f=u[1],p=(0,a.useState)(!1),v=(0,o.Z)(p,2),g=v[0],h=v[1],E=(0,a.useState)(!1),x=(0,o.Z)(E,2),I=x[0],w=x[1],b=(0,l.v9)((function(e){return e.contextualization.pipelines.active})),k=b.stagedChanges,S=b.writingChanges,Z=b.writeError,C=b.success,D=b.error,T=(0,l.v9)((function(e){return e.contextualization.pipelines.items.find((function(e){return String(e.id)===n}))||e.contextualization.pipelines.active})),_=[],N=k.filter((function(e){var t=_[e.sourceId];return(null==t?void 0:t.assetId)&&e.targetId!==(null==t?void 0:t.assetId)})).length>0;(0,a.useEffect)((function(){C&&ze.Z.info({message:"Pipeline successfully updated!"}),D&&ze.Z.error({message:"An error occurred while trying to save pipeline."})}),[C,D]),(0,a.useEffect)((function(){d&&!S&&(!1===Z&&(ze.Z.info({message:"Changes successfully saved to CDF!"}),f(!1)),!0===Z&&(ze.Z.error({message:"An error occurred while trying to save to CDF."}),f(!1)))}),[d,S,Z]);var M=function(){(0,Y.t5)(Y.YY.pipeline.saveToCdf),f(!0),t((0,xt.Qq)())},F=0===k.length;return a.default.createElement(m,{justify:"space-between"},a.default.createElement(ma,{visible:I,confirmed:function(){return M()},onClose:function(){return w(!1)}}),a.default.createElement(_t,{type:"save",visible:g,pipeline:T,onCancel:function(){return h(!1)},onOk:function(e,a){t((0,xt.xr)(Number(n),{name:e,description:a})),h(!1)}}),a.default.createElement(s.Z,{type:"flex",justify:"start",align:"middle"},a.default.createElement(pa,{style:{marginRight:"16px"},onClick:function(){return h(!0)}},"Save this pipeline"),a.default.createElement(c.u,{placement:"top",content:F?"You have no drafted changes to download":"Download the drafted changes as a JSON file"},a.default.createElement(y.hU,{icon:"Download",onClick:function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(k)],{type:"text/json"});e.href=window.URL.createObjectURL(t),e.download="staged_".concat(n,".json"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},disabled:F,type:"secondary",square:!0}))),a.default.createElement(s.Z,{type:"flex",justify:"end",align:"middle"},a.default.createElement(pa,{variant:"ghost",onClick:function(){return e.goBack()}},"Back"),a.default.createElement(c.u,{content:F?"You have no drafted changes to save to CDF":"Save all the drafted changes to CDF"},a.default.createElement(pa,{onClick:function(){N?w(!0):M()},disabled:F,type:"primary",style:{marginLeft:"8px"}},"Save to CDF"))))}function ga(e){var t,n,l=e.rule,r=e.entitySet;return a.default.createElement(a.default.Fragment,null,null!==(t=null==l||null===(n=l.extractors)||void 0===n?void 0:n.filter((function(e){return e.entitySet===r})).map((function(e,t){var n,l,r=null!==(n=null==e?void 0:e.fixedPattern)&&void 0!==n?n:null==e?void 0:e.pattern;return a.default.createElement(y.X2,{flex:!0,direction:"column",key:"pattern-".concat(t.toString())},a.default.createElement(c.F,{style:{userSelect:"none"}},null!==(l=null==e?void 0:e.field)&&void 0!==l?l:"-"),a.default.createElement(c.uT,{level:1,style:{fontWeight:500,fontFamily:"monospace"}},null!=r?r:"-"))})))&&void 0!==t?t:null)}function ha(e){var t,n=(0,l.I0)(),i=(0,r.UO)().pipelineId,u=e.rule,o=e.style,d=e.drafted,s=(0,l.v9)((function(e){var t,n;return null===(t=e.contextualization.pipelines)||void 0===t||null===(n=t.active)||void 0===n?void 0:n.stagedChanges})),f=(0,l.v9)((function(e){return e.dataSets.items})),m=d?null==u||null===(t=u.matches)||void 0===t?void 0:t.filter((function(e){return null==s?void 0:s.find((function(t){return t.rule===u.index&&t.sourceId===e.source.id&&t.targetId===e.target.id}))})):null==u?void 0:u.matches,p=function(e){var t=null==m?void 0:m.find((function(t){return t.source.id===e}));t?n((0,xt.vH)(Number(i),[{sourceId:t.source.id,targetId:t.target.id,rule:u.index}])):ze.Z.error({message:"Something went wrong."})};(0,a.useEffect)((function(){0===Object.keys(f).length&&n((0,v.pb)())}),[n,f]);var g=[{title:d?"Source":"Does this resource match...",dataIndex:"",key:"column-from",width:"30%",render:function(e,t,n){return Object.entries(e.source).filter((function(e){return"id"!==e[0]})).map((function(e,t){var l;return a.default.createElement(y.X2,{flex:!0,direction:"column",style:{margin:0},key:"edit-rule-match-".concat(n.toString(),"-source-").concat(t.toString())},a.default.createElement(c.F,{style:{userSelect:"none"}},null!==(l=e[0])&&void 0!==l?l:"-"),a.default.createElement(c.uT,{level:2,style:{fontWeight:500,marginBottom:"4px"}},e[1]))}))}},{title:d?"Target":"...to this asset?",dataIndex:"",key:"column-to",width:"30%",render:function(e,t,n){return Object.entries(e.target).filter((function(e){return"id"!==e[0]})).map((function(e,t){var l;return a.default.createElement(y.X2,{flex:!0,direction:"column",key:"edit-rule-match-".concat(n.toString(),"-target-").concat(t.toString())},a.default.createElement(c.F,{style:{userSelect:"none"}},null!==(l=e[0])&&void 0!==l?l:"-"),a.default.createElement(c.uT,{level:2,style:{fontWeight:500,marginBottom:"4px"}},e[1]))}))}},{title:"Type",key:"type",align:"center",render:function(e){var t=null==e?void 0:e.source,n=null==e?void 0:e.target,l=null==e?void 0:e.existingMatchType;return a.default.createElement(c.uT,{level:2},bn({source:t,target:n,type:l}))},sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.matchType,null==t?void 0:t.matchType)}},{title:d?"Unstage":"Confirm",dataIndex:"",key:"confirmation",width:130,align:"center",render:function(e){return a.default.createElement(y.X2,{flex:!0,justify:"center",style:{margin:"8px 0"}},d?a.default.createElement(y.hU,{icon:"Close",square:!0,onClick:function(){return p(e.source.id)}}):a.default.createElement(c.XZ,{name:"checkbox-".concat(e.source.id,"-rules"),value:(t=e.source.id,s&&!!s.find((function(e){return e.sourceId===t}))),onChange:function(t){return t?function(e){var t=null==m?void 0:m.find((function(t){return t.source.id===e}));t?((0,Y.t5)(Y.YY.manualMatching.apply,{sourceId:t.source.id,targetId:t.target.id,pipelineId:i}),n((0,xt.l$)(Number(i),[{sourceId:t.source.id,targetId:t.target.id,rule:u.index}]))):ze.Z.error({message:"Something went wrong."})}(e.source.id):p(e.source.id)}}));var t}}];return a.default.createElement(y.iA,{pagination:{defaultPageSize:10,hideOnSinglePage:!0},dataSource:m,columns:g,rowKey:function(e,t){return"match-".concat(t.toString(),d?"-rules-drafted":"-rules")},style:o,options:e.options})}var Ea=jn.Z.Panel,ya=(0,d.default)(jn.Z).withConfig({displayName:"datastudio__Collapse",componentId:"datastudio__sc-1h4wl6i-0"})(["&&&{border:0;}&&& .ant-collapse-item{border-bottom:0;}"]),xa=(0,d.default)(Ea).withConfig({displayName:"datastudio__CollapsePanel",componentId:"datastudio__sc-1h4wl6i-1"})(["&&& .ant-collapse-content{border-top:0;}&&& .ant-collapse-content > .ant-collapse-content-box{padding:0;}"]);function Ia(){var e=(0,l.v9)((function(e){return e.contextualization.pipelines.active.stagedChanges}));return(0,a.useEffect)((function(){}),[!1]),null!=e&&e.length?a.default.createElement(a.default.Fragment,null,a.default.createElement(wa,null),a.default.createElement(ba,null)):a.default.createElement(y.aK,{content:'You have no drafted changes! Go to the "Unmatched Resources" tab and choose some resources.'})}function wa(){var e,t=(0,l.I0)(),n=(0,r.UO)().pipelineId,i=(0,l.v9)((function(e){return e.contextualization.pipelines.active})).matches,u=(0,l.v9)((function(e){return e.contextualization.pipelines.active.stagedChanges.filter((function(e){return void 0===e.rule}))})),o=[{title:"Source",dataIndex:"",key:"column-source-manual-staged",render:function(e){var t,n,l,r=null==i?void 0:i.find((function(t){return t.source.id===e.sourceId})),u=!(null==r||null===(t=r.source)||void 0===t||!t.name),o=u?"Name":"External ID",d=u?null==r||null===(n=r.source)||void 0===n?void 0:n.name:null==r||null===(l=r.source)||void 0===l?void 0:l.externalId;return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.F,{style:{userSelect:"none"}},o),a.default.createElement(c.uT,{level:2,style:{fontWeight:500}},null!=d?d:"-"))}},{title:"Target",dataIndex:"",key:"column-targed-manual-staged",render:function(e){var t,n,l,r=null==i?void 0:i.find((function(t){return t.target.id===e.targetId})),u=!(null==r||null===(t=r.target)||void 0===t||!t.name),o=u?"Name":"External ID",d=u?null==r||null===(n=r.target)||void 0===n?void 0:n.name:null==r||null===(l=r.target)||void 0===l?void 0:l.externalId;return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.F,{style:{userSelect:"none"}},o),a.default.createElement(c.uT,{level:2,style:{fontWeight:500}},null!=d?d:"-"))}},{title:"Unstage",dataIndex:"",key:"confirmation",width:100,align:"center",render:function(e){return a.default.createElement(y.X2,{flex:!0,justify:"center",style:{margin:"8px 0"}},a.default.createElement(y.hU,{icon:"Close",square:!0,onClick:function(){return d(e)}}))}}],d=function(e){var a={sourceId:e.sourceId,targetId:e.targetId};t((0,xt.vH)(Number(n),[a]))},s=a.default.createElement(y.X2,{flex:!0,justify:"space-between",align:"center",style:{margin:0}},a.default.createElement(c.Dx,{level:4},"Manual matching"),a.default.createElement(c.zx,{onClick:function(e){e.stopPropagation(),t((0,xt.vH)(Number(n),u))},type:"danger"},"Unstage all ",null!==(e=null==u?void 0:u.length)&&void 0!==e?e:"-"," matches"));return null!=u&&u.length?a.default.createElement(ya,{style:{margin:"8px 0"}},a.default.createElement(xa,{header:s,key:"test"},a.default.createElement(y.iA,{pagination:{defaultPageSize:10,hideOnSinglePage:!0},dataSource:u,columns:o,rowKey:function(e){return"".concat(e.sourceId,"-manual-staged")},options:{narrow:!0,secondary:!0}}))):null}function ba(){var e,t=(0,l.I0)(),n=(0,r.UO)().pipelineId,i=(0,l.v9)((function(e){return e.contextualization.pipelines.active})).rules,u=(0,l.v9)((function(e){return e.contextualization.pipelines.active.stagedChanges.filter((function(e){return void 0!==e.rule}))})),o=(0,C.Z)(new Set(null==u?void 0:u.map((function(e){return e.rule})))),d=[{title:"Source",dataIndex:"",key:"column-source-manual-staged",render:function(e){return a.default.createElement(ga,{rule:i[e],entitySet:"sources"})}},{title:"Target",dataIndex:"",key:"column-target-manual-staged",render:function(e){return a.default.createElement(ga,{rule:i[e],entitySet:"targets"})}},{title:"Staged matches",dataIndex:"",key:"column-nrofmatches-manual-staged",width:150,render:function(e){var t,n=null===(t=u.filter((function(t){return t.rule===e})))||void 0===t?void 0:t.length;return a.default.createElement(y.X2,{flex:!0,justify:"center",align:"center"},a.default.createElement(c.Ct,{text:n}))}},{title:"Unstage all",dataIndex:"",key:"confirmation",width:150,align:"center",render:function(e){return a.default.createElement(y.X2,{flex:!0,justify:"center",style:{margin:"8px 0"}},a.default.createElement(y.hU,{icon:"Close",square:!0,onClick:function(){return s(e)}}))}}],s=function(e){var a=u.filter((function(t){return t.rule===e}));t((0,xt.vH)(Number(n),a))},f=a.default.createElement(y.X2,{flex:!0,justify:"space-between",align:"center",style:{margin:0}},a.default.createElement(c.Dx,{level:4},"Rules"),a.default.createElement(c.zx,{onClick:function(e){e.stopPropagation(),t((0,xt.vH)(Number(n),u))},type:"danger"},"Unstage all ",null!==(e=null==u?void 0:u.length)&&void 0!==e?e:"-"," matches"));return null!=u&&u.length?a.default.createElement(ya,{style:{margin:"8px 0"}},a.default.createElement(xa,{header:f,key:"test"},a.default.createElement(y.iA,{pagination:{defaultPageSize:10,hideOnSinglePage:!0},dataSource:o,columns:d,rowKey:function(e){return"".concat(e,"-rule-staged")},options:{narrow:!0,secondary:!0},expandedRowRender:function(e){var t=(0,p.Z)((0,p.Z)({},i[e]),{},{index:e});return a.default.createElement(y.X2,{flex:!0,style:{margin:0}},a.default.createElement(ha,{rule:t,options:{secondary:!0,narrow:!0},style:{width:"100%"},drafted:!0}))},expandIcon:function(e){return a.default.createElement(y.qp,{record:e})}}))):null}var ka=n(91036),Sa=d.default.div.withConfig({displayName:"datastudio__Menu",componentId:"datastudio__utkdx3-0"})(["&&&{cursor:default;background-color:",";border-radius:4px;box-shadow:0px 8px 16px rgba(0,0,0,0.07),0px 3px 10px rgba(0,0,0,0.02),0px 1px 3px rgba(0,0,0,0.02);}"],c.wL.white.hex()),Za=d.default.div.withConfig({displayName:"datastudio__Results",componentId:"datastudio__utkdx3-1"})(["&&&{}"]),Ca=d.default.div.withConfig({displayName:"datastudio__Section",componentId:"datastudio__utkdx3-2"})(["&&&{display:flex;flex-direction:column;padding:16px 16px 0 16px;}&&& .cogs-body-2{margin-bottom:4px;}"]),Da=(0,d.default)(y.X2).attrs((function(e){var t={};return e.selected&&(t.backgroundColor=c.wL["midblue-7"].hex()),{style:t}})).withConfig({displayName:"datastudio__AssetToMatch",componentId:"datastudio__utkdx3-3"})(["&&&{padding:10px 16px;margin:0;cursor:pointer;}&&&:hover{background-color:",";}"],c.wL["midblue-7"].hex());function Ta(e){var t,n,r,i,u,d=e.match,s=(0,l.I0)(),f=(0,a.useState)(""),m=(0,o.Z)(f,2),p=m[0],v=m[1],g=(0,a.useState)(p),h=(0,o.Z)(g,2),E=h[0],x=h[1],I=(0,a.useState)(void 0),w=(0,o.Z)(I,2),b=w[0],k=w[1],S=(0,l.v9)((function(e){return e.contextualization.pipelines.active})),Z=(0,ka.Z)(x,500),C=(0,o.Z)(Z,1)[0],D=function(e){var t;return{limit:100,search:e.length>0?{query:e}:{},filter:{dataSetIds:null===(t=S.targets)||void 0===t?void 0:t.dataSetIds}}},T=(0,l.v9)(_n.yn)(D(E)),_=T.items,N=T.fetching,M=(0,l.v9)((function(e){return e.dataSets.items})),F=(0,a.useCallback)((function(e){v(e.target.value),C(e.target.value)}),[C]);(0,a.useEffect)((function(){if(E.length>0){var e=D(E);s((0,_n.yC)(e)),(0,Y.t5)(Y.YY.manualMatching.assetSearch,{query:e})}}),[s,E]);var A=_.slice(0,5).map((function(e){var t;return a.default.createElement(Da,{flex:!0,direction:"column",selected:(null==b?void 0:b.id)===e.id,onClick:function(){return k(e)}},a.default.createElement(c.uT,{level:2,strong:!0},null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"<NO NAME>"),(null==e?void 0:e.description)&&a.default.createElement(c.uT,{level:2},e.description))})),O=null===(t=S.targets)||void 0===t?void 0:t.dataSetIds.filter((function(e){var t;return null===(t=M[e.id])||void 0===t?void 0:t.name})).map((function(e){var t=M[e.id].name||"unknown data set";return a.default.createElement(c.Ct,{text:t,key:e.id})})),K=N?a.default.createElement(y.X2,{style:{padding:"16px 16px 12px 16px"}},a.default.createElement(c.JO,{type:"Loader"})):a.default.createElement(Ta.Results,null,a.default.createElement(c.Dx,{level:5,style:{padding:"16px 16px 12px 16px"}},"Results ",a.default.createElement(c.Ct,{text:null!==(n=null==_?void 0:_.length.toString())&&void 0!==n?n:"0"})),A," ");return a.default.createElement(Sa,null,(null===(r=d.userTarget)||void 0===r?void 0:r.id)&&a.default.createElement(Ta.Section,null,a.default.createElement(c.uT,{level:2,strong:!0},"Original asset selection"),a.default.createElement(c.uT,{level:2,style:{marginTop:"12px",marginBottom:"24px"}},null!==(i=null===(u=d.target)||void 0===u?void 0:u.name)&&void 0!==i?i:"<no name>"),a.default.createElement(y.hU,{icon:"Refresh",type:"secondary",onClick:function(){null!=S&&S.id&&s((0,xt.HK)(S.id,d.source.id))}},"Restore default selection")),a.default.createElement(Ta.Section,null,a.default.createElement(c.uT,{level:2,strong:!0},"Search"),a.default.createElement(c.II,{placeholder:"Search by keyboard",onChange:F,value:p})),a.default.createElement(Ta.Section,null,a.default.createElement(c.uT,{level:2,strong:!0},"Datasets"),a.default.createElement(c.uT,{level:2,style:{marginTop:"12px",marginBottom:"24px"}},null!=O&&O.length?O:a.default.createElement(c.JO,{type:"Loader"}))),!(null==p||!p.length)&&!(null==E||!E.length)&&K,a.default.createElement(Ta.Section,{style:{alignItems:"flex-end",paddingBottom:"16px"}},a.default.createElement(c.zx,{type:"primary",disabled:!b,onClick:function(){b&&null!=S&&S.id&&((0,Y.t5)(Y.YY.manualMatching.apply,{resourceName:d.source.name||"",assetName:b.name}),s((0,xt.zJ)(S.id,b,d.source.id)))}},"Confirm")))}function _a(e){var t=e.score,n=t?"".concat(Math.round(100*t),"%"):"0%";return a.default.createElement(y.kC,{justify:!0},a.default.createElement("span",{style:{fontWeight:600,maxWidth:"100px"}},n))}Ta.Results=Za,Ta.Section=Ca;var Na=(0,d.default)(c.uT).withConfig({displayName:"datastudio__HoverableBody",componentId:"datastudio__sc-4etl55-0"})(["&&&{display:flex;flex-direction:row;user-select:none;}"]),Ma=d.default.div.withConfig({displayName:"datastudio__Hover",componentId:"datastudio__sc-4etl55-1"})(["&&&:hover{background-color:",";}"],c.wL["greyscale-grey3"].hex()),Fa=(0,d.default)(zt.Z).withConfig({displayName:"datastudio__Dropdown",componentId:"datastudio__sc-4etl55-2"})(["&&&{margin:0;padding:0;}"]);function Aa(e){var t=e.pipelineId,n=e.dataSource,r=e.style,i=(0,l.I0)(),u=(0,a.useState)("all"),d=(0,o.Z)(u,2),s=d[0],f=d[1],m=(0,a.useState)(!0),p=(0,o.Z)(m,2),g=p[0],h=p[1],E=(0,a.useState)(),x=(0,o.Z)(E,2),w=x[0],b=x[1],k=(0,a.useState)(),S=(0,o.Z)(k,2),Z=S[0],C=S[1],D=(0,a.useState)(void 0),T=(0,o.Z)(D,2),_=T[0],N=T[1],M=(0,l.v9)((function(e){var t,n=null===(t=e.contextualization.pipelines)||void 0===t?void 0:t.fetch;return n.start||!n.success||n.error?n.start||n.success||!n.error?"running":"error":"success"})),F=function(e){var t;return(null!==(t=null==e?void 0:e.score)&&void 0!==t?t:0)>=.5||!g},A=(0,l.v9)((function(e){var t,n;return null===(t=e.contextualization.pipelines)||void 0===t||null===(n=t.active)||void 0===n?void 0:n.stagedChanges})),O=(0,l.v9)((function(e){var t;return null!=n?n:null===(t=e.contextualization.pipelines.active.matches)||void 0===t?void 0:t.filter((function(e){return kn[s].filter({source:e.source,target:e.target,type:e.matchType})&&(!F||F(e))}))})),K=(0,l.v9)((function(e){return e.dataSets.items}));(0,a.useEffect)((function(){0===Object.keys(K).length&&i((0,v.pb)())}),[]);var z=[{title:"Does this resource match...",key:"column-from",width:"25%",render:function(e){var t,n,l,r=!(null==e||null===(t=e.source)||void 0===t||!t.name),i=r?"Name":"External ID",u=r?null==e||null===(n=e.source)||void 0===n?void 0:n.name:null==e||null===(l=e.source)||void 0===l?void 0:l.externalId;return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.F,{style:{userSelect:"none"}},i),a.default.createElement(c.uT,{level:2,style:{fontWeight:500}},null!=u?u:"-"))}},{title:"...to this asset?",key:"column-to",width:"25%",render:function(e){var t,n,l,r,i,u,o=!(null==e||null===(t=e.target)||void 0===t||!t.name),d=o?"Name":"External ID",s=o?null==e||null===(n=e.target)||void 0===n?void 0:n.name:null==e||null===(l=e.target)||void 0===l?void 0:l.externalId,f=null!==(r=e.userTarget)&&void 0!==r&&r.id?e.userTarget:e.target;return a.default.createElement("div",{style:{display:"flex",flexDirection:"row",position:"relative"}},a.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.default.createElement(c.F,{style:{userSelect:"none"}},d),a.default.createElement(Na,{level:2,style:{fontWeight:500}},a.default.createElement(Ma,{onClick:function(){_===e.source.id?N(void 0):N(e.source.id)}},null!=s?s:"<no name>"))),_===(null==e||null===(i=e.source)||void 0===i?void 0:i.id)&&a.default.createElement(Fa,{overlay:a.default.createElement(Ta,{match:e}),trigger:["click"],getPopupContainer:function(e){return e.parentNode},className:"z-12",key:"dropdown-".concat(null!==(u=null==f?void 0:f.id)&&void 0!==u?u:"unknown")},a.default.createElement(y.hU,{type:"secondary",icon:"Refresh",style:{padding:"8px",marginLeft:"8px"}},"Change")))}},{title:function(){return a.default.createElement(ua,{mode:s,setMode:f})},key:"type",align:"center",render:function(e){var t=e.source,n=e.target,l=e.matchType;return a.default.createElement(c.uT,{level:2},bn({source:t,target:n,type:l}))},sorter:function(e,t){var n=bn({source:e.source,target:e.target,type:e.type}),a=bn({source:t.source,target:t.target,type:t.type});return(0,I.$K)(n,a)}},{title:function(){return a.default.createElement(oa,{onlyHighConfidence:g,setOnlyHighConfidence:h})},key:"confidence",align:"center",width:300,render:function(e){return a.default.createElement(_a,{score:null==e?void 0:e.score})},sorter:function(e,t){var n,a;return(null!==(n=null==e?void 0:e.score)&&void 0!==n?n:0)-(null!==(a=null==t?void 0:t.score)&&void 0!==a?a:0)},sortDirections:["descend","ascend"],defaultSortOrder:"descend"},{title:"Confirm",key:"confirmation",width:130,align:"center",render:function(e){return a.default.createElement(c.XZ,{name:"checkbox-".concat(e.source.id,"-manual"),value:(n=e.source.id,A&&!!A.find((function(e){return e.sourceId===n}))),onChange:function(n){return n?function(e){var n,a,l=null==O?void 0:O.find((function(t){return t.source.id===e.source.id}));if(l){var r=null!==(n=l.userTarget)&&void 0!==n&&n.id?l.userTarget:l.target;(0,Y.t5)(Y.YY.manualMatching.apply,{resourceName:(null===(a=l.source)||void 0===a?void 0:a.name)||"",assetName:null==r?void 0:r.name,pipelineId:t}),i((0,xt.l$)(t,[{sourceId:l.source.id,targetId:r.id}]))}else ze.Z.error({message:"Something went wrong."})}(e):function(e){var n=null==O?void 0:O.find((function(t){return t.source.id===e.source.id}));n?i((0,xt.vH)(t,[{sourceId:n.source.id,targetId:n.target.id}])):ze.Z.error({message:"Something went wrong."})}(e)}});var n}}];return"success"===M?a.default.createElement(a.default.Fragment,null,w&&a.default.createElement(Mn,{onClose:function(){return b(void 0)},timeseriesId:w}),Z&&a.default.createElement(Fn,{onClose:function(){return C(void 0)},assetId:Z}),a.default.createElement(y.iA,{pagination:{defaultPageSize:10},dataSource:O,columns:z,expandedRowRender:function(e){return a.default.createElement(On,{key:"source-".concat(e.source.id,"-target-").concat(e.target.id,"-connection"),match:e})},expandIcon:function(e){return a.default.createElement(y.qp,{record:e})},rowKey:function(e){return"".concat(e.source.id,"-manual")},style:r,options:e.options})):"error"===M?a.default.createElement(rt.Z,{type:"error",message:"There was an error fetching matches. Please try running the pipeline again."}):a.default.createElement(y.kC,{row:!0,style:{height:"50vh"}},a.default.createElement(y.aN,null))}function Oa(e){var t=(0,l.I0)(),n=e.pipelineId,r=(0,a.useMemo)((function(){return[]}),[]);(0,a.useEffect)((function(){t((0,_n.Jv)(r))}),[t,r]);var i=(0,a.useState)(),u=(0,o.Z)(i,2),c=u[0],d=u[1];return a.default.createElement(a.default.Fragment,null,c&&a.default.createElement(Mn,{onClose:function(){return d(void 0)},timeseriesId:c}),a.default.createElement(Aa,{pipelineId:n,options:{expandedRowPadding:!0}}))}function Ka(){var e=(0,l.I0)(),t=(0,r.UO)().pipelineId,n=(0,l.v9)((function(e){return e.contextualization.pipelines.active.rules})),i=(0,l.v9)((function(e){var t,n;return null===(t=e.contextualization.pipelines)||void 0===t||null===(n=t.active)||void 0===n?void 0:n.stagedChanges})),u=[{title:"#",dataIndex:"index",key:"pattern-index",width:"50px",render:function(e){return a.default.createElement(c.uT,{level:2,style:{color:c.wL["greyscale-grey6"].hex()}},e+1)}},{title:"Source",dataIndex:"",key:"pattern-source",render:function(e){return a.default.createElement(ga,{rule:e,entitySet:"sources"})}},{title:"Target",dataIndex:"",key:"pattern-target",render:function(e){return a.default.createElement(ga,{rule:e,entitySet:"targets"})}},{title:"Conflicts",dataIndex:"",key:"pattern-conflicts",align:"center",width:"150px",render:function(e){return 0===e.numConflicts?a.default.createElement(c.uT,{level:2,strong:!0},"No conflicts"):a.default.createElement(c.uT,{level:2,strong:!0,style:{color:c.wL.danger.hex()}},"".concat(e.numConflicts," conflict(s)"))},sorter:function(e,t){var n,a;return(null!==(n=null==e?void 0:e.numConflicts)&&void 0!==n?n:0)-(null!==(a=null==t?void 0:t.numConflicts)&&void 0!==a?a:0)}},{title:"Priority",dataIndex:"",key:"pattern-priority",align:"center",width:"150px",render:function(e){return a.default.createElement(c.uT,{level:2,strong:!0},e.priority)},sorter:function(e,t){var n,a;return(null!==(n=null==e?void 0:e.priority)&&void 0!==n?n:0)-(null!==(a=null==t?void 0:t.priority)&&void 0!==a?a:0)}},{title:"Confirm",dataIndex:"",key:"pattern-confirm",align:"center",width:"250px",render:function(n){var l,r,u,o=(u=n.index,i&&void 0!==u&&i.filter((function(e){return e.rule===u}))).length,d=o===n.matches.length,s=0!==o&&o<n.matches.length;return a.default.createElement(y.X2,{flex:!0,justify:"flex-end",align:"center",style:{padding:0}},"Confirm",a.default.createElement("span",{style:{fontWeight:"bold",margin:"0 4px"}},null!==(l=null==n||null===(r=n.matches)||void 0===r?void 0:r.length)&&void 0!==l?l:"-"),"matches",a.default.createElement(c.XZ,{name:"rule-index-".concat(n.index,"-confirm-all"),onChange:function(a){return function(n,a){var l=a.matches.map((function(e){return{sourceId:e.source.id,targetId:e.target.id,rule:a.index}}));n?((0,Y.t5)(Y.YY.pipeline.byPattern,{pipelineId:t,rerun:!1,rule:a}),e((0,xt.l$)(Number(t),l))):e((0,xt.vH)(Number(t),l))}(a,n)},value:d,indeterminate:s}))}}],o=n?n.filter((function(e){return e.matches.length>0})).map((function(e,t){return(0,p.Z)((0,p.Z)({},e),{},{index:t})})):[];return a.default.createElement(a.default.Fragment,null,0===o.length&&a.default.createElement(rt.Z,{type:"info",message:"No rules were generated."}),o.length>0&&a.default.createElement(y.iA,{pagination:{defaultPageSize:10},dataSource:o,columns:u,rowKey:function(e){return"".concat(e.index,"-row")},options:{narrow:!0},expandedRowRender:function(e){var t=e;return a.default.createElement(y.X2,{flex:!0,style:{margin:0}},a.default.createElement(ha,{rule:t,options:{secondary:!0,narrow:!0},style:{width:"100%"}}))},expandIcon:function(e){return a.default.createElement(y.qp,{record:e})}}))}function za(e){var t=e.id,n=e.activeTab,l=Number(t);return a.default.createElement(y.X2,{flex:!0},a.default.createElement(U.Z,{renderTabBar:function(){return a.default.createElement(a.default.Fragment,null)},activeKey:n,style:{width:"100%"}},a.default.createElement(U.Z.TabPane,{key:"manual"},a.default.createElement(Oa,{pipelineId:l})),a.default.createElement(U.Z.TabPane,{key:"rules"},a.default.createElement(Ka,null))))}var Pa=(0,d.default)(U.Z).withConfig({displayName:"datastudio__TabsStyled",componentId:"datastudio__sc-14pjcbn-0"})(["&&&{width:100%;}&&& .ant-tabs-tab{padding:16px 0;}&&& .ant-tabs-ink-bar{background-color:",";height:4px;}"],c.wL["midblue-3"].hex());function Ra(){var e=(0,r.k6)(),t=(0,l.I0)(),n=(0,r.UO)().pipelineId,i=e.location.search,u=ln.parse(i).tab,d=void 0===u?"edit":u,s=(0,a.useState)(d),f=(0,o.Z)(s,2),m=f[0],v=f[1],g=(0,a.useState)("manual"),h=(0,o.Z)(g,2),E=h[0],x=h[1],I=(0,a.useState)(!1),w=(0,o.Z)(I,2),b=w[0],k=w[1],S=(0,l.v9)((function(e){return e.contextualization.pipelines.fetch})),Z=(0,l.v9)((function(e){return e.contextualization.pipelines.items.find((function(e){return String(e.id)===n}))})),C=(0,l.v9)((function(e){return e.contextualization.pipelines.active.stagedChanges})),D=(0,l.v9)(xt.V8)(Number(n)).filter((function(e){var t;return!(null!==(t=e.item)&&void 0!==t&&t.assetId)})),T=null==Z?void 0:Z.lastJobId,_=!!Z;return(0,a.useEffect)((function(){(0,Y.t5)(Y.YY.results.tab,{activeTab:m})}),[m]),(0,a.useEffect)((function(){S.start||S.success||S.error||t((0,xt.pr)())}),[t,S]),(0,a.useEffect)((function(){!b&&T&&(t((0,xt.kE)(T)),k(!0)),t((0,xt.PJ)(Z))}),[b,T,Z,t]),_?b?a.default.createElement(a.default.Fragment,null,a.default.createElement(y.X2,{flex:!0},a.default.createElement(c.Dx,{level:3},"Review the results")),a.default.createElement(y.X2,{flex:!0,justify:"space-between"},a.default.createElement(Pa,{defaultActiveKey:"edit",onChange:function(t){var n=ln.parse(window.location.search);v(t),e.push({search:ln.stringify((0,p.Z)((0,p.Z)({},n),{},{tab:t}))})},tabBarExtraContent:a.default.createElement(y.X2,{flex:!0,direction:"row",justify:"flex-end",align:"center"},a.default.createElement(da,{changeTab:function(e){return x(e)}}),a.default.createElement(ca,{pipelineId:Number(n)}))},a.default.createElement(U.Z.TabPane,{key:"edit",tab:a.default.createElement(a.default.Fragment,null,a.default.createElement(c.Dx,{level:5},"Unmatched resources"),a.default.createElement(c.uT,{level:2},D.length))},a.default.createElement(za,{id:n,activeTab:E})),a.default.createElement(U.Z.TabPane,{key:"draft",tab:a.default.createElement(a.default.Fragment,null,a.default.createElement(c.Dx,{level:5},"Drafted changes"),a.default.createElement(c.uT,{level:2},Object.keys(C).length))},a.default.createElement(Ia,null)))),a.default.createElement(va,null)):a.default.createElement(c.aN,null):a.default.createElement(y.aK,{content:"Could not find pipeline for given pipeline id."})}var La=n(14591),Ya=n(95615);function Ba(){return a.default.createElement(Ya.ZP,{status:"success",title:"All resources are matched",subTitle:"All resources in this selection have an asset id, well done!"})}function Ua(e){var t=(0,r.k6)(),n=e.type,l=e.ready,i=e.handleCancel,u=e.handleContinue;return a.default.createElement(m,null,a.default.createElement(s.Z,{gutter:[0,24]},a.default.createElement(c.zx,{style:{marginRight:"20px"},type:"secondary",onClick:i,key:"cancelbutton"},"Cancel"),a.default.createElement(c.zx,{type:"secondary",onClick:function(){return t.goBack()},key:"backButton"},"Back")),a.default.createElement(c.u,{key:"continuebutton",content:l?"Run ".concat(n," with the chosen configuration"):"All properties have to be filled in before running the ".concat(n),placement:"bottom"},a.default.createElement(c.zx,{type:"primary",disabled:!l,onClick:u},"Run ",n)))}function Wa(e){var t=(0,l.I0)(),n=e.type,r=e.resourceDataKitId,i=e.assetsDataKitId,u=(0,l.v9)((function(e){var t=e.selection.items;return{typeFrom:t[r].type,typeTo:t[i].type}})),o=u.typeFrom,d=u.typeTo,s=(0,l.v9)((function(e){return(0,ue.LV)(e)(r)})).connections,f=(void 0===s?[]:s).map((function(e,t){return a.default.createElement(y.kC,{row:!0},a.default.createElement(ve,{key:e.id,resourceDataKitId:r,assetsDataKitId:i,connectionId:e.id,canDelete:0!==t}))}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.Dx,{level:3,style:{padding:0}},"Configure ",n),a.default.createElement(ne,{marginTop:24,title:"Select the fields for matching entities",description:a.default.createElement(a.default.Fragment,null,"By default, the model uses the similarity between name and description when it searches for matches.",a.default.createElement("br",null),"Create new connections between name, description, and available metadata fields with ",a.default.createElement("strong",null,"Add fields"),".",a.default.createElement("br",null)," ",a.default.createElement("strong",null,"Note:")," You can rerun the ",n," later.")}),a.default.createElement(y.kC,{column:!0},a.default.createElement(he,{typeFrom:o,typeTo:d}),f,a.default.createElement(c.zx,{type:"secondary",onClick:function(){return t((0,ue.HE)(r))},style:{alignSelf:"flex-start"}},"Add fields")))}var ja=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-1o9naed-0"})(["&&&{transition:max-height 0.3s ease-out;height:auto;}"]),qa=(0,d.default)(bt.ZP.Group).withConfig({displayName:"datastudio__RadioGroup",componentId:"datastudio__sc-1o9naed-1"})(["&&&{display:flex;flex-direction:row;flex-wrap:wrap;}&&& .ant-radio-button-wrapper{line-height:20px;border:1px solid ",";box-sizing:border-box;}&&& .ant-radio-button-wrapper:not(:first-child):before{display:none;}&&& .ant-radio-button-wrapper-checked{border-color:",";}&&& .ant-radio-button-wrapper-checked:not(:first-child){border-left:0;}&&& .ant-radio-button-wrapper-checked:not(.ant-radio-button-wrapper-disabled):before{display:none;}"],c.wL["greyscale-grey4"].hex(),c.wL["midblue-3"].hex()),Ja=(0,d.default)(bt.ZP.Button).withConfig({displayName:"datastudio__RadioButton",componentId:"datastudio__sc-1o9naed-2"})(["&&&{display:flex;flex-direction:column;box-sizing:border-box;max-width:328px;height:auto;margin-bottom:10px;border-radius:5px;padding:15px 19px 15px;margin-right:8px;}&&&:hover{background-color:",";border-color:",";color:",";}"],c.wL["midblue-8"].hex(),c.wL["midblue-4"].hex(),c.wL.black.hex()),Xa=[{value:"simple",title:"Simple",supervised:!1,description:"Calculates a similarity score based on each part of the name in the fields defined above. This is the fast option."},{value:"bigram",title:"Bigram",supervised:!0,description:"Calculates a similarity score influenced by the order of the terms in the name in the fields defined above. This is a slower option."},{value:"frequency-weighted-bigram",title:"Frequency weighted bigram",supervised:!0,description:"Calculates a similarity score based on the sequence of the terms in the resource name, giving higher weights to less commonly occuring tokens."},{value:"bigram-extra-tokenizers",title:"Bigram with extra tokenizers",supervised:!0,description:"Similar to bigram, but able to learn that case sensitivity does not matter, and leading zeros and spaces should be ignored in matching."},{value:"bigram-combo",title:"Combined features",supervised:!0,description:"Calculates all of the above options, relying on the machine learning model to determine the appropriate features to use. This is the slowest option."}];function Ha(e){var t=(0,l.I0)(),n=e.showMore,r=e.resourceDataKitId,i=e.onChange,u=(0,l.v9)((function(e){return(0,ue.LV)(e)(r)})),o=u.featureType,d=u.useTrueMatches;return(0,a.useEffect)((function(){d&&"simple"===o&&t((0,ue.yn)(r,"bigram-extra-tokenizers"))}),[d]),a.default.createElement(ja,null,a.default.createElement(qa,{onChange:function(e){return i(e.target.value)},value:o},(n?Xa.filter((function(e){return!d||e.supervised})):Xa.filter((function(e){return e.value===o}))).map((function(e){return a.default.createElement(Ja,{value:e.value,key:e.value},a.default.createElement(c.Dx,{level:5,style:{marginBottom:"8px"}},e.title),a.default.createElement(c.uT,{level:2},e.description))}))))}function Qa(e){var t=(0,l.I0)(),n=e.resourceDataKitId,r=(0,a.useState)(!1),i=(0,o.Z)(r,2),u=i[0],d=i[1];return a.default.createElement(y.kC,{column:!0},a.default.createElement(ne,{title:"Select the similarity scoring method",description:"Select how the model calculates the similarity scores. The similarity scores are used as input to the model when it tries to determine if a match-from and match-to pair is correct.",marginTop:40,marginBottom:24}),a.default.createElement(s.Z,{gutter:[0,24]},a.default.createElement(D.Z,{span:24},a.default.createElement(Ha,{showMore:u,resourceDataKitId:n,onChange:function(e){return t((0,ue.yn)(n,e))}}),a.default.createElement(c.zx,{onClick:function(){return d(!u)}},u?"Hide other methods":"Show more methods"))))}var $a=n(26648);function Ga(e){var t=(0,l.I0)(),n=e.scope,r=e.resourceDataKitId;return a.default.createElement(a.default.Fragment,null,a.default.createElement(ne,{title:"Scope",description:"Match only resources without an asset ID, or match all resources.",marginTop:40,marginBottom:24}),a.default.createElement(s.Z,{gutter:[0,24]},a.default.createElement(D.Z,null,a.default.createElement($a.ZP.Group,{value:n,onChange:function(e){return t((0,ue.Wr)(r,e.target.value))}},a.default.createElement($a.ZP,{value:"missingAssetId",style:{height:"20px",display:"block",lineHeight:"20px"}}," ","Unmatched only"),a.default.createElement($a.ZP,{style:{height:"20px",display:"block",lineHeight:"20px"},value:"none"}," ","All resources")))))}var Va=(0,d.default)(h.Z).withConfig({displayName:"datastudio__StyledCheckbox",componentId:"datastudio__sc-2r4jb2-0"})(["&&& .ant-checkbox-inner{border:1px solid ",";}&&& .ant-checkbox-checked .ant-checkbox-inner{border-color:",";}"],c.wL["greyscale-grey10"].hex(),c.wL.midblue.hex());function el(e){var t=(0,l.I0)(),n=e.resourceDataKitId,r=(0,l.v9)((function(e){return(0,ue.LV)(e)(n)})).useTrueMatches;return a.default.createElement(a.default.Fragment,null,a.default.createElement(ne,{title:"Model type",description:"By default an unsupervised model is used. If you wish to use existing matches stored in CDF to train a supervised model, check the box below.",marginTop:40,marginBottom:24}),a.default.createElement(s.Z,null,a.default.createElement(D.Z,null,a.default.createElement(c.uT,{level:2},"Use matched resources as training data",a.default.createElement(Va,{style:{marginLeft:"8px"},checked:r,onChange:function(e){return t((0,ue.XZ)(n,e.target.checked))}})))))}var tl=(0,d.default)(h.Z).withConfig({displayName:"datastudio__StyledCheckbox",componentId:"datastudio__c5yfjg-0"})(["&&& .ant-checkbox-inner{border:1px solid ",";}&&& .ant-checkbox-checked .ant-checkbox-inner{border-color:",";}"],c.wL["greyscale-grey10"].hex(),c.wL.midblue.hex());function nl(e){var t=(0,l.I0)(),n=e.resourceDataKitId,r=(0,l.v9)((function(e){return(0,ue.LV)(e)(n)})).generateRules;return a.default.createElement(a.default.Fragment,null,a.default.createElement(ne,{title:"Generate rules",description:"On top of matching resources, the model also generates rules to demonstrate similarities between matches and group matches based on the patterns.  You can uncheck this option if you don't need the rules or want to review results quicker.",marginTop:40,marginBottom:24}),a.default.createElement(s.Z,{gutter:[0,24]},a.default.createElement(D.Z,{span:24},a.default.createElement(c.uT,{level:2},"Generate rules",a.default.createElement(tl,{style:{marginLeft:"8px"},checked:r,onChange:function(e){return t((0,ue.ph)(n,e.target.checked))}})))))}var al=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-1fap0i5-0"})(["&&&{background-color:white;padding:0;margin-bottom:90px;max-width:672px;}"]);function ll(e){var t=e.onRun,n=e.afterRun,r=e.onCancel,i=e.resourceDataKitId,u=e.assetsDataKitId,d=e.pipelineId,s=(0,l.I0)(),f=d?"pipeline":"model",m=(0,a.useState)(!1),p=(0,o.Z)(m,2),v=p[0],g=p[1],h=(0,a.useMemo)((function(){return(0,se.ak)(i,!1)}),[i]),E=(0,a.useMemo)((function(){return(0,se.ak)(u,!1)}),[u]),y=(0,l.v9)(h),x=(0,l.v9)(E),I=(0,l.v9)((function(e){return e.contextualization.pipelines.byDataKitId[i]})),w=(0,l.v9)((function(e){return d?e.contextualization.pipelines.run[d]:{start:!1,error:!1,success:!1}})),b=(0,l.v9)((function(e){return(0,ue.LV)(e)(i)})),k=b.connections,S=void 0===k?[]:k,Z=b.featureType,C=b.scope,D=b.useTrueMatches,T=b.generateRules,_=b.hasConfig,N=b.allMatched,M=y&&x&&!_;(0,a.useEffect)((function(){s((0,se.CY)(u,!1)),s((0,se.CY)(i,!1))}),[s,u,i]),(0,a.useEffect)((function(){null!=I&&I.error&&ze.Z.error({message:"An error occurred while trying run the pipeline."})}),[s,I]),(0,a.useEffect)((function(){null!=I&&I.success&&null!=I&&I.isUpdate&&!v&&d&&(g(!0),s((0,xt.M_)(d)))}),[s,I,v,d]),(0,a.useEffect)((function(){null!=w&&w.success&&v&&g(!1)}),[s,v,w]),(0,a.useEffect)((function(){M&&s((0,ue.j)(i,u,String(d)))}),[s,M,d,i,u]);var F=function(){var e=(0,ae.Z)(re().mark((function e(){return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t(),s((0,se.Vx)({id:i,filter:C})),d?((0,Y.t5)(Y.YY.pipeline.config,{connections:S,featureType:Z,scope:C,useTrueMatches:D,generateRules:T}),s((0,xt.Zs)("run",d)),s((0,xt.oL)(d,{},i,u))):((0,Y.t5)(Y.YY.quickMatch.config,{connections:S,featureType:Z,scope:C,useTrueMatches:D,generateRules:T}),s((0,rn.UH)(u,i,(0,ue.vB)(S)))),n&&n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=S.filter((function(e){var t=e.source,n=e.target;return!!t&&!!n})),O=!N&&A.length>0&&A.length===S.length;return _?N?a.default.createElement(Ba,null):a.default.createElement(a.default.Fragment,null,a.default.createElement(al,null,a.default.createElement(Wa,{type:f,resourceDataKitId:i,assetsDataKitId:u}),a.default.createElement(el,{resourceDataKitId:i}),a.default.createElement(Qa,{resourceDataKitId:i}),!!d&&a.default.createElement(nl,{resourceDataKitId:i}),!d&&a.default.createElement(Ga,{resourceDataKitId:i,scope:C})),a.default.createElement(Ua,{type:f,ready:O,handleCancel:function(){r&&r()},handleContinue:F})):a.default.createElement(c.JO,{type:"Loader"})}function rl(e){var t,n=e.isPipeline,i=(0,r.k6)(),u=i.location,c=(0,a.useState)(!1),d=(0,o.Z)(c,2),s=d[0],f=d[1],m=(0,r.$B)(),p=null==m||null===(t=m.params)||void 0===t?void 0:t.pipelineId,v=Number(p),g=(0,r.UO)(),h=g.assetsDataKitId,E=g.resourceDataKitId,y=(0,a.useMemo)((function(){return(0,La.GB)(h)}),[h]),x=(0,a.useMemo)((function(){return(0,ue.kS)(E)}),[E]),w=(0,a.useMemo)((function(){return(0,Pn.WA)(E)}),[E]),b=(0,l.v9)(y),k=b.id,S=b.done,Z=b.running,C=(0,l.v9)((function(e){var t;return null!==(t=e.contextualization.pipelines.run[v])&&void 0!==t?t:{start:!1,success:!1,error:!1}})),D=C.start,T=C.success,_=(0,l.v9)((function(e){var t;return null!==(t=e.contextualization.pipelines.byDataKitId[E])&&void 0!==t?t:{start:!1,success:!1,isUpdate:!1}})),N=_.start,M=_.success,F=_.isUpdate,A=(0,l.v9)(x),O=A.id,K=A.done,z=A.running,P=(0,l.v9)(w),R=P.id,L=P.done,Y=P.error,B=P.running,U=S&&K&&(L||Y),W=Z||z||B,j=F&&M&&T,q=F&&(N||M||D),J=u.pathname.split("/").slice(2).join("/");return s&&!n&&U?a.default.createElement(r.l_,{to:(0,I.EW)("/".concat(J,"/").concat(k,"/").concat(O,"/").concat(R))}):s&&n&&j?a.default.createElement(r.l_,{to:(0,I.EW)("/".concat(J,"/results"))}):a.default.createElement(un,{selector:function(e){return!!e.selection.items[h]&&!!e.selection.items[E]},missingMessage:a.default.createElement(rt.Z,{type:"error",message:"Could not find the specified Data Kit, please start the entity matching process from the beginning."})},!n&&W&&a.default.createElement(vn,{assetDataKitId:h,resourceDataKitId:E}),n&&q&&a.default.createElement(vn,{assetDataKitId:h,resourceDataKitId:E,isPipeline:!0}),a.default.createElement(ll,{onRun:function(){return f(!0)},onCancel:function(){return i.goBack()},assetsDataKitId:h,resourceDataKitId:E,pipelineId:v}))}var il=n(21968),ul=d.default.span.withConfig({displayName:"datastudio__BoldText",componentId:"datastudio__sc-56lqwy-0"})(["&&&{font-weight:bolder;}"]),ol=function(){return a.default.createElement(c.uT,{level:2,style:{marginTop:"16px",marginBottom:"16px"}}," ",a.default.createElement(ul,null," ",a.default.createElement(c.JO,{type:"Warning",className:"em-icon",style:{color:c.wL["yellow-3"].hex()}})," ","Disclosure"),": The selected data is accessible to anyone with"," ",a.default.createElement(ul,null,"assets read-all")," and"," ",a.default.createElement(ul,null,"entitymatching read and write")," permissions on this CDF subscription")},cl=n(44452),dl=n.n(cl),sl=n(48664),fl=n(34617);function ml(e){var t=(0,a.useRef)();return(0,a.useEffect)((function(){t.current=e})),t.current}var pl=n(9270),vl=n(96706),gl=n(27518),hl=function(e){return function(){var t=(0,ae.Z)(re().mark((function t(n){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n((0,vl.QX)({filter:e.filter})),e.search?n((0,vl.yC)(e)):e.filter&&n((0,vl.pb)(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},El=function(e){return function(){var t=(0,ae.Z)(re().mark((function t(n){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n((0,_n.QX)({filter:e.filter})),e.search?n((0,_n.yC)(e)):e.filter&&n((0,_n.pb)(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},yl=function(e){return function(){var t=(0,ae.Z)(re().mark((function t(n){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n((0,pl.QX)({filter:e.filter})),e.search?n((0,pl.yC)(e)):e.filter&&n((0,pl.pb)(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},xl=function(e){return function(){var t=(0,ae.Z)(re().mark((function t(n){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n((0,N.QX)({filter:e.filter})),e.search?n((0,N.yC)(e)):n((0,N.pb)({filter:e.filter}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Il=function(e){return function(){var t=(0,ae.Z)(re().mark((function t(n){return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n((0,gl.QX)({filter:e.filter})),e.search?n((0,gl.yC)(e)):n((0,gl.pb)({filter:e.filter}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},wl=function(e,t){return function(){var n=(0,ae.Z)(re().mark((function n(a){return re().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e,n.next="assets"===n.t0?3:"files"===n.t0?5:"timeseries"===n.t0?7:"sequences"===n.t0?9:"events"===n.t0?11:13;break;case 3:return a(El(t)),n.abrupt("break",14);case 5:return a(yl(t)),n.abrupt("break",14);case 7:return a(xl(t)),n.abrupt("break",14);case 9:return a(hl(t)),n.abrupt("break",14);case 11:return a(Il(t)),n.abrupt("break",14);case 13:throw new Error("Unsupported ResourceType: ".concat(e));case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},bl=n(42457),kl=n.n(bl),Sl=n(69179),Zl=d.default.div.withConfig({displayName:"datastudio__DetailsWrapper",componentId:"datastudio__sc-1w54w4m-0"})(["&&&{pointer-events:all;overflow:auto;padding:12px;margin-top:12px;padding-top:6px;border-radius:4px;margin-right:12px;flex:1;overflow:auto;width:100%;background:#fff;}"]),Cl=function(e){var t=e.extraButtons,n=(0,r.k6)(),i=(0,l.I0)(),u=n.location.search,o=ln.parse(u,{parseNumbers:!0}),c=o.showSidebar,d=o.assetId,s=o.fileId,m=o.timeseriesId,p=o.sequenceId,v="true"===c,g=[];return t&&(g=kl()(t)?t({assetId:d,fileId:s,timeseriesId:m}):t),a.default.createElement(Sl.Z,{width:"80%",onClose:function(){return i((0,E.QJ)({showSidebar:!1},n))},zIndex:f.Z.SIDEBAR,destroyOnClose:!0,className:"pnid-sidebar",visible:v},a.default.createElement(Zl,{className:"search-content"},s&&Number.isInteger(Number(s))?a.default.createElement(Bl,{fileId:s,extraActions:g}):m&&Number.isInteger(Number(m))?a.default.createElement(Wl,{timeseriesId:m,extraActions:g}):d&&Number.isInteger(Number(d))?a.default.createElement(Rl,{assetId:d,extraActions:g}):p&&Number.isInteger(Number(p))?a.default.createElement(ql,{sequenceId:p,extraActions:g}):a.default.createElement(a.default.Fragment,null,a.default.createElement("p",null,"Start by searching for an asset or file"))))},Dl=n(85690),Tl=n(55030),_l=n(33419),Nl=n(45784),Ml=n(92847),Fl=n.n(Ml),Al=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-1gskeze-0"})(["&&& .back-button{margin-bottom:12px;}&&& .ant-collapse{margin-bottom:12px;}"]),Ol=function(e){return{filter:{assetSubtreeIds:[{id:e}]},limit:1e3}},Kl=function(e){return{filter:{assetSubtreeIds:[{id:e}]},limit:1e3}},zl=function(e){return{filter:{assetIds:[e]},limit:1e3}},Pl=function(e){return{filter:{assetIds:[e]},limit:1e3}},Rl=function(e){var t=e.assetId,n=e.extraActions,i=(0,r.k6)(),u=(0,l.I0)(),o=(0,l.v9)(_n.O1)(t),d=(0,l.v9)(M.B5)(t),s=d.files,f=d.fileIds,m=(0,l.v9)(pl.gL)(Ol(t),!0).items,p=(0,l.v9)(N.gL)(Kl(t),!0).items,v=(0,l.v9)(vl.gL)(zl(t),!0).items,g=(0,l.v9)(gl.gL)(Pl(t),!0).items,h=Fl()(s,m,(function(e){return e.id}));return(0,a.useEffect)((function(){(0,ae.Z)(re().mark((function e(){return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u((0,_n.Jv)([{id:t}]));case 2:return e.next=4,u((0,M.tp)(t));case 4:return e.next=6,u((0,pl.pb)(Ol(t),!0));case 6:return e.next=8,u((0,N.pb)(Kl(t),!0));case 8:return e.next=10,u((0,gl.pb)(Pl(t),!0));case 10:return e.next=12,u((0,vl.pb)(zl(t),!0));case 12:case"end":return e.stop()}}),e)})))()}),[u,t]),(0,a.useEffect)((function(){f&&u((0,pl.Jv)(f.map((function(e){return{id:e}}))))}),[u,f]),a.default.createElement(Al,null,a.default.createElement(c.zx,{className:"back-button",onClick:function(){return i.goBack()}},"Back"),a.default.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}},a.default.createElement("span",{style:{marginRight:"12px"}},"LOCATION:"),a.default.createElement(Dl.D,{assetId:t,onBreadcrumbClick:function(e){return u((0,E.QJ)({assetId:e.id},i))}})),a.default.createElement("h1",null,a.default.createElement(c.JO,{type:"Assets"})," ",o?o.name:"Loading..."),n,a.default.createElement(U.Z,null,a.default.createElement(U.Z.TabPane,{key:"asset-metadata",tab:"Asset Details"},a.default.createElement(c.Dx,{level:4,style:{marginTop:12,marginBottom:12}},"Details"),a.default.createElement(y.ST,{name:"Description",value:null==o?void 0:o.description}),a.default.createElement(y.ST,{name:"Source",value:null==o?void 0:o.source}),a.default.createElement(y.ST,{name:"External ID",value:null==o?void 0:o.externalId}),a.default.createElement(y.ST,{name:"Created at",value:o?b()(o.createdTime).format("MM/DD/YYYY HH:MM"):"Loading..."}),a.default.createElement(y.ST,{name:"Updated at",value:o?b()(o.lastUpdatedTime).format("MM/DD/YYYY HH:MM"):"Loading..."}),a.default.createElement(c.Dx,{level:4,style:{marginTop:12,marginBottom:12}},"Metadata"),a.default.createElement(Tl.U,{assetId:t})),a.default.createElement(U.Z.TabPane,{key:"timeseries",tab:a.default.createElement("span",null,"Linked Timeseries (",p.length,")")},a.default.createElement(qn.Z,{renderItem:function(e){return a.default.createElement(qn.Z.Item,{style:{cursor:"pointer"},onClick:function(){e&&u((0,E.QJ)({timeseriesId:e.id,showSidebar:!0},i))}},a.default.createElement(Nl.O,{timeseriesId:e.id}))},pagination:{position:"bottom"},dataSource:p})),a.default.createElement(U.Z.TabPane,{key:"files",tab:a.default.createElement("span",null,"Linked Files (",h.length,")")},a.default.createElement(qn.Z,{renderItem:function(e){return a.default.createElement(qn.Z.Item,{style:{cursor:"pointer"},onClick:function(){e&&u((0,E.QJ)({fileId:e.id,showSidebar:!0},i))}},a.default.createElement(qn.Z.Item.Meta,{title:e.name,description:e.externalId}))},pagination:{position:"bottom"},dataSource:h})),a.default.createElement(U.Z.TabPane,{key:"sequences",tab:a.default.createElement("span",null,"Linked Sequences (",v.length,")")},a.default.createElement(qn.Z,{renderItem:function(e){return a.default.createElement(qn.Z.Item,{style:{cursor:"pointer"},onClick:function(){e&&u((0,E.QJ)({sequenceId:e.id,showSidebar:!0},i))}},a.default.createElement(qn.Z.Item.Meta,{title:e.name,description:e.externalId}))},pagination:{position:"bottom"},dataSource:v})),a.default.createElement(U.Z.TabPane,{key:"events",tab:a.default.createElement("span",null,"Linked Events (",g.length,")")},a.default.createElement(qn.Z,{renderItem:function(e){return a.default.createElement(qn.Z.Item,{style:{cursor:"pointer"},onClick:function(){e&&sl.Z.info("Coming soon...")}},a.default.createElement(qn.Z.Item.Meta,{title:"".concat([e.type,e.subtype].filter((function(e){return!!e})).join(" - "),": ").concat(e.externalId||e.id),description:e.externalId}))},pagination:{position:"bottom"},dataSource:g})),a.default.createElement(U.Z.TabPane,{key:"children",tab:"Children"},a.default.createElement(_l.O,{assetIds:[t],defaultExpandedKeys:[t],onSelect:function(e){e.node&&u((0,E.QJ)({assetId:e.node.id,showSidebar:!0},i))}}))))},Ll=n(71506),Yl=n.n(Ll),Bl=function(e){var t=e.fileId,n=e.extraActions,i=(0,r.k6)(),u=(0,l.I0)(),o=(0,l.v9)(pl.O1)(t),d=(0,l.v9)(M.ww)(t),s=d.assetIds,f=d.assets,m=(0,l.v9)(M.s$)(t),p=m.fileIds,v=m.files;return(0,a.useEffect)((function(){(0,ae.Z)(re().mark((function e(){return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u((0,pl.Jv)([{id:t}]));case 2:return e.next=4,u((0,M.RQ)(t));case 4:case"end":return e.stop()}}),e)})))()}),[u,t]),(0,a.useEffect)((function(){u((0,_n.Jv)(s.filter((function(e){return Yl()(e)})).map((function(e){return{id:e}})))),u((0,_n.TS)(s.filter((function(e){return me()(e)})).map((function(e){return{externalId:e}}))))}),[u,s]),(0,a.useEffect)((function(){u((0,pl.Jv)(p.filter((function(e){return Yl()(e)})).map((function(e){return{id:e}})))),u((0,pl.TS)(p.filter((function(e){return me()(e)})).map((function(e){return{externalId:e}}))))}),[u,p]),a.default.createElement(Al,null,a.default.createElement(c.zx,{className:"back-button",onClick:function(){return i.goBack()}},"Back"),a.default.createElement("h1",null,o?o.name:"Loading..."),n,a.default.createElement(jn.Z,null,a.default.createElement(jn.Z.Panel,{key:"assets",header:a.default.createElement("span",{style:{display:"flex",alignItems:"center"}},"Assets Tags Detected (",f.length,")")},a.default.createElement(qn.Z,{renderItem:function(e){return a.default.createElement(qn.Z.Item,{style:{cursor:"pointer"},onClick:function(){e&&u((0,E.QJ)({assetId:e.id},i))}},a.default.createElement(qn.Z.Item.Meta,{title:e.name,description:e.description}))},pagination:{position:"bottom"},dataSource:f})),a.default.createElement(jn.Z.Panel,{key:"files",header:a.default.createElement("span",{style:{display:"flex",alignItems:"center"}},"Files Tags Detected (",v.length,")")},a.default.createElement(qn.Z,{renderItem:function(e){return a.default.createElement(qn.Z.Item,{style:{cursor:"pointer"},onClick:function(){e&&u((0,E.QJ)({fileId:e.id},i))}},a.default.createElement(qn.Z.Item.Meta,{title:e.name,description:e.externalId}))},pagination:{position:"bottom"},dataSource:v})),a.default.createElement(jn.Z.Panel,{key:"metdata",header:"Metadata"},a.default.createElement("pre",null,JSON.stringify(o,null,2)))))},Ul=n(53730),Wl=function(e){var t,n,i=e.timeseriesId,u=e.extraActions,o=(0,r.k6)(),d=(0,l.I0)(),s=(0,l.v9)(N.O1)(i);return(0,a.useEffect)((function(){s||d((0,N.Jv)([{id:i}]))}),[d,s,i]),a.default.createElement(Al,null,a.default.createElement(c.zx,{className:"back-button",onClick:function(){return o.goBack()}},"Back"),a.default.createElement("h1",null,a.default.createElement(c.JO,{type:"Timeseries"}),s?s.name:"Loading..."),u,s&&a.default.createElement(a.default.Fragment,null,a.default.createElement(y.m3,{timeseries:s,contextChart:!0,graphHeight:500}),a.default.createElement(Ul.o,{valueSet:(n=null!==(t=s.metadata)&&void 0!==t?t:{},Object.keys(n).reduce((function(e,t){return(0,p.Z)((0,p.Z)({},e),{},(0,ie.Z)({},t,String(n[t])||""))}),{}))})))},jl=function(e){return e.reduce((function(e,t){return(0,p.Z)((0,p.Z)({},e),{},(0,ie.Z)({},t.name||t.externalId||t.id,"".concat(t.valueType).concat(t.description?" - ".concat(t.description):"")))}),{})},ql=function(e){var t,n=e.sequenceId,i=e.extraActions,u=(0,r.k6)(),o=(0,l.I0)(),d=(0,l.v9)(vl.O1)(n);return(0,a.useEffect)((function(){d||o((0,vl.Jv)([{id:n}]))}),[o,d,n]),a.default.createElement(Al,null,a.default.createElement(c.zx,{className:"back-button",onClick:function(){return u.goBack()}},"Back"),a.default.createElement("h1",null,a.default.createElement(c.JO,{type:"GridFilled"}),d?d.name:"Loading..."),i,d&&a.default.createElement(U.Z,null,a.default.createElement(U.Z.TabPane,{key:"details",tab:"Sequence Details"},a.default.createElement(c.Dx,{level:4,style:{marginTop:12,marginBottom:12}},"Details"),a.default.createElement(y.ST,{name:"Description",value:d.description}),a.default.createElement(y.ST,{name:"Created at",value:b()(d.createdTime).format("MM/DD/YYYY HH:MM")}),a.default.createElement(y.ST,{name:"Updated at",value:b()(d.lastUpdatedTime).format("MM/DD/YYYY HH:MM")}),a.default.createElement(y.ST,{name:"External ID",value:d.externalId}),a.default.createElement(c.Dx,{level:4,style:{marginTop:12,marginBottom:12}},"Metadata"),a.default.createElement(y.UM.SequenceInfoGrid,{sequence:d,showAll:!0})),a.default.createElement(U.Z.TabPane,{key:"columns",tab:"Columns"},a.default.createElement(Ul.o,{valueSet:jl(null!==(t=d.columns)&&void 0!==t?t:[])}))))},Jl=function(e){var t=e.id,n=e.externalId;return a.default.createElement("div",{style:{display:"flex",alignItems:"center"}},a.default.createElement(y.J2,{style:{marginRight:"6px",display:"flex"},content:a.default.createElement("div",null,a.default.createElement(y.v$,null,a.default.createElement(y.ED,{title:"ID"},t),a.default.createElement(y.ED,{title:"External ID"},n||"<no external ID>")))},a.default.createElement("span",{style:{fontStyle:"italic"}},"<no name>")))},Xl=n(71526),Hl=de.Z.Option,Ql=(0,d.default)(de.Z).withConfig({displayName:"datastudio__DataSetSelector",componentId:"datastudio__di72cl-0"})(["&&& li.ant-select-selection__choice{border:1px solid ",";}"],c.wL["greyscale-grey7"].hex()),$l=function(e){var t=e.onDataSetSelected,n=e.style,r=void 0===n?{minWidth:"306px",maxHeight:"36px"}:n,i=e.disabled,u=void 0!==i&&i,d=e.multiple,s=void 0!==d&&d,f=e.noTypeCheck,m=void 0!==f&&f,p=e.selectedDataSetIds,g=e.type,h=(0,l.I0)(),y=(0,l.v9)(v.l8),x=(0,l.v9)(v.fI),w=(0,l.v9)(v.hL),b=(0,a.useState)([]),k=(0,o.Z)(b,2),S=k[0],Z=k[1],C=(0,a.useState)([]),D=(0,o.Z)(C,2),T=D[0],N=D[1],M=(0,a.useState)(""),F=(0,o.Z)(M,2),A=F[0],O=F[1],K=(0,a.useState)(!1),z=(0,o.Z)(K,2),P=z[0],R=z[1];(0,a.useEffect)((function(){var e=y.filter((function(e){return(0,I.No)(null==e?void 0:e.name,A)&&g}));Z(e)}),[A,y,g,x,m]),(0,a.useEffect)((function(){p&&N(p)}),[p]),(0,a.useEffect)((function(){h((0,v.pb)()),R(!1)}),[h,m]);var L=(0,a.useMemo)((function(){return(0,E.P_)("datasetsAcl","READ")}),[]);if(!(0,l.v9)(L))return a.default.createElement(_.Z,{title:"Missing DataSetAcl.READ",content:"Go to Access management to enable access to DataSetAcl.READ"},a.default.createElement(de.Z,{style:r,disabled:!0}));var Y=function(e,t,n){return a.default.createElement(Xl.Z,{placement:"left",title:a.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.default.createElement("div",{style:{fontSize:"12px",fontWeight:"bolder"}},t),a.default.createElement("div",null,e))},a.default.createElement(c.uT,{level:2},n&&t?(0,I.aS)(t,14):t))};return a.default.createElement(Bt.Z,{spinning:!!w,size:"small"},a.default.createElement(Ql,{showSearch:!0,style:r,disabled:u,mode:s?"multiple":"default",placeholder:"Select data sets",value:s?T:T[0],onChange:function(e){var n;(n=e)?s?(N(n),t(n)):(N([n]),t([n])):(N([]),t([])),O(""),R(!1)},onSearch:O,dropdownMatchSelectWidth:!0,filterOption:!1,maxTagCount:1,optionLabelProp:"label",onDropdownVisibleChange:R,open:P,loading:!!w},S.map((function(e){return a.default.createElement(Hl,{key:e.id,value:e.id,label:Y(e.id,null==e?void 0:e.name,!0)},Y(e.id,null==e?void 0:e.name,!1))}))))},Gl=n(45568),Vl=n.n(Gl);function er(e){var t=e.filter,n=void 0===t?{}:t,l=e.lockedFilters,r=e.updateFilter,i=void 0===r?function(){}:r,u=e.dataSetsOnly,o=void 0!==u&&u,d=e.noTypeCheck,s=void 0!==d&&d,f=e.onDataSetsUpdate,m=(n.filter.dataSetIds||[]).map((function(e){return null==e?void 0:e.id}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(D.Z,{span:o?6:4},a.default.createElement("p",null,"Data set"),a.default.createElement($l,{multiple:!0,noTypeCheck:s,style:{width:"100%"},selectedDataSetIds:m,type:"files",onDataSetSelected:function(e){var t=0===e.length?void 0:e.map((function(e){return{id:e}}));f?f(null!=t?t:[]):i((0,p.Z)((0,p.Z)({},n),{},{filter:(0,p.Z)((0,p.Z)({},n.filter),{},{dataSetIds:t})}))}})),!o&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Search"),a.default.createElement(S.Z,{disabled:o,prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter by name",value:n.search?n.search.name:"",onChange:function(e){return i((0,p.Z)((0,p.Z)({},n),{},{search:e.target.value.length>0?(0,p.Z)((0,p.Z)({},n.search),{},{name:e.target.value}):void 0}))}})),!o&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Source"),a.default.createElement(S.Z,{disabled:o,id:"source",placeholder:"Filter by source",value:n.filter?n.filter.source:void 0,onChange:function(e){return i((0,p.Z)((0,p.Z)({},n),{},{filter:(0,p.Z)((0,p.Z)({},n.filter),{},{source:e.target.value.length>0?e.target.value:void 0})}))}})),!o&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"File Type"),a.default.createElement(de.Z,{id:"file-type",style:{width:"100%"},placeholder:"Select a file type",value:n.filter?n.filter.mimeType:void 0,disabled:o||(null==l?void 0:l.filter)&&l.filter.mimeType,onSelect:function(e){if("all"===e){var t=Vl()(n.filter,["mimeType"]);i((0,p.Z)((0,p.Z)({},n),{},{filter:t}))}else i((0,p.Z)((0,p.Z)({},n),{},{filter:(0,p.Z)((0,p.Z)({},n.filter),{},{mimeType:e})}))}},a.default.createElement(de.Z.Option,{value:"all"},"All"),a.default.createElement(de.Z.Option,{value:"application/pdf"},"PDF"),a.default.createElement(de.Z.Option,{value:"image/jpeg"},"JPEG"),a.default.createElement(de.Z.Option,{value:"image/png"},"PNG"))))}function tr(e){var t,n=e.filter,l=e.updateFilter,r=void 0===l?function(){}:l,i=e.dataSetsOnly,u=void 0!==i&&i,o=e.onDataSetsUpdate,d=e.noTypeCheck,s=void 0!==d&&d,f=((null===(t=n.filter)||void 0===t?void 0:t.dataSetIds)||[]).map((function(e){return e.id}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(D.Z,{span:u?6:4},a.default.createElement("p",null,"Data set"),a.default.createElement($l,{multiple:!0,style:{width:"100%"},selectedDataSetIds:f,type:"timeseries",noTypeCheck:s,onDataSetSelected:function(e){var t=0===e.length?void 0:e.map((function(e){return{id:e}}));o?o(null!=t?t:[]):r((0,p.Z)((0,p.Z)({},n),{},{filter:(0,p.Z)((0,p.Z)({},n.filter),{},{dataSetIds:t})}))}})),!u&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Search"),a.default.createElement(S.Z,{disabled:u,prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter by name/description",value:n.search?n.search.query:"",onChange:function(e){return r((0,p.Z)((0,p.Z)({},n),{},{search:e.target.value.length>0?(0,p.Z)((0,p.Z)({},n.search),{},{query:e.target.value}):void 0}))}})))}function nr(e){var t,n=e.filter,l=e.updateFilter,r=void 0===l?function(){}:l,i=e.dataSetsOnly,u=void 0!==i&&i,o=e.onDataSetsUpdate,d=e.noTypeCheck,s=void 0!==d&&d,f=((null===(t=n.filter)||void 0===t?void 0:t.dataSetIds)||[]).map((function(e){return e.id}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(D.Z,{span:u?6:4},a.default.createElement("p",null,"Data set"),a.default.createElement($l,{multiple:!0,style:{width:"100%"},selectedDataSetIds:f,type:"sequences",noTypeCheck:s,onDataSetSelected:function(e){var t=0===e.length?void 0:e.map((function(e){return{id:e}}));o?o(null!=t?t:[]):r((0,p.Z)((0,p.Z)({},n),{},{filter:(0,p.Z)((0,p.Z)({},n.filter),{},{dataSetIds:t})}))}})),!u&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Search"),a.default.createElement(S.Z,{disabled:u,prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter by name/description",value:n.search?n.search.query:"",onChange:function(e){return r((0,p.Z)((0,p.Z)({},n),{},{search:e.target.value.length>0?(0,p.Z)((0,p.Z)({},n.search),{},{query:e.target.value}):void 0}))}})))}function ar(e){var t,n=e.filter,l=e.updateFilter,r=void 0===l?function(){}:l,i=e.dataSetsOnly,u=void 0!==i&&i,o=e.onDataSetsUpdate,d=e.noTypeCheck,s=void 0!==d&&d,f=((null===(t=n.filter)||void 0===t?void 0:t.dataSetIds)||[]).map((function(e){return e.id}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(D.Z,{span:u?6:4},a.default.createElement("p",null,"Data set"),a.default.createElement($l,{multiple:!0,noTypeCheck:s,style:{width:"100%"},selectedDataSetIds:f,type:"events",onDataSetSelected:function(e){var t=0===e.length?void 0:e.map((function(e){return{id:e}}));o?o(null!=t?t:[]):r((0,p.Z)((0,p.Z)({},n),{},{filter:(0,p.Z)((0,p.Z)({},n.filter),{},{dataSetIds:t})}))}})),!u&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Search"),a.default.createElement(S.Z,{disabled:u,prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter by description",value:n.search?n.search.description:"",onChange:function(e){return r((0,p.Z)((0,p.Z)({},n),{},{search:e.target.value.length>0?(0,p.Z)((0,p.Z)({},n.search),{},{description:e.target.value}):void 0}))}})))}var lr=n(44075),rr=function(e,t){return(0,lr.P1)(se.eU,se.Qv,(function(n,a){var l,r;return t.search?(null===(r=(a(e)(t)||{}).items)||void 0===r?void 0:r.length)||0:null===(l=n(e)({filter:t.filter}))||void 0===l?void 0:l.count}))},ir=(0,lr.P1)(se.J6,se.Qv,(function(e,t){return function(n,a){return a.search?t(n)(a):e(n)(a,!1)}})),ur={},or={},cr={search:void 0,filter:{}};function dr(e){var t=e.type,n=e.secondaryType,r=e.defaultFilters,i=void 0===r?ur:r,u=e.lockedFilters,d=void 0===u?or:u,f=e.setSelectionDetails,m=void 0===f?function(){}:f,v=e.selectionToLoad,g=e.availableTypes,E=void 0===g?[]:g,y=(0,l.I0)(),x=(0,a.useState)(1),w=(0,o.Z)(x,2),k=w[0],S=w[1],Z=(0,a.useState)(10),_=(0,o.Z)(Z,2),N=_[0],M=_[1],F=(0,a.useState)(t),A=(0,o.Z)(F,2),O=A[0],K=A[1],z=(0,a.useState)(!1),P=(0,o.Z)(z,2),R=P[0],L=P[1],Y=(0,a.useState)(!0),B=(0,o.Z)(Y,2),U=B[0],W=B[1],j=(0,a.useState)([]),q=(0,o.Z)(j,2),J=q[0],X=q[1],H=(0,a.useState)(i[O]||cr),Q=(0,o.Z)(H,2),$=Q[0],G=Q[1],V=(0,a.useState)($),ee=(0,o.Z)(V,2),te=ee[0],ne=ee[1],ae=(0,ka.Z)(ne,300),le=(0,o.Z)(ae,1)[0],re=(0,a.useCallback)((function(e){G(e),le(e)}),[le]);(0,a.useEffect)((function(){var e=(0,p.Z)({},i[O]||cr);G(e),le(e)}),[O,i,G,le]);var ie=(0,l.v9)(rr(O,te)),ue=(0,l.v9)(ir)(O,te),oe=ue.items,ce=ue.fetching;(0,a.useEffect)((function(){m({count:ie||0,isSelectAll:R,filter:$,type:O,selectedRowKeys:J})}),[ie,J,$,R,O]),(0,a.useEffect)((function(){t!==O&&K(t)}),[t]),(0,a.useEffect)((function(){y(wl(O,te))}),[y,O,te]),(0,a.useEffect)((function(){v&&("assets"!==O&&O!==v.type&&K(v.type),v.filter&&re(v.filter),X(v.selectedRowKeys),L(v.isSelectAll))}),[v,t]);var se=ml(R),fe=ml($),me=ml(O);(0,a.useEffect)((function(){(fe&&!dl()(fe,$)&&(null==v?void 0:v.filter)!==$||me&&me!==O)&&(L(!1),X([]),W(!$.search))}),[$,me,O,fe,v]),(0,a.useEffect)((function(){R?X(oe.map((function(e){return e.id}))):se&&se&&X([])}),[R,se,oe]);var pe=function(e,t){S(e),t&&M(t)},ve=Tn()([O].concat((0,C.Z)(E))).map((function(e){return{value:e,label:"timeseries"===e?"Time series":"".concat(e.substring(0,1).toUpperCase()).concat(e.substring(1))}}));return ve.sort(),a.default.createElement(a.default.Fragment,null,a.default.createElement(s.Z,{type:"flex",gutter:[8,12]},E.length>0&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Resource type"),a.default.createElement(de.Z,{style:{width:"100%"},dropdownMatchSelectWidth:!1,defaultValue:O,onChange:function(e){return K(e)}},ve.map((function(e){return a.default.createElement(de.Z.Option,{key:e.value,value:e.value},e.label)})))),function(e,t,n,l){switch(e){case"files":return a.default.createElement(er,{filter:t,updateFilter:n,lockedFilters:l,noTypeCheck:!0});case"timeseries":return a.default.createElement(tr,{filter:t,updateFilter:n,noTypeCheck:!0});case"sequences":return a.default.createElement(nr,{filter:t,updateFilter:n,noTypeCheck:!0});case"events":return a.default.createElement(ar,{filter:t,updateFilter:n,noTypeCheck:!0});default:throw new Error("type '".concat(e,"' not supported"))}}(O,$,re,d[t])),a.default.createElement(T.Z,{style:{marginBottom:"90px",marginTop:"16px"},rowSelection:{columnWidth:"5%",columnTitle:a.default.createElement(c.u,{content:ie?U?"Select all entities":"When you have a search query, you cannot select all":"There are no items in the list to select"},a.default.createElement(h.Z,{disabled:!U||!ie,onChange:function(e){return L(e.target.checked)},checked:R})),getCheckboxProps:function(){return R?{disabled:!0}:{}},onSelect:function(e,t){R?sl.Z.info("Currently only manual selection or select all is supported."):X(t?[].concat((0,C.Z)(J),[e.id]):J.filter((function(t){return t!==e.id})))},selectedRowKeys:J},columns:[{title:"Name",key:"name",dataIndex:"name",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.name,null==t?void 0:t.name)},width:"40%",render:function(e,t){return a.default.createElement("div",null,e||a.default.createElement(Jl,{id:t.id,externalId:t.externalId}))}},{title:"Description",key:"description",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.description,null==t?void 0:t.description)},width:"40%",dataIndex:"description"},{title:"Last modified",key:"last-modified",width:"15%",sorter:(0,I.o8)((function(e){return null==e?void 0:e.lastUpdatedTime})),render:function(e){return b()(e.lastUpdatedTime).format("YYYY-MM-DD hh:mm")}}],rowKey:"id",pagination:{position:"bottom",showQuickJumper:!0,showSizeChanger:!0,pageSize:N,current:k,onChange:pe,onShowSizeChange:pe},loading:ce,dataSource:oe.map((function(e){return(0,p.Z)({},e)})),locale:{emptyText:a.default.createElement(fl.Z,{image:fl.Z.PRESENTED_IMAGE_SIMPLE,description:"No ".concat(null!=n?n:O," found")})}}),a.default.createElement(Cl,null))}function sr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={limit:100,search:e.length>0?{query:e}:{}},n=(0,p.Z)((0,p.Z)({},t),{},{filter:{root:!0}});return[t,n]}function fr(e){var t=(0,a.useState)(""),n=(0,o.Z)(t,2),r=n[0],i=n[1],u=(0,l.I0)(),c=e.onAssetSelected,d=void 0===c?function(){}:c,s=e.selectedAssetId,f=e.rootOnly,m=sr(r),p=(0,o.Z)(m,2),v=p[0],g=p[1],h=(0,l.v9)(_n.yn)(v),E=h.items,y=h.fetching,x=(0,l.v9)(_n.yn)(g),I=x.items,w=x.fetching;return(0,a.useEffect)((function(){var e=sr(r),t=(0,o.Z)(e,2),n=t[0],a=t[1];f||u((0,_n.yC)(n)),u((0,_n.yC)(a))}),[u,r,f]),a.default.createElement(de.Z,{disabled:!!e.disabled,showSearch:!0,style:e.style||{width:"200px"},placeholder:e.placeholder||"Search for an asset",value:s,notFoundContent:y||w?a.default.createElement(J.Z,{size:"small"}):null,onSelect:function(e){return d([].concat((0,C.Z)(I),(0,C.Z)(E)).find((function(t){return t.id===e})))},onChange:function(e){e||d([].concat((0,C.Z)(I),(0,C.Z)(E)).find((function(t){return t.id===e})))},onSearch:i,filterOption:!1,allowClear:!0},0!==I.length&&a.default.createElement(de.Z.OptGroup,{label:"Root assets",key:"root"},I.map((function(e){return a.default.createElement(de.Z.Option,{key:e.id,value:e.id},a.default.createElement("span",null,e.name),a.default.createElement("span",{style:{color:"#ababab",marginLeft:"4px"}},"(",e.id,")"))}))),0!==E.length&&!f&&a.default.createElement(de.Z.OptGroup,{label:"All Assets",key:"assets"},E.map((function(e){return a.default.createElement(de.Z.Option,{key:e.id,value:e.id},a.default.createElement("span",null,e.name),a.default.createElement("span",{style:{color:"#ababab",marginLeft:"4px"}},"(",e.id,")"))}))))}function mr(e){var t,n=e.filter,l=void 0===n?{}:n,r=e.updateFilter,i=void 0===r?function(){}:r,u=e.dataSetsOnly,o=void 0!==u&&u,d=e.onDataSetsUpdate,s=e.noTypeCheck,f=void 0!==s&&s,m=((null===(t=l.filter)||void 0===t?void 0:t.dataSetIds)||[]).map((function(e){return null==e?void 0:e.id}));return a.default.createElement(a.default.Fragment,null,a.default.createElement(D.Z,{span:o?6:4},a.default.createElement("p",null,"Data set"),a.default.createElement($l,{multiple:!0,noTypeCheck:f,style:{width:"100%"},selectedDataSetIds:m,type:"assets",onDataSetSelected:function(e){d?d(e.map((function(e){return{id:e}}))):i((0,p.Z)((0,p.Z)({},l),{},{filter:(0,p.Z)((0,p.Z)({},l.filter),{},{dataSetIds:e.map((function(e){return{id:e}}))})}))}})),!o&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Search"),a.default.createElement(S.Z,{disabled:o,prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter by name/description",value:l.search?l.search.query:"",onChange:function(e){return i((0,p.Z)((0,p.Z)({},l),{},{search:e.target.value.length>0?(0,p.Z)((0,p.Z)({},l.search),{},{query:e.target.value}):void 0}))}})),!o&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Source"),a.default.createElement(S.Z,{disabled:o,id:"source",placeholder:"Filter by source",value:l.filter?l.filter.source:void 0,onChange:function(e){return i((0,p.Z)((0,p.Z)({},l),{},{filter:(0,p.Z)((0,p.Z)({},l.filter),{},{source:e.target.value.length>0?e.target.value:void 0})}))}})),!o&&a.default.createElement(D.Z,{span:4},a.default.createElement("p",null,"Root assets"),a.default.createElement(fr,{disabled:o,style:{width:"100%"},placeholder:"Filter by root asset",rootOnly:!0,selectedAssetId:l.filter&&l.filter.rootIds&&l.filter.rootIds.length>0?l.filter.rootIds[0].id:void 0,onAssetSelected:function(e){return i((0,p.Z)((0,p.Z)({},l),{},{filter:(0,p.Z)((0,p.Z)({},l.filter),{},{rootIds:e?[{id:e.id}]:void 0})}))}})))}var pr=[{title:"Name",key:"name",dataIndex:"name",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.name,null==t?void 0:t.name)},width:"40%",render:function(e,t){return a.default.createElement("div",{style:{display:"flex",alignItems:"center"}},a.default.createElement(y.J2,{style:{marginRight:"6px",display:"flex"},content:a.default.createElement(O,{asset:t})},a.default.createElement(c.JO,{type:"Assets"})),a.default.createElement("span",null,e||"<no name>"))}},{title:"Description",key:"description",sorter:function(e,t){return(0,I.$K)(null==e?void 0:e.description,null==t?void 0:t.description)},width:"40%",dataIndex:"description"},{title:"Last modified",key:"last-modified",width:"15%",sorter:(0,I.o8)((function(e){return null==e?void 0:e.lastUpdatedTime})),render:function(e){return b()(e.lastUpdatedTime).format("YYYY-MM-DD hh:mm")}}],vr={search:void 0,filter:{}};function gr(e){var t=e.secondaryType,n=e.setSelectionDetails,r=void 0===n?function(){}:n,i=e.selectionToLoad,u=(0,l.I0)(),d=(0,a.useState)(1),f=(0,o.Z)(d,2),m=f[0],v=f[1],g=(0,a.useState)(10),E=(0,o.Z)(g,2),y=E[0],x=E[1],I=(0,a.useState)(!1),w=(0,o.Z)(I,2),b=w[0],k=w[1],S=(0,a.useState)(!0),Z=(0,o.Z)(S,2),D=Z[0],_=Z[1],N=(0,a.useState)([]),M=(0,o.Z)(N,2),F=M[0],A=M[1],O=(0,a.useState)(vr),K=(0,o.Z)(O,2),z=K[0],P=K[1],R=(0,a.useState)(z),L=(0,o.Z)(R,2),Y=L[0],B=L[1],U=(0,ka.Z)(B,300),W=(0,o.Z)(U,1)[0],j=(0,a.useCallback)((function(e){P(e),W(e)}),[W]);(0,a.useEffect)((function(){var e=(0,p.Z)({},vr);P(e),W(e)}),[P,W]);var q=(0,l.v9)(rr("assets",Y)),J=(0,l.v9)(ir)("assets",Y),X=J.items,H=J.fetching;(0,a.useEffect)((function(){r({count:q||0,isSelectAll:b,filter:z,type:"assets",selectedRowKeys:F})}),[q,F,z,b]),(0,a.useEffect)((function(){u(wl("assets",Y))}),[u,Y]),(0,a.useEffect)((function(){i&&(A(i.selectedRowKeys),k(i.isSelectAll))}),[i]);var Q=ml(b),$=ml(z);(0,a.useEffect)((function(){$&&!dl()($,z)&&(null==i?void 0:i.filter)!==z&&(k(!1),A([]),_(!z.search))}),[z,$,i]),(0,a.useEffect)((function(){b?A(X.map((function(e){return e.id}))):Q&&Q&&A([])}),[b,Q,X]);var G=function(e,t){v(e),t&&x(t)};return a.default.createElement(a.default.Fragment,null,a.default.createElement(s.Z,{type:"flex",gutter:[8,12]},a.default.createElement(mr,{filter:z,updateFilter:j,noTypeCheck:!0})),a.default.createElement(T.Z,{style:{marginBottom:"90px",marginTop:"16px"},rowSelection:{columnWidth:"5%",columnTitle:a.default.createElement(c.u,{content:q?D?"Select all entities":"When you have a search query, you cannot select all":"There are no items in the list to select"},a.default.createElement(h.Z,{disabled:!D||!q,onChange:function(e){return k(e.target.checked)},checked:b})),getCheckboxProps:function(){return b?{disabled:!0}:{}},onSelect:function(e,t){b?sl.Z.info("Currently only manual selection or select all is supported."):A(t?[].concat((0,C.Z)(F),[e.id]):F.filter((function(t){return t!==e.id})))},selectedRowKeys:F},columns:pr,rowKey:"id",pagination:{position:"bottom",showQuickJumper:!0,showSizeChanger:!0,pageSize:y,current:m,onChange:G,onShowSizeChange:G},loading:H,dataSource:X.map((function(e){return(0,p.Z)({},e)})),locale:{emptyText:a.default.createElement(fl.Z,{image:fl.Z.PRESENTED_IMAGE_SIMPLE,description:"No ".concat(null!=t?t:"assets"," found")})}}),a.default.createElement(Cl,null))}var hr=function(e){var t=e.tabName,n=e.details;return a.default.createElement(y.X2,{flex:!0,direction:"column",style:{margin:"0",width:"180px"}},a.default.createElement(c.Dx,{level:5},t),a.default.createElement(c.uT,{level:2}," ",n.count," results."," ",n.isSelectAll?n.count:n.selectedRowKeys.length," ","selected"))},Er=function(){var e=(0,l.I0)(),t=(0,r.k6)(),n=(0,r.$B)("/:project/:path*"),i=(0,a.useState)({selectedRowKeys:[],count:0,isSelectAll:!1,type:"timeseries",filter:{}}),u=(0,o.Z)(i,2),d=u[0],s=u[1],f=(0,a.useState)({selectedRowKeys:[],count:0,isSelectAll:!1,type:"assets",filter:{}}),v=(0,o.Z)(f,2),g=v[0],h=v[1],E=(0,a.useState)("entities"),y=(0,o.Z)(E,2),x=y[0],w=y[1],b=(0,a.useState)(!1),k=(0,o.Z)(b,2),S=k[0],Z=k[1],C=function(){var t=(0,ae.Z)(re().mark((function t(n){var a,l,r,i;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=n.isSelectAll?n.count:n.selectedRowKeys.length,n.isSelectAll?(a=n.filter,l>5e3&&(a=(0,p.Z)((0,p.Z)({},a),{},{limit:1e3}))):a=n.selectedRowKeys.map((function(e){return{id:e}})),r={type:n.type,endpoint:n.isSelectAll?"list":"retrieve",query:a},(0,Y.t5)(Y.YY.quickMatch.selectData,(0,p.Z)({},r)),i=e((0,se.Ue)(r)),t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(){var e=(0,ae.Z)(re().mark((function e(){var a,l;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),e.next=3,C(d);case 3:return a=e.sent,e.next=6,C(g);case 6:l=e.sent,Z(!1),t.push((0,I.EW)("/".concat(null==n?void 0:n.params.path,"/").concat(a,"/").concat(l)));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=(null==d?void 0:d.selectedRowKeys.length)<1&&!(null!=d&&d.isSelectAll),t=(null==g?void 0:g.selectedRowKeys.length)<1&&!(null!=g&&g.isSelectAll);return"entities"===x?e:e||t};return a.default.createElement("div",null,a.default.createElement(c.Dx,{level:3},"Select data",a.default.createElement(c.u,{content:"assets"===x?"Select assets you want to match with previously selected entities":"Select entities you want to match to assets",placement:"right"},a.default.createElement(c.JO,{type:"Help",style:{marginLeft:"10px"}}))),a.default.createElement(ol,null),a.default.createElement(yr,{activeKey:x,onChange:function(e){return w(e)}},a.default.createElement(il.default.TabPane,{tab:a.default.createElement(hr,{tabName:"Select entities",details:d}),key:"entities",forceRender:!0},a.default.createElement(dr,{type:"timeseries",key:"resourceSearch",availableTypes:["timeseries","sequences","files","events"],setSelectionDetails:function(e){return s(e)}})),a.default.createElement(il.default.TabPane,{tab:a.default.createElement(hr,{tabName:"Select assets",details:g}),key:"assets",forceRender:!0},a.default.createElement(gr,{key:"assetSearch",setSelectionDetails:function(e){return h(e)}}))),a.default.createElement(m,null,a.default.createElement(c.zx,{type:"secondary",onClick:function(){return t.goBack()}},"Back"),a.default.createElement("div",null,a.default.createElement(c.u,{content:T()?"Select entities and assets to continue to configure your model.":"Proceed to ".concat("entities"===x?"selecting assets":"configuring your model!",".")},a.default.createElement(c.zx,{type:"primary",disabled:T(),onClick:function(){"entities"===x?w("assets"):D()},loading:S,style:{marginLeft:"20px"}},"Next")))))},yr=(0,d.default)(il.default).withConfig({displayName:"datastudio__TabsStyled",componentId:"datastudio__sc-1fp7r0l-0"})(["&&&{width:100%;}&&& .ant-tabs-tab{padding:16px 0;}&&& .ant-tabs-ink-bar{background-color:",";height:4px;}"],c.wL["midblue-3"].hex());function xr(e){var t,n=e.setSelectionDetails,l=void 0===n?function(){}:n,r=e.availableTypes,i=void 0===r?[]:r,u=e.selectionDetails,d=(0,a.useState)({search:void 0,filter:{}}),f=(0,o.Z)(d,2),m=f[0],v=f[1],g=(0,a.useState)(""),h=(0,o.Z)(g,2),E=h[0],y=h[1],x=(0,a.useState)(!1),I=(0,o.Z)(x,2),w=I[0],b=I[1];(0,a.useEffect)((function(){u.dataSetIds.length?v({search:void 0,filter:{dataSetIds:u.dataSetIds}}):v({search:void 0,filter:{}})}),[u]);var Z=function(e){return e.map((function(e){return{id:e}}))},T=Tn()([u.resource.replace(/[^a-zA-Z ]/g,"")].concat((0,C.Z)(i))).map((function(e){return{value:e,label:"timeseries"===e?"Time series":"".concat(ce()(e))}})).sort(),_=function(){if(u.resource){var e=T.find((function(e){return e.value===u.resource}));return e?e.value:u.resource.replace(/[^a-zA-Z ]/g,"")}return"timeseries"};return a.default.createElement(a.default.Fragment,null,a.default.createElement(s.Z,{type:"flex",gutter:[8,12],style:{marginBottom:"24px"}},i.length>0&&a.default.createElement(D.Z,{span:6},a.default.createElement("p",null,"Resource type"),a.default.createElement(de.Z,{style:{width:"100%"},dropdownMatchSelectWidth:!1,defaultValue:_(),onChange:function(e){l({selectedItems:[],resource:e,count:0,dataSetIds:[]})}},T.map((function(e){return a.default.createElement(de.Z.Option,{key:e.value,value:e.value},e.label)})))),a.default.createElement(D.Z,{span:6},a.default.createElement("p",null,"Data set name"),a.default.createElement(S.Z,{prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter data sets by name",value:E,onChange:function(e){return y(e.currentTarget.value)}}))),a.default.createElement(s.Z,null,a.default.createElement(k,{selectedDataSetIds:((null===(t=m.filter)||void 0===t?void 0:t.dataSetIds)||[]).map((function(e){return e.id})),type:_(),onDataSetSelected:function(e){l((0,p.Z)((0,p.Z)({},u),{},{dataSetIds:e&&e.length?Z(e):[],selectedItems:[]}))},query:E,showAll:w,setShowAll:b})),a.default.createElement(Cl,null))}function Ir(e){var t,n=e.setSelectionDetails,l=void 0===n?function(){}:n,r=e.selectionDetails,i=(0,a.useState)({search:void 0,filter:{}}),u=(0,o.Z)(i,2),d=u[0],f=u[1],m=(0,a.useState)(""),v=(0,o.Z)(m,2),g=v[0],h=v[1],E=(0,a.useState)(!1),y=(0,o.Z)(E,2),x=y[0],I=y[1];(0,a.useEffect)((function(){r.dataSetIds.length?f({search:void 0,filter:{dataSetIds:r.dataSetIds}}):f({search:void 0,filter:{}})}),[r]);var w=function(e){return e.map((function(e){return{id:e}}))};return a.default.createElement(a.default.Fragment,null,a.default.createElement(s.Z,{type:"flex",gutter:[8,12],style:{marginBottom:"24px"}},a.default.createElement(D.Z,{span:6},a.default.createElement("p",null,"Data set name"),a.default.createElement(S.Z,{prefix:a.default.createElement(c.JO,{type:"Search",style:{height:"16px",color:c.wL["greyscale-grey6"].hex()}}),placeholder:"Filter data sets by name",value:g,onChange:function(e){return h(e.currentTarget.value)}}))),a.default.createElement(s.Z,null,a.default.createElement(k,{selectedDataSetIds:((null===(t=d.filter)||void 0===t?void 0:t.dataSetIds)||[]).map((function(e){return e.id})),type:"assets",onDataSetSelected:function(e){l((0,p.Z)((0,p.Z)({},r),{},{dataSetIds:e&&e.length?w(e):[],selectedItems:[]}))},query:g,showAll:x,setShowAll:I})),a.default.createElement(Cl,null))}var wr=function(e){var t=e.tabName,n=e.details;return a.default.createElement(y.X2,{flex:!0,direction:"column",style:{margin:"0",width:"180px"}},a.default.createElement(c.Dx,{level:5},t),a.default.createElement(c.uT,{level:2}," ",n.dataSetIds.length," data sets selected."))},br=function(){var e=(0,l.I0)(),t=(0,r.$B)("/:project/entity-matching/pipeline/:pipelineId"),n=(0,r.k6)(),i=(0,l.v9)((function(e){var t,n,a;return null!==(t=null===(n=e.contextualization.pipelines.active)||void 0===n||null===(a=n.sources)||void 0===a?void 0:a.resource)&&void 0!==t?t:"timeseries"})),u=(0,a.useState)({dataSetIds:[],resource:i,count:0,selectedItems:[]}),d=(0,o.Z)(u,2),s=d[0],f=d[1],v=(0,a.useState)({dataSetIds:[],resource:"assets",count:0,selectedItems:[]}),g=(0,o.Z)(v,2),h=g[0],E=g[1],y=(0,a.useState)("entities"),x=(0,o.Z)(y,2),w=x[0],b=x[1],k=(0,a.useState)(!1),S=(0,o.Z)(k,2),Z=S[0],C=S[1],D=(0,l.v9)((function(e){return e.contextualization.pipelines.items.find((function(e){var n;return String(e.id)===(null==t||null===(n=t.params)||void 0===n?void 0:n.pipelineId)}))||e.contextualization.pipelines.active}));(0,a.useEffect)((function(){var e,t,n,a,l;(!D||null!=s&&null!==(e=s.dataSetIds)&&void 0!==e&&e.length)&&null!=h&&null!==(t=h.dataSetIds)&&void 0!==t&&t.length||(null!=D&&D.sources&&f({dataSetIds:null==D||null===(n=D.sources)||void 0===n?void 0:n.dataSetIds.map((function(e){return(0,p.Z)({},e)})),resource:null==D||null===(a=D.sources)||void 0===a?void 0:a.resource,selectedItems:[],count:0}),null!=D&&D.targets&&E({dataSetIds:null==D||null===(l=D.targets)||void 0===l?void 0:l.dataSetIds.map((function(e){return(0,p.Z)({},e)})),resource:"assets",selectedItems:[],count:0}))}),[D]);var T=function(){var t=(0,ae.Z)(re().mark((function t(n){var a,l,r;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={filter:{dataSetIds:n.dataSetIds},limit:1e3},l={type:n.resource,endpoint:"list",query:a},(0,Y.t5)(Y.YY.pipeline.selectData,{numberOfDataSets:n.dataSetIds.length}),r=e((0,se.Ue)(l)),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_=function(){var t=(0,ae.Z)(re().mark((function t(n,a){var l;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l=e((0,xt.kD)(null==D?void 0:D.name,null==D?void 0:D.description,n,a)),t.abrupt("return",l);case 5:return t.prev=5,t.t0=t.catch(0),ze.Z.error({message:"Failed to create pipeline",description:String(t.t0)}),t.abrupt("return",void 0);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,n){return t.apply(this,arguments)}}(),N=function(){var a=(0,ae.Z)(re().mark((function a(){var l,r,i,u;return re().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return C(!0),a.next=3,T(s);case 3:return r=a.sent,a.next=6,T(h);case 6:if(i=a.sent,e((0,xt.$0)(null==D?void 0:D.name,null==D?void 0:D.description,null==D?void 0:D.id,{dataSetIds:s.dataSetIds,resource:s.resource},{dataSetIds:h.dataSetIds,resource:"assets"})),C(!1),null!=t&&null!==(l=t.params)&&void 0!==l&&l.pipelineId){a.next=16;break}return a.next=12,_(r,i);case 12:u=a.sent,n.push((0,I.EW)("/entity-matching/pipeline/".concat(u,"/").concat(r,"/").concat(i))),a.next=17;break;case 16:n.push((0,I.EW)("/entity-matching/pipeline/".concat(t.params.pipelineId,"/").concat(r,"/").concat(i)));case 17:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),M=function(){var e,t,n=!(null!=s&&null!==(e=s.dataSetIds)&&void 0!==e&&e.length),a=!(null!=h&&null!==(t=h.dataSetIds)&&void 0!==t&&t.length);return"entities"===w?n:n||a};return a.default.createElement("div",{style:{marginTop:"16px"}},a.default.createElement(Sr,null,a.default.createElement(c.Dx,{level:3},"Select data",a.default.createElement(c.u,{content:"assets"===w?"Select assets you want to match with previously selected entities":"Select entities you want to match to assets",placement:"right"},a.default.createElement(c.JO,{type:"Help",style:{marginLeft:"10px"}}))),a.default.createElement(kr,{activeKey:w,onChange:function(e){return b(e)}},a.default.createElement(il.default.TabPane,{tab:a.default.createElement(wr,{tabName:"Select entities",details:s}),key:"entities",forceRender:!0},a.default.createElement(xr,{key:"resourceSearch",availableTypes:["timeseries","sequences","files","events"],setSelectionDetails:function(e){return f(e)},selectionDetails:s})),a.default.createElement(il.default.TabPane,{tab:a.default.createElement(wr,{tabName:"Select assets",details:h}),key:"assets",forceRender:!0},a.default.createElement(Ir,{key:"assetSearch",setSelectionDetails:function(e){return E(e)},selectionDetails:h})))),a.default.createElement(m,null,a.default.createElement(c.zx,{type:"secondary",onClick:function(){return n.goBack()}},"Back"),a.default.createElement("div",null,a.default.createElement(c.u,{content:M()?"Select entities and assets to continue to configure your model.":"Proceed to ".concat("entities"===w?"selecting assets":"configuring your pipeline!",".")},a.default.createElement(c.zx,{type:"primary",onClick:function(){"entities"===w?b("assets"):N()},disabled:M(),loading:Z,style:{marginLeft:"20px"}},"Next")))))},kr=(0,d.default)(il.default).withConfig({displayName:"datastudio__TabsStyled",componentId:"datastudio__sc-1xg26b-0"})(["&&&{width:100%;}&&& .ant-tabs-tab{padding:16px 0;}&&& .ant-tabs-ink-bar{background-color:",";height:4px;}"],c.wL["midblue-3"].hex()),Sr=d.default.div.withConfig({displayName:"datastudio__Wrapper",componentId:"datastudio__sc-1xg26b-1"})(["&&&{background-color:white;padding:0;margin-bottom:90px;}"]),Zr=function(){var e=(0,r.$B)(),t=(0,a.useMemo)((function(){return(0,E.P_)("entitymatchingAcl","READ")}),[]),n=(0,a.useMemo)((function(){return(0,E.P_)("entitymatchingAcl","WRITE")}),[]),u=(0,l.v9)(t),o=(0,l.v9)(n);return u&&o?a.default.createElement(Te,null,a.default.createElement(Ce,null,a.default.createElement(r.rs,null,a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(an,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/quick-match"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(Er,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/quick-match/:resourceDataKitId/:assetsDataKitId"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(rl,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/quick-match/:resourceDataKitId/:assetsDataKitId/:modelId/:predictId/:ruleId"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(la,null)," ")}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/quick-match/:resourceDataKitId/:assetsDataKitId/:modelId/:predictId/:ruleId/:changed"),component:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(la,null)," ")}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/pipeline/:pipelineId?"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(br,null))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/pipeline/:pipelineId/results"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(Ra,null)," ")}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/pipeline/:pipelineId?/:resourceDataKitId/:assetsDataKitId"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(rl,{isPipeline:!0}))}}),a.default.createElement(r.AW,{exact:!0,path:"".concat(e.url,"/pipeline/:pipelineId?/:resourceDataKitId/:assetsDataKitId/results"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(Ra,null)," ")}}),a.default.createElement(r.AW,{path:"".concat(e.url,"/3d_matching"),render:function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Z,{title:"Entity Matching"}),a.default.createElement(mt,null))}})))):a.default.createElement(pt,{feature:"Entity Matching",permissions:[{acl:"entitymatchingAcl",type:"READ"},{acl:"entitymatchingAcl",type:"WRITE"}]})}},24654:function(){}}]);
//# sourceMappingURL=877.b3bffee3.chunk.js.map