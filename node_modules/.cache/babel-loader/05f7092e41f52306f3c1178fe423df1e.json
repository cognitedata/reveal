{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useMemo } from 'react';\nimport isEmpty from 'lodash/isEmpty';\nimport { EMPTY_DATA } from '../../../constants';\nimport { useTimeseriesDatapointsQuery } from '../../service/queries';\nimport { mapToChartData, mapToTimeseriesDatapointsQuery } from '../transformers';\nimport { useTimeseriesChartMetadata } from './useTimeseriesChartMetadata';\nexport const useTimeseriesChartData = ({\n  query,\n  dataFetchOptions\n}) => {\n  _s();\n  const {\n    data: metadata,\n    isFetched,\n    isInitialLoading: isInitialMetadataLoading\n  } = useTimeseriesChartMetadata({\n    query,\n    dataFetchOptions\n  });\n  const {\n    data: datapoints,\n    isInitialLoading: isInitialDatapointsLoading\n  } = useTimeseriesDatapointsQuery({\n    query: mapToTimeseriesDatapointsQuery({\n      query,\n      metadata\n    }),\n    enabled: isFetched\n  });\n  const chartData = useMemo(() => {\n    if (!datapoints || isEmpty(datapoints)) {\n      return EMPTY_DATA;\n    }\n    return mapToChartData({\n      datapoints,\n      metadata\n    });\n  }, [datapoints, metadata]);\n  return {\n    data: chartData,\n    metadata,\n    isLoading: isInitialMetadataLoading || isInitialDatapointsLoading\n  };\n};\n_s(useTimeseriesChartData, \"3VWDH2oQsGsT6WxvY+oNqcMhvSM=\", false, function () {\n  return [useTimeseriesChartMetadata, useTimeseriesDatapointsQuery];\n});","map":{"version":3,"names":["useMemo","isEmpty","EMPTY_DATA","useTimeseriesDatapointsQuery","mapToChartData","mapToTimeseriesDatapointsQuery","useTimeseriesChartMetadata","useTimeseriesChartData","query","dataFetchOptions","data","metadata","isFetched","isInitialLoading","isInitialMetadataLoading","datapoints","isInitialDatapointsLoading","enabled","chartData","isLoading"],"sources":["/Volumes/csvol/fusion/libs/shared/plotting-components/src/TimeseriesChart/domain/internal/hooks/useTimeseriesChartData.ts"],"sourcesContent":["import { useMemo } from 'react';\n\nimport isEmpty from 'lodash/isEmpty';\n\nimport { Data } from '../../../../LineChart';\nimport { EMPTY_DATA } from '../../../constants';\nimport { DataFetchOptions } from '../../../types';\nimport { useTimeseriesDatapointsQuery } from '../../service/queries';\nimport {\n  mapToChartData,\n  mapToTimeseriesDatapointsQuery,\n} from '../transformers';\nimport { TimeseriesChartQuery } from '../types';\n\nimport { useTimeseriesChartMetadata } from './useTimeseriesChartMetadata';\n\ninterface Props {\n  query: TimeseriesChartQuery;\n  dataFetchOptions?: DataFetchOptions;\n}\n\nexport const useTimeseriesChartData = ({ query, dataFetchOptions }: Props) => {\n  const {\n    data: metadata,\n    isFetched,\n    isInitialLoading: isInitialMetadataLoading,\n  } = useTimeseriesChartMetadata({\n    query,\n    dataFetchOptions,\n  });\n\n  const { data: datapoints, isInitialLoading: isInitialDatapointsLoading } =\n    useTimeseriesDatapointsQuery({\n      query: mapToTimeseriesDatapointsQuery({ query, metadata }),\n      enabled: isFetched,\n    });\n\n  const chartData: Data = useMemo(() => {\n    if (!datapoints || isEmpty(datapoints)) {\n      return EMPTY_DATA;\n    }\n    return mapToChartData({ datapoints, metadata });\n  }, [datapoints, metadata]);\n\n  return {\n    data: chartData,\n    metadata,\n    isLoading: isInitialMetadataLoading || isInitialDatapointsLoading,\n  };\n};\n"],"mappings":";AAAA,SAASA,OAAO,QAAQ,OAAO;AAE/B,OAAOC,OAAO,MAAM,gBAAgB;AAGpC,SAASC,UAAU,QAAQ,oBAAoB;AAE/C,SAASC,4BAA4B,QAAQ,uBAAuB;AACpE,SACEC,cAAc,EACdC,8BAA8B,QACzB,iBAAiB;AAGxB,SAASC,0BAA0B,QAAQ,8BAA8B;AAOzE,OAAO,MAAMC,sBAAsB,GAAG,CAAC;EAAEC,KAAK;EAAEC;AAAwB,CAAC,KAAK;EAAA;EAC5E,MAAM;IACJC,IAAI,EAAEC,QAAQ;IACdC,SAAS;IACTC,gBAAgB,EAAEC;EACpB,CAAC,GAAGR,0BAA0B,CAAC;IAC7BE,KAAK;IACLC;EACF,CAAC,CAAC;EAEF,MAAM;IAAEC,IAAI,EAAEK,UAAU;IAAEF,gBAAgB,EAAEG;EAA2B,CAAC,GACtEb,4BAA4B,CAAC;IAC3BK,KAAK,EAAEH,8BAA8B,CAAC;MAAEG,KAAK;MAAEG;IAAS,CAAC,CAAC;IAC1DM,OAAO,EAAEL;EACX,CAAC,CAAC;EAEJ,MAAMM,SAAe,GAAGlB,OAAO,CAAC,MAAM;IACpC,IAAI,CAACe,UAAU,IAAId,OAAO,CAACc,UAAU,CAAC,EAAE;MACtC,OAAOb,UAAU;IACnB;IACA,OAAOE,cAAc,CAAC;MAAEW,UAAU;MAAEJ;IAAS,CAAC,CAAC;EACjD,CAAC,EAAE,CAACI,UAAU,EAAEJ,QAAQ,CAAC,CAAC;EAE1B,OAAO;IACLD,IAAI,EAAEQ,SAAS;IACfP,QAAQ;IACRQ,SAAS,EAAEL,wBAAwB,IAAIE;EACzC,CAAC;AACH,CAAC;AAAC,GA5BWT,sBAAsB;EAAA,QAK7BD,0BAA0B,EAM5BH,4BAA4B;AAAA"},"metadata":{},"sourceType":"module"}