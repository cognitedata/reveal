{"ast":null,"code":"import { getMarkerPosition } from './getMarkerPosition';\nimport { getPlotStyleData } from './getPlotStyleData';\nconst TOOLTIP_HORIZONTAL_MARGIN = 16;\nexport const getTooltipPosition = (chartRef, plotMouseEvent, tooltipWidth, tooltipHeight, referencePosition = {}) => {\n  if (!plotMouseEvent || !tooltipWidth || !tooltipHeight) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n  const {\n    offsetTop,\n    height,\n    width\n  } = getPlotStyleData(chartRef.current);\n  const {\n    x = 0,\n    y = 0\n  } = {\n    ...getMarkerPosition(plotMouseEvent),\n    ...referencePosition\n  };\n  return {\n    x: calculateTooltipPositionX(x, tooltipWidth, width),\n    y: calculateTooltipPositionY(y, tooltipHeight, offsetTop, height)\n  };\n};\nexport const calculateTooltipPositionX = (markerX, tooltipWidth, gridWidth) => {\n  const x = markerX + TOOLTIP_HORIZONTAL_MARGIN;\n  if (gridWidth - x < tooltipWidth) {\n    return markerX - tooltipWidth - TOOLTIP_HORIZONTAL_MARGIN;\n  }\n  return x;\n};\nexport const calculateTooltipPositionY = (markerY, tooltipHeight, plotOffsetTop, gridHeight) => {\n  const tooltipHeightHalf = tooltipHeight / 2;\n  const referenceMin = plotOffsetTop + tooltipHeightHalf;\n  const referenceMax = plotOffsetTop + gridHeight;\n  if (markerY < referenceMin) {\n    return referenceMin;\n  }\n  const offsetBottom = referenceMax - markerY;\n  if (offsetBottom < tooltipHeightHalf) {\n    const position = markerY - (tooltipHeightHalf - offsetBottom);\n    return Math.max(position, referenceMin);\n  }\n  return markerY;\n};","map":{"version":3,"names":["getMarkerPosition","getPlotStyleData","TOOLTIP_HORIZONTAL_MARGIN","getTooltipPosition","chartRef","plotMouseEvent","tooltipWidth","tooltipHeight","referencePosition","x","y","offsetTop","height","width","current","calculateTooltipPositionX","calculateTooltipPositionY","markerX","gridWidth","markerY","plotOffsetTop","gridHeight","tooltipHeightHalf","referenceMin","referenceMax","offsetBottom","position","Math","max"],"sources":["/Volumes/csvol/fusion/libs/shared/plotting-components/src/LineChart/utils/getTooltipPosition.ts"],"sourcesContent":["import { PlotMouseEvent } from 'plotly.js';\n\nimport { Coordinate } from '../types';\n\nimport { getMarkerPosition } from './getMarkerPosition';\nimport { getPlotStyleData } from './getPlotStyleData';\n\nconst TOOLTIP_HORIZONTAL_MARGIN = 16;\n\nexport const getTooltipPosition = (\n  chartRef: React.RefObject<HTMLDivElement>,\n  plotMouseEvent?: PlotMouseEvent,\n  tooltipWidth?: number,\n  tooltipHeight?: number,\n  referencePosition: Coordinate = {}\n) => {\n  if (!plotMouseEvent || !tooltipWidth || !tooltipHeight) {\n    return {\n      x: 0,\n      y: 0,\n    };\n  }\n\n  const { offsetTop, height, width } = getPlotStyleData(chartRef.current);\n\n  const { x = 0, y = 0 } = {\n    ...getMarkerPosition(plotMouseEvent),\n    ...referencePosition,\n  };\n\n  return {\n    x: calculateTooltipPositionX(x, tooltipWidth, width),\n    y: calculateTooltipPositionY(y, tooltipHeight, offsetTop, height),\n  };\n};\n\nexport const calculateTooltipPositionX = (\n  markerX: number,\n  tooltipWidth: number,\n  gridWidth: number\n) => {\n  const x = markerX + TOOLTIP_HORIZONTAL_MARGIN;\n\n  if (gridWidth - x < tooltipWidth) {\n    return markerX - tooltipWidth - TOOLTIP_HORIZONTAL_MARGIN;\n  }\n\n  return x;\n};\n\nexport const calculateTooltipPositionY = (\n  markerY: number,\n  tooltipHeight: number,\n  plotOffsetTop: number,\n  gridHeight: number\n) => {\n  const tooltipHeightHalf = tooltipHeight / 2;\n  const referenceMin = plotOffsetTop + tooltipHeightHalf;\n  const referenceMax = plotOffsetTop + gridHeight;\n\n  if (markerY < referenceMin) {\n    return referenceMin;\n  }\n\n  const offsetBottom = referenceMax - markerY;\n\n  if (offsetBottom < tooltipHeightHalf) {\n    const position = markerY - (tooltipHeightHalf - offsetBottom);\n    return Math.max(position, referenceMin);\n  }\n\n  return markerY;\n};\n"],"mappings":"AAIA,SAASA,iBAAiB,QAAQ,qBAAqB;AACvD,SAASC,gBAAgB,QAAQ,oBAAoB;AAErD,MAAMC,yBAAyB,GAAG,EAAE;AAEpC,OAAO,MAAMC,kBAAkB,GAAG,CAChCC,QAAyC,EACzCC,cAA+B,EAC/BC,YAAqB,EACrBC,aAAsB,EACtBC,iBAA6B,GAAG,CAAC,CAAC,KAC/B;EACH,IAAI,CAACH,cAAc,IAAI,CAACC,YAAY,IAAI,CAACC,aAAa,EAAE;IACtD,OAAO;MACLE,CAAC,EAAE,CAAC;MACJC,CAAC,EAAE;IACL,CAAC;EACH;EAEA,MAAM;IAAEC,SAAS;IAAEC,MAAM;IAAEC;EAAM,CAAC,GAAGZ,gBAAgB,CAACG,QAAQ,CAACU,OAAO,CAAC;EAEvE,MAAM;IAAEL,CAAC,GAAG,CAAC;IAAEC,CAAC,GAAG;EAAE,CAAC,GAAG;IACvB,GAAGV,iBAAiB,CAACK,cAAc,CAAC;IACpC,GAAGG;EACL,CAAC;EAED,OAAO;IACLC,CAAC,EAAEM,yBAAyB,CAACN,CAAC,EAAEH,YAAY,EAAEO,KAAK,CAAC;IACpDH,CAAC,EAAEM,yBAAyB,CAACN,CAAC,EAAEH,aAAa,EAAEI,SAAS,EAAEC,MAAM;EAClE,CAAC;AACH,CAAC;AAED,OAAO,MAAMG,yBAAyB,GAAG,CACvCE,OAAe,EACfX,YAAoB,EACpBY,SAAiB,KACd;EACH,MAAMT,CAAC,GAAGQ,OAAO,GAAGf,yBAAyB;EAE7C,IAAIgB,SAAS,GAAGT,CAAC,GAAGH,YAAY,EAAE;IAChC,OAAOW,OAAO,GAAGX,YAAY,GAAGJ,yBAAyB;EAC3D;EAEA,OAAOO,CAAC;AACV,CAAC;AAED,OAAO,MAAMO,yBAAyB,GAAG,CACvCG,OAAe,EACfZ,aAAqB,EACrBa,aAAqB,EACrBC,UAAkB,KACf;EACH,MAAMC,iBAAiB,GAAGf,aAAa,GAAG,CAAC;EAC3C,MAAMgB,YAAY,GAAGH,aAAa,GAAGE,iBAAiB;EACtD,MAAME,YAAY,GAAGJ,aAAa,GAAGC,UAAU;EAE/C,IAAIF,OAAO,GAAGI,YAAY,EAAE;IAC1B,OAAOA,YAAY;EACrB;EAEA,MAAME,YAAY,GAAGD,YAAY,GAAGL,OAAO;EAE3C,IAAIM,YAAY,GAAGH,iBAAiB,EAAE;IACpC,MAAMI,QAAQ,GAAGP,OAAO,IAAIG,iBAAiB,GAAGG,YAAY,CAAC;IAC7D,OAAOE,IAAI,CAACC,GAAG,CAACF,QAAQ,EAAEH,YAAY,CAAC;EACzC;EAEA,OAAOJ,OAAO;AAChB,CAAC"},"metadata":{},"sourceType":"module"}