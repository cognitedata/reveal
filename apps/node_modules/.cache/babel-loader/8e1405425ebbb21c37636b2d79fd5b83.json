{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useMemo } from 'react';\nimport omit from 'lodash/omit';\nimport { getAssetSubtreeIdFilter } from '../../../utils';\nimport { mergeDynamicFilterOptions } from '../../../utils/mergeDynamicFilterOptions';\nimport { useEventsUniqueValuesByProperty } from '../../service';\nimport { mapFiltersToEventsAdvancedFilters } from '../transformers';\nexport const useEventsFilterOptions = ({\n  property,\n  filterProperty,\n  searchQuery,\n  filter = {},\n  query\n}) => {\n  _s();\n  const {\n    data = [],\n    isLoading,\n    isError\n  } = useEventsUniqueValuesByProperty({\n    property,\n    query\n  });\n  const omittedFilter = omit(filter, filterProperty || property);\n  const {\n    data: dynamicData = []\n  } = useEventsUniqueValuesByProperty({\n    property,\n    advancedFilter: mapFiltersToEventsAdvancedFilters(omittedFilter, searchQuery),\n    /**\n     * In asset detailed view, we need to filter events according to selected assetSubtreeIds.\n     * But assetSubtreeIds not supported in advanced filter.\n     * so we have to use filter for that.\n     */\n    filter: getAssetSubtreeIdFilter(omittedFilter),\n    query\n  });\n  const options = useMemo(() => {\n    return mergeDynamicFilterOptions(data, dynamicData);\n  }, [data, dynamicData]);\n  return {\n    options,\n    isLoading,\n    isError\n  };\n};\n_s(useEventsFilterOptions, \"zDvp3UIORZ1LkJrz0zUiaaoTy8o=\", false, function () {\n  return [useEventsUniqueValuesByProperty, useEventsUniqueValuesByProperty];\n});","map":{"version":3,"names":["useMemo","omit","getAssetSubtreeIdFilter","mergeDynamicFilterOptions","useEventsUniqueValuesByProperty","mapFiltersToEventsAdvancedFilters","useEventsFilterOptions","property","filterProperty","searchQuery","filter","query","data","isLoading","isError","omittedFilter","dynamicData","advancedFilter","options"],"sources":["/Volumes/csvol/fusion/libs/data-exploration/domain-layer/src/events/internal/queries/useEventsFilterOptions.ts"],"sourcesContent":["import { useMemo } from 'react';\n\nimport omit from 'lodash/omit';\n\nimport { InternalEventsFilters } from '@data-exploration-lib/core';\n\nimport { getAssetSubtreeIdFilter } from '../../../utils';\nimport { mergeDynamicFilterOptions } from '../../../utils/mergeDynamicFilterOptions';\nimport { EventProperty, useEventsUniqueValuesByProperty } from '../../service';\nimport { mapFiltersToEventsAdvancedFilters } from '../transformers';\n\ninterface Props {\n  property: EventProperty;\n  /**\n   * If the property is different from what we input for transformer.\n   * Example: source and sources\n   * Better to fix this in future and remove this.\n   */\n  filterProperty?: string;\n  searchQuery?: string;\n  filter?: InternalEventsFilters;\n  query?: string;\n}\n\nexport const useEventsFilterOptions = ({\n  property,\n  filterProperty,\n  searchQuery,\n  filter = {},\n  query,\n}: Props) => {\n  const {\n    data = [],\n    isLoading,\n    isError,\n  } = useEventsUniqueValuesByProperty({\n    property,\n    query,\n  });\n\n  const omittedFilter = omit(filter, filterProperty || property);\n\n  const { data: dynamicData = [] } = useEventsUniqueValuesByProperty({\n    property,\n    advancedFilter: mapFiltersToEventsAdvancedFilters(\n      omittedFilter,\n      searchQuery\n    ),\n    /**\n     * In asset detailed view, we need to filter events according to selected assetSubtreeIds.\n     * But assetSubtreeIds not supported in advanced filter.\n     * so we have to use filter for that.\n     */\n    filter: getAssetSubtreeIdFilter(omittedFilter),\n    query,\n  });\n\n  const options = useMemo(() => {\n    return mergeDynamicFilterOptions(data, dynamicData);\n  }, [data, dynamicData]);\n\n  return {\n    options,\n    isLoading,\n    isError,\n  };\n};\n"],"mappings":";AAAA,SAASA,OAAO,QAAQ,OAAO;AAE/B,OAAOC,IAAI,MAAM,aAAa;AAI9B,SAASC,uBAAuB,QAAQ,gBAAgB;AACxD,SAASC,yBAAyB,QAAQ,0CAA0C;AACpF,SAAwBC,+BAA+B,QAAQ,eAAe;AAC9E,SAASC,iCAAiC,QAAQ,iBAAiB;AAenE,OAAO,MAAMC,sBAAsB,GAAG,CAAC;EACrCC,QAAQ;EACRC,cAAc;EACdC,WAAW;EACXC,MAAM,GAAG,CAAC,CAAC;EACXC;AACK,CAAC,KAAK;EAAA;EACX,MAAM;IACJC,IAAI,GAAG,EAAE;IACTC,SAAS;IACTC;EACF,CAAC,GAAGV,+BAA+B,CAAC;IAClCG,QAAQ;IACRI;EACF,CAAC,CAAC;EAEF,MAAMI,aAAa,GAAGd,IAAI,CAACS,MAAM,EAAEF,cAAc,IAAID,QAAQ,CAAC;EAE9D,MAAM;IAAEK,IAAI,EAAEI,WAAW,GAAG;EAAG,CAAC,GAAGZ,+BAA+B,CAAC;IACjEG,QAAQ;IACRU,cAAc,EAAEZ,iCAAiC,CAC/CU,aAAa,EACbN,WAAW,CACZ;IACD;AACJ;AACA;AACA;AACA;IACIC,MAAM,EAAER,uBAAuB,CAACa,aAAa,CAAC;IAC9CJ;EACF,CAAC,CAAC;EAEF,MAAMO,OAAO,GAAGlB,OAAO,CAAC,MAAM;IAC5B,OAAOG,yBAAyB,CAACS,IAAI,EAAEI,WAAW,CAAC;EACrD,CAAC,EAAE,CAACJ,IAAI,EAAEI,WAAW,CAAC,CAAC;EAEvB,OAAO;IACLE,OAAO;IACPL,SAAS;IACTC;EACF,CAAC;AACH,CAAC;AAAC,GA1CWR,sBAAsB;EAAA,QAW7BF,+BAA+B,EAOAA,+BAA+B;AAAA"},"metadata":{},"sourceType":"module"}