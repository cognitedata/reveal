/*! For license information please see 498.057881bc.chunk.js.LICENSE.txt */
(self.webpackChunkdata_studio=self.webpackChunkdata_studio||[]).push([[498],{31050:function(e,t,n){var r=n(94117);function i(e){var t,n;function i(t,n){try{var a=e[t](n),s=a.value,u=s instanceof r;Promise.resolve(u?s.wrapped:s).then((function(e){u?i("return"===t?"return":"next",e):o(a.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},94117:function(e){e.exports=function(e){this.wrapped=e},e.exports.__esModule=!0,e.exports.default=e.exports},81506:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},47003:function(e){function t(e){function n(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):n(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):n(t.apply(this.s,arguments))}},new t(e)}e.exports=function(e){var n,r,i,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,i=Symbol.iterator);o--;){if(r&&null!=(n=e[r]))return n.call(e);if(i&&null!=(n=e[i]))return new t(n.call(e));r="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},55486:function(e,t,n){var r=n(94117);e.exports=function(e){return new r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},69100:function(e,t,n){var r=n(99489),i=n(57067);function o(t,n,a){return i()?(e.exports=o=Reflect.construct,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},99842:function(e,t,n){var r=n(29754),i=n(57067),o=n(78585);e.exports=function(e){var t=i();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},16525:function(e,t,n){var r=n(58331);function i(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},29754:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},2205:function(e,t,n){var r=n(99489);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},70430:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},57067:function(e){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},81109:function(e,t,n){var r=n(59713);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},78585:function(e,t,n){var r=n(50008).default,i=n(81506);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},99489:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},58331:function(e,t,n){var r=n(29754);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},551:function(e,t,n){var r=n(31050);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}},e.exports.__esModule=!0,e.exports.default=e.exports},65957:function(e,t,n){var r=n(29754),i=n(99489),o=n(70430),a=n(69100);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},82043:function(e,t,n){var r=n(59713).default,i=n(65957).default,o=n(69100).default,a=n(81506).default,s=n(319).default,u=n(48926).default,c=n(81109).default,l=n(2205).default,d=n(99842).default,f=n(43269).default,p=n(87757),h=n(63038).default,v=n(34575).default,m=n(93913).default,y=n(47003).default,g=n(55486).default,b=n(551).default;"undefined"!=typeof self&&self,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://apps-cdn.cogniteapp.com/@cognite/reveal-parser-worker/1.3.0/",n(n.s=64)}([function(e,t){e.exports=n(70497)},function(e,t,n){"use strict";function r(e,t){if(t(e))for(var n=0;n<e.children.length;n++)r(e.children[n],t)}function i(e,t){if(void 0!==e){var n=e.position,r=e.target;return n.applyMatrix4(t),r.applyMatrix4(t),{position:n,target:r}}}n.d(t,"u",(function(){return r})),n.d(t,"t",(function(){return i})),n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return x})),n.d(t,"o",(function(){return _})),n.d(t,"l",(function(){return w})),n.d(t,"i",(function(){return M})),n.d(t,"m",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"r",(function(){return I})),n.d(t,"c",(function(){return L})),n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return z})),n.d(t,"p",(function(){return U})),n.d(t,"q",(function(){return G})),n.d(t,"j",(function(){return V})),n.d(t,"k",(function(){return q})),n.d(t,"g",(function(){return X})),n.d(t,"h",(function(){return K})),n.d(t,"n",(function(){return J})),n.d(t,"s",(function(){return H}));var o=n(0),a=function(){function e(){v(this,e)}return m(e,null,[{key:"color",value:function(t){var n=e._colors.get(t);if(void 0!==n)return n;var r=e.generateRandomColor();return e._colors.set(t,r),r}},{key:"colorRGB",value:function(t){var n=e.color(t);return[Math.floor(255*n.r),Math.floor(255*n.g),Math.floor(255*n.b)]}},{key:"colorCSS",value:function(t){var n=e.colorRGB(t),r=h(n,3),i=r[0],o=r[1],a=r[2];return"rgb(".concat(i,", ").concat(o,", ").concat(a,")")}},{key:"generateRandomColor",value:function(){var e=Math.random(),t=.4+.6*Math.random(),n=.3+.4*Math.random();return(new o.Color).setHSL(e,t,n)}}]),e}();function s(e,t){var n=t.getBoundingClientRect();if(e instanceof MouseEvent)return{offsetX:e.clientX-n.left,offsetY:e.clientY-n.top};if(e.changedTouches.length>0){var r=e.changedTouches[0];return{offsetX:r.clientX-n.left,offsetY:r.clientY-n.top}}return{offsetX:-1,offsetY:-1}}a._colors=new Map;var y=function(){function e(){v(this,e),this._listeners=[]}return m(e,[{key:"subscribe",value:function(e){this._listeners.push(e)}},{key:"unsubscribe",value:function(e){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},{key:"unsubscribeAll",value:function(){this._listeners.splice(0)}},{key:"fire",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._listeners.forEach((function(e){return e.apply(void 0,t)}))}}]),e}(),g=n(14),b=n.n(g),x=function(){function e(t){var n=this;v(this,e),this._events={click:new y,hover:new y},this.onHoverCallback=b()((function(e){n._events.hover.fire(s(e,n.domElement))}),100),this.domElement=t,this.setupEventListeners()}return m(e,[{key:"on",value:function(e,t){switch(e){case"click":this._events.click.subscribe(t);break;case"hover":this._events.hover.subscribe(t);break;default:w(e)}}},{key:"off",value:function(e,t){switch(e){case"click":this._events.click.unsubscribe(t);break;case"hover":this._events.hover.unsubscribe(t);break;default:w(e)}}},{key:"dispose",value:function(){_(this._events)}},{key:"setupEventListeners",value:function(){var e=this,t=this.domElement,n=!1,r=0,i=!1,a=new o.Vector2,u=function o(s){e.handleClickEvent(s,a,n,i,r),n=!1,i=!1,t.removeEventListener("mouseup",o),t.removeEventListener("touchend",o),t.addEventListener("mousemove",e.onHoverCallback)},c=function(o){n=!0,i=!0,r=o.timeStamp;var c=s(o,t),l=c.offsetX,d=c.offsetY;a.set(l,d),t.addEventListener("mouseup",u),t.addEventListener("touchend",u),t.removeEventListener("mousemove",e.onHoverCallback)};t.addEventListener("mousedown",c),t.addEventListener("touchstart",c),t.addEventListener("mousemove",this.onHoverCallback)}},{key:"isProperClick",value:function(t,n,r,i,o){var a=s(t,this.domElement),u=a.offsetX,c=a.offsetY,l=t.timeStamp-o,d=Math.abs(u-n.x)+Math.abs(c-n.y)>e.maxMoveDistance;return r&&i&&l<e.maxClickDuration&&!d}},{key:"handleClickEvent",value:function(e,t,n,r,i){this.isProperClick(e,t,n,r,i)&&this._events.click.fire(s(e,this.domElement))}}]),e}();function _(e){for(var t=0,n=Object.keys(e);t<n.length;t++)e[n[t]].unsubscribeAll()}function w(e,t){throw new Error(t||"Unexpected object: "+e)}x.maxMoveDistance=8,x.maxClickDuration=250;var M=function(){function e(t,n){if(v(this,e),n<0)throw new Error("Range cannot have negative number of elements");this.from=t,this.count=n,this.toInclusive=t+n-1}return m(e,[{key:"values",value:p.mark((function e(){var t;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.from;case 1:if(!(t<=this.toInclusive)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"toArray",value:function(){return Array.from(this.values())}},{key:"equal",value:function(e){return this.from===e.from&&this.count===e.count}},{key:"contains",value:function(e){return e>=this.from&&e<=this.toInclusive}},{key:"intersects",value:function(e){return this.from<=e.toInclusive&&this.toInclusive>=e.from}},{key:"intersectsOrCoinciding",value:function(e){return this.from<=e.toInclusive+1&&this.toInclusive+1>=e.from}},{key:"intersectionWith",value:function(t){return this.intersects(t)?e.createFromInterval(Math.max(this.from,t.from),Math.min(this.toInclusive,t.toInclusive)):void 0}},{key:"isInside",value:function(e){return this.from>=e.from&&this.toInclusive<=e.toInclusive}},{key:"union",value:function(t){return e.createFromInterval(Math.min(this.from,t.from),Math.max(this.toInclusive,t.toInclusive))}},{key:"forEach",value:function(e){for(var t=this.from;t<=this.toInclusive;++t)e(t)}},{key:"toString",value:function(){return"("+this.from+", "+this.toInclusive+")"}}],[{key:"createFromInterval",value:function(t,n){return new e(t,n-t+1)}},{key:"isNumericRange",value:function(e){if(!e)return!1;var t=e;return void 0!==t.from&&void 0!==t.count&&void 0!==t.toInclusive}}]),e}();function S(e){var t=Math.max(1,E(Math.sqrt(e)));return{width:t,height:Math.max(1,E(e/t))}}var T=Math.log(2);function E(e){return Math.pow(2,Math.ceil(Math.log(e)/T))}var k=n(7),A=n.n(k),P=function(){function e(t,n){v(this,e),this.left=t,this.right=n,this.maxSubtreeDepth=Math.max(this.left.maxSubtreeDepth,this.right.maxSubtreeDepth)+1,this.range=M.createFromInterval(this.left.range.from,this.right.range.toInclusive),this.count=this.left.count+this.right.count}return m(e,[{key:"traverse",value:function(e){this.left.traverse(e),this.right.traverse(e)}},{key:"contains",value:function(e){return!!this.range.contains(e)&&(this.left.contains(e)||this.right.contains(e))}},{key:"addRange",value:function(t){if(!t.intersectsOrCoinciding(this.range)){if(t.from<this.range.from){var n=this.left.addRange(t);return e.fromIndexNodesAndBalance(n,this.right)}var r=this.right.addRange(t);return e.fromIndexNodesAndBalance(this.left,r)}var i=t.intersectsOrCoinciding(this.left.range),o=t.intersectsOrCoinciding(this.right.range);if(i&&o){var a=this.left.soak(t),s=h(a,2),u=s[0],c=s[1],l=this.right.soak(t),d=h(l,2),f=d[0],p=d[1],v=c.union(p);return void 0===u&&void 0===f?new C(v):void 0===u&&void 0!==f?f.addRange(v):void 0===f&&void 0!==u?u.addRange(v):e.fromIndexNodesAndBalance(u,f).addRange(v)}return i?e.fromIndexNodesAndBalance(this.left.addRange(t),this.right):o?e.fromIndexNodesAndBalance(this.left,this.right.addRange(t)):this.left.maxSubtreeDepth<this.right.maxSubtreeDepth?e.fromIndexNodesAndBalance(this.left.addRange(t),this.right):e.fromIndexNodesAndBalance(this.left,this.right.addRange(t))}},{key:"removeRange",value:function(t){if(!t.intersects(this.range))return this;var n=this.soak(t),r=h(n,2),i=r[0],o=r[1],a=void 0,s=void 0;if(o.from<t.from&&(a=M.createFromInterval(o.from,t.from-1)),o.toInclusive>t.toInclusive&&(s=M.createFromInterval(t.toInclusive+1,o.toInclusive)),void 0===i)return void 0!==a&&void 0!==s?e.fromIndexNodesAndBalance(new C(a),new C(s)):null!=a?new C(a):null!=s?new C(s):void 0;var u=i;return void 0!==a&&(u=u.addRange(a)),void 0!==s&&(u=u.addRange(s)),u}},{key:"balance",value:function(){var t=this.left.maxSubtreeDepth,n=this.right.maxSubtreeDepth;if(n+2<=t)return new e(this.left.rotateSmallerRight(),this.right).rotateRight().balance();if(t+2<=n){var r=this.right.rotateSmallerLeft();return new e(this.left,r).rotateLeft().balance()}return this}},{key:"clone",value:function(){return e.fromIndexNodesAndBalance(this.left.clone(),this.right.clone())}},{key:"hasIntersectionWith",value:function(e){return!!e.range.intersects(this.range)&&(this.range.isInside(e.range)?e.hasIntersectionWith(this):!(!this.left.range.intersects(e.range)||!this.left.hasIntersectionWith(e))||!(!this.right.range.intersects(e.range)||!this.right.hasIntersectionWith(e)))}},{key:"soak",value:function(t){var n,r,i,o,a=[this.left,t],s=a[0],u=a[1],c=[this.right,t],l=c[0],d=c[1];if(this.right.range.isInside(t)&&this.left.range.isInside(t))return[void 0,t];this.left.range.intersectsOrCoinciding(t)&&(n=this.left.soak(t),s=(r=h(n,2))[0],u=r[1]),this.right.range.intersectsOrCoinciding(t)&&(i=this.right.soak(t),l=(o=h(i,2))[0],d=o[1]);var f=u.union(d);return null==l?[s,f]:null==s?[l,f]:[e.fromIndexNodesAndBalance(s,l),f]}},{key:"rotateRight",value:function(){return"right"in this.left?new e(this.left.left,new e(this.left.right,this.right)):this}},{key:"rotateLeft",value:function(){return"left"in this.right?new e(new e(this.left,this.right.left),this.right.right):this}},{key:"rotateSmallerLeft",value:function(){if(this.left.maxSubtreeDepth>this.right.maxSubtreeDepth){var e=this.rotateRight();return e.rotateSmallerLeft()}return this}},{key:"rotateSmallerRight",value:function(){if(this.right.maxSubtreeDepth>this.left.maxSubtreeDepth){var e=this.rotateLeft();return e.rotateSmallerRight()}return this}}],[{key:"fromIndexNodesAndBalance",value:function(t,n){return t.range.from>n.range.toInclusive+1?new e(n,t).balance():t.range.toInclusive+1<n.range.from?new e(t,n).balance():void A()(!1,"Internal error in IndexSet: Overlapping nodes")}}]),e}(),C=function(){function e(t){v(this,e),this.range=t,this.maxSubtreeDepth=0,this.count=t.count}return m(e,[{key:"traverse",value:function(e){e(this.range)}},{key:"contains",value:function(e){return this.range.contains(e)}},{key:"addRange",value:function(t){return this.range.intersectsOrCoinciding(t)?new e(this.range.union(t)):P.fromIndexNodesAndBalance(this,new e(t))}},{key:"removeRange",value:function(t){if(!t.intersects(this.range))return this;if(!this.range.isInside(t)){var n=void 0,r=void 0;return this.range.from<t.from&&(n=M.createFromInterval(this.range.from,t.from-1)),this.range.toInclusive>t.toInclusive&&(r=M.createFromInterval(t.toInclusive+1,this.range.toInclusive)),null!=n&&null!=r?P.fromIndexNodesAndBalance(new e(n),new e(r)):null!=n?new e(n):null!=r?new e(r):void 0}}},{key:"hasIntersectionWith",value:function(e){return e.range.intersects(this.range)}},{key:"soak",value:function(e){return this.range.intersectsOrCoinciding(e)?[void 0,this.range.union(e)]:[this,e]}},{key:"clone",value:function(){return new e(this.range)}}],[{key:"fromInterval",value:function(t,n){return new e(M.createFromInterval(t,n))}}]),e}(),O=function(){function e(t){if(v(this,e),null==t)this.rootNode=void 0;else if(M.isNumericRange(t))this.addRange(t);else{var n,r=f(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.add(i)}}catch(e){r.e(e)}finally{r.f()}}}return m(e,[{key:"forEachRange",value:function(e){this.rootNode&&this.rootNode.traverse(e)}},{key:"add",value:function(e){var t=new M(e,1);this.addRange(t)}},{key:"addRange",value:function(e){this.rootNode?this.rootNode=this.rootNode.addRange(e):this.rootNode=new C(e)}},{key:"remove",value:function(e){var t=new M(e,1);this.removeRange(t)}},{key:"removeRange",value:function(e){this.rootNode&&(this.rootNode=this.rootNode.removeRange(e))}},{key:"contains",value:function(e){return!!this.rootNode&&this.rootNode.contains(e)}},{key:"count",get:function(){return this.rootNode?this.rootNode.count:0}},{key:"toRangeArray",value:function(){var e=[];return this.forEachRange((function(t){e.push(t)})),e}},{key:"toIndexArray",value:function(){var e=[];return this.rootNode&&this.forEachRange((function(t){t.forEach((function(t){e.push(t)}))})),e}},{key:"toPlainSet",value:function(){var e=this.toIndexArray();return new Set(e)}},{key:"invertedRanges",value:function(){for(var e=this.toRangeArray(),t=[],n=0;n<e.length-1;n++)e[n].toInclusive+1>=e[n+1].from||t.push(M.createFromInterval(e[n].toInclusive+1,e[n+1].from-1));return t}},{key:"unionWith",value:function(e){var t=this;return this.rootNode?e.forEachRange((function(e){t.rootNode=t.rootNode.addRange(e)})):this.rootNode=e.rootNode,this}},{key:"differenceWith",value:function(e){var t=this;return this.rootNode&&e.forEachRange((function(e){var n;t.rootNode=null===(n=t.rootNode)||void 0===n?void 0:n.removeRange(e)})),this}},{key:"hasIntersectionWith",value:function(t){if(t instanceof e)return void 0!==this.rootNode&&void 0!==t.rootNode&&this.rootNode.hasIntersectionWith(t.rootNode);var n,r=f(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(this.contains(i))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"intersectWith",value:function(e){var t=this;if(this.rootNode&&e.rootNode){if(this.rootNode.range.from<e.rootNode.range.from){var n=M.createFromInterval(this.rootNode.range.from,e.rootNode.range.from-1);if(this.rootNode=this.rootNode.removeRange(n),!this.rootNode)return this}if(this.rootNode.range.toInclusive>e.rootNode.range.toInclusive){var r=M.createFromInterval(e.rootNode.range.toInclusive+1,this.rootNode.range.toInclusive);this.rootNode=this.rootNode.removeRange(r)}e.invertedRanges().forEach((function(e){t.rootNode&&(t.rootNode=t.rootNode.removeRange(e))}))}else this.rootNode&&(this.rootNode=void 0);return this}},{key:"clear",value:function(){this.rootNode=void 0}},{key:"clone",value:function(){var t=new e;return this.rootNode&&(t.rootNode=this.rootNode.clone()),t}}]),e}();function I(e,t,n){var r=function(e){return Math.abs(e)}(e);if(0!=r){var i=function(e,t){return t<e?0:1}(0,-e),o=D(function(e){return Math.log(e)/Math.log(2)}(r)),a=r/R(o);a<1&&(o-=1),o+=127,t[n]=128*i+D(o*R(-1)),t[n+1]=128*N(o,2)+N(D(128*a),128),t[n+2]=D(N(D(a*R(15)),R(8))),t[n+3]=D(R(23)*N(a,R(-15)))}}function R(e){return Math.pow(2,e)}function N(e,t){return e-t*D(e/t)}function D(e){return Math.floor(e)}var L=function(){function e(t,n){v(this,e),this._numFilled=0,this._batchIdCounter=0,this._batchMap=new Map,this._type=n;var r=Math.pow(2,Math.ceil(Math.log2(t)));this._buffer=new n(r)}return m(e,[{key:"length",get:function(){return this._numFilled}},{key:"buffer",get:function(){return this._buffer}},{key:"add",value:function(e){var t=!1;if(this._numFilled+e.length>this._buffer.length){var n=Math.pow(2,Math.ceil(Math.log2(this._numFilled+e.length)));this.allocateNewBuffer(n),t=!0}this._buffer.set(e,this._numFilled);var r=this.createBatch(e);return this._numFilled+=e.length,{batchId:r,bufferIsReallocated:t}}},{key:"remove",value:function(e){var t=this._batchMap.get(e);if(!t)throw new Error("batch does not exist in buffer");this._buffer.copyWithin(t.from,t.from+t.count,this.buffer.length),this._numFilled-=t.count,this._currentTail===t&&(this._currentTail=t.prev);var n=t.prev,r=t.next;n&&(n.next=r),r&&(r.prev=n);for(var i=r;i;)i.from-=t.count,i=i.next;this._batchMap.delete(e)}},{key:"createBatch",value:function(e){var t={from:this._numFilled,count:e.length,prev:this._currentTail,next:void 0};this._currentTail&&(this._currentTail.next=t),this._currentTail=t;var n=this._batchIdCounter;return this._batchIdCounter++,this._batchMap.set(n,t),n}},{key:"allocateNewBuffer",value:function(e){var t=new this._type(e);t.set(this._buffer),this._buffer=t}}]),e}(),B=new o.BufferGeometry,F=function(e){l(n,e);var t=d(n);function n(){var e;return v(this,n),(e=t.apply(this,arguments))._isDisposed=!1,e._referenceCount=0,e}return m(n,[{key:"reference",value:function(){this.ensureNotDisposed(),this._referenceCount++}},{key:"dereference",value:function(){if(this.ensureNotDisposed(),0===this._referenceCount)throw new Error("No references");0==--this._referenceCount&&this.dispose()}},{key:"dispose",value:function(){this.ensureNotDisposed(),this._isDisposed=!0;var e,t=this.children.filter((function(e){return e instanceof o.Mesh})).map((function(e){return e})),n=f(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;void 0!==r.geometry&&(r.geometry.dispose(),r.geometry=B)}}catch(e){n.e(e)}finally{n.f()}}},{key:"ensureNotDisposed",value:function(){if(this._isDisposed)throw new Error("Already disposed/dereferenced")}}]),n}(o.Group),j={camPos:new o.Vector3,bounds:new o.Box3},z=function(e){l(n,e);var t=d(n);function n(e){var r;return v(this,n),(r=t.call(this))._activeLevel=0,r._levels=[],r.isLOD=!0,r.autoUpdate=!0,r._boundingBox=e.clone(),r.type="BoundingBoxLOD",r}return m(n,[{key:"setBoundingBox",value:function(e){this._boundingBox.copy(e)}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._levels.push({object:e,distance:Math.abs(t)}),this._levels.sort((function(e,t){return t.distance-e.distance})),e.visible=!1,this.add(e)}},{key:"getCurrentLevel",value:function(){return this._levels.length>0?this._levels.length-this._activeLevel-1:0}},{key:"update",value:function(e){this.updateCurrentLevel(e)}},{key:"updateCurrentLevel",value:function(e){var t=this._levels,n=j.camPos,r=j.bounds;r.copy(this._boundingBox).applyMatrix4(this.matrixWorld);var i=e instanceof o.PerspectiveCamera?e.zoom:1;if(t.length>0){n.setFromMatrixPosition(e.matrixWorld);var a=r.distanceToPoint(n)/i;t[this._activeLevel].object.visible=!1,this._activeLevel=t.findIndex((function(e){return a>=e.distance})),this._activeLevel=this._activeLevel>=0?this._activeLevel:t.length-1,t[this._activeLevel].object.visible=!0}}}]),n}(o.Object3D);function U(e){return[new o.Vector3(e.min.x,e.min.y,e.min.z),new o.Vector3(e.min.x,e.min.y,e.max.z),new o.Vector3(e.min.x,e.max.y,e.min.z),new o.Vector3(e.min.x,e.max.y,e.max.z),new o.Vector3(e.max.x,e.min.y,e.min.z),new o.Vector3(e.max.x,e.min.y,e.max.z),new o.Vector3(e.max.x,e.max.y,e.min.z),new o.Vector3(e.max.x,e.max.y,e.max.z)]}function G(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}var V=function(){function e(t){v(this,e),this._originalState={},this._renderer=t,this._originalState={}}return m(e,[{key:"setClearColor",value:function(e,t){this._originalState=c({clearColor:this._renderer.getClearColor(new o.Color),clearAlpha:this._renderer.getClearAlpha()},this._originalState),this._renderer.setClearColor(e,t)}},{key:"setSize",value:function(e,t){this._originalState=c({size:this._renderer.getSize(new o.Vector2)},this._originalState),this._renderer.setSize(e,t)}},{key:"localClippingEnabled",set:function(e){this._originalState=c({localClippingEnabled:this._renderer.localClippingEnabled},this._originalState),this._renderer.localClippingEnabled=e}},{key:"autoClear",set:function(e){this._originalState=c({autoClear:this._renderer.autoClear},this._originalState),this._renderer.autoClear=e}},{key:"setRenderTarget",value:function(e){this._originalState=c({renderTarget:this._renderer.getRenderTarget()},this._originalState),this._renderer.setRenderTarget(e)}},{key:"resetState",value:function(){void 0!==this._originalState.autoClear&&(this._renderer.autoClear=this._originalState.autoClear),void 0!==this._originalState.clearColor&&this._renderer.setClearColor(this._originalState.clearColor,this._originalState.clearAlpha),void 0!==this._originalState.localClippingEnabled&&(this._renderer.localClippingEnabled=this._originalState.localClippingEnabled),void 0!==this._originalState.size&&this._renderer.setSize(this._originalState.size.width,this._originalState.size.height),void 0!==this._originalState.renderTarget&&this._renderer.setRenderTarget(this._originalState.renderTarget),this._originalState={}}}]),e}(),W=n(22),H={publicPath:""},Z=n(10),q=function(){function e(){v(this,e),this.workerList=[];for(var t,n=this.determineNumberOfWorkers(),r=0;r<n;r++){var i={worker:Object(W.wrap)(this.createWorker()),activeJobCount:0,messageIdCounter:0};this.workerList.push(i)}(t=u(p.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,f,v,m;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getVersion();case 3:n=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),n="1.1.0";case 9:if(i=(r="1.3.0").split(".").map((function(e){return parseInt(e,10)})),o=h(i,3),a=o[0],s=o[1],u=o[2],c=n.split(".").map((function(e){return parseInt(e,10)})),l=h(c,3),d=l[0],f=l[1],v=l[2],m="Update your local copy of @cognite/reveal-parser-worker. Required version is ".concat(r,". Received ").concat(n,"."),a===d){e.next=12;break}throw new Error(m);case 12:if(!(f<s)){e.next=14;break}throw new Error(m);case 14:if(!(f===s&&v<u)){e.next=16;break}throw new Error(m);case 16:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return t.apply(this,arguments)})(this.workerList[0].worker).catch((function(e){return Z.a.error(e)})),this.workerObjUrl&&URL.revokeObjectURL(this.workerObjUrl)}return m(e,[{key:"createWorker",value:function(){var e=(H.publicPath||n.p)+"reveal.parser.worker.js",t={name:"reveal.parser #"+this.workerList.length};if(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.origin,n=function(e){return!e.match(/^.*\/\//)};if(n(t))throw new Error("isTheSameDomain: the second argument must be an absolute url or omitted. Received "+t);if(n(e))return!0;try{var r=[e,t].map((function(e){return e.startsWith("//")?"https:"+e:e})).map((function(e){return new URL(e)}));return r[0].host===r[1].host}catch(n){return console.error("can not create URLs for ".concat(e," and ").concat(t),n),!1}}(e))return new Worker(e,t);if(!this.workerObjUrl){var r=new Blob(["importScripts(".concat(JSON.stringify(e),");")],{type:"text/javascript"});this.workerObjUrl=URL.createObjectURL(r)}return new Worker(this.workerObjUrl,t)}},{key:"postWorkToAvailable",value:(t=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.workerList.reduce((function(e,t){return e.activeJobCount>t.activeJobCount?t:e}),this.workerList[0]),n.activeJobCount+=1,e.next=4,u(p.mark((function e(){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(n.worker);case 3:return e.abrupt("return",e.sent);case 4:return e.prev=4,n.activeJobCount-=1,e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[0,,4,7]])})))();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"determineNumberOfWorkers",value:function(){return Math.max(2,Math.min(4,window.navigator.hardwareConcurrency||2))}}],[{key:"defaultPool",get:function(){return e._defaultPool=e._defaultPool||new e,e._defaultPool}}]),e;var t}(),Y=function(){function e(t){v(this,e),this._value=t,this._lastAccessTime=Date.now()}return m(e,[{key:"value",get:function(){return this.touch(),this._value}},{key:"lastAccessTime",get:function(){return this._lastAccessTime}},{key:"touch",value:function(){this._lastAccessTime=Date.now()}}]),e}(),X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;v(this,e),this._data=new Map,this._maxElementsInCache=t,this._defaultCleanupCount=r,this._removeCallback=n}return m(e,[{key:"has",value:function(e){return this._data.has(e)}},{key:"forceInsert",value:function(e,t){this.isFull()&&this.cleanCache(this._defaultCleanupCount),this.insert(e,t)}},{key:"insert",value:function(e,t){if(!(this._data.size<this._maxElementsInCache))throw new Error("Cache full, please clean Cache and retry adding data");this._data.set(e,new Y(t))}},{key:"remove",value:function(e){if(void 0!==this._removeCallback){var t=this._data.get(e);void 0!==t&&this._removeCallback(t.value)}this._data.delete(e)}},{key:"get",value:function(e){var t=this._data.get(e);if(void 0!==t)return t.value;throw new Error("Cache element ".concat(e," does not exist"))}},{key:"isFull",value:function(){return!(this._data.size<this._maxElementsInCache)}},{key:"cleanCache",value:function(e){var t=Array.from(this._data.entries());t.sort((function(e,t){return t[1].lastAccessTime-e[1].lastAccessTime}));for(var n=0;n<e;n++){var r=t.pop();if(void 0===r)return;this.remove(r[0])}}},{key:"clear",value:function(){if(void 0!==this._removeCallback){var e,t=f(this._data.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this._removeCallback(n.value)}}catch(e){t.e(e)}finally{t.f()}}this._data.clear()}}]),e}(),K=function(){function e(t,n){v(this,e),this._cache=new Map,this._retrieves=new Map,this._capacity=t,this._disposeCallback=n}return m(e,[{key:"get",value:function(e){var t=this._retrieves.get(e)||0;return this._retrieves.set(e,t+1),this._cache.get(e)}},{key:"set",value:function(e,t){return this._cache.has(e)||this._capacity<this._cache.size?(this._cache.set(e,t),!0):(this._cache.set(e,t),this.ensureWithinCapacity(),this._cache.has(e))}},{key:"remove",value:function(e){this._retrieves.delete(e);var t=this._cache.get(e);return void 0!==t&&(void 0!==this._disposeCallback&&this._disposeCallback(t),this._cache.delete(e),!0)}},{key:"clear",value:function(){if(void 0!==this._disposeCallback){var e,t=f(this._cache.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this._disposeCallback(n)}}catch(e){t.e(e)}finally{t.f()}}this._retrieves.clear(),this._cache.clear()}},{key:"ensureWithinCapacity",value:function(){var e=this;if(!(this._capacity>=this._cache.size)){var t,n=Array.from(this._cache.keys()).map((function(t){return{key:t,retrivalCount:e._retrieves.get(t)||0}})).sort((function(e,t){return e.retrivalCount-t.retrivalCount})).slice(0,this._cache.size-this._capacity).map((function(e){return e.key})),r=f(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.remove(i)}}catch(e){r.e(e)}finally{r.f()}}}}]),e}();function J(){this.array=null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"f",(function(){return E})),n.d(t,"e",(function(){return k})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return b})),n.d(t,"n",(function(){return N})),n.d(t,"o",(function(){return D})),n.d(t,"p",(function(){return B})),n.d(t,"q",(function(){return L})),n.d(t,"m",(function(){return j})),n.d(t,"i",(function(){return U})),n.d(t,"t",(function(){return W})),n.d(t,"k",(function(){return X})),n.d(t,"w",(function(){return q})),n.d(t,"r",(function(){return $})),n.d(t,"v",(function(){return J})),n.d(t,"j",(function(){return G})),n.d(t,"u",(function(){return H})),n.d(t,"s",(function(){return ee})),n.d(t,"h",(function(){return _})),n.d(t,"l",(function(){return te}));var r=n(0),i=n(1),o=n(24),y=n.n(o),g=function(){function e(t,n,r,i,o){v(this,e),this.version=t,this.maxTreeIndex=n,this.root=i,this.sectors=o,this.unit=r}return m(e,[{key:"sectorCount",get:function(){return this.sectors.size}},{key:"getSectorById",value:function(e){return this.sectors.get(e)}},{key:"getAllSectors",value:function(){return s(this.sectors.values())}},{key:"getSectorsContainingPoint",value:function(e){var t=[];return Object(i.u)(this.root,(function(n){return!!n.bounds.containsPoint(e)&&(t.push(n),!0)})),t}},{key:"getSectorsIntersectingBox",value:function(e){var t=[];return Object(i.u)(this.root,(function(n){return!!n.bounds.intersectsBox(e)&&(t.push(n),!0)})),t}},{key:"getBoundsOfMostGeometry",value:function(){if(0===this.root.children.length)return this.root.bounds;var e=[],t=[];Object(i.u)(this.root,(function(n){return 0===n.children.length&&(t.push(n.bounds.min.toArray(),n.bounds.max.toArray()),e.push(n.bounds,n.bounds)),!0}));var n=Math.min(t.length,4),o=y()(t,n,"kmpp",10),a=new Array(o.idxs.length).fill(0),s=a.map((function(e){return new r.Box3}));o.idxs.map((function(e){return a[e]++}));var u=a.reduce((function(e,t,n){return t>e.count&&(e.count=t,e.idx=n),e}),{count:0,idx:-1}).idx;o.idxs.forEach((function(t,n){a[t]++,s[t].expandByPoint(e[n].min),s[t].expandByPoint(e[n].max)}));var c=s.filter((function(e,t){return!(t===u||!e.intersectsBox(s[u]))}));if(c.length>0){var l=s[u].clone();return c.forEach((function(e){l.expandByPoint(e.min),l.expandByPoint(e.max)})),l}return s[u]}},{key:"getSectorsIntersectingFrustum",value:function(e,t){var n=(new r.Matrix4).multiplyMatrices(e,t),o=(new r.Frustum).setFromProjectionMatrix(n),a=[];return Object(i.u)(this.root,(function(e){return!!o.intersectsBox(e.bounds)&&(a.push(e),!0)})),a}}]),e}();var b,x=function(){function e(){v(this,e)}return m(e,[{key:"parse",value:function(e){var t=e.version;switch(t){case 8:return function(e){var t=new Map,n=[];e.sectors.forEach((function(e){var i=function(e){var t=function(e){return e.facesFile?c(c({},e.facesFile),{},{recursiveCoverageFactors:e.facesFile.recursiveCoverageFactors||e.facesFile.coverageFactors}):{quadSize:-1,coverageFactors:{xy:-1,yz:-1,xz:-1},recursiveCoverageFactors:{xy:-1,yz:-1,xz:-1},fileName:null,downloadSize:e.indexFile.downloadSize}}(e),n=e.boundingBox,i=n.min.x,o=n.min.y,a=n.min.z,s=n.max.x,u=n.max.y,l=n.max.z;return{id:e.id,path:e.path,depth:e.depth,bounds:new r.Box3(new r.Vector3(i,o,a),new r.Vector3(s,u,l)),estimatedDrawCallCount:e.estimatedDrawCallCount,estimatedRenderCost:e.estimatedTriangleCount||0,indexFile:c({},e.indexFile),facesFile:t,children:[]}}(e);t.set(e.id,i),n[e.id]=e.parentId}));var i,o=f(t.values());try{for(o.s();!(i=o.n()).done;){var a=i.value,s=n[a.id];-1!==s&&t.get(s).children.push(a)}}catch(e){o.e(e)}finally{o.f()}var u=t.get(0);if(!u)throw new Error("Root sector not found, must have ID 0");!function e(t,n){!function(e){return-1===e.facesFile.coverageFactors.xy}(t)?t.children.forEach((function(n){return e(n,t.facesFile)})):(t.facesFile.coverageFactors.xy=n.recursiveCoverageFactors.xy,t.facesFile.coverageFactors.yz=n.recursiveCoverageFactors.yz,t.facesFile.coverageFactors.xz=n.recursiveCoverageFactors.xz,t.facesFile.recursiveCoverageFactors.xy=n.recursiveCoverageFactors.xy,t.facesFile.recursiveCoverageFactors.yz=n.recursiveCoverageFactors.yz,t.facesFile.recursiveCoverageFactors.xz=n.recursiveCoverageFactors.xz,t.children.forEach((function(t){return e(t,n)})))}(u,u.facesFile);var l=null!==e.unit?e.unit:"Meters";return new g(e.version,e.maxTreeIndex,l,u,t)}(e);case void 0:throw new Error('Metadata must contain a "version"-field');default:throw new Error("Version ".concat(t," is not supported"))}}}]),e}(),_=new Map([["Meters",1],["Centimeters",.01],["Millimeters",.001],["Micrometers",1e-6],["Kilometers",1e3],["Feet",.3048],["Inches",.0254],["Yards",.9144],["Miles",1609.34],["Mils",254e-7],["Microinches",2.54e-8]]),w=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"scene.json";v(this,e),this._currentModelIdentifier=0,this._modelMetadataProvider=t,this._modelDataProvider=n,this._cadSceneParser=r,this._blobFileName=i}return m(e,[{key:"loadData",value:(t=u(p.mark((function e(t){var n,o,a,s,u,c,l,d,f;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._modelMetadataProvider.getModelUri(t),o=this._modelMetadataProvider.getModelMatrix(t),a=this._modelMetadataProvider.getModelCamera(t),e.next=5,n;case 5:return s=e.sent,e.next=8,this._modelDataProvider.getJsonFile(s,this._blobFileName);case 8:return u=e.sent,c=this._cadSceneParser.parse(u),e.t0=function(e,t){var n=_.get(e);if(void 0===n)throw new Error("Unknown model unit '".concat(e,"'"));return(new r.Matrix4).makeScale(n,n,n).multiply(t)},e.t1=c.unit,e.next=14,o;case 14:return e.t2=e.sent,l=(0,e.t0)(e.t1,e.t2),d=(new r.Matrix4).copy(l).invert(),e.next=19,a;case 19:return f=e.sent,e.abrupt("return",{modelIdentifier:""+this._currentModelIdentifier++,modelBaseUrl:s,geometryClipBox:null,modelMatrix:l,inverseModelMatrix:d,cameraConfiguration:Object(i.t)(f,l),scene:c});case 21:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t}(),M=n(7),S=n.n(M),T=function(){function e(){v(this,e)}return m(e,[{key:"createSectorScene",value:function(e,t,n,r){S()(8===e,"Only version 8 is currently supported");var o=new Map;return Object(i.u)(r,(function(e){return o.set(e.id,e),!0})),new g(e,t,n,r,o)}}]),e}();!function(e){e[e.Discarded=0]="Discarded",e[e.Simple=1]="Simple",e[e.Detailed=2]="Detailed"}(b||(b={}));var E=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return v(this,n),(o=t.call(this))._lod=b.Discarded,o._updatedTimestamp=Date.now(),o.name="Sector ".concat(r," [id=").concat(e,"]"),o.sectorId=e,o.sectorPath=r,o.bounds=i,o.depth=function(e){for(var t=0,n=0;n<e.length;++n)t+="/"===e[n]?1:0;return t-1}(r),o}return m(n,[{key:"levelOfDetail",get:function(){return this._lod}},{key:"group",get:function(){return this._group}},{key:"updatedTimestamp",get:function(){return this._updatedTimestamp}},{key:"updateGeometry",value:function(e,t){this.resetGeometry(),this._group=e,void 0!==this._group&&this._group.reference(),this._lod=t,this._updatedTimestamp=Date.now(),this.visible=this._lod!==b.Discarded,this.updateMatrixWorld(!0)}},{key:"resetGeometry",value:function(){void 0!==this._group&&(this._group.dereference(),this.remove(this._group)),this._group=void 0,this._lod=b.Discarded,this._updatedTimestamp=Date.now()}}]),n}(r.Group),k=function(e){l(n,e);var t=d(n);function n(e){var r;v(this,n);var i=e.scene.root.bounds.clone();i.applyMatrix4(e.modelMatrix),r=t.call(this,0,"/",i);var o=e.scene,s=e.modelMatrix;return r.sectorNodeMap=new Map,function e(t,n,r,i){var o=t.bounds.clone();o.applyMatrix4(i);var a=new E(t.id,t.path,o);a.name="Sector "+t.id,n.add(a),a.matrixAutoUpdate=!1,a.updateMatrixWorld(!0),r.set(t.id,a);var s,u=f(t.children);try{for(u.s();!(s=u.n()).done;)e(s.value,a,r,i)}catch(e){u.e(e)}finally{u.f()}}(o.root,a(r),r.sectorNodeMap,s),r.matrixAutoUpdate=!1,r.setModelTransformation(s),r}return m(n,[{key:"setModelTransformation",value:function(e){this.matrix.copy(e),this.updateMatrixWorld(!0)}},{key:"getModelTransformation",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Matrix4).copy(this.matrix)}}]),n}(E),A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.k.defaultPool;v(this,e),this.workerPool=t}return m(e,[{key:"parseI3D",value:function(e){return this.parseDetailed(e)}},{key:"parseF3D",value:function(e){return this.parseSimple(e)}},{key:"parseCTM",value:function(e){return this.parseCtm(e)}},{key:"parseSimple",value:(r=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.workerPool.postWorkToAvailable(function(){var e=u(p.mark((function e(n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.parseQuads(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"parseDetailed",value:(n=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.workerPool.postWorkToAvailable(function(){var e=u(p.mark((function e(n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.parseSector(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parseCtm",value:(t=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.workerPool.postWorkToAvailable(function(){var e=u(p.mark((function e(n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.parseCtm(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t,n,r}(),P={centerA:new r.Vector3,centerB:new r.Vector3,sphere:new r.Sphere,box:new r.Box3},C={vertex1:new r.Vector3,vertex2:new r.Vector3,vertex3:new r.Vector3,vertex4:new r.Vector3},O={instanceMatrix:new r.Matrix4},I={center:new r.Vector3,size:new r.Vector3};function R(e,t,n,i){for(var o=Array.from(t.values()).reduce((function(e,t){return Math.max(e,t.offset+t.size)}),0),a=e.length/o,s=new Float32Array(e.buffer),u=new r.Box3,c=new Uint8Array(e.length),l=0,d=0;d<a;++d)if(i(d,o,s,u),n.intersectsBox(u)){var f=e.subarray(d*o,(d+1)*o);c.set(f,l*o),l++}return c.slice(0,l*o)}function N(e,t,n,r){if(null===r)return e;var i=t.get("instanceMatrix");return S()(void 0!==i),R(e,t,r,(function(e,t,r,o){!function(e,t,n,r,i,o){var a=O.instanceMatrix,s=(r*n+e.offset)/t.BYTES_PER_ELEMENT;a.set(t[s+0],t[s+4],t[s+8],t[s+12],t[s+1],t[s+5],t[s+9],t[s+13],t[s+2],t[s+6],t[s+10],t[s+14],t[s+3],t[s+7],t[s+11],t[s+15]),o.copy(i).applyMatrix4(a)}(i,r,t,e,n,o)}))}function D(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"radiusA",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"radiusB";if(null===n)return e;var o=t.get("centerA"),a=t.get("centerB"),s=t.get(r),u=t.get(i);return S()(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==u),R(e,t,n,(function(e,t,n,r){!function(e,t,n,r,i,o,a,s){var u=P.centerA,c=P.centerB,l=P.sphere,d=P.box;function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a*o+e.offset)/i.BYTES_PER_ELEMENT;return i[n+t]}u.set(f(e,0),f(e,1),f(e,2)),c.set(f(t,0),f(t,1),f(t,2));var p=f(n),h=f(r);l.set(u,p),l.getBoundingBox(s),l.set(c,h),l.getBoundingBox(d),s.expandByPoint(d.min),s.expandByPoint(d.max)}(o,a,s,u,n,t,e,r)}))}function L(e,t,n){if(null===n)return e;var r=t.get("vertex1"),i=t.get("vertex2"),o=t.get("vertex3"),a=t.get("vertex4");return S()(void 0!==r&&void 0!==i&&void 0!==o&&void 0!==a),R(e,t,n,(function(e,t,n,s){!function(e,t,n,r,i,o,a,s){var u=C.vertex1,c=C.vertex2,l=C.vertex3,d=C.vertex4;function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a*o+e.offset)/i.BYTES_PER_ELEMENT;return i[n+t]}u.set(f(e,0),f(e,1),f(e,2)),c.set(f(t,0),f(t,1),f(t,2)),l.set(f(n,0),f(n,1),f(n,2)),d.set(f(r,0),f(r,1),f(r,2)),s.setFromPoints([u,c,l,d])}(r,i,o,a,n,t,e,s)}))}function B(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"horizontalRadius",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"verticalRadius";if(null===n)return e;var o=t.get("center"),a=t.get(r),s=t.get(i),u=t.get("height");return S()(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==u),R(e,t,n,(function(e,t,n,r){!function(e,t,n,r,i,o,a,s){var u=I.center,c=I.size;function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a*o+e.offset)/i.BYTES_PER_ELEMENT;return i[n+t]}u.set(l(e,0),l(e,1),l(e,2));var d=l(t),f=l(n),p=l(r),h=2*Math.max(d,f,p);c.set(h,h,h),s.setFromCenterAndSize(u,c)}(o,a,s,u,n,t,e,r)}))}var F={p:new r.Vector3,instanceMatrix:new r.Matrix4,baseBounds:new r.Box3,instanceBounds:new r.Box3};function j(e,t,n,r){if(null===r)return n;var i=F.p,o=F.instanceMatrix,a=F.baseBounds,s=F.instanceBounds;a.makeEmpty();for(var u=n.triangleOffset;u<n.triangleOffset+n.triangleCount;++u){var c=t[3*u+0],l=t[3*u+1],d=t[3*u+2];i.set(e[c+0],e[c+1],e[c+2]),a.expandByPoint(i),i.set(e[l+0],e[l+1],e[l+2]),a.expandByPoint(i),i.set(e[d+0],e[d+1],e[d+2]),a.expandByPoint(i)}for(var f,p,h=0,v=n.treeIndices.length,m=new Float32Array(n.instanceMatrices.length),y=new Float32Array(v),g=new Uint8Array(4*v),b=0;b<v;++b)if(f=n.instanceMatrices,p=b,o.set(f[p+0],f[p+4],f[p+8],f[p+12],f[p+1],f[p+5],f[p+9],f[p+13],f[p+2],f[p+6],f[p+10],f[p+14],f[p+3],f[p+7],f[p+11],f[p+15]),s.copy(a).applyMatrix4(o),r.intersectsBox(s)){var x=n.instanceMatrices.subarray(16*b,16*(b+1)),_=n.colors.subarray(4*b,4*(b+1)),w=n.treeIndices[b];m.set(x,16*h),g.set(_,4*h),y[h]=w,h++}return v===h?n:{triangleCount:n.triangleCount,triangleOffset:n.triangleOffset,instanceMatrices:m.slice(0,16*h),colors:g.slice(0,4*h),treeIndices:y.slice(0,h)}}var z=function(){var e=new r.BoxBufferGeometry(1,1,1,1,1,1);try{var t={index:e.getIndex(),position:e.getAttribute("position"),normal:e.getAttribute("normal")};return e.computeBoundingBox(),{boxGeometry:t,boxGeometryBoundingBox:e.boundingBox}}finally{e.dispose()}}(),U=z.boxGeometry,G=z.boxGeometryBoundingBox,V=function(){var e=new r.PlaneBufferGeometry(1,1,1,1);try{var t={index:e.getIndex(),position:e.getAttribute("position"),normal:e.getAttribute("normal")};return e.computeBoundingBox(),{quadGeometry:t,quadGeometryBoundingBox:e.boundingBox}}finally{e.dispose()}}(),W=V.quadGeometry,H=V.quadGeometryBoundingBox,Z=function(){var e=[0,0,0,1,1,1,2,2,2,3,3,3];return{trapeziumGeometry:{index:new r.BufferAttribute(new Uint16Array([0,1,3,0,3,2]),1),position:new r.BufferAttribute(new Float32Array(e),3)},trapeziumGeometryBoundingBox:(new r.Box3).setFromArray(e)}}(),q=Z.trapeziumGeometry,Y=(Z.trapeziumGeometryBoundingBox,function(){var e=[];e.push(-1,1,-1),e.push(-1,-1,-1),e.push(1,1,-1),e.push(1,-1,-1),e.push(1,1,1),e.push(1,-1,1);var t=new Uint16Array([1,2,0,1,3,2,3,4,2,3,5,4]);return{coneGeometry:{index:new r.BufferAttribute(t,1),position:new r.BufferAttribute(new Float32Array(e),3)},coneGeometryBoundingBox:(new r.Box3).setFromArray(e)}}()),X=Y.coneGeometry,K=(Y.coneGeometryBoundingBox,function(){var e=function(e,t){return[e,2*t*Math.PI]};return{torusLodGeometries:[{tubularSegments:9,radialSegments:18},{tubularSegments:5,radialSegments:12},{tubularSegments:4,radialSegments:5}].map((function(t){var n=t.tubularSegments;return function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return[e,t,0]},i=[],o=[],a=1/e,s=1/t,u=0;u<=t;u++)for(var c=0;c<=e;c++){var l=n(c*a,u*s),d=h(l,3),f=d[0],p=d[1],v=d[2];i.push(f||0,p||0,v||0)}for(var m=1;m<=t;m++)for(var y=1;y<=e;y++){var g=(e+1)*m+y-1,b=(e+1)*(m-1)+y-1,x=(e+1)*(m-1)+y,_=(e+1)*m+y;o.push(g,b,_),o.push(b,x,_)}return{index:new r.Uint16BufferAttribute(o,1),position:new r.Float32BufferAttribute(i,3)}}(t.radialSegments,n,e)}))}}()),J=K.torusLodGeometries,Q=function(){var e=new r.CylinderBufferGeometry(.5,.5,1,6);try{e.applyMatrix4((new r.Matrix4).makeRotationX(-Math.PI/2));var t={index:e.getIndex(),position:e.getAttribute("position"),normal:e.getAttribute("normal")};return{nutGeometry:t,nutGeometryBoundingBox:(new r.Box3).setFromArray(t.position.array)}}finally{e.dispose()}}(),$=Q.nutGeometry,ee=Q.nutGeometryBoundingBox;function te(e,t,n,o){var a,s=[],u=e.filter((function(e){return null===o||function(e,t){var n=ne.p,r=ne.box;r.makeEmpty();for(var i=0;i<e.vertices.length;i+=3)n.set(e.vertices[i+0],e.vertices[i+1],e.vertices[i+2]),r.expandByPoint(n);return t.intersectsBox(r)}(e,o)})),c=f(u);try{for(c.s();!(a=c.n()).done;){var l=a.value,d=new r.BufferGeometry,p=new r.Uint32BufferAttribute(l.indices.buffer,1).onUpload(i.n),h=new r.Float32BufferAttribute(l.vertices.buffer,3).onUpload(i.n),v=new r.Uint8BufferAttribute(l.colors.buffer,3).onUpload(i.n),m=new r.Float32BufferAttribute(l.treeIndices.buffer,1).onUpload(i.n);d.setIndex(p),d.setAttribute("color",v),d.setAttribute("position",h),d.setAttribute("treeIndex",m),d.boundingBox=t.clone(),d.boundingSphere=new r.Sphere,t.getBoundingSphere(d.boundingSphere);var y=new r.Mesh(d,n);y.name="Triangle mesh "+l.fileId,y.userData.treeIndices=new Set(l.treeIndices),s.push(y)}}catch(e){c.e(e)}finally{c.f()}return s}var ne={p:new r.Vector3,box:new r.Box3}},function(e,t){e.exports=n(60552)},function(e,t){e.exports=n(35400)},function(e,t){e.exports=n(66796)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return M})),n.d(t,"h",(function(){return S})),n.d(t,"e",(function(){return r}));var r,i=function(){function e(t){v(this,e),this.client=t,this.authenticationPromise=t.authenticate()}return m(e,[{key:"headers",get:function(){return this.client.getDefaultRequestHeaders()}},{key:"getBinaryFile",value:(r=u(p.mark((function e(t,n){var r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t,"/").concat(n),i=c(c({},this.client.getDefaultRequestHeaders()),{},{Accept:"*/*"}),e.next=3,this.fetchWithRetry(r,{headers:i,method:"GET"});case 3:return e.abrupt("return",e.sent.arrayBuffer());case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"getJsonFile",value:(n=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.get("".concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchWithRetry",value:(t=u(p.mark((function e(t,n){var r,i,o,a,s=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.length>2&&void 0!==s[2]?s[2]:3,o=0;case 2:if(!(o<r)){e.next=21;break}return e.prev=3,e.next=6,this.authenticationPromise;case 6:return e.next=8,fetch(t,n);case 8:if(401!==(a=e.sent).status){e.next=12;break}return this.authenticationPromise=this.client.authenticate(),e.abrupt("continue",18);case 12:return e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(3),void 0!==i&&(i=e.t0);case 18:o++,e.next=2;break;case 21:throw i;case 22:case"end":return e.stop()}}),e,this,[[3,15]])}))),function(e,n){return t.apply(this,arguments)})}]),e;var t,n,r}(),a=function(){function e(t,n,r){v(this,e),this.revealInternalId=Symbol("".concat(t,"/").concat(n,"[").concat(r,"]")),this.modelId=t,this.revisionId=n,this.modelFormat=r}return m(e,[{key:"toString",value:function(){return"".concat(e.name," (").concat(String(this.revealInternalId)," - ").concat(this.modelFormat,")")}}]),e}(),l=n(0);!function(e){e.EptPointCloud="ept-pointcloud",e.RevealCadModel="reveal-directory",e.AnyFormat="all-outputs"}(r||(r={}));var d=(new l.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);function f(e,t){switch(t){case r.RevealCadModel:e.premultiply(d);break;case r.EptPointCloud:break;default:throw new Error("Unknown model format '"+t)}}var h=function(){function e(t,n,r){v(this,e),this.modelId=t,this.revisionId=n,this.outputs=r}return m(e,[{key:"findMostRecentOutput",value:function(e,t){var n=this.outputs.filter((function(n){return n.format===e&&(!t||-1!==t.indexOf(n.version))}));return n.length>0?n.reduce((function(e,t){return t.version>e.version?t:e})):void 0}}]),e}(),y=function(){function e(t){v(this,e),this._client=t}return m(e,[{key:"getModelMatrix",value:(i=u(p.mark((function e(t){var n,r,i,u,c;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof a){e.next=2;break}throw new Error("Model must be a ".concat(a.name,", but got ").concat(t.toString()));case 2:return n=t.modelId,r=t.revisionId,i=t.modelFormat,e.next=7,this._client.revisions3D.retrieve(n,r);case 7:return u=e.sent,c=new l.Matrix4,e.abrupt("return",(u.rotation&&c.makeRotationFromEuler(o(l.Euler,s(u.rotation))),f(c,i),c));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getModelCamera",value:(r=u(p.mark((function e(t){var n,r,i,o,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof a){e.next=2;break}throw new Error("Model must be a ".concat(a.name,", but got ").concat(t.toString()));case 2:return n=t.modelId,r=t.revisionId,e.next=6,this._client.revisions3D.retrieve(n,r);case 6:if(!((i=e.sent).camera&&i.camera.position&&i.camera.target)){e.next=10;break}return o=i.camera,s=o.position,u=o.target,e.abrupt("return",{position:new l.Vector3(s[0],s[1],s[2]),target:new l.Vector3(u[0],u[1],u[2])});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getModelUri",value:(n=u(p.mark((function e(t){var n,r,i,o,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof a){e.next=2;break}throw new Error("Model must be a ".concat(a.name,", but got ").concat(t.toString()));case 2:return n=t.modelId,r=t.revisionId,i=t.modelFormat,e.next=7,this.getOutputs(t);case 7:if(o=e.sent.findMostRecentOutput(i)){e.next=10;break}throw new Error("Model '".concat(n,"/").concat(r,"' is not compatible with this version of Reveal, because no outputs for format '(").concat(i,")' was found. If this model works with a previous version of Reveal it must be reprocessed to support this version."));case 10:return s=o.blobId,e.abrupt("return","".concat(this._client.getBaseUrl()).concat(this.getRequestPath(s)));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getOutputs",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.modelId,r=t.revisionId,i=t.modelFormat,o="/api/v1/projects/".concat(this._client.project,"/3d/models/").concat(n,"/revisions/").concat(r,"/outputs"),a=void 0!==i?{params:{format:i}}:void 0,e.next=7,this._client.get(o,a);case 7:if(200!==(s=e.sent).status){e.next=10;break}return e.abrupt("return",new h(n,r,s.data.items));case 10:throw new Error("Unexpected response ".concat(s.status," (payload: '").concat(s.data,")"));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getRequestPath",value:function(e){return"/api/v1/projects/".concat(this._client.project,"/3d/files/").concat(e)}}]),e;var t,n,r,i}(),g=function(){function e(t){v(this,e),this._client=t}return m(e,[{key:"getOutputs",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.modelId,r=t.revisionId,i=t.modelFormat,o="/api/v1/projects/".concat(this._client.project,"/3d/models/").concat(n,"/revisions/").concat(r,"/outputs"),a=void 0!==i?{params:{format:i}}:void 0,e.next=7,this._client.get(o,a);case 7:if(200!==(s=e.sent).status){e.next=10;break}return e.abrupt("return",new h(n,r,s.data.items));case 10:throw new Error("Unexpected response ".concat(s.status," (payload: '").concat(s.data,")"));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t}(),b=n(18);function x(e){return _.apply(this,arguments)}function _(){return _=u(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=6;break}throw r={},n.headers.forEach((function(e,t){r[e]=t})),new b.HttpError(n.status,n.body,r);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}var w=function(){function e(){v(this,e)}return m(e,[{key:"headers",get:function(){return{}}},{key:"getBinaryFile",value:(n=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("".concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent.arrayBuffer());case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"getJsonFile",value:(t=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("".concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e;var t,n}(),M=function(){function e(t){v(this,e),this.revealInternalId=Symbol(t),this.localPath=t}return m(e,[{key:"toString",value:function(){return"".concat(e.name," (").concat(this.localPath,")")}}]),e}(),S=function(){function e(){v(this,e)}return m(e,[{key:"getModelUri",value:function(e){if(!(e instanceof M))throw new Error("Model must be a ".concat(M.name,", but got ").concat(e.toString()));return Promise.resolve("".concat(location.origin,"/").concat(e.localPath))}},{key:"getModelMatrix",value:(t=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof M){e.next=2;break}throw new Error("Model must be a ".concat(M.name,", but got ").concat(t.toString()));case 2:return n=new l.Matrix4,e.abrupt("return",(f(n,r.RevealCadModel),n));case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getModelCamera",value:function(e){if(!(e instanceof M))throw new Error("Model must be a ".concat(M.name,", but got ").concat(e.toString()));return Promise.resolve(void 0)}}]),e;var t}()},function(e,t){e.exports=n(11011)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),i=n.n(r),o=n(10),a="2.3.0",s="8c900bdfe458e32b768450c20750853d",u=function(){function e(t,n,r){v(this,e),i.a.init(s,{disable_cookie:!0,disable_persistence:!0,ip:!1,property_blacklist:["$city","$region","mp_country_code","$geo_source","$timezone","mp_lib","$lib_version","$device_id","$user_id","$current_url","$screen_width","$screen_height","$referrer","$referring_domain","$initial_referrer","$initial_referring_domain"]}),i.a.reset(),i.a.identify("reveal-single-user"),this._sessionProps={VERSION:a,project:"unknown",application:"unknown",sessionId:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},t&&(this._sessionProps.project=t),n&&(this._sessionProps.application=n),this.innerTrackEvent("init",r)}return m(e,[{key:"innerTrackEvent",value:function(e,t){var n=c(c({},this._sessionProps),t);i.a.track(e,n)}}],[{key:"init",value:function(t,n,r,i){if(void 0===globalThis.revealMetricsLogger&&t){var o=new e(n,r,i);globalThis.revealMetricsLogger={metricsLogger:o}}}},{key:"trackEvent",value:function(e,t){globalThis.revealMetricsLogger&&globalThis.revealMetricsLogger.metricsLogger.innerTrackEvent(e,t)}},{key:"trackCreateTool",value:function(t){e.trackEvent("toolCreated",{toolName:t})}},{key:"trackLoadModel",value:function(t,n){e.trackEvent("loadModel",c(c({},t),{},{modelIdentifier:n}))}},{key:"trackCadModelStyled",value:function(t,n){e.trackEvent("cadModelStyleAssigned",{nodeCollectionClassToken:t,style:n})}},{key:"trackError",value:function(e,t){o.a.error(e),this.trackEvent("error",c({message:e.message,name:e.name,stack:e.stack},t))}},{key:"trackCameraNavigation",value:function(t){e.trackEvent("cameraNavigated",t)}}]),e}()},function(e,t){e.exports=n(4027)},function(e,t,n){"use strict";var r=n(23);t.a=r},function(e,t){e.exports=n(71083)},function(e,t){e.exports=n(60797)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(0),i={renderSize:new r.Vector2,position:new r.Vector3};function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.Vector3,o=i.position;o.copy(t),o.project(e);var a=(o.x+1)/2,s=(1-o.y)/2;return n.set(a,s,o.z)}function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new r.Vector3;o(t,n,a);var s=i.renderSize;e.getSize(s);var u=e.domElement.getBoundingClientRect(),c=u.width,l=u.height;return a.x=Math.round(a.x*c),a.y=Math.round(a.y*l),a}},function(e,t){e.exports=n(39807)},function(e,t){e.exports=n(72518)},function(e,t){e.exports=n(48543)},,function(e,t){e.exports=n(16529)},function(e,t,n){"use strict";var r=n(13);n.d(t,"d",(function(){return r.b}));var i=n(20);n.d(t,"a",(function(){return i.a}));var o=n(1);n.d(t,"c",(function(){return o.l})),n.d(t,"b",(function(){return o.d})),n(6)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(t){v(this,e),this._clippingPlanes=[new r.Plane,new r.Plane,new r.Plane,new r.Plane,new r.Plane,new r.Plane],this._box=t||new r.Box3,this.updatePlanes()}return m(e,[{key:"minX",get:function(){return this._box.min.x},set:function(e){this._box.min.x=e,this.updatePlanes()}},{key:"minY",get:function(){return this._box.min.y},set:function(e){this._box.min.y=e,this.updatePlanes()}},{key:"minZ",get:function(){return this._box.min.z},set:function(e){this._box.min.z=e,this.updatePlanes()}},{key:"maxX",get:function(){return this._box.max.x},set:function(e){this._box.max.x=e,this.updatePlanes()}},{key:"maxY",get:function(){return this._box.max.y},set:function(e){this._box.max.y=e,this.updatePlanes()}},{key:"maxZ",get:function(){return this._box.max.z},set:function(e){this._box.max.z=e,this.updatePlanes()}},{key:"updatePlanes",value:function(){this._clippingPlanes[0].setFromNormalAndCoplanarPoint(new r.Vector3(1,0,0),new r.Vector3(this.minX,0,0)),this._clippingPlanes[1].setFromNormalAndCoplanarPoint(new r.Vector3(-1,0,0),new r.Vector3(this.maxX,0,0)),this._clippingPlanes[2].setFromNormalAndCoplanarPoint(new r.Vector3(0,1,0),new r.Vector3(0,this.minY,0)),this._clippingPlanes[3].setFromNormalAndCoplanarPoint(new r.Vector3(0,-1,0),new r.Vector3(0,this.maxY,0)),this._clippingPlanes[4].setFromNormalAndCoplanarPoint(new r.Vector3(0,0,1),new r.Vector3(0,0,this.minZ)),this._clippingPlanes[5].setFromNormalAndCoplanarPoint(new r.Vector3(0,0,-1),new r.Vector3(0,0,this.maxZ))}},{key:"clippingPlanes",get:function(){return this._clippingPlanes}}]),e}()},,function(e,t){e.exports=n(20867)},function(e,t){e.exports=n(37702)},function(e,t){e.exports=n(18187)},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec3 v_normal;\nvarying vec3 v_color;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n    if (isClipped(appearance, vViewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);    \n    vec3 normal = normalize(v_normal);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.Primitive);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// Not using the w-component to support using vec3 and vec4 as input\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    vec4(column_0.xyz, 0.0),\n    vec4(column_1.xyz, 0.0),\n    vec4(column_2.xyz, 0.0),\n    vec4(column_3.xyz, 1.0)\n  );\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\n\nvarying float v_treeIndex;\nvarying vec3 v_normal;\nvarying vec3 v_color;\n\nvarying vec3 vViewPosition;\n\nuniform vec2 treeIndexTextureSize;\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize;\nuniform sampler2D transformOverrideTexture;\n\nvoid main()\n{\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * normalize(inverseModelMatrix * treeIndexWorldTransform * modelMatrix * instanceMatrix * vec4(normalize(normal), 0.0)).xyz;\n    //v_normal = normal;\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 modelViewPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4(transformed, 1.0);\n    vViewPosition = modelViewPosition.xyz;\n    gl_Position = projectionMatrix * modelViewPosition;\n}"},function(e,t){e.exports=n(27364)},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t){e.exports=n(45568)},function(e,t){e.exports=n(83080)},function(e,t){e.exports=n(12325)},,function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n    if (isClipped(appearance, vViewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    updateFragmentColor(renderMode, color, v_treeIndex, v_normal, gl_FragCoord.z, matCapTexture, GeometryType.Quad);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute vec3 color;\nattribute float treeIndex;\nattribute vec4 matrix0;\nattribute vec4 matrix1;\nattribute vec4 matrix2;\nattribute vec4 matrix3;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    \n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    v_treeIndex = treeIndex;\n    v_color = color;\n    v_normal = normalize(normalMatrix * (inverseModelMatrix * treeIndexWorldTransform * modelMatrix * vec4(normalize(normal), 0.0)).xyz);\n    mat4 instanceMatrix = mat4(matrix0, matrix1, matrix2, matrix3);\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 mvPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4( transformed, 1.0 );\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 derivateNormal(vec3 v_viewPosition) {\n  vec3 fdx = vec3(dFdx(v_viewPosition.x), dFdx(v_viewPosition.y), dFdx(v_viewPosition.z));\n  vec3 fdy = vec3(dFdy(v_viewPosition.x), dFdy(v_viewPosition.y), dFdy(v_viewPosition.z));\n  vec3 normal = normalize(cross(fdx, fdy));\n  return normal;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_viewPosition;\n\nuniform int renderMode;\n\nvoid main()\n{\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n\n    if (isClipped(appearance, v_viewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    vec3 normal = derivateNormal(v_viewPosition);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.TriangleMesh);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nattribute vec3 color;\nattribute float treeIndex; \n\nvarying vec3 v_color;\nvarying float v_treeIndex;\nvarying vec3 v_viewPosition;\n\nuniform vec2 treeIndexTextureSize;\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize;\nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    v_color = color;\n    v_treeIndex = treeIndex;\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    vec4 modelViewPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4(position, 1.0);\n    v_viewPosition = modelViewPosition.xyz;\n    gl_Position = projectionMatrix * modelViewPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 derivateNormal(vec3 v_viewPosition) {\n  vec3 fdx = vec3(dFdx(v_viewPosition.x), dFdx(v_viewPosition.y), dFdx(v_viewPosition.z));\n  vec3 fdy = vec3(dFdy(v_viewPosition.x), dFdy(v_viewPosition.y), dFdy(v_viewPosition.z));\n  vec3 normal = normalize(cross(fdx, fdy));\n  return normal;\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_viewPosition;\n\nuniform int renderMode;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n\n    if (isClipped(appearance, v_viewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    vec3 normal = derivateNormal(v_viewPosition);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.InstancedMesh);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// Not using the w-component to support using vec3 and vec4 as input\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    vec4(column_0.xyz, 0.0),\n    vec4(column_1.xyz, 0.0),\n    vec4(column_2.xyz, 0.0),\n    vec4(column_3.xyz, 1.0)\n  );\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_viewPosition;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main()\n{\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    v_color = a_color;\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 modelViewPosition = viewMatrix * modelMatrix * vec4(transformed, 1.0);\n    v_viewPosition = modelViewPosition.xyz;\n    v_treeIndex = a_treeIndex;\n    gl_Position = projectionMatrix * modelViewPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec2 v_xy;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    float dist = dot(v_xy, v_xy);\n    vec3 normal = normalize( v_normal );\n    if (dist > 0.25)\n      discard;\n      \n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n    if (isClipped(appearance, vViewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.Primitive);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// Not using the w-component to support using vec3 and vec4 as input\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    vec4(column_0.xyz, 0.0),\n    vec4(column_1.xyz, 0.0),\n    vec4(column_2.xyz, 0.0),\n    vec4(column_3.xyz, 1.0)\n  );\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute vec3 a_normal;\n\nvarying vec2 v_xy;\nvarying vec3 v_color;\nvarying vec3 v_normal;\nvarying float v_treeIndex;\n\nvarying vec3 vViewPosition;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    v_xy = vec2(position.x, position.y);\n    v_treeIndex = a_treeIndex;\n\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 mvPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4( transformed, 1.0 );\n    v_color = a_color;\n\n    v_normal = normalMatrix * normalize(inverseModelMatrix * treeIndexWorldTransform * modelMatrix * vec4(normalize(a_normal), 0.0)).xyz;\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth) \n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_0) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_0) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_0));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_1 || renderMode == RenderTypeEffects_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_1) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_1) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_1) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_1) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform mat4 projectionMatrix;\n\nvarying vec4 v_centerB;\n\nvarying vec4 v_W;\nvarying vec4 v_U;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec4 v_centerA;\nvarying vec4 v_V;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n  NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n  if (!determineVisibility(appearance, renderMode)) {\n      discard;\n  }\n\n  vec3 normal = normalize( v_normal );\n  vec4 color = determineColor(v_color, appearance);\n\n  float R1 = v_centerB.w;\n  vec4 U = v_U;\n  vec4 W = v_W;\n  vec4 V = v_V;\n  float height = length(v_centerA.xyz - v_centerB.xyz);\n  float R2 = v_centerA.w;\n  float dR = R2 - R1;\n\n  mat3 basis = mat3(U.xyz, V.xyz, W.xyz);\n  vec3 surfacePoint = vec3(U.w, V.w, W.w);\n  vec3 rayTarget = surfacePoint;\n\n  #if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n  #else\n    vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n  #endif\n\n  vec3 diff = rayTarget - v_centerB.xyz;\n  vec3 E = diff * basis;\n  vec3 D = rayDirection * basis;\n\n  float a = dot(D.xy, D.xy);\n  float b = dot(E.xy, D.xy);\n  float c = dot(E.xy, E.xy) - R1*R1;\n\n  if (R1 != R2) {\n    // Additional terms if radii are different\n    float dRLInv = dR / height;\n    float dRdRL2Inv = dRLInv * dRLInv;\n    a -= D.z * D.z * dRdRL2Inv;\n    b -= dRLInv * (E.z * D.z * dRLInv + R1 * D.z);\n    c -= dRLInv * (E.z * E.z * dRLInv + 2.0 * R1 * E.z);\n  }\n\n  // Calculate a dicriminant of the above quadratic equation\n  float d = b*b - a*c;\n\n  // d < 0.0 means the ray hits outside an infinitely long cone\n  if (d < 0.0) {\n    discard;\n  }\n\n  float sqrtd = sqrt(d);\n  float dist1 = (-b - sqrtd)/a;\n  float dist2 = (-b + sqrtd)/a;\n\n  // Make sure dist1 is the smaller one\n  if (dist2 < dist1) {\n    float tmp = dist1;\n    dist1 = dist2;\n    dist2 = tmp;\n  }\n\n  float dist = dist1;\n  vec3 intersectionPoint = E + dist * D;\n  float theta = atan(intersectionPoint.y, intersectionPoint.x);\n  if (theta < v_angle) theta += 2.0 * PI;\n\n  // Intersection point in camera space\n  vec3 p = rayTarget + dist*rayDirection;\n\n  bool isInner = false;\n\n  if (intersectionPoint.z <= 0.0 ||\n      intersectionPoint.z > height ||\n      theta > v_angle + v_arcAngle ||\n      isClipped(appearance, p)\n    ) {\n      // Missed the first point, check the other point\n      isInner = true;\n      dist = dist2;\n      intersectionPoint = E + dist * D;\n      theta = atan(intersectionPoint.y, intersectionPoint.x);\n      p = rayTarget + dist*rayDirection;\n      if (theta < v_angle) theta += 2.0 * PI;\n      if (intersectionPoint.z <= 0.0 ||\n        intersectionPoint.z > height ||\n        theta > v_angle + v_arcAngle ||\n        isClipped(appearance, p)\n      ) {\n        // Missed the other point too\n        discard;\n      }\n    }\n\n  #if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n      if (R1 != R2)\n      {\n        // Find normal vector\n        vec3 n = -normalize(W.xyz);\n        vec3 P1 = v_centerB.xyz;\n        vec3 P2 = v_centerA.xyz;\n        vec3 A = cross(P1 - p, P2 - p);\n\n        vec3 t = normalize(cross(n, A));\n        vec3 o1 = P1 + R1 * t;\n        vec3 o2 = P2 + R2 * t;\n        vec3 B = o2-o1;\n        normal = normalize(cross(A, B));\n      }\n      else\n      {\n        // Regular cylinder has simpler normal vector in camera space\n        vec3 p_local = p - v_centerB.xyz;\n        normal = normalize(p_local - W.xyz * dot(p_local, W.xyz));\n      }\n  #endif\n\n    float fragDepth = updateFragmentDepth(p, projectionMatrix);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture, GeometryType.Primitive);\n}\n'},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_centerA;\nattribute vec3 a_centerB;\nattribute float a_radiusA;\nattribute float a_radiusB;\nattribute vec3 a_color;\n// segment attributes\nattribute vec3 a_localXAxis;\nattribute float a_angle;\nattribute float a_arcAngle;\n\nvarying float v_treeIndex;\n// We pack the radii into w-components\nvarying vec4 v_centerB;\n\n// U, V, axis represent the 3x3 cone basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 v_U;\nvarying vec4 v_W;\n\nvarying vec4 v_centerA;\nvarying vec4 v_V;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    mat4 modelTransformOffset = inverseModelMatrix * treeIndexWorldTransform * modelMatrix;\n\n    vec3 centerA = mul3(modelTransformOffset, a_centerA);\n    vec3 centerB = mul3(modelTransformOffset, a_centerB);\n\n    vec3 center = 0.5 * (centerA + centerB);\n    float halfHeight = 0.5 * length(centerA - centerB);\n    vec3 dir = normalize(centerA - centerB);\n    vec3 newPosition = position;\n\n    vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n    vec3 objectToCameraModelSpace = rayOrigin - center;\n\n    float maxRadius = max(a_radiusA, a_radiusB);\n    float leftUpScale = maxRadius;\n\n    vec3 lDir = dir;\n    if (dot(objectToCameraModelSpace, dir) < 0.0) { // direction vector looks away, flip it\n        lDir = -lDir;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (maxRadius * (position.x + 1.0) * 0.0025 / halfHeight);\n#endif\n\n    vec3 surfacePoint = center + mat3(halfHeight*lDir, leftUpScale*left, leftUpScale*up) * newPosition;\n    vec3 transformed = surfacePoint;\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n\n    // varying data\n    v_treeIndex = a_treeIndex;\n    v_angle = a_angle;\n    v_arcAngle = a_arcAngle;\n\n    // compute basis for cone\n    v_W.xyz = dir;\n    v_U.xyz = (modelTransformOffset * vec4(a_localXAxis, 0.0)).xyz;\n    v_W.xyz = normalize(normalMatrix * v_W.xyz);\n    v_U.xyz = normalize(normalMatrix * v_U.xyz);\n    // We pack surfacePoint as w-components of U and W\n    v_W.w = surfacePoint.z;\n    v_U.w = surfacePoint.x;\n\n    mat4 modelToTransformOffset = modelMatrix * modelTransformOffset;\n\n    float radiusB = length((modelToTransformOffset * vec4(a_localXAxis * a_radiusB, 0.0)).xyz);\n    float radiusA = length((modelToTransformOffset * vec4(a_localXAxis * a_radiusA, 0.0)).xyz);\n\n    // We pack radii as w-components of v_centerB\n    v_centerB.xyz = mul3(modelViewMatrix, centerB);\n    v_centerB.w = radiusB;\n\n    v_V.xyz = -cross(v_U.xyz, v_W.xyz);\n    v_V.w = surfacePoint.y;\n\n    v_centerA.xyz = mul3(modelViewMatrix, centerA);\n    v_centerA.w = radiusA;\n\n    v_color = a_color;\n    v_normal = normalMatrix * normal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default='#define GLSLIFY 1\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth) \n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_0) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_0) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_0));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_1 || renderMode == RenderTypeEffects_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_1) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_1) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_1) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_1) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform mat4 projectionMatrix;\n\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 axis;\n\nvarying vec4 v_centerA;\nvarying vec4 v_centerB;\nvarying float height;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    vec3 normal = normalize( v_normal );\n    mat3 basis = mat3(U.xyz, V.xyz, axis.xyz);\n    vec3 surfacePoint = vec3(U.w, V.w, axis.w);\n    vec3 rayTarget = surfacePoint;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n      vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n#else\n      vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n#endif\n\n    vec3 diff = rayTarget - v_centerA.xyz;\n    vec3 E = diff * basis;\n    float L = height;\n    vec3 D = rayDirection * basis;\n\n    float R1 = v_centerA.w;\n    float R2 = v_centerB.w;\n    float dR = R2 - R1;\n\n    float a = dot(D.xy, D.xy);\n    float b = dot(E.xy, D.xy);\n    float c = dot(E.xy, E.xy)-R1*R1;\n    float L2Inv = 1.0/(L*L);\n\n    if (R1 != R2) {\n      // Additional terms if radii are different\n      float dRLInv = dR/L;\n      float dRdRL2Inv = dRLInv*dRLInv;\n      a -= D.z*D.z*dRdRL2Inv;\n      b -= dRLInv*(E.z*D.z*dRLInv + R1*D.z);\n      c -= dRLInv*(E.z*E.z*dRLInv + 2.0*R1*E.z);\n    }\n\n    // Additional terms when one of the center points is displaced orthogonal to normal vector\n    vec2 displacement = ((v_centerB.xyz-v_centerA.xyz)*basis).xy; // In the basis where displacement is in XY only\n    float displacementLengthSquared = dot(displacement, displacement);\n    a += D.z*(D.z*displacementLengthSquared - 2.0*L*dot(D.xy, displacement))*L2Inv;\n    b += (D.z*E.z*displacementLengthSquared - L*(D.x*E.z*displacement.x + D.y*E.z*displacement.y + D.z*E.x*displacement.x + D.z*E.y*displacement.y))*L2Inv;\n    c += E.z*(E.z*displacementLengthSquared - 2.*L*dot(E.xy, displacement))*L2Inv;\n\n    // Calculate a dicriminant of the above quadratic equation (factor 2 removed from all b-terms above)\n    float d = b*b - a*c;\n\n    // d < 0.0 means the ray hits outside an infinitely long eccentric cone\n    if (d < 0.0) {\n      discard;\n    }\n    float sqrtd = sqrt(d);\n    float dist1 = (-b - sqrtd)/a;\n    float dist2 = (-b + sqrtd)/a;\n\n    // Make sure dist1 is the smaller one\n    if (dist2 < dist1) {\n      float tmp = dist1;\n      dist1 = dist2;\n      dist2 = tmp;\n    }\n\n    // Check the smallest root, it is closest camera. Only test if the z-component is outside the truncated eccentric cone\n    float dist = dist1;\n    float intersectionPointZ = E.z + dist*D.z;\n    // Intersection point in camera space\n    vec3 p = rayTarget + dist*rayDirection;\n    bool isInner = false;\n\n    if (intersectionPointZ <= 0.0 ||\n      intersectionPointZ >= L ||\n      isClipped(appearance, p)\n      ) {\n      // Either intersection point is behind starting point (happens inside the cone),\n      // or the intersection point is outside the end caps. This is not a valid solution.\n      isInner = true;\n      dist = dist2;\n      intersectionPointZ = E.z + dist*D.z;\n      p = rayTarget + dist*rayDirection;\n\n      if (intersectionPointZ <= 0.0 ||\n        intersectionPointZ >= L ||\n        isClipped(appearance, p)\n      ) {\n        // Missed the other point too\n        discard;\n      }\n    }\n\n#if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n    // Find normal vector\n    vec3 n = normalize(-axis.xyz);\n    vec3 v_centerA = v_centerA.xyz;\n    vec3 v_centerB = v_centerB.xyz;\n    vec3 A = cross(v_centerA - p, v_centerB - p);\n\n    vec3 t = normalize(cross(n, A));\n    vec3 o1 = v_centerA + R1 * t;\n    vec3 o2 = v_centerB + R2 * t;\n    vec3 B = o2-o1;\n    normal = normalize(cross(A, B));\n#endif\n\n    float fragDepth = updateFragmentDepth(p, projectionMatrix);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture, GeometryType.Primitive);\n}\n'},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_centerA;\nattribute vec3 a_centerB;\nattribute float a_radiusA;\nattribute float a_radiusB;\nattribute vec3 a_normal;\nattribute vec3 a_color;\n\nvarying float v_treeIndex;\n// We pack the radii into w-components\nvarying vec4 v_centerA;\nvarying vec4 v_centerB;\n\n// U, V, axis represent the 3x3 cone basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 axis;\nvarying float height;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n\n  mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    mat4 modelTransformOffset = inverseModelMatrix * treeIndexWorldTransform * modelMatrix;\n    mat4 modelToTransformOffset = modelMatrix * modelTransformOffset;\n\n    vec3 centerA = mul3(modelTransformOffset, a_centerA);\n    vec3 centerB = mul3(modelTransformOffset, a_centerB);\n\n    vec3 normalWithOffset = normalize((modelTransformOffset * vec4(a_normal, 0)).xyz);\n\n    float uniformScaleFactor = length(mul3(modelMatrix, normalize(vec3(1.0))));\n\n    height = dot(centerA - centerB, normalWithOffset) * uniformScaleFactor;\n\n    vec3 lDir;\n    vec3 center = 0.5 * (centerA + centerB);\n    vec3 newPosition = position;\n\n    vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n    vec3 objectToCameraModelSpace = rayOrigin - center;\n\n    // Find the coordinates of centerA and centerB projected down to the end cap plane\n    vec3 maxCenterProjected = centerA - dot(centerA, normalWithOffset) * normalWithOffset;\n    vec3 minCenterProjected = centerB - dot(centerB, normalWithOffset) * normalWithOffset;\n    float distanceBetweenProjectedCenters = length(maxCenterProjected - minCenterProjected);\n\n    lDir = normalWithOffset;\n    float dirSign = 1.0;\n    if (dot(objectToCameraModelSpace, lDir) < 0.0) { // direction vector looks away, flip it\n      dirSign = -1.0;\n      lDir *= -1.;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n    // compute basis for cone\n    axis.xyz = -normalWithOffset;\n    U.xyz = cross(objectToCameraModelSpace, axis.xyz);\n    V.xyz = cross(U.xyz, axis.xyz);\n    // Transform to camera space\n    axis.xyz = normalize(normalMatrix * axis.xyz);\n    U.xyz = normalize(normalMatrix * U.xyz);\n    V.xyz = normalize(normalMatrix * V.xyz);\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (a_radiusA * (position.x + 1.0) * 0.0025 / height);\n#endif\n\n    v_centerA.xyz = mul3(viewMatrix, mul3(modelMatrix, centerA));\n    v_centerB.xyz = mul3(viewMatrix, mul3(modelMatrix, centerB));\n\n    float radiusA = length((modelToTransformOffset * vec4(normalize(vec3(1.0)) * a_radiusA, 0.0)).xyz);\n    float radiusB = length((modelToTransformOffset * vec4(normalize(vec3(1.0)) * a_radiusB, 0.0)).xyz);\n\n    // Pack radii as w components of v_centerA and v_centerB\n    v_centerA.w = radiusA;\n    v_centerB.w = radiusB;\n\n    float radiusIncludedDisplacement = 0.5*(2.0*max(a_radiusA, a_radiusB) + distanceBetweenProjectedCenters);\n    vec3 surfacePoint = center + mat3(0.5 * height * lDir * (1.0 / uniformScaleFactor), radiusIncludedDisplacement*left, radiusIncludedDisplacement*up) * newPosition;\n    vec3 transformed = surfacePoint;\n\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n\n    // We pack surfacePoint as w-components of U, V and axis\n    U.w = surfacePoint.x;\n    V.w = surfacePoint.y;\n    axis.w = surfacePoint.z;\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * normal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth) \n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_0) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_0) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_0));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_1 || renderMode == RenderTypeEffects_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_1) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_1) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_1) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_1) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform mat4 projectionMatrix;\nvarying vec4 center;\nvarying float hRadius;\nvarying float height;\n\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 sphereNormal;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    vec3 normal = normalize(sphereNormal.xyz);\n\n    float vRadius = center.w;\n    float ratio = vRadius / hRadius;\n    mat3 basis = mat3(U.xyz, V.xyz, sphereNormal.xyz);\n    mat3 scaledBasis = mat3(ratio * U.xyz, ratio * V.xyz, sphereNormal.xyz);\n    vec3 surfacePoint = vec3(U.w, V.w, sphereNormal.w);\n    vec3 rayTarget = surfacePoint;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n#else\n    vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n#endif\n\n    vec3 diff = rayTarget - center.xyz;\n    vec3 E = diff * scaledBasis;\n    vec3 D = rayDirection * scaledBasis;\n\n    float a = dot(D, D);\n    float b = dot(E, D);\n    float c = dot(E, E) - vRadius*vRadius;\n\n    // discriminant of sphere equation (factor 2 removed from b above)\n    float d = b*b - a*c;\n    if(d < 0.0)\n        discard;\n\n    float sqrtd = sqrt(d);\n    float dist1 = (-b - sqrtd)/a;\n    float dist2 = (-b + sqrtd)/a;\n\n    // Make sure dist1 is the smaller one\n    if (dist2 < dist1) {\n        float tmp = dist1;\n        dist1 = dist2;\n        dist2 = tmp;\n    }\n\n    float dist = dist1;\n    float intersectionPointZ = E.z + dist*D.z;\n    // Intersection point in camera space\n    vec3 p = rayTarget + dist*rayDirection;\n\n    if (intersectionPointZ <= vRadius - height ||\n        intersectionPointZ > vRadius ||\n        isClipped(appearance, p)\n       ) {\n        // Missed the first point, check the other point\n\n        dist = dist2;\n        intersectionPointZ = E.z + dist*D.z;\n        p = rayTarget + dist*rayDirection;\n        if (intersectionPointZ <= vRadius - height ||\n            intersectionPointZ > vRadius ||\n            isClipped(appearance, p)\n           ) {\n            // Missed the other point too\n            discard;\n        }\n    }\n\n#if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n    // Find normal vector in local space\n    normal = vec3(p - center.xyz) * basis;\n    normal.z = normal.z * (hRadius / vRadius) * (hRadius / vRadius);\n    // Transform into camera space\n    normal = normalize(basis * normal);\n    if (dot(normal, rayDirection) >  0.) {\n        normal = -normal;\n    }\n#endif\n\n  float fragDepth = updateFragmentDepth(p, projectionMatrix);\n  updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture, GeometryType.Primitive);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\nuniform mat4 inverseNormalMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute vec3 a_center;\nattribute vec3 a_normal;\nattribute float a_horizontalRadius;\nattribute float a_verticalRadius;\nattribute float a_height;\n\nvarying float v_treeIndex;\n// We pack vRadius as w-component of center\nvarying vec4 center;\nvarying float hRadius;\nvarying float height;\n\n// U, V, axis represent the 3x3 sphere basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 U;\nvarying vec4 V;\nvarying vec4 sphereNormal;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    mat4 modelTransformOffset = inverseModelMatrix * treeIndexWorldTransform * modelMatrix;\n\n    vec3 centerWithOffset = mul3(modelTransformOffset, a_center).xyz;\n\n    vec3 normalWithOffset = (modelTransformOffset * vec4(a_normal, 0)).xyz;\n\n    vec3 lDir;\n    float distanceToCenterOfSegment = a_verticalRadius - a_height * 0.5;\n    vec3 centerOfSegment = centerWithOffset + normalWithOffset * distanceToCenterOfSegment;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n      vec3 objectToCameraModelSpace = inverseNormalMatrix * vec3(0.0, 0.0, 1.0);\n#else\n      vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n      vec3 objectToCameraModelSpace = rayOrigin - centerOfSegment;\n#endif\n\n    vec3 newPosition = position;\n\n    float bb = dot(objectToCameraModelSpace, normalWithOffset);\n    if (bb < 0.0) { // direction vector looks away, flip it\n      lDir = -normalWithOffset;\n    } else { // direction vector already looks in my direction\n      lDir = normalWithOffset;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (a_verticalRadius * (position.x + 1.0) * 0.0025 / a_height);\n#endif\n\n    // Negative angle means height larger than radius,\n    // so we should have full size so we can render the largest part of the ellipsoid segment\n    float ratio = max(0.0, 1.0 - a_height / a_verticalRadius);\n    // maxRadiusOfSegment is the radius of the circle (projected ellipsoid) when ellipsoid segment is seen from above\n    float maxRadiusOfSegment = a_horizontalRadius * sqrt(1.0 - ratio * ratio);\n\n    vec3 displacement = vec3(newPosition.x*a_height*0.5, maxRadiusOfSegment*newPosition.y, maxRadiusOfSegment*newPosition.z);\n    vec3 surfacePoint = centerOfSegment + mat3(lDir, left, up) * displacement;\n    vec3 transformed = surfacePoint;\n\n    v_treeIndex = a_treeIndex;\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n    center.xyz = mul3(modelViewMatrix, centerWithOffset);\n    center.w = a_verticalRadius; // Pack radius into w-component\n    hRadius = a_horizontalRadius;\n    height = a_height;\n    v_color = a_color;\n\n    // compute basis\n    sphereNormal.xyz = normalMatrix * normalWithOffset;\n    U.xyz = normalMatrix * up;\n    V.xyz = normalMatrix * left;\n\n    // We pack surfacePoint as w-components of U, V and axis\n    U.w = surfacePoint.x;\n    V.w = surfacePoint.y;\n    sphereNormal.w = surfacePoint.z;\n\n    // TODO should perhaps be a different normal?\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}\n'},function(e,t,n){"use strict";n.r(t),t.default='#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\nfloat displaceScalar(vec3 point, float scalar, \n  float treeIndex, vec3 cameraPosition, mat4 inverseModelMatrix) {\n\n  // Displaces a scalar based on distance to camera to avoid z-fighting\n  vec3 cameraPositionModelSpace = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n  vec3 pointToCamera = cameraPositionModelSpace - point;\n\n  // "Random" number in the range [0, 1], based on treeIndex\n  float rnd = mod(treeIndex, 64.) / 64.;\n  // Compute distance to camera, but cap it\n  float maxDistanceToCamera = 50.;\n  float distanceToCamera = min(length(pointToCamera), maxDistanceToCamera);\n\n  float maxDisplacement = 0.01;\n  float scaleFactor = 0.01;\n  float displacement = min(maxDisplacement, scaleFactor * rnd * distanceToCamera / maxDistanceToCamera);\n  return scalar + displacement;\n}\n\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth) \n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_0) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_0) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_0));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_1 || renderMode == RenderTypeEffects_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_1) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_1) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_1) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_1) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\n// TODO general cylinder and cone are very similar and used\n// the same shader in the old code. Consider de-duplicating\n// parts of this code\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform float dataTextureWidth;\nuniform float dataTextureHeight;\nuniform mat4 projectionMatrix;\n\nvarying vec4 v_centerB;\n\nvarying vec4 v_W;\nvarying vec4 v_U;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying float v_surfacePointY;\n\nvarying vec4 v_planeA;\nvarying vec4 v_planeB;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform int renderMode;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);    \n    vec3 normal = normalize( v_normal );\n\n    float R1 = v_centerB.w;\n    vec4 U = v_U;\n    vec4 W = v_W;\n    vec4 V = vec4(normalize(cross(W.xyz, U.xyz)), v_surfacePointY);\n\n    mat3 basis = mat3(U.xyz, V.xyz, W.xyz);\n    vec3 surfacePoint = vec3(U.w, V.w, W.w);\n    vec3 rayTarget = surfacePoint;\n\n#if defined(COGNITE_ORTHOGRAPHIC_CAMERA)\n    vec3 rayDirection = vec3(0.0, 0.0, -1.0);\n#else\n    vec3 rayDirection = normalize(rayTarget); // rayOrigin is (0,0,0) in camera space\n#endif\n\n    vec3 diff = rayTarget - v_centerB.xyz;\n    vec3 E = diff * basis;\n    vec3 D = rayDirection * basis;\n\n    float a = dot(D.xy, D.xy);\n    float b = dot(E.xy, D.xy);\n    float c = dot(E.xy, E.xy) - R1*R1;\n\n    // Calculate a dicriminant of the above quadratic equation\n    float d = b*b - a*c;\n\n    // d < 0.0 means the ray hits outside an infinitely long cone\n    if (d < 0.0)\n        discard;\n\n    float sqrtd = sqrt(d);\n    float dist1 = (-b - sqrtd)/a;\n    float dist2 = (-b + sqrtd)/a;\n\n    // Make sure dist1 is the smaller one\n    if (dist2 < dist1) {\n        float tmp = dist1;\n        dist1 = dist2;\n        dist2 = tmp;\n    }\n\n    float dist = dist1;\n    vec3 intersectionPoint = E + dist * D;\n    float theta = atan(intersectionPoint.y, intersectionPoint.x);\n    if (theta < v_angle) theta += 2.0 * PI;\n\n    // Intersection point in camera space\n    vec3 p = rayTarget + dist*rayDirection;\n\n    vec3 planeACenter = vec3(0.0, 0.0, v_planeA.w);\n    vec3 planeANormal = v_planeA.xyz;\n    vec3 planeBCenter = vec3(0.0, 0.0, v_planeB.w);\n    vec3 planeBNormal = v_planeB.xyz;\n    bool isInner = false;\n\n    if (dot(intersectionPoint - planeACenter, planeANormal) > 0.0 ||\n        dot(intersectionPoint - planeBCenter, planeBNormal) > 0.0 ||\n        theta > v_arcAngle + v_angle ||\n        isClipped(appearance, p)\n       ) {\n        // Missed the first point, check the other point\n        isInner = true;\n        dist = dist2;\n        intersectionPoint = E + dist * D;\n        theta = atan(intersectionPoint.y, intersectionPoint.x);\n        p = rayTarget + dist*rayDirection;\n        if (theta < v_angle) theta += 2.0 * PI;\n        if (dot(intersectionPoint - planeACenter, planeANormal) > 0.0 ||\n            dot(intersectionPoint - planeBCenter, planeBNormal) > 0.0 ||\n            theta > v_arcAngle + v_angle || isClipped(appearance, p)\n           ) {\n            // Missed the other point too\n            discard;\n        }\n    }\n\n#if !defined(COGNITE_RENDER_COLOR_ID) && !defined(COGNITE_RENDER_DEPTH)\n    // Regular cylinder has simpler normal vector in camera space\n    vec3 p_local = p - v_centerB.xyz;\n    normal = normalize(p_local - W.xyz * dot(p_local, W.xyz));\n#endif\n\n    float fragDepth = updateFragmentDepth(p, projectionMatrix);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, fragDepth, matCapTexture, GeometryType.Primitive);\n}\n'},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 mul3(mat4 M, vec3 v) {\n  vec4 u = M * vec4(v, 1.0);\n  return u.xyz / u.w;\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_centerA;\nattribute vec3 a_centerB;\nattribute float a_radius;\nattribute vec3 a_color;\n// slicing plane attributes\nattribute vec4 a_planeA;\nattribute vec4 a_planeB;\n// segment attributes\nattribute vec3 a_localXAxis;\nattribute float a_angle;\nattribute float a_arcAngle;\n\nvarying float v_treeIndex;\n// We pack the radii into w-components\nvarying vec4 v_centerB;\n\n// U, V, axis represent the 3x3 cone basis.\n// They are vec4 to pack extra data into the w-component\n// since Safari on iOS only supports 8 varying vec4 registers.\nvarying vec4 v_U;\nvarying vec4 v_W;\n\nvarying vec4 v_planeA;\nvarying vec4 v_planeB;\n\nvarying float v_surfacePointY;\n\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n    \n    mat4 modelTransformOffset = inverseModelMatrix * treeIndexWorldTransform * modelMatrix;\n\n    vec3 centerA = mul3(modelTransformOffset, a_centerA);\n    vec3 centerB = mul3(modelTransformOffset, a_centerB);\n\n    vec3 center = 0.5 * (centerA + centerB);\n    float halfHeight = 0.5 * length(centerA - centerB);\n    vec3 dir = normalize(centerA - centerB);\n    vec3 newPosition = position;\n\n    vec3 rayOrigin = (inverseModelMatrix * vec4(cameraPosition, 1.0)).xyz;\n    vec3 objectToCameraModelSpace = rayOrigin - center;\n\n    float leftUpScale = a_radius;\n\n    vec3 lDir = dir;\n    if (dot(objectToCameraModelSpace, dir) < 0.0) { // direction vector looks away, flip it\n        lDir = -lDir;\n    }\n\n    vec3 left = normalize(cross(objectToCameraModelSpace, lDir));\n    vec3 up = normalize(cross(left, lDir));\n\n#ifndef GL_EXT_frag_depth\n    // make sure the billboard will not overlap with cap geometry (flickering effect), not important if we write to depth buffer\n    newPosition.x *= 1.0 - (a_radius * (position.x + 1.0) * 0.0025 / halfHeight);\n#endif\n\n    vec3 surfacePoint = center + mat3(halfHeight*lDir, leftUpScale*left, leftUpScale*up) * newPosition;\n    vec3 transformed = surfacePoint;\n    surfacePoint = mul3(modelViewMatrix, surfacePoint);\n\n    // varying data\n    v_treeIndex = a_treeIndex;\n    v_angle = a_angle;\n    v_arcAngle = a_arcAngle;\n\n    // compute basis for cone\n    v_W.xyz = dir;\n    v_U.xyz = (modelTransformOffset * vec4(a_localXAxis, 0)).xyz;\n    v_W.xyz = normalize(normalMatrix * v_W.xyz);\n    v_U.xyz = normalize(normalMatrix * v_U.xyz);\n    // We pack surfacePoint as w-components of U and W\n    v_W.w = surfacePoint.z;\n    v_U.w = surfacePoint.x;\n\n    // We pack radii as w-components of v_centerB\n    mat4 modelToTransformOffset = modelMatrix * modelTransformOffset;\n    float radius = length((modelToTransformOffset * vec4(a_localXAxis * a_radius, 0.0)).xyz);\n\n    centerB = centerB - dir;\n    v_centerB.xyz = mul3(modelViewMatrix, centerB);\n    v_centerB.w = radius;\n\n    vec4 planeA = a_planeA;\n    planeA.w = length((modelToTransformOffset * vec4(planeA.xyz * planeA.w, 0.0)).xyz);\n\n    vec4 planeB = a_planeB;\n    planeB.w = length((modelToTransformOffset * vec4(planeB.xyz * planeB.w, 0.0)).xyz);\n\n    v_planeA = planeA;\n    v_planeB = planeB;\n    v_surfacePointY = surfacePoint.y;\n    v_centerB.w = radius;\n\n    v_color = a_color;\n    v_normal = normalMatrix * normal;\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nfloat computeFragmentDepth(vec3 p, mat4 projectionMatrix) {\n  // Anders Hafreager comments:\n  // Depth value can be calculated by transforming the z-component of the intersection point to projection space.\n  // The w-component is also needed to scale projection space into clip space.\n  // However, the 4th column of the projection matrix is (0, 0, const, 0), so we can exploit this when computing w-value.\n  float projected_intersection_z=projectionMatrix[0][2]*p.x+projectionMatrix[1][2]*p.y+projectionMatrix[2][2]*p.z+projectionMatrix[3][2];\n\n  // If we want to use orthographic camera, the full w-component is found as\n  float projected_intersection_w=projectionMatrix[0][3]*p.x+projectionMatrix[1][3]*p.y+projectionMatrix[2][3]*p.z+projectionMatrix[3][3];\n  // float projected_intersection_w = projectionMatrix[2][3]*newPoint.z; // Optimized for perspective camera\n  return ((gl_DepthRange.diff * (projected_intersection_z / projected_intersection_w)) + gl_DepthRange.near + gl_DepthRange.far) * .5;\n}\n\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth) \n\nfloat updateFragmentDepth(vec3 p,mat4 projectionMatrix) {\n  gl_FragDepthEXT = computeFragmentDepth(p, projectionMatrix);\n  return gl_FragDepthEXT;\n}\n\n#else\n\nfloat updateFragmentDepth(vec3 p, mat4 projectionMatrix){\n  // Extension not available - not much we can do.\n  return computeFragmentDepth(p, projectionMatrix);\n}\n\n#endif\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_0) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_0) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_0));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_1 || renderMode == RenderTypeEffects_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_1) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_1) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_1) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_1) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_1) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n\nvarying float v_oneMinusThicknessSqr;\nvarying vec2 v_xy;\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n\n    if (isClipped(appearance, vViewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);\n    float dist = dot(v_xy, v_xy);\n    float theta = atan(v_xy.y, v_xy.x);\n    vec3 normal = normalize( v_normal );\n    if (theta < v_angle) {\n        theta += 2.0 * PI;\n    }\n    if (dist > 0.25 || dist < 0.25 * v_oneMinusThicknessSqr || theta >= v_angle + v_arcAngle) {\n        discard;\n    }\n\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.Primitive);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// Not using the w-component to support using vec3 and vec4 as input\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    vec4(column_0.xyz, 0.0),\n    vec4(column_1.xyz, 0.0),\n    vec4(column_2.xyz, 0.0),\n    vec4(column_3.xyz, 1.0)\n  );\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute float a_angle;\nattribute float a_arcAngle;\nattribute float a_thickness;\nattribute vec3 a_normal;\n\nvarying float v_treeIndex;\nvarying float v_oneMinusThicknessSqr;\nvarying vec2 v_xy;\nvarying float v_angle;\nvarying float v_arcAngle;\n\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n\n    v_treeIndex = a_treeIndex;\n    v_oneMinusThicknessSqr = (1.0 - a_thickness) * (1.0 - a_thickness);\n    v_xy = vec2(position.x, position.y);\n    v_angle = a_angle;\n    v_arcAngle = a_arcAngle;\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    vec3 transformed = (instanceMatrix * vec4(position, 1.0)).xyz;\n    vec4 mvPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4( transformed, 1.0 );\n    v_color = a_color;\n\n    v_normal = normalMatrix * normalize(inverseModelMatrix * treeIndexWorldTransform * modelMatrix * vec4(normalize(a_normal), 0.0)).xyz;\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n    if (isClipped(appearance, vViewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);    \n    vec3 normal = normalize(v_normal);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.Primitive);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// Not using the w-component to support using vec3 and vec4 as input\nmat4 constructMatrix(vec4 column_0, vec4 column_1, vec4 column_2, vec4 column_3) {\n  return mat4(\n    vec4(column_0.xyz, 0.0),\n    vec4(column_1.xyz, 0.0),\n    vec4(column_2.xyz, 0.0),\n    vec4(column_3.xyz, 1.0)\n  );\n}\n\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute vec4 a_instanceMatrix_column_0;\nattribute vec4 a_instanceMatrix_column_1;\nattribute vec4 a_instanceMatrix_column_2;\nattribute vec4 a_instanceMatrix_column_3;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute float a_arcAngle;\nattribute float a_radius;\nattribute float a_tubeRadius;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    mat4 instanceMatrix = constructMatrix(\n        a_instanceMatrix_column_0,\n        a_instanceMatrix_column_1,\n        a_instanceMatrix_column_2,\n        a_instanceMatrix_column_3\n    );\n    // normalized theta and phi are packed into positions\n    float theta = position.x * a_arcAngle;\n    float phi = position.y;\n    float cosTheta = cos(theta);\n    float sinTheta = sin(theta);\n    vec3 pos3 = vec3(0);\n\n    pos3.x = (a_radius + a_tubeRadius*cos(phi)) * cosTheta;\n    pos3.y = (a_radius + a_tubeRadius*cos(phi)) * sinTheta;\n    pos3.z = a_tubeRadius*sin(phi);\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n    \n    vec3 transformed = (instanceMatrix * vec4(pos3, 1.0)).xyz;\n\n    // Calculate normal vectors if we're not picking\n    vec3 center = (instanceMatrix * vec4(a_radius * cosTheta, a_radius * sinTheta, 0.0, 1.0)).xyz;\n    vec3 objectNormal = normalize(transformed.xyz - center);\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * normalize(inverseModelMatrix * treeIndexWorldTransform * modelMatrix * vec4(objectNormal, 0.0)).xyz;\n\n    vec4 modelViewPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4(transformed, 1.0);\n\n    vViewPosition = modelViewPosition.xyz;\n\n    gl_Position = projectionMatrix * modelViewPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nstruct GeometryTypeEnum {\n  int Quad;\n  int Primitive;\n  int TriangleMesh;\n  int InstancedMesh;\n};\n\nconst GeometryTypeEnum GeometryType = GeometryTypeEnum(1,2,3,4);\n\nconst int RenderTypeColor_0 = 1;\nconst int RenderTypeNormal_0 = 2;\nconst int RenderTypeTreeIndex_0 = 3;\nconst int RenderTypePackColorAndNormal_0 = 4;\nconst int RenderTypeDepth_0 = 5;\nconst int RenderTypeEffects_0 = 6;\nconst int RenderTypeGhost_0 = 7;\nconst int RenderTypeLOD = 8;\nconst int RenderTypeDepthBufferOnly = 9;\nconst int RenderTypeGeometryType = 10;\n\n#include <packing>\n\nvec3 packNormalToRgb( const in vec3 normal ) {\n    return normalize( normal ) * 0.5 + 0.5;\n}\n\nvoid updateFragmentColor(\n    int renderMode, vec4 color, float treeIndex, \n    vec3 normal, float depth, sampler2D matCapTexture, \n    int geometryType) {\n    if (renderMode == RenderTypeColor_0 || renderMode == RenderTypeEffects_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        hsv.z = min(0.5 * hsv.z + 0.5, 1.0);\n        vec3 colorRGB = hsv2rgb(hsv);\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        vec4 albedo = vec4(colorRGB * (0.4 + 0.6 * amplitude), 1.0);\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec4 mc = vec4(texture2D(matCapTexture, cap).rgb, 1.0);\n        \n        gl_FragColor = vec4(albedo.rgb * mc.rgb * 1.7, color.a);\n    } else if (renderMode == RenderTypeGhost_0) {\n        float amplitude = max(0.0, dot(normal, vec3(0.0, 0.0, 1.0)));\n        float s = 0.4 + 0.6 * amplitude;\n        gl_FragColor = vec4(vec3(s), 0.3);\n    } else if (renderMode == RenderTypeDepthBufferOnly) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    } else if (renderMode == RenderTypePackColorAndNormal_0) {\n        vec3 hsv = rgb2hsv(color.rgb);\n        float a = 0.0;\n        if (hsv.y > 0.01) {\n            if (hsv.z > 0.5) {\n                // light color\n                a = (0.55 + hsv.x * 0.45);\n            } else {\n                // dark color\n                a = (0.1 + hsv.x * 0.45);\n            }\n        } else {\n            // no saturation - grayscale\n            a = hsv.z * 0.09;\n        }\n        gl_FragColor = vec4(packNormalToRgb(normal.rgb), a);\n    } else if (renderMode == RenderTypeNormal_0) {\n        gl_FragColor = vec4(packNormalToRgb(normal), 1.0);\n    } else if (renderMode == RenderTypeTreeIndex_0) {\n        gl_FragColor = vec4(packIntToColor(treeIndex), 1.0);\n    } else if (renderMode == RenderTypeDepth_0) {\n        gl_FragColor = packDepthToRGBA(depth);\n    } else if (renderMode == RenderTypeLOD) {\n        bool isHighDetail = geometryType != GeometryType.Quad;\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        gl_FragColor = isHighDetail ? vec4(vec3(0.0, 1.0, 0.0) * mc, color.a) : vec4(vec3(1.0, 1.0, 0.0) * mc, color.a);\n    } else if (renderMode == RenderTypeGeometryType) {\n        vec2 cap = normal.xy * 0.5 + 0.5;\n        vec3 mc = texture2D(matCapTexture, cap).rgb * 1.5;\n        vec3 geometryColor = \n            float(geometryType == 1) * vec3(1.0, 0.0, 0.0) + // Quads\n            float(geometryType == 2) * vec3(0.0, 1.0, 0.0) + // Primitives\n            float(geometryType == 3) * vec3(0.0, 0.0, 1.0) + // Triangle meshes\n            float(geometryType == 4) * vec3(1.0, 1.0, 0.0);  // Instance meshes\n        gl_FragColor = vec4(geometryColor * mc, color.a);\n    } else {\n        // Unknown render mode - should not happen. \n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \n\nNodeAppearance determineNodeAppearance(sampler2D nodeAppearanceTexture, vec2 textureSize, float treeIndex) {\n  treeIndex = floor(treeIndex + 0.5);\n  float dataTextureWidth = textureSize.x;\n  float dataTextureHeight = textureSize.y;\n\n  float u = mod(treeIndex, dataTextureWidth);\n  float v = floor(treeIndex / dataTextureWidth);\n  float uCoord = (u + 0.5) / dataTextureWidth;\n  float vCoord = (v + 0.5) / dataTextureHeight;\n  vec2 treeIndexUv = vec2(uCoord, vCoord);\n  \n  vec4 texel = texture2D(nodeAppearanceTexture, treeIndexUv);\n  float alphaUnwrapped = floor((texel.a * 255.0) + 0.5);\n\n  bool isVisible = floatBitsSubset(alphaUnwrapped, 0, 1) == 1.0;\n  bool renderInFront = floatBitsSubset(alphaUnwrapped, 1, 2) == 1.0;\n  bool renderGhosted = floatBitsSubset(alphaUnwrapped, 2, 3) == 1.0;\n\n  return NodeAppearance(texel, isVisible, renderInFront, renderGhosted);\n}\n\nconst int RenderTypeColor_1 = 1;\nconst int RenderTypeNormal_1 = 2;\nconst int RenderTypeTreeIndex_1 = 3;\nconst int RenderTypePackColorAndNormal_1 = 4;\nconst int RenderTypeDepth_1 = 5;\nconst int RenderTypeEffects_1 = 6;\nconst int RenderTypeGhost_1 = 7;\n\nbool determineVisibility(NodeAppearance nodeAppearance, int renderMode) {\n    return \n         // In ghost mode\n         ((renderMode == RenderTypeGhost_1) && nodeAppearance.isVisible && nodeAppearance.renderGhosted) ||\n         // Not ghost mode\n         ((renderMode != RenderTypeGhost_1) && \n         !nodeAppearance.renderGhosted && nodeAppearance.isVisible && (nodeAppearance.renderInFront || renderMode != RenderTypeEffects_1));\n}\n\nvec4 determineColor(vec3 originalColor, NodeAppearance nodeAppearance) {\n    vec4 overrideColor = nodeAppearance.colorTexel;\n    if (any(greaterThan(overrideColor.rgb, vec3(0.0)))) {\n      return overrideColor;\n    }\n    return vec4(originalColor.rgb, overrideColor.a);\n}\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nuniform sampler2D colorDataTexture;\nuniform sampler2D overrideVisibilityPerTreeIndex;\nuniform sampler2D matCapTexture;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform int renderMode;\n\nvarying vec3 vViewPosition;\n\nvoid main() {\n    NodeAppearance appearance = determineNodeAppearance(colorDataTexture, treeIndexTextureSize, v_treeIndex);\n    if (!determineVisibility(appearance, renderMode)) {\n        discard;\n    }\n    if (isClipped(appearance, vViewPosition)) {\n        discard;\n    }\n\n    vec4 color = determineColor(v_color, appearance);    \n    vec3 normal = normalize(v_normal);\n    updateFragmentColor(renderMode, color, v_treeIndex, normal, gl_FragCoord.z, matCapTexture, GeometryType.Primitive);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float @ Arjan\nfloat unpackVec4ToFloat( vec4 packedFloat)\n{\n  vec4 rgba = packedFloat;\n  float sign = 1.0 - step(128.0, rgba.x) * 2.0;\n  float exponent = 2.0 * mod(rgba.x, 128.0) + step(128.0, rgba.y) - 127.0;\n  if (exponent == -127.0) return 0.0;\n  float mantissa = mod(rgba.y, 128.0) * 65536.0 + rgba.z * 256.0 + rgba.w + 8388608.0;\n  return sign * exp2(exponent - 23.0) * mantissa;   \n}\n\nfloat unpackFloatFromRGBATexel(vec4 texel){\n    float byteValueR = floor((texel.r * 255.0) + 0.5);\n    float byteValueG = floor((texel.g * 255.0) + 0.5);\n    float byteValueB = floor((texel.b * 255.0) + 0.5);\n    float byteValueA = floor((texel.a * 255.0) + 0.5);\n\n    return unpackVec4ToFloat(vec4(byteValueR, byteValueG, byteValueB, byteValueA));\n}\n\nmat4 determineMatrixOverride(\n  float treeIndex, \n  vec2 treeIndexTextureSize, \n  sampler2D transformOverrideIndexTexture, \n  vec2 transformOverrideTextureSize, \n  sampler2D transformOverrideTexture\n) {\n\n    treeIndex = floor(treeIndex + 0.5);\n    float dataTextureWidth = treeIndexTextureSize.x;\n    float dataTextureHeight = treeIndexTextureSize.y;\n\n    float xTreeIndexTextureCoord = mod(treeIndex, dataTextureWidth);\n    float yTreeIndexTextureCoord = floor(treeIndex / dataTextureWidth);\n\n    vec2 indexUV = vec2((xTreeIndexTextureCoord + 0.5) / dataTextureWidth, (yTreeIndexTextureCoord + 0.5) / dataTextureHeight);\n\n    vec3 indexTexel = texture2D(transformOverrideIndexTexture, indexUV).rgb;\n\n    float index = floor(indexTexel.r * 256.0) * 65536.0  + floor(indexTexel.g * 256.0) * 256.0 + floor(indexTexel.b * 256.0);\n    \n    \n    if(index == 0.0){\n      return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0\n      );\n    }\n\n    index = index - 1.0;\n    float overridesPerRow = transformOverrideTextureSize.x / 16.0;\n\n    float xOverrideTextureCoord = mod(index, overridesPerRow);\n    float yOverrideTextureCoord = floor(index / overridesPerRow);\n\n    float cellWidth = 1.0 / transformOverrideTextureSize.x;\n    float cellHeight = 1.0 / transformOverrideTextureSize.y;\n\n    float overrideU = (xOverrideTextureCoord / overridesPerRow) + cellWidth / 2.0;\n    float overrideV = (yOverrideTextureCoord / transformOverrideTextureSize.y) + cellHeight / 2.0;\n\n    vec2 overrideUV = vec2(overrideU, overrideV); \n\n    float matrixElements[12];\n\n    for(int i = 0; i < 12; i++){\n      matrixElements[i] = unpackFloatFromRGBATexel(texture2D(transformOverrideTexture, overrideUV + vec2(float(i) * cellWidth, 0.0)));\n    }\n    \n    return mat4(\n      matrixElements[0], matrixElements[4], matrixElements[8],  0,\n      matrixElements[1], matrixElements[5], matrixElements[9],  0,\n      matrixElements[2], matrixElements[6], matrixElements[10], 0,\n      matrixElements[3], matrixElements[7], matrixElements[11], 1\n    );\n}\n\nuniform mat4 inverseModelMatrix;\n\nattribute float a_treeIndex;\nattribute vec3 a_color;\nattribute vec3 a_vertex1;\nattribute vec3 a_vertex2;\nattribute vec3 a_vertex3;\nattribute vec3 a_vertex4;\n\nvarying float v_treeIndex;\nvarying vec3 v_color;\nvarying vec3 v_normal;\n\nvarying vec3 vViewPosition;\n\nuniform vec2 treeIndexTextureSize;\n\nuniform sampler2D transformOverrideIndexTexture;\n\nuniform vec2 transformOverrideTextureSize; \nuniform sampler2D transformOverrideTexture;\n\nvoid main() {\n    vec3 transformed;\n    // reduce the avarage branchings\n    if (position.x < 1.5) {\n      transformed = position.x == 0.0 ? a_vertex1 : a_vertex2;\n    } else {\n      transformed = position.x == 2.0 ? a_vertex3 : a_vertex4;\n    }\n\n    mat4 treeIndexWorldTransform = determineMatrixOverride(\n      a_treeIndex, \n      treeIndexTextureSize, \n      transformOverrideIndexTexture, \n      transformOverrideTextureSize, \n      transformOverrideTexture\n    );\n\n    vec3 objectNormal = cross(a_vertex1 - a_vertex2, a_vertex1 - a_vertex3);\n\n    v_treeIndex = a_treeIndex;\n    v_color = a_color;\n    v_normal = normalMatrix * normalize(inverseModelMatrix * treeIndexWorldTransform * modelMatrix * vec4(objectNormal, 0.0)).xyz;\n\n    vec4 mvPosition = viewMatrix * treeIndexWorldTransform * modelMatrix * vec4( transformed, 1.0 );\n    vViewPosition = mvPosition.xyz;\n    gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nfloat floatBitsSubset(float inNumber, int fromLeastSignificantBitIndex,  int toMostSignificantBitIndex) {\n    float r = float(fromLeastSignificantBitIndex);\n    float l = float(toMostSignificantBitIndex);\n\n    float bitShift = pow(2.0, r);\n    return mod(((inNumber - mod(inNumber, bitShift)) / bitShift), pow(2.0, l - r));\n}\n\n/*\n\nExample:\n\nGet the value from bit 2 to 4 (not inclusive)\n\ninput:\ninNumber = 173 = 1010_1101 , from=2, to=4\n\nexpected output = 1010_|11|01 = 3\n\n1)  subtract any bits in the least significant bit-subset\n\n  mod(inNumber=173, pow(2.0, from=2)) = mod(inNumber, 4) = 1\n  \n  inNumber - 1 = 172\n\n2)  bitshift such that we remove the least significant bit-subset\n    this is guaranteed to be devisible since we subtracted the remainder\n\n  (inNumber=172) / pow(2.0, from=2) = 172 / 4 = 43 = 0010_1011\n\n3)  lastly, remove the most significant bit-subset\n\n  mod((inNumber=43), pow(2.0, to=4 - from=2) = mod(43, 4)\n\n  mod(43, 4) = 3\n\n  or in binary notation: 0000_0011 which is the expected result.\n\n*/ \nmat3 G[9];\n// hard coded matrix values!!!! as suggested in https://github.com/neilmendoza/ofxPostProcessing/blob/master/src/EdgePass.cpp#L45\nconst mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\n\nfloat edgeDetectionFilter(sampler2D baseTexture, vec2 uv, vec2 resolution) {\n\n  vec2 texel = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n\n\tG[0] = g0,\n\tG[1] = g1,\n\tG[2] = g2,\n\tG[3] = g3,\n\tG[4] = g4,\n\tG[5] = g5,\n\tG[6] = g6,\n\tG[7] = g7,\n\tG[8] = g8;\n\n\tmat3 I;\n\tfloat cnv[9];\n\tvec3 neighbour;\n\n\t/* fetch the 3x3 neighbourhood and use the RGB vector's length as intensity value */\n\tfor (int i=0; i<3; i++) {\n\t\tfor (int j=0; j<3; j++) {\n\t\t\tneighbour = texture2D(baseTexture, uv + texel * vec2(float(i)-1.0,float(j)-1.0) ).rgb;\n\t\t\tI[i][j] = length(neighbour);\n\t\t}\n\t}\n\n\t/* calculate the convolution values for all the masks */\n\tfor (int i=0; i<9; i++) {\n\t\tfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n\t\tcnv[i] = dp3 * dp3;\n\t}\n\n\tfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\n\tfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\n\n  float edgeStrength = sqrt(M/S);\n\n  return edgeStrength;\n}\n\n#include <packing>\n\nvarying vec2 vUv;\n\nvarying vec2 vUv0;\nvarying vec2 vUv1;\nvarying vec2 vUv2;\nvarying vec2 vUv3;\n\nuniform sampler2D tFront;\nuniform sampler2D tFrontDepth;\n\nuniform sampler2D tBack;\nuniform sampler2D tBackDepth;\n\nuniform sampler2D tCustom;\nuniform sampler2D tCustomDepth;\n\nuniform sampler2D tGhost;\nuniform sampler2D tGhostDepth;\n\nuniform sampler2D tOutlineColors;\n\nuniform float cameraNear;\nuniform float cameraFar;\n\nuniform vec2 resolution;\n\nuniform float edgeStrengthMultiplier;\nuniform float edgeGrayScaleIntensity;\n\nconst float infinity = 1e20;\n\nfloat computeFloatEncodedOutlineIndex(float bitEncodedFloat){\n  return floatBitsSubset(floor((bitEncodedFloat * 255.0) + 0.5), 5, 8);\n}\n\nvec4 computeNeighborOutlineIndices(sampler2D colorTexture){\n  float outlineIndex0 = computeFloatEncodedOutlineIndex(texture2D(colorTexture, vUv0).a);\n  float outlineIndex1 = computeFloatEncodedOutlineIndex(texture2D(colorTexture, vUv1).a);\n  float outlineIndex2 = computeFloatEncodedOutlineIndex(texture2D(colorTexture, vUv2).a);\n  float outlineIndex3 = computeFloatEncodedOutlineIndex(texture2D(colorTexture, vUv3).a);\n\n  return vec4(outlineIndex0, outlineIndex1, outlineIndex2, outlineIndex3);\n}\n\nfloat toViewZ(float depth, float near, float far){\n  float normalizedDepth = depth * 2.0 - 1.0;\n  return 2.0 * near * far / (far + near - normalizedDepth * (far - near)); \n}\n\nvec4 computeNeighborAlphas(sampler2D colorTexture){\n  float alpha0 = texture2D(colorTexture, vUv0).a;\n  float alpha1 = texture2D(colorTexture, vUv1).a;\n  float alpha2 = texture2D(colorTexture, vUv2).a;\n  float alpha3 = texture2D(colorTexture, vUv3).a;\n\n  return vec4(alpha0, alpha1, alpha2, alpha3);\n}\n\nvoid main() {\n  vec4 frontAlbedo = texture2D(tFront, vUv);\n  vec4 backAlbedo = texture2D(tBack, vUv);\n  vec4 customAlbedo = texture2D(tCustom, vUv);\n  vec4 ghostAlbedo = texture2D(tGhost, vUv);\n\n  float frontDepth = texture2D(tFrontDepth, vUv).r;\n  float backDepth = texture2D(tBackDepth, vUv).r;  \n  float customDepth = texture2D(tCustomDepth, vUv).r;\n  float ghostDepth = texture2D(tGhostDepth, vUv).r;\n\n  // This is a hack to make sure that all textures are initialized\n  // If a texture is unused, it will have a clear value of 0.0.\n  // Without this we've seen issues with MSAA where resizing render targets\n  // causes depth to cleared to either 1 or 0 depending on the device/browser\n  customDepth = customDepth > 0.0 ? customDepth : 1.0; \n  backDepth = backDepth > 0.0 ? backDepth : 1.0;\n  ghostDepth = ghostDepth > 0.0 ? ghostDepth : 1.0;\n  frontDepth = frontDepth > 0.0 ? frontDepth : 1.0; \n\n  if(all(greaterThanEqual(vec4(backDepth, customDepth, ghostDepth, frontDepth), vec4(1.0)))){\n    discard;\n  }\n  \n  // Decompose and clamp \"ghost\" color\n  vec4 clampedGhostAlbedo = vec4(max(ghostAlbedo.rgb, 0.5), min(ghostAlbedo.a, 0.8));\n\n  float frontOutlineIndex = computeFloatEncodedOutlineIndex(frontAlbedo.a);\n  vec4 frontNeighborIndices = computeNeighborOutlineIndices(tFront);\n\n  // There exsists fragments of rendered objects within the edge width that should have border\n  if(any(equal(frontNeighborIndices, vec4(0.0))) && frontOutlineIndex > 0.0) \n  { \n    float borderColorIndex = max(max(frontNeighborIndices.x, frontNeighborIndices.y), max(frontNeighborIndices.z, frontNeighborIndices.w));\n    gl_FragColor = texture2D(tOutlineColors, vec2(0.125 * borderColorIndex + (0.125 / 2.0), 0.5));\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth) \n    gl_FragDepthEXT = frontDepth;\n#endif\n    return;\n  }\n\n  // texture has drawn fragment\n  if(frontDepth < 1.0){\n    float customDepthTest = step(customDepth, backDepth); // zero if back is in front\n\n    float a = customDepthTest > 0.0 ? ceil(customAlbedo.a) * 0.5 : ceil(backAlbedo.a) * 0.5;\n\n    gl_FragColor = vec4(frontAlbedo.rgb, 1.0) * (1.0 - a) + (vec4(backAlbedo.rgb, 1.0) * (1.0 - customDepthTest) + vec4(customAlbedo.rgb, 1.0) * customDepthTest) * a;\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth)   \n    gl_FragDepthEXT = texture2D(tFrontDepth, vUv).r;\n#endif\n    return;\n  }\n\n  if (customDepth >= backDepth) {\n    float backOutlineIndex = computeFloatEncodedOutlineIndex(backAlbedo.a);\n    vec4 backNeighborIndices = computeNeighborOutlineIndices(tBack);\n\n    if( any(equal(backNeighborIndices, vec4(0.0))) && backOutlineIndex > 0.0) \n    { \n      float borderColorIndex = max(max(backNeighborIndices.x, backNeighborIndices.y), max(backNeighborIndices.z, backNeighborIndices.w));\n      gl_FragColor = texture2D(tOutlineColors, vec2(0.125 * borderColorIndex + (0.125 / 2.0), 0.5));\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth)\n      gl_FragDepthEXT = texture2D(tBackDepth, vUv).r;\n#endif\n      return;\n    }\n  }\n  \n  float edgeStrength = 0.0;\n#if defined(EDGES)\n  if (!any(equal(computeNeighborAlphas(tBack), vec4(0.0)))) {\n    float depthEdge = toViewZ(backDepth, cameraNear, cameraFar);\n    edgeStrength = (1.0 - smoothstep(10.0, 40.0, depthEdge)) * edgeDetectionFilter(tBack, vUv, resolution) * edgeStrengthMultiplier;\n  }\n#endif\n\n  // Combine color from ghost, back and custom object\n  vec4 color = backAlbedo;\n  float depth = backDepth;\n  if (customDepth < backDepth && ghostDepth == 1.0) {\n    color = vec4(customAlbedo.rgb * customAlbedo.a + (1.0 - customAlbedo.a) * backAlbedo.rgb, 1.0);\n    depth = customDepth;\n    edgeStrength = 0.0;\n  } else if (customDepth < backDepth && ghostDepth < 1.0) {\n    float s = (1.0 - step(backDepth, ghostDepth)) * clampedGhostAlbedo.a;\n    vec3 modelAlbedo = mix(backAlbedo.rgb, clampedGhostAlbedo.rgb, s);\n    color = vec4(customAlbedo.rgb * customAlbedo.a + (1.0 - customAlbedo.a) * modelAlbedo.rgb, 1.0);\n    depth = customDepth;\n    edgeStrength = 0.0;\n  } else {\n    float s = (1.0 - step(backDepth, ghostDepth)) * clampedGhostAlbedo.a;\n    color = vec4(mix(backAlbedo.rgb, clampedGhostAlbedo.rgb, s), backAlbedo.a);\n    depth = mix(backDepth, ghostDepth, s);\n  }\n  \n  gl_FragColor = color * (1.0 - edgeStrength) + vec4(vec3(edgeGrayScaleIntensity) * edgeStrength, 1.0);\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth)  \n  gl_FragDepthEXT = depth;\n#endif\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\nvarying vec2 vUv;\n\n// selection outline\nuniform vec2 texelSize;\nvarying vec2 vUv0;\nvarying vec2 vUv1;\nvarying vec2 vUv2;\nvarying vec2 vUv3;\n\nvoid main() {\n  vUv = uv;\n\n  // selection outline\n  vUv0 = vec2(uv.x + texelSize.x, uv.y);\n  vUv1 = vec2(uv.x - texelSize.x, uv.y);\n  vUv2 = vec2(uv.x, uv.y + texelSize.y);\n  vUv3 = vec2(uv.x, uv.y - texelSize.y);\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n/*!\n *\n * Adapted from:\n * https://github.com/mattdesl/three-shader-fxaa\n * MIT License (MIT) Copyright (c) 2014 Matt DesLauriers\n *\n */\n\nvarying vec2 v_uv;\nvarying vec2 v_fragCoord;\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec2 inverseResolution;\nuniform vec2 resolution;\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\nvec4 fxaa(sampler2D tex, vec2 fragCoord,\n    vec2 resolution, vec2 inverseResolution,\n    vec2 v_rgbNW, vec2 v_rgbNE,\n    vec2 v_rgbSW, vec2 v_rgbSE,\n    vec2 v_rgbM) {\n  vec4 color;\n\n  vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n  vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n  vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n  vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n  vec4 texColor = texture2D(tex, v_rgbM);\n  vec3 rgbM  = texColor.xyz;\n\n  vec3 luma = vec3(0.299, 0.587, 0.114);\n  float lumaNW = dot(rgbNW, luma);\n  float lumaNE = dot(rgbNE, luma);\n  float lumaSW = dot(rgbSW, luma);\n  float lumaSE = dot(rgbSE, luma);\n  float lumaM  = dot(rgbM,  luma);\n  float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n  float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n  mediump vec2 dir;\n  dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n  dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n  float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                  (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n  float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n  dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n      max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n      dir * rcpDirMin));\n\n  vec4 rgbA = 0.5 * (\n    texture2D(tex, inverseResolution * (v_fragCoord + dir * (1.0 / 3.0 - 0.5))) +\n    texture2D(tex, inverseResolution * (v_fragCoord + dir * (2.0 / 3.0 - 0.5))));\n  vec4 rgbB = rgbA * 0.5 + 0.25 * (\n    texture2D(tex, inverseResolution * (v_fragCoord + dir * -0.5)) +\n    texture2D(tex, inverseResolution * (v_fragCoord + dir * 0.5)));\n\n  float lumaB = dot(rgbB.rgb, luma);\n  if ((lumaB < lumaMin) || (lumaB > lumaMax)) {\n    color = rgbA;\n  } else {\n    color = rgbB;\n  }\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = fxaa(tDiffuse, v_fragCoord, \n    resolution, inverseResolution, \n    v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n#if defined(gl_FragDepthEXT) || defined(GL_EXT_frag_depth)\n  gl_FragDepthEXT = texture2D(tDepth, v_uv).r;\n#endif\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n/*!\n *\n * Adapted from:\n * https://github.com/mattdesl/three-shader-fxaa\n * MIT License (MIT) Copyright (c) 2014 Matt DesLauriers\n *\n */\n\nuniform vec2 resolution;\nuniform vec2 inverseResolution;\n\nvarying vec2 v_uv;\nvarying vec2 v_fragCoord;\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvoid main() {\n  v_fragCoord = uv * resolution;\n  v_rgbNW = (v_fragCoord + vec2(-1.0, -1.0)) * inverseResolution;\n  v_rgbNE = (v_fragCoord + vec2(1.0, -1.0)) * inverseResolution;\n  v_rgbSW = (v_fragCoord + vec2(-1.0, 1.0)) * inverseResolution;\n  v_rgbSE = (v_fragCoord + vec2(1.0, 1.0)) * inverseResolution;\n  v_rgbM = vec2(v_fragCoord * inverseResolution);\n  v_uv = uv;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// From http://www.science-and-fiction.org/rendering/noise.html\nfloat rand2d(in vec2 co){\n    return fract(sin(dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvarying vec2 vUv;\n\nuniform mat4 projMatrix;\nuniform mat4 inverseProjectionMatrix;\n\nuniform vec3 kernel[MAX_KERNEL_SIZE];\n\nuniform sampler2D tDepth;\n\nuniform vec2 resolution;\n\nuniform float sampleRadius;\nuniform float bias;\n\nvec3 viewPosFromDepth(float depth, vec2 uv) {\n  // Depth to clip space: [0, 1] -> [-1, 1]\n  float z = depth * 2.0 - 1.0;\n\n  // Fragment in clip space\n  vec4 clipSpacePosition = vec4(uv * 2.0 - 1.0, z, 1.0);\n  vec4 viewSpacePosition = inverseProjectionMatrix * clipSpacePosition;\n\n  // Perspective division\n  viewSpacePosition /= viewSpacePosition.w;\n\n  return viewSpacePosition.xyz;\n}\n\nvec3 computeWorldNormalFromDepth(sampler2D depthTexture, vec2 resolution, vec2 uv, float sampleDepth){\n  float dx = 1.0 / resolution.x;\n  float dy = 1.0 / resolution.y;\n\n  vec2 uv1 = uv + vec2(dx, 0.0); // right\n  float d1 = texture2D(depthTexture, uv1).r; \n\n  vec2 uv2 = uv + vec2(0.0, dy);  // up\n  float d2 = texture2D(depthTexture, uv2).r;\n\n  vec2 uv3 = uv + vec2(-dx, 0.0); // left\n  float d3 = texture2D(depthTexture, uv3).r;\n\n  vec2 uv4 = uv + vec2(0.0, -dy);  // down\n  float d4 = texture2D(depthTexture, uv4).r;\n\n  bool horizontalSampleCondition = abs(d1 - sampleDepth) < abs(d3 - sampleDepth);\n\n  float horizontalSampleDepth = horizontalSampleCondition ? d1 : d3;\n  vec2 horizontalSampleUv = horizontalSampleCondition ? uv1 : uv3;\n\n  bool verticalSampleCondition = abs(d2 - sampleDepth) < abs(d4 - sampleDepth);\n\n  float verticalSampleDepth = verticalSampleCondition ? d2 : d4;\n  vec2 verticalSampleUv = verticalSampleCondition ? uv2 : uv4;\n\n  vec3 viewPos = viewPosFromDepth(sampleDepth, vUv);\n  \n  vec3 viewPos1 = (horizontalSampleCondition == verticalSampleCondition) ? viewPosFromDepth(horizontalSampleDepth, horizontalSampleUv) : viewPosFromDepth(verticalSampleDepth, verticalSampleUv);\n  vec3 viewPos2 = (horizontalSampleCondition == verticalSampleCondition) ? viewPosFromDepth(verticalSampleDepth, verticalSampleUv) : viewPosFromDepth(horizontalSampleDepth, horizontalSampleUv);\n\n  return normalize(cross(viewPos1 - viewPos, viewPos2 - viewPos));\n}\n\nvoid main(){\n  float d = texture2D(tDepth, vUv).r;\n\n  vec3 viewNormal = computeWorldNormalFromDepth(tDepth, resolution, vUv, d);\n\n  vec3 viewPosition = viewPosFromDepth(d, vUv);\n\n  vec3 randomVec = normalize(vec3(rand2d(vUv), rand2d(vUv * 3.0), rand2d(vUv * 5.0)));\n\n  vec3 tangent = normalize(randomVec - viewNormal * dot(randomVec, viewNormal));\n\n  vec3 bitangent = cross(viewNormal, tangent);\n\n  mat3 TBN = mat3(tangent, bitangent, viewNormal);\n\n  float occlusion = 0.0;\n\n  for (int i = 0; i < MAX_KERNEL_SIZE; i++){\n    \n    vec3 sampleVector = TBN * kernel[i];\n    sampleVector = viewPosition + sampleVector * sampleRadius;\n\n    vec4 offset = projMatrix * vec4(sampleVector, 1.0);\n    offset.xyz /= offset.w;\n    offset.xyz = offset.xyz * 0.5 + 0.5;\n\n    float realDepth = texture2D(tDepth, offset.xy).r;\n    vec3 realPos = viewPosFromDepth(realDepth, offset.xy);\n\n    float rangeCheck = smoothstep(0.0, 1.0, sampleRadius / length(viewPosition - realPos));\n\n    occlusion += (realPos.z >= sampleVector.z + bias ? 1.0 : 0.0) * rangeCheck;\n  }\n\n  float occlusionFactor = 1.0 - clamp(occlusion / float(MAX_KERNEL_SIZE), 0.0, 1.0);\n\n  gl_FragColor = vec4(vec3(occlusionFactor), 1.0);\n}"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// Copyright Cognite (C) 2021 Cognite\n//\n// Efficient Gaussian blur based on technique described by Daniel Rákos in\n// http://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\n// generalized for two dimensions\n\nvarying vec2 vUv;\n\nuniform sampler2D tDiffuse;\nuniform sampler2D tAmbientOcclusion;\n\nuniform vec2 resolution;\n\nvoid main() {\n  float blurredAO =\n      texture2D(tAmbientOcclusion, vUv + vec2(-3.1111111, -3.1111111) / resolution).r * 0.0012360 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-1.3333333, -3.1111111) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-3.1111111, -1.3333333) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-1.3333333, -1.3333333) / resolution).r * 0.1076660 +\n      texture2D(tAmbientOcclusion, vUv + vec2(0.0000000, -3.1111111) / resolution).r * 0.0096130 +\n      texture2D(tAmbientOcclusion, vUv + vec2(0.0000000, -1.3333333) / resolution).r * 0.0897217 +\n      texture2D(tAmbientOcclusion, vUv + vec2(1.3333333, -3.1111111) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(3.1111111, -3.1111111) / resolution).r * 0.0012360 +\n      texture2D(tAmbientOcclusion, vUv + vec2(1.3333333, -1.3333333) / resolution).r * 0.1076660 +\n      texture2D(tAmbientOcclusion, vUv + vec2(3.1111111, -1.3333333) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-3.1111111, 0.0000000) / resolution).r * 0.0096130 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-1.3333333, 0.0000000) / resolution).r * 0.0897217 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-3.1111111, 1.3333333) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-1.3333333, 1.3333333) / resolution).r * 0.1076660 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-3.1111111, 3.1111111) / resolution).r * 0.0012360 +\n      texture2D(tAmbientOcclusion, vUv + vec2(-1.3333333, 3.1111111) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(0.0000000, 1.3333333) / resolution).r * 0.0897217 +\n      texture2D(tAmbientOcclusion, vUv + vec2(0.0000000, 3.1111111) / resolution).r * 0.0096130 +\n      texture2D(tAmbientOcclusion, vUv + vec2(1.3333333, 1.3333333) / resolution).r * 0.1076660 +\n      texture2D(tAmbientOcclusion, vUv + vec2(3.1111111, 1.3333333) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(1.3333333, 3.1111111) / resolution).r * 0.0115356 +\n      texture2D(tAmbientOcclusion, vUv + vec2(3.1111111, 3.1111111) / resolution).r * 0.0012360 +\n      texture2D(tAmbientOcclusion, vUv + vec2(1.3333333, 0.0000000) / resolution).r * 0.0897217 +\n      texture2D(tAmbientOcclusion, vUv + vec2(3.1111111, 0.0000000) / resolution).r * 0.0096130 +\n      texture2D(tAmbientOcclusion, vUv).r * 0.0747681;\n\n  gl_FragColor = vec4(texture2D(tDiffuse, vUv).rgb * blurredAO, 1.0);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n// From http://www.science-and-fiction.org/rendering/noise.html\nfloat rand2d(in vec2 co){\n    return fract(sin(dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nstruct NodeAppearance {\n  vec4 colorTexel;\n  bool isVisible;\n  bool renderInFront;\n  bool renderGhosted;\n};\n\n#if NUM_CLIPPING_PLANES > 0\nuniform vec4 clippingPlanes[NUM_CLIPPING_PLANES];\n#endif\n\nbool isClipped(NodeAppearance nodeAppearance, vec3 point) {\n#if NUM_CLIPPING_PLANES > 0\n  vec3 pointFlipped = -point;\n  vec4 plane;\n\n  for (int i = 0; i < UNION_CLIPPING_PLANES; i++) {\n    plane = clippingPlanes[i];\n    if (dot(pointFlipped, plane.xyz) > plane.w) return true;\n  }\n#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  bool clipped = true;\n  for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n      plane = clippingPlanes[ i ];\n      clipped = (dot(pointFlipped, plane.xyz) > plane.w) && clipped;\n  }\n  if ( clipped ) return true;\n#endif\n#endif\n  return false;\n}\n\nvarying mediump vec3 v_color;\nvarying lowp float v_coverageFactor;\nvarying lowp float v_visible;\nvarying lowp vec2 v_seed;\n\nvarying vec3 v_viewPosition;\n    \nconst NodeAppearance dummyNodeAppearance = NodeAppearance(vec4(0.0), false, false, false);\n\nvoid main() {\n    if(v_visible != 1.0 || isClipped(dummyNodeAppearance, v_viewPosition)){\n      discard;\n    }\n\n    float v = rand2d(gl_FragCoord.xy + v_seed);\n    if (v >= v_coverageFactor) {\n        discard;\n    }\n\n    gl_FragColor = vec4(v_color, 1.0);\n}\n"},function(e,t,n){"use strict";n.r(t),t.default="#define GLSLIFY 1\n/**\n * Packs the integer part of the number given to a RGB color.\n */\nvec3 packIntToColor(float number) {\n    float r = floor(number / (255.0 * 255.0)) / 255.0;\n    float g = mod(floor(number / 255.0), 255.0) / 255.0;\n    float b = mod(number, 255.0) / 255.0;\n    return vec3(r, g, b);\n}\n\nattribute mediump float a_sectorId;\nattribute lowp vec3 a_coverageFactor;\nattribute lowp float a_visible;\n\nvarying mediump vec3 v_color;\nvarying lowp float v_coverageFactor;\nvarying lowp vec2 v_seed;\nvarying lowp float v_visible;\n\nvarying vec3 v_viewPosition;\n\nvoid main()\n{\n    v_visible = a_visible;\n    v_color = packIntToColor(a_sectorId);\n    v_coverageFactor = abs(dot(a_coverageFactor, normal));\n    // A seed to ensure that two overlapping sectors A and B \n    // doesn't produce the same noise pattern\n    v_seed = vec2(a_sectorId / 255.0, a_sectorId / 65025.0);\n\n    vec4 mvPosition = modelViewMatrix * instanceMatrix * vec4( position, 1.0 );\n\n    v_viewPosition = mvPosition.xyz;\n\n    gl_Position = projectionMatrix * modelViewMatrix * instanceMatrix * vec4(position, 1.0);\n}\n"},,function(e,t,n){"use strict";var o=p.mark(Ge),x=p.mark($e),_=p.mark(Bn);n.r(t),n.d(t,"NodeAppearanceProvider",(function(){return F})),n.d(t,"NodeOutlineColor",(function(){return w})),n.d(t,"NodeCollectionBase",(function(){return E})),n.d(t,"TreeIndexNodeCollection",(function(){return C})),n.d(t,"IntersectionNodeCollection",(function(){return P})),n.d(t,"UnionNodeCollection",(function(){return A})),n.d(t,"revealEnv",(function(){return T.s})),n.d(t,"IndexSet",(function(){return T.e})),n.d(t,"NumericRange",(function(){return T.i})),n.d(t,"BoundingBoxClipper",(function(){return Sn.a})),n.d(t,"Cognite3DModel",(function(){return ue})),n.d(t,"Cognite3DViewer",(function(){return Un})),n.d(t,"CognitePointCloudModel",(function(){return ce})),n.d(t,"PotreePointShape",(function(){return Nt})),n.d(t,"PotreePointColorType",(function(){return Lt})),n.d(t,"PotreePointSizeType",(function(){return Ft})),n.d(t,"WellKnownAsprsPointClassCodes",(function(){return zt})),n.d(t,"NotSupportedInMigrationWrapperError",(function(){return te})),n.d(t,"PropertyFilterNodeCollection",(function(){return _e})),n.d(t,"SinglePropertyFilterNodeCollection",(function(){return Me})),n.d(t,"AssetNodeCollection",(function(){return ge})),n.d(t,"InvertedNodeCollection",(function(){return we})),n.d(t,"registerCustomNodeCollectionType",(function(){return Ae})),n.d(t,"THREE",(function(){return j})),n.d(t,"DefaultNodeAppearance",(function(){return D}));var w,M=n(7),S=n.n(M),T=n(1),E=function(){function e(t){v(this,e),this._changedEvent=new T.d,this._classToken=t}return m(e,[{key:"classToken",get:function(){return this._classToken}},{key:"on",value:function(e,t){S()("changed"===e),this._changedEvent.subscribe(t)}},{key:"off",value:function(e,t){S()("changed"===e),this._changedEvent.unsubscribe(t)}},{key:"notifyChanged",value:function(){this._changedEvent.fire()}}]),e}(),k=function(e){l(n,e);var t=d(n);function n(e,r){var i;return v(this,n),(i=t.call(this,e))._cachedCombinedIndexSet=void 0,i._nodeCollections=[],i._changedUnderlyingNodeCollectionHandler=i.makeDirty.bind(a(i)),r&&r.forEach((function(e){return i.add(e)})),i}return m(n,[{key:"add",value:function(e){e.on("changed",this._changedUnderlyingNodeCollectionHandler),this._nodeCollections.push(e),this.makeDirty()}},{key:"remove",value:function(e){var t=this._nodeCollections.indexOf(e);if(t<0)throw new Error("Could not find set");e.off("changed",this._changedUnderlyingNodeCollectionHandler),this._nodeCollections.splice(t,1),this.makeDirty()}},{key:"clear",value:function(){this._nodeCollections.forEach((function(e){return e.clear()}))}},{key:"makeDirty",value:function(){void 0!==this._cachedCombinedIndexSet&&(this._cachedCombinedIndexSet=void 0,this.notifyChanged())}},{key:"getIndexSet",value:function(){var e;return this._cachedCombinedIndexSet=null!==(e=this._cachedCombinedIndexSet)&&void 0!==e?e:this.createCombinedIndexSet(),this._cachedCombinedIndexSet}},{key:"isLoading",get:function(){return this._nodeCollections.some((function(e){return e.isLoading}))}}]),n}(E),A=function(e){l(n,e);var t=d(n);function n(e){return v(this,n),t.call(this,n.classToken,e)}return m(n,[{key:"serialize",value:function(){return{token:this.classToken,state:{subCollections:this._nodeCollections.map((function(e){return e.serialize()}))}}}},{key:"createCombinedIndexSet",value:function(){if(0===this._nodeCollections.length)return new T.e;for(var e=this._nodeCollections[0].getIndexSet().clone(),t=1;t<this._nodeCollections.length;++t)e.unionWith(this._nodeCollections[t].getIndexSet());return e}}]),n}(k);A.classToken="UnionNodeCollection";var P=function(e){l(n,e);var t=d(n);function n(e){return v(this,n),t.call(this,A.classToken,e)}return m(n,[{key:"serialize",value:function(){return{token:this.classToken,state:{subCollections:this._nodeCollections.map((function(e){return e.serialize()}))}}}},{key:"createCombinedIndexSet",value:function(){if(0===this._nodeCollections.length)return new T.e;for(var e=this._nodeCollections[0].getIndexSet().clone(),t=1;t<this._nodeCollections.length;++t)e.intersectWith(this._nodeCollections[t].getIndexSet());return e}}]),n}(k);P.classToken="IntersectionNodeCollection";var C=function(e){l(n,e);var t=d(n);function n(e){var r;return v(this,n),r=t.call(this,n.classToken),e instanceof T.e?r._treeIndices=e:(T.i.isNumericRange(e),r._treeIndices=new T.e(e)),r}return m(n,[{key:"updateSet",value:function(e){this._treeIndices=e,this.notifyChanged()}},{key:"clear",value:function(){this._treeIndices=new T.e,this.notifyChanged()}},{key:"getIndexSet",value:function(){return this._treeIndices}},{key:"isLoading",get:function(){return!1}},{key:"serialize",value:function(){return{token:this.classToken,state:this._treeIndices.toRangeArray()}}}]),n}(E);C.classToken="TreeIndexNodeCollection",function(e){e[e.NoOutline=0]="NoOutline",e[e.White=1]="White",e[e.Black=2]="Black",e[e.Cyan=3]="Cyan",e[e.Blue=4]="Blue",e[e.Green=5]="Green",e[e.Red=6]="Red",e[e.Orange=7]="Orange"}(w||(w={}));var O,I,R={visible:!0,outlineColor:w.White},N={visible:!0,renderInFront:!0},D={Default:{visible:!0,renderGhosted:!1,renderInFront:!1,outlineColor:w.NoOutline,color:[0,0,0]},Outlined:R,Hidden:{visible:!1},InFront:N,Ghosted:{visible:!0,renderGhosted:!0},Highlighted:c(c({},N),{},{visible:!0,color:[100,100,255]},R)},L=n(14),B=n.n(L),F=function(){function e(){var t=this;v(this,e),this._styledCollections=new Array,this._events={changed:new T.d,loadingStateChanged:new T.d},this.scheduleNotifyChanged=B()((function(){return t.notifyChanged()}),0)}return m(e,[{key:"on",value:function(e,t){switch(e){case"changed":this._events.changed.subscribe(t);break;case"loadingStateChanged":this._events.loadingStateChanged.subscribe(t);break;default:Object(T.l)(e,"Unsupported event: '".concat(e,"'"))}}},{key:"off",value:function(e,t){switch(e){case"changed":this._events.changed.unsubscribe(t);break;case"loadingStateChanged":this._events.loadingStateChanged.unsubscribe(t);break;default:Object(T.l)(e,"Unsupported event: '".concat(e,"'"))}}},{key:"assignStyledNodeCollection",value:function(e,t){var n=this,r=this._styledCollections.find((function(t){return t.nodeCollection===e}));if(void 0!==r)r.appearance=t,this.handleNodeCollectionChanged(r);else{var i={nodeCollection:e,appearance:t,handleNodeCollectionChangedListener:function(){n.handleNodeCollectionChanged(i)}};this._styledCollections.push(i),e.on("changed",i.handleNodeCollectionChangedListener),this.scheduleNotifyChanged()}}},{key:"unassignStyledNodeCollection",value:function(e){var t=this._styledCollections.findIndex((function(t){return t.nodeCollection===e}));if(-1===t)throw new Error("NodeCollection not added");var n=this._styledCollections[t];this._styledCollections.splice(t,1),e.off("changed",n.handleNodeCollectionChangedListener),this.scheduleNotifyChanged()}},{key:"applyStyles",value:function(e){this._styledCollections.forEach((function(t){var n=t.nodeCollection.getIndexSet();e(n,t.appearance)}))}},{key:"clear",value:function(){var e,t=f(this._styledCollections);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.nodeCollection.off("changed",n.handleNodeCollectionChangedListener)}}catch(e){t.e(e)}finally{t.f()}this._styledCollections.splice(0),this.scheduleNotifyChanged()}},{key:"isLoading",get:function(){return this._styledCollections.some((function(e){return e.nodeCollection.isLoading}))}},{key:"notifyChanged",value:function(){this._events.changed.fire()}},{key:"notifyLoadingStateChanged",value:function(){this._lastFiredLoadingState!==this.isLoading&&(this._lastFiredLoadingState=this.isLoading,this._events.loadingStateChanged.fire(this.isLoading))}},{key:"handleNodeCollectionChanged",value:function(e){this.scheduleNotifyChanged(),this.notifyLoadingStateChanged()}}]),e}(),j=n(0),z=n(11),U=n.n(z),G=n(29),V=n.n(G),W=n(4);!function(e){e[e.NoAA=0]="NoAA",e[e.FXAA=1]="FXAA"}(O||(O={})),function(e){e[e.Medium=32]="Medium",e[e.High=64]="High",e[e.VeryHigh=128]="VeryHigh",e[e.None=1]="None",e[e.Default=32]="Default"}(I||(I={}));var H,Z={antiAliasing:O.FXAA,multiSampleCountHint:1,ssaoRenderParameters:{sampleSize:I.Default,sampleRadius:1,depthCheckBias:.0125},edgeDetectionParameters:{enabled:!0}},q=n(8),Y=n(13);!function(e){e[e.Color=1]="Color",e[e.Normal=2]="Normal",e[e.TreeIndex=3]="TreeIndex",e[e.PackColorAndNormal=4]="PackColorAndNormal",e[e.Depth=5]="Depth",e[e.Effects=6]="Effects",e[e.Ghost=7]="Ghost",e[e.LOD=8]="LOD",e[e.DepthBufferOnly=9]="DepthBufferOnly",e[e.GeometryType=10]="GeometryType"}(H||(H={}));var X=new j.Color("black");function K(e,t){var n,r,i,o=t.camera,a=t.normalizedCoords,s=t.renderer,u=t.domElement,c=new j.Scene,l=e.parent;c.add(e);try{var d={normalizedCoords:a,camera:o,renderer:s,domElement:u,scene:c,cadNode:e},f=function(e){var t,n=e.cadNode,r=n.renderMode;n.renderMode=H.TreeIndex;try{t=ee(e,X,0)}finally{n.renderMode=r}if(0!==t[3])return 255*t[0]*255+255*t[1]+t[2]}(d);if(void 0===f)return;var p=function(e){var t=e.cadNode,n=t.renderMode;t.renderMode=H.Depth;var r,i=ee(e,X,0);return t.renderMode=n,r=i,J.fromArray(r).multiplyScalar(1/255).dot(Q)}(d),h=function(e,t){var n=e.camera,r=e.normalizedCoords,i=new j.Vector3;return i.set(r.x,r.y,.5).applyMatrix4(n.projectionMatrixInverse),i.multiplyScalar(t/i.z),i.applyMatrix4(n.matrixWorld),i}(d,(n=p,(r=o.near)*(i=o.far)/((i-r)*n-i)));return{distance:(new j.Vector3).subVectors(h,o.position).length(),point:h,treeIndex:f,object:e,cadNode:e}}finally{l&&l.add(e)}}var J=new j.Vector4,Q=new j.Vector4(255/256/16777216,255/256/65536,255/256/256,255/256),$={renderTarget:new j.WebGLRenderTarget(1,1),pixelBuffer:new Uint8Array(4)};function ee(e,t,n){var r=$.renderTarget,i=$.pixelBuffer,o=e.scene,a=e.camera,s=e.normalizedCoords,u=e.renderer,c=e.domElement,l=a.clone(),d={x:(s.x+1)/2*c.clientWidth,y:(1-s.y)/2*c.clientHeight};l.setViewOffset(c.clientWidth,c.clientHeight,d.x,d.y,1,1);var f=new T.j(u);try{var p=u.getSize(new j.Vector2),h=p.width,v=p.height;r.setSize(h,v),f.setRenderTarget(r),f.setClearColor(t,n),u.clearColor(),u.render(o,l),u.readRenderTargetPixels(r,0,0,1,1,i)}finally{f.resetState()}return i}var te=function(e){l(n,e);var t=d(n);function n(e){return v(this,n),t.call(this,e)}return m(n)}(i(Error)),ne=function(){function e(t){var n=this;v(this,e),this._camera=t,this._needsRedraw=!0,this._lastCameraPosition=new j.Vector3,this._lastCameraRotation=new j.Euler,this._lastCameraZoom=0,window.addEventListener("focus",(function(){n.redraw()}))}return m(e,[{key:"needsRedraw",get:function(){return this._needsRedraw}},{key:"update",value:function(){var e=this._camera,t=this._lastCameraPosition,n=this._lastCameraRotation,r=this._lastCameraZoom,i=e.position,o=e.rotation,a=e.zoom,s=!i.equals(t)||!o.equals(n)||a!==r;t.copy(i),n.copy(o),this._lastCameraZoom=a,s&&(this._needsRedraw=!0)}},{key:"clearNeedsRedraw",value:function(){this._needsRedraw=!1}},{key:"redraw",value:function(){this._needsRedraw=!0}}]),e}(),re=n(3),ie=function(){function e(t,n,r){var i=this;v(this,e),this.modelId=t,this.revisionId=n,this.nodesApiClient=r,this.nodeIdToTreeIndexMap=new Map,this.treeIndexToNodeIdMap=new Map,this.treeIndexSubTreeSizeMap=new Map,this.nodeIdRequestObservable=new W.Subject,this.nodeIdResponse=this.nodeIdRequestObservable.pipe(Object(re.bufferTime)(50),Object(re.filter)((function(e){return e.length>0})),Object(re.mergeMap)(function(){var e=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.nodesApiClient.mapNodeIdsToTreeIndices(i.modelId,i.revisionId,t);case 2:return n=e.sent,e.abrupt("return",t.map((function(e,t){return{nodeId:e,treeIndex:n[t]}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(re.mergeAll)(),Object(re.tap)((function(e){i.nodeIdToTreeIndexMap.set(e.nodeId,e.treeIndex),i.treeIndexToNodeIdMap.set(e.treeIndex,e.nodeId)})),Object(re.share)()),this.treeIndexRequestObservable=new W.Subject,this.treeIndexResponse=this.treeIndexRequestObservable.pipe(Object(re.bufferTime)(50),Object(re.filter)((function(e){return e.length>0})),Object(re.mergeMap)(function(){var e=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.nodesApiClient.mapTreeIndicesToNodeIds(i.modelId,i.revisionId,t);case 2:return n=e.sent,e.abrupt("return",t.map((function(e,t){return{nodeId:n[t],treeIndex:e}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(re.mergeAll)(),Object(re.tap)((function(e){i.nodeIdToTreeIndexMap.set(e.nodeId,e.treeIndex),i.treeIndexToNodeIdMap.set(e.treeIndex,e.nodeId)})),Object(re.share)()),this.subtreeSizeObservable=new W.Subject,this.subtreeSizeResponse=this.subtreeSizeObservable.pipe(Object(re.bufferTime)(50),Object(re.filter)((function(e){return e.length>0})),Object(re.mergeMap)(function(){var e=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.nodesApiClient.determineTreeIndexAndSubtreeSizesByNodeIds(i.modelId,i.revisionId,t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(re.mergeAll)(),Object(re.tap)((function(e){i.treeIndexSubTreeSizeMap.set(e.treeIndex,e.subtreeSize)})),Object(re.share)())}return m(e,[{key:"getTreeIndex",value:(o=u(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.nodeIdToTreeIndexMap.get(t))){e.next=3;break}return e.abrupt("return",n);case 3:return r=this.nodeIdResponse.pipe(Object(re.first)((function(e){return e.nodeId===t})),Object(re.map)((function(e){return e.treeIndex}))).toPromise(),this.nodeIdRequestObservable.next(t),e.next=7,r;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getNodeId",value:(i=u(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.treeIndexToNodeIdMap.get(t))){e.next=3;break}return e.abrupt("return",n);case 3:return r=this.treeIndexResponse.pipe(Object(re.first)((function(e){return e.treeIndex===t})),Object(re.map)((function(e){return e.nodeId}))).toPromise(),this.treeIndexRequestObservable.next(t),e.next=7,r;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSubtreeSize",value:(r=u(p.mark((function e(t){var n,r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.treeIndexSubTreeSizeMap.get(t))){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,this.getNodeId(t);case 5:return r=e.sent,i=this.subtreeSizeResponse.pipe(Object(re.first)((function(e){return e.treeIndex===t})),Object(re.map)((function(e){return e.subtreeSize}))).toPromise(),this.subtreeSizeObservable.next(r),e.next=10,i;case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getTreeIndices",value:(n=u(p.mark((function e(t){var n,r,i,o,a,s,u,c,l=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return l.nodeIdToTreeIndexMap.get(e)||-1})),0!==(r=t.filter((function(e,t){return-1===n[t]}))).length){e.next=3;break}return e.abrupt("return",n);case 3:return i=new Map(t.map((function(e,t){return[e,t]}))),e.next=6,this.nodesApiClient.mapNodeIdsToTreeIndices(this.modelId,this.revisionId,r);case 6:for(o=e.sent,console.assert(r.length===o.length),a=0;a<o.length;a++)s=r[a],u=o[a],c=i.get(s),n[c]=u,this.add(s,u);return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getNodeIds",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s,u,c,l=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return l.treeIndexToNodeIdMap.get(e)||-1})),0!==(r=t.filter((function(e,t){return-1===n[t]}))).length){e.next=3;break}return e.abrupt("return",n);case 3:return i=new Map(t.map((function(e,t){return[e,t]}))),e.next=6,this.nodesApiClient.mapTreeIndicesToNodeIds(this.modelId,this.revisionId,r);case 6:for(o=e.sent,console.assert(o.length===r.length),a=0;a<o.length;a++)s=o[a],u=r[a],c=i.get(u),n[c]=s,this.add(s,u);return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"add",value:function(e,t){this.nodeIdToTreeIndexMap.set(e,t),this.treeIndexToNodeIdMap.set(t,e)}}]),e;var t,n,r,i,o}();function oe(e,t,n){return ae.apply(this,arguments)}function ae(){return ae=u(p.mark((function e(t,n,r){var i,o,a=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>3&&void 0!==a[3]?a[3]:15e3,o=t,e.abrupt("return",new Promise((function(e){!function t(){for(var a=0;a<i&&o<=n;a++)r(o++);o<=n?setTimeout(t):e()}()})));case 3:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}var se=n(2),ue=function(e){l(w,e);var t,n,r,i,o,c,f,h,y,g,b,x,_=d(w);function w(e,t,n,r){var i;return v(this,w),(i=_.call(this)).type="cad",i._styledNodeCollections=[],i.modelId=e,i.revisionId=t,i.cadModel=n.cadModelMetadata,i.nodesApiClient=r,i.nodeIdAndTreeIndexMaps=new ie(e,t,i.nodesApiClient),i.cadNode=n,i.add(i.cadNode),Object.defineProperty(a(i),"visible",{get:function(){return i.cadNode.visible},set:function(e){i.cadNode.visible=e}}),i}return m(w,[{key:"nodeTransformProvider",get:function(){return this.cadNode.nodeTransformProvider}},{key:"modelUnit",get:function(){return this.cadNode.cadModelMetadata.scene.unit}},{key:"modelUnitToMetersFactor",get:function(){return se.h.get(this.modelUnit)}},{key:"setDefaultNodeAppearance",value:function(e){this.cadNode.defaultNodeAppearance=e}},{key:"getDefaultNodeAppearance",value:function(){return this.cadNode.defaultNodeAppearance}},{key:"styledNodeCollections",get:function(){return s(this._styledNodeCollections)}},{key:"assignStyledNodeCollection",value:function(e,t){if(q.a.trackCadModelStyled(e.classToken,t),-1!==this._styledNodeCollections.findIndex((function(t){return t.nodeCollection===e})))throw new Error("Node collection as already been assigned, use updateStyledNodeCollection() to update the appearance");this._styledNodeCollections.push({nodeCollection:e,appearance:t}),this.cadNode.nodeAppearanceProvider.assignStyledNodeCollection(e,t)}},{key:"updateStyledNodeCollection",value:function(e,t){var n=this._styledNodeCollections.findIndex((function(t){return t.nodeCollection===e}));if(-1===n)throw new Error("The node collection provide has not been assigned previously");this._styledNodeCollections[n].appearance=t,this.cadNode.nodeAppearanceProvider.assignStyledNodeCollection(e,t)}},{key:"unassignStyledNodeCollection",value:function(e){var t=this._styledNodeCollections.findIndex((function(t){return t.nodeCollection===e}));if(-1===t)throw new Error("Node collection has not been assigned to model");this._styledNodeCollections.splice(t,1),this.cadNode.nodeAppearanceProvider.unassignStyledNodeCollection(e)}},{key:"removeAllStyledNodeCollections",value:function(){this._styledNodeCollections.splice(0),this.cadNode.nodeAppearanceProvider.clear()}},{key:"setNodeTransform",value:function(e,t){this.nodeTransformProvider.setNodeTransform(e,t)}},{key:"resetNodeTransform",value:function(e){this.nodeTransformProvider.resetNodeTransform(e)}},{key:"mapFromCdfToModelCoordinates",value:function(e,t){return(t=void 0!==t?t:new j.Vector3)!==e&&t.copy(e),t.applyMatrix4(this.cadModel.modelMatrix),t}},{key:"mapPositionFromModelToCdfCoordinates",value:function(e,t){return(t=void 0!==t?t:new j.Vector3)!==e&&t.copy(e),t.applyMatrix4(this.cadModel.inverseModelMatrix),t}},{key:"mapBoxFromModelToCdfCoordinates",value:function(e,t){return(t=null!=t?t:new j.Box3)!==e&&t.copy(e),t.applyMatrix4(this.cadModel.inverseModelMatrix),t}},{key:"dispose",value:function(){this.children=[]}},{key:"getSubtreeTreeIndices",value:(x=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.determineTreeIndices(t,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"getAncestorTreeIndices",value:(b=u(p.mark((function e(t,n){var r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mapTreeIndexToNodeId(t);case 2:return r=e.sent,e.next=5,this.nodesApiClient.determineNodeAncestorsByNodeId(this.modelId,this.revisionId,r,n);case 5:return i=e.sent,e.abrupt("return",new T.i(i.treeIndex,i.subtreeSize));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"getModelBoundingBox",value:function(e,t){var n=t?this.cadModel.scene.getBoundsOfMostGeometry():this.cadModel.scene.root.bounds;return(e=e||new j.Box3).copy(n),e.applyMatrix4(this.cadModel.modelMatrix),e}},{key:"getCameraConfiguration",value:function(){return this.cadModel.cameraConfiguration}},{key:"setModelTransformation",value:function(e){this.cadNode.setModelTransformation(e)}},{key:"getModelTransformation",value:function(e){return this.cadNode.getModelTransformation(e)}},{key:"getBoundingBoxByNodeId",value:(g=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.nodesApiClient.getBoundingBoxByNodeId(this.modelId,this.revisionId,t,n);case 3:return(n=e.sent).applyMatrix4(this.cadModel.modelMatrix),e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),q.a.trackError(e.t0,{moduleName:"Cognite3DModel",methodName:"getBoundingBoxByNodeId"}),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e,t){return g.apply(this,arguments)})},{key:"getBoundingBoxByTreeIndex",value:(y=u(p.mark((function e(t,n){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nodeIdAndTreeIndexMaps.getNodeId(t);case 2:return r=e.sent,e.abrupt("return",this.getBoundingBoxByNodeId(r,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"iterateNodesByTreeIndex",value:function(e){return oe(0,this.cadModel.scene.maxTreeIndex,e)}},{key:"nodeCount",get:function(){return this.cadModel.scene.maxTreeIndex+1}},{key:"iterateSubtreeByTreeIndex",value:(h=u(p.mark((function e(t,n){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.determineTreeIndices(t,!0);case 2:return r=e.sent,e.abrupt("return",oe(r.from,r.toInclusive,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"setNodeTransformByTreeIndex",value:(f=u(p.mark((function e(t,n){var r,i,o=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(o.length>2&&void 0!==o[2])||o[2],e.next=3,this.determineTreeIndices(t,r);case 3:return i=e.sent,e.abrupt("return",(this.nodeTransformProvider.setNodeTransform(i,n),i.count));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"resetNodeTransformByTreeIndex",value:(c=u(p.mark((function e(t){var n,r,i=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.determineTreeIndices(t,n);case 3:return r=e.sent,e.abrupt("return",(this.nodeTransformProvider.resetNodeTransform(r),r.count));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"mapNodeIdsToTreeIndices",value:(o=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.nodeIdAndTreeIndexMaps.getTreeIndices(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"mapNodeIdToTreeIndex",value:(i=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.nodeIdAndTreeIndexMaps.getTreeIndex(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"mapTreeIndicesToNodeIds",value:(r=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.nodeIdAndTreeIndexMaps.getNodeIds(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"mapTreeIndexToNodeId",value:(n=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.nodeIdAndTreeIndexMaps.getNodeId(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"determineTreeIndices",value:(t=u(p.mark((function e(t,n){var r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=1,!n){e.next=6;break}return e.next=4,this.nodeIdAndTreeIndexMaps.getSubtreeSize(t);case 4:i=e.sent,r=i||1;case 6:return e.abrupt("return",new T.i(t,r));case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),w}(j.Object3D),ce=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return v(this,n),(o=t.call(this)).type="pointcloud",o.modelId=e,o.revisionId=r,o.pointCloudNode=i,o.add(i),o}return m(n,[{key:"dispose",value:function(){this.children=[]}},{key:"getModelBoundingBox",value:function(e){return this.pointCloudNode.getBoundingBox(e)}},{key:"getCameraConfiguration",value:function(){return this.pointCloudNode.cameraConfiguration}},{key:"setModelTransformation",value:function(e){this.pointCloudNode.setModelTransformation(e)}},{key:"getModelTransformation",value:function(e){return this.pointCloudNode.getModelTransformation(e)}},{key:"setClassVisible",value:function(e,t){this.pointCloudNode.setClassVisible(e,t)}},{key:"isClassVisible",value:function(e){return this.pointCloudNode.isClassVisible(e)}},{key:"hasClass",value:function(e){return this.pointCloudNode.hasClass(e)}},{key:"getClasses",value:function(){return this.pointCloudNode.getClasses()}},{key:"visiblePointCount",get:function(){return this.pointCloudNode.visiblePointCount}},{key:"pointColorType",get:function(){return this.pointCloudNode.pointColorType},set:function(e){this.pointCloudNode.pointColorType=e}},{key:"pointSize",get:function(){return this.pointCloudNode.pointSize},set:function(e){this.pointCloudNode.pointSize=e}},{key:"pointShape",get:function(){return this.pointCloudNode.pointShape},set:function(e){this.pointCloudNode.pointShape=e}}]),n}(j.Object3D),le=function(){function e(t){v(this,e),this._loading=!1,e.loadStyles(),this.el=document.createElement("div"),this.el.title=e.titles.idle,this.el.className=e.classnames.base,this.el.classList.add(e.classnames.topLeft),this.el.innerHTML='<svg fill="none" xmlns="http://www.w3.org/2000/svg" width="64" height="38" viewBox="0 0 64 38">\n  <path id="reveal-spinner-top-1" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M50.4542 15.3288c-28.2275 5.9674-28.7378 6.0661-29.2355 6.1624h-.0001c-1.3944.2698-2.6891.5203-3.9772.7036v-6.3583c-.0652-1.475-1.2799-2.6372-2.7563-2.6372s-2.6911 1.1622-2.7563 2.6372v7.1072z"/>\n  <path id="reveal-spinner-top-2" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M50.4542 15.3288c-16.8452 3.375-17.0189 3.4183-17.1711 3.506-1.7276.3694-3.3435.7389-4.9594 1.1083l-.0571.013V7.6106c-.0465-1.48876-1.2668-2.67155-2.7563-2.67155S22.8005 6.12184 22.754 7.6106v13.5866z"/>\n  <path id="reveal-spinner-top-3" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M50.4542 15.3288c-7.274 1.2593-9.1537 1.6344-11.0347 2.0095V2.74337c-.0338-1.54541-1.3116-2.7721267-2.8571-2.74285692h-.0134C35.0327.00556379 33.8015 1.2272 33.7846 2.74337V18.7098z"/>\n  <path id="reveal-spinner-top-4" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M50.4542 15.3288v-3.2274c0-1.5594-1.2642-2.82358-2.8236-2.82358s-2.8235 1.26418-2.8235 2.82358v4.4z"/>\n  <path id="reveal-spinner-center" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M50.4542 15.3288C5.46324 23.6926 1.83164 23.4439 1.45248 22.3172c-.773329-1.6548 3.63593-3.8942 5.79662-4.9915.28489-.1447.53068-.2695.72036-.3706v-.1237h-.12505c-1.62823.6226-8.646718 3.4958-7.768735 5.9832.875294 2.7456 11.653125 3.4958 34.086725-1.9939 18.7926-4.6145 27.4393-5.4925 28.3173-3.7446.6266 1.4952-4.0121 4.3644-8.5217 6.3597-.0966.0984-.1427.2357-.125.3724l.002.002c.1243.1244.2474.2475.3745.1231 1.6268-.6266 10.1499-4.238 9.7721-7.2323-.3738-1.9935-4.8842-2.6175-13.5274-1.3722z"/>\n  <path id="reveal-spinner-bot-1" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M11.7557 30.5551v-2.0894c1.8291-.1048 3.6511-.3108 5.4575-.6171v2.7065c-.033 1.4835-1.245 2.6689-2.7288 2.6689s-2.6958-1.1854-2.7287-2.6689z"/>\n  <path id="reveal-spinner-bot-2" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M22.7715 26.9222v7.602c-.0132 1.496 1.1804 2.7238 2.6762 2.7529 1.4957.0291 2.7362-1.1513 2.7813-2.6467v-8.8309c-1.7953.4821-3.6177.857-5.4575 1.1227z"/>\n  <path id="reveal-spinner-bot-3" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M33.87 24.7193h-.3764v5.3419c.066 1.5151 1.3136 2.7095 2.8302 2.7095s2.7642-1.1944 2.8303-2.7095v-6.5883c-.3876.0886-.7821.1771-1.1838.2671l-.0007.0002c-1.2926.2897-2.6585.5959-4.0996.9764v.0027z"/>\n  <path id="reveal-spinner-bot-4" fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M44.5094 22.2377c2.1383-.3726 4.0242-.7438 5.6578-1.1137v4.3375c-.0249 1.5094-1.2534 2.7212-2.763 2.7254h-.0162c-.7432.0206-1.4641-.255-2.004-.7662-.54-.5112-.8546-1.216-.8746-1.9592v-3.2238z"/>\n</svg>\n',t.style.position="relative",t.appendChild(this.el)}return m(e,[{key:"placement",set:function(t){switch(this.el.classList.remove(e.classnames.bottomLeft,e.classnames.bottomRight,e.classnames.topLeft,e.classnames.topRight),t){case"topLeft":this.el.classList.add(e.classnames.topLeft);break;case"topRight":this.el.classList.add(e.classnames.topRight);break;case"bottomLeft":this.el.classList.add(e.classnames.bottomLeft);break;case"bottomRight":this.el.classList.add(e.classnames.bottomRight);break;default:Object(T.l)(t,"Invalid placement: "+t)}}},{key:"opacity",set:function(e){this.el.style.opacity=""+e}},{key:"loading",get:function(){return this._loading},set:function(t){this._loading=t,t?(this.el.classList.add(e.classnames.loading),this.el.title=e.titles.loading):(this.el.classList.remove(e.classnames.loading),this.el.title=e.titles.idle)}},{key:"updateBackgroundColor",value:function(t){t.getHSL({h:0,s:0,l:0}).l>.5?this.el.classList.add(e.classnames.dark):this.el.classList.remove(e.classnames.dark)}},{key:"dispose",value:function(){this.el.remove();var t=document.getElementById(e.stylesId);t&&t.remove()}}],[{key:"loadStyles",value:function(){if(!document.getElementById(e.stylesId)){var t=document.createElement("style");t.id=e.stylesId,t.appendChild(document.createTextNode(".reveal-viewer-spinner-top-left {\n  top: 10px;\n  left: 10px;\n}\n\n.reveal-viewer-spinner-top-right {\n  top: 10px;\n  right: 10px;\n}\n\n.reveal-viewer-spinner-bottom-left {\n  bottom: 10px;\n  left: 10px;\n}\n\n.reveal-viewer-spinner-bottom-right {\n  bottom: 10px;\n  right: 10px;\n}\n\n.reveal-viewer-spinner {\n  position: absolute;\n  color: white;\n}\n.reveal-viewer-spinner--dark {\n  color: black;\n}\n\n.reveal-viewer-spinner--loading #reveal-spinner-bot-1,\n.reveal-viewer-spinner--loading #reveal-spinner-top-1 {\n  animation: reveal-loading-opacity 0.8s ease-out infinite alternate;\n}\n.reveal-viewer-spinner--loading #reveal-spinner-bot-2,\n.reveal-viewer-spinner--loading #reveal-spinner-top-2 {\n  animation: reveal-loading-opacity 0.8s ease-out 0.2s infinite alternate;\n}\n.reveal-viewer-spinner--loading #reveal-spinner-bot-3,\n.reveal-viewer-spinner--loading #reveal-spinner-top-3 {\n  animation: reveal-loading-opacity 0.8s ease-out 0.4s infinite alternate;\n}\n.reveal-viewer-spinner--loading #reveal-spinner-bot-4,\n.reveal-viewer-spinner--loading #reveal-spinner-top-4 {\n  animation: reveal-loading-opacity 0.8s ease-out 0.6s infinite alternate;\n}\n\n.reveal-viewer-spinner--loading #center {\n  transform-origin: center;\n  animation: reveal-loading-scale 1.6s ease-out infinite 0.8s alternate,\n    reveal-loading-opacity 1.6s ease-out infinite alternate;\n}\n\n@keyframes reveal-loading-opacity {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0.2;\n  }\n}\n\n@keyframes reveal-loading-scale {\n  100% {\n    transform: scaleY(1.2) translateY(0.6px);\n  }\n}\n")),document.head.appendChild(t)}}}]),e}();le.stylesId="reveal-viewer-spinner-styles",le.classnames={base:"reveal-viewer-spinner",topLeft:"reveal-viewer-spinner-top-left",topRight:"reveal-viewer-spinner-top-right",bottomLeft:"reveal-viewer-spinner-bottom-left",bottomRight:"reveal-viewer-spinner-bottom-right",loading:"reveal-viewer-spinner--loading",dark:"reveal-viewer-spinner--dark"},le.titles={idle:"2.3.0",loading:"2.3.0 Loading..."};var de=n(9),fe=new j.Vector2,pe=new j.Raycaster;function he(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.05,r=t.normalizedCoords,i=t.camera;return fe.set(r.x,r.y),pe.setFromCamera(r,i),pe.params.Points={threshold:n},pe.intersectObjects(e,!0).filter((function(e){return function(e,t){for(var n=!0,r=0;n&&r<t.length;++r)n=t[r].distanceToPoint(e)>=0;return n}(e.point,t.clippingPlanes)})).map((function(t){var n=function(e,t){for(;"Points"===e.type&&null!==e.parent;)e=e.parent;if(e instanceof de.PointCloudOctree){var n=e.root;return t.find((function(e){return n.pointcloud===e.potreeNode.octtree}))||null}return null}(t.object,e);if(null===n)throw new Error("Could not find PointCloudNode for intersected point");return{distance:t.distance,point:t.point,pointIndex:t.index,pointCloudNode:n,object:t.object}}))}var ve=function(){function e(t,n){v(this,e),this._ongoingOperations=0,this._interrupted=!1,this._itemToTreeIndexRangeCallback=t,this._notifyChangedCallback=n}return m(e,[{key:"interrupt",value:function(){this._interrupted=!0}},{key:"isLoading",get:function(){return!this._interrupted&&this._ongoingOperations>0}},{key:"pageResults",value:(t=u(p.mark((function e(t,n){var r,i,o,a;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._itemToTreeIndexRangeCallback,i=this._notifyChangedCallback,this._ongoingOperations++,e.prev=2,e.next=5,n;case 5:o=e.sent;case 6:if(this._interrupted){e.next=15;break}if(a=o.next?o.next():void 0,o.items.forEach((function(e){var n=r(e);t.addRange(n)})),i(),a){e.next=10;break}return e.abrupt("break",15);case 10:return e.next=12,a;case 12:o=e.sent;case 13:e.next=6;break;case 15:return e.abrupt("return",!this._interrupted);case 16:return e.prev=16,this._ongoingOperations--,e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,,16,19]])}))),function(e,n){return t.apply(this,arguments)})}]),e;var t}(),me=n(15),ye=n.n(me),ge=function(e){l(r,e);var t,n=d(r);function r(e,t){var i;return v(this,r),(i=n.call(this,r.classToken))._indexSet=new T.e,i._client=e,i._model=t,i._fetchResultHelper=void 0,i}return m(r,[{key:"isLoading",get:function(){return void 0!==this._fetchResultHelper&&this._fetchResultHelper.isLoading}},{key:"executeFilter",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._model,void 0!==this._fetchResultHelper&&this._fetchResultHelper.interrupt(),r=new ve((function(e){return new T.i(e.treeIndex,e.subtreeSize)}),(function(){return s.notifyChanged()})),this._fetchResultHelper=r,i={assetId:t.assetId,intersectsBoundingBox:function(e){if(void 0!==e){var t=(new j.Box3).copy(e);return n.mapBoxFromModelToCdfCoordinates(t,t),{min:[t.min.x,t.min.y,t.min.z],max:[t.max.x,t.max.y,t.max.z]}}}(t.boundingBox),limit:1e3},o=new T.e,this._indexSet=o,this._filter=t,a=this._client.assetMappings3D.list(n.modelId,n.revisionId,i),e.next=9,r.pageResults(o,a);case 9:if(e.t0=e.sent,!e.t0){e.next=12;break}this._fetchResultHelper=void 0;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clear",value:function(){void 0!==this._fetchResultHelper&&this._fetchResultHelper.interrupt(),this._indexSet.clear()}},{key:"getIndexSet",value:function(){return this._indexSet}},{key:"serialize",value:function(){return{token:this.classToken,state:ye()(this._filter)}}}]),r}(E);ge.classToken="AssetNodeCollection";var be=n(16),xe=n.n(be),_e=function(e){l(r,e);var t,n=d(r);function r(e,t){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v(this,r),(i=n.call(this,r.classToken))._indexSet=new T.e,i._filter={},i._client=e,i._modelId=t.modelId,i._revisionId=t.revisionId,i._options=c({requestPartitions:1},o),i}return m(r,[{key:"isLoading",get:function(){return void 0!==this._fetchResultHelper&&this._fetchResultHelper.isLoading}},{key:"executeFilter",value:(t=u(p.mark((function e(t){var n,r,i,o,a=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new T.e,r=this._options.requestPartitions,void 0!==this._fetchResultHelper&&this._fetchResultHelper.interrupt(),i=new ve((function(e){return new T.i(e.treeIndex,e.subtreeSize)}),(function(){return a.notifyChanged()})),this._fetchResultHelper=i,this._indexSet=n,o=xe()(1,r+1).map(function(){var e=u(p.mark((function e(o){var s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a._client.revisions3D.list3DNodes(a._modelId,a._revisionId,{properties:t,limit:1e3,sortByNodeId:!0,partition:"".concat(o,"/").concat(r)}),e.abrupt("return",i.pageResults(n,s));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this._filter=t,this.notifyChanged(),e.next=9,Promise.all(o);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clear",value:function(){void 0!==this._fetchResultHelper&&this._fetchResultHelper.interrupt(),this._indexSet.clear(),this.notifyChanged()}},{key:"getIndexSet",value:function(){return this._indexSet}},{key:"serialize",value:function(){return{token:this.classToken,state:ye()(this._filter),options:c({},this._options)}}}]),r}(E);_e.classToken="PropertyFilterNodeCollection";var we=function(e){l(n,e);var t=d(n);function n(e,r){var i;return v(this,n),(i=t.call(this,n.classToken))._innerCollection=r,i._innerCollection.on("changed",(function(){i._cachedIndexSet=void 0,i.notifyChanged()})),i._allTreeIndicesRange=new T.i(0,e.nodeCount),i}return m(n,[{key:"isLoading",get:function(){return this._innerCollection.isLoading}},{key:"getIndexSet",value:function(){if(void 0===this._cachedIndexSet){var e=this._innerCollection.getIndexSet(),t=new T.e;t.addRange(this._allTreeIndicesRange),t.differenceWith(e),this._cachedIndexSet=t}return this._cachedIndexSet}},{key:"serialize",value:function(){return{token:this.classToken,state:{innerCollection:this._innerCollection.serialize()}}}},{key:"clear",value:function(){throw new Error("clear() is not supported")}}]),n}(E);we.classToken="InvertedNodeCollection";var Me=function(e){l(i,e);var t,n=d(i);function i(e,t){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v(this,i),(r=n.call(this,i.classToken))._indexSet=new T.e,r._filter={propertyCategory:"",propertyKey:"",propertyValues:new Array},r._client=e,r._modelId=t.modelId,r._revisionId=t.revisionId,r._options=c({requestPartitions:1},o),r}return m(i,[{key:"isLoading",get:function(){return void 0!==this._fetchResultHelper&&this._fetchResultHelper.isLoading}},{key:"executeFilter",value:(t=u(p.mark((function e(t,n,i){var o,a,s,c,l,d=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new T.e,a=this._options.requestPartitions,void 0!==this._fetchResultHelper&&this._fetchResultHelper.interrupt(),s=new ve((function(e){return new T.i(e.treeIndex,e.subtreeSize)}),(function(){return d.notifyChanged()})),this._fetchResultHelper=s,this._indexSet=o,c=this.buildUrl(),l=Array.from(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=8;break}return r=t.slice(n,Math.min(t.length,n+1e3)),e.next=5,r;case 5:n+=1e3,e.next=1;break;case 8:case"end":return e.stop()}}),e)}))(i)).flatMap((function(e){var i={properties:r({},""+t,r({},""+n,e))};return xe()(1,a+1).map(function(){var e=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=u(p.mark((function e(t,n,r){var i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te(t,n,r);case 2:return i=e.sent,e.abrupt("return",new Se(t,n,r,i));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()(d._client,c,{data:{filter:i,limit:1e3,partition:"".concat(t,"/").concat(a)}}),e.abrupt("return",s.pageResults(o,n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),this.notifyChanged(),e.next=8,Promise.all(l);case 8:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"clear",value:function(){void 0!==this._fetchResultHelper&&this._fetchResultHelper.interrupt(),this._indexSet.clear(),this.notifyChanged()}},{key:"getIndexSet",value:function(){return this._indexSet}},{key:"buildUrl",value:function(){return"".concat(this._client.getBaseUrl(),"/api/v1/projects/").concat(this._client.project,"/3d/models/").concat(this._modelId,"/revisions/").concat(this._revisionId,"/nodes/list")}},{key:"serialize",value:function(){return{token:this.classToken,state:ye()(this._filter),options:c({},this._options)}}}]),i}(E);Me.classToken="SinglePropertyNodeCollection";var Se=m((function e(t,n,r,i){var o=this;v(this,e),this.items=i.items,this.nextCursor=i.nextCursor,void 0!==this.nextCursor&&(this.next=u(p.mark((function i(){var a,s;return p.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=c(c({},r),{},{data:c(c({},r.data),{},{cursor:o.nextCursor})}),i.next=3,Te(t,n,a);case 3:return s=i.sent,i.abrupt("return",new e(t,n,r,s));case 5:case"end":return i.stop()}}),i)}))))}));function Te(e,t,n){return Ee.apply(this,arguments)}function Ee(){return Ee=u(p.mark((function e(t,n,r){var i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post(n,r);case 2:if(200!==(i=e.sent).status){e.next=5;break}return e.abrupt("return",i.data);case 5:throw new Error("Unexpected status from server while POST ".concat(n,": ").concat(i.status," (body: ").concat(i.data,")"));case 6:case"end":return e.stop()}}),e)}))),Ee.apply(this,arguments)}var ke=function(){function e(){v(this,e),this._types=new Map,this._types=new Map,this.registerWellKnownNodeCollectionTypes()}return m(e,[{key:"registerNodeCollectionType",value:function(e,t){this._types.set(e,{deserializer:function(e,n){return t(e,n)}})}},{key:"deserialize",value:(t=u(p.mark((function e(t,n,r){var i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={client:t,model:n},e.abrupt("return",this.getDeserializer(r.token)(r,i));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"getDeserializer",value:function(e){var t=this._types.get(e);return S()(void 0!==t),t.deserializer}},{key:"registerWellKnownNodeCollectionTypes",value:function(){var e=this;this.registerNodeCollectionType(ge.classToken,function(){var e=u(p.mark((function e(t,n){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new ge(n.client,n.model),e.next=3,r.executeFilter(t.state);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.registerNodeCollectionType(_e.classToken,function(){var e=u(p.mark((function e(t,n){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new _e(n.client,n.model,t.options),e.next=3,r.executeFilter(t.state);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.registerNodeCollectionType(Me.classToken,function(){var e=u(p.mark((function e(t,n){var r,i,o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Me(n.client,n.model,t.options),i=t.state,o=i.propertyCategory,a=i.propertyKey,s=i.propertyValues,e.next=3,r.executeFilter(o,a,s);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.registerNodeCollectionType(C.classToken,(function(e){var t=new T.e;e.state.forEach((function(e){return t.addRange(new T.i(e.from,e.count))}));var n=new C(t);return Promise.resolve(n)})),this.registerNodeCollectionType(P.classToken,function(){var t=u(p.mark((function t(n,r){var i;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.state.subCollections.map((function(t){return e.deserialize(r.client,r.model,t)})));case 2:return i=t.sent,t.abrupt("return",new P(i));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.registerNodeCollectionType(A.classToken,function(){var t=u(p.mark((function t(n,r){var i;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.state.subCollections.map((function(t){return e.deserialize(r.client,r.model,t)})));case 2:return i=t.sent,t.abrupt("return",new A(i));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.registerNodeCollectionType(we.classToken,function(){var t=u(p.mark((function t(n,r){var i;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.deserialize(r.client,r.model,n.state.innerSet);case 2:return i=t.sent,t.abrupt("return",new we(r.model,i));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}]),e;var t}();function Ae(e,t){ke.Instance.registerNodeCollectionType(e,t)}ke.Instance=new ke;var Pe=function(){function e(t,n){v(this,e),this._viewer=t,this._cdfClient=n,this._cameraControls=t.cameraControls}return m(e,[{key:"getCurrentState",value:function(){var e=this._cameraControls.getState(),t=this._viewer.models.filter((function(e){return e instanceof ue})).map((function(e){return e})).map((function(e){return{defaultNodeAppearance:e.getDefaultNodeAppearance(),modelId:e.modelId,revisionId:e.revisionId,styledSets:e.styledNodeCollections.map((function(e){var t=e.nodeCollection,n=e.appearance;return c(c({},t.serialize()),{},{appearance:n})}))}}));return{camera:{position:e.position,target:e.target},models:t}}},{key:"setState",value:(t=u(p.mark((function e(t){var n,r,i,o=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.camera.position,r=t.camera.target,this._cameraControls.setState(new j.Vector3(n.x,n.y,n.z),new j.Vector3(r.x,r.y,r.z)),i=this._viewer.models.filter((function(e){return e instanceof ue})).map((function(e){return e})),e.next=5,Promise.all(t.models.map((function(e){var t=i.find((function(t){return t.modelId==e.modelId&&t.revisionId==e.revisionId}));if(void 0===t)throw new Error("Cannot apply model state. Model (modelId: ".concat(e.modelId,", revisionId: ").concat(e.revisionId,") has not been added to viewer."));return{model:t,state:e}})).map(function(){var e=u(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.model,r=t.state,n.setDefaultNodeAppearance(r.defaultNodeAppearance),e.next=4,Promise.all(r.styledSets.map(function(){var e=u(p.mark((function e(t){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke.Instance.deserialize(o._cdfClient,n,{token:t.token,state:t.state,options:t.options});case 2:r=e.sent,n.assignStyledNodeCollection(r,t.appearance);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t}(),Ce=function(){function e(t){v(this,e),this._geometryClipBox=t}return m(e,[{key:"createClippedModel",value:function(e){var t=function e(t,n){var r=t.bounds,i=t.bounds.clone();if(i.intersect(n),!i.isEmpty()){for(var o=[],a=0;a<t.children.length;a++){var s=e(t.children[a],n);void 0!==s&&o.push(s)}var u=Ie(i)/Ie(r),l=Math.min(1,1-1/(1+10*u));return c(c({},t),{},{children:o,estimatedDrawCallCount:Math.ceil(l*t.estimatedDrawCallCount),estimatedRenderCost:Math.ceil(l*t.estimatedRenderCost),bounds:i})}}(e.scene.root,this._geometryClipBox);if(void 0===t)throw new Error("No sectors inside provided geometry clip box");var n=new Map;Object(T.u)(t,(function(e){return n.set(e.id,e),!0}));var r=(new se.g).createSectorScene(e.scene.version,e.scene.maxTreeIndex,e.scene.unit,t);return c(c({},e),{},{scene:r,geometryClipBox:this._geometryClipBox.clone()})}}]),e}(),Oe={size:new j.Vector3};function Ie(e){var t=Oe.size;return e.getSize(t),t.x*t.y*t.z}var Re=function(){function e(t,n,r,i){var o=this;v(this,e),this._cadModelMap=new Map,this._subscription=new W.Subscription,this._needsRedraw=!1,this._markNeedsRedrawBound=this.markNeedsRedraw.bind(this),this._materialsChangedListener=this.handleMaterialsChanged.bind(this),this._materialManager=t,this._cadModelMetadataRepository=n,this._cadModelFactory=r,this._cadModelUpdateHandler=i,this._materialManager.on("materialsChanged",this._materialsChangedListener),this._subscription.add(this._cadModelUpdateHandler.consumedSectorObservable().subscribe({next:function(e){var t=o._cadModelMap.get(e.modelIdentifier);if(t){e.instancedMeshes&&e.levelOfDetail===se.d.Detailed?t.updateInstancedMeshes(e.instancedMeshes,e.modelIdentifier,e.metadata.id):e.levelOfDetail!==se.d.Simple&&e.levelOfDetail!==se.d.Discarded||t.discardInstancedMeshes(e.metadata.id);var n=t.rootSector.sectorNodeMap.get(e.metadata.id);if(!n)throw new Error("Could not find 3D node for sector ".concat(e.metadata.id," - invalid id?"));e.group&&n.add(e.group),n.updateGeometry(e.group,e.levelOfDetail),o.markNeedsRedraw()}},error:function(e){q.a.trackError(e,{moduleName:"CadManager",methodName:"constructor"})}}))}return m(e,[{key:"materialManager",get:function(){return this._materialManager}},{key:"budget",get:function(){return this._cadModelUpdateHandler.budget},set:function(e){this._cadModelUpdateHandler.budget=e}},{key:"loadedStatistics",get:function(){return this._cadModelUpdateHandler.lastBudgetSpendage}},{key:"dispose",value:function(){this._cadModelUpdateHandler.dispose(),this._subscription.unsubscribe(),this._materialManager.off("materialsChanged",this._materialsChangedListener)}},{key:"requestRedraw",value:function(){this._needsRedraw=!0}},{key:"resetRedraw",value:function(){this._needsRedraw=!1}},{key:"needsRedraw",get:function(){return this._needsRedraw}},{key:"updateCamera",value:function(e){this._cadModelUpdateHandler.updateCamera(e),this._needsRedraw=!0}},{key:"clippingPlanes",get:function(){return this._materialManager.clippingPlanes},set:function(e){this._materialManager.clippingPlanes=e,this._cadModelUpdateHandler.clippingPlanes=e,this._needsRedraw=!0}},{key:"renderMode",get:function(){return this._materialManager.getRenderMode()},set:function(e){this._materialManager.setRenderMode(e)}},{key:"addModel",value:(t=u(p.mark((function e(t,n){var r,i,o;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._cadModelMetadataRepository.loadData(t);case 2:if(r=e.sent,!this._cadModelMap.has(r.modelIdentifier)){e.next=5;break}throw new Error("Model ".concat(t," has already been added"));case 5:return i=function(e,t){return null===t?e:new Ce(t).createClippedModel(e)}(r,function(e,t){if(void 0===e||void 0===e.boundingBox)return null;if(!e.isBoundingBoxInModelCoordinates)return e.boundingBox;var n=e.boundingBox.clone();return n.applyMatrix4(t.inverseModelMatrix),n}(n,r)),o=this._cadModelFactory.createModel(i),e.abrupt("return",(o.addEventListener("update",this._markNeedsRedrawBound),this._cadModelMap.set(r.modelIdentifier,o),this._cadModelUpdateHandler.addModel(o),o));case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"removeModel",value:function(e){var t=e.cadModelMetadata;if(!this._cadModelMap.delete(t.modelIdentifier))throw new Error("Could not remove model ".concat(t.modelIdentifier," because it's not added"));e.removeEventListener("update",this._markNeedsRedrawBound),this._cadModelUpdateHandler.removeModel(e)}},{key:"getLoadingStateObserver",value:function(){return this._cadModelUpdateHandler.getLoadingStateObserver()}},{key:"markNeedsRedraw",value:function(){this._needsRedraw=!0}},{key:"handleMaterialsChanged",value:function(){this.requestRedraw()}}]),e;var t}(),Ne=function(){function e(t,n){v(this,e),this._materialManager=n,this._instancedGeometryMap=new Map,this._instancedAttributeMap=new Map,this._processedSectorMap=new Map,this._instancedMeshGroup=t}return m(e,[{key:"addInstanceMeshes",value:function(e,t,n){if(!this._processedSectorMap.has(n)){this._instancedGeometryMap.has(e.fileId)||this._instancedGeometryMap.set(e.fileId,{vertices:new j.Float32BufferAttribute(e.vertices.buffer,3),indices:new j.Uint32BufferAttribute(e.indices.buffer,1)});var r,i=this._instancedGeometryMap.get(e.fileId),o=this._materialManager.getModelMaterials(t).instancedMesh,a=f(e.instances);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=JSON.stringify([e.fileId,s.triangleOffset]);if(this._instancedAttributeMap.has(u)){var c=this._instancedAttributeMap.get(u),l=c.treeIndexBuffer.add(s.treeIndices),d=c.colorBuffer.add(s.colors),p=c.instanceMatrixBuffer.add(s.instanceMatrices);c.updateAttributes(),this.addBatchDescriptor(u,l.batchId,d.batchId,p.batchId,n),c.mesh.count=c.treeIndexBuffer.length,(l.bufferIsReallocated||d.bufferIsReallocated||p.bufferIsReallocated)&&this.recreateBufferGeometry(i,c,s,u)}else this.createInstance(s,i,o,u,n)}}catch(e){a.e(e)}finally{a.f()}}}},{key:"removeSectorInstancedMeshes",value:function(e){var t=this._processedSectorMap.get(e);if(t){var n,r=f(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this._instancedAttributeMap.get(i.instanceIdentifier);if(void 0===o)throw new Error("Cannot resolve instance identifier for sector "+e);o.treeIndexBuffer.remove(i.treeIndicesbatchId),o.colorBuffer.remove(i.colorsBatchId),o.instanceMatrixBuffer.remove(i.instanceMatricesBatchId),o.updateAttributes(),o.mesh.count=o.treeIndexBuffer.length}}catch(e){r.e(e)}finally{r.f()}this._processedSectorMap.delete(e)}}},{key:"createInstancedBufferGeometry",value:function(e,t,n,r,i){var o=new j.InstancedBufferGeometry;o.setIndex(t),o.setAttribute("position",e);var a=new j.InstancedBufferAttribute(n.buffer,1);o.setAttribute("a_treeIndex",a);var s=new j.InstancedBufferAttribute(r.buffer,4,!0);o.setAttribute("a_color",s);for(var u=new j.InstancedInterleavedBuffer(i.buffer,16),c=0;c<4;c++){var l=new j.InterleavedBufferAttribute(u,4,4*c);o.setAttribute("a_instanceMatrix_column_"+c,l)}return[o,function(){a.needsUpdate=!0,s.needsUpdate=!0,u.needsUpdate=!0}]}},{key:"recreateBufferGeometry",value:function(e,t,n,r){var i=this.createInstancedBufferGeometry(e.vertices,e.indices,t.treeIndexBuffer,t.colorBuffer,t.instanceMatrixBuffer),o=h(i,2),a=o[0],s=o[1];a.setDrawRange(3*n.triangleOffset,3*n.triangleCount),t.mesh.geometry.dispose(),t.mesh.geometry=a,t.mesh.count=t.treeIndexBuffer.length,this._instancedAttributeMap.set(r,{mesh:t.mesh,treeIndexBuffer:t.treeIndexBuffer,colorBuffer:t.colorBuffer,instanceMatrixBuffer:t.instanceMatrixBuffer,updateAttributes:s})}},{key:"createInstance",value:function(e,t,n,r,i){var o=new T.c(e.treeIndices.length,Float32Array),a=o.add(e.treeIndices),s=new T.c(e.colors.length,Uint8Array),u=s.add(e.colors),c=new T.c(e.instanceMatrices.length,Float32Array),l=c.add(e.instanceMatrices);this.addBatchDescriptor(r,a.batchId,u.batchId,l.batchId,i);var d=this.createInstancedBufferGeometry(t.vertices,t.indices,o,s,c),f=h(d,2),p=f[0],v=f[1];p.setDrawRange(3*e.triangleOffset,3*e.triangleCount);var m=new j.InstancedMesh(p,n,o.length);m.frustumCulled=!1,this._instancedAttributeMap.set(r,{mesh:m,treeIndexBuffer:o,colorBuffer:s,instanceMatrixBuffer:c,updateAttributes:v}),this._instancedMeshGroup.add(m),m.updateMatrixWorld(!0)}},{key:"addBatchDescriptor",value:function(e,t,n,r,i){var o={instanceIdentifier:e,treeIndicesbatchId:t,colorsBatchId:n,instanceMatricesBatchId:r},a=this._processedSectorMap.get(i);a?a.push(o):this._processedSectorMap.set(i,[o])}}]),e}(),De=function(e){l(n,e);var t=d(n);function n(e,r){var i;v(this,n),(i=t.call(this))._previousCameraMatrix=new j.Matrix4,i.type="CadNode",i.name="Sector model",i._materialManager=r;var o=new j.Group;o.name="InstancedMeshes",i._instancedMeshManager=new Ne(o,r);var a=new se.e(e);a.add(o),i._cadModelMetadata=e;var s=e.scene;return i._sectorScene=s,i._previousCameraMatrix.elements[0]=1/0,i._rootSector=a,i.add(a),i.matrixAutoUpdate=!1,i.updateMatrixWorld(),i.setModelTransformation(e.modelMatrix),i}return m(n,[{key:"nodeTransformProvider",get:function(){return this._materialManager.getModelNodeTransformProvider(this._cadModelMetadata.modelIdentifier)}},{key:"nodeAppearanceProvider",get:function(){return this._materialManager.getModelNodeAppearanceProvider(this._cadModelMetadata.modelIdentifier)}},{key:"defaultNodeAppearance",get:function(){return this._materialManager.getModelDefaultNodeAppearance(this._cadModelMetadata.modelIdentifier)},set:function(e){this._materialManager.setModelDefaultNodeAppearance(this._cadModelMetadata.modelIdentifier,e)}},{key:"clippingPlanes",get:function(){return this._materialManager.clippingPlanes},set:function(e){this._materialManager.clippingPlanes=e}},{key:"cadModelMetadata",get:function(){return this._cadModelMetadata}},{key:"sectorScene",get:function(){return this._sectorScene}},{key:"rootSector",get:function(){return this._rootSector}},{key:"materialManager",get:function(){return this._materialManager}},{key:"renderMode",get:function(){return this._materialManager.getRenderMode()},set:function(e){this._materialManager.setRenderMode(e)}},{key:"setModelTransformation",value:function(e){this._rootSector.setModelTransformation(e),this._cadModelMetadata.modelMatrix.copy(e)}},{key:"getModelTransformation",value:function(e){return this._rootSector.getModelTransformation(e)}},{key:"suggestCameraConfig",value:function(){var e=function(e){var t=new j.Vector3,n=new j.Vector3,r=0;Object(T.u)(e,(function(e){return t.add(e.bounds.min),n.add(e.bounds.max),r+=1,!0})),t.divideScalar(r),n.divideScalar(r);var i=new j.Box3(t,n),o=i.getCenter(new j.Vector3),a=i.getSize(new j.Vector3);a.x*=-2,a.y*=-2,a.z*=2;var s=(new j.Vector3).addVectors(o,a);return{position:s,target:o,near:.1,far:12*s.distanceTo(o)}}(this._sectorScene.root),t=e.position,n=e.target,r=e.near,i=e.far,o=this.getModelTransformation(),a=t.clone(),s=n.clone();return a.applyMatrix4(o),s.applyMatrix4(o),{position:a,target:s,near:r,far:i}}},{key:"updateInstancedMeshes",value:function(e,t,n){var r,i=f(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;this._instancedMeshManager.addInstanceMeshes(o,t,n)}}catch(e){i.e(e)}finally{i.f()}}},{key:"discardInstancedMeshes",value:function(e){this._instancedMeshManager.removeSectorInstancedMeshes(e)}}]),n}(j.Object3D),Le=n(20),Be=function(){function e(t){v(this,e),this._materialManager=t}return m(e,[{key:"createModel",value:function(e){var t=e.modelIdentifier,n=e.scene,r=new De(e,this._materialManager);if(this._materialManager.addModelMaterials(t,n.maxTreeIndex),null!==e.geometryClipBox){var i=function(e,t){var n=e.min.clone().applyMatrix4(t.modelMatrix),r=e.max.clone().applyMatrix4(t.modelMatrix);return(new j.Box3).setFromPoints([n,r])}(e.geometryClipBox,e),o=new Le.a(i).clippingPlanes;this._materialManager.setModelClippingPlanes(e.modelIdentifier,o)}return r}}]),e}(),Fe=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0]),je=new j.Float32BufferAttribute(Fe.buffer,3),ze=(new j.Box3).setFromArray(Fe),Ue=new Map([["color",{offset:0,size:12}],["treeIndex",{offset:12,size:4}],["normal",{offset:16,size:12}],["instanceMatrix",{offset:28,size:64}]]);function Ge(e,t,n){var r,i,a,s=arguments;return p.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=s.length>3&&void 0!==s[3]?s[3]:null,i=e.primitives,o.t0=Ve(i.boxCollection),!o.t0){o.next=6;break}return o.next=6,function(e,t,n,r){var i=Object(se.n)(e,t,se.j,r),o=new j.InstancedBufferGeometry,a=new j.Mesh(o,n);return o.setIndex(se.i.index),o.setAttribute("position",se.i.position),o.setAttribute("normal",se.i.normal),We(o,i,t,a),Ke(o),a.onBeforeRender=function(){return Ze(n,a.matrixWorld)},a.name="Primitives (Boxes)",a}(i.boxCollection,i.boxAttributes,t.box,r);case 6:if(o.t1=Ve(i.circleCollection),!o.t1){o.next=10;break}return o.next=10,function(e,t,n,r){var i=Object(se.n)(e,t,se.u,r),o=new j.InstancedBufferGeometry,a=new j.Mesh(o,n);return o.setIndex(se.t.index),o.setAttribute("position",se.t.position),o.setAttribute("normal",se.t.position),We(o,i,t,a),Ke(o),a.onBeforeRender=function(){return Ze(n,a.matrixWorld)},a.name="Primitives (Circles)",a}(i.circleCollection,i.circleAttributes,t.circle,r);case 10:if(o.t2=Ve(i.coneCollection),!o.t2){o.next=14;break}return o.next=14,function(e,t,n,r,i){var o=Object(se.o)(e,t,i),a=new j.InstancedBufferGeometry,s=new j.Mesh(a,n);return a.setIndex(se.k.index),a.setAttribute("position",se.k.position),We(a,o,t,s),qe(a,r),s.onBeforeRender=function(){return Ze(n,s.matrixWorld)},s.name="Primitives (Cones)",s}(i.coneCollection,i.coneAttributes,t.cone,n,r);case 14:if(o.t3=Ve(i.eccentricConeCollection),!o.t3){o.next=18;break}return o.next=18,function(e,t,n,r,i){var o=Object(se.o)(e,t,i),a=new j.InstancedBufferGeometry,s=new j.Mesh(a,n);return a.setIndex(se.k.index),a.setAttribute("position",se.k.position),We(a,o,t,s),qe(a,r),s.onBeforeRender=function(){return Ze(n,s.matrixWorld)},s.name="Primitives (EccentricCones)",s}(i.eccentricConeCollection,i.eccentricConeAttributes,t.eccentricCone,n,r);case 18:if(o.t4=Ve(i.ellipsoidSegmentCollection),!o.t4){o.next=22;break}return o.next=22,function(e,t,n,r,i){var o=Object(se.p)(e,t,i),a=new j.InstancedBufferGeometry,s=new j.Mesh(a,n);return a.setIndex(se.k.index),a.setAttribute("position",se.k.position),We(a,o,t,s),qe(a,r),s.onBeforeRender=function(){return Ze(n,s.matrixWorld)},s.name="Primitives (EllipsoidSegments)",s}(i.ellipsoidSegmentCollection,i.ellipsoidSegmentAttributes,t.ellipsoidSegment,n,r);case 22:if(!Ve(i.generalCylinderCollection)){o.next=28;break}if(a=function(e,t,n,r,i){var o=Object(se.o)(e,t,i,"radius","radius");if(0===o.length)return null;var a=new j.InstancedBufferGeometry,s=new j.Mesh(a,n);return a.setIndex(se.k.index),a.setAttribute("position",se.k.position),We(a,o,t,s),qe(a,r),s.onBeforeRender=function(){return Ze(n,s.matrixWorld)},s.name="Primitives (GeneralCylinders)",s}(i.generalCylinderCollection,i.generalCylinderAttributes,t.generalCylinder,n,r),o.t5=a,!o.t5){o.next=28;break}return o.next=28,a;case 28:if(o.t6=Ve(i.generalRingCollection),!o.t6){o.next=32;break}return o.next=32,function(e,t,n,r){var i=Object(se.n)(e,t,se.u,r),o=new j.InstancedBufferGeometry,a=new j.Mesh(o,n);return o.setIndex(se.t.index),o.setAttribute("position",se.t.position),We(o,i,t,a),Ke(o),a.onBeforeRender=function(){return Ze(n,a.matrixWorld)},a.name="Primitives (GeneralRings)",a}(i.generalRingCollection,i.generalRingAttributes,t.generalRing,r);case 32:if(o.t7=Ve(i.quadCollection),!o.t7){o.next=36;break}return o.next=36,function(e,t,n,r){var i=Object(se.n)(e,t,se.u,r),o=new j.InstancedBufferGeometry,a=new j.Mesh(o,n);return o.setIndex(se.t.index),o.setAttribute("position",se.t.position),o.setAttribute("normal",se.t.normal),We(o,i,t,a),Ke(o),a.name="Primitives (Quads)",a}(i.quadCollection,i.quadAttributes,t.quad,r);case 36:if(o.t8=Ve(i.sphericalSegmentCollection),!o.t8){o.next=40;break}return o.next=40,function(e,t,n,r,i){var o=Object(se.p)(e,t,i,"radius","radius"),a=new j.InstancedBufferGeometry,s=new j.Mesh(a,n);return a.setIndex(se.k.index),a.setAttribute("position",se.k.position),We(a,o,t,s),qe(a,r),a.setAttribute("a_horizontalRadius",a.getAttribute("a_radius")),a.setAttribute("a_verticalRadius",a.getAttribute("a_radius")),s.onBeforeRender=function(){return Ze(n,s.matrixWorld)},s.name="Primitives (EllipsoidSegments)",s}(i.sphericalSegmentCollection,i.sphericalSegmentAttributes,t.sphericalSegment,n,r);case 40:if(o.t9=Ve(i.torusSegmentCollection),!o.t9){o.next=44;break}return o.next=44,function(e,t,n,r){var i=function(e,t){for(var n=Array.from(t.values()).reduce((function(e,t){return e+t.size}),0),r=e.length/n,i=0,o=new DataView(e.buffer),a=t.get("size").offset,s=0;s<r;s++)i=Math.max(i,o.getFloat32(s*n+a,!0));return i}(e,t),o=new T.b(new j.Box3);o.name="Primitives (TorusSegments)";var a,s=null,u=null,c=f(se.v.entries());try{var l=function(){var r=h(a.value,2),c=r[0],l=r[1],d=new j.InstancedBufferGeometry,f=new j.Mesh(d,n);if(d.setIndex(l.index),d.setAttribute("position",l.position),We(d,e,t,f),null===s){var p=Xe(d);s=p.boundingBox,u=p.boundingSphere,o.setBoundingBox(s)}d.boundingBox=s,d.boundingSphere=u,f.name="Primitives (TorusSegments) - LOD "+c,o.addLevel(f,He(i,c)),f.onBeforeRender=function(){return Ze(n,f.matrixWorld)}};for(c.s();!(a=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}return o}(i.torusSegmentCollection,i.torusSegmentAttributes,t.torusSegment);case 44:if(o.t10=Ve(i.trapeziumCollection),!o.t10){o.next=48;break}return o.next=48,function(e,t,n,r){var i=Object(se.q)(e,t,r),o=new j.InstancedBufferGeometry,a=new j.Mesh(o,n);return o.setIndex(se.w.index),o.setAttribute("position",se.w.position),We(o,i,t,a),function(e){var t=Je.bbox,n=Je.p;t.makeEmpty();var r=e.getAttribute("a_vertex1"),i=e.getAttribute("a_vertex2"),o=e.getAttribute("a_vertex3"),a=e.getAttribute("a_vertex4");S()(void 0!==r&&void 0!==i&&void 0!==o&&void 0!==a);for(var s=0;s<r.count;++s)n.set(r.getX(s),r.getY(s),r.getZ(s)),t.expandByPoint(n),n.set(i.getX(s),i.getY(s),i.getZ(s)),t.expandByPoint(n),n.set(o.getX(s),o.getY(s),o.getZ(s)),t.expandByPoint(n),n.set(a.getX(s),a.getY(s),a.getZ(s)),t.expandByPoint(n);e.boundingBox=t,e.boundingSphere=e.boundingSphere||new j.Sphere,e.boundingBox.getBoundingSphere(e.boundingSphere)}(o),a.onBeforeRender=function(){return Ze(n,a.matrixWorld)},a.name="Primitives (Trapeziums)",a}(i.trapeziumCollection,i.trapeziumAttributes,t.trapezium,r);case 48:if(o.t11=Ve(i.nutCollection),!o.t11){o.next=52;break}return o.next=52,function(e,t,n,r){var i=Object(se.n)(e,t,se.s,r),o=new j.InstancedBufferGeometry,a=new j.Mesh(o,n);return o.setIndex(se.r.index),o.setAttribute("position",se.r.position),o.setAttribute("normal",se.r.normal),We(o,i,t,a),Ke(o),a.name="Primitives (Nuts)",a}(i.nutCollection,i.nutAttributes,t.nut,r);case 52:case"end":return o.stop()}}),o)}function Ve(e){return e.length>0}function We(e,t,n,r){var i=Array.from(n.values()).reduce((function(e,t){return e+t.size}),0);!function(e){var t=e.get("instanceMatrix");if(t){for(var n=t.size/4,r=0;r<4;r++){var i={size:n,offset:t.offset+n*r};e.set("instanceMatrix_column_"+r,i)}e.delete("instanceMatrix")}}(n);var o,a=new j.InstancedInterleavedBuffer(t,i),s=new j.InstancedInterleavedBuffer(new Float32Array(t.buffer),i/4),u=f(n);try{for(u.s();!(o=u.n()).done;){var c=h(o.value,2),l=c[0],d=c[1],p="color"===l,v=p?a:s,m=p?d.size:d.size/4,y=p?d.offset:d.offset/4;e.setAttribute("a_"+l,new j.InterleavedBufferAttribute(v,m,y,p))}}catch(e){u.e(e)}finally{u.f()}r.onAfterRender=function(){T.n.bind(s)(),T.n.bind(a)(),r.onAfterRender=function(){}},e.instanceCount=t.length/i,function(){for(var o=new DataView(t.buffer),a=n.get("treeIndex").offset,s=new Set,u=0;u<e.instanceCount;u++)s.add(o.getFloat32(u*i+a,!0));r.userData.treeIndices=s}()}function He(e,t){return 0===t?0:e*Math.pow(5,t)}function Ze(e,t){e.uniforms.inverseModelMatrix.value.copy(t).invert()}function qe(e,t){e.boundingSphere=e.boundingSphere||new j.Sphere,t.getBoundingSphere(e.boundingSphere)}var Ye={baseBoundingBox:new j.Box3,instanceBoundingBox:new j.Box3,instanceMatrix:new j.Matrix4,p:new j.Vector3};function Xe(e){var t=Ye.baseBoundingBox,n=Ye.instanceBoundingBox,r=Ye.instanceMatrix,i=Ye.p;t.makeEmpty();for(var o=new j.Box3,a=e.getAttribute("position"),s=0;s<a.count;++s)i.set(a.getX(s),a.getY(s),a.getZ(s)),t.expandByPoint(i);var u=e.getAttribute("a_instanceMatrix_column_0"),c=e.getAttribute("a_instanceMatrix_column_1"),l=e.getAttribute("a_instanceMatrix_column_2"),d=e.getAttribute("a_instanceMatrix_column_3");S()(void 0!==u&&void 0!==c&&void 0!==l&&void 0!==d);for(var f=0;f<u.count;++f)r.set(u.getX(f),c.getX(f),l.getX(f),d.getX(f),u.getY(f),c.getY(f),l.getY(f),d.getY(f),u.getZ(f),c.getZ(f),l.getZ(f),d.getZ(f),u.getW(f),c.getW(f),l.getW(f),d.getW(f)),n.copy(t).applyMatrix4(r),o.expandByPoint(n.min),o.expandByPoint(n.max);return{boundingBox:o,boundingSphere:o.getBoundingSphere(new j.Sphere)}}function Ke(e){var t=Xe(e),n=t.boundingBox,r=t.boundingSphere;e.boundingBox=n,e.boundingSphere=r}var Je={bbox:new j.Box3,p:new j.Vector3};var Qe=function(){function e(t){v(this,e),this.materialManager=t}return m(e,[{key:"transformSimpleSector",value:function(e,t,n,r){var i=this.materialManager.getModelMaterials(e);return S()(void 0!==i,"Could not find materials for model '"+e),Promise.resolve(function(e,t,n,r){var i=new T.a;if(i.name="Quads",0===e.buffer.byteLength)return{sectorMeshes:new T.a,instancedMeshes:[]};var o=function(e,t,n,r){var i=new Uint8Array(e.buffer),o=Object(se.n)(i,Ue,ze,r);if(0!==o.byteLength){var a=new Float32Array(o.buffer);if(o.byteLength%23!=0)throw new Error("Expected buffer size to be multiple of 23, but got "+a.byteLength);var s=new j.InstancedBufferGeometry,u=new j.InstancedInterleavedBuffer(a,23),c=new j.InterleavedBufferAttribute(u,3,0,!0),l=new j.InterleavedBufferAttribute(u,1,3,!1),d=new j.InterleavedBufferAttribute(u,3,4,!0),f=new j.InterleavedBufferAttribute(u,4,7,!1),p=new j.InterleavedBufferAttribute(u,4,11,!1),h=new j.InterleavedBufferAttribute(u,4,15,!1),v=new j.InterleavedBufferAttribute(u,4,19,!1);s.setAttribute("position",je),s.setAttribute("color",c),s.setAttribute("treeIndex",l),s.setAttribute("normal",d),s.setAttribute("matrix0",f),s.setAttribute("matrix1",p),s.setAttribute("matrix2",h),s.setAttribute("matrix3",v);var m=new j.Mesh(s,t.simple);return m.name="Low detail geometry",m.onAfterRender=function(){T.n.bind(u)(),m.onAfterRender=function(){}},m.onBeforeRender=function(){t.simple.uniforms.inverseModelMatrix.value.copy(m.matrixWorld).invert()},function(){for(var t=new Set,n=0;n<e.length/23;n++)t.add(e[23*n+3]);m.userData.treeIndices=t}(),m.geometry.boundingSphere=new j.Sphere,n.getBoundingSphere(m.geometry.boundingSphere),m}}(e.buffer,n,t,r);return void 0!==o&&i.add(o),{sectorMeshes:i,instancedMeshes:[]}}(n,t.bounds,i,r))}},{key:"transformDetailedSector",value:function(e,t,n,r){var i=this.materialManager.getModelMaterials(e);return S()(void 0!==i,"Could not find materials for model '"+e),Promise.resolve(function(e,t,n,r){var i=t.bounds;null!==r&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4,r=e,i=t;return r.min.x-i.min.x>=n&&i.max.x-r.max.x>=n&&r.min.y-i.min.y>=n&&i.max.y-r.max.y>=n&&r.min.z-i.min.z>=n&&i.max.z-r.max.z>=n}(r,i)&&(r=null);var o,a=new T.a,s=f(Ge(e,n,i,r));try{for(s.s();!(o=s.n()).done;){var u=o.value;a.add(u)}}catch(e){s.e(e)}finally{s.f()}var c,l=Object(se.l)(e.triangleMeshes,i,n.triangleMesh,r),d=f(l);try{for(d.s();!(c=d.n()).done;){var p=c.value;a.add(p)}}catch(e){d.e(e)}finally{d.f()}return{sectorMeshes:a,instancedMeshes:e.instanceMeshes.map((function(e){var t=e.instances.map((function(t){return Object(se.m)(e.vertices,e.indices,t,r)})).filter((function(e){return e.treeIndices.length>0}));return{fileId:e.fileId,vertices:e.vertices,indices:e.indices,instances:t}})).filter((function(e){return e.instances.length>0}))}}(n,t,i,r))}}]),e}();function $e(e){var t,n,r,i,o,a,s;return p.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:for(t=new Array(e.length),n=0;n<e.length;++n)t[n]={fileId:e[n],index:n};t.sort((function(e,t){return e.fileId-t.fileId})),r=0;case 4:if(!(r<t.length)){u.next=12;break}for(i=t[r].fileId,o=et(t,i,r,(function(e){return e.fileId})),a=new Array(o+1-r),s=r;s<o+1;s++)a[s-r]=t[s].index;return u.next=9,{id:i,meshIndices:a};case 9:r=o+1;case 10:u.next=4;break;case 12:case"end":return u.stop()}}),x)}function et(e,t,n,r){for(var i=n,o=e.length-1,a=e.length;i<=o;){var s=Math.floor((i+o)/2),u=r(e[s]);u>t?o=s-1:(u<t||(a=s),i=s+1)}return a}function tt(e){var t=new Array(e.length);return e.forEach((function(n,r){t[r]=r>0?t[r-1]+e[r-1]:0})),t}var nt=function(){function e(t,n,r){v(this,e),this._modelSectorProvider=t,this._modelDataParser=n,this._modelDataTransformer=r,this._consumedSectorCache=new T.g(50,(function(e){void 0!==e.group&&e.group.dereference()})),this._ctmFileCache=new T.h(10)}return m(e,[{key:"clear",value:function(){this._consumedSectorCache.clear(),this._ctmFileCache.clear()}},{key:"loadSector",value:(a=u(p.mark((function e(t){var n,r,i,o,a;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.wantedSectorCacheKey(t),e.prev=1,!this._consumedSectorCache.has(i)){e.next=4;break}return e.abrupt("return",this._consumedSectorCache.get(i));case 4:e.t0=t.levelOfDetail,e.next=e.t0===se.d.Detailed?7:e.t0===se.d.Simple?11:e.t0===se.d.Discarded?15:16;break;case 7:return e.next=9,this.loadDetailedSectorFromNetwork(t);case 9:return o=e.sent,e.abrupt("return",(this._consumedSectorCache.forceInsert(i,o),null===(n=null==o?void 0:o.group)||void 0===n||n.reference(),o));case 11:return e.next=13,this.loadSimpleSectorFromNetwork(t);case 13:return a=e.sent,e.abrupt("return",(this._consumedSectorCache.forceInsert(i,a),null===(r=null==a?void 0:a.group)||void 0===r||r.reference(),a));case 15:return e.abrupt("return",{modelIdentifier:t.modelIdentifier,metadata:t.metadata,levelOfDetail:t.levelOfDetail,instancedMeshes:[],group:void 0});case 16:Object(T.l)(t.levelOfDetail);case 17:e.next=22;break;case 19:throw e.prev=19,e.t1=e.catch(1),this._consumedSectorCache.remove(i),q.a.trackError(e.t1,{methodName:"loadSector",moduleName:"CachedRepository"}),e.t1;case 22:case"end":return e.stop()}}),e,this,[[1,19]])}))),function(e){return a.apply(this,arguments)})},{key:"loadSimpleSectorFromNetwork",value:(o=u(p.mark((function e(t){var n,r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._modelSectorProvider.getBinaryFile(t.modelBaseUrl,t.metadata.facesFile.fileName);case 2:return n=e.sent,e.next=5,this._modelDataParser.parseF3D(new Uint8Array(n));case 5:return r=e.sent,e.next=8,this._modelDataTransformer.transformSimpleSector(t.modelIdentifier,t.metadata,r,t.geometryClipBox);case 8:return i=e.sent,e.abrupt("return",c(c({},t),{},{group:i.sectorMeshes,instancedMeshes:i.instancedMeshes}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadI3DFromNetwork",value:(i=u(p.mark((function e(t,n){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._modelSectorProvider.getBinaryFile(t,n);case 2:return r=e.sent,e.abrupt("return",this._modelDataParser.parseI3D(new Uint8Array(r)));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"loadCtmsFromNetwork",value:(r=u(p.mark((function e(t,n){var r,i=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return i.loadCtmFileFromNetwork(t,e)})));case 2:return r=e.sent,e.abrupt("return",n.reduce((function(e,t,n){return e.set(t,r[n])}),new Map));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"loadDetailedSectorFromNetwork",value:(n=u(p.mark((function e(t){var n,r,i,o,a,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.metadata.indexFile,r=this.loadI3DFromNetwork(t.modelBaseUrl,n.fileName),i=this.loadCtmsFromNetwork(t.modelBaseUrl,n.peripheralFiles),e.next=5,r;case 5:return o=e.sent,e.next=8,i;case 8:return a=e.sent,s=this.finalizeDetailed(o,a),e.next=12,this._modelDataTransformer.transformDetailedSector(t.modelIdentifier,t.metadata,s,t.geometryClipBox);case 12:return u=e.sent,e.abrupt("return",c(c({},t),{},{group:u.sectorMeshes,instancedMeshes:u.instancedMeshes}));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"loadCtmFileFromNetwork",value:(t=u(p.mark((function e(t,n){var r,i,o,a=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.ctmFileCacheKey(t,n),void 0===(i=this._ctmFileCache.get(r))){e.next=3;break}return e.abrupt("return",i);case 3:return o=this._modelSectorProvider.getBinaryFile(t,n).then((function(e){return a._modelDataParser.parseCTM(new Uint8Array(e))})),e.abrupt("return",(this._ctmFileCache.set(r,o),o));case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"finalizeDetailed",value:function(e,t){var n=e.instanceMeshes,r=e.triangleMeshes,i=function(){var e,n=r.fileIds,i=r.colors,o=r.triangleCounts,a=r.treeIndices,s=[],u=f($e(n));try{for(u.s();!(e=u.n()).done;){for(var c=e.value,l=c.id,d=c.meshIndices,p=d.map((function(e){return o[e]})),h=tt(p),v="mesh_".concat(l,".ctm"),m=t.get(v),y=m.indices,g=m.vertices,b=m.normals,x=new Uint8Array(3*y.length),_=new Float32Array(y.length),w=0;w<d.length;w++)for(var M=d[w],S=a[M],T=h[w],E=p[w],k=[i[4*M+0],i[4*M+1],i[4*M+2]],A=k[0],P=k[1],C=k[2],O=T;O<T+E;O++)for(var I=0;I<3;I++){var R=y[3*O+I];_[R]=S,x[3*R]=A,x[3*R+1]=P,x[3*R+2]=C}var N={colors:x,fileId:l,treeIndices:_,indices:y,vertices:g,normals:b};s.push(N)}}catch(e){u.e(e)}finally{u.f()}return s}(),o=function(){var e,r=n.fileIds,i=n.colors,o=n.treeIndices,a=n.triangleCounts,s=n.triangleOffsets,u=n.instanceMatrices,c=[],l=f($e(r));try{for(l.s();!(e=l.n()).done;){var d,p=e.value,h=p.id,v=p.meshIndices,m="mesh_".concat(h,".ctm"),y=t.get(m),g=y.indices,b=y.vertices,x=[],_=new Float64Array(v.map((function(e){return s[e]}))),w=new Float64Array(v.map((function(e){return a[e]}))),M=f($e(_));try{for(M.s();!(d=M.n()).done;){for(var S=d.value,T=S.id,E=S.meshIndices,k=w[E[0]],A=new Float32Array(16*E.length),P=new Float32Array(E.length),C=new Uint8Array(4*E.length),O=0;O<E.length;O++){var I=v[E[O]],R=o[I],N=u.subarray(16*I,16*I+16);A.set(N,16*O),P[O]=R;var D=i.subarray(4*I,4*I+4);C.set(D,4*O)}x.push({triangleCount:k,triangleOffset:T,instanceMatrices:A,colors:C,treeIndices:P})}}catch(e){M.e(e)}finally{M.f()}var L={fileId:h,indices:g,vertices:b,instances:x};c.push(L)}}catch(e){l.e(e)}finally{l.f()}return c}();return{treeIndexToNodeIdMap:e.treeIndexToNodeIdMap,nodeIdToTreeIndexMap:e.nodeIdToTreeIndexMap,primitives:e.primitives,instanceMeshes:o,triangleMeshes:i}}},{key:"wantedSectorCacheKey",value:function(e){return e.modelIdentifier+"."+e.metadata.id+"."+e.levelOfDetail}},{key:"ctmFileCacheKey",value:function(e,t){return e+"."+t}}]),e;var t,n,r,i,o,a}();function rt(e){return Object(W.pipe)(Object(re.switchMap)((function(t){return function(e){return Object(W.of)(!1).pipe(Object(re.delay)(e),Object(re.startWith)(!0))}(e)})),Object(re.distinctUntilChanged)())}function it(e){var t=e.cadModelsMetadata,n=e.loadingHints;return t.length>0&&!0!==n.suspendLoading}var ot=n(30),at=n.n(ot),st=function(){function e(){v(this,e)}return m(e,null,[{key:"raceUntilAllCompleted",value:function(e){return b(p.mark((function t(){var n,r,i,o;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Map(e.map((function(e){return[e,e.then((function(){return[e]}))]})));case 1:if(!(n.size>0)){t.next=12;break}return t.next=4,g(Promise.race(n.values()));case 4:return r=t.sent,i=h(r,1),o=i[0],n.delete(o),t.next=10,o;case 10:t.next=1;break;case 12:case"end":return t.stop()}}),t)})))()}}]),e}(),ut=n(10),ct=function(){function e(t,n,r,i,o){v(this,e),this._sectorRepository=t,this._sectorCuller=n,this._modelStateHandler=r,this._collectStatisticsCallback=i,this._progressCallback=o}return m(e,[{key:"loadSectors",value:function(e){var t=this;return b(p.mark((function n(){var r,i,o,a,s,u,c,l,d,h,v,m,b,x,_;return p.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.cameraInMotion){n.next=2;break}return n.abrupt("return",[]);case 2:r=t._sectorCuller.determineSectors(e),t._collectStatisticsCallback(r.spentBudget),i=t._modelStateHandler.hasStateChanged.bind(t._modelStateHandler),o=r.wantedSectors.filter(i),(a=new lt(t._progressCallback)).start(o.length),s=f(at()(o,20)),n.prev=7,s.s();case 9:if((u=s.n()).done){n.next=47;break}return c=u.value,n.next=13,g(t.filterSectors(e,c,a));case 13:l=n.sent,d=t.startLoadingBatch(l,a),h=!1,v=!1,n.prev=17,b=y(st.raceUntilAllCompleted(d));case 19:return n.next=21,g(b.next());case 21:if(!(h=!(x=n.sent).done)){n.next=29;break}return _=x.value,t._modelStateHandler.updateState(_),n.next=26,_;case 26:h=!1,n.next=19;break;case 29:n.next=35;break;case 31:n.prev=31,n.t0=n.catch(17),v=!0,m=n.t0;case 35:if(n.prev=35,n.prev=36,!h||null==b.return){n.next=40;break}return n.next=40,g(b.return());case 40:if(n.prev=40,!v){n.next=43;break}throw m;case 43:return n.finish(40);case 44:return n.finish(35);case 45:n.next=9;break;case 47:n.next=52;break;case 49:n.prev=49,n.t1=n.catch(7),s.e(n.t1);case 52:return n.prev=52,s.f(),n.finish(52);case 55:case"end":return n.stop()}}),n,null,[[7,49,52,55],[17,31,35,45],[36,,40,44]])})))()}},{key:"filterSectors",value:(t=u(p.mark((function e(t,n,r){var i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sectorCuller.filterSectorsToLoad(t,n);case 2:return i=e.sent,e.abrupt("return",(r.reportNewSectorsCulled(n.length-i.length),i));case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"startLoadingBatch",value:function(e,t){var n=this;return e.map(function(){var e=u(p.mark((function e(r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n._sectorRepository.loadSector(r);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),ut.a.error("Failed to load sector",r,"error:",e.t0),e.abrupt("return",function(e){return{modelIdentifier:e.modelIdentifier,metadata:e.metadata,levelOfDetail:se.d.Discarded,group:void 0,instancedMeshes:void 0}}(r));case 10:return e.prev=10,t.reportNewSectorsLoaded(1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,6,10,13]])})));return function(t){return e.apply(this,arguments)}}())}}]),e;var t}(),lt=function(){function e(t){v(this,e),this._sectorsScheduled=0,this._sectorsLoaded=0,this._sectorsCulled=0,this._progressCallback=t}return m(e,[{key:"start",value:function(e){this._sectorsScheduled=e,this._sectorsLoaded=0,this._sectorsCulled=0,this.triggerCallback()}},{key:"reportNewSectorsLoaded",value:function(e){this._sectorsLoaded+=e,this.triggerCallback()}},{key:"reportNewSectorsCulled",value:function(e){this._sectorsCulled+=e,this._sectorsLoaded+=e,this.triggerCallback()}},{key:"triggerCallback",value:function(){this._progressCallback(this._sectorsLoaded,this._sectorsScheduled,this._sectorsCulled)}}]),e}(),dt=Object(T.q)()?{highDetailProximityThreshold:5,geometryDownloadSizeBytes:20971520,maximumNumberOfDrawCalls:700,maximumRenderCost:1/0}:{highDetailProximityThreshold:10,geometryDownloadSizeBytes:36700160,maximumNumberOfDrawCalls:2e3,maximumRenderCost:1/0},ft=function(){function e(){v(this,e),this._sceneModelState={}}return m(e,[{key:"hasStateChanged",value:function(e){var t=this._sceneModelState[e.modelIdentifier];S()(void 0!==t,"Model ".concat(e.modelIdentifier," has not been added"));var n=t[e.metadata.id];return void 0!==n?n!==e.levelOfDetail:e.levelOfDetail!==se.d.Discarded}},{key:"addModel",value:function(e){S()(void 0===this._sceneModelState[e],"Model ".concat(e," is already added")),this._sceneModelState[e]={}}},{key:"removeModel",value:function(e){S()(void 0!==this._sceneModelState[e],"Model ".concat(e," is not added")),delete this._sceneModelState[e]}},{key:"updateState",value:function(e){if(void 0!==this._sceneModelState[e.modelIdentifier]){var t=this._sceneModelState[e.modelIdentifier];e.levelOfDetail===se.d.Discarded?delete t[e.metadata.id]:t[e.metadata.id]=e.levelOfDetail}}}]),e}(),pt={isLoading:!1,itemsLoaded:0,itemsRequested:0,itemsCulled:0},ht=function(){function e(t,n){var r=this;v(this,e),this._cameraSubject=new W.Subject,this._clippingPlaneSubject=new W.Subject,this._loadingHintsSubject=new W.Subject,this._modelSubject=new W.Subject,this._budgetSubject=new W.Subject,this._progressSubject=new W.BehaviorSubject(pt),this._sectorRepository=t,this._sectorCuller=n,this._modelStateHandler=new ft,this._budget=dt,this._lastSpent={downloadSize:0,drawCalls:0,renderCost:0,loadedSectorCount:0,simpleSectorCount:0,detailedSectorCount:0,forcedDetailedSectorCount:0,totalSectorCount:0,accumulatedPriority:0};var i=Object(W.combineLatest)([Object(W.combineLatest)([this._loadingHintsSubject.pipe(Object(re.startWith)({})),this._budgetSubject.pipe(Object(re.startWith)(this._budget))]).pipe(Object(re.map)(vt)),Object(W.combineLatest)([this._cameraSubject.pipe(Object(re.auditTime)(500)),this._cameraSubject.pipe(Object(re.auditTime)(250),rt(600))]).pipe(Object(re.map)(mt)),Object(W.combineLatest)([this._clippingPlaneSubject.pipe(Object(re.startWith)([]))]).pipe(Object(re.map)(yt)),this.loadingModelObservable()]),o=new ct(t,n,this._modelStateHandler,(function(e){r._lastSpent=e}),(function(e,t,n){var i={isLoading:t>e,itemsRequested:t,itemsLoaded:e,itemsCulled:n};r._progressSubject.next(i)}));this._updateObservable=i.pipe(Object(re.observeOn)(W.asyncScheduler),Object(re.auditTime)(250),Object(re.map)(gt),Object(re.filter)(it),Object(re.mergeMap)(function(){var e=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",function(){var e=b(p.mark((function e(t){var n,r,i,a,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,r=!1,e.prev=2,a=y(o.loadSectors(t));case 4:return e.next=6,g(a.next());case 6:if(!(n=!(s=e.sent).done)){e.next=13;break}return u=s.value,e.next=10,u;case 10:n=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),r=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==a.return){e.next=24;break}return e.next=24,g(a.return());case 24:if(e.prev=24,!r){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})));return function(t){return e.apply(this,arguments)}}()(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(re.mergeMap)((function(e){return e})),Object(re.finalize)((function(){r._sectorRepository.clear()})))}return m(e,[{key:"dispose",value:function(){this._sectorCuller.dispose()}},{key:"updateCamera",value:function(e){this._cameraSubject.next(e),this._progressSubject.next(pt)}},{key:"clippingPlanes",set:function(e){this._clippingPlaneSubject.next(e)}},{key:"budget",get:function(){return this._budget},set:function(e){this._budget=e,this._budgetSubject.next(e)}},{key:"lastBudgetSpendage",get:function(){return this._lastSpent}},{key:"addModel",value:function(e){this._modelStateHandler.addModel(e.cadModelMetadata.modelIdentifier),this._modelSubject.next({model:e,operation:"add"})}},{key:"removeModel",value:function(e){this._modelStateHandler.removeModel(e.cadModelMetadata.modelIdentifier),this._modelSubject.next({model:e,operation:"remove"})}},{key:"updateLoadingHints",value:function(e){this._loadingHintsSubject.next(e)}},{key:"consumedSectorObservable",value:function(){return this._updateObservable.pipe(Object(re.share)())}},{key:"getLoadingStateObserver",value:function(){return this._progressSubject}},{key:"loadingModelObservable",value:function(){return this._modelSubject.pipe(Object(re.scan)((function(e,t){var n=t.model,r=t.operation;switch(r){case"add":return e.push(n),e;case"remove":return e.filter((function(e){return e.cadModelMetadata.modelIdentifier!==n.cadModelMetadata.modelIdentifier}));default:Object(T.l)(r)}}),[]))}}]),e}();function vt(e){var t=h(e,2);return{loadingHints:t[0],budget:t[1]}}function mt(e){var t=h(e,2);return{camera:t[0],cameraInMotion:t[1]}}function yt(e){return{clippingPlanes:h(e,1)[0]}}function gt(e){var t=h(e,4),n=t[0],r=t[1],i=t[2],o=t[3];return c(c(c(c({},r),n),i),{},{cadModelsMetadata:o.filter((function(e){return e.visible})).map((function(e){return e.cadModelMetadata}))})}var bt=n(5),xt=n.n(bt),_t={defines:{COGNITE_COLOR_BY_TREE_INDEX:!1}},wt={simpleMesh:{fragment:xt()(n(33).default),vertex:xt()(n(34).default)},detailedMesh:{fragment:xt()(n(35).default),vertex:xt()(n(36).default)},instancedMesh:{fragment:xt()(n(37).default),vertex:xt()(n(38).default)},boxPrimitive:{fragment:xt()(n(25).default),vertex:xt()(n(26).default)},circlePrimitive:{fragment:xt()(n(39).default),vertex:xt()(n(40).default)},conePrimitive:{fragment:xt()(n(41).default),vertex:xt()(n(42).default)},eccentricConePrimitive:{fragment:xt()(n(43).default),vertex:xt()(n(44).default)},ellipsoidSegmentPrimitive:{fragment:xt()(n(45).default),vertex:xt()(n(46).default)},generalCylinderPrimitive:{fragment:xt()(n(47).default),vertex:xt()(n(48).default)},generalRingPrimitive:{fragment:xt()(n(49).default),vertex:xt()(n(50).default)},nutPrimitive:{fragment:xt()(n(25).default),vertex:xt()(n(26).default)},quadPrimitive:{fragment:xt()(n(25).default),vertex:xt()(n(26).default)},torusSegmentPrimitive:{fragment:xt()(n(51).default),vertex:xt()(n(52).default)},trapeziumPrimitive:{fragment:xt()(n(53).default),vertex:xt()(n(54).default)}},Mt={fragment:xt()(n(55).default),vertex:xt()(n(56).default)},St={fragment:xt()(n(57).default),vertex:xt()(n(58).default)},Tt={fragment:xt()(n(59).default),vertex:xt()(n(28).default)},Et={fragment:xt()(n(60).default),vertex:xt()(n(28).default)},kt={fragment:xt()(n(61).default),vertex:xt()(n(62).default)},At=new j.Quaternion,Pt=function(){function e(t){v(this,e),this.sectorIdOffset=0,this.scene=new j.Scene,this.containers=new Map,this.buffers={size:new j.Vector2,rtBuffer:new Uint8Array,sectorVisibilityBuffer:[]},this.coverageMaterial=new j.ShaderMaterial({vertexShader:kt.vertex,fragmentShader:kt.fragment,clipping:!0,side:j.DoubleSide}),this._ensureBuffersCorrectSizeVars={size:new j.Vector2},this._renderer=t.renderer,this._alreadyLoadedProvider=t.occludingGeometryProvider,this.renderTarget=new j.WebGLRenderTarget(1,1,{generateMipmaps:!1,type:j.UnsignedByteType,format:j.RGBAFormat,stencilBuffer:!1})}return m(e,[{key:"dispose",value:function(){this._renderer.dispose()}},{key:"renderer",get:function(){return this._renderer}},{key:"createDebugCanvas",value:function(e){if(this._debugImageElement)throw new Error("createDebugCanvas() can only be called once");var t=e?e.width:this.renderTarget.width,n=e?e.height:this.renderTarget.height;return this._debugImageElement=document.createElement("img"),this._debugImageElement.style.width=t+"px",this._debugImageElement.style.height=n+"px",this._debugImageElement}},{key:"setModels",value:function(e){var t,n=new Set,r=f(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.modelIdentifier;n.add(o);var a=this.containers.get(o);a?this.updateModel(a,i):this.addModel(i)}}catch(e){r.e(e)}finally{r.f()}var u,c=new Set(this.containers.keys()),l=new Set(s(c).filter((function(e){return!n.has(e)}))),d=f(l);try{for(d.s();!(u=d.n()).done;){var p=u.value;this.removeModel(p)}}catch(e){d.e(e)}finally{d.f()}}},{key:"setClipping",value:function(e){this.coverageMaterial.clippingPlanes=e}},{key:"cullOccludedSectors",value:function(e,t){var n=this;try{this.setAllSectorsVisible(!1),this.setSectorsVisibility(t,!0);var r=this.orderSectorsByVisibility(e);return t.filter((function(t){var i=n.containers.get(t.modelIdentifier);if(void 0===i)throw new Error("Model ".concat(t.modelIdentifier," is not registered"));var o=function(e,t,n){var r=Ct.sectorBounds;return r.copy(t.bounds),r.applyMatrix4(e.modelMatrix),r.containsPoint(n)}(i.model,t.metadata,e.position);return r.some((function(e){return e.model.modelIdentifier===t.modelIdentifier&&e.sectorId===t.metadata.id}))||o}))}finally{this.setAllSectorsVisible(!0)}}},{key:"orderSectorsByVisibility",value:function(e){var t=this;this._debugImageElement&&(this.renderSectors(null,e),this._debugImageElement.src=this._renderer.domElement.toDataURL()),this.ensureBuffersCorrectSize(),this.renderSectors(this.renderTarget,e),this._renderer.readRenderTargetPixels(this.renderTarget,0,0,this.renderTarget.width,this.renderTarget.height,this.buffers.rtBuffer);var n=this.unpackSectorVisibility(this.renderTarget.width,this.renderTarget.height,this.buffers.rtBuffer),r=n.reduce((function(e,t){return t.weight+e}),0);return n.filter((function(e){return e.weight>0})).sort((function(e,t){return e&&t?t.weight-e.weight:e?-1:t?1:0})).map((function(e){var n=t.findSectorContainer(e.sectorIdWithOffset),i=e.sectorIdWithOffset-n.sectorIdOffset;return{model:n.model,sectorId:i,priority:e.weight/r,depth:e.distance}}))}},{key:"ensureBuffersCorrectSize",value:function(){var t=this._ensureBuffersCorrectSizeVars.size;if(this._renderer.getSize(t),!this.buffers.size.equals(t)){var n=Math.max(Math.floor(t.width*e.CoverageRenderTargetScalingFactor),64),r=Math.max(Math.floor(t.height*e.CoverageRenderTargetScalingFactor),64);this.renderTarget.setSize(n,r),this.buffers.rtBuffer.length<4*n*r&&(this.buffers.rtBuffer=new Uint8Array(4*n*r)),this.buffers.size.copy(t)}}},{key:"renderSectors",value:function(e,t){var n=new T.j(this._renderer);try{n.localClippingEnabled=!0,n.setRenderTarget(e),n.setClearColor("#FFFFFF",1),n.autoClear=!1,n.setSize(this.buffers.size.width,this.buffers.size.height),this._renderer.clear(!0,!0),this._alreadyLoadedProvider.renderOccludingGeometry(e,t),this._renderer.render(this.scene,t)}finally{n.resetState()}}},{key:"setAllSectorsVisible",value:function(e){var t=e?1:0;this.containers.forEach((function(e){for(var n=0;n<e.sectors.length;++n){var r=e.sectors[n].id,i=e.sectorIndexById[r];e.attributesValues[5*i+4]=t}e.attributesBuffer.needsUpdate=!0}))}},{key:"setSectorsVisibility",value:function(e,t){var n=this,r=t?1:0;e.forEach((function(e){var t=e.metadata.id,i=n.containers.get(e.modelIdentifier);if(void 0===i)throw new Error("Sector ".concat(e," is from a model not added"));var o=i.sectorIndexById[t];i.attributesValues[5*o+4]=r,i.attributesBuffer.needsUpdate=!0}))}},{key:"removeModel",value:function(e){var t=this.containers.get(e);if(!t)throw new Error("Could not find model '".concat(e,"'"));t.mesh.geometry.dispose(),this.deleteSectorsFromBuffers(t.sectorIdOffset,t.lastSectorIdWithOffset),this.scene.remove(t.renderable),this.containers.delete(e)}},{key:"deleteSectorsFromBuffers",value:function(e,t){for(var n=this.buffers.sectorVisibilityBuffer,r=e;r<=t;++r)n[r]={sectorIdWithOffset:-1,weight:-1,distance:1/0}}},{key:"addModel",value:function(e){var t=e.scene.getAllSectors(),n=this.createSectorTreeGeometry(this.sectorIdOffset,t),r=h(n,3),i=r[0],o=r[1],a=r[2],s=new j.Group;s.matrixAutoUpdate=!1,s.applyMatrix4(e.modelMatrix),s.updateMatrixWorld(),s.add(i);var u=t.reduce((function(e,t){return Math.max(t.id,e)}),0),c=new Array(u);t.forEach((function(e,t){return c[e.id]=t})),this.containers.set(e.modelIdentifier,{model:e,sectors:t,sectorIndexById:c,sectorIdOffset:this.sectorIdOffset,lastSectorIdWithOffset:this.sectorIdOffset+u,renderable:s,mesh:i,attributesBuffer:o,attributesValues:a}),this.sectorIdOffset+=u+1,this.scene.add(s)}},{key:"updateModel",value:function(e,t){e.renderable.matrix.copy(t.modelMatrix),e.renderable.updateMatrixWorld(!0)}},{key:"findSectorContainer",value:function(e){var t,n=f(this.containers.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e>=r.sectorIdOffset&&e<=r.lastSectorIdWithOffset)return r}}catch(e){n.e(e)}finally{n.f()}throw new Error("Sector ID ".concat(e," is out of range"))}},{key:"unpackSectorVisibility",value:function(e,t,n){function r(e,t){var n=e*e+t*t;return.5*(2.5-n)+Math.exp(-Math.sqrt(n))}var i=this.buffers.sectorVisibilityBuffer;!function(e){for(var t=0;t<e.length;t++){var n=e[t];n&&(n.weight=0)}}(i);for(var o=t/2,a=e/2,s=0;s<t;s++)for(var u=(s-t/2)/o,c=0;c<e;c++){var l=c+e*s,d=n[4*l+0],f=n[4*l+1],p=n[4*l+2],h=n[4*l+3];if(255!==d||255!==f||255!==p){var v=(s-a)/a,m=p+255*f+255*d*255,y=i[m]||{sectorIdWithOffset:m,weight:0,distance:h};y.weight+=r(v,u),y.distance=Math.min(y.distance,h),i[m]=y}}return i}},{key:"createSectorTreeGeometry",value:function(e,t){var n=new j.Vector3,r=new j.Vector3,i=t.length,o=new Float32Array(5*i),a=new j.BoxBufferGeometry,s=new j.InstancedMesh(a,this.coverageMaterial,i),u=new j.Vector3;t.forEach((function(t,i){var a=t.facesFile.coverageFactors,c=a.xy,l=a.xz,d=a.yz;u.set(d,l,c),function(t,i,a,u){t.getCenter(n),t.getSize(r);var c=(new j.Matrix4).compose(n,At,r);s.setMatrixAt(i,c),o[5*i+0]=e+a,o[5*i+1]=u.x,o[5*i+2]=u.y,o[5*i+3]=u.z,o[5*i+4]=1}(t.bounds,i,t.id,u)}));var c=new j.InstancedInterleavedBuffer(o,5);return a.setAttribute("a_sectorId",new j.InterleavedBufferAttribute(c,1,0)),a.setAttribute("a_coverageFactor",new j.InterleavedBufferAttribute(c,3,1)),a.setAttribute("a_visible",new j.InterleavedBufferAttribute(c,1,4)),[s,c,o]}}]),e}();Pt.CoverageRenderTargetScalingFactor=.5;var Ct={sectorBounds:new j.Box3};function Ot(e,t){e.downloadSize+=t.downloadSize,e.drawCalls+=t.drawCalls,e.renderCost+=t.renderCost}var It=function(){function e(t,n){var r=this;v(this,e),this.sectors=[],this._totalCost={downloadSize:0,drawCalls:0,renderCost:0},this.determineSectorCost=n,Object(T.u)(t,(function(e){return r.sectors.length=Math.max(r.sectors.length,e.id),r.sectors[e.id]={sector:e,parentIndex:-1,priority:-1,cost:{downloadSize:0,drawCalls:0,renderCost:0},lod:se.d.Discarded},!0}));for(var i=0;i<this.sectors.length;++i){var o=this.sectors[i];if(void 0!==o){var a,s=o.sector.children.map((function(e){return e.id})),u=f(s);try{for(u.s();!(a=u.n()).done;){var c=a.value;this.sectors[c].parentIndex=i}}catch(e){u.e(e)}finally{u.f()}}}t.facesFile.fileName&&this.setSectorLod(t.id,se.d.Simple)}return m(e,[{key:"totalCost",get:function(){return this._totalCost}},{key:"determineWantedSectorCount",value:function(){return this.sectors.reduce((function(e,t){return t.lod!==se.d.Discarded?e+1:e}),0)}},{key:"toWantedSectors",value:function(e,t,n){return this.sectors.filter((function(e){return void 0!==e})).map((function(r){return{modelIdentifier:e,modelBaseUrl:t,levelOfDetail:r.lod,metadata:r.sector,priority:r.priority,geometryClipBox:n}})).sort((function(e,t){return t.priority-e.priority}))}},{key:"markSectorDetailed",value:function(e,t){if(this.setSectorPriority(e,t),this.sectors[e].lod!==se.d.Detailed){for(var n=this.sectors[e];;){switch(n.lod){case se.d.Simple:this.replaceSimpleWithDetailed(n.sector.id);break;case se.d.Discarded:this.setSectorLod(n.sector.id,se.d.Detailed)}if(-1===n.parentIndex)break;n=this.sectors[n.parentIndex]}this.markAllDiscardedChildrenAsSimple(e)}}},{key:"replaceSimpleWithDetailed",value:function(e){Rt(this.sectors[e].lod===se.d.Simple,"Sector ".concat(e," must be a Simple-sector, but got ").concat(this.sectors[e].lod)),this.setSectorLod(e,se.d.Detailed),this.markAllDiscardedChildrenAsSimple(e)}},{key:"markAllDiscardedChildrenAsSimple",value:function(e){var t,n=f(this.sectors[e].sector.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.getSectorLod(r.id)===se.d.Discarded&&null!==r.facesFile.fileName&&this.setSectorLod(r.id,se.d.Simple)}}catch(e){n.e(e)}finally{n.f()}}},{key:"setSectorLod",value:function(e,t){var n,r;Rt(t!==se.d.Simple||null!==this.sectors[e].sector.facesFile.fileName),this.sectors[e].lod=t,n=this._totalCost,r=this.sectors[e].cost,n.downloadSize-=r.downloadSize,n.drawCalls-=r.drawCalls,n.renderCost-=r.renderCost,this.sectors[e].cost=this.determineSectorCost(this.sectors[e].sector,t),Ot(this._totalCost,this.sectors[e].cost)}},{key:"setSectorPriority",value:function(e,t){this.sectors[e].priority=t}},{key:"getSectorLod",value:function(e){return this.sectors[e].lod}}]),e}();function Rt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"assertion hit";e||ut.a.error("[ASSERT]",t)}var Nt,Dt,Lt,Bt,Ft,jt,zt,Ut=function(){function e(t){v(this,e),this._takenSectorTrees=new Map,this.determineSectorCost=t}return m(e,[{key:"totalCost",get:function(){var e={downloadSize:0,drawCalls:0,renderCost:0};return this._takenSectorTrees.forEach((function(t){var n=t.sectorTree;Ot(e,n.totalCost)})),e}},{key:"initializeScene",value:function(e){this._takenSectorTrees.set(e.modelIdentifier,{sectorTree:new It(e.scene.root,this.determineSectorCost),modelMetadata:e})}},{key:"getWantedSectorCount",value:function(){var e=0;return this._takenSectorTrees.forEach((function(t){var n=t.sectorTree;e+=n.determineWantedSectorCount()})),e}},{key:"markSectorDetailed",value:function(e,t,n){var r=this._takenSectorTrees.get(e.modelIdentifier);!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"assertion hit";console.assert(e,t)}(!!r,"Could not find sector tree for ".concat(e.modelIdentifier," (have trees ").concat(Array.from(this._takenSectorTrees.keys()).join(", "),")")),r.sectorTree.markSectorDetailed(t,n)}},{key:"isWithinBudget",value:function(e){return this.totalCost.downloadSize<e.geometryDownloadSizeBytes&&this.totalCost.drawCalls<e.maximumNumberOfDrawCalls&&this.totalCost.renderCost<e.maximumRenderCost}},{key:"collectWantedSectors",value:function(){var e,t=new Array,n=f(this._takenSectorTrees);try{for(n.s();!(e=n.n()).done;){var r=h(e.value,2),i=r[0],o=r[1],a=o.sectorTree,u=o.modelMetadata;t.push.apply(t,s(a.toWantedSectors(i,u.modelBaseUrl,u.geometryClipBox)))}}catch(e){n.e(e)}finally{n.f()}return t.sort((function(e,t){return t.priority-e.priority})),t}},{key:"clear",value:function(){this._takenSectorTrees.clear()}}]),e}(),Gt=function(){function e(t){v(this,e),this.options={renderer:t.renderer,determineSectorCost:t&&t.determineSectorCost?t.determineSectorCost:Vt,logCallback:t&&t.logCallback?t.logCallback:function(){},coverageUtil:t.coverageUtil},this.takenSectors=new Ut(this.options.determineSectorCost)}return m(e,[{key:"dispose",value:function(){this.options.coverageUtil.dispose()}},{key:"determineSectors",value:function(e){var t=this.update(e.camera,e.cadModelsMetadata,e.clippingPlanes,e.budget),n=t.collectWantedSectors(),r=n.filter((function(e){return e.levelOfDetail!==se.d.Discarded})),i=e.cadModelsMetadata.reduce((function(e,t){return e+t.scene.sectorCount}),0),o=r.length,a=r.filter((function(e){return e.levelOfDetail===se.d.Simple})).length,s=r.filter((function(e){return!Number.isFinite(e.priority)})).length,u=r.filter((function(e){return Number.isFinite(e.priority)&&e.priority>0})).reduce((function(e,t){return e+t.priority}),0),c=(100*(o-a)/i).toPrecision(3),l=(100*o/i).toPrecision(3);return this.log("Scene: ".concat(o," (").concat(s," required, ").concat(i," sectors, ").concat(l,"% of all sectors - ").concat(c,"% detailed)")),{spentBudget:{drawCalls:t.totalCost.drawCalls,downloadSize:t.totalCost.downloadSize,renderCost:t.totalCost.renderCost,totalSectorCount:i,forcedDetailedSectorCount:s,loadedSectorCount:o,simpleSectorCount:a,detailedSectorCount:o-a,accumulatedPriority:u},wantedSectors:n}}},{key:"filterSectorsToLoad",value:function(e,t){var n=this.options.coverageUtil.cullOccludedSectors(e.camera,t);return Promise.resolve(n)}},{key:"update",value:function(e,t,n,r){var i=this.options.coverageUtil,o=this.takenSectors;o.clear(),t.forEach((function(e){return o.initializeScene(e)})),i.setModels(t),i.setClipping(n);var a=i.orderSectorsByVisibility(e);this.addHighDetailsForNearSectors(e,t,r,o,n);var s=0,u=a.length,c=0;for(c=0;c<u&&o.isWithinBudget(r);c++){var l=a[c];o.markSectorDetailed(l.model,l.sectorId,l.priority),s+=l.priority}return this.log("Retrieving ".concat(c," of ").concat(u," (last: ").concat(a.length>0?a[c-1]:null,")")),this.log("Total scheduled: ".concat(o.getWantedSectorCount()," of ").concat(u," (cost: ").concat(o.totalCost.downloadSize/1024/1024,"/").concat(r.geometryDownloadSizeBytes/1024/1024,", drawCalls: ").concat(o.totalCost.drawCalls,"/").concat(r.maximumNumberOfDrawCalls,", priority: ").concat(s,")")),o}},{key:"addHighDetailsForNearSectors",value:function(e,t,n,r,i){var o=this,a=e.clone(!0);a.far=n.highDetailProximityThreshold,a.updateProjectionMatrix();var s=a.matrixWorldInverse,u=a.projectionMatrix,c=new j.Matrix4;t.forEach((function(e){c.multiplyMatrices(s,e.modelMatrix);var t=e.scene.getSectorsIntersectingFrustum(u,c);null!=i&&i.length>0&&(t=o.testForClippingOcclusion(t,i,e.modelMatrix)),o.markSectorsAsDetailed(t,r,e)}))}},{key:"testForClippingOcclusion",value:function(e,t,n){for(var r=[],i=0;i<e.length;i++){for(var o=Object(T.p)(e[i].bounds).map((function(e){var t=e.clone();return t.applyMatrix4(n),t})),a=!0,s=0;s<t.length;s++){for(var u=!1,c=0;c<o.length;c++)u=t[s].distanceToPoint(o[c])>=0||u;a=a&&u}a&&r.push(e[i])}return r}},{key:"markSectorsAsDetailed",value:function(e,t,n){for(var r=0;r<e.length;r++)t.markSectorDetailed(n,e[r].id,1/0)}},{key:"log",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.options).logCallback.apply(t,[e].concat(r))}}]),e}();function Vt(e,t){switch(t){case se.d.Detailed:return{downloadSize:e.indexFile.downloadSize,drawCalls:e.estimatedDrawCallCount,renderCost:e.estimatedRenderCost};case se.d.Simple:return{downloadSize:e.facesFile.downloadSize,drawCalls:1,renderCost:Math.ceil(e.facesFile.downloadSize/100)};default:throw new Error("Can't compute cost for lod "+t)}}function Wt(e,t,n,r,i,o){var a=new se.a,s=new se.b(e,t,a),u=new Be(r),c=new se.c,l=new Qe(r),d=new nt(t,c,l),f=o.internal,p=f&&f.sectorCuller?f.sectorCuller:function(e,t){var n=new Pt({renderer:e,occludingGeometryProvider:t});return new Gt({renderer:e,coverageUtil:n})}(n,i),h=new ht(d,p);return new Re(r,s,u,h)}(Dt=Nt||(Nt={}))[Dt.Circle=de.PointShape.CIRCLE]="Circle",Dt[Dt.Square=de.PointShape.SQUARE]="Square",(Bt=Lt||(Lt={}))[Bt.Rgb=de.PointColorType.RGB]="Rgb",Bt[Bt.Depth=de.PointColorType.DEPTH]="Depth",Bt[Bt.Height=de.PointColorType.HEIGHT]="Height",Bt[Bt.PointIndex=de.PointColorType.POINT_INDEX]="PointIndex",Bt[Bt.LevelOfDetail=de.PointColorType.LOD]="LevelOfDetail",Bt[Bt.Classification=de.PointColorType.CLASSIFICATION]="Classification",Bt[Bt.Intensity=de.PointColorType.INTENSITY]="Intensity",(jt=Ft||(Ft={}))[jt.Adaptive=de.PointSizeType.ADAPTIVE]="Adaptive",jt[jt.Fixed=de.PointSizeType.FIXED]="Fixed",function(e){e[e.Default=-1]="Default",e[e.Created=0]="Created",e[e.Unclassified=1]="Unclassified",e[e.Ground=2]="Ground",e[e.LowVegetation=3]="LowVegetation",e[e.MedVegetation=4]="MedVegetation",e[e.HighVegetation=5]="HighVegetation",e[e.Building=6]="Building",e[e.LowPoint=7]="LowPoint",e[e.ReservedOrHighPoint=8]="ReservedOrHighPoint",e[e.Water=9]="Water",e[e.Rail=10]="Rail",e[e.RoadSurface=11]="RoadSurface",e[e.ReservedOrBridgeDeck=12]="ReservedOrBridgeDeck",e[e.WireGuard=13]="WireGuard",e[e.WireConductor=14]="WireConductor",e[e.TransmissionTower=15]="TransmissionTower",e[e.WireStructureConnector=16]="WireStructureConnector",e[e.BridgeDeck=17]="BridgeDeck",e[e.HighNoise=18]="HighNoise",e[e.OverheadStructure=19]="OverheadStructure",e[e.IgnoredGround=20]="IgnoredGround",e[e.Snow=21]="Snow",e[e.TemporalExclusion=22]="TemporalExclusion",e[e.UserDefinableOffset=64]="UserDefinableOffset"}(zt||(zt={}));var Ht=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return v(this,n),(o=t.call(this)).name="PointCloudNode",o._potreeGroup=e,o._potreeNode=r,o._cameraConfiguration=i,o.add(o._potreeGroup),o.matrixAutoUpdate=!1,o}return m(n,[{key:"potreeGroup",get:function(){return this._potreeGroup}},{key:"potreeNode",get:function(){return this._potreeNode}},{key:"hasCameraConfiguration",get:function(){return void 0!==this._cameraConfiguration}},{key:"cameraConfiguration",get:function(){return this._cameraConfiguration}},{key:"needsRedraw",get:function(){return this._potreeGroup.needsRedraw}},{key:"requestRedraw",value:function(){this._potreeGroup.requestRedraw()}},{key:"pointSize",get:function(){return this._potreeNode.pointSize},set:function(e){this._potreeNode.pointSize=e}},{key:"pointSizeType",get:function(){return this._potreeNode.pointSizeType},set:function(e){this._potreeNode.pointSizeType=e}},{key:"pointBudget",get:function(){return this._potreeNode.pointBudget},set:function(e){this._potreeNode.pointBudget=e}},{key:"visiblePointCount",get:function(){return this._potreeNode.visiblePointCount}},{key:"pointColorType",get:function(){return this._potreeNode.pointColorType},set:function(e){this._potreeNode.pointColorType=e}},{key:"pointShape",get:function(){return this._potreeNode.pointShape},set:function(e){this._potreeNode.pointShape=e}},{key:"setClassVisible",value:function(e,t){if(!this.hasClass(e))throw new Error("Point cloud model doesn't have class "+e);var n=Zt(e);this._potreeNode.classification[n].w=t?1:0,this._potreeNode.recomputeClassification()}},{key:"isClassVisible",value:function(e){if(!this.hasClass(e))throw new Error("Point cloud model doesn't have class "+e);var t=Zt(e);return 0!==this._potreeNode.classification[t].w}},{key:"hasClass",value:function(e){var t=Zt(e);return void 0!==this._potreeNode.classification[t]}},{key:"getClasses",value:function(){return Object.keys(this._potreeNode.classification).map((function(e){return"DEFAULT"===e?-1:parseInt(e,10)})).sort((function(e,t){return e-t}))}},{key:"getBoundingBox",value:function(e){return(e=e||new j.Box3).copy(this._potreeNode.boundingBox),e.applyMatrix4(this.matrixWorld),e}},{key:"setModelTransformation",value:function(e){this.matrix.copy(e),this.updateMatrixWorld(!0)}},{key:"getModelTransformation",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new j.Matrix4).copy(this.matrix)}}]),n}(j.Group);function Zt(e){return e===zt.Default?"DEFAULT":e}var qt=function(e){l(n,e);var t=d(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;v(this,n),(e=t.call(this))._needsRedraw=!1,e._lastDrawPointBuffersHash=0,e._forceLoadingSubject=new W.Subject,e.nodes=[],e.numNodesLoadingAfterLastRedraw=0,e.numChildrenAfterLastRedraw=0,e.potreeGroup=new de.Group,e.potreeGroup.name="Potree.Group",e.name="Potree point cloud wrapper",e.add(e.potreeGroup);var i=new j.Mesh(new j.BufferGeometry);return i.name="onAfterRender trigger (no geometry)",i.frustumCulled=!1,i.onAfterRender=function(){e.resetRedraw(),e._lastDrawPointBuffersHash=e.pointBuffersHash},e.add(i),e._loadingObservable=e.createLoadingStateObservable(r),e._lastDrawPointBuffersHash=e.pointBuffersHash,e.pointBudget=2e6,e}return m(n,[{key:"needsRedraw",get:function(){return this._needsRedraw||this._lastDrawPointBuffersHash!==this.pointBuffersHash||de.Global.numNodesLoading!==this.numNodesLoadingAfterLastRedraw||this.numChildrenAfterLastRedraw!==this.potreeGroup.children.length||this.nodes.some((function(e){return e.needsRedraw}))}},{key:"pointBudget",get:function(){return this.potreeGroup.pointBudget},set:function(e){this.potreeGroup.pointBudget=e}},{key:"getLoadingStateObserver",value:function(){return this._loadingObservable}},{key:"addPointCloud",value:function(e){this.potreeGroup.add(e.octtree),this.nodes.push(e),this._forceLoadingSubject.next(),this.requestRedraw()}},{key:"removePointCloud",value:function(e){var t=this.nodes.indexOf(e);if(-1===t)throw new Error("Point cloud is not added - cannot remove it");this.potreeGroup.remove(e.octtree),this.nodes.splice(t,1)}},{key:"requestRedraw",value:function(){this._needsRedraw=!0}},{key:"resetRedraw",value:function(){this._needsRedraw=!1,this.numNodesLoadingAfterLastRedraw=de.Global.numNodesLoading,this.numChildrenAfterLastRedraw=this.potreeGroup.children.length,this.nodes.forEach((function(e){return e.resetRedraw()}))}},{key:"createLoadingStateObservable",value:function(e){var t,n=this._forceLoadingSubject.pipe((t=5*e,Object(W.pipe)(Object(re.switchMap)((function(){return Object(W.of)(!1).pipe(Object(re.delay)(t),Object(re.startWith)(!0))})),Object(re.distinctUntilChanged)())));return Object(W.combineLatest)([Object(W.interval)(e).pipe(Object(re.map)(Yt),Object(re.distinctUntilChanged)((function(e,t){return e.isLoading===t.isLoading&&e.itemsLoaded===t.itemsLoaded&&e.itemsRequested===t.itemsRequested}))),n]).pipe(Object(re.map)((function(e){var t=h(e,2),n=t[0];return t[1]&&!n.isLoading?{isLoading:!0,itemsLoaded:0,itemsRequested:1,itemsCulled:0}:n})),Object(re.startWith)({isLoading:!1,itemsLoaded:0,itemsRequested:0,itemsCulled:0}),Object(re.distinctUntilChanged)(),Object(re.share)())}},{key:"pointBuffersHash",get:function(){var e,t=this.potreeGroup.pointclouds,n=3131961357,r=f(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.traverseVisible((function(e){if(e.isPoints){var t=e.geometry;n^=t.getAttribute("position").count}})),n^=i.id}}catch(e){r.e(e)}finally{r.f()}return n}}]),n}(j.Object3D);function Yt(){return{isLoading:de.Global.numNodesLoading>0,itemsLoaded:0,itemsRequested:de.Global.numNodesLoading,itemsCulled:0}}var Xt=function(){function e(t,n){v(this,e),this._pointCloudMetadataRepository=t,this._pointCloudFactory=n,this._pointCloudGroupWrapper=new qt}return m(e,[{key:"requestRedraw",value:function(){this._pointCloudGroupWrapper.requestRedraw()}},{key:"resetRedraw",value:function(){this._pointCloudGroupWrapper.resetRedraw()}},{key:"pointBudget",get:function(){return this._pointCloudGroupWrapper.pointBudget},set:function(e){this._pointCloudGroupWrapper.pointBudget=e}},{key:"needsRedraw",get:function(){return this._pointCloudGroupWrapper.needsRedraw}},{key:"clippingPlanes",set:function(e){this._pointCloudGroupWrapper.traverse((function(t){if(t.material){var n=t.material;n.clipping=!0,n.clipIntersection=!1,n.clippingPlanes=e}}))}},{key:"getLoadingStateObserver",value:function(){return this._pointCloudGroupWrapper.getLoadingStateObserver()}},{key:"updateCamera",value:function(e){}},{key:"addModel",value:(t=u(p.mark((function e(t){var n,r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._pointCloudMetadataRepository.loadData(t);case 2:return n=e.sent,r=this._pointCloudFactory.createModel(n),this._pointCloudGroupWrapper.addPointCloud(r),i=new Ht(this._pointCloudGroupWrapper,r,n.cameraConfiguration),e.abrupt("return",(i.setModelTransformation(n.modelMatrix),i));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"removeModel",value:function(e){this._pointCloudGroupWrapper.removePointCloud(e.potreeNode)}}]),e;var t}(),Kt=(new j.Matrix4).identity(),Jt=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ept.json";v(this,e),this._modelMetadataProvider=t,this._modelDataProvider=n,this._blobFileName=r}return m(e,[{key:"loadData",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._modelMetadataProvider.getModelUri(t),r=this._modelMetadataProvider.getModelMatrix(t),i=this._modelMetadataProvider.getModelCamera(t),e.next=5,n;case 5:return o=e.sent,e.next=8,r;case 8:return a=e.sent,e.next=11,this._modelDataProvider.getJsonFile(o,this._blobFileName);case 11:return s=e.sent,e.next=14,i;case 14:return u=e.sent,e.abrupt("return",{modelBaseUrl:o,modelMatrix:a,cameraConfiguration:Object(T.t)(u,Kt),scene:s});case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t}(),Qt=function(){function e(t){v(this,e),this._needsRedraw=!1,this.octtree=t,this.pointSize=2,this.pointSizeType=Ft.Adaptive,this.pointColorType=Lt.Rgb,this.pointShape=Nt.Circle,this.pointBudget=1/0}return m(e,[{key:"needsRedraw",get:function(){return this._needsRedraw}},{key:"pointSize",get:function(){return this.octtree.material.size},set:function(e){this.octtree.material.size=e,this._needsRedraw=!0}},{key:"pointSizeType",get:function(){return this.octtree.material.pointSizeType},set:function(e){this.octtree.material.pointSizeType=e,this._needsRedraw=!0}},{key:"pointBudget",get:function(){return this.octtree.pointBudget},set:function(e){this.octtree.pointBudget=e,this._needsRedraw=!0}},{key:"visiblePointCount",get:function(){return this.octtree.numVisiblePoints||0}},{key:"boundingBox",get:function(){var e=this.octtree.pcoGeometry.tightBoundingBox||this.octtree.pcoGeometry.boundingBox||this.octtree.boundingBox,t=new j.Vector3(e.min.x,e.min.z,-e.min.y),n=new j.Vector3(e.max.x,e.max.z,-e.max.y);return(new j.Box3).setFromPoints([t,n])}},{key:"pointColorType",get:function(){return this.octtree.material.pointColorType},set:function(e){this.octtree.material.pointColorType=e,this._needsRedraw=!0}},{key:"pointShape",get:function(){return this.octtree.material.shape},set:function(e){this.octtree.material.shape=e,this._needsRedraw=!0}},{key:"classification",get:function(){return this.octtree.material.classification}},{key:"recomputeClassification",value:function(){this.octtree.material.recomputeClassification()}},{key:"resetRedraw",value:function(){this._needsRedraw=!1}}]),e}(),$t=function(){function e(t){v(this,e),this._httpHeadersProvider=t}return m(e,[{key:"createModel",value:function(e){this.initializePointCloudXhrRequestHeaders();var t=e.modelBaseUrl,n=e.scene,r=new de.PointCloudEptGeometry(t+"/",n),i=r.offset.x,o=r.offset.y,a=r.offset.z,s=new de.PointCloudEptGeometryNode(r,r.boundingBox,0,i,o,a);r.root=s,r.root.load();var u=new de.PointCloudOctree(r);return u.name="PointCloudOctree: "+t,new Qt(u)}},{key:"initializePointCloudXhrRequestHeaders",value:function(){for(var e=this._httpHeadersProvider.headers,t=de.XHRFactory.config.customHeaders,n=function(){var e=h(i[r],2),n=e[0],o=e[1];t=t.filter((function(e){return e.header!==n})),t.push({header:n,value:o})},r=0,i=Object.entries(e);r<i.length;r++)n();de.XHRFactory.config.customHeaders=t.filter((function(e){return e.header}))}}]),e}(),en=function(){function e(t,n,r){v(this,e),this._lastCamera={position:new j.Vector3(NaN,NaN,NaN),quaternion:new j.Quaternion(NaN,NaN,NaN,NaN),zoom:NaN},this._isDisposed=!1,this._subscriptions=new W.Subscription,this._events={loadingStateChanged:new T.d},this._effectRenderManager=n,this._cadManager=t,this._pointCloudManager=r,this.initLoadingStateObserver(this._cadManager,this._pointCloudManager),this._updateSubject=new W.Subject,this._updateSubject.pipe(Object(re.auditTime)(5e3),Object(re.tap)((function(){q.a.trackCameraNavigation({moduleName:"RevealManager",methodName:"update"})}))).subscribe()}return m(e,[{key:"dispose",value:function(){this._isDisposed||(this._cadManager.dispose(),this._subscriptions.unsubscribe(),this._isDisposed=!0)}},{key:"requestRedraw",value:function(){this._cadManager.requestRedraw(),this._pointCloudManager.requestRedraw()}},{key:"resetRedraw",value:function(){this._cadManager.resetRedraw(),this._pointCloudManager.resetRedraw()}},{key:"debugRenderTiming",get:function(){return this._effectRenderManager.debugRenderTimings},set:function(e){this._effectRenderManager.debugRenderTimings=e}},{key:"renderOptions",get:function(){return this._effectRenderManager.renderOptions},set:function(e){this._effectRenderManager.renderOptions=null!=e?e:Z}},{key:"needsRedraw",get:function(){return this._cadManager.needsRedraw||this._pointCloudManager.needsRedraw}},{key:"update",value:function(e){(this._lastCamera.zoom!==e.zoom||!this._lastCamera.position.equals(e.position)||!this._lastCamera.quaternion.equals(e.quaternion))&&(this._lastCamera.position.copy(e.position),this._lastCamera.quaternion.copy(e.quaternion),this._lastCamera.zoom=e.zoom,this._cadManager.updateCamera(e),this._updateSubject.next())}},{key:"cadBudget",get:function(){return this._cadManager.budget},set:function(e){this._cadManager.budget=e}},{key:"cadLoadedStatistics",get:function(){return this._cadManager.loadedStatistics}},{key:"cadRenderMode",get:function(){return this._cadManager.renderMode},set:function(e){this._cadManager.renderMode=e}},{key:"pointCloudBudget",get:function(){return{numberOfPoints:this._pointCloudManager.pointBudget}},set:function(e){this._pointCloudManager.pointBudget=e.numberOfPoints}},{key:"clippingPlanes",get:function(){return this._cadManager.clippingPlanes},set:function(e){this._cadManager.clippingPlanes=e,this._pointCloudManager.clippingPlanes=e}},{key:"on",value:function(e,t){if("loadingStateChanged"!==e)throw new Error("Unsupported event '".concat(e,"'"));this._events.loadingStateChanged.subscribe(t)}},{key:"off",value:function(e,t){if("loadingStateChanged"!==e)throw new Error("Unsupported event '".concat(e,"'"));this._events.loadingStateChanged.unsubscribe(t)}},{key:"render",value:function(e){this._effectRenderManager.render(e),this.resetRedraw()}},{key:"setRenderTarget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._effectRenderManager.setRenderTarget(e),this._effectRenderManager.setRenderTargetAutoSize(t)}},{key:"addModel",value:(t=u(p.mark((function e(t,n,r){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(q.a.trackLoadModel({type:t},n),t),e.next="cad"===e.t0?3:"pointcloud"===e.t0?4:5;break;case 3:return e.abrupt("return",this._cadManager.addModel(n,null==r?void 0:r.geometryFilter));case 4:return e.abrupt("return",this._pointCloudManager.addModel(n));case 5:throw new Error("Model type '".concat(t,"' is not supported"));case 6:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"removeModel",value:function(e,t){switch(e){case"cad":this._cadManager.removeModel(t);break;case"pointcloud":this._pointCloudManager.removeModel(t);break;default:Object(T.l)(e)}}},{key:"addUiObject",value:function(e,t,n){this._effectRenderManager.addUiObject(e,t,n),this.requestRedraw()}},{key:"removeUiObject",value:function(e){this._effectRenderManager.removeUiObject(e),this.requestRedraw()}},{key:"notifyLoadingStateChanged",value:function(e){this._events.loadingStateChanged.fire(e)}},{key:"initLoadingStateObserver",value:function(e,t){this._subscriptions.add(Object(W.combineLatest)([e.getLoadingStateObserver(),t.getLoadingStateObserver()]).pipe(Object(re.observeOn)(W.asyncScheduler),Object(re.subscribeOn)(W.asyncScheduler),Object(re.map)((function(e){var t=h(e,2),n=t[0],r=t[1];return{isLoading:n.isLoading||r.isLoading,itemsLoaded:n.itemsLoaded+r.itemsLoaded,itemsRequested:n.itemsRequested+r.itemsRequested,itemsCulled:n.itemsCulled+r.itemsCulled}})),Object(re.distinctUntilChanged)((function(e,t){return e.itemsLoaded===t.itemsLoaded&&e.itemsRequested===t.itemsRequested}))).subscribe(this.notifyLoadingStateChanged.bind(this),(function(e){return q.a.trackError(e,{moduleName:"RevealManager",methodName:"constructor"})})))}}]),e;var t}(),tn=function(){function e(t){v(this,e),this._renderManager=t}return m(e,[{key:"renderOccludingGeometry",value:function(e,t){var n={renderTarget:this._renderManager.getRenderTarget(),autoSize:this._renderManager.getRenderTargetAutoSize()};try{this._renderManager.setRenderTarget(e),this._renderManager.renderDetailedToDepthOnly(t)}finally{this._renderManager.setRenderTarget(n.renderTarget),this._renderManager.setRenderTargetAutoSize(n.autoSize)}}}]),e}(),nn=function(){function e(t,n){v(this,e),this._defaultAppearance={},this._handleStylesChangedListener=this.handleStylesChanged.bind(this),this._needsUpdate=!0,this._allTreeIndices=new T.e,this._allTreeIndices.addRange(new T.i(0,t)),this._styleProvider=n,this._styleProvider.on("changed",this._handleStylesChangedListener);var r=function(e){var t=Object(T.m)(e),n=t.width,r=t.height,i=n*r,o=new j.DataTexture(new Uint8ClampedArray(4*i),n,r),a=new Uint8ClampedArray(3*i);return{overrideColorPerTreeIndexTexture:o,transformOverrideIndexTexture:new j.DataTexture(a,n,r,j.RGBFormat)}}(t);this._overrideColorPerTreeIndexTexture=r.overrideColorPerTreeIndexTexture,this._overrideColorDefaultAppearanceRgba=new Uint8ClampedArray(this._overrideColorPerTreeIndexTexture.image.data.length),this._regularNodesTreeIndices=new T.e,this._ghostedNodesTreeIndices=new T.e,this._infrontNodesTreeIndices=new T.e,this.setDefaultAppearance(D.Default)}return m(e,[{key:"getDefaultAppearance",value:function(){return this._defaultAppearance}},{key:"setDefaultAppearance",value:function(e){var t,n;t=e,n=this._defaultAppearance,JSON.stringify(t)!==JSON.stringify(n)&&(this._defaultAppearance=e,function(e,t){for(var n=rn(t),r=h(n,4),i=r[0],o=r[1],a=r[2],s=r[3],u=0;u<e.length;++u)e[4*u+0]=i,e[4*u+1]=o,e[4*u+2]=a,e[4*u+3]=s}(this._overrideColorDefaultAppearanceRgba,e),this._needsUpdate=!0)}},{key:"regularNodeTreeIndices",get:function(){return this._regularNodesTreeIndices}},{key:"ghostedNodeTreeIndices",get:function(){return this._ghostedNodesTreeIndices}},{key:"infrontNodeTreeIndices",get:function(){return this._infrontNodesTreeIndices}},{key:"needsUpdate",get:function(){return this._needsUpdate}},{key:"overrideColorPerTreeIndexTexture",get:function(){return this._overrideColorPerTreeIndexTexture}},{key:"dispose",value:function(){this._styleProvider.off("changed",this._handleStylesChangedListener),this._overrideColorPerTreeIndexTexture.dispose()}},{key:"build",value:function(){if(this._needsUpdate){var e=this._overrideColorPerTreeIndexTexture.image.data;this.populateTexture(e),this.populateNodeSets(e),this._needsUpdate=!1}}},{key:"populateTexture",value:function(e){var t=this;e.set(this._overrideColorDefaultAppearanceRgba),this._styleProvider.applyStyles((function(e,n){var r=c(c({},t._defaultAppearance),n);t.applyStyleToNodes(e,r)})),this._overrideColorPerTreeIndexTexture.needsUpdate=!0}},{key:"populateNodeSets",value:function(e){var t=this;this._regularNodesTreeIndices.clear(),this._infrontNodesTreeIndices.clear(),this._ghostedNodesTreeIndices.clear();for(var n={rangeStart:-1,inFront:!1,ghosted:!1},r=function(e){var r=T.i.createFromInterval(n.rangeStart,e-1);n.inFront?t._infrontNodesTreeIndices.addRange(r):n.ghosted?t._ghostedNodesTreeIndices.addRange(r):t._regularNodesTreeIndices.addRange(r)},i=0;i<this._allTreeIndices.count;++i){var o=0!=(2&e[4*i+3]),a=0!=(4&e[4*i+3]);-1===n.rangeStart?(n.rangeStart=i,n.inFront=o,n.ghosted=a):n.inFront===o&&n.ghosted===a||(r(i),n.rangeStart=i,n.inFront=o,n.ghosted=a)}-1!==n.rangeStart&&r(this._allTreeIndices.count)}},{key:"applyStyleToNodes",value:function(e,t){0!==e.count&&function(e,t,n){var r=rn(n),i=h(r,4),o=i[0],a=i[1],s=i[2],u=i[3],c=void 0===n.color||0===n.color[0]&&0===n.color[1]&&0===n.color[2]?0:255,l=~c,d=o&c,f=a&c,p=s&c,v=(void 0!==n.visible?1:0)|(void 0!==n.renderInFront?2:0)|(void 0!==n.renderGhosted?4:0)|(void 0!==n.outlineColor?224:0),m=~v,y=u&v;t.forEachRange((function(t){for(var n=t.from;n<=t.toInclusive;++n){var r=e[4*n+0],i=e[4*n+1],o=e[4*n+2];e[4*n+0]=r&l|d,e[4*n+1]=i&l|f,e[4*n+2]=o&l|p,e[4*n+3]=e[4*n+3]&m|y}}))}(this._overrideColorPerTreeIndexTexture.image.data,e,t)}},{key:"handleStylesChanged",value:function(){this._needsUpdate=!0}}]),e}();function rn(e){var t=e.color||[0,0,0],n=h(t,3);return[n[0],n[1],n[2],(void 0===e.visible||e.visible?1:0)+(e.renderInFront?2:0)+(e.renderGhosted?4:0)+((e.outlineColor?Number(e.outlineColor):0)<<5)]}var on=function(){function e(t){v(this,e),this._textureBuffer=new Uint8Array(e.MIN_NUMBER_OF_TREE_INDICES*e.NUMBER_OF_ELEMENTS_PER_MATRIX*e.BYTES_PER_FLOAT),this._dataTexture=new j.DataTexture(this._textureBuffer,e.NUMBER_OF_ELEMENTS_PER_MATRIX,e.MIN_NUMBER_OF_TREE_INDICES),this._onGenerateNewDataTextureCallback=t,this._unusedIndices=s(Array(e.MIN_NUMBER_OF_TREE_INDICES).keys()).map((function(e,t){return t})),this._treeIndexToOverrideIndex=new Map}return m(e,[{key:"dataTexture",get:function(){return this._dataTexture}},{key:"overrideIndices",get:function(){return this._treeIndexToOverrideIndex}},{key:"dispose",value:function(){this._dataTexture.dispose()}},{key:"addOverrideTransform",value:function(t,n){var r,i=n.toArray();this._treeIndexToOverrideIndex.has(t)?r=this._treeIndexToOverrideIndex.get(t):(void 0===(r=this._unusedIndices.pop())&&(this.recomputeDataTexture(),r=this._unusedIndices.pop()),this._treeIndexToOverrideIndex.set(t,r));for(var o=0;o<e.NUMBER_OF_ELEMENTS_PER_MATRIX;o++){var a=(r*e.NUMBER_OF_ELEMENTS_PER_MATRIX+o)*e.BYTES_PER_FLOAT,s=i[o%4*4+Math.floor(o/4)];Object(T.r)(s,this._dataTexture.image.data,a)}return this._dataTexture.needsUpdate=!0,r}},{key:"removeOverrideTransform",value:function(e){if(this._treeIndexToOverrideIndex.has(e)){var t=this._treeIndexToOverrideIndex.get(e);this._unusedIndices.push(t),this._treeIndexToOverrideIndex.delete(e)}}},{key:"recomputeDataTexture",value:function(){var t=this._textureBuffer.length,n=new Uint8Array(2*t);n.set(this._textureBuffer);for(var r=Object(T.m)(2*t/e.BYTES_PER_FLOAT),i=new j.DataTexture(n,r.width,r.height),o=t/(e.BYTES_PER_FLOAT*e.NUMBER_OF_ELEMENTS_PER_MATRIX),a=o;a<2*o;a++)this._unusedIndices.push(a);this._textureBuffer=n,this._dataTexture=i,this._onGenerateNewDataTextureCallback(i)}}]),e}();on.MIN_NUMBER_OF_TREE_INDICES=16,on.NUMBER_OF_ELEMENTS_PER_MATRIX=16,on.BYTES_PER_FLOAT=4;var an=function(){function e(t,n){v(this,e),this._needsUpdate=!1,this._handleTransformChangedBound=this.handleTransformChanged.bind(this);var r=function(e){var t=Object(T.m)(e),n=t.width,r=t.height,i=new Uint8ClampedArray(n*r*3);return{transformOverrideIndexTexture:new j.DataTexture(i,n,r,j.RGBFormat)}}(t);this._transformOverrideIndexTexture=r.transformOverrideIndexTexture,this._transformOverrideBuffer=new on(this.handleNewTransformTexture.bind(this)),this._transformProvider=n,this._transformProvider.on("changed",this._handleTransformChangedBound)}return m(e,[{key:"dispose",value:function(){this._transformOverrideBuffer.dispose(),this._transformOverrideIndexTexture.dispose(),this._transformProvider.off("changed",this._handleTransformChangedBound)}},{key:"needsUpdate",get:function(){return this._needsUpdate}},{key:"overrideTransformIndexTexture",get:function(){return this._transformOverrideIndexTexture}},{key:"transformLookupTexture",get:function(){return this._transformOverrideBuffer.dataTexture}},{key:"build",value:function(){this._needsUpdate=!1}},{key:"setNodeTransform",value:function(e,t){var n=this,r=this._transformOverrideBuffer.addOverrideTransform(e.from,t);e.forEach((function(e){return n.setOverrideIndex(e,r)})),this._needsUpdate=!0}},{key:"resetNodeTransform",value:function(e){var t=this;this._transformOverrideBuffer.removeOverrideTransform(e.from),e.forEach((function(e){return t.setOverrideIndex(e,-1)})),this._needsUpdate=!0}},{key:"setOverrideIndex",value:function(e,t){var n=this._transformOverrideIndexTexture.image.data;n[3*e+0]=t+1>>16,n[3*e+1]=t+1>>8,n[3*e+2]=t+1>>0,this._transformOverrideIndexTexture.needsUpdate=!0}},{key:"handleNewTransformTexture",value:function(){this._needsUpdate=!0}},{key:"handleTransformChanged",value:function(e,t,n){switch(e){case"set":this.setNodeTransform(t,n);break;case"reset":this.resetNodeTransform(t);break;default:Object(T.l)(e,"Unexpected change type '".concat(e,"'"))}}}]),e}(),sn=(new j.Matrix4).identity(),un=function(){function e(){v(this,e),this._events={changed:new T.d}}return m(e,[{key:"on",value:function(e,t){"changed"===e?this._events.changed.subscribe(t):Object(T.l)(e,"Unsupported event: '".concat(e,"'"))}},{key:"off",value:function(e,t){"changed"===e?this._events.changed.unsubscribe(t):Object(T.l)(e,"Unsupported event: '".concat(e,"'"))}},{key:"setNodeTransform",value:function(e,t){this._events.changed.fire("set",e,t)}},{key:"resetNodeTransform",value:function(e){this._events.changed.fire("reset",e,sn)}}]),e}(),cn=new Image;cn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABgGlDQ1BJQ0MgcHJvZmlsZQAAKJFjYGCqSCwoyGFhYGDIzSspCnJ3UoiIjFJgv8PAzcDDIMRgxSCemFxc4BgQ4MOAE3y7xsAIoi/rgsxqOqd2d+pGwehjat+yq+1cc3DrAwPulNTiZAYGRg4gOyWlODkXyAbp0UsuKCoBsucA2brlJQUg9hkgW6QI6EAg+wGInQ5hfwGxk8BsJg6wmpAgZyBbBsgWSIKwdUDsdAjbBsROzkhMAbJB/tKBuAEMuIJdFAzNDXx1HQk4nFSQm1MKswMUWjypeaHBQFoIiGUYghlcGBQYDBnMGQwYfBl0GYCWl6RWlIAUO+cXVBZlpmeUKDgCQzdVwTk/t6C0JLVIR8EzL1lPR8HIwNAApA4UbxDjPweBbWAUO48Qy5rMwGDxhoGBuQohlrKcgWGLPQODeDBCTH020EnvGRh2hBckFiXCHc/4jYUQvzjN2AjC5nFiYGC99///ZzUGBvZJDAx/J/7//3vR//9/FwPtv8PAcCAHALbUa33lfYEHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AobCyAEEhU0UQAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAACAASURBVHjalV3bkiLXESzoC9cZdle7lixF7IMj7Ad/qn/RVliybMmyZhkGGKCBBj+s6ig7yTqNJmJjbzPN6XOpysrKqjP429/+djUzu16vNhgMbDAY2HA4tLIsbTKZWFmW1rat7fd7O5/P1ratXS4Xw5+5Xq82HA47v1+vVzOz9Hcz6/zc5XKxtm07z/Ev/34elz9vOBzaYDCwtm3tfD7b6XSy6/Vq5/M5fU9RFFbXtZVlaXVdm5mlZ1wuFyvLMn2GP78oCjMzO51Odjqd0rNxrP5VFEXnl7+nf4bP4+VySe/jn+Hj97nzMU+nUyuKwo7HY3onfGZRFDabzWyxWNjpdLLVamVN06Tvw3nHL5xb/LfL5WIlDsJ/90Vu29bKsrTr9Wpt23YWHxfocrl0Jtf/HQeE/68GpDaBP5tfwsdzPp/tcrnYcDi0qqpsNptZVVVW17UVRZEWwZ91PB7TJuHF8gnxBR0MBukQ+Lh9kx2Px84iFUVhZVlaWZbpM3Hjq7nCeTezNObL5WLn81keoLqubTqd2vl8ts1mY03TpHGphY/mFte69P/gTaBOLf7CBR0Oh9a2rQ2Hw5tF8pfljYaf65/hz8Hv8/8/nU5p0cuytNFoZKPRyKqqSiceFxInECfRTzlaFPydLZSP1Z8zHo9tNBqlzXA6naxpGjsej3Y4HNJmqOu680z/bJ7H6/WaNu3lcrHD4ZDmDdfBF9/MbL1e236/l3OFm1ptAt4MJU4Un27frfhwPvG+0GaWTheamMgMqQ2AL+QL0DSNnc/nNPnT6dTG47FVVWWXy+XmM/CXLxr/P1shXxh2P/w8f0devNFolMbcNI01TWObzSZtVLcqfDh83t1FuYXiuSrL0sbjsRVFYa+vr2lO+DRHi8//jgei4wLYLKEFwIfipsAHKlPEbsD/7j/DE3q9Xu10OtnxeEy+ej6fp5PuC+obEn0qnlb/HceMC41+GBfbD4JbFDTZuFkQE7jFGQwGaZO6RXh9fU2bt67rjoVyrDUYDOxwOEi/79akqiprmsb2+33CJYy5/J0iF8DWouMCcKH5FLA7wMlmP+0P9wnCF1bPRdxxOp3scDiYmSVTy2bUzb0vBO9uXEj8N5wsPgkM3HDh8eTi+7CP5w3sG3c6nVrTNHY4HGy321ld1+k0O25wPKHG65vEN5SDPv8+drO5Lwad1+vVSpw0BSR48ZWJ50lEk46m3jcLY4jz+Wz7/d7MzCaTiY3H405UgSi9LEuJotmPIwD033E8yiziBLKlUT4Ux6Asqf8aj8c2Ho/tfD6nk+6Wwt0cR09u2aqqSt9zPB5vcJjCWJEVUAel7DMXKkrAk4MbQ/0M/r/7bNwg+/3ertdr8u24iH7a/d9wlzv6xs9UoSJvCPb/yl/ySeF/ZzPt74KuyDcbbtCyLG02m9nxeLTlcmnr9boTauM40d0cDoe0+BGuUqFzzhI44C5VWKJMmzrx/H3RTvOXc2DXtq3tdrt0OqbT6c3pcx/M5h9NI5rhnAnk08LjRovC40Bcge+IGwMxA4NqPiyOazzeX61WVlVVQvg4FneLDo755OM40MKyJYxcQbIA/NDIfCCCxYHyKcdFcfLIB7jf761pGiuKwubzeQJG7mv9xLMlYB/NII5fjMOo6KSrU65cCm9qhSXYwuAYGF9UVWXv3r2zpmlsuVzadrtNmGE0Gtn5fLamaTqRUUTm8EG455397yWHfAzsGDUiaFOxpm8QRpwO8Nq2tel0mtCvLzqSKMpcqZBMvVhkFpU7UBtMPVtZumizoFtSB8ldl5/4wWCQNsJ6vbbL5WJffPGFtW1rx+Mx+5loYdW7RiAZfy/ZxOMH9G0ChejdAvjv/iL7/d6KorDFYiERvZ98NGEK6KD5V0RPNFF4Chn0KbPPoFfNQy7WZvCLOMCt3uFw6LiFN2/e2MvLi/3jH/+wh4eHRA5dr1cry7IzN7zROWTNYRt0ryX7cwYZiNpVjM+cAVoBZ7aOx2MCOz7JfuJ9UdD0c6zOuABPm0LCjD944ftOewRsmRPhRVbg0RfFf7aqKptMJtY0TWfDOU56//697XY7Wy6XKWR0V6rcNLu6vq8bkolPj4rpmRLOoU8ndy6Xi+12O2vb1h4fH7t+B0I5PNFMaiDVrHw/x+/3+EF2MfckTnI4QJ0wB4Uq9h6Px50owefVreBkMkkU99PTk202G5vP5535UGPhOWGgGkUGQ4WIOeTLgUIflLNTnkXbbDZmZvbw8NAhNHzx0fw7y4exPsb+vFkQATMw5BOuACQyg8oN8IRGG94XmRlK3NA4Vmf0PBJifsPNvLOg7969s7qubbPZdDKnmLBjfKBctTqk/ueSzRxSnNGu4ZPmg3FSZ7PZWF3XNp/POz4nonHVCceQBicqOtF8Mpmq7ov1owhIAVLlShStnOjWX13faDRKC8zP8twGxvxuPXe7na3X60SJq3dCfKA4EA7fE/ZQ8TsnaCIziMSOZ8VeX19TbO8vzwvINGeExvHvjq5V7K8yYYrQ4mRQxI71bYK+UJFdElq/3W53Q/e6yXdSrCiK5PNPp1PSCaxWK5tOpwkcKmJKhZ6RBTCz3yxAn+lQdDCe+uPxaNvt1kajkU0mk87i4knHiVfiCPydQV4U4qgdz36Pn63Qfk5U0cccKs4BN3pVVck94pdbShfc8OINh0M7nU42Go3s7du39unTJ5vNZglLME7jw9PHGg45XufJZ3yA3+chXtM0tt1uE4/vQM99Gy40U7ycuUOqGK0RAy4kXSLTG0UtDB7v/cq5iQhLIFbwhA/O8WKxsMFgkEgfprI9RHRxzvv37ztJIU6JMwvIhwA35WAwsKECCYzWVU7AxRCHw8HW63VKeLgUC+N7NufI/CkWUqmJWJiCoCjiANRpxZdX38efo/QRymVE6Nx/d5CM3/P4+GiTycS2220KC3EhfQ18jtq2taIo7O3bt0kXwGAwEogo63S9Xm0YERbKr+BEOFW52WxSrtuFCxzjq8VnQQbG9Zg34J3tCFqZP/+ZSCSCAhTMp0fRzT0hJIet/Hmoe8D/H4/H9vDwYOv12g6Hww2NzVwJsozD4dDevXtnu92uIx9Dy+hzhO+KVH7CJzn5EJ9G1sVtt1ur69pGo1FSv6DpR9dRVVVnctACKHGo2tEMSO/RwanwMQJFvFlzz+bf2TqwtcS/V1Vlj4+PdjgcUrgcRV58iHy8ZVnaYrGw19fXThTmohJXL+XY3Ov1+hkDRKecdw/G+a+vr4m4iDRwatAe9+MmUdIuJoFyC6iUOQr98gJFGUx10nPkl+JReBPg5vcIabVadUx4n7ADuRNUS202Gzufz8nKsAVQhziNF3eof7CLL9mMuOnfbrdmZimp4+ZfWQ5W1Mznc/v48aN98cUXHTm1ynqxG1J4RAFAxQJGGkUlO+9zAyqrxtR0pGr2uVqv1wkXMKGj8hN+WPCzLpdLcr/r9TqtmzrpYRiLA2X/iYvvO8w1aXjy0VfxwB3I+NdoNLIPHz7YH/7wh5scO6pwGRiyzDuaZLWwyqzzpEesopKOq39ncKkApH/PbrfroPhc3p6BNOZO6rq26/VqDw8PNhgMkjtQqqUIGJd9oQ9ugP1+b/v9PpERTO0qMoTB0Xa7tR9//DHt4FyYxSpkxA/olljVq15YkUIKKKq6BUVQRZOMIR4mgvDnnOqNSKvISiFuSlRuWdrpdLLFYmHPz89Ja8GgV2kkzew3RVBfbYCreKqqsqqqOmlNJngY6WOat21b+/nnn+/i4BlguctAMKjSooq34CKRKNcfbQLFlnKaWlkdfj4DwkjHwGOPimNQiPL4+Jjk6FhowuPthPosjMBkA7oGlzdPp9MbAsd3Ji4UZsMGg4FVVSUFlszIKbUNF1cwsFHWR20Qj6Mj/95HG7MUS/ECnEhjidY9GUac25zcnj/XaxT8oPr7qkKT5AI4z81MHypS5/N5h+hRIQqKOB28RJOAAFBtRD5VeLr4pRTZhAQNppvVZKiSN1VIweOLijAUd8CJNrXhlb7BP8utB6eGHWedz2ebTCZJQj4ejyXNjfNTIkGhTpGHfF6Nw3G+CtkYbEVaOvWiKoOnJNwKP/wenj4KD9Umjfw8vw9L3vkU42HDwlGmw/F70b36IiMmYJbwfD7bbDZLHA1GYgpwllEs7IN+fX1NzBXLtPGlMQRyfX9RFNY0Ta+eD/16tBH59KF/yxE3OZDFG6Ev0xidzD4pNi42RywqJa3EppEa2zcBbgbXHbgMzzcHR0+yLgB9//F4tLZtUx4aK2AVJ+6boCgK+/rrr62ua/v3v/+deO5cJQ/69hz1yieFcUWfNPwegicifaJows2zqoD2PzuvojaHUjnl1Fio2/C/Y2n85XKx+Xxuz8/PxhaesVfJOx+R6uFwSFW4zuDxALlmzwd0OBxukkkKAEbmkpU8+L2cM2DSKYrFGZmzrDqXSYwKY1URLZ9YP4G4cLl6hByHgGNgsanPjeOj6XRq2+3WHh4e0uexrqLkl/IvL2FySZcvPgM+9QKXy8U+ffpkq9WqUzShkK7K0eOCKgEkAz6up1eIPIoM1AZVglgGyQpIKq0CLzjTvlEdZq5Gg78HRbIOqN0K7HY7Ox6PnSYZiKFKPAFu/p308eJM1tPhLlLNFdCSMBOYyzxGNGu0qBiKRdnLKAZWYZwSkOQKZHJ6AVUHGdG9rEvgRY4KeCMXgfPpGUcPw7mQZOgL5pkjL832ej1H/FzCzaDPQz6UfXHlkKrdizQA+GL4ghxloOBEFZDk6GEUdXJFUo4+jYpJ8d9yMi0Oadn8I7B2F9u38dSzXE42HA5vCkvTBmDT7QWbTiQoAQW/HCZ1ol2uMm7RIvVJuHmTOTuZE2gqmRZPsHJlKr/PHUmQ/FK4Rsm1ImuXqnZ/xU+oc2D8owplMNLwn314eEjtZLzeMM0xL5JnqNxkqDx8TjSCp52zd7nYnXsLsNWI2D/k2ZUKKccPRMkfLjyJ0txK4II1D4qLjwpsWEDqgLFv4VVvJnw39P++CXBDDdn0+A9wvR738olKoZSIFF0BLti9ihs+wVztg1qDvuyXeo/xeJxCXdxAqstIJJ5ly5UTpkaAlCloLiqN8hNctcz5icvlYrPZrNOEwjfBkJFq27Y2m81SzI9FnKr4k09nTnuPANF9HLdZi4Af73LvG6QYOHXKIzc2mUzsm2++sY8fP9r79+9vElzRxnTMpLALS+Aj8osl8vyeyrQr/V+fwPV8PicrwBT6EHUA3toENfuo7OU0YyS85EVQfLyLF1QuXrkS1NBj6OoRBkqhFL+vNoNXLj0+PtpoNLLFYtHBEpjb4OTX27dv7e3bt1KDF9U25MApWzelYWSQGPH8OF6k7Ou67qiGLpfL5w2AqNETCKpok30sPihqRKTy2MhmqdJmBk94ir755hv78ssvE17Bz0Okq1yIcguo1nVtvppkNO2TycQ+fvxoHz9+tIeHh45Qlq1AZL6VGIWbS/KpVwkrnD+2eniYL5eLjUajToOptm2tdPPvyNBjf25r1hcWqTCNY2EVEqk+A5z08e9tmsZWq5X99a9/tePxaE9PTx2dgT+PGT8mlHDCttut/fTTTzYcDlPnTbeInA7m/LoTZOwOo3K1HL5BjMRKZ5U5RGV0LoLCVjWj0cg2m42dTqfkEko8PQ6ClJ9SG4CTFUxCqMRJLn8fsX44hv/85z82Ho/t3bt39vT0ZOfzuZPt8g2Ai5ir9vGNxCdOjccnc7vd2g8//GBFUdh6vb5h5WazmRVFkbSTPJaorgC/T4leGOzhZlel6Vym3ratjUajBPRTcaj/53Q6vYnvlc9X1Tw5LNCnsuWBcg6ew6h//vOfKdvogBA3gdI15j6L2TvF6jHj6d08eB6qqrJvvvnG6rq2H3/80ZbL5Q0oVJlXThMrMQlrJllWx+6DtY9t26YsoYPoIZoJ7JEbMVY5ti0nwuTkiWK2nNRBkz2ZTGyxWNycYG+Vys/B2FmVl+XUOWhyVeZSpWN5wh2bIJnDTa9U+KiqozgyQFwRFb6oSiZ059gAMymCfGe4egcnU1GcESUZDYw7kESly6rJw/l8tj/96U+22+3su+++k/42om+jvn8Rr99X94d/5kaYPkeHw8H+9a9/2XQ6TU0vPV1clmVi5fb7fW/TB6VC4p5AUSfXKA/ifQp8zVNdgNenI9qPkjLKX7IuPurioWrxVaoVZU7ffvutDQYDm8/nlqtl5LHhaYmaODKxpXL9GAarDcWfsd/vbblcpnJvfLfRaJTK55yKVhY3IqIi6xm5VWy84e9eVVWKdkrfTd54IOpEGZUtMUGEZicqcmBLgKbVuQh/OW+Z9t1333W0hgrxRp/HYaoytRhD89hUY0iuWeBwTG3Q0+lkr6+v6fmLxcI+fPhgm83Gfv755xSJMf7hpJhqapWzIPxOvtZt237WBHJm7J48uiIrlComCoEUIsZCUew+ggWWub44qh4hkorj5Kl4H8uz2TJhroK7lUZ0uP/ZS+q8NNwrhI/Ho/3yyy/SKubo9ahcTrXDZxDZtq0N3Tep7FfUCJonCZUmyryyKe5rxcKgyReeFcecgeOxMIHD1icaC5pNVSfJERFHC6qFjurA4l1APW/Pc8RiD6y8Vhb4HlzDVmvojQc6JcPEnSsNXh9B5C/uL6nSxrmmCqpejtO5yhqoTKBqOq1MJfcGwA2FixlpFKOmknyC/Tnr9bqjl1SSfC7OURgod2VMpIN0fFWi2eXYkxdN9aTJJWFUzV8uWuC4FjckM4ZRkiWXjkZlLH6WWlgUuJ5Op5s5wGiAMcY9m2AwGNhms7GffvrJ5vO5LZdLKaHHknyl+mG2U9HFqtWvg/6SgQTGieoyBv4QlexQdWgsBlVsHy+a6nkTpWijsA+tgCJSfOH9RKCF8EnCfAEjcUzecASB4FBxCOfz2Z6enmy5XIbKKAdseEVM1KJXsYaROAf0C+VNOOSnA82OYth4QfvKnnIl3oo8Yl5A8d3qciYOz9j/4+8fPnywtm3t06dPYbNJb9TEuQDFGCr3qe4pYHenzDluOi/66NMWqjnCMfszXPMxVHIuJaDgU88Lyrl9lk0pWravSZOipZX1iEIh1WeIy8j++Mc/2rt37zob5i9/+Yu9efMmxfGYUWM6XJVzRxFErhZBgUzPVXg1MfdaUA0gmAuJtJZwZU0pmaNIY8YxMwMl3iSqzInDtIjUQD+NUYYCVaoalyMb9e9///vfb3ICP/74ox0OBxsOh/bnP//ZvvvuO1utVimdiu3yFcmk4vGcDEyFocj6cTpYpYdz8jAFpr3DSMlgSBVH8I5V3b8UMkZRI4d47ttQXaNEoz4ZKGTEujj+xWxjdLWN/9mrnvH7PIEzHA7t+++/t6ZprK7rRON++eWX9vT0ZKvV6qZzuYPG6OJIRSQp8KzawOKBVA20ouqoTjEo0P2DweC3W8OiFit9SQYEWHxrBloJVMx4MYdvvijs5CSN6tatiis5KuCESFQMwwLO6/Vqz8/PKWxaLpf21Vdf2ddff935P3w/DN0QtEUWLFfYij6c8QBGNFHSTV31w1xI6R0mMPnDk6PoUMwaMv8eTSbHuXhd6n6/T63Trtdr6nRRlmXKq/PNWhENnLsoMkoOcRcPlGe7fM2tw7fffmur1aqzkeu67txxyFp+VgZxqjfXtj833qiLisIFLCsbDoefK4PQz6LWTlXiRMSL6mad6zjuz/nw4UNqjb5YLOzt27epIcVkMrGqquz5+TnRpNgSjYWbDNhU+baiVVWXMt/MHP7t93v74YcfOnODdyqrOgB2P6p1m7pfKMfwKc0gWjoFNPH5/n2lDz7qzRu1M3HFMJssjKXV9XH4fGfDvIs2K1mc+mT1S9QyTlX9qMZXbNX4NCnwxBskYt0U6IpOqNoErDFQtRSKEIoSUMql4zNKVI0yv85EB1fBqElFLgE3QVQfuFwuOy3QvQml3yh2PB5tt9vdtJFXyZwPHz4kda/n5r///nvJYURavQitRz2Vo43FFoIvlc718EdXzCrhnKYhCuf5Kh/8zBIJBqXaiQonUQnLDCBe8Ij6PA5z/FQ4BtlsNqkhRV3X9t///je1qOGaObYsZpawgn+/X7qUaxAZ9SpWrKfCRlFDZgav6FZyIDC3WH3C0qgRVC4LW+IV7JiocGsQ5feRo+b+OyigZI2Ain85MnAFMHbQVoWYLBnf7Xa23++TyDOq2GVwmkue5Pj9SHmj7jFWlkOF3SpiUalsdb08W6Xo4quOK+eXUehU7XjuUKGUQmx6o4nHGN7DySipoZA6jo1Lzxj5Rr4wEoIq/35P7X5UnMJzGgFCdVpz4bmy3HiAWQ/gn1MyEMKya9XESN0BHHX1iLpx5nwZRwxsrlk+heCQQafKOjIzqQQUTMsqnkQdHLWJIqAYbRw0/4zq++4GRveIa4J9gnAtzufz5zCQrxyNBAfRtaROK7JQgweh2DA+obw4yuRyiKbAmbe25WtquPBC1R2quFkBPEVDR907VPUuz4OqnVCp+JzVUdfVMW2P710q/R/XnDMAyl1IpGJgpdRljkC1heer3DHJxI2YFOePqV60ZNyePmqujIvIUvMINHI4misHj274VMmbeyMOjBpUcgnnpm3b35pFs89TDQ4RJGKygs04mxp1kll5rFgsjCjw55TPYyHlzYvSFfKRikaNQ+kf7uldFNVERh1B1FgiU88/E3USVXON71Fyu1a+sJHboirqFHco07C4ee5pdcIhFPtADFm9OJSRME8IF22qhheRwkhpJVU4qWRyUcZPAVyOTriXT1RxHc1hdKkF/l8qDkV5U0Qm5O74UbsZJx19cZ9ciSMNJn4Y8CgaV4E0Vvuo+r9IucMKKRaV8viQ94hYuYgLUPqLaIMqljJXycQ5m+v1+pkH8ELBXK99VQShysQU2ENAGCUqolIybHTI2r2ojDsq4+IcRVSmpWTZWLeg5GdcFNt3e6dqO8/AOXcJBrfr442jxoAZRD8Upep8He20qMqHVbjYPFLRsDnyRWUhWX+HJ00JKRR6jpizHMOmQF6OGIquuFPm+vemhu9RPXEndbd6qgQ/9QfwH4yuU8stvAJxDIByeepIIBFZiqjMC8eGiS2+kCqaVMVrRGPmLGOkQFI0sYpU+m4qVcomfAa/nyLGVFrYN0ip2r2xsvXmssGgxRuqilUVCw5Y8QlKIJmbVL+N0wkirgdkd6FSshwb9/nsXDvZvqIM1UcwKrfrE3qqht2RNVRVRe4KS6xcjV5E9eBVSRHuAaTQOde+K8CV09Mz2VEUhX311Ve22+3s5eUl1DKiKeT7CCIAmMv65ZIykc+/B7UrwWxf63ylKFYVUS4yLYoiXWBdeqjG3bE4BMtJxHjCOe2p+HgGJBGAi7qH+vdVVZVu3PYaO7QyKu7nEDcqCv09JjqSzvWJXxXax0qg6OLN6Fq4SCugoqK6rq3EzlH4gGjxlXiRlSxR2ZJqO6N6/uViVwasl8vFnp6eUvrZXYK6twdZRSVAUQg9KtDM5RlyTF/OiiiNAja84LsVVBeQHPDFNUobwGvF8Yvr4SNRJWfcUMjQNwGK31d3BEcnxuldNO+uK4hy9pxhU1fZRMUhCh/0RS8qNOy70DraCEx5K7wRqaT4GS5tL8vSht4XL+nEodWp6qun/FtEVXJcmruOViUz7hVEKCTvZg41hMqn8wmLFiPXJY0roFV003dbiapm5iwq9xlSBFhUiIMXgHhziF/HPEwdI1AIijtG3UjJiD2K9bnIUXHYSrBxT8UrdtbKNV7Kxd65f0MxSw6kjkajpG7OJWByBTAqP8CAMAoh1cbmZ/lt706hpwsjfACOCvF+Geb4FVDDU6dSyhHTpvxylAlD369YQdWbUJnqKOLIMYcMYplg8hYy3jDS9YxKvxhFBSqncE+95b38AY+j0ybOY2inObFYg5tF5VDy7yE41G5lV6C6hUfAUNXvRT0M2R+r5JdyWYqS9XE0TZNKyTysvsfUR+xkFMfnXGFOBIpaSrdq3uByiD1lPUbMceqqrRmb+SjH3vcrwheKo1cNqxEdqz7B3JQ6QtC5tiyqZOt8Ptt6vU79f9R7KCwUldRFSap7Fj4ShvqzveAmrTveTOFuICpsiDaDMrNRWzmVD1d3DnCLWbUYSpiRk3vnJOARWo+IHbZOrkC+p01LBDKjjmdRoqyvJ5HKRzRNk3I1g8Hg840hTqhgtkvJm3Pp29yt2arFuco55HrxR9agj77NTaA6QUgcKUsX3R8YgVfl76PkUK4WIbpmPqdm4s3tEY/7/4QBMJTZ7Xb28PDQAYNcsKAaL0R1A4rDz5n7KL2r0tT3mMSofCxqdhHJp3MW5B5iJ9rYUeY191m5cJjdMeZo/E5h0gj+NkF1XSc3wFe4YciF+YEoXle7mJMYkUmMmlUpsibCGSqppNLXCjhFobA6ibnCE/WluPvIGuQkYQyGcyGv/7lpms4NsKk83L/cDex2O5tMJp2SJoxVc02fVLMGJpSiiWYqNgeaIq18X46dpdNqQXONnbiqKZJ5Ky5enWKlpVTRj5KeM15T7tijG7/C9+Zyb5zwtm1tPB6nDaAWgAs91WlU1Tw8aWweuQeuyoJFDFvuPh3+d59kLC9jNTKGhHi6WFiBCTPmKaJ6h5wkLHJBCnQyDxM9A83/aDS6vZ+YpVIOEA6Hw02Ha97BUf/AiJDgMrH5fJ4aJHJ+PufjVReNnFtRVCu+W45lU3oFZAlzl0UpU50Doip05HSuqrrKVWYNh0M7HA6J6r/BReyf/V6e3W4X1qlH9fY5lk0t0HQ6tTdv3nQuprynK7mimqN2qY58lSI2pwdkqlbpDFi4mqNpVYlYdFCiSuZc7iWnMt7tdlbX9U29x2Aw+CwI4YUejUbWNE26RURl9iKdWa6aGF+wbVt7eXnpXFDJNQiRHu6epBTToEhVq7Erqll1GlWtc90VcVCcmwAACrxJREFUcL2EqkTKZRBzQFCRT9GB8Dkuy9Kapkl3QWFpXcIBKtvlzRk2m83NzlftYLGtKcf8zA7iRluv1/by8pImq67rTtuZnNQqyjoq/psxB/t9ZX1UTWOuKIOtjGoBn5PC33PrKiuBVM9F7u+42WzS/UBSpqZiXu9rb/a5QyXX1qnMH19+hKlYXBQmSBCFs8o36uARsWtoPXCRlannTF/fla7chk3VCCpuoS+TmOt6nsMG7Io4GVZVVSqv9w2AUYY/o1SXGPnkTSYT2263aTPwSWFTGpV95+hf1P+rCc6FjSpe9uew9IuRvVqAqL8P9zJWdDdrHVUxS870MyBFF8J4Symv2PWWZWmfPn36LesHFqkTskdKF9T3bzab1C2rz4z1UZJ9SFhlBXMKl6jxgqKwOcyMmLk+di66mSPi4/siDH+uK7F4kRWNzkQdvmNVVbZerztrGLahy+n9zMym06nt9/tOKzmFUrmnPi+OuiRSmWVG50p8krs9O6pEVmxlpFKK8EYkic/5dNVeNqoSqus69fCNGL7IdWC3Fr8BHq+miSKPYU7m5AObTCa2Wq06N4pHcW7OOkSMW8TIqYxWdJ2NUteoNHJkbfqijOhEq8ZPqr5PYQR8Vl3XNp1OO4DNDxsKXyJq29+nLEtbrVZWlmVqvhX1D7xer583gKqwwZZxzgp6Sze+4p2JHvbj2EOPTZfKl0eFFLk7DJX5VUxkBEpzXEaEG/pqGThSyfVVwK5gLr9TuYic7tD5G2d08eq6CD+VuZOGoGg+n9vz87ONRqMU80aFnkwv50qjWHUU+SpFJed4dSX3UpEEbiZ1KUVfZjJK5UZ8Apd3I/D2Cx2jqMK1fCyju1wuKXez3W5tNptJt6jmpezrlIUuYjKZ2HK5tPfv33dMlCpcVNfAcZ4g0ujxhsmlaCPhQy4yyYlVuNlUbnHVpsuVdedqIvF6HRVq8vO5OqooCvvll19sOp3enPpcTeJQyb7xA/Dk+HWt7mOwQTKaV9XiPIcbchp8Zaa5aVVOcRRtLKWZU9fh3KO94xI0/gzuzqVOIp78XHdTzgU4abdcLq0sS5tOp507oHNjTyAwusJN9brx8isPDVkurnLUEUDknZm701eRK4rDiKIZhQ8Uq5kDsrmMmxqzN6pi8Mr1+pEWIddxDAmf5+dnO5/PNp1ObyKjHLk1GAw+9wiKZMiqD79fcbbdbq1pmrQJItZNycmia1lytQB48nM5/z7tnGqIpU5ZjuPIJXUUJ6HqF3jTYKgcye/w5Ltia7PZJL8fSe1yX8Mo/FKCD5y42Wxmq9UqScndEmB/2wikReRNn8lVdGjU0JHj9Rxaxw2YUzf16e+jcJjzFZFiKgqVOc+CiZ7VamXT6TTUL0YbIR1s1vb1vTzKyCeTiT0/P3d680Vl11wZpPLbOc38PVU2fRKzqJomB/b6yuD6tP+sqWQ3k0uW4S88YF7csVqtbDKZhAdC3aF4g/VyA4/MOJIX4/HYPn36FE6kMl8RSufIQW08NUG/pwVLpHO8J5uYk55xJBRtXGY7VSWVqkvgQtjn52cbj8dJ5BlhJqar+d6mYdSaVeW+Fdjy27D9/pwoFOpD9VGGL7rWJaex6xOM5iYqp8LN5e9VQUjUExA3nUr2cGYUw1JefGYEo45hkcCljKpflDhCoW7v6z8YDOz5+dnevHmTyqO4x4ACWmoDclu5HE6IFiXCNUq4mdMf5OoK1bWuOYzAvRhVG1hOqfv/1XVt+/3eXl5ebDabpZOv7nlmJXbOIpWR7+U+/1wQya3NncN+eXmxh4cHq+s6AURWDLPPUyxd1FiSFwzVRMpMcx1AdIVaX/dwRZnnupcoSZjqHRxlD/HZTvFuNpvO4vdZS9WxhX+mvAeJRxODcWxRFDYajWw4HNp6vbaHh4d0zx76H54wXxyWROcqd1XpuUoCRQ2ZFXGkZNX3CDgjyTdrG6LOnbzo3PK2qirbbDa22Wzs8fGxo0Jm85+7H5FTyGkDRL6PW8FGBQ58Unx3bjYbO5/PNpvNkjqIawNY0x6d4qhrR7Qhojau0QbpSwblqn4iV6O6nEXEjkqQ+aZ+eXmxpmns8fGxk91TafHcGDEqkMkg7sHTp2Pnxccd5pLv3W5n5/PZFovFjQZfgSN1+yX7RwVMWcmjJkmZXmVdVDzdF3bmLABzIuqwqXa9g8HAVquVtW1r8/m8c/Lv6Q+g6juVdH2owj9uL9ZHKnCrWD/ps9ksXQzl5ozJEG51rkIgJELUBY2KZ8iVb0Wtb6IoQOUT+qxErjsp5wkwDewxvl9mvVgskqRbnXh+h2itIkay7CNbOGd9j1XAD59Op3Y8Hu35+dlms5nNZrMOYo40dgzwVA6BrQbr6iNFM+sDI+4i14uP9ZN9rWf58xURVJalrddra5rGZrNZquML1TwBfZ/bqNgsItUF9PEAaNpzzYgVZ+9hYlVVtt/vrWkaWywWhjeWRrdps2nnhApLtSMBqQJeEXmUGwsveqT46esn7OJV7HjWtq09PT3ZYDCw+Xze6besOpfcE+Jx5MWHqCiKWz2A6pLdRyxwLaAqw/YXOxwOtlwubTqd2mw2kyVOqmBD5erZp6F5QyyTYxoVgRLJp7CiKCKeGIfkxJ0+9u12mzR8k8kkdWtTauWoiimX9IqIrMvl8tkF5KRPLFmKwoyopy6bYb8O1q2BcwaqVQuesoho6Us65W4fizaYAlJ9esIICPL1tNjy7XA4pBK8+XzeEXDyHCh53D2ZyQivpeqhCLhwL/uIo88lYlRxhZNGdV3b4XCw9XptVVUlgiMifBSC5jHeZLqCzmbMeEY99nJJHQaz7KZUHsRPddM09vr6mrR7KAePxDmRVcoplCOLgPihZFKGOeiI5eoTSOQ2B1LIzhhuNhsrisKm02mnjJk7fkeiFS5Nd1PN16hFt33mJGTKKkUdRqIWMd6Ea7fb2eVySQvPsvFIxaT+LZd3ENKvGzY3WYC+Xvi5+3RyjOE9HILr2cbjsZ1OJ3t9fbXdbmfT6TS5C9fKqVtKWCTCpEeuVWzU01+BwL7iFnUZtYtlmqZJal1vKslhncp9qL7DvQKP4F4mNP2dBhG5erbcxN3LDCr0GsXW4/HYRqORnc9ne319tfV6bePxONHKHisr3MGXQTGZpe7tU5MaXegUsYUM8HxDe/Vzasv+q16Pr7/Dkxm1z4k4GLbWag1yjGGHCu7jAiJFLg+QO4iwv1b4gusFPGw8nU623+/tf//7n5VlabPZrAOUONpgppEznNgGv09MosSuSrGMFul4PHbuPB4Oh+m0R00ocxRuX0kZ1yoii6i6qysLkiWC+pJDSqacawKVa7nGhEsiKn7lCxwnOIj0AhVPQPmFF03TdBZQET54jWr0/qq6B822T/7pdLLD4dBxU2VZdnw8/pzqtJbLQEYUL46Hay9YNa2ypZ0NoNQsfRyzMj0KZavFjSwJ3+zpP1NVVZpUpFAxjPJNgTeg4Wd7Qkq5O743gMeHoahvxuPxmGRaZVmmghnVERSf7xs10laouxiiu5zQEqhEUt9NJWbWZQL7Up4KKEZ3/+QAS3TTJpeFMRPpk435hsvlkjbCer3u+NeyLFPTiaIoUl0DXlLBp7pt29RV43g82vF4TKebGUH06RGhxuKPXIUx8wf3MH2clbw3UeSf+X/9B04mXw6cfAAAAABJRU5ErkJggg==";var ln=cn;function dn(e,t,n,r,i,o){var a=new j.Vector2(t.image.width,t.image.height),s=new j.Vector2(r.image.width,r.image.height),u=e.uniforms;e.setValues(c(c({},_t),{},{uniforms:c(c({},u),{},{renderMode:{value:o},treeIndexTextureSize:{value:a},transformOverrideTextureSize:{value:s},colorDataTexture:{value:t},transformOverrideIndexTexture:{value:n},transformOverrideTexture:{value:r},matCapTexture:{value:i}})})),e.uniformsNeedUpdate=!0}var fn=n(31),pn=n.n(fn),hn=function(){function e(){v(this,e),this._events={materialsChanged:new T.d},this._renderMode=H.Color,this.materialsMap=new Map,this._clippingPlanes=[]}return m(e,[{key:"clippingPlanes",get:function(){return this._clippingPlanes},set:function(e){this._clippingPlanes=e;var t,n=f(this.materialsMap.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.updateClippingPlanesForModel(r)}}catch(e){n.e(e)}finally{n.f()}this.triggerMaterialsChanged()}},{key:"on",value:function(e,t){"materialsChanged"===e?this._events.materialsChanged.subscribe(t):Object(T.l)(e,"Unexpected event '"+e)}},{key:"off",value:function(e,t){"materialsChanged"===e?this._events.materialsChanged.unsubscribe(t):Object(T.l)(e,"Unexpected event '"+e)}},{key:"addModelMaterials",value:function(e,t){var n=this,r=new F,i=new nn(t+1,r);i.build();var o=new un,a=new an(t+1,o);a.build();var s=pn()((function(){return n.updateMaterials(e)}),75,{leading:!0,trailing:!0}),u=function(){return n.updateTransforms(e)};r.on("changed",s),o.on("changed",u);var l=function(e,t,n,r,i){var o=new j.Texture(ln);o.needsUpdate=!0;for(var a=new j.ShaderMaterial({name:"Primitives (Box)",clipping:!0,clippingPlanes:t,extensions:{fragDepth:!0},vertexShader:wt.boxPrimitive.vertex,fragmentShader:wt.boxPrimitive.fragment,side:j.DoubleSide,uniforms:{inverseModelMatrix:{value:new j.Matrix4}}}),s=new j.ShaderMaterial({name:"Primitives (Circle)",clipping:!0,clippingPlanes:t,extensions:{fragDepth:!0},vertexShader:wt.circlePrimitive.vertex,fragmentShader:wt.circlePrimitive.fragment,side:j.DoubleSide,uniforms:{inverseModelMatrix:{value:new j.Matrix4}}}),u=new j.ShaderMaterial({name:"Primitives (Nuts)",clipping:!0,clippingPlanes:t,vertexShader:wt.nutPrimitive.vertex,fragmentShader:wt.nutPrimitive.fragment,side:j.DoubleSide}),l=new j.ShaderMaterial({name:"Primitives (Quads)",clipping:!0,clippingPlanes:t,vertexShader:wt.quadPrimitive.vertex,fragmentShader:wt.quadPrimitive.fragment,side:j.DoubleSide}),d=new j.ShaderMaterial({name:"Primitives (General rings)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.generalRingPrimitive.vertex,fragmentShader:wt.generalRingPrimitive.fragment,side:j.DoubleSide}),f=new j.ShaderMaterial({name:"Primitives (Cone)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.conePrimitive.vertex,fragmentShader:wt.conePrimitive.fragment,side:j.DoubleSide}),p=new j.ShaderMaterial({name:"Primitives (Eccentric cone)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.eccentricConePrimitive.vertex,fragmentShader:wt.eccentricConePrimitive.fragment,side:j.DoubleSide}),h=new j.ShaderMaterial({name:"Primitives (Ellipsoid segments)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.ellipsoidSegmentPrimitive.vertex,fragmentShader:wt.ellipsoidSegmentPrimitive.fragment,side:j.DoubleSide}),v=new j.ShaderMaterial({name:"Primitives (General cylinder)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.generalCylinderPrimitive.vertex,fragmentShader:wt.generalCylinderPrimitive.fragment,side:j.DoubleSide}),m=new j.ShaderMaterial({name:"Primitives (Trapezium)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.trapeziumPrimitive.vertex,fragmentShader:wt.trapeziumPrimitive.fragment,side:j.DoubleSide}),y=new j.ShaderMaterial({name:"Primitives (Torus segment)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0,derivatives:!0},vertexShader:wt.torusSegmentPrimitive.vertex,fragmentShader:wt.torusSegmentPrimitive.fragment,side:j.DoubleSide}),g=new j.ShaderMaterial({name:"Primitives (Spherical segment)",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},extensions:{fragDepth:!0},vertexShader:wt.ellipsoidSegmentPrimitive.vertex,fragmentShader:wt.ellipsoidSegmentPrimitive.fragment,side:j.DoubleSide}),b=new j.ShaderMaterial({name:"Triangle meshes",clipping:!0,clippingPlanes:t,extensions:{derivatives:!0},side:j.DoubleSide,fragmentShader:wt.detailedMesh.fragment,vertexShader:wt.detailedMesh.vertex}),x={box:a,circle:s,nut:u,generalRing:d,quad:l,cone:f,eccentricCone:p,sphericalSegment:g,torusSegment:y,generalCylinder:v,trapezium:m,ellipsoidSegment:h,instancedMesh:new j.ShaderMaterial({name:"Instanced meshes",clipping:!0,clippingPlanes:t,extensions:{derivatives:!0},side:j.DoubleSide,fragmentShader:wt.instancedMesh.fragment,vertexShader:wt.instancedMesh.vertex}),triangleMesh:b,simple:new j.ShaderMaterial({name:"Low detail material",clipping:!0,clippingPlanes:t,uniforms:{inverseModelMatrix:{value:new j.Matrix4}},side:j.FrontSide,fragmentShader:wt.simpleMesh.fragment,vertexShader:wt.simpleMesh.vertex})},_=0,w=Object.values(x);_<w.length;_++)dn(w[_],n,r,i,o,e);return c({},x)}(this._renderMode,this._clippingPlanes,i.overrideColorPerTreeIndexTexture,a.overrideTransformIndexTexture,a.transformLookupTexture);this.materialsMap.set(e,{materials:l,perModelClippingPlanes:[],nodeAppearanceProvider:r,nodeTransformProvider:o,nodeAppearanceTextureBuilder:i,nodeTransformTextureBuilder:a,updateMaterialsCallback:s,updateTransformsCallback:u}),this.updateClippingPlanesForModel(e)}},{key:"getModelMaterials",value:function(e){return this.getModelMaterialsWrapper(e).materials}},{key:"getModelNodeAppearanceProvider",value:function(e){return this.getModelMaterialsWrapper(e).nodeAppearanceProvider}},{key:"getModelNodeTransformProvider",value:function(e){return this.getModelMaterialsWrapper(e).nodeTransformProvider}},{key:"getModelDefaultNodeAppearance",value:function(e){return this.getModelMaterialsWrapper(e).nodeAppearanceTextureBuilder.getDefaultAppearance()}},{key:"setModelClippingPlanes",value:function(e,t){var n=this.materialsMap.get(e);if(void 0===n)throw new Error("Materials for model ".concat(e," has not been added, call ").concat(this.addModelMaterials.name," first"));n.perModelClippingPlanes=t,this.updateClippingPlanesForModel(e),this.triggerMaterialsChanged()}},{key:"updateClippingPlanesForModel",value:function(e){var t=this.materialsMap.get(e);if(void 0===t)throw new Error("Materials for model ".concat(e," has not been added, call ").concat(this.addModelMaterials.name," first"));var n=[].concat(s(t.perModelClippingPlanes),s(this.clippingPlanes));vn(t.materials,(function(e){e.clipping=!0,e.clipIntersection=!1,e.clippingPlanes=n}))}},{key:"setModelDefaultNodeAppearance",value:function(e,t){this.getModelMaterialsWrapper(e).nodeAppearanceTextureBuilder.setDefaultAppearance(t),this.updateMaterials(e)}},{key:"getModelBackTreeIndices",value:function(e){return this.getModelMaterialsWrapper(e).nodeAppearanceTextureBuilder.regularNodeTreeIndices}},{key:"getModelInFrontTreeIndices",value:function(e){return this.getModelMaterialsWrapper(e).nodeAppearanceTextureBuilder.infrontNodeTreeIndices}},{key:"getModelGhostedTreeIndices",value:function(e){return this.getModelMaterialsWrapper(e).nodeAppearanceTextureBuilder.ghostedNodeTreeIndices}},{key:"setRenderMode",value:function(e){this._renderMode=e;var t=e!==H.DepthBufferOnly;this.applyToAllMaterials((function(n){n.uniforms.renderMode.value=e,n.colorWrite=t}))}},{key:"getRenderMode",value:function(){return this._renderMode}},{key:"updateMaterials",value:function(e){var t=this.getModelMaterialsWrapper(e);t.nodeAppearanceTextureBuilder.needsUpdate&&t.nodeAppearanceTextureBuilder.build(),this.triggerMaterialsChanged()}},{key:"updateTransforms",value:function(e){var t=this.getModelMaterialsWrapper(e);if(t.nodeTransformTextureBuilder.needsUpdate){var n=t.nodeTransformTextureBuilder,r=t.materials;n.build();var i=n.transformLookupTexture,o=new j.Vector2(i.image.width,i.image.height);vn(r,(function(e){e.uniforms.transformOverrideTexture.value=i,e.uniforms.transformOverrideTextureSize.value=o}))}this.triggerMaterialsChanged()}},{key:"getModelMaterialsWrapper",value:function(e){var t=this.materialsMap.get(e);if(void 0===t)throw new Error("Model ".concat(e," has not been added to MaterialManager"));return t}},{key:"applyToAllMaterials",value:function(e){var t,n=f(this.materialsMap.values());try{for(n.s();!(t=n.n()).done;)vn(t.value.materials,e)}catch(e){n.e(e)}finally{n.f()}}},{key:"triggerMaterialsChanged",value:function(){this._events.materialsChanged.fire()}}]),e}();function vn(e,t){t(e.box),t(e.circle),t(e.generalRing),t(e.nut),t(e.quad),t(e.cone),t(e.eccentricCone),t(e.sphericalSegment),t(e.torusSegment),t(e.generalCylinder),t(e.trapezium),t(e.ellipsoidSegment),t(e.instancedMesh),t(e.triangleMesh),t(e.simple)}var mn=m((function e(){v(this,e)}));mn.Black=new j.Color("rgb(0, 0, 0)"),mn.White=new j.Color("rgb(255, 255, 255)"),mn.Cyan=new j.Color("rgb(102, 213, 234)"),mn.Blue=new j.Color("rgb(77, 106, 242)"),mn.Purple=new j.Color("rgb(186, 82, 212)"),mn.Pink=new j.Color("rgb(232, 64, 117)"),mn.Orange=new j.Color("rgb(238, 113, 53)"),mn.Yellow=new j.Color("rgb(246, 189, 65)"),mn.VeryLightGray=new j.Color("rgb(247, 246, 245)"),mn.LightGray=new j.Color("rgb(242, 241, 240)");var yn=m((function e(){v(this,e)}));yn.Red=new j.Color("rgb(235,0,4)"),yn.Green=new j.Color("rgb(46,164,79)");var gn=function(){function e(t,n,r,i){var o,a;v(this,e),this._lastFrameSceneState={hasBackElements:!0,hasInFrontElements:!0,hasGhostElements:!0,hasCustomObjects:!0},this._rootSectorNodeBuffer=new Set,this._outlineTexelSize=2,this._autoSetTargetSize=!1,this._debugRenderTimings=!1,this._uiObjects=[],this._deepFlushRendererArgs={buffer:new ArrayBuffer(4)},this._renderer=t,this._renderOptions=i,this._materialManager=r,this._orthographicCamera=new j.OrthographicCamera(-1,1,1,-1,-1,1),this._renderTarget=null,this._originalScene=n,this._cadScene=new j.Scene,this._cadScene.autoUpdate=!1,this._normalScene=new j.Scene,this._normalScene.autoUpdate=!1,this._inFrontScene=new j.Scene,this._inFrontScene.autoUpdate=!1,this._compositionScene=new j.Scene,this._compositionScene.autoUpdate=!1,this._fxaaScene=new j.Scene,this._fxaaScene.autoUpdate=!1,this._ssaoScene=new j.Scene,this._ssaoScene.autoUpdate=!1,this._ssaoBlurCombineScene=new j.Scene,this._ssaoBlurCombineScene.autoUpdate=!1,this._emptyScene=new j.Scene,this._emptyScene.autoUpdate=!1;var s=t.capabilities.isWebGL2,u=this.createOutlineColorTexture();this._inFrontRenderedCadModelTarget=bn(s,this.multiSampleCountHint,{stencilBuffer:!1}),this._inFrontRenderedCadModelTarget.depthTexture=new j.DepthTexture(0,0),this._inFrontRenderedCadModelTarget.depthTexture.format=j.DepthFormat,this._inFrontRenderedCadModelTarget.depthTexture.type=j.UnsignedIntType,this._normalRenderedCadModelTarget=bn(s,this.multiSampleCountHint,{stencilBuffer:!1}),this._normalRenderedCadModelTarget.depthTexture=new j.DepthTexture(0,0),this._normalRenderedCadModelTarget.depthTexture.format=j.DepthFormat,this._normalRenderedCadModelTarget.depthTexture.type=j.UnsignedIntType,this._ghostObjectRenderTarget=bn(s,this.multiSampleCountHint,{stencilBuffer:!1}),this._ghostObjectRenderTarget.depthTexture=new j.DepthTexture(0,0),this._ghostObjectRenderTarget.depthTexture.format=j.DepthFormat,this._ghostObjectRenderTarget.depthTexture.type=j.UnsignedIntType,this._customObjectRenderTarget=bn(s,this.multiSampleCountHint,{stencilBuffer:!1}),this._customObjectRenderTarget.depthTexture=new j.DepthTexture(0,0),this._customObjectRenderTarget.depthTexture.format=j.DepthFormat,this._customObjectRenderTarget.depthTexture.type=j.UnsignedIntType,this._compositionTarget=new j.WebGLRenderTarget(0,0,{stencilBuffer:!1}),this._compositionTarget.depthTexture=new j.DepthTexture(0,0),this._compositionTarget.depthTexture.format=j.DepthFormat,this._compositionTarget.depthTexture.type=j.UnsignedIntType,this._ssaoTarget=new j.WebGLRenderTarget(0,0,{stencilBuffer:!1}),this._ssaoTarget.depthTexture=new j.DepthTexture(0,0),this._ssaoTarget.depthTexture.format=j.DepthFormat,this._ssaoTarget.depthTexture.type=j.UnsignedIntType,this._ssaoBlurCombineTarget=new j.WebGLRenderTarget(0,0,{stencilBuffer:!1}),this._ssaoBlurCombineTarget.depthTexture=new j.DepthTexture(0,0),this._ssaoBlurCombineTarget.depthTexture.format=j.DepthFormat,this._ssaoBlurCombineTarget.depthTexture.type=j.UnsignedIntType,this._combineOutlineDetectionMaterial=new j.ShaderMaterial({vertexShader:Mt.vertex,fragmentShader:Mt.fragment,uniforms:{tFront:{value:this._inFrontRenderedCadModelTarget.texture},tFrontDepth:{value:this._inFrontRenderedCadModelTarget.depthTexture},tBack:{value:this._normalRenderedCadModelTarget.texture},tBackDepth:{value:this._normalRenderedCadModelTarget.depthTexture},tCustom:{value:this._customObjectRenderTarget.texture},tCustomDepth:{value:this._customObjectRenderTarget.depthTexture},tGhost:{value:this._ghostObjectRenderTarget.texture},tGhostDepth:{value:this._ghostObjectRenderTarget.depthTexture},tOutlineColors:{value:u},resolution:{value:new j.Vector2(0,0)},texelSize:{value:new j.Vector2(0,0)},cameraNear:{value:.1},cameraFar:{value:1e4},edgeStrengthMultiplier:{value:2.5},edgeGrayScaleIntensity:{value:.1}},extensions:{fragDepth:!0},defines:{EDGES:null!==(a=null===(o=this._renderOptions.edgeDetectionParameters)||void 0===o?void 0:o.enabled)&&void 0!==a?a:Z.edgeDetectionParameters.enabled}});var c=this.ssaoParameters(this._renderOptions),l=c.sampleSize,d=this.createKernel(l),f=c.sampleRadius,p=c.depthCheckBias;this._ssaoMaterial=new j.ShaderMaterial({uniforms:{tDepth:{value:this._compositionTarget.depthTexture},kernel:{value:d},sampleRadius:{value:f},bias:{value:p},projMatrix:{value:new j.Matrix4},inverseProjectionMatrix:{value:new j.Matrix4},resolution:{value:new j.Vector2}},defines:{MAX_KERNEL_SIZE:l},vertexShader:Tt.vertex,fragmentShader:Tt.fragment}),this._ssaoBlurCombineMaterial=new j.ShaderMaterial({uniforms:{tDiffuse:{value:this._compositionTarget.texture},tAmbientOcclusion:{value:this._ssaoTarget.texture},resolution:{value:new j.Vector2}},vertexShader:Et.vertex,fragmentShader:Et.fragment});var h=this.supportsSsao(c)?this._ssaoBlurCombineTarget.texture:this._compositionTarget.texture;this._fxaaMaterial=new j.ShaderMaterial({uniforms:{tDiffuse:{value:h},tDepth:{value:this._compositionTarget.depthTexture},resolution:{value:new j.Vector2},inverseResolution:{value:new j.Vector2}},vertexShader:St.vertex,fragmentShader:St.fragment,extensions:{fragDepth:!0}}),this.setupCompositionScene(),this.setupSsaoScene(),this.setupSsaoBlurCombineScene(),this.setupFxaaScene(),this._normalSceneBuilder=new _n(this._normalScene),this._inFrontSceneBuilder=new _n(this._inFrontScene)}return m(e,[{key:"renderOptions",set:function(e){var t=this.ssaoParameters(e),n=c({},t);this.setSsaoParameters(n),this._renderOptions=c(c({},e),{},{ssaoRenderParameters:c({},t)})}},{key:"debugRenderTimings",get:function(){return this._debugRenderTimings},set:function(e){this._debugRenderTimings=e}},{key:"addUiObject",value:function(e,t,n){this._uiObjects.push({object:e,screenPos:t,width:n.x,height:n.y})}},{key:"removeUiObject",value:function(e){this._uiObjects=this._uiObjects.filter((function(t){var n=t.object;return e!==n}))}},{key:"ssaoParameters",value:function(e){var t;return null!==(t=null==e?void 0:e.ssaoRenderParameters)&&void 0!==t?t:c({},Z.ssaoRenderParameters)}},{key:"antiAliasingMode",get:function(){var e=this._renderOptions.antiAliasing;return void 0===e?Z.antiAliasing:e}},{key:"multiSampleCountHint",get:function(){var e=this._renderOptions.multiSampleCountHint;return void 0===e?Z.multiSampleCountHint:e}},{key:"supportsSsao",value:function(e){return!Object(T.q)()&&(this._renderer.capabilities.isWebGL2||this._renderer.extensions.has("EXT_frag_depth"))&&e.sampleSize!==I.None}},{key:"renderDetailedToDepthOnly",value:function(e){var t={renderMode:this._materialManager.getRenderMode()},n=new T.j(this._renderer);this._materialManager.setRenderMode(H.DepthBufferOnly);try{n.setRenderTarget(this._renderTarget),this.setVisibilityOfSectors(se.d.Simple,!1),this.traverseForRootSectorNode(this._originalScene),this.extractCadNodes(this._originalScene),this.clearTarget(this._renderTarget);var r=this.splitToScenes(),i=r.hasBackElements,o=r.hasInFrontElements,a=r.hasGhostElements;i&&!a?this.renderNormalCadModelsFromBaseScene(e,this._renderTarget):i&&a&&(this.renderNormalCadModels(e,this._renderTarget),this._normalSceneBuilder.restoreOriginalScene()),o&&(this.renderInFrontCadModels(e),this._inFrontSceneBuilder.restoreOriginalScene())}finally{this._materialManager.setRenderMode(t.renderMode),n.resetState(),this.restoreCadNodes(),this.setVisibilityOfSectors(se.d.Simple,!0)}}},{key:"render",value:function(e){this.setupRenderTargetSpectorDebugging(),this._debugRenderTimings&&ut.a.debug("============== RENDER BEGIN ==============");var t=this._renderer,n=this._originalScene,r=new T.j(t),i={autoClear:t.autoClear,clearAlpha:t.getClearAlpha(),renderMode:this._materialManager.getRenderMode()};t.info.autoReset=!1,t.info.reset(),r.autoClear=!1;try{r.setRenderTarget(this._renderTarget),this.updateRenderSize(t),t.info.autoReset=!1,t.info.reset(),r.autoClear=!1,this.traverseForRootSectorNode(n),this.extractCadNodes(n),this.clearTarget(this._ghostObjectRenderTarget),this.clearTarget(this._compositionTarget),this.clearTarget(this._customObjectRenderTarget),t.setClearAlpha(0),this.clearTarget(this._normalRenderedCadModelTarget),this.clearTarget(this._inFrontRenderedCadModelTarget),t.setClearAlpha(i.clearAlpha);var o=c({},this._lastFrameSceneState),a=this.splitToScenes(),s=a.hasBackElements,u=a.hasInFrontElements,l=a.hasGhostElements,d=n.children.length>0;this._lastFrameSceneState={hasBackElements:s,hasInFrontElements:u,hasGhostElements:l,hasCustomObjects:d},s&&!l?this.renderNormalCadModelsFromBaseScene(e):s&&l?(this.renderNormalCadModels(e),this._normalSceneBuilder.restoreOriginalScene(),this.renderGhostedCadModelsFromBaseScene(e)):!s&&l&&this.renderGhostedCadModelsFromBaseScene(e),u&&(this.renderInFrontCadModels(e),this._inFrontSceneBuilder.restoreOriginalScene()),d&&this.renderCustomObjects(n,e),t.capabilities.isWebGL2&&(!s&&o.hasBackElements&&this.explicitFlushRender(e,this._normalRenderedCadModelTarget),!l&&o.hasGhostElements&&this.explicitFlushRender(e,this._ghostObjectRenderTarget),!u&&o.hasInFrontElements&&this.explicitFlushRender(e,this._inFrontRenderedCadModelTarget),!d&&o.hasInFrontElements&&this.explicitFlushRender(e,this._customObjectRenderTarget));var f=this.supportsSsao(this.ssaoParameters(this._renderOptions));switch(this.antiAliasingMode){case O.FXAA:this.renderComposition(e,this._compositionTarget),r.autoClear=i.autoClear,f&&(this.renderSsao(this._ssaoTarget,e),this.renderPostProcessStep("ssao-blur-combine",this._ssaoBlurCombineTarget,this._ssaoBlurCombineScene)),this.renderPostProcessStep("fxaa",this._renderTarget,this._fxaaScene);break;case O.NoAA:t.autoClear=i.autoClear,f?(this.renderComposition(e,this._compositionTarget),this.renderSsao(this._ssaoTarget,e),this.renderPostProcessStep("ssao-blur-combine",this._renderTarget,this._ssaoBlurCombineScene)):this.renderComposition(e,this._renderTarget);break;default:throw new Error("Unsupported anti-aliasing mode: "+this.antiAliasingMode)}}finally{r.resetState(),this._materialManager.setRenderMode(i.renderMode),this.restoreCadNodes(),this._debugRenderTimings&&ut.a.debug("=============== RENDER END ===============")}}},{key:"restoreCadNodes",value:function(){this._rootSectorNodeBuffer.forEach((function(e){e[1].add(e[0])})),this._rootSectorNodeBuffer.clear()}},{key:"extractCadNodes",value:function(e){var t=this;this._rootSectorNodeBuffer.forEach((function(n){if(n[1].parent!==e&&null!==n[1].parent&&n[1].parent.parent!==e)throw new Error("CadNode must be put at scene root");t._cadScene.add(n[0])}))}},{key:"setRenderTarget",value:function(e){this._renderTarget=e}},{key:"getRenderTarget",value:function(){return this._renderTarget}},{key:"setRenderTargetAutoSize",value:function(e){this._autoSetTargetSize=e}},{key:"getRenderTargetAutoSize",value:function(){return this._autoSetTargetSize}},{key:"clearTarget",value:function(e){this._renderer.setRenderTarget(e),this._renderer.clear()}},{key:"explicitFlushRender",value:function(e,t){this._renderer.setRenderTarget(t),this.renderStep("flushRender",this._emptyScene,e)}},{key:"splitToScenes",value:function(){var e=this,t={hasBackElements:!1,hasInFrontElements:!1,hasGhostElements:!1};this._rootSectorNodeBuffer.forEach((function(n){var r=n[1],i=e._materialManager.getModelBackTreeIndices(r.cadModelMetadata.modelIdentifier),o=e._materialManager.getModelInFrontTreeIndices(r.cadModelMetadata.modelIdentifier),a=e._materialManager.getModelGhostedTreeIndices(r.cadModelMetadata.modelIdentifier),s=i.count>0,u=o.count>0,c=a.count>0;t.hasBackElements=t.hasBackElements||s,t.hasInFrontElements=t.hasInFrontElements||u,t.hasGhostElements=t.hasGhostElements||c}));var n=t.hasBackElements,r=t.hasInFrontElements,i=t.hasGhostElements;return this._rootSectorNodeBuffer.forEach((function(t){var o=t[0],a=t[1],u=e._materialManager.getModelBackTreeIndices(a.cadModelMetadata.modelIdentifier),c=e._materialManager.getModelInFrontTreeIndices(a.cadModelMetadata.modelIdentifier),l=new j.Object3D;l.applyMatrix4(o.matrix),n&&i&&e._normalScene.add(l);var d=new j.Object3D;d.applyMatrix4(o.matrix),r&&e._inFrontScene.add(d);for(var f=[t[0]];f.length>0;){var p=f.pop(),h=p.userData.treeIndices;h?(r&&c.hasIntersectionWith(h)&&e._inFrontSceneBuilder.addElement(p,d),n&&!i||i&&u.hasIntersectionWith(h)&&e._normalSceneBuilder.addElement(p,l)):f.push.apply(f,s(p.children))}})),t}},{key:"renderNormalCadModels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._normalRenderedCadModelTarget;this._normalSceneBuilder.populateTemporaryScene(),this._renderer.setRenderTarget(t),this.renderStep("normal",this._normalScene,e)}},{key:"renderNormalCadModelsFromBaseScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._normalRenderedCadModelTarget;this._renderer.setRenderTarget(t),this.renderStep("normalCadModelsFromBaseScene",this._cadScene,e)}},{key:"renderInFrontCadModels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._inFrontRenderedCadModelTarget;this._inFrontSceneBuilder.populateTemporaryScene(),this._renderer.setRenderTarget(t),this._materialManager.setRenderMode(H.Effects),this.renderStep("infront",this._inFrontScene,e)}},{key:"renderGhostedCadModelsFromBaseScene",value:function(e){this._renderer.setRenderTarget(this._ghostObjectRenderTarget),this._materialManager.setRenderMode(H.Ghost),this.renderStep("ghosted",this._cadScene,e)}},{key:"renderCustomObjects",value:function(e,t){var n=e.autoUpdate;try{e.autoUpdate=!0,this._renderer.setRenderTarget(this._customObjectRenderTarget),this.renderStep("customobjects",e,t)}finally{e.autoUpdate=n}}},{key:"updateRenderSize",value:function(e){var t=new j.Vector2;return e.getSize(t),this._renderTarget&&this._autoSetTargetSize&&t.x!==this._renderTarget.width&&t.y!==this._renderTarget.height&&this._renderTarget.setSize(t.x,t.y),t.x===this._normalRenderedCadModelTarget.width&&t.y===this._normalRenderedCadModelTarget.height||(this._normalRenderedCadModelTarget.setSize(t.x,t.y),this._inFrontRenderedCadModelTarget.setSize(t.x,t.y),this._customObjectRenderTarget.setSize(t.x,t.y),this._ghostObjectRenderTarget.setSize(t.x,t.y),this._compositionTarget.setSize(t.x,t.y),this._ssaoTarget.setSize(t.x,t.y),this._ssaoBlurCombineTarget.setSize(t.x,t.y),this._combineOutlineDetectionMaterial.uniforms.texelSize.value=new j.Vector2(this._outlineTexelSize/t.x,this._outlineTexelSize/t.y),this._combineOutlineDetectionMaterial.uniforms.resolution.value=t,this._ssaoMaterial.uniforms.resolution.value=t,this._ssaoBlurCombineMaterial.uniforms.resolution.value=t,this._fxaaMaterial.uniforms.resolution.value=t,this._fxaaMaterial.uniforms.inverseResolution.value=new j.Vector2(1/t.x,1/t.y)),t}},{key:"renderComposition",value:function(e,t){this._combineOutlineDetectionMaterial.uniforms.cameraNear.value=e.near,this._combineOutlineDetectionMaterial.uniforms.cameraFar.value=e.far,this.renderPostProcessStep("composition",t,this._compositionScene)}},{key:"setSsaoParameters",value:function(e){var t,n=Z.ssaoRenderParameters;if(this._ssaoMaterial.uniforms.sampleRadius.value=e.sampleRadius,this._ssaoMaterial.uniforms.bias.value=e.depthCheckBias,e.sampleSize!==this.ssaoParameters(this._renderOptions).sampleSize){var r=null!==(t=null==e?void 0:e.sampleSize)&&void 0!==t?t:n.sampleSize,i=this.createKernel(r);this._fxaaMaterial.uniforms.tDiffuse.value=e.sampleSize!==I.None?this._ssaoBlurCombineTarget.texture:this._compositionTarget.texture,this._ssaoMaterial.uniforms.kernel.value=i,this._ssaoMaterial.defines={MAX_KERNEL_SIZE:r},this._ssaoMaterial.needsUpdate=!0}}},{key:"renderPostProcessStep",value:function(e,t,n){var r=this,i=this._renderer;if(i.setRenderTarget(t),this.renderStep(e,n,this._orthographicCamera),t===this._renderTarget){var o=i.getSize(new j.Vector2),a=new j.Vector2(i.domElement.clientWidth,i.domElement.clientHeight),s=new j.Vector2(o.x/a.x,o.y/a.y);i.autoClear=!1,this._uiObjects.forEach((function(e){var t=new j.Scene;t.add(e.object);var n=e.screenPos.clone().multiply(s),o=e.width*s.x,a=e.height*s.y;i.setViewport(n.x,n.y,o,a),i.clearDepth(),i.render(t,r._orthographicCamera)})),i.setViewport(0,0,o.x,o.y),i.autoClear=!0}}},{key:"renderSsao",value:function(e,t){this._ssaoMaterial.uniforms.inverseProjectionMatrix.value=t.projectionMatrixInverse,this._ssaoMaterial.uniforms.projMatrix.value=t.projectionMatrix,this.renderPostProcessStep("ssao",e,this._ssaoScene)}},{key:"renderStep",value:function(e,t,n){if(this._debugRenderTimings){this.deepFlushRenderer();var r=performance.now();this._renderer.render(t,n),this.deepFlushRenderer(),ut.a.log("Render stage '".concat(e,"' took ").concat(performance.now()-r," ms"))}else this._renderer.render(t,n)}},{key:"deepFlushRenderer",value:function(){var e=this._deepFlushRendererArgs.buffer,t=this._renderer.getContext(),n=this._renderer.getRenderTarget();t.flush(),t.finish(),null!==n&&this._renderer.readRenderTargetPixels(n,0,0,1,1,e)}},{key:"createOutlineColorTexture",value:function(){var e=new Uint8Array(32),t=new j.DataTexture(e,8,1);return xn(t.image.data,w.White,mn.White),xn(t.image.data,w.Black,mn.Black),xn(t.image.data,w.Cyan,mn.Cyan),xn(t.image.data,w.Blue,mn.Blue),xn(t.image.data,w.Green,yn.Green),xn(t.image.data,w.Red,yn.Red),xn(t.image.data,w.Orange,mn.Orange),t}},{key:"setupCompositionScene",value:function(){var e=this.createRenderTriangle(),t=new j.Mesh(e,this._combineOutlineDetectionMaterial);this._compositionScene.add(t)}},{key:"setupFxaaScene",value:function(){var e=this.createRenderTriangle(),t=new j.Mesh(e,this._fxaaMaterial);this._fxaaScene.add(t)}},{key:"setupSsaoScene",value:function(){var e=this.createRenderTriangle(),t=new j.Mesh(e,this._ssaoMaterial);this._ssaoScene.add(t)}},{key:"setupSsaoBlurCombineScene",value:function(){var e=this.createRenderTriangle(),t=new j.Mesh(e,this._ssaoBlurCombineMaterial);this._ssaoBlurCombineScene.add(t)}},{key:"createKernel",value:function(e){for(var t=[],n=0;n<e;n++){for(var r=new j.Vector3;r.length()<.5;)r.x=2*Math.random()-1,r.y=2*Math.random()-1,r.z=Math.random();r.normalize();var i=n/e;i=o(.1,1,i*i),r.multiplyScalar(i),t.push(r)}return t;function o(e,t,n){return e+(t-e)*((n=n<0?0:n)>1?1:n)}}},{key:"createRenderTriangle",value:function(){var e=new j.BufferGeometry,t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),n=new Float32Array([0,0,2,0,0,2]);return e.setAttribute("position",new j.BufferAttribute(t,3)),e.setAttribute("uv",new j.BufferAttribute(n,2)),e}},{key:"traverseForRootSectorNode",value:function(e){for(var t=[e];t.length>0;){var n=t.pop();if(n instanceof se.e){var r=n.parent;r.visible&&this._rootSectorNodeBuffer.add([n,r])}else n instanceof j.Group||t.push.apply(t,s(n.children))}}},{key:"setVisibilityOfSectors",value:function(e,t){this._originalScene.traverse((function(n){n instanceof se.f&&n.levelOfDetail===e&&(n.visible=t)}))}},{key:"setupRenderTargetSpectorDebugging",value:function(){}},{key:"assignSpectorJsMetadataToRenderTarget",value:function(e,t){var n=this._renderer.getRenderTarget();try{this._renderer.setRenderTarget(e);var r=this._renderer.getContext();r.getParameter(r.FRAMEBUFFER_BINDING).__SPECTOR_Metadata=t}finally{this._renderer.setRenderTarget(n)}}}]),e}();function bn(e,t,n){if(e&&t>1){var r=new j.WebGLMultisampleRenderTarget(0,0,n);return r.samples=t,r}return new j.WebGLRenderTarget(0,0,n)}function xn(e,t,n){e[4*t+0]=Math.floor(255*n.r),e[4*t+1]=Math.floor(255*n.g),e[4*t+2]=Math.floor(255*n.b),e[4*t+3]=255}var _n=function(){function e(t){v(this,e),this.buffer=[],this.temporaryScene=t}return m(e,[{key:"addElement",value:function(e,t){this.buffer.push({object:e,parent:e.parent,sceneParent:t})}},{key:"populateTemporaryScene",value:function(){this.buffer.forEach((function(e){return e.sceneParent.add(e.object)}))}},{key:"restoreOriginalScene",value:function(){var e;this.buffer.forEach((function(e){e.parent.add(e.object)})),this.buffer.length=0,(e=this.temporaryScene).remove.apply(e,s(this.temporaryScene.children))}}]),e}(),wn=n(6);function Mn(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};q.a.init(!1!==a.logMetrics,e,t,{constructorOptions:a});var s=a.renderOptions||{},u=new hn,c=new gn(i,o,u,s),l=Wt(n,r,i,u,new tn(c),a),d=function(e,t){var n=new Jt(e,t),r=new $t(t);return new Xt(n,r)}(n,r);return new en(l,c,d)}var Sn=n(19),Tn=function(){function e(t,n){switch(v(this,e),this._revealManager=n,t){case"cdf":this.addCadModel=function(t){return e.addCdfCadModel(t,n)},this.addPointCloudModel=function(t){return e.addCdfPointCloudModel(t,n)};break;case"local":this.addCadModel=function(t){return e.addLocalCadModel(t,n)},this.addPointCloudModel=function(){throw new Error("Local point cloud models are not supported")};break;default:Object(T.l)(t)}}return m(e,[{key:"revealManager",get:function(){return this._revealManager}}],[{key:"createLocalHelper",value:function(t,n,r){var i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Mn("local","local-dataSource-appId",new wn.h,new wn.f,e,t,n)}(t,n,r);return new e("local",i)}},{key:"createCdfHelper",value:function(t,n,r,i){var o=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.getDefaultRequestHeaders()["x-cdp-app"]||"unknown",o=new wn.c(e),a=new wn.a(e);return Mn(e.project,i,o,a,t,n,r)}(i,t,n,r);return new e("cdf",o)}},{key:"createCustomDataSourceHelper",value:function(t,n,r,i){return new e("cdf",Mn("custom-datasource","custom-datasource-app",i.getModelMetadataProvider(),i.getModelDataProvider(),t,n,r))}},{key:"addLocalCadModel",value:function(e,t){if(void 0===e.localPath)throw new Error("addLocalCadModel only works with local models");var n=new wn.g(e.localPath);return t.addModel("cad",n,{geometryFilter:e.geometryFilter})}},{key:"addCdfCadModel",value:function(e,t){if(-1===e.modelId||-1===e.revisionId)throw new Error("addCdfCadModel only works with local models");var n=new wn.b(e.modelId,e.revisionId,wn.e.RevealCadModel);return t.addModel("cad",n,{geometryFilter:e.geometryFilter})}},{key:"addCdfPointCloudModel",value:function(e,t){if(-1===e.modelId||-1===e.revisionId)throw new Error("addCdfPointCloudModel only works with local models");var n=new wn.b(e.modelId,e.revisionId,wn.e.EptPointCloud);return t.addModel("pointcloud",n)}}]),e}(),En={16:"shift",17:"ctrl",18:"alt",27:"escape",32:"space",37:"left",38:"up",39:"right",40:"down",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",81:"q",83:"s",87:"w"},kn=function(){function e(){var t=this;v(this,e),this.keys={},this._disabled=!1,this.addEventListeners=function(){t.clearPressedKeys(),window.addEventListener("keydown",t.onKeydown),window.addEventListener("keyup",t.onKeyup),window.addEventListener("blur",t.clearPressedKeys)},this.removeEventListeners=function(){window.removeEventListener("keydown",t.onKeydown),window.removeEventListener("keyup",t.onKeyup),window.removeEventListener("blur",t.clearPressedKeys)},this.onKeydown=function(e){e.metaKey||e.altKey||e.ctrlKey||e.keyCode in En&&(0===t.keys[En[e.keyCode]]&&(t.keys[En[e.keyCode]]=2),e.preventDefault())},this.onKeyup=function(e){e.keyCode in En&&(t.keys[En[e.keyCode]]=0)},this.clearPressedKeys=function(){Object.keys(En).forEach((function(e){t.keys[En[e]]=0}))},this.addEventListeners()}return m(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,e?this.removeEventListeners():this.addEventListeners()}},{key:"isPressed",value:function(e){return this.keys[e]>=1}},{key:"comsumePressed",value:function(e){var t=2===this.keys[e];return t&&(this.keys[e]=1),t}}]),e}(),An=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");function Pn(e,t,n){return new j.Vector2(t-e.offsetLeft,n-e.offsetTop)}function Cn(e,t){if(2!==t.length)throw new Error("getPinchInfo only works if touches.length === 2");var n=[t[0],t[1]].map((function(t){var n=t.clientX,r=t.clientY;return Pn(e,n,r)}));return{center:n[0].clone().add(n[1]).multiplyScalar(.5),distance:n[0].distanceTo(n[1]),offsets:n}}var On=Math.PI/360,In=10*On,Rn=function(e){l(n,e);var t=d(n);function n(e,r){var i;return v(this,n),(i=t.call(this)).enabled=!0,i.enableDamping=!0,i.dampingFactor=.25,i.dynamicTarget=!0,i.minDistance=.8,i.minZoomDistance=.4,i.dollyFactor=.99,i.minPolarAngle=0,i.maxPolarAngle=Math.PI,i.minAzimuthAngle=-1/0,i.maxAzimuthAngle=1/0,i.panDollyMinDistanceFactor=10,i.firstPersonRotationFactor=.4,i.pointerRotationSpeedAzimuth=On,i.pointerRotationSpeedPolar=On,i.enableKeyboardNavigation=!0,i.keyboardRotationSpeedAzimuth=In,i.keyboardRotationSpeedPolar=In,i.mouseFirstPersonRotationSpeed=2*On,i.keyboardDollySpeed=2,i.keyboardPanSpeed=10,i.keyboardSpeedFactor=3,i.pinchEpsilon=2,i.pinchPanSpeed=1,i.EPSILON=.001,i.minZoom=0,i.maxZoom=1/0,i.orthographicCameraDollyFactor=.3,i.lookAtViewTarget=!1,i.useScrollTarget=!1,i.zoomToCursor=!0,i.minDeltaRatio=1,i.maxDeltaRatio=8,i.minDeltaDownscaleCoefficient=.1,i.maxDeltaDownscaleCoefficient=1,i._temporarilyDisableDamping=!1,i._firstPersonMode=!1,i._reusableVector3=new j.Vector3,i._accumulatedMouseMove=new j.Vector2,i._target=new j.Vector3,i._viewTarget=new j.Vector3,i._scrollTarget=new j.Vector3,i._targetEnd=new j.Vector3,i._spherical=new j.Spherical,i._sphericalEnd=new j.Spherical,i._deltaTarget=new j.Vector3,i._keyboard=new kn,i._offsetVector=new j.Vector3,i._panVector=new j.Vector3,i._raycaster=new j.Raycaster,i._targetFPS=30,i._targetFPSOverActualFPS=1,i._isFocused=!1,i.update=function(e){var t=a(i),n=t._camera,r=t._target,o=t._targetEnd,s=t._spherical,u=t._sphericalEnd,c=t._deltaTarget,l=t.handleKeyboard,d=t.enableDamping,f=t.dampingFactor,p=t.EPSILON,h=t._targetFPS;if(!t.enabled)return!1;var v=Math.min(1/e,h);i._targetFPSOverActualFPS=h/v,l(),i._accumulatedMouseMove.lengthSq()>0&&(i.rotate(i._accumulatedMouseMove.x,i._accumulatedMouseMove.y),i._accumulatedMouseMove.set(0,0));var m=0;i._firstPersonMode?m+=i.calculateShortestDeltaTheta(u.theta,s.theta):m=u.theta-s.theta;var y=u.phi-s.phi,g=u.radius-s.radius;c.subVectors(o,r);var b=!1,x=d&&!i._temporarilyDisableDamping?Math.min(f*i._targetFPSOverActualFPS,1):1;return i._temporarilyDisableDamping=!1,Math.abs(m)>p||Math.abs(y)>p||Math.abs(g)>p||Math.abs(c.x)>p||Math.abs(c.y)>p||Math.abs(c.z)>p?(s.set(s.radius+g*x,s.phi+y*x,s.theta+m*x),r.add(c.multiplyScalar(x)),b=!0):(s.copy(u),r.copy(o)),s.makeSafe(),n.position.setFromSpherical(s).add(r),n.lookAt(i.lookAtViewTarget?i._viewTarget:r),b&&i.triggerCameraChangeEvent(),b},i.getState=function(){var e=a(i),t=e._target,n=e._camera;return{target:t.clone(),position:n.position.clone()}},i.setState=function(e,t){var n=e.clone().sub(t);i._targetEnd.copy(t),i._sphericalEnd.setFromVector3(n),i._target.copy(i._targetEnd),i._scrollTarget.copy(t),i._spherical.copy(i._sphericalEnd),i.update(1e3/i._targetFPS),i.triggerCameraChangeEvent()},i.setViewTarget=function(e){i._viewTarget.copy(e)},i.setScrollTarget=function(e){i._scrollTarget.copy(e)},i.triggerCameraChangeEvent=function(){var e=a(i),t=e._camera,n=e._target;i.dispatchEvent({type:"cameraChange",camera:{position:t.position,target:n}})},i.convertPixelCoordinatesToNormalized=function(e,t){return{x:e/i._domElement.clientWidth*2-1,y:t/i._domElement.clientHeight*-2+1}},i.onPointerDown=function(e){"mouse"===e.pointerType&&i.onMouseDown(e)},i.onMouseDown=function(e){if(i.enabled)switch(i._firstPersonMode=!1,i._sphericalEnd.copy(i._spherical),e.button){case j.MOUSE.LEFT:i.startMouseRotation(e);break;case j.MOUSE.RIGHT:e.preventDefault(),i.startMousePan(e)}},i.onMouseUp=function(e){i._accumulatedMouseMove.set(0,0)},i.onMouseWheel=function(e){if(i.enabled){e.preventDefault();var t=0;if(e.wheelDelta)t=-e.wheelDelta/40;else if(e.detail)t=e.detail;else if(e.deltaY){var n=An?1:40;t=e.deltaY/n}var r=i.convertPixelCoordinatesToNormalized(e.offsetX,e.offsetY),o=r.x,a=r.y,s=t<0,u=i._camera.isPerspectiveCamera?i.getDollyDeltaDistance(s,Math.abs(t)):Math.sign(t)*i.orthographicCameraDollyFactor;i.dolly(o,a,u,!1)}},i.onTouchStart=function(e){if(i.enabled)switch(e.preventDefault(),i._firstPersonMode=!1,i._sphericalEnd.copy(i._spherical),e.touches.length){case 1:i.startTouchRotation(e);break;case 2:i.startTouchPinch(e)}},i.onFocusChanged=function(e){i._isFocused="blur"!==e.type&&(i.isDescendant(i._domElement.parentElement,e.target)||document.activeElement===i._domElement),i._keyboard.disabled=!i._isFocused},i.isDescendant=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},i.onContextMenu=function(e){i.enabled&&e.preventDefault()},i.rotate=function(e,t){if(0!==e||0!==t){var n=(i._firstPersonMode?i.mouseFirstPersonRotationSpeed:i.pointerRotationSpeedAzimuth)*e,r=(i._firstPersonMode?i.mouseFirstPersonRotationSpeed:i.pointerRotationSpeedPolar)*t;i._firstPersonMode?(i._temporarilyDisableDamping=!0,i.rotateFirstPersonMode(n,r)):i.rotateSpherical(n,r)}},i.startMouseRotation=function(e){var t=Pn(i._domElement,e.clientX,e.clientY),n=function(e){var n=Pn(i._domElement,e.clientX,e.clientY),r=t.clone().sub(n);i._accumulatedMouseMove.add(r),t=n};window.addEventListener("pointermove",n,{passive:!1}),window.addEventListener("pointerup",(function e(){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",e)}),{passive:!1})},i.startMousePan=function(e){var t=Pn(i._domElement,e.clientX,e.clientY),n=function(e){var n=Pn(i._domElement,e.clientX,e.clientY),r=n.x-t.x,o=n.y-t.y;t=n,i.pan(r,o)};window.addEventListener("pointermove",n,{passive:!1}),window.addEventListener("pointerup",(function e(){window.removeEventListener("pointermove",n),window.removeEventListener("pointereup",e)}),{passive:!1})},i.startTouchRotation=function(e){var t=a(i)._domElement,n=Pn(t,e.touches[0].clientX,e.touches[0].clientY),r=function(e){if(1===e.touches.length){var r=Pn(t,e.touches[0].clientX,e.touches[0].clientY);i.rotate(n.x-r.x,n.y-r.y),n=r}},o=function(e){1!==e.touches.length&&u()},s=function(){u()},u=function(){document.removeEventListener("touchstart",o),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",s)};document.addEventListener("touchstart",o),document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",s,{passive:!1})},i.startTouchPinch=function(e){var t=a(i)._domElement,n=Cn(t,e.touches),r=Cn(t,e.touches),o=i._spherical.radius,s=function(e){if(2===e.touches.length){var a=Cn(t,e.touches),s=r.distance/a.distance;i._sphericalEnd.radius=Math.max(s*o,i.minDistance/5);var u=a.center.clone().sub(n.center);u.length()>i.pinchEpsilon&&(u.multiplyScalar(i.pinchPanSpeed),i.pan(u.x,u.y)),n=a}},u=function(e){2!==e.touches.length&&l()},c=function(){l()},l=function(){document.removeEventListener("touchstart",u),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",c)};document.addEventListener("touchstart",u),document.addEventListener("touchmove",s),document.addEventListener("touchend",c)},i.handleKeyboard=function(){if(i.enabled&&i.enableKeyboardNavigation&&i._isFocused){var e=a(i),t=e._keyboard,n=e.keyboardDollySpeed,r=e.keyboardPanSpeed,o=e.keyboardSpeedFactor,s=i.keyboardRotationSpeedAzimuth*(Number(t.isPressed("left"))-Number(t.isPressed("right"))),u=i.keyboardRotationSpeedPolar*(Number(t.isPressed("up"))-Number(t.isPressed("down")));if(0!==s||0!==u){i._firstPersonMode=!0;var c=a(i)._sphericalEnd,l=c.phi;c.phi+=u,c.makeSafe(),u=c.phi-l,c.phi=l,i.rotateFirstPersonMode(s,u)}var d=t.isPressed("shift")?o:1,f=!!t.isPressed("w")||!t.isPressed("s")&&void 0;void 0!==f&&(i.dolly(0,0,i.getDollyDeltaDistance(f,n*d),!0),i._firstPersonMode=!0);var p=Number(t.isPressed("a"))-Number(t.isPressed("d")),h=Number(t.isPressed("e"))-Number(t.isPressed("q"));0===p&&0===h||(i._firstPersonMode=!0,i.pan(d*r*p,d*r*h))}},i.rotateSpherical=function(e,t){var n=a(i)._sphericalEnd,r=j.MathUtils.clamp(n.theta+e,i.minAzimuthAngle,i.maxAzimuthAngle),o=j.MathUtils.clamp(n.phi+t,i.minPolarAngle,i.maxPolarAngle);n.theta=r,n.phi=o,n.makeSafe()},i.rotateFirstPersonMode=function(e,t){var n=a(i),r=n.firstPersonRotationFactor,o=n._reusableCamera,s=n._reusableVector3,u=n._sphericalEnd,c=n._targetEnd;o.position.setFromSpherical(u).add(c),o.lookAt(c),o.rotateX(r*t),o.rotateY(r*e);var l=c.distanceTo(o.position);o.getWorldDirection(s),c.addVectors(o.position,s.multiplyScalar(l)),u.setFromVector3(s.subVectors(o.position,c)),u.makeSafe()},i.pan=function(e,t){var n=a(i),r=n._domElement,o=n._camera,s=n._offsetVector,u=n._target;s.copy(o.position).sub(u);var c=Math.max(s.length(),i.panDollyMinDistanceFactor*i.minDistance);o.isPerspectiveCamera&&(c*=Math.tan(o.fov/2*Math.PI/180)),i.panLeft(2*e*c/r.clientHeight),i.panUp(2*t*c/r.clientHeight)},i.dollyOrthographicCamera=function(e,t,n){var r=i._camera;r.zoom*=1-n,r.zoom=j.MathUtils.clamp(r.zoom,i.minZoom,i.maxZoom),r.updateProjectionMatrix()},i.calculateNewRadiusAndTargetOffsetLerp=function(e,t,n,r){var o=a(i),s=o.dynamicTarget,u=o.minZoomDistance,c=o._raycaster,l=o._targetEnd,d=o._reusableCamera,f=Math.tan(j.MathUtils.degToRad(90-.5*i._camera.fov)),p=Math.sqrt(f*f+e*e+t*t)/f,h=r.length(),v=n>0;c.setFromCamera({x:e,y:t},d);var m=h+n;m<u&&!v&&(m=h,s?(d.getWorldDirection(r),l.add(r.normalize().multiplyScalar(Math.abs(n)))):n=0);var y=-n*p;return d.getWorldDirection(r),r.normalize().multiplyScalar(n),{targetOffset:c.ray.direction.normalize().multiplyScalar(y).add(r),radius:m}},i.clampedMap=function(e,t,n,r,i){return e<t?r:e>n?i:j.MathUtils.mapLinear(e,t,n,r,i)},i.calculateNewRadiusAndTargetOffsetScrollTarget=function(e,t){var n=a(i),r=n.minZoomDistance,o=n._reusableVector3,s=n._target,u=n._scrollTarget,c=n._camera,l=n.minDeltaRatio,d=n.maxDeltaRatio,f=n.minDeltaDownscaleCoefficient,p=n.maxDeltaDownscaleCoefficient,h=t.length(),v=e>0;v&&i.setScrollTarget(s);var m=o.subVectors(u,s),y=(new j.Vector3).subVectors(s,c.position),g=(new j.Vector3).subVectors(u,c.position),b=y.angleTo(g),x=m.clone().negate().angleTo(g.clone().negate()),_=e*(Math.sin(b)/Math.sin(x)),w=Math.abs(_/e),M=i.clampedMap(w,l,d,p,f);_*=M;var S=h+(e*=M);return S<r&&(i._temporarilyDisableDamping=!0,(u.distanceTo(s)<r||S<=0)&&(_=0,S=h)),{targetOffset:m.negate().normalize().multiplyScalar(v?0:_),radius:S}},i.dollyWithWheelScroll=function(e,t,n,r){var o=a(i),s=o._targetEnd,u=o._sphericalEnd,c=o.useScrollTarget,l=o.zoomToCursor,d=n<0,f=new j.Vector3,p=u.radius;if(l)if(c&&d){var h=i.calculateNewRadiusAndTargetOffsetScrollTarget(n,r),v=h.radius,m=h.targetOffset;p=v,f.copy(m)}else{var y=i.calculateNewRadiusAndTargetOffsetLerp(e,t,n,r),g=y.radius,b=y.targetOffset;p=g,f.copy(b)}else{var x=i.calculateNewRadiusAndTargetOffsetLerp(0,0,n,r),_=x.radius,w=x.targetOffset;p=_,f.copy(w)}s.add(f),u.radius=p},i.dollyPerspectiveCamera=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=a(i),s=o._reusableVector3,u=o._targetEnd,c=o._reusableCamera,l=o._sphericalEnd,d=o._camera;c.copy(d),c.position.setFromSpherical(l).add(u),c.lookAt(u);var f=s.clone().setFromSpherical(l);r?(c.getWorldDirection(f),u.add(f.normalize().multiplyScalar(-n))):i.dollyWithWheelScroll(e,t,n,f)},i.dolly=function(e,t,n,r){var o=a(i)._camera;o.isOrthographicCamera?i.dollyOrthographicCamera(e,t,n):o.isPerspectiveCamera&&i.dollyPerspectiveCamera(e,t,n,r)},i.getDollyDeltaDistance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a(i),r=n._sphericalEnd,o=n.dollyFactor,s=Math.pow(o,t),u=e?s:1/s;return Math.max(r.radius,i.panDollyMinDistanceFactor*i.minDistance)*(u-1)},i.panLeft=function(e){var t=a(i),n=t._camera,r=t._targetEnd,o=t._panVector;o.setFromMatrixColumn(n.matrix,0),o.multiplyScalar(-e),r.add(o)},i.panUp=function(e){var t=a(i),n=t._camera,r=t._targetEnd,o=t._panVector;o.setFromMatrixColumn(n.matrix,1),o.multiplyScalar(e),r.add(o)},i._camera=e,i._reusableCamera=e.clone(),i._domElement=r,i._spherical.setFromVector3(e.position),i._sphericalEnd.copy(i._spherical),r.addEventListener("pointerdown",i.onPointerDown),r.addEventListener("touchstart",i.onTouchStart),r.addEventListener("wheel",i.onMouseWheel),r.addEventListener("contextmenu",i.onContextMenu),r.addEventListener("focus",i.onFocusChanged),r.addEventListener("blur",i.onFocusChanged),window.addEventListener("pointerup",i.onMouseUp),window.addEventListener("pointerdown",i.onFocusChanged),i.dispose=function(){r.removeEventListener("pointerdown",i.onMouseDown),r.removeEventListener("wheel",i.onMouseWheel),r.removeEventListener("touchstart",i.onTouchStart),r.removeEventListener("contextmenu",i.onContextMenu),r.removeEventListener("focus",i.onFocusChanged),r.removeEventListener("blur",i.onFocusChanged),window.removeEventListener("mouseup",i.onMouseUp),window.removeEventListener("pointerdown",i.onFocusChanged)},i}return m(n,[{key:"calculateShortestDeltaTheta",value:function(e,t){var n=e%(2*Math.PI)-t%(2*Math.PI),r=Math.min(Math.abs(n),2*Math.PI-Math.abs(n));return r*((r===Math.abs(n)?1:-1)*Math.sign(n))}}]),n}(j.EventDispatcher),Nn=function(){function e(t,n,r,i){var o=this;v(this,e),this._events={cameraChange:new T.d},this._raycaster=new j.Raycaster,this.isDisposed=!1,this._onClick=void 0,this._onWheel=void 0,this._cameraControlsOptions=c({},e.DefaultCameraControlsOptions),this.automaticNearFarPlane=!0,this.automaticControlsSensitivity=!0,this._updateNearAndFarPlaneBuffers={cameraPosition:new j.Vector3,cameraDirection:new j.Vector3,corners:new Array(new j.Vector3,new j.Vector3,new j.Vector3,new j.Vector3,new j.Vector3,new j.Vector3,new j.Vector3,new j.Vector3)},this._calculateCameraFarBuffers={nearPlaneCoplanarPoint:new j.Vector3,nearPlane:new j.Plane},this._camera=t,this._domElement=n,this._inputHandler=r,this._modelRaycastCallback=i,this.setCameraControlsOptions(this._cameraControlsOptions),this._controls=new Rn(t,n),this._controls.minZoomDistance=e.DefaultMinZoomDistance,this._controls.addEventListener("cameraChange",(function(e){var t=e.camera,n=t.position,r=t.target;o._events.cameraChange.fire({camera:{position:n.clone(),target:r.clone()}})})),t||(this._camera=new j.PerspectiveCamera(60,void 0,.1,1e4),this._camera.position.x=30,this._camera.position.y=10,this._camera.position.z=50,this._camera.lookAt(new j.Vector3))}return m(e,[{key:"on",value:function(e,t){"cameraChange"===e?this._events.cameraChange.subscribe(t):Object(T.l)(e)}},{key:"off",value:function(e,t){"cameraChange"===e?this._events.cameraChange.subscribe(t):Object(T.l)(e)}},{key:"fitCameraToBoundingBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=e.getBoundingSphere(new j.Sphere),i=r.center,o=r.radius*n,a=new j.Vector3(0,0,-1);a.applyQuaternion(this._camera.quaternion);var s=new j.Vector3;s.copy(a).multiplyScalar(-o).add(i),this.moveCameraTo(s,i,t)}},{key:"cameraControlsEnabled",get:function(){return this._controls.enabled},set:function(e){this._controls.enabled=e}},{key:"keyboardNavigationEnabled",get:function(){return this._controls.enableKeyboardNavigation},set:function(e){this._controls.enableKeyboardNavigation=e}},{key:"cameraControls",get:function(){return this._controls}},{key:"setCameraTarget",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isDisposed){var r=n?e.DefaultAnimationDuration:0;this.moveCameraTargetTo(t,r)}}},{key:"setCameraControlsState",value:function(e){this._controls.setState(e.position,e.target)}},{key:"getCameraControlsState",value:function(){return this._controls.getState()}},{key:"getCameraControlsOptions",value:function(){return this._cameraControlsOptions}},{key:"setCameraControlsOptions",value:function(t){this._cameraControlsOptions=c(c({},e.DefaultCameraControlsOptions),t),this.teardownControls(!1),this.setupControls()}},{key:"moveCameraTo",value:function(e,t,n){var r=this;if(!this.isDisposed){var i=this._camera;n=null!=n?n:this.calculateDefaultDuration(t.distanceTo(i.position));var o=this.calculateAnimationStartTarget(t),a={x:i.position.x,y:i.position.y,z:i.position.z,targetX:o.x,targetY:o.y,targetZ:o.z},s={x:e.x,y:e.y,z:e.z,targetX:t.x,targetY:t.y,targetZ:t.z},u=new j.Vector3,c=new j.Vector3,l=this.createTweenAnimation(a,s,n),d=l.tween,f=l.stopTween;d.onUpdate((function(){r.isDisposed||(c.set(a.x,a.y,a.z),u.set(a.targetX,a.targetY,a.targetZ),r._camera&&r._controls.setState(c,u))})).onStop((function(){r._controls.setState(c,u)})).onComplete((function(){r.isDisposed||r._domElement.removeEventListener("pointerdown",f)})).start(U.a.now()),d.update(U.a.now())}}},{key:"moveCameraTargetTo",value:function(e,t){var n=this;if(!this.isDisposed)if(0!==t){var r=this._camera,i=this._controls;t=null!=t?t:this.calculateDefaultDuration(e.distanceTo(r.position));var o=this.calculateAnimationStartTarget(e),a={targetX:o.x,targetY:o.y,targetZ:o.z},s={targetX:e.x,targetY:e.y,targetZ:e.z},u=new j.Vector3,c=this.createTweenAnimation(a,s,t),l=c.tween,d=c.stopTween;l.onStart((function(){i.lookAtViewTarget=!0,i.setState(n._camera.position,e)})).onUpdate((function(){n.isDisposed||(u.set(a.targetX,a.targetY,a.targetZ),n._camera&&("zoomToCursor"===n._cameraControlsOptions.mouseWheelAction&&i.setScrollTarget(u),i.setViewTarget(u)))})).onStop((function(){i.lookAtViewTarget=!1,i.setState(n._camera.position,u)})).onComplete((function(){n.isDisposed||(i.lookAtViewTarget=!1,i.enableKeyboardNavigation=!0,i.setState(n._camera.position,u),n._domElement.removeEventListener("pointerdown",d))})).start(U.a.now()),l.update(U.a.now())}else this._controls.setState(this._camera.position,e)}},{key:"updateCameraNearAndFar",value:function(t,n){if(!this.isDisposed&&(this.automaticControlsSensitivity||this.automaticNearFarPlane)){var r=this._updateNearAndFarPlaneBuffers,i=r.cameraPosition,o=r.cameraDirection,a=r.corners;!function(e,t){if(8!==(t=t||xe()(0,8).map((function(e){return new j.Vector3}))).length)throw new Error("outBuffer must hold exactly 8 elements, but holds ".concat(t.length," elemnents"));var n=e.min,r=e.max;t[0].set(n.x,n.y,n.z),t[1].set(r.x,n.y,n.z),t[2].set(n.x,r.y,n.z),t[3].set(n.x,n.y,r.z),t[4].set(r.x,r.y,n.z),t[5].set(r.x,r.y,r.z),t[6].set(r.x,n.y,r.z),t[7].set(n.x,r.y,r.z)}(n,a),t.getWorldPosition(i),t.getWorldDirection(o);var s=this.calculateCameraNear(t,n,i),u=this.calculateCameraFar(s,i,o,a),c=n.min.distanceTo(n.max);n.containsPoint(i)&&(s=Math.min(.1,u/1e3)),this.automaticNearFarPlane&&(t.near=s,t.far=u,t.updateProjectionMatrix()),this.automaticControlsSensitivity&&(this._controls.minDistance=Math.min(Math.max(.02*c,.1*s),e.DefaultMinDistance))}}},{key:"updateCameraControlsState",value:function(e){this._controls.update(e)}},{key:"dispose",value:function(){this.isDisposed=!0,this._controls.dispose(),this.teardownControls(),Object(T.o)(this._events),this._inputHandler.dispose()}},{key:"calculateAnimationStartTarget",value:function(e){var t=this._raycaster,n=this._camera;t.setFromCamera(new j.Vector2,n);var r=e.distanceTo(n.position),i=t.ray.direction.clone().multiplyScalar(r);return t.ray.origin.clone().add(i)}},{key:"createTweenAnimation",value:function(e,t,n){var r=this,i=new U.a.Tween(e),o=function e(t){if(r.isDisposed)return document.removeEventListener("keydown",e),void i.stop();("keydown"!==t.type||r._controls.enableKeyboardNavigation)&&(i.stop(),r._domElement.removeEventListener("pointerdown",e),r._domElement.removeEventListener("wheel",e),document.removeEventListener("keydown",e))};return this._domElement.addEventListener("pointerdown",o),this._domElement.addEventListener("wheel",o),document.addEventListener("keydown",o),{tween:i.to(t,n).easing((function(e){return U.a.Easing.Circular.Out(e)})),stopTween:o}}},{key:"calculateCameraFar",value:function(e,t,n,r){var i=this._calculateCameraFarBuffers,o=i.nearPlane,a=i.nearPlaneCoplanarPoint;a.copy(t).addScaledVector(n,e),o.setFromNormalAndCoplanarPoint(n,a);for(var s=-1/0,u=0;u<r.length;++u)if(o.distanceToPoint(r[u])>=0){var c=r[u].distanceTo(t);s=Math.max(s,c)}return Math.max(2*e,s)}},{key:"calculateCameraNear",value:function(e,t,n){var r=t.distanceToPoint(n);return r/=Math.sqrt(1+Math.pow(Math.tan(e.fov/180*Math.PI/2),2)*(Math.pow(e.aspect,2)+1)),Math.max(.1,r)}},{key:"calculateNewTargetWithoutModel",value:function(e,t){var n=t.min.distanceTo(t.max);return this._raycaster.setFromCamera(e,this._camera),this._raycaster.ray.direction.clone().normalize().multiplyScalar(Math.max(this._camera.position.distanceTo(t.getCenter(new j.Vector3)),n)).add(this._camera.position)}},{key:"calculateNewTarget",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s,u,c;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.offsetX,o=t.offsetY,a=this.convertPixelCoordinatesToNormalized(i,o),s=a.x,u=a.y,e.next=7,this._modelRaycastCallback(i,o);case 7:return c=e.sent,e.abrupt("return",null!==(r=null===(n=c.intersection)||void 0===n?void 0:n.point)&&void 0!==r?r:this.calculateNewTargetWithoutModel({x:s,y:u},c.modelsBoundingBox));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"teardownControls",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];void 0!==this._onClick&&(this._inputHandler.off("click",this._onClick),this._onClick=void 0),void 0!==this._onWheel&&e&&(this._domElement.removeEventListener("wheel",this._onWheel),this._onWheel=void 0)}},{key:"handleMouseWheelActionChange",value:function(e){var t=this._controls;switch(null==e?void 0:e.mouseWheelAction){case"zoomToTarget":t.zoomToCursor=!1;break;case"zoomPastCursor":t.useScrollTarget=!1,t.zoomToCursor=!0;break;case"zoomToCursor":t.setScrollTarget(t.getState().target),t.useScrollTarget=!0,t.zoomToCursor=!0;break;case void 0:break;default:Object(T.l)(e.mouseWheelAction)}}},{key:"setupControls",value:function(){var t=this,n=!1,r=new j.Clock,i=function(){var e=u(p.mark((function e(n){var r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._controls.enableKeyboardNavigation=!1,e.next=3,t.calculateNewTarget(n);case 3:r=e.sent,t.setCameraTarget(r,!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var i=u(p.mark((function i(o){var a,s,u;return p.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r.getDelta()>e.DefaultMinimalTimeBetweenRaycasts&&(n=!1),a=!n&&o.deltaY<0,s="zoomToCursor"===t._cameraControlsOptions.mouseWheelAction,!a||!s){i.next=8;break}return n=!0,i.next=6,t.calculateNewTarget(o);case 6:u=i.sent,t._controls.setScrollTarget(u);case 8:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}();this._controls&&this.handleMouseWheelActionChange(this._cameraControlsOptions),this._cameraControlsOptions.changeCameraTargetOnClick&&void 0===this._onClick&&(this._inputHandler.on("click",i),this._onClick=i),void 0===this._onWheel&&(this._domElement.addEventListener("wheel",o),this._onWheel=o)}},{key:"convertPixelCoordinatesToNormalized",value:function(e,t){return{x:e/this._domElement.clientWidth*2-1,y:t/this._domElement.clientHeight*-2+1}}},{key:"calculateDefaultDuration",value:function(t){var n=125*t;return Math.min(Math.max(n,e.DefaultMinAnimationDuration),e.DefaultMaxAnimationDuration)}}]),e;var t}();Nn.DefaultAnimationDuration=300,Nn.DefaultMinAnimationDuration=300,Nn.DefaultMaxAnimationDuration=1250,Nn.DefaultMinDistance=.8,Nn.DefaultMinZoomDistance=.4,Nn.DefaultMinimalTimeBetweenRaycasts=.08,Nn.DefaultCameraControlsOptions={mouseWheelAction:"zoomPastCursor",changeCameraTargetOnClick:!1};var Dn=n(27),Ln=function(){function e(t){v(this,e),this._client=t}return m(e,[{key:"mapTreeIndicesToNodeIds",value:(c=u(p.mark((function t(n,r,i){var o,a=this;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s(Bn(i,e.MaxItemsPerRequest)).map(function(){var e=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.postByTreeIndicesRequest(n,r,t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.next=3,Promise.all(o);case 3:return t.abrupt("return",t.sent.flat());case 4:case"end":return t.stop()}}),t)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"mapNodeIdsToTreeIndices",value:(a=u(p.mark((function t(n,r,i){var o,a=this;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s(Bn(i,e.MaxItemsPerRequest)).map(function(){var e=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.postByNodeIdsRequest(n,r,t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.next=3,Promise.all(o);case 3:return t.abrupt("return",t.sent.flat());case 4:case"end":return t.stop()}}),t)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"determineTreeIndexAndSubtreeSizesByNodeIds",value:(o=u(p.mark((function e(t,n,r){var i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map((function(e){return{id:e}})),e.next=3,this._client.revisions3D.retrieve3DNodes(t,n,i);case 3:return e.abrupt("return",e.sent.map((function(e){return{treeIndex:e.treeIndex,subtreeSize:e.subtreeSize}})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"determineNodeAncestorsByNodeId",value:(i=u(p.mark((function e(t,n,r,i){var o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.revisions3D.list3DNodeAncestors(t,n,r,{limit:1e3});case 2:return o=e.sent,a=o.items.find((function(e){return e.id===r})),S()(void 0!==a,"Could not find ancestor for node with nodeId "+r),i=Math.min(a.depth,i),s=o.items.find((function(e){return e.depth===a.depth-i})),e.abrupt("return",(S()(void 0!==a,"Could not find ancestor for node with nodeId ".concat(r," at 'generation' ").concat(i)),{treeIndex:s.treeIndex,subtreeSize:s.subtreeSize}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"getBoundingBoxByNodeId",value:(r=u(p.mark((function e(t,n,r,i){var o,a,s,u,c;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.revisions3D.retrieve3DNodes(t,n,[{id:r}]);case 2:if(!((o=e.sent).length<1)){e.next=5;break}throw new Error("NodeId not found");case 5:if(void 0!==(a=o[0].boundingBox)){e.next=8;break}throw new Error("Node ".concat(r," doesn't have a defined bounding box"));case 8:return s=a.min,u=a.max,c=i||new j.Box3,e.abrupt("return",(c.min.set(s[0],s[1],s[2]),c.max.set(u[0],u[1],u[2]),c));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"postByTreeIndicesRequest",value:(n=u(p.mark((function t(n,r,i){var o,a;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.assert(i.length<=e.MaxItemsPerRequest),o="".concat(this._client.getBaseUrl(),"/api/v1/projects/").concat(this._client.project,"/3d/models/").concat(n,"/revisions/").concat(r,"/nodes/internalids/bytreeindices"),t.next=4,this._client.post(o,{data:{items:i}});case 4:if(200!==(a=t.sent).status){t.next=7;break}return t.abrupt("return",a.data.items);case 7:throw new Dn.HttpError(a.status,a.data,a.headers);case 8:case"end":return t.stop()}}),t,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"postByNodeIdsRequest",value:(t=u(p.mark((function t(n,r,i){var o,a;return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.assert(i.length<=e.MaxItemsPerRequest),o="".concat(this._client.getBaseUrl(),"/api/v1/projects/").concat(this._client.project,"/3d/models/").concat(n,"/revisions/").concat(r,"/nodes/treeindices/byinternalids"),t.next=4,this._client.post(o,{data:{items:i}});case 4:if(200!==(a=t.sent).status){t.next=7;break}return t.abrupt("return",a.data.items);case 7:throw new Dn.HttpError(a.status,a.data,a.headers);case 8:case"end":return t.stop()}}),t,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e;var t,n,r,i,o,a,c}();function Bn(e,t){var n,r;return p.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=0;case 1:if(!(n<e.length)){i.next=8;break}return r=Math.min(e.length-n,t),i.next=5,e.slice(n,n+r);case 5:n+=r;case 6:i.next=1;break;case 8:case"end":return i.stop()}}),_)}Ln.MaxItemsPerRequest=1e3;var Fn=function(){function e(){v(this,e)}return m(e,[{key:"mapTreeIndicesToNodeIds",value:function(e,t,n){return Promise.resolve(n)}},{key:"mapNodeIdsToTreeIndices",value:function(e,t,n){return Promise.resolve(n)}},{key:"determineTreeIndexAndSubtreeSizesByNodeIds",value:function(e,t,n){throw new Error("Not supported for local models")}},{key:"determineNodeAncestorsByNodeId",value:function(e,t,n,r){throw new Error("Not supported for local models")}},{key:"getBoundingBoxByNodeId",value:function(e,t,n,r){throw new Error("Not supported for local models")}}]),e}(),jn=function(){function e(t){v(this,e),this._metadataProvider=new wn.c(t),this._nodesApiClient=new Ln(t),this._modelDataClient=new wn.a(t)}return m(e,[{key:"getNodesApiClient",value:function(){return this._nodesApiClient}},{key:"getModelDataProvider",value:function(){return this._modelDataClient}},{key:"getModelMetadataProvider",value:function(){return this._metadataProvider}}]),e}(),zn=function(){function e(){v(this,e)}return m(e,[{key:"getNodesApiClient",value:function(){return new Fn}},{key:"getModelDataProvider",value:function(){return new wn.f}},{key:"getModelMetadataProvider",value:function(){throw new wn.h}}]),e}(),Un=function(){function e(t){var n,r,i,o,a,s,u,l,d=this;v(this,e),this._subscription=new W.Subscription,this._boundAnimate=this.animate.bind(this),this._events={cameraChange:new T.d,click:new T.d,hover:new T.d,sceneRendered:new T.d,disposed:new T.d},this._models=[],this._extraObjects=[],this.isDisposed=!1,this.latestRequestId=-1,this.clock=new j.Clock,this._clippingNeedsUpdate=!1,this._updateNearAndFarPlaneBuffers={combinedBbox:new j.Box3,bbox:new j.Box3},this.startPointerEventListeners=function(){d._mouseHandler.on("click",(function(e){d._events.click.fire(e)})),d._mouseHandler.on("hover",(function(e){d._events.hover.fire(e)}))},this._renderer=t.renderer||new j.WebGLRenderer,this._renderer.localClippingEnabled=!0,this._automaticNearFarPlane=null===(n=t.automaticCameraNearFar)||void 0===n||n,this._automaticControlsSensitivity=null===(r=t.automaticControlsSensitivity)||void 0===r||r,this.canvas.style.width="640px",this.canvas.style.height="480px",this.canvas.style.minWidth="100%",this.canvas.style.minHeight="100%",this.canvas.style.maxWidth="100%",this.canvas.style.maxHeight="100%",this._domElement=t.domElement||function(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","div");return e.style.width="100%",e.style.height="100%",e}(),this._domElement.appendChild(this.canvas),this.spinner=new le(this.domElement),this.spinner.placement=null!==(o=null===(i=t.loadingIndicatorStyle)||void 0===i?void 0:i.placement)&&void 0!==o?o:"topLeft",this.spinner.opacity=Math.max(.2,null!==(s=null===(a=t.loadingIndicatorStyle)||void 0===a?void 0:a.opacity)&&void 0!==s?s:1),this.camera=new j.PerspectiveCamera(60,void 0,.1,1e4),this.camera.position.x=30,this.camera.position.y=10,this.camera.position.z=50,this.camera.lookAt(new j.Vector3),this.scene=new j.Scene,this.scene.autoUpdate=!1,this._mouseHandler=new T.f(this.canvas),this._cameraManager=new Nn(this.camera,this.canvas,this._mouseHandler,this.modelIntersectionCallback.bind(this)),this._cameraManager.automaticControlsSensitivity=this._automaticControlsSensitivity,this._cameraManager.automaticNearFarPlane=this._automaticNearFarPlane,this._cameraManager.on("cameraChange",(function(e){var t=e.camera,n=t.position,r=t.target;d._events.cameraChange.fire(n.clone(),r.clone())}));var f=function(e){var t,n={internal:{}};n.internal={sectorCuller:e._sectorCuller};var r=function(e){switch(e=e||"fxaa"){case"disabled":return{antiAliasing:O.NoAA,multiSampleCount:1};case"fxaa":return{antiAliasing:O.FXAA,multiSampleCount:1};case"msaa2":return{antiAliasing:O.NoAA,multiSampleCount:2};case"msaa4":return{antiAliasing:O.NoAA,multiSampleCount:4};case"msaa8":return{antiAliasing:O.NoAA,multiSampleCount:8};case"msaa16":return{antiAliasing:O.NoAA,multiSampleCount:16};case"msaa2+fxaa":return{antiAliasing:O.FXAA,multiSampleCount:2};case"msaa4+fxaa":return{antiAliasing:O.FXAA,multiSampleCount:4};case"msaa8+fxaa":return{antiAliasing:O.FXAA,multiSampleCount:8};case"msaa16+fxaa":return{antiAliasing:O.FXAA,multiSampleCount:16};default:Object(T.l)(e,"Unsupported anti-aliasing mode: "+e)}}(e.antiAliasingHint),i=r.antiAliasing,o=r.multiSampleCount,a=function(e){var t=c({},Z.ssaoRenderParameters);switch(e){case void 0:break;case"medium":t.sampleSize=I.Medium;break;case"high":t.sampleSize=I.High;break;case"veryhigh":t.sampleSize=I.VeryHigh;break;case"disabled":t.sampleSize=I.None;break;default:Object(T.l)(e,"Unexpected SSAO quality mode: '".concat(e,"'"))}return t}(e.ssaoQualityHint),s={enabled:null!==(t=e.enableEdges)&&void 0!==t?t:Z.edgeDetectionParameters.enabled};return n.logMetrics=e.logMetrics,n.renderOptions={antiAliasing:i,multiSampleCountHint:o,ssaoRenderParameters:a,edgeDetectionParameters:s},n}(t);!0===t._localModels?(this._dataSource=new zn,this._cdfSdkClient=void 0,this._revealManagerHelper=Tn.createLocalHelper(this._renderer,this.scene,f)):void 0!==t.customDataSource?(this._dataSource=t.customDataSource,this._revealManagerHelper=Tn.createCustomDataSourceHelper(this._renderer,this.scene,f,t.customDataSource)):(this._dataSource=new jn(t.sdk),this._cdfSdkClient=t.sdk,this._revealManagerHelper=Tn.createCdfHelper(this._renderer,this.scene,f,t.sdk)),this.renderController=new ne(this.camera),this.startPointerEventListeners(),this.revealManager.setRenderTarget((null===(u=t.renderTargetOptions)||void 0===u?void 0:u.target)||null,null===(l=t.renderTargetOptions)||void 0===l?void 0:l.autoSetSize),this._subscription.add(Object(W.fromEventPattern)((function(e){return d.revealManager.on("loadingStateChanged",e)}),(function(e){return d.revealManager.off("loadingStateChanged",e)})).subscribe((function(e){d.spinner.loading=e.itemsLoaded!=e.itemsRequested,t.onLoading&&t.onLoading(e.itemsLoaded,e.itemsRequested,e.itemsCulled)}),(function(e){return q.a.trackError(e,{moduleName:"Cognite3DViewer",methodName:"constructor"})}))),this.animate(0),q.a.trackEvent("construct3dViewer",{constructorOptions:V()(t,["sdk","domElement","renderer","renderTargetOptions","onLoading","_sectorCuller"])})}return m(e,[{key:"canvas",get:function(){return this.renderer.domElement}},{key:"domElement",get:function(){return this._domElement}},{key:"renderer",get:function(){return this._renderer}},{key:"revealManager",get:function(){return this._revealManagerHelper.revealManager}},{key:"cadBudget",get:function(){return this.revealManager.cadBudget},set:function(e){this.revealManager.cadBudget=e}},{key:"pointCloudBudget",get:function(){return this.revealManager.pointCloudBudget},set:function(e){this.revealManager.pointCloudBudget=e}},{key:"models",get:function(){return this._models.slice()}},{key:"cadLoadedStatistics",get:function(){return this.revealManager.cadLoadedStatistics}},{key:"getVersion",value:function(){return"2.3.0"}},{key:"setLogLevel",value:function(e){"none"===e?this.setLogLevel("silent"):ut.a.setLevel(e)}},{key:"dispose",value:function(){if(!this.isDisposed){this.isDisposed=!0,void 0!==this.latestRequestId&&cancelAnimationFrame(this.latestRequestId),this._subscription.unsubscribe(),this._cameraManager.dispose(),this.revealManager.dispose(),this.domElement.removeChild(this.canvas),this.renderer.dispose();var e,t=f(this._models.values());try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(e){t.e(e)}finally{t.f()}this._models.splice(0),this.spinner.dispose(),this._events.disposed.fire(),Object(T.o)(this._events),this._mouseHandler.dispose()}}},{key:"on",value:function(e,t){switch(e){case"click":this._events.click.subscribe(t);break;case"hover":this._events.hover.subscribe(t);break;case"cameraChange":this._events.cameraChange.subscribe(t);break;case"sceneRendered":this._events.sceneRendered.subscribe(t);break;case"disposed":this._events.disposed.subscribe(t);break;default:Object(T.l)(e)}}},{key:"off",value:function(e,t){switch(e){case"click":this._events.click.unsubscribe(t);break;case"hover":this._events.hover.unsubscribe(t);break;case"cameraChange":this._events.cameraChange.unsubscribe(t);break;case"sceneRendered":this._events.sceneRendered.unsubscribe(t);break;case"disposed":this._events.disposed.unsubscribe(t);break;default:Object(T.l)(e)}}},{key:"setCameraControlsOptions",value:function(e){this._cameraManager.setCameraControlsOptions(e)}},{key:"getCameraControlsOptions",value:function(){return this._cameraManager.getCameraControlsOptions()}},{key:"getViewState",value:function(){return this.createViewStateHelper().getCurrentState()}},{key:"setViewState",value:function(e){var t=this.createViewStateHelper();return this.models.filter((function(e){return e instanceof ue})).map((function(e){return e})).forEach((function(e){return e.removeAllStyledNodeCollections()})),t.setState(e)}},{key:"addModel",value:(l=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t.localPath){e.next=2;break}throw new Error("addModel() only supports CDF hosted models. Use addCadModel() and addPointCloudModel() to use self-hosted models");case 2:return e.next=4,this.determineModelType(t.modelId,t.revisionId);case 4:e.t0=e.sent,e.next="cad"===e.t0?7:"pointcloud"===e.t0?8:9;break;case 7:return e.abrupt("return",this.addCadModel(t));case 8:return e.abrupt("return",this.addPointCloudModel(t));case 9:throw new Error("Model is not supported");case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"addCadModel",value:(s=u(p.mark((function e(t){var n,r,i,o,a;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._dataSource.getNodesApiClient(),r=t.modelId,i=t.revisionId,e.next=5,this._revealManagerHelper.addCadModel(t);case 5:return o=e.sent,a=new ue(r,i,o,n),e.abrupt("return",(this._models.push(a),this.scene.add(a),a));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"addPointCloudModel",value:(a=u(p.mark((function e(t){var n,r,i,o;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.localPath){e.next=2;break}throw new te("localPath is not supported");case 2:if(!t.geometryFilter){e.next=4;break}throw new te("geometryFilter is not supported for point clouds");case 4:return n=t.modelId,r=t.revisionId,e.next=8,this._revealManagerHelper.addPointCloudModel(t);case 8:return i=e.sent,o=new ce(n,r,i),e.abrupt("return",(this._models.push(o),this.scene.add(o),o));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"removeModel",value:function(e){var t=this._models.indexOf(e);if(-1===t)throw new Error("Model is not added to viewer");switch(this._models.splice(t,1),e.type){case"cad":var n=e;this.scene.remove(n),this.revealManager.removeModel(e.type,n.cadNode);break;case"pointcloud":var r=e;this.scene.remove(r),this.revealManager.removeModel(e.type,r.pointCloudNode);break;default:Object(T.l)(e.type,"Model type ".concat(e.type," cannot be removed"))}this.renderController.redraw()}},{key:"determineModelType",value:(o=u(p.mark((function e(t,n){var r,i,o;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._cdfSdkClient){e.next=2;break}throw new Error(this.determineModelType.name+"() is only supported when connecting to Cognite Data Fusion");case 2:return r=new wn.b(t,n,wn.e.AnyFormat),i=new wn.d(this._cdfSdkClient),e.next=6,i.getOutputs(r);case 6:return o=e.sent,e.abrupt("return",void 0!==o.findMostRecentOutput(wn.e.RevealCadModel)?"cad":void 0!==o.findMostRecentOutput(wn.e.EptPointCloud)?"pointcloud":"");case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"addObject3D",value:function(e){this.isDisposed||(this.scene.add(e),e.updateMatrixWorld(!0),this._extraObjects.push(e),this.renderController.redraw(),this.updateCameraNearAndFar(this.camera))}},{key:"removeObject3D",value:function(e){if(!this.isDisposed){this.scene.remove(e);var t=this._extraObjects.indexOf(e);t>=0&&this._extraObjects.splice(t,1),this.renderController.redraw(),this.updateCameraNearAndFar(this.camera)}}},{key:"addUiObject",value:function(e,t,n){this.isDisposed||this.revealManager.addUiObject(e,t,n)}},{key:"removeUiObject",value:function(e){this.isDisposed||this.revealManager.removeUiObject(e)}},{key:"setBackgroundColor",value:function(e){this.isDisposed||(this.renderer.setClearColor(e),this.spinner.updateBackgroundColor(e),this.requestRedraw())}},{key:"setClippingPlanes",value:function(e){this.revealManager.clippingPlanes=e,this._clippingNeedsUpdate=!0}},{key:"setSlicingPlanes",value:function(e){this.setClippingPlanes(e)}},{key:"getClippingPlanes",value:function(){return this.revealManager.clippingPlanes}},{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getCameraPosition",value:function(){return this.isDisposed?new j.Vector3(-1/0,-1/0,-1/0):this.camera.position.clone()}},{key:"getCameraTarget",value:function(){return this.isDisposed?new j.Vector3(-1/0,-1/0,-1/0):this._cameraManager.getCameraControlsState().target.clone()}},{key:"setCameraPosition",value:function(e){this.isDisposed||this._cameraManager.setCameraControlsState({position:e,target:this.getCameraTarget()})}},{key:"setCameraTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isDisposed||this._cameraManager.setCameraTarget(e,t)}},{key:"cameraControls",get:function(){return this._cameraManager.cameraControls}},{key:"cameraControlsEnabled",get:function(){return this._cameraManager.cameraControlsEnabled},set:function(e){this._cameraManager.cameraControlsEnabled=e}},{key:"loadCameraFromModel",value:function(e){var t=e.getCameraConfiguration();t?this._cameraManager.setCameraControlsState({position:t.position,target:t.target}):this.fitCameraToModel(e,0)}},{key:"fitCameraToModel",value:function(e,t){var n=e.getModelBoundingBox(new j.Box3,!0);this._cameraManager.fitCameraToBoundingBox(n,t)}},{key:"fitCameraToBoundingBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this._cameraManager.fitCameraToBoundingBox(e,t,n)}},{key:"requestRedraw",value:function(){this.revealManager.requestRedraw()}},{key:"enableKeyboardNavigation",value:function(){this._cameraManager.keyboardNavigationEnabled=!0}},{key:"disableKeyboardNavigation",value:function(){this._cameraManager.keyboardNavigationEnabled=!1}},{key:"worldToScreen",value:function(e,t){this.camera.updateMatrixWorld();var n=new j.Vector3;return t?Object(Y.a)(this.camera,e,n):Object(Y.b)(this.renderer,this.camera,e,n),n.x<0||n.x>1||n.y<0||n.y>1||n.z<0||n.z>1?null:new j.Vector2(n.x,n.y)}},{key:"getScreenshot",value:(i=u(p.mark((function e(){var t,n,r,i,o,a,s,u=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:this.canvas.width,n=u.length>1&&void 0!==u[1]?u[1]:this.canvas.height,!this.isDisposed){e.next=4;break}throw new Error("Viewer is disposed");case 4:return r=this.canvas,i=r.width,o=r.height,Gn(a=this.camera.clone(),t,n),this.renderer.setSize(t,n),this.renderer.render(this.scene,a),this.revealManager.render(a),s=this.renderer.domElement.toDataURL(),e.abrupt("return",(this.renderer.setSize(i,o),this.renderer.render(this.scene,this.camera),this.requestRedraw(),s));case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getIntersectionFromPixel",value:(r=u(p.mark((function e(t,n,r){var i,o,a,s,u,c,l,d,h,v,m,y,g,b,x,_,w,M;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getModels("cad"),o=this.getModels("pointcloud"),a=i.map((function(e){return e.cadNode})),s=o.map((function(e){return e.pointCloudNode})),u={normalizedCoords:{x:t/this.renderer.domElement.clientWidth*2-1,y:n/this.renderer.domElement.clientHeight*-2+1},camera:this.camera,renderer:this.renderer,clippingPlanes:this.getClippingPlanes(),domElement:this.renderer.domElement},c=function(e,t){var n,r=[],i=f(e);try{for(i.s();!(n=i.n()).done;){var o=K(n.value,t);o&&r.push(o)}}catch(e){i.e(e)}finally{i.f()}return r.sort((function(e,t){return e.distance-t.distance}))}(a,u),l=he(s,u,null==r?void 0:r.pointIntersectionThreshold),d=[],!(l.length>0)){e.next=22;break}h=l[0],v=f(o),e.prev=4,v.s();case 6:if((m=v.n()).done){e.next=14;break}if((y=m.value).pointCloudNode!==h.pointCloudNode){e.next=12;break}return g={type:"pointcloud",model:y,point:h.point,pointIndex:h.pointIndex,distanceToCamera:h.distance},d.push(g),e.abrupt("break",14);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),v.e(e.t0);case 19:return e.prev=19,v.f(),e.finish(19);case 22:if(c.length>0){b=c[0],x=f(i);try{for(x.s();!(_=x.n()).done;)(w=_.value).cadNode===b.cadNode&&(M={type:"cad",model:w,treeIndex:b.treeIndex,point:b.point,distanceToCamera:b.distance},d.push(M))}catch(e){x.e(e)}finally{x.f()}}return e.abrupt("return",(d.sort((function(e,t){return e.distanceToCamera-t.distanceToCamera})),d.length>0?d[0]:null));case 24:case"end":return e.stop()}}),e,this,[[4,16,19,22]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"getModels",value:function(e){return this._models.filter((function(t){return t.type===e}))}},{key:"createViewStateHelper",value:function(){if(void 0===this._cdfSdkClient)throw new Error(this.setViewState.name+"() is only supported when connecting to Cognite Data Fusion");return new Pe(this,this._cdfSdkClient)}},{key:"animate",value:(n=u(p.mark((function e(t){var n,r,i,o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDisposed){e.next=2;break}return e.abrupt("return");case 2:this.latestRequestId=requestAnimationFrame(this._boundAnimate),n=window.getComputedStyle(this.canvas),r=n.display,"visible"===n.visibility&&"none"!==r&&(i=this.renderController,U.a.update(t),this.resizeIfNecessary()&&this.requestRedraw(),this._cameraManager.updateCameraControlsState(this.clock.getDelta()),i.update(),this.revealManager.update(this.camera),(i.needsRedraw||this.revealManager.needsRedraw||this._clippingNeedsUpdate)&&(o=this.renderer.info.render.frame,a=Date.now(),this.updateCameraNearAndFar(this.camera),this.revealManager.render(this.camera),i.clearNeedsRedraw(),this.revealManager.resetRedraw(),this._clippingNeedsUpdate=!1,s=Date.now()-a,this._events.sceneRendered.fire({frameNumber:o,renderTime:s,renderer:this.renderer,camera:this.camera})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"modelIntersectionCallback",value:(t=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIntersectionFromPixel(t,n);case 2:return e.t0=e.sent,e.t1=this._updateNearAndFarPlaneBuffers.combinedBbox,e.abrupt("return",{intersection:e.t0,modelsBoundingBox:e.t1});case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"updateCameraNearAndFar",value:function(e){if(!this.isDisposed&&(this._automaticControlsSensitivity||this._automaticNearFarPlane)){var t=this._updateNearAndFarPlaneBuffers,n=t.combinedBbox,r=t.bbox;n.makeEmpty(),this._models.forEach((function(e){e.getModelBoundingBox(r),r.isEmpty()||n.union(r)})),this._extraObjects.forEach((function(e){r.setFromObject(e),r.isEmpty()||n.union(r)})),this._cameraManager.updateCameraNearAndFar(e,n)}}},{key:"resizeIfNecessary",value:function(){if(this.isDisposed)return!1;var e=this.renderer.getSize(new j.Vector2),t=e.width,n=e.height,r=0!==this.domElement.clientWidth?this.domElement.clientWidth:this.canvas.clientWidth,i=0!==this.domElement.clientHeight?this.domElement.clientHeight:this.canvas.clientHeight,o=this.renderer.getPixelRatio()*r,a=this.renderer.getPixelRatio()*i,s=o*a,u=s>14e5?Math.sqrt(14e5/s):1,c=o*u,l=a*u;return!(Math.abs(t-c)<.1&&Math.abs(n-l)<.1||(this.renderer.setSize(c,l),Gn(this.camera,c,l),0))}}],[{key:"isBrowserSupported",value:function(){return!0}}]),e;var t,n,r,i,o,a,s,l}();function Gn(e,t,n){e instanceof j.PerspectiveCamera?(e.aspect=t/n,e.updateProjectionMatrix()):e instanceof j.OrthographicCamera&&(e.left=-t,e.right=t,e.top=n,e.bottom=-n)}}])},4027:function(e,t,n){var r=n(16525).default,i=n(29754).default,o=n(81109).default,a=n(69100).default,s=n(319).default,u=n(87757),c=n(48926).default,l=n(81506).default,d=n(2205).default,f=n(99842).default,p=n(63038).default,h=n(43269).default,v=n(93913).default,m=n(34575).default;!function(e,t){for(var n in t)e[n]=t[n]}(t,function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t){e.exports=n(70497)},function(e,t,n){"use strict";var r=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),n=n.getBlob()}catch(t){n=new Blob([e])}return new Worker(r.createObjectURL(n))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,n){e.exports=function(){return n(1)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){this.buffer=e,this.u8=new Uint8Array(e);var t=new ArrayBuffer(4),r=new Float32Array(t),n=new Uint8Array(t);this.getUint32=function(e){return this.u8[e+3]<<24|this.u8[e+2]<<16|this.u8[e+1]<<8|this.u8[e]},this.getUint16=function(e){return this.u8[e+1]<<8|this.u8[e]},this.getFloat32=function(e){return n[0]=this.u8[e+0],n[1]=this.u8[e+1],n[2]=this.u8[e+2],n[3]=this.u8[e+3],r[0]},this.getUint8=function(e){return this.u8[e]}}function i(e){this.version=e;var t=-1===e.indexOf(".")?e.length:e.indexOf(".");this.versionMajor=parseInt(e.substr(0,t)),this.versionMinor=parseInt(e.substr(t+1)),0===this.versionMinor.length&&(this.versionMinor=0)}onmessage=function(e){if(e.data&&e.data.buffer)try{var t=e.data.buffer,r=e.data.pointAttributes,a=t.byteLength/r.byteSize,s=new n(t),o=new i(e.data.version),u=e.data.offset,f=e.data.scale,A=(e.data.spacing,e.data.hasChildren,e.data.name,[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]),T=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],b=[0,0,0],_={},h=0;for(var I of r.attributes){if(I.name===P.POSITION_CARTESIAN.name){for(var N=new ArrayBuffer(4*a*3),y=new Float32Array(N),E=0;E<a;E++){o.newerThan("1.3")?(F=s.getUint32(h+E*r.byteSize+0,!0)*f,R=s.getUint32(h+E*r.byteSize+4,!0)*f,Y=s.getUint32(h+E*r.byteSize+8,!0)*f):(F=s.getFloat32(E*r.byteSize+0,!0)+u[0],R=s.getFloat32(E*r.byteSize+4,!0)+u[1],Y=s.getFloat32(E*r.byteSize+8,!0)+u[2]),y[3*E+0]=F,y[3*E+1]=R,y[3*E+2]=Y,b[0]+=F/a,b[1]+=R/a,b[2]+=Y/a,A[0]=Math.min(A[0],F),A[1]=Math.min(A[1],R),A[2]=Math.min(A[2],Y),T[0]=Math.max(T[0],F),T[1]=Math.max(T[1],R),T[2]=Math.max(T[2],Y)}_[I.name]={buffer:N,attribute:I}}else if(I.name===P.COLOR_PACKED.name){N=new ArrayBuffer(4*a);var l=new Uint8Array(N);for(E=0;E<a;E++)l[4*E+0]=s.getUint8(h+E*r.byteSize+0),l[4*E+1]=s.getUint8(h+E*r.byteSize+1),l[4*E+2]=s.getUint8(h+E*r.byteSize+2);_[I.name]={buffer:N,attribute:I}}else if(I.name===P.INTENSITY.name){N=new ArrayBuffer(4*a);var S=new Float32Array(N);for(E=0;E<a;E++){var m=s.getUint16(h+E*r.byteSize,!0);S[E]=m}_[I.name]={buffer:N,attribute:I}}else if(I.name===P.CLASSIFICATION.name){N=new ArrayBuffer(a);var M=new Uint8Array(N);for(E=0;E<a;E++){var O=s.getUint8(h+E*r.byteSize);M[E]=O}_[I.name]={buffer:N,attribute:I}}else if(I.name===P.NORMAL_SPHEREMAPPED.name){N=new ArrayBuffer(4*a*3);var v=new Float32Array(N);for(E=0;E<a;E++){var d=s.getUint8(h+E*r.byteSize+0),g=s.getUint8(h+E*r.byteSize+1),w=2*(d/255)-1,c=2*(g/255)-1,z=1,U=w*-w+c*-c+1*z;z=U,w*=Math.sqrt(U),c*=Math.sqrt(U),w*=2,c*=2,z=2*z-1,v[3*E+0]=w,v[3*E+1]=c,v[3*E+2]=z}_[I.name]={buffer:N,attribute:I}}else if(I.name===P.NORMAL_OCT16.name){for(N=new ArrayBuffer(4*a*3),v=new Float32Array(N),E=0;E<a;E++){d=s.getUint8(h+E*r.byteSize+0),g=s.getUint8(h+E*r.byteSize+1);var D=d/255*2-1,p=g/255*2-1,Y=1-Math.abs(D)-Math.abs(p),F=0,R=0;Y>=0?(F=D,R=p):(F=-(p/Math.sign(p)-1)/Math.sign(D),R=-(D/Math.sign(D)-1)/Math.sign(p));var L=Math.sqrt(F*F+R*R+Y*Y);F/=L,R/=L,Y/=L,v[3*E+0]=F,v[3*E+1]=R,v[3*E+2]=Y}_[I.name]={buffer:N,attribute:I}}else if(I.name===P.NORMAL.name){for(N=new ArrayBuffer(4*a*3),v=new Float32Array(N),E=0;E<a;E++){F=s.getFloat32(h+E*r.byteSize+0,!0),R=s.getFloat32(h+E*r.byteSize+4,!0),Y=s.getFloat32(h+E*r.byteSize+8,!0);v[3*E+0]=F,v[3*E+1]=R,v[3*E+2]=Y}_[I.name]={buffer:N,attribute:I}}h+=I.byteSize}N=new ArrayBuffer(4*a);for(var C=new Uint32Array(N),B=0;B<a;B++)C[B]=B;_[P.INDICES.name]={buffer:N,attribute:P.INDICES};var x={buffer:t,mean:b,attributeBuffers:_,tightBoundingBox:{min:A,max:T}},j=[];for(var G in x.attributeBuffers)j.push(x.attributeBuffers[G].buffer);j.push(t),postMessage(x,j)}catch(e){postMessage({error:"Exeption thrown during execution."})}},i.prototype.newerThan=function(e){var t=new i(e);return this.versionMajor>t.versionMajor||this.versionMajor===t.versionMajor&&this.versionMinor>t.versionMinor};var a=0,s=1,o=4,u=5,f=6,A=7,T=8,b=9,_=10,h=11,I=12,N=13,y=14,E=15,l={DATA_TYPE_DOUBLE:{ordinal:0,size:8},DATA_TYPE_FLOAT:{ordinal:1,size:4},DATA_TYPE_INT8:{ordinal:2,size:1},DATA_TYPE_UINT8:{ordinal:3,size:1},DATA_TYPE_INT16:{ordinal:4,size:2},DATA_TYPE_UINT16:{ordinal:5,size:2},DATA_TYPE_INT32:{ordinal:6,size:4},DATA_TYPE_UINT32:{ordinal:7,size:4},DATA_TYPE_INT64:{ordinal:8,size:8},DATA_TYPE_UINT64:{ordinal:9,size:8}},S=0;for(var m in l)l[S]=l[m],S++;function P(e,t,r){this.name=e,this.type=t,this.numElements=r,this.byteSize=this.numElements*this.type.size}function M(e){if(this.attributes=[],this.byteSize=0,this.size=0,null!=e)for(var t=0;t<e.length;t++){var r=P[e[t]];this.attributes.push(r),this.byteSize+=r.byteSize,this.size++}}P.POSITION_CARTESIAN=new P(a,l.DATA_TYPE_FLOAT,3),P.RGBA_PACKED=new P(s,l.DATA_TYPE_INT8,4),P.COLOR_PACKED=P.RGBA_PACKED,P.RGB_PACKED=new P(s,l.DATA_TYPE_INT8,3),P.NORMAL_FLOATS=new P(o,l.DATA_TYPE_FLOAT,3),P.FILLER_1B=new P(u,l.DATA_TYPE_UINT8,1),P.INTENSITY=new P(f,l.DATA_TYPE_UINT16,1),P.CLASSIFICATION=new P(A,l.DATA_TYPE_UINT8,1),P.NORMAL_SPHEREMAPPED=new P(T,l.DATA_TYPE_UINT8,2),P.NORMAL_OCT16=new P(b,l.DATA_TYPE_UINT8,2),P.NORMAL=new P(_,l.DATA_TYPE_FLOAT,3),P.RETURN_NUMBER=new P(h,l.DATA_TYPE_UINT8,1),P.NUMBER_OF_RETURNS=new P(I,l.DATA_TYPE_UINT8,1),P.SOURCE_ID=new P(N,l.DATA_TYPE_UINT8,1),P.INDICES=new P(y,l.DATA_TYPE_UINT32,1),P.SPACING=new P(E,l.DATA_TYPE_FLOAT,1),M.prototype.add=function(e){this.attributes.push(e),this.byteSize+=e.byteSize,this.size++},M.prototype.hasColors=function(){for(var e in this.attributes){if(this.attributes[e].name===s)return!0}return!1},M.prototype.hasNormals=function(){for(var e in this.attributes){var t=this.attributes[e];if(t===P.NORMAL_SPHEREMAPPED||t===P.NORMAL_FLOATS||t===P.NORMAL||t===P.NORMAL_OCT16)return!0}return!1}}]);\n',null)}},function(e,t,n){e.exports=function(){return n(1)('!function(e){var r={};function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)n.d(t,a,function(r){return e[r]}.bind(null,a));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=0)}([function(e,r,n){"use strict";onmessage=function(e){if(e.data&&e.data.buffer){for(var r=e.data.buffer,n=e.data.numPoints,t=e.data.pointSize,a=e.data.pointFormatID,i=e.data.scale,o=e.data.offset,u=(new Uint8Array(r),new DataView(r)),f=new ArrayBuffer(40*n),m=(new DataView(f),{min:[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],max:[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]}),s=[0,0,0],c=new ArrayBuffer(3*n*4),I=new ArrayBuffer(4*n),y=new ArrayBuffer(4*n),l=new ArrayBuffer(n),d=new ArrayBuffer(n),b=new ArrayBuffer(n),p=new ArrayBuffer(2*n),w=new Float32Array(c),N=new Uint8Array(I),A=new Float32Array(y),g=new Uint8Array(l),v=new Uint8Array(d),x=new Uint8Array(b),T=new Uint16Array(p),U=0;U<n;U++){var O=u.getInt32(U*t+0,!0),_=u.getInt32(U*t+4,!0),B=u.getInt32(U*t+8,!0),M=O*i[0]+o[0]-e.data.mins[0],S=_*i[1]+o[1]-e.data.mins[1],E=B*i[2]+o[2]-e.data.mins[2];w[3*U+0]=M,w[3*U+1]=S,w[3*U+2]=E,s[0]+=M/n,s[1]+=S/n,s[2]+=E/n,m.min[0]=Math.min(m.min[0],M),m.min[1]=Math.min(m.min[1],S),m.min[2]=Math.min(m.min[2],E),m.max[0]=Math.max(m.max[0],M),m.max[1]=Math.max(m.max[1],S),m.max[2]=Math.max(m.max[2],E);var F=u.getUint16(U*t+12,!0);A[U]=F;var P=u.getUint8(U*t+14,!0),h=7&P,V=(56&P)>>3;v[U]=h,x[U]=V;var j=u.getUint8(U*t+15,!0);g[U]=j;var Y=u.getUint16(U*t+18,!0);if(T[U]=Y,2===a){var D=u.getUint16(U*t+20,!0)/256,G=u.getUint16(U*t+22,!0)/256,R=u.getUint16(U*t+24,!0)/256;N[4*U+0]=D,N[4*U+1]=G,N[4*U+2]=R,N[4*U+3]=255}}var z=new ArrayBuffer(4*n),k=new Uint32Array(z);for(U=0;U<n;U++)k[U]=U;var q={mean:s,position:c,color:I,intensity:y,classification:l,returnNumber:d,numberOfReturns:b,pointSourceID:p,tightBoundingBox:m,indices:z};postMessage(q,[q.position,q.color,q.intensity,q.classification,q.returnNumber,q.numberOfReturns,q.pointSourceID,q.indices])}}}]);\n//# sourceMappingURL=main.map',null)}},function(e,t,n){e.exports=function(){return n(1)('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";onmessage=function(e){var t=e.data.boundingBox,n=new Float32Array(e.data.position),r=n.length/3,o=t.max[0]-t.min[0],a=t.max[1]-t.min[1],i=(t.max[2],t.min[2],new Float32Array(4096));i.fill(-1/0);for(var u=0;u<r;u++){var f=n[3*u+0],l=n[3*u+1],c=n[3*u+2],d=f/o,s=l/a;i[parseInt(Math.min(64*d,63))+64*parseInt(Math.min(64*s,63))]=c}var p={dem:{width:64,height:64,data:i.buffer}};postMessage(p,[p.dem.data])}}]);\n//# sourceMappingURL=main.map',null)}},function(e,t,n){e.exports=function(){return n(1)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){onmessage=function(e){if(performance.mark("laslaz-start"),!e.data||!e.data.buffer)return;let t=e.data.buffer,r=e.data.numPoints,n=e.data.pointSize,a=e.data.pointFormatID,i=e.data.scale,o=e.data.offset,u=(new Uint8Array(t),new DataView(t)),f={min:[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],max:[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]},l=[0,0,0],m=new ArrayBuffer(3*r*4),c=new ArrayBuffer(4*r),s=new ArrayBuffer(4*r),I=new ArrayBuffer(r),d=new ArrayBuffer(r),p=new ArrayBuffer(r),b=new ArrayBuffer(2*r),g=new Float32Array(m),N=new Uint8Array(c),w=new Float32Array(s),A=new Uint8Array(I),U=new Uint8Array(d),T=new Uint8Array(p),M=new Uint16Array(b),O=2==a||3==a,_=2==a?20:28,S=!1;if(O){let e,t,a,i;for(let o=0;o<r&&!S;++o)i=o*n,e=u.getUint16(i+_,!0),t=u.getUint16(i+_+2,!0),a=u.getUint16(i+_+4,!0),(e>255||t>255||a>255)&&(S=!0)}for(let t=0;t<r;t++){let a=u.getInt32(t*n+0,!0),m=u.getInt32(t*n+4,!0),c=u.getInt32(t*n+8,!0);x=a*i[0]+o[0]-e.data.mins[0],y=m*i[1]+o[1]-e.data.mins[1],z=c*i[2]+o[2]-e.data.mins[2],g[3*t+0]=x,g[3*t+1]=y,g[3*t+2]=z,l[0]+=x/r,l[1]+=y/r,l[2]+=z/r,f.min[0]=Math.min(f.min[0],x),f.min[1]=Math.min(f.min[1],y),f.min[2]=Math.min(f.min[2],z),f.max[0]=Math.max(f.max[0],x),f.max[1]=Math.max(f.max[1],y),f.max[2]=Math.max(f.max[2],z);let s=u.getUint16(t*n+12,!0);w[t]=s;let I=u.getUint8(t*n+14,!0),d=7&I,p=(56&I)>>3;U[t]=d,T[t]=p;let b=u.getUint8(t*n+15,!0);A[t]=b;let B=u.getUint16(t*n+18,!0);if(M[t]=B,O){let e=u.getUint16(t*n+_,!0),r=u.getUint16(t*n+_+2,!0),a=u.getUint16(t*n+_+4,!0);S&&(e/=256,r/=256,a/=256),N[4*t+0]=e,N[4*t+1]=r,N[4*t+2]=a,N[4*t+3]=255}}let B=new ArrayBuffer(4*r),E=new Uint32Array(B);for(let e=0;e<r;e++)E[e]=e;performance.mark("laslaz-end"),performance.clearMarks(),performance.clearMeasures();let F={mean:l,position:m,color:c,intensity:s,classification:I,returnNumber:d,numberOfReturns:p,pointSourceID:b,tightBoundingBox:f,indices:B};postMessage(F,[F.position,F.color,F.intensity,F.classification,F.returnNumber,F.numberOfReturns,F.pointSourceID,F.indices])}}]);\n//# sourceMappingURL=main.map',null)}},function(e,t,n){e.exports=function(){return n(1)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){Potree={},onmessage=function(e){if(!e.data||!e.data.buffer)return;let t,r,n,i,a,u,o,f,s,c,l,m,d,y,b,A,g,w,p,x,M,U=e.data.buffer,h=new DataView(U),N=e.data.schema,B=e.data.scale,O=e.data.offset,_=e.data.mins,I=N.reduce((e,t)=>(e[t.name]=t,e),{}),v=e=>{let t=(e=>{let t=0;for(var r=0;r<N.length;++r){if(N[r].name==e)return t;t+=N[r].size}})(e),r=I[e].type,n=I[e].size;if("signed"==r)switch(n){case 1:return e=>h.getInt8(e+t);case 2:return e=>h.getInt16(e+t,!0);case 4:return e=>h.getInt32(e+t,!0);case 8:return e=>h.getInt64(e+t,!0)}if("unsigned"==r)switch(n){case 1:return e=>h.getUint8(e+t);case 2:return e=>h.getUint16(e+t,!0);case 4:return e=>h.getUint32(e+t,!0);case 8:return e=>h.getUint64(e+t,!0)}if("float"==r)switch(n){case 4:return e=>h.getFloat32(e+t,!0);case 8:return e=>h.getFloat64(e+t,!0)}let i=JSON.stringify(I[e]);throw new Error(`Invalid dimension specification for ${e}: ${i}`)},S=N.reduce((e,t)=>e+t.size,0),P=U.byteLength/S,R=!1;if(I.X&&I.Y&&I.Z&&(t=new ArrayBuffer(4*P*3),f=new Float32Array(t),b=[v("X"),v("Y"),v("Z")]),I.Red&&I.Green&&I.Blue){let e,t,n,i;r=new ArrayBuffer(4*P),s=new Uint8Array(r),A=[v("Red"),v("Green"),v("Blue")];for(let r=0;r<P&&!R;++r)i=r*S,e=A[0](i),t=A[1](i),n=A[2](i),(e>255||t>255||n>255)&&(R=!0)}I.Intensity&&(n=new ArrayBuffer(4*P),c=new Float32Array(n),g=v("Intensity")),I.Classification&&(i=new ArrayBuffer(P),l=new Uint8Array(i),w=v("Classification")),I.ReturnNumber&&(a=new ArrayBuffer(P),m=new Uint8Array(a),p=v("ReturnNumber")),I.NumberOfReturns&&(u=new ArrayBuffer(P),d=new Uint8Array(u),x=v("NumberOfReturns")),I.PointSourceId&&(o=new ArrayBuffer(2*P),y=new Uint16Array(o),M=v("PointSourceId"));let X,j,E,L,V,z,F=[0,0,0],C={min:[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],max:[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE]};for(let e=0;e<P;++e){let t=e*S;f&&(X=b[0](t)*B.x+O.x-_[0],j=b[1](t)*B.y+O.y-_[1],E=b[2](t)*B.z+O.z-_[2],F[0]+=X/P,F[1]+=j/P,F[2]+=E/P,C.min[0]=Math.min(C.min[0],X),C.min[1]=Math.min(C.min[1],j),C.min[2]=Math.min(C.min[2],E),C.max[0]=Math.max(C.max[0],X),C.max[1]=Math.max(C.max[1],j),C.max[2]=Math.max(C.max[2],E),f[3*e+0]=X,f[3*e+1]=j,f[3*e+2]=E),s&&(L=A[0](t),V=A[1](t),z=A[2](t),R&&(L/=256,V/=256,z/=256),s[4*e+0]=L,s[4*e+1]=V,s[4*e+2]=z),c&&(c[e]=g(t)),l&&(l[e]=w(t)),m&&(m[e]=p(t)),d&&(d[e]=x(t)),y&&(y[e]=M(t))}let G=new ArrayBuffer(4*P),T=new Uint32Array(G);for(let e=0;e<P;++e)T[e]=e;let Y={numPoints:P,tightBoundingBox:C,mean:F,position:t,color:r,intensity:n,classification:i,returnNumber:a,numberOfReturns:u,pointSourceId:o,indices:G},Z=[Y.position,Y.color,Y.intensity,Y.classification,Y.returnNumber,Y.numberOfReturns,Y.pointSourceId,Y.indices].filter(e=>e);postMessage(Y,Z)}}]);\n//# sourceMappingURL=main.map',null)}},function(e,t,n){"use strict";n.r(t),n.d(t,"Global",(function(){return C})),n.d(t,"AttributeLocations",(function(){return Ee})),n.d(t,"Classification",(function(){return ke})),n.d(t,"PointSizeType",(function(){return Ae})),n.d(t,"PointShape",(function(){return Pe})),n.d(t,"PointColorType",(function(){return Ce})),n.d(t,"TreeType",(function(){return Oe})),n.d(t,"loadPointCloud",(function(){return Ie})),n.d(t,"updateVisibility",(function(){return Re})),n.d(t,"updatePointClouds",(function(){return Ne})),n.d(t,"updateVisibilityStructures",(function(){return De})),n.d(t,"BinaryHeap",(function(){return Te})),n.d(t,"LRU",(function(){return g})),n.d(t,"HelperUtils",(function(){return ve})),n.d(t,"VersionUtils",(function(){return W})),n.d(t,"WorkerManager",(function(){return P})),n.d(t,"PointAttribute",(function(){return L})),n.d(t,"PointAttributes",(function(){return B})),n.d(t,"PointAttributeNames",(function(){return I})),n.d(t,"PointAttributeTypes",(function(){return R})),n.d(t,"Gradients",(function(){return me})),n.d(t,"Points",(function(){return Le})),n.d(t,"Shaders",(function(){return ye})),n.d(t,"DEM",(function(){return j})),n.d(t,"DEMNode",(function(){return F})),n.d(t,"PointCloudTree",(function(){return U})),n.d(t,"PointCloudArena4D",(function(){return we})),n.d(t,"PointCloudOctree",(function(){return xe})),n.d(t,"PointCloudOctreeGeometry",(function(){return ie})),n.d(t,"PointCloudOctreeGeometryNode",(function(){return oe})),n.d(t,"PointCloudArena4DGeometry",(function(){return Se})),n.d(t,"PointCloudGreyhoundGeometry",(function(){return G})),n.d(t,"PointCloudEptGeometry",(function(){return de})),n.d(t,"PointCloudEptGeometryNode",(function(){return pe})),n.d(t,"PointCloudMaterial",(function(){return ge})),n.d(t,"LASLoader",(function(){return Q})),n.d(t,"BinaryLoader",(function(){return X})),n.d(t,"GreyhoundUtils",(function(){return q})),n.d(t,"GreyhoundLoader",(function(){return Y})),n.d(t,"GreyhoundBinaryLoader",(function(){return Z})),n.d(t,"POCLoader",(function(){return ae})),n.d(t,"LASLAZLoader",(function(){return ne})),n.d(t,"EptLoader",(function(){return he})),n.d(t,"EptLaszipLoader",(function(){return ue})),n.d(t,"EptBinaryLoader",(function(){return se})),n.d(t,"BasicGroup",(function(){return Be})),n.d(t,"Group",(function(){return Fe})),n.d(t,"XHRFactory",(function(){return H}));var y=v((function e(t){m(this,e),this.previous=null,this.next=null,this.node=t})),g=function(){function e(){m(this,e),this.first=null,this.last=null,this.items={},this.elements=0,this.numPoints=0}return v(e,[{key:"size",value:function(){return this.elements}},{key:"contains",value:function(e){return null==this.items[e.id]}},{key:"touch",value:function(e){var t;e.loaded&&(null==this.items[e.id]?((t=new y(e)).previous=this.last,this.last=t,null!==t.previous&&(t.previous.next=t),this.items[e.id]=t,this.elements++,null===this.first&&(this.first=t),this.numPoints+=e.numPoints):null===(t=this.items[e.id]).previous?null!==t.next&&(this.first=t.next,this.first.previous=null,t.previous=this.last,t.next=null,this.last=t,t.previous.next=t):null!==t.next&&(t.previous.next=t.next,t.next.previous=t.previous,t.previous=this.last,t.next=null,this.last=t,t.previous.next=t))}},{key:"remove",value:function(e){var t=this.items[e.id];t&&(1===this.elements?(this.first=null,this.last=null):(t.previous||(this.first=t.next,this.first.previous=null),t.next||(this.last=t.previous,this.last.next=null),t.previous&&t.next&&(t.previous.next=t.next,t.next.previous=t.previous)),delete this.items[e.id],this.elements--,this.numPoints-=e.numPoints)}},{key:"getLRUItem",value:function(){return null===this.first?null:this.first.node}},{key:"toString",value:function(){for(var e="{ ",t=this.first;null!==t;)e+=t.node.id,null!==t.next&&(e+=", "),t=t.next;return(e+="}")+"("+this.size()+")"}},{key:"freeMemory",value:function(){if(!(this.elements<=1))for(;this.numPoints>C.pointLoadLimit;){var e=this.first.node;this.disposeDescendants(e)}}},{key:"disposeDescendants",value:function(e){var t=[];for(t.push(e);t.length>0;){var n=t.pop();for(var r in n.dispose(),this.remove(n),n.children)n.children.hasOwnProperty(r)&&n.children[r].loaded&&t.push(n.children[r])}}}]),e}(),b=n(2),x=n.n(b),_=n(3),w=n.n(_),M=n(4),S=n.n(M),T=n(5),E=n.n(T),k=n(6),A=n.n(k),P=function(){function e(){m(this,e),this.workers=[];for(var t=0;t<7;t++)this.workers.push([])}return v(e,[{key:"getWorker",value:function(e){if(this.workers[e].length>0)return this.workers[e].pop();switch(e){case 0:return new x.a;case 1:throw"LASLAZWorker not implemented";case 2:return new w.a;case 3:throw"GreyhoundBinaryDecoderWorker not implemented";case 4:return new S.a;case 5:return new E.a;case 6:return new A.a;default:throw"Unknown worker requested"}}},{key:"returnWorker",value:function(e,t){this.workers[e].push(t)}},{key:"runTask",value:function(e,t,n,r){var i=this,o=this.getWorker(e);o.onmessage=function(n){t(n),i.returnWorker(e,o)},void 0!==r?o.postMessage(n,r):o.postMessage(n)}}]),e}();P.BINARY_DECODER=0,P.LAS_LAZ=1,P.LAS_DECODER=2,P.GREYHOUND=3,P.DEM=4,P.EPT_LAS_ZIP_DECODER=5,P.EPT_BINARY_DECODER=6;var C={debug:{},workerPath:function(){var e=function(){if(document&&document.currentScript)return document.currentScript;var e=document.getElementsByTagName("script");return e&&e.length?e[e.length-1].getAttribute("src"):null}();if(e&&e.src){var t=new URL(e.src+"/..").href;return"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}return console.error("Potree: Was unable to find its script path using document.currentScript."),""}(),maxNodesLoadGPUFrame:20,maxDEMLevel:0,maxNodesLoading:void 0!==navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,pointLoadLimit:1e10,numNodesLoading:0,measureTimings:!1,workerPool:new P,lru:new g,pointcloudTransformVersion:void 0},O=n(0),I={POSITION_CARTESIAN:0,COLOR_PACKED:1,COLOR_FLOATS_1:2,COLOR_FLOATS_255:3,NORMAL_FLOATS:4,FILLER:5,INTENSITY:6,CLASSIFICATION:7,NORMAL_SPHEREMAPPED:8,NORMAL_OCT16:9,NORMAL:10,RETURN_NUMBER:11,NUMBER_OF_RETURNS:12,SOURCE_ID:13,INDICES:14,SPACING:15},R={DATA_TYPE_DOUBLE:{ordinal:0,size:8},DATA_TYPE_FLOAT:{ordinal:1,size:4},DATA_TYPE_INT8:{ordinal:2,size:1},DATA_TYPE_UINT8:{ordinal:3,size:1},DATA_TYPE_INT16:{ordinal:4,size:2},DATA_TYPE_UINT16:{ordinal:5,size:2},DATA_TYPE_INT32:{ordinal:6,size:4},DATA_TYPE_UINT32:{ordinal:7,size:4},DATA_TYPE_INT64:{ordinal:8,size:8},DATA_TYPE_UINT64:{ordinal:9,size:8}},N=0;for(var D in R)R[N]=R[D],N++;function L(e,t,n){this.name=e,this.type=t,this.numElements=n,this.byteSize=this.numElements*this.type.size}function B(e){if(this.attributes=[],this.byteSize=0,this.size=0,null!=e)for(var t=0;t<e.length;t++){var n=L[e[t]];this.attributes.push(n),this.byteSize+=n.byteSize,this.size++}}L.POSITION_CARTESIAN=new L(I.POSITION_CARTESIAN,R.DATA_TYPE_FLOAT,3),L.RGBA_PACKED=new L(I.COLOR_PACKED,R.DATA_TYPE_INT8,4),L.COLOR_PACKED=L.RGBA_PACKED,L.RGB_PACKED=new L(I.COLOR_PACKED,R.DATA_TYPE_INT8,3),L.NORMAL_FLOATS=new L(I.NORMAL_FLOATS,R.DATA_TYPE_FLOAT,3),L.FILLER_1B=new L(I.FILLER,R.DATA_TYPE_UINT8,1),L.INTENSITY=new L(I.INTENSITY,R.DATA_TYPE_UINT16,1),L.CLASSIFICATION=new L(I.CLASSIFICATION,R.DATA_TYPE_UINT8,1),L.NORMAL_SPHEREMAPPED=new L(I.NORMAL_SPHEREMAPPED,R.DATA_TYPE_UINT8,2),L.NORMAL_OCT16=new L(I.NORMAL_OCT16,R.DATA_TYPE_UINT8,2),L.NORMAL=new L(I.NORMAL,R.DATA_TYPE_FLOAT,3),L.RETURN_NUMBER=new L(I.RETURN_NUMBER,R.DATA_TYPE_UINT8,1),L.NUMBER_OF_RETURNS=new L(I.NUMBER_OF_RETURNS,R.DATA_TYPE_UINT8,1),L.SOURCE_ID=new L(I.SOURCE_ID,R.DATA_TYPE_UINT8,1),L.INDICES=new L(I.INDICES,R.DATA_TYPE_UINT32,1),L.SPACING=new L(I.SPACING,R.DATA_TYPE_FLOAT,1),B.prototype.add=function(e){this.attributes.push(e),this.byteSize+=e.byteSize,this.size++},B.prototype.hasColors=function(){for(var e in this.attributes)if(this.attributes[e].name===I.COLOR_PACKED)return!0;return!1},B.prototype.hasNormals=function(){for(var e in this.attributes){var t=this.attributes[e];if(t===L.NORMAL_SPHEREMAPPED||t===L.NORMAL_FLOATS||t===L.NORMAL||t===L.NORMAL_OCT16)return!0}return!1};var F=function(){function e(t,n,r){m(this,e),this.name=t,this.box=n,this.tileSize=r,this.level=this.name.length-1,this.data=new Float32Array(r*r),this.data.fill(-1/0),this.children=[],this.mipMap=[this.data],this.mipMapNeedsUpdate=!0}return v(e,[{key:"createMipMap",value:function(){this.mipMap=[this.data];for(var e=this.tileSize,t=parseInt(e/2),n=this.data;t>1;){for(var r=new Float32Array(t*t),i=0;i<t;i++)for(var o=0;o<t;o++){var a=n[2*i+0+2*o*e],s=n[2*i+0+2*o*e+e],u=n[2*i+1+2*o*e],c=n[2*i+1+2*o*e+e],l=0,d=0;isFinite(a)&&(l+=a,d+=1),isFinite(s)&&(l+=s,d+=1),isFinite(u)&&(l+=u,d+=1),isFinite(c)&&(l+=c,d+=1),l/=d,r[i+o*t]=l}this.mipMap.push(r),n=r,e=t,t=parseInt(t/2)}this.mipMapNeedsUpdate=!1}},{key:"uv",value:function(e){var t=this.box.getSize(new O.Vector3);return[(e.x-this.box.min.x)/t.x,(e.y-this.box.min.y)/t.y]}},{key:"heightAtMipMapLevel",value:function(e,t){var n=this.uv(e),r=parseInt(this.tileSize/parseInt(Math.pow(2,t))),i=this.mipMap[t],o=Math.min(n[0]*r,r-1),a=Math.min(n[1]*r,r-1),s=o%1,u=a%1,c=[Math.floor(o),Math.ceil(o)],l=c[0],d=c[1],f=[Math.floor(a),Math.ceil(a)],p=f[0],h=f[1],v=i[l+r*p],m=i[l+r*h],y=i[d+r*p],g=i[d+r*h],b=isFinite(v)?(1-s)*(1-u):0,x=isFinite(m)?(1-s)*u:0,_=isFinite(y)?s*(1-u):0,w=isFinite(g)?s*u:0,M=b+x+_+w;if(b/=M,x/=M,_/=M,w/=M,0===M)return null;var S=0;return isFinite(v)&&(S+=v*b),isFinite(m)&&(S+=m*x),isFinite(y)&&(S+=y*_),isFinite(g)&&(S+=g*w),S}},{key:"height",value:function(e){for(var t=null,n=0;n<this.mipMap.length;n++)if(null!==(t=this.heightAtMipMapLevel(e,n)))return t;return t}},{key:"traverse",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=h((e(this,n),this.children.filter((function(e){return void 0!==e}))));try{for(r.s();!(t=r.n()).done;){var i=t.value;i.traverse(e,n+1)}}catch(e){r.e(e)}finally{r.f()}}}]),e}(),j=function(){function e(t){m(this,e),this.pointcloud=t,this.matrix=null,this.boundingBox=null,this.tileSize=64,this.root=null,this.version=0}return v(e,[{key:"expandAndFindByBox",value:function(e,t){if(0===t)return[this.root];for(var n=[],r=[this.root];r.length>0;)for(var i=r.pop(),o=i.box.getSize(new O.Vector3),a={x:(e.min.x-i.box.min.x)/o.x,y:(e.min.y-i.box.min.y)/o.y},s={x:(e.max.x-i.box.max.x)/o.x,y:(e.max.y-i.box.max.y)/o.y},u=0,c=(a.x=a.x<.5?0:1,a.y=a.y<.5?0:1,s.x=s.x<.5?0:1,s.y=s.y<.5?0:1,0===a.x&&0===a.y&&1===s.x&&1===s.y?[0,1,2,3]:a.x===s.x&&a.y===s.y?[a.x<<1|a.y]:[a.x<<1|a.y,s.x<<1|s.y]);u<c.length;u++){var l=c[u];if(void 0===i.children[l]){var d=i.box.clone();(2&l)>0?d.min.x+=o.x/2:d.max.x-=o.x/2,(1&l)>0?d.min.y+=o.y/2:d.max.y-=o.y/2;var f=new F(i.name+l,d,this.tileSize);i.children[l]=f}(f=i.children[l]).level<t?r.push(f):n.push(f)}return n}},{key:"childIndex",value:function(e){var t=e.map((function(e){return e<.5?0:1})),n=p(t,2);return n[0]<<1|n[1]}},{key:"height",value:function(e){if(!this.root)return 0;for(var t=null,n=[this.root];;){var r=n[n.length-1],i=r.height(e);null!==i&&(t=i);var o=r.uv(e),a=this.childIndex(o);if(!r.children[a])break;n.push(r.children[a])}return t+this.pointcloud.position.z}},{key:"update",value:function(e){null!==this.matrix&&this.matrix.equals(this.pointcloud.matrixWorld)||(this.matrix=this.pointcloud.matrixWorld.clone(),this.boundingBox=this.pointcloud.boundingBox.clone().applyMatrix4(this.matrix),this.root=new F("r",this.boundingBox,this.tileSize),this.version++);var t,n=null,r=h(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(void 0===i.demVersion||i.demVersion<this.version){n=i;break}}}catch(e){r.e(e)}finally{r.f()}if(null!==n){var o=n.getBoundingBox().clone().applyMatrix4(this.matrix),a=o.getSize(new O.Vector3),s=this.expandAndFindByBox(o,n.getLevel());n.demVersion=this.version;var u=n.geometryNode.geometry.attributes.position.array,c={boundingBox:{min:n.getBoundingBox().min.toArray(),max:n.getBoundingBox().max.toArray()},position:new Float32Array(u).buffer},l=[c.position],d=this;C.workerPool.runTask(P.DEM,(function(e){var t,n=new Float32Array(e.data.dem.data),r=h(s);try{for(r.s();!(t=r.n()).done;){for(var i=t.value,u=i.box.getSize(new O.Vector3),c=0;c<d.tileSize;c++)for(var l=0;l<d.tileSize;l++){var f=c/(d.tileSize-1),p=l/(d.tileSize-1),v=i.box.min.x+f*u.x,m=i.box.min.y+p*u.y,y=d.tileSize*(v-o.min.x)/a.x,g=d.tileSize*(m-o.min.y)/a.y;y<0||y>d.tileSize||g<0||g>d.tileSize||(y=Math.min(Math.floor(y),d.tileSize-1),g=Math.min(Math.floor(g),d.tileSize-1),i.data[c+d.tileSize*l]=n[y+d.tileSize*g])}i.createMipMap(),i.mipMapNeedsUpdate=!0}}catch(e){r.e(e)}finally{r.f()}}),c,l)}}}]),e}(),z=function(){function e(){m(this,e),this.needsTransformUpdate=!0}return v(e,[{key:"getChildren",value:function(){}},{key:"getBoundingBox",value:function(){}},{key:"isLoaded",value:function(){}},{key:"isGeometryNode",value:function(){}},{key:"isTreeNode",value:function(){}},{key:"getLevel",value:function(){}},{key:"getBoundingSphere",value:function(){}}]),e}(),U=function(e){d(n,e);var t=f(n);function n(){var e;return m(this,n),(e=t.call(this)).dem=new j(l(e)),e}return v(n,[{key:"initialized",value:function(){return null!==this.root}}]),n}(O.Object3D),G=v((function e(){m(this,e),this.spacing=0,this.boundingBox=null,this.root=null,this.nodes=null,this.pointAttributes={},this.hierarchyStepSize=-1,this.loader=null,this.schema=null,this.baseDepth=null,this.offset=null,this.projection=null,this.boundingSphere=null,this.serverURL=null,this.normalize={color:!1,intensity:!1}}));function V(e,t,n,r,i){this.id=V.IDCount++,this.name=e,this.index=parseInt(e.charAt(e.length-1)),this.pcoGeometry=t,this.geometry=null,this.boundingBox=n,this.boundingSphere=n.getBoundingSphere(new O.Sphere),this.scale=r,this.offset=i,this.children={},this.numPoints=0,this.level=null,this.loaded=!1,this.oneTimeDisposeHandlers=[],this.baseLoaded=!1;var o=new O.Vector3,a=this.boundingBox.clone();a.min.sub(this.pcoGeometry.boundingBox.getCenter(o)),a.max.sub(this.pcoGeometry.boundingBox.getCenter(o)),this.scale&&(a.min.multiplyScalar(1/this.scale),a.max.multiplyScalar(1/this.scale)),this.greyhoundBounds=a,this.greyhoundOffset=this.pcoGeometry.offset.clone().add(this.pcoGeometry.boundingBox.getSize(new O.Vector3).multiplyScalar(.5))}function W(e){this.version=e;var t=-1===e.indexOf(".")?e.length:e.indexOf(".");this.versionMajor=parseInt(e.substr(0,t)),this.versionMinor=parseInt(e.substr(t+1)),0===this.versionMinor.length&&(this.versionMinor=0)}V.IDCount=0,V.prototype=Object.create(z.prototype),V.prototype.isGeometryNode=function(){return!0},V.prototype.isTreeNode=function(){return!1},V.prototype.isLoaded=function(){return this.loaded},V.prototype.getBoundingSphere=function(){return this.boundingSphere},V.prototype.getBoundingBox=function(){return this.boundingBox},V.prototype.getLevel=function(){return this.level},V.prototype.getChildren=function(){for(var e=[],t=0;t<8;++t)this.children[t]&&e.push(this.children[t]);return e},V.prototype.getURL=function(){var e=this.pcoGeometry.schema,t=this.greyhoundBounds,n=t.min.x+","+t.min.y+","+t.min.z+","+t.max.x+","+t.max.y+","+t.max.z,r=this.pcoGeometry.serverURL+"read?depthBegin="+(this.baseLoaded?this.level+this.pcoGeometry.baseDepth:0)+"&depthEnd="+(this.level+this.pcoGeometry.baseDepth+1)+"&bounds=["+n+"]&schema="+JSON.stringify(e)+"&compress=true";if(this.scale&&(r+="&scale="+this.scale),this.greyhoundOffset){var i=this.greyhoundOffset;r+="&offset=["+i.x+","+i.y+","+i.z+"]"}return this.baseLoaded||(this.baseLoaded=!0),r},V.prototype.addChild=function(e){this.children[e.index]=e,e.parent=this},V.prototype.load=function(){!0===this.loading||!0===this.loaded||C.numNodesLoading>=C.maxNodesLoading||(this.loading=!0,C.numNodesLoading++,this.level%this.pcoGeometry.hierarchyStepSize==0&&this.hasChildren?this.loadHierarchyThenPoints():this.loadPoints())},V.prototype.loadPoints=function(){this.pcoGeometry.loader.load(this)},V.prototype.loadHierarchyThenPoints=function(){var e=[0,2,1,3,4,6,5,7],t=function t(n,r,i){var o,a;Object.keys(n).forEach((function(s){if("n"!==s){switch(s){case"swd":o=n.swd,a=r+e[0];break;case"nwd":o=n.nwd,a=r+e[1];break;case"swu":o=n.swu,a=r+e[2];break;case"nwu":o=n.nwu,a=r+e[3];break;case"sed":o=n.sed,a=r+e[4];break;case"ned":o=n.ned,a=r+e[5];break;case"seu":o=n.seu,a=r+e[6];break;case"neu":o=n.neu,a=r+e[7]}var u,c;i.push({children:(u=o,c=0,Object.keys(u).forEach((function(t){"swd"===t?c+=1<<e[0]:"nwd"===t?c+=1<<e[1]:"swu"===t?c+=1<<e[2]:"nwu"===t?c+=1<<e[3]:"sed"===t?c+=1<<e[4]:"ned"===t?c+=1<<e[5]:"seu"===t?c+=1<<e[6]:"neu"===t&&(c+=1<<e[7])})),c),numPoints:o.n,name:a}),t(o,a,i)}}))};if(this.level%this.pcoGeometry.hierarchyStepSize==0){var n=this.level+this.pcoGeometry.baseDepth,r=n+this.pcoGeometry.hierarchyStepSize+2,i=this.greyhoundBounds,o=i.min.x+","+i.min.y+","+i.min.z+","+i.max.x+","+i.max.y+","+i.max.z,a=this.pcoGeometry.serverURL+"hierarchy?bounds=["+o+"]&depthBegin="+n+"&depthEnd="+r;if(this.scale&&(a+="&scale="+this.scale),this.greyhoundOffset){var s=this.greyhoundOffset;a+="&offset=["+s.x+","+s.y+","+s.z+"]"}var u=this,c=XHRFactory.createXMLHttpRequest();c.overrideMimeType("text/plain"),c.open("GET",a,!0),c.onload=function(e){try{!function(e,n){var r=[];e.numPoints=n.n,t(n,e.name,r);var i={};i[e.name]=e;for(var o=e.pcoGeometry,a=0;a<r.length;a++){var s=r[a].name,u=r[a].numPoints,c=parseInt(s.charAt(s.length-1)),l=i[s.substring(0,s.length-1)],d=s.length-1,f=new V(s,o,Y.createChildAABB(l.boundingBox,c),e.scale,e.offset);f.level=d,f.numPoints=u,f.hasChildren=r[a].children>0,f.spacing=o.spacing/Math.pow(2,d),l.addChild(f),i[s]=f}e.loadPoints()}(u,JSON.parse(c.responseText)||{})}catch(e){C.numNodesLoading--,console.error("Potree: Exception thrown parsing points.",e)}},c.onerror=function(e){console.log("Potree: Failed to load file! HTTP status "+c.status+", file:"+a,e)},c.send(null)}},V.prototype.getNumPoints=function(){return this.numPoints},V.prototype.dispose=function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var e=0;e<this.oneTimeDisposeHandlers.length;e++)(0,this.oneTimeDisposeHandlers[e])();this.oneTimeDisposeHandlers=[]}},Object.assign(V.prototype,O.EventDispatcher.prototype),W.prototype.newerThan=function(e){var t=new W(e);return this.versionMajor>t.versionMajor||this.versionMajor===t.versionMajor&&this.versionMinor>t.versionMinor},W.prototype.equalOrHigher=function(e){var t=new W(e);return this.versionMajor>t.versionMajor||this.versionMajor===t.versionMajor&&this.versionMinor>=t.versionMinor},W.prototype.upTo=function(e){return!this.newerThan(e)};var H={config:{withCredentials:!1,customHeaders:[{header:null,value:null}]},createXMLHttpRequest:function(){var e=new XMLHttpRequest;if(this.config.customHeaders&&Array.isArray(this.config.customHeaders)&&this.config.customHeaders.length>0){var t=e.open,n=this.config.customHeaders;e.open=function(){t.apply(this,[].slice.call(arguments)),n.forEach((function(t){t.header&&t.value&&e.setRequestHeader(t.header,t.value)}))}}return e},fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=c(u.mark((function e(t){var n,r;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Headers,this.config.customHeaders&&this.config.customHeaders.forEach((function(e){e.header&&e.value&&n.append(e.header,e.value)})),r={headers:n,credentials:H.config.withCredentials?"include":"same-origin"},e.abrupt("return",fetch(t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}())},Z=function(){function e(t,n,r){m(this,e),this.version="string"==typeof t?new W(t):t,this.boundingBox=n,this.scale=r}return v(e,[{key:"load",value:function(e){if(!e.loaded){var t=this,n=e.getURL(),r=H.createXMLHttpRequest();r.overrideMimeType("text/plain"),r.open("GET",n,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onload=function(){try{t.parse(e,r.response)}catch(e){console.error("Potree: Exception thrown parsing points.",e),C.numNodesLoading--}},r.onerror=function(e){C.numNodesLoading--,console.error("Potree: Failed to load file.",r,n)},r.send(null)}}},{key:"parse",value:function(e,t){var n=new DataView(t,t.byteLength-4,4).getUint32(0,!0),r=e.pcoGeometry.pointAttributes;e.numPoints=n;var i=e.boundingBox,o=new THREE.Vector3,u=e.pcoGeometry.boundingBox.getCenter(o).sub(e.boundingBox.min),c={buffer:t,pointAttributes:r,version:this.version.version,schema:e.pcoGeometry.schema,min:[i.min.x,i.min.y,i.min.z],max:[i.max.x,i.max.y,i.max.z],offset:u.toArray(),scale:this.scale,normalize:e.pcoGeometry.normalize};C.workerPool.runTask(P.GREYHOUND,(function(t){var n=t.data,r=n.attributeBuffers,i=new THREE.Box3((new THREE.Vector3).fromArray(n.tightBoundingBox.min),(new THREE.Vector3).fromArray(n.tightBoundingBox.max)),o=new THREE.BufferGeometry;for(var u in r){var c=r[u].buffer;if(parseInt(u)===I.POSITION_CARTESIAN)o.setAttribute("position",new THREE.BufferAttribute(new Float32Array(c),3));else if(parseInt(u)===I.COLOR_PACKED)o.setAttribute("color",new THREE.BufferAttribute(new Uint8Array(c),4,!0));else if(parseInt(u)===I.INTENSITY)o.setAttribute("intensity",new THREE.BufferAttribute(new Float32Array(c),1));else if(parseInt(u)===I.CLASSIFICATION)o.setAttribute("classification",new THREE.BufferAttribute(new Uint8Array(c),1));else if(parseInt(u)===I.NORMAL_SPHEREMAPPED)o.setAttribute("normal",new THREE.BufferAttribute(new Float32Array(c),3));else if(parseInt(u)===I.NORMAL_OCT16)o.setAttribute("normal",new THREE.BufferAttribute(new Float32Array(c),3));else if(parseInt(u)===I.NORMAL)o.setAttribute("normal",new THREE.BufferAttribute(new Float32Array(c),3));else if(parseInt(u)===I.INDICES)(l=new THREE.BufferAttribute(new Uint8Array(c),4)).normalized=!0,o.setAttribute("indices",l);else if(parseInt(u)===I.SPACING){var l=new THREE.BufferAttribute(new Float32Array(c),1);o.setAttribute("spacing",l)}}i.max.sub(i.min),i.min.set(0,0,0),e.numPoints=n.numPoints,e.geometry=o,e.mean=a(THREE.Vector3,s(n.mean)),e.tightBoundingBox=i,e.loaded=!0,e.loading=!1,C.numNodesLoading--}),c,[c.buffer])}}]),e}(),q=function(){function e(){m(this,e)}return v(e,null,[{key:"getQueryParam",value:function(e){e=e.replace(/[[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(window.location.href);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}},{key:"createSchema",value:function(e){var t=[{name:"X",size:4,type:"signed"},{name:"Y",size:4,type:"signed"},{name:"Z",size:4,type:"signed"}];return e.forEach((function(e){"COLOR_PACKED"===e?(t.push({name:"Red",size:2,type:"unsigned"}),t.push({name:"Green",size:2,type:"unsigned"}),t.push({name:"Blue",size:2,type:"unsigned"})):"INTENSITY"===e?t.push({name:"Intensity",size:2,type:"unsigned"}):"CLASSIFICATION"===e&&t.push({name:"Classification",size:1,type:"unsigned"})})),t}},{key:"fetch",value:function(e,t){var n=H.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?t(null,n.responseText):t(n.responseText))},n.send(null)}},{key:"fetchBinary",value:function(e,t){var n=H.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",e,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?t(null,n.response):t(n.responseText))},n.send(null)}},{key:"pointSizeFrom",value:function(e){return e.reduce((function(e,t){return e+t.size}),0)}},{key:"getNormalization",value:function(t,n,r){var i=[{name:"X",size:4,type:"floating"},{name:"Y",size:4,type:"floating"},{name:"Z",size:4,type:"floating"},{name:"Red",size:2,type:"unsigned"},{name:"Green",size:2,type:"unsigned"},{name:"Blue",size:2,type:"unsigned"},{name:"Intensity",size:2,type:"unsigned"}],o=t+"read?depth="+n+"&schema="+JSON.stringify(i);e.fetchBinary(o,(function(t,n){if(t)throw new Error(t);for(var o=new DataView(n),a=n.byteLength-4,s=e.pointSizeFrom(i),u=!1,c=!1,l=0;l<a&&((o.getUint16(l+12,!0)>255||o.getUint16(l+14,!0)>255||o.getUint16(l+16,!0)>255)&&(u=!0),o.getUint16(l+18,!0)>255&&(c=!0),!u||!c);l+=s);r(null,{color:u,intensity:c})}))}}]),e}();function Y(){}Y.loadInfoJSON=function(e,t){},Y.load=function(e,t){try{var n=e.split("greyhound://")[1];1===n.split("http://").length&&1===n.split("https://").length&&(n="http://"+n),q.fetch(n+"info",(function(e,r){if(e)throw new Error(e);var i=JSON.parse(r),o=new W("1.4"),a=i.bounds,s=i.scale||.01;Array.isArray(s)&&(s=Math.min(s[0],s[1],s[2])),q.getQueryParam("scale")&&(s=parseFloat(q.getQueryParam("scale")));var u=Math.max(8,i.baseDepth),c=["POSITION_CARTESIAN"],l=!1,d=!1,f=!1;i.schema.forEach((function(e){"Intensity"===e.name&&c.push("INTENSITY"),"Classification"===e.name&&c.push("CLASSIFICATION"),"Red"===e.name?l=!0:"Green"===e.name?d=!0:"Blue"===e.name&&(f=!0)})),l&&d&&f&&c.push("COLOR_PACKED");var p=new G;p.serverURL=n,p.spacing=(a[3]-a[0])/Math.pow(2,u),p.baseDepth=u,p.hierarchyStepSize=5,p.schema=q.createSchema(c);var h=q.pointSizeFrom(p.schema);p.pointAttributes=new B(c),p.pointAttributes.byteSize=h;var v=new THREE.Box3((new THREE.Vector3).fromArray(a,0),(new THREE.Vector3).fromArray(a,3)),m=v.min.clone();v.max.sub(v.min),v.min.set(0,0,0),p.projection=i.srs,p.boundingBox=v,p.boundingSphere=v.getBoundingSphere(new THREE.Sphere),p.scale=s,p.offset=m,p.loader=new Z(o,v,p.scale);var y={},g=new V("r",p,v,s,m);g.level=0,g.hasChildren=!0,g.numPoints=i.numPoints,g.spacing=p.spacing,p.root=g,p.root.load(),y.r=g,p.nodes=y,q.getNormalization(n,i.baseDepth,(function(e,n){n.color&&(p.normalize.color=!0),n.intensity&&(p.normalize.intensity=!0),t(p)}))}))}catch(n){console.log("Potree: Loading failed.",e,n),t()}},Y.loadPointAttributes=function(e){for(var t=e.pointAttributes,n=new B,r=0;r<t.length;r++){var i=L[t[r]];n.add(i)}return n},Y.createChildAABB=function(e,t){var n=e.min,r=e.max,i=(new THREE.Vector3).copy(r).sub(n).multiplyScalar(.5),o=new THREE.Vector3(i.x,0,0),a=new THREE.Vector3(0,i.y,0),s=new THREE.Vector3(0,0,i.z),u=n,c=(new THREE.Vector3).add(n).add(i);return 1===t?(n=(new THREE.Vector3).copy(u).add(s),r=(new THREE.Vector3).copy(c).add(s)):3===t?(n=(new THREE.Vector3).copy(u).add(s).add(a),r=(new THREE.Vector3).copy(c).add(s).add(a)):0===t?(n=u,r=c):2===t?(n=(new THREE.Vector3).copy(u).add(a),r=(new THREE.Vector3).copy(c).add(a)):5===t?(n=(new THREE.Vector3).copy(u).add(s).add(o),r=(new THREE.Vector3).copy(c).add(s).add(o)):7===t?(n=(new THREE.Vector3).copy(u).add(i),r=(new THREE.Vector3).copy(c).add(i)):4===t?(n=(new THREE.Vector3).copy(u).add(o),r=(new THREE.Vector3).copy(c).add(o)):6===t&&(n=(new THREE.Vector3).copy(u).add(o).add(a),r=(new THREE.Vector3).copy(c).add(o).add(a)),new THREE.Box3(n,r)};var X=function(){function e(t,n,r){m(this,e),this.version="string"==typeof t?new W(t):t,this.boundingBox=n,this.scale=r}return v(e,[{key:"load",value:function(e){if(!e.loaded){var t=e.getURL();this.version.equalOrHigher("1.4")&&(t+=".bin");var n=this,r=H.createXMLHttpRequest();r.open("GET",t,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onload=function(){try{n.parse(e,r.response)}catch(e){C.numNodesLoading--,console.error("Potree: Exception thrown parsing points.",e)}},r.onerror=function(e){C.numNodesLoading--,console.error("Potree: Failed to load file.",r,t)},r.send(null)}}},{key:"parse",value:function(e,t){var n=e.pcoGeometry.pointAttributes,r=t.byteLength/e.pcoGeometry.pointAttributes.byteSize;this.version.upTo("1.5")&&(e.numPoints=r);var i={buffer:t,pointAttributes:n,version:this.version.version,min:[e.boundingBox.min.x,e.boundingBox.min.y,e.boundingBox.min.z],offset:[e.pcoGeometry.offset.x,e.pcoGeometry.offset.y,e.pcoGeometry.offset.z],scale:this.scale,spacing:e.spacing,hasChildren:e.hasChildren,name:e.name};C.workerPool.runTask(P.BINARY_DECODER,(function(t){var r=t.data;if(void 0!==r.error)return C.numNodesLoading--,void console.error("Potree: Binary worker error.",r);var i=r.attributeBuffers,o=new O.Box3((new O.Vector3).fromArray(r.tightBoundingBox.min),(new O.Vector3).fromArray(r.tightBoundingBox.max)),u=new O.BufferGeometry;for(var c in i){var l=i[c].buffer;if(parseInt(c)===I.POSITION_CARTESIAN)u.setAttribute("position",new O.BufferAttribute(new Float32Array(l),3));else if(parseInt(c)===I.COLOR_PACKED)u.setAttribute("color",new O.BufferAttribute(new Uint8Array(l),4,!0));else if(parseInt(c)===I.INTENSITY)u.setAttribute("intensity",new O.BufferAttribute(new Float32Array(l),1));else if(parseInt(c)===I.CLASSIFICATION)u.setAttribute("classification",new O.BufferAttribute(new Uint8Array(l),1));else if(parseInt(c)===I.NORMAL_SPHEREMAPPED)u.setAttribute("normal",new O.BufferAttribute(new Float32Array(l),3));else if(parseInt(c)===I.NORMAL_OCT16)u.setAttribute("normal",new O.BufferAttribute(new Float32Array(l),3));else if(parseInt(c)===I.NORMAL)u.setAttribute("normal",new O.BufferAttribute(new Float32Array(l),3));else if(parseInt(c)===I.INDICES)(d=new O.BufferAttribute(new Uint8Array(l),4)).normalized=!0,u.setAttribute("indices",d);else if(parseInt(c)===I.SPACING){var d=new O.BufferAttribute(new Float32Array(l),1);u.setAttribute("spacing",d)}}o.max.sub(o.min),o.min.set(0,0,0);var f=t.data.buffer.byteLength/n.byteSize;e.numPoints=f,e.geometry=u,e.mean=a(O.Vector3,s(r.mean)),e.tightBoundingBox=o,e.loaded=!0,e.loading=!1,e.estimatedSpacing=r.estimatedSpacing,C.numNodesLoading--}),i,[i.buffer])}}]),e}(),K=[function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0)}},function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0)}},function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0),color:[e.getUint16(20,!0),e.getUint16(22,!0),e.getUint16(24,!0)]}},function(e){return{position:[e.getInt32(0,!0),e.getInt32(4,!0),e.getInt32(8,!0)],intensity:e.getUint16(12,!0),classification:e.getUint8(16,!0),color:[e.getUint16(28,!0),e.getUint16(30,!0),e.getUint16(32,!0)]}}];function J(e,t,n,r){r=void 0===r||0===r?1:r;var i=new t(e.slice(n,n+t.BYTES_PER_ELEMENT*r));if(void 0===r||1===r)return i[0];for(var o=[],a=0;a<r;a++)o.push(i[a]);return o}function Q(e){this.arraybuffer=e}function $(e){var t=this;this.arraybuffer=e,this.nextCB=null,this.dorr=function(e,n){t.nextCB=n,C.workerPool.runTask(P.LAS_LAZ,(function(e){null!==t.nextCB&&(t.nextCB(e.data),t.nextCB=null)}),e)}}function ee(e){if(this.arraybuffer=e,this.determineVersion(),this.version>12)throw new Error("Only file versions <= 1.2 are supported at this time");if(this.determineFormat(),void 0===K[this.formatId])throw new Error("The point format ID is not supported");this.loader=this.isCompressed?new $(this.arraybuffer):new Q(this.arraybuffer)}function te(e,t,n,r,i,o,a,s){this.arrayb=e,this.decoder=K[t],this.pointsCount=r,this.pointSize=n,this.scale=i,this.offset=o,this.mins=a,this.maxs=s}Q.prototype.open=function(){return this.readOffset=0,new Promise((function(e,t){setTimeout(e,0)}))},Q.prototype.getHeader=function(){var e=this;return new Promise((function(t,n){setTimeout((function(){e.header=function(e){var t={};t.pointsOffset=J(e,Uint32Array,96),t.pointsFormatId=J(e,Uint8Array,104),t.pointsStructSize=J(e,Uint16Array,105),t.pointsCount=J(e,Uint32Array,107);var n=131;t.scale=J(e,Float64Array,n,3),n+=24,t.offset=J(e,Float64Array,n,3),n+=24;var r=J(e,Float64Array,n,6);return n+=48,t.maxs=[r[0],r[2],r[4]],t.mins=[r[1],r[3],r[5]],t}(e.arraybuffer),t(e.header)}),0)}))},Q.prototype.readData=function(e,t,n){var r=this;return new Promise((function(t,i){setTimeout((function(){if(!r.header)return i(new Error("Cannot start reading data till a header request is issued"));var o;if(n<=1){e=Math.min(e,r.header.pointsCount-r.readOffset);var a=(o=r.header.pointsOffset+r.readOffset*r.header.pointsStructSize)+e*r.header.pointsStructSize;t({buffer:r.arraybuffer.slice(o,a),count:e,hasMoreData:r.readOffset+e<r.header.pointsCount}),r.readOffset+=e}else{for(var s=Math.min(e*n,r.header.pointsCount-r.readOffset),u=Math.ceil(s/n),c=0,l=new Uint8Array(u*r.header.pointsStructSize),d=0;d<s;d++){if(d%n==0){o=r.header.pointsOffset+r.readOffset*r.header.pointsStructSize;var f=new Uint8Array(r.arraybuffer,o,r.header.pointsStructSize);l.set(f,c*r.header.pointsStructSize),c++}r.readOffset++}t({buffer:l.buffer,count:c,hasMoreData:r.readOffset<r.header.pointsCount})}}),0)}))},Q.prototype.close=function(){var e=this;return new Promise((function(t,n){e.arraybuffer=null,setTimeout(t,0)}))},$.prototype.open=function(){var e=this;return new Promise((function(t,n){e.dorr({type:"open",arraybuffer:e.arraybuffer},(function(e){if(1!==e.status)return n(new Error("Failed to open file"));t(!0)}))}))},$.prototype.getHeader=function(){var e=this;return new Promise((function(t,n){e.dorr({type:"header"},(function(e){if(1!==e.status)return n(new Error("Failed to get header"));t(e.header)}))}))},$.prototype.readData=function(e,t,n){var r=this;return new Promise((function(i,o){r.dorr({type:"read",count:e,offset:t,skip:n},(function(e){if(1!==e.status)return o(new Error("Failed to read data"));i({buffer:e.buffer,count:e.count,hasMoreData:e.hasMoreData})}))}))},$.prototype.close=function(){var e=this;return new Promise((function(t,n){e.dorr({type:"close"},(function(e){if(1!==e.status)return n(new Error("Failed to close file"));t(!0)}))}))},ee.prototype.determineFormat=function(){var e=J(this.arraybuffer,Uint8Array,104),t=(128&e)>>7,n=(64&e)>>6;if(1===t&&1===n)throw new Error("Old style compression not supported");this.formatId=63&e,this.isCompressed=1===t||1===n},ee.prototype.determineVersion=function(){var e=new Int8Array(this.arraybuffer,24,2);this.version=10*e[0]+e[1],this.versionAsString=e[0]+"."+e[1]},ee.prototype.open=function(){return this.loader.open()},ee.prototype.getHeader=function(){return this.loader.getHeader()},ee.prototype.readData=function(e,t,n){return this.loader.readData(e,t,n)},ee.prototype.close=function(){return this.loader.close()},te.prototype.getPoint=function(e){if(e<0||e>=this.pointsCount)throw new Error("Point index out of range");return this.decoder(new DataView(this.arrayb,e*this.pointSize,this.pointSize))};var ne=function(){function e(t){m(this,e),this.version="string"==typeof t?new W(t):t}return v(e,[{key:"load",value:function(e){if(!e.loaded){var t=e.pcoGeometry.pointAttributes,n=e.getURL();this.version.equalOrHigher("1.4")&&(n+="."+t.toLowerCase());var r=this,i=H.createXMLHttpRequest();i.open("GET",n,!0),i.responseType="arraybuffer",i.overrideMimeType("text/plain; charset=x-user-defined"),i.onload=function(){if(i.response instanceof ArrayBuffer)try{r.parse(e,i.response)}catch(e){console.error("Potree: Exception thrown parsing points.",e),C.numNodesLoading--}else C.numNodesLoading--,console.log("Potree: LASLAZLoader xhr response is not a ArrayBuffer.")},i.onerror=function(){C.numNodesLoading--,console.log("Potree: LASLAZLoader failed to load file, "+i.status+", file: "+n)},i.send(null)}}},{key:"parse",value:function(e,t){var n=new ee(t),r=new re(e);n.open().then((function(e){return n.isOpen=!0,n})).catch((function(e){console.log("Potree: Failed to open file.")})).then((function(e){return e.getHeader().then((function(t){return[e,t]}))})).then((function(e){var t=e[0],n=e[1],i=0;return n.pointsCount,function e(){return t.readData(1e6,0,1).then((function(o){return r.push(new te(o.buffer,n.pointsFormatId,n.pointsStructSize,o.count,n.scale,n.offset,n.mins,n.maxs)),i+=o.count,o.hasMoreData?e():(n.totalRead=i,n.versionAsString=t.versionAsString,n.isCompressed=t.isCompressed,[t,n,r])}))}()})).then((function(e){var t=e[0];return t.close().then((function(){return t.isOpen=!1,e.slice(1)})).catch((function(e){if(t.isOpen)return t.close().then((function(){throw t.isOpen=!1,e}));throw e}))}))}},{key:"handle",value:function(e,t){}}]),e}(),re=function(){function e(t){m(this,e),this.node=t}return v(e,[{key:"push",value:function(e){var t=this,n={buffer:e.arrayb,numPoints:e.pointsCount,pointSize:e.pointSize,pointFormatID:2,scale:e.scale,offset:e.offset,mins:e.mins,maxs:e.maxs},r=C.workerPool.getWorker(P.LAS_DECODER);r.onmessage=function(n){var i=new O.BufferGeometry,o=e.pointsCount,u=new Float32Array(n.data.position),c=new Uint8Array(n.data.color),l=new Float32Array(n.data.intensity),d=new Uint8Array(n.data.classification),f=new Uint8Array(n.data.returnNumber),p=new Uint8Array(n.data.numberOfReturns),h=new Uint16Array(n.data.pointSourceID),v=new Uint8Array(n.data.indices);i.setAttribute("position",new O.BufferAttribute(u,3)),i.setAttribute("color",new O.BufferAttribute(c,4,!0)),i.setAttribute("intensity",new O.BufferAttribute(l,1)),i.setAttribute("classification",new O.BufferAttribute(d,1)),i.setAttribute("returnNumber",new O.BufferAttribute(f,1)),i.setAttribute("numberOfReturns",new O.BufferAttribute(p,1)),i.setAttribute("pointSourceID",new O.BufferAttribute(h,1)),i.setAttribute("indices",new O.BufferAttribute(v,4)),i.attributes.indices.normalized=!0;var m=new O.Box3((new O.Vector3).fromArray(n.data.tightBoundingBox.min),(new O.Vector3).fromArray(n.data.tightBoundingBox.max));i.boundingBox=t.node.boundingBox,t.node.tightBoundingBox=m,t.node.geometry=i,t.node.numPoints=o,t.node.loaded=!0,t.node.loading=!1,C.numNodesLoading--,t.node.mean=a(O.Vector3,s(n.data.mean)),C.workerPool.returnWorker(P.LAS_DECODER,r)},r.postMessage(n,[n.buffer])}}]),e}(),ie=v((function e(){m(this,e),this.url=null,this.octreeDir=null,this.spacing=0,this.boundingBox=null,this.root=null,this.nodes=null,this.pointAttributes=null,this.hierarchyStepSize=-1,this.loader=null})),oe=function(e){d(n,e);var t=f(n);function n(e,r,i){var o;return m(this,n),(o=t.call(this)).id=n.IDCount++,o.name=e,o.index=parseInt(e.charAt(e.length-1)),o.pcoGeometry=r,o.geometry=null,o.boundingBox=i,o.boundingSphere=i.getBoundingSphere(new O.Sphere),o.children={},o.numPoints=0,o.level=null,o.loaded=!1,o.oneTimeDisposeHandlers=[],o}return v(n,[{key:"isGeometryNode",value:function(){return!0}},{key:"getLevel",value:function(){return this.level}},{key:"isTreeNode",value:function(){return!1}},{key:"isLoaded",value:function(){return this.loaded}},{key:"getBoundingSphere",value:function(){return this.boundingSphere}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"getChildren",value:function(){for(var e=[],t=0;t<8;t++)this.children[t]&&e.push(this.children[t]);return e}},{key:"getURL",value:function(){var e="",t=this.pcoGeometry.loader.version;return t.equalOrHigher("1.5")?e=this.pcoGeometry.octreeDir+"/"+this.getHierarchyPath()+"/"+this.name:(t.equalOrHigher("1.4")||t.upTo("1.3"))&&(e=this.pcoGeometry.octreeDir+"/"+this.name),e}},{key:"getHierarchyPath",value:function(){for(var e="r/",t=this.pcoGeometry.hierarchyStepSize,n=this.name.substr(1),r=Math.floor(n.length/t),i=0;i<r;i++)e+=n.substr(i*t,t)+"/";return e.slice(0,-1)}},{key:"addChild",value:function(e){this.children[e.index]=e,e.parent=this}},{key:"load",value:function(){if(!(!0===this.loading||!0===this.loaded||C.numNodesLoading>=C.maxNodesLoading)){this.loading=!0,C.numNodesLoading++;try{this.pcoGeometry.loader.version.equalOrHigher("1.5")&&this.level%this.pcoGeometry.hierarchyStepSize==0&&this.hasChildren?this.loadHierachyThenPoints():this.loadPoints()}catch(e){C.numNodesLoading--,console.error("Potree: Exception thrown loading points file.",e)}}}},{key:"loadPoints",value:function(){this.pcoGeometry.loader.load(this)}},{key:"loadHierachyThenPoints",value:function(){var e=this;if(e.level%e.pcoGeometry.hierarchyStepSize==0){var t=e.pcoGeometry.octreeDir+"/"+e.getHierarchyPath()+"/"+e.name+".hrc",r=H.createXMLHttpRequest();r.open("GET",t,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onload=function(t){try{!function(e,t){var r=new DataView(t),i=[],o=r.getUint8(0),a=r.getUint32(1,!0);e.numPoints=a,i.push({children:o,numPoints:a,name:e.name});for(var s=[],u=5;i.length>0;){for(var c=i.shift(),l=1,d=0;d<8;d++){if(0!=(c.children&l)){var f=c.name+d,p=r.getUint8(u),h=r.getUint32(u+1,!0);i.push({children:p,numPoints:h,name:f}),s.push({children:p,numPoints:h,name:f}),u+=5}l*=2}if(u===t.byteLength)break}var v={};v[e.name]=e;var m=e.pcoGeometry;for(d=0;d<s.length;d++){var y=s[d].name,g=s[d].numPoints,b=parseInt(y.charAt(y.length-1)),x=v[y.substring(0,y.length-1)],_=y.length-1,w=new n(y,m,ae.createChildAABB(x.boundingBox,b));w.level=_,w.numPoints=g,w.hasChildren=s[d].children>0,w.spacing=m.spacing/Math.pow(2,_),x.addChild(w),v[y]=w}e.loadPoints()}(e,r.response)}catch(e){C.numNodesLoading--,console.error("Potree: Exception thrown parsing points.",e)}},r.onerror=function(e){C.numNodesLoading--,console.error("Potree: Failed to load file.",r.status,t,e)},r.send(null)}}},{key:"getNumPoints",value:function(){return this.numPoints}},{key:"dispose",value:function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var e=0;e<this.oneTimeDisposeHandlers.length;e++)(0,this.oneTimeDisposeHandlers[e])();this.oneTimeDisposeHandlers=[]}}}]),n}(z);oe.IDCount=0,Object.assign(oe.prototype,O.EventDispatcher.prototype);var ae=function(){function e(){m(this,e)}return v(e,null,[{key:"load",value:function(t,n){var r=new ie;r.url=t;var i=H.createXMLHttpRequest();i.overrideMimeType("text/plain"),i.open("GET",t,!0),i.onload=function(){var o=JSON.parse(i.responseText),a=new W(o.version);0===o.octreeDir.indexOf("http")?r.octreeDir=o.octreeDir:r.octreeDir=t+"/../"+o.octreeDir,r.spacing=o.spacing,r.hierarchyStepSize=o.hierarchyStepSize,r.pointAttributes=o.pointAttributes;var s=new O.Vector3(o.boundingBox.lx,o.boundingBox.ly,o.boundingBox.lz),u=new O.Vector3(o.boundingBox.ux,o.boundingBox.uy,o.boundingBox.uz),c=(b=new O.Box3(s,u)).clone();o.tightBoundingBox&&(c.min.copy(new O.Vector3(o.tightBoundingBox.lx,o.tightBoundingBox.ly,o.tightBoundingBox.lz)),c.max.copy(new O.Vector3(o.tightBoundingBox.ux,o.tightBoundingBox.uy,o.tightBoundingBox.uz)));var l=s.clone();b.min.sub(l),b.max.sub(l),c.min.sub(l),c.max.sub(l),r.projection=o.projection,r.boundingBox=b,r.tightBoundingBox=c,r.boundingSphere=b.getBoundingSphere(new O.Sphere),r.tightBoundingSphere=c.getBoundingSphere(new O.Sphere),r.offset=l,"LAS"===o.pointAttributes||"LAZ"===o.pointAttributes?r.loader=new ne(o.version):(r.loader=new X(o.version,b,o.scale),r.pointAttributes=new B(r.pointAttributes));var d={},f=new oe(h="r",r,b);if(f.level=0,f.hasChildren=!0,f.spacing=r.spacing,f.numPoints=a.upTo("1.5")?o.hierarchy[0][1]:0,r.root=f,r.root.load(),d[h]=f,a.upTo("1.4"))for(var p=1;p<o.hierarchy.length;p++){var h=o.hierarchy[p][0],v=o.hierarchy[p][1],m=parseInt(h.charAt(h.length-1)),y=d[h.substring(0,h.length-1)],g=h.length-1,b=e.createChildAABB(y.boundingBox,m),x=new oe(h,r,b);x.level=g,x.numPoints=v,x.spacing=r.spacing/Math.pow(2,g),y.addChild(x),d[h]=x}r.nodes=d,n(r)},i.onerror=function(e){C.numNodesLoading--,console.log("Potree: loading file failed.",t,e),n()},i.send(null)}},{key:"loadPointAttributes",value:function(e){for(var t=e.pointAttributes,n=new B,r=0;r<t.length;r++)n.add(L[t[r]]);return n}},{key:"createChildAABB",value:function(e,t){var n=e.min.clone(),r=e.max.clone(),i=(new O.Vector3).subVectors(r,n);return(1&t)>0?n.z+=i.z/2:r.z-=i.z/2,(2&t)>0?n.y+=i.y/2:r.y-=i.y/2,(4&t)>0?n.x+=i.x/2:r.x-=i.x/2,new O.Box3(n,r)}}]),e}(),se=function(){function e(){m(this,e)}return v(e,[{key:"load",value:function(e){var t=this;if(!e.loaded){var n=e.url()+".bin",r=H.createXMLHttpRequest();r.open("GET",n,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var i=r.response;t.parse(e,i)}else console.log("Failed "+n+": "+r.status)};try{r.send(null)}catch(e){console.log("Failed request: "+e)}}}},{key:"parse",value:function(e,t){var n=C.workerPool.getWorker(P.EPT_BINARY_DECODER);n.onmessage=function(t){var r=new O.BufferGeometry,i=t.data.numPoints,o=new Float32Array(t.data.position);r.setAttribute("position",new O.BufferAttribute(o,3));var u=new Uint8Array(t.data.indices);if(r.setAttribute("indices",new O.BufferAttribute(u,4)),t.data.color){var c=new Uint8Array(t.data.color);r.setAttribute("color",new O.BufferAttribute(c,4,!0))}if(t.data.intensity){var l=new Float32Array(t.data.intensity);r.setAttribute("intensity",new O.BufferAttribute(l,1))}if(t.data.classification){var d=new Uint8Array(t.data.classification);r.setAttribute("classification",new O.BufferAttribute(d,1))}if(t.data.returnNumber){var f=new Uint8Array(t.data.returnNumber);r.setAttribute("returnNumber",new O.BufferAttribute(f,1))}if(t.data.numberOfReturns){var p=new Uint8Array(t.data.numberOfReturns);r.setAttribute("numberOfReturns",new O.BufferAttribute(p,1))}if(t.data.pointSourceId){var h=new Uint16Array(t.data.pointSourceId);r.setAttribute("pointSourceID",new O.BufferAttribute(h,1))}r.attributes.indices.normalized=!0;var v=new O.Box3((new O.Vector3).fromArray(t.data.tightBoundingBox.min),(new O.Vector3).fromArray(t.data.tightBoundingBox.max));e.doneLoading(r,v,i,a(O.Vector3,s(t.data.mean))),C.workerPool.returnWorker(P.EPT_BINARY_DECODER,n)};var r,i={buffer:t,schema:e.ept.schema,scale:e.ept.eptScale,offset:e.ept.eptOffset,mins:(r=e.key.b.min,[r.x,r.y,r.z])};n.postMessage(i,[i.buffer])}}]),e}(),ue=function(){function e(){m(this,e)}return v(e,[{key:"load",value:function(e){var t=this;if(!e.loaded){var n=e.url()+".laz",r=H.createXMLHttpRequest();r.open("GET",n,!0),r.responseType="arraybuffer",r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var i=r.response;t.parse(e,i)}else console.log("Failed "+n+": "+r.status)},r.send(null)}}},{key:"parse",value:function(e,t){var n=new ee(t),r=new ce(e);n.open().then((function(){return n.isOpen=!0,n.getHeader()})).then((function(t){var i=0,o=(t.pointsCount,function(e){return[e.x,e.y,e.z]}),a=o(e.key.b.min),s=o(e.key.b.max);return function e(){return n.readData(1e6,0,1).then((function(o){var u=new te(o.buffer,t.pointsFormatId,t.pointsStructSize,o.count,t.scale,t.offset,a,s);return u.extraBytes=t.extraBytes,u.pointsFormatId=t.pointsFormatId,r.push(u),i+=o.count,o.hasMoreData?e():(t.totalRead=i,t.versionAsString=n.versionAsString,t.isCompressed=n.isCompressed,null)}))}()})).then((function(){return n.close()})).then((function(){return n.isOpen=!1})).catch((function(e){if(console.log("Error reading LAZ:",e),!n.isOpen)throw e;n.close().then((function(){throw n.isOpen=!1,e}))}))}}]),e}(),ce=function(){function e(t){m(this,e),this.node=t}return v(e,[{key:"push",value:function(e){var t=this,n=C.workerPool.getWorker(P.EPT_LAS_ZIP_DECODER);n.onmessage=function(r){var i=new O.BufferGeometry,o=e.pointsCount,u=new Float32Array(r.data.position),c=new Uint8Array(r.data.color),l=new Float32Array(r.data.intensity),d=new Uint8Array(r.data.classification),f=new Uint8Array(r.data.returnNumber),p=new Uint8Array(r.data.numberOfReturns),h=new Uint16Array(r.data.pointSourceID),v=new Uint8Array(r.data.indices);i.setAttribute("position",new O.BufferAttribute(u,3)),i.setAttribute("color",new O.BufferAttribute(c,4,!0)),i.setAttribute("intensity",new O.BufferAttribute(l,1)),i.setAttribute("classification",new O.BufferAttribute(d,1)),i.setAttribute("returnNumber",new O.BufferAttribute(f,1)),i.setAttribute("numberOfReturns",new O.BufferAttribute(p,1)),i.setAttribute("pointSourceID",new O.BufferAttribute(h,1)),i.setAttribute("indices",new O.BufferAttribute(v,4)),i.attributes.indices.normalized=!0;var m=new O.Box3((new O.Vector3).fromArray(r.data.tightBoundingBox.min),(new O.Vector3).fromArray(r.data.tightBoundingBox.max));t.node.doneLoading(i,m,o,a(O.Vector3,s(r.data.mean))),C.workerPool.returnWorker(P.EPT_LAS_ZIP_DECODER,n)};var r={buffer:e.arrayb,numPoints:e.pointsCount,pointSize:e.pointSize,pointFormatID:e.pointsFormatId,scale:e.scale,offset:e.offset,mins:e.mins,maxs:e.maxs};n.postMessage(r,[r.buffer])}}]),e}(),le=function(){function e(){m(this,e)}return v(e,null,[{key:"toVector3",value:function(e,t){return(new O.Vector3).fromArray(e,t||0)}},{key:"toBox3",value:function(t){return new O.Box3(e.toVector3(t),e.toVector3(t,3))}},{key:"findDim",value:function(e,t){var n=e.find((function(e){return e.name==t}));if(!n)throw new Error("Failed to find "+t+" in schema");return n}},{key:"sphereFrom",value:function(e){return e.getBoundingSphere(new O.Sphere)}}]),e}(),de=v((function e(t,n){m(this,e),n.version;var r=n.schema,i=n.bounds,o=n.boundsConforming,a=[le.findDim(r,"X"),le.findDim(r,"Y"),le.findDim(r,"Z")],s=a.map((function(e){return e.scale||1})),u=a.map((function(e){return e.offset||0}));this.eptScale=le.toVector3(s),this.eptOffset=le.toVector3(u),this.url=t,this.info=n,this.type="ept",this.schema=r,this.span=n.span||n.ticks,this.boundingBox=le.toBox3(i),this.tightBoundingBox=le.toBox3(o),this.offset=le.toVector3([0,0,0]),this.boundingSphere=le.sphereFrom(this.boundingBox),this.tightBoundingSphere=le.sphereFrom(this.tightBoundingBox),this.version=new W("1.6"),this.projection=null,this.fallbackProjection=null,n.srs&&n.srs.horizontal&&(this.projection=n.srs.authority+":"+n.srs.horizontal),n.srs.wkt&&(this.projection?this.fallbackProjection=n.srs.wkt:this.projection=n.srs.wkt),this.pointAttributes="LAZ",this.spacing=(this.boundingBox.max.x-this.boundingBox.min.x)/this.span,n.hierarchyType;var c=n.dataType||"laszip";this.loader="binary"==c?new se:new ue})),fe=function(){function e(t,n,r,i,o,a){m(this,e),this.ept=t,this.b=n,this.d=r,this.x=i||0,this.y=o||0,this.z=a||0}return v(e,[{key:"name",value:function(){return this.d+"-"+this.x+"-"+this.y+"-"+this.z}},{key:"step",value:function(t,n,r){var i=this.b.min.clone(),o=this.b.max.clone(),a=(new O.Vector3).subVectors(o,i);return t?i.x+=a.x/2:o.x-=a.x/2,n?i.y+=a.y/2:o.y-=a.y/2,r?i.z+=a.z/2:o.z-=a.z/2,new e(this.ept,new O.Box3(i,o),this.d+1,2*this.x+t,2*this.y+n,2*this.z+r)}},{key:"children",value:function(){for(var e=[],t=0;t<2;++t)for(var n=0;n<2;++n)for(var r=0;r<2;++r){var i=this.step(t,n,r).name();e.includes(i)||(e=e.concat(i))}return e}}]),e}(),pe=function(e){d(r,e);var t,n=f(r);function r(e,t,i,o,a,s){var u;m(this,r),(u=n.call(this)).ept=e,u.key=new fe(u.ept,t||u.ept.boundingBox,i||0,o,a,s),u.id=r.IDCount++,u.geometry=null,u.boundingBox=u.key.b,u.tightBoundingBox=u.boundingBox,u.spacing=u.ept.spacing/Math.pow(2,u.key.d),u.boundingSphere=le.sphereFrom(u.boundingBox),u.hasChildren=!1,u.children={},u.numPoints=-1,u.level=u.key.d,u.loaded=!1,u.loading=!1,u.oneTimeDisposeHandlers=[];var c=u.key;return u.name=u.toPotreeName(c.d,c.x,c.y,c.z),u.index=parseInt(u.name.charAt(u.name.length-1)),u}return v(r,[{key:"isGeometryNode",value:function(){return!0}},{key:"getLevel",value:function(){return this.level}},{key:"isTreeNode",value:function(){return!1}},{key:"isLoaded",value:function(){return this.loaded}},{key:"getBoundingSphere",value:function(){return this.boundingSphere}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"url",value:function(){return this.ept.url+"ept-data/"+this.filename()}},{key:"getNumPoints",value:function(){return this.numPoints}},{key:"filename",value:function(){return this.key.name()}},{key:"getChildren",value:function(){for(var e=[],t=0;t<8;t++)this.children[t]&&e.push(this.children[t]);return e}},{key:"addChild",value:function(e){this.children[e.index]=e,e.parent=this}},{key:"load",value:function(){this.loaded||this.loading||C.numNodesLoading>=C.maxNodesLoading||(this.loading=!0,C.numNodesLoading++,-1===this.numPoints&&this.loadHierarchy(),this.loadPoints())}},{key:"loadPoints",value:function(){this.ept.loader.load(this)}},{key:"loadHierarchy",value:(t=c(u.mark((function e(){var t,n,i,o,a=this;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})[this.filename()]=this,this.hasChildren=!1,n="".concat(this.ept.url,"ept-hierarchy/").concat(this.filename(),".json"),e.next=5,H.fetch(n);case 5:return i=e.sent,e.next=8,i.json();case 8:o=e.sent,Object.keys(o).sort((function(e,t){var n=e.split("-").map((function(e){return parseInt(e,10)})),r=p(n,4),i=r[0],o=r[1],a=r[2],s=r[3],u=t.split("-").map((function(e){return parseInt(e,10)})),c=p(u,4),l=c[0],d=c[1],f=c[2],h=c[3];return i<l?-1:i>l?1:o<d?-1:o>d?1:a<f?-1:a>f?1:s<h?-1:s>h?1:0})).forEach((function(e){var n=e.split("-").map((function(e){return parseInt(e,10)})),i=p(n,4),s=i[0],u=i[1],c=i[2],l=i[3],d=1&u,f=1&c,h=1&l,v=t[s-1+"-"+(u>>1)+"-"+(c>>1)+"-"+(l>>1)];if(v){v.hasChildren=!0;var m=v.key.step(d,f,h),y=new r(a.ept,m.b,m.d,m.x,m.y,m.z);y.level=s,y.numPoints=o[e],v.addChild(y),t[m.name()]=y}}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"doneLoading",value:function(e,t,n,r){e.boundingBox=this.boundingBox,this.geometry=e,this.tightBoundingBox=t,this.numPoints=n,this.mean=r,this.loaded=!0,this.loading=!1,C.numNodesLoading--}},{key:"toPotreeName",value:function(e,t,n,r){for(var i="r",o=0;o<e;++o){var a=1<<e-o-1,s=0;t&a&&(s+=4),n&a&&(s+=2),r&a&&(s+=1),i+=s}return i}},{key:"dispose",value:function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var e=0;e<this.oneTimeDisposeHandlers.length;e++)(0,this.oneTimeDisposeHandlers[e])();this.oneTimeDisposeHandlers=[]}}}]),r}(z);pe.IDCount=0;var he=function(){function e(){m(this,e)}var t;return v(e,null,[{key:"load",value:(t=c(u.mark((function e(t,n){var r,i,o,a,s;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.fetch(t);case 2:return r=e.sent,e.next=5,r.json();case 5:i=e.sent,o=t.substr(0,t.lastIndexOf("ept.json")),a=new de(o,i),s=new pe(a),a.root=s,a.root.load(),n(a);case 10:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),ve=function(){function e(){m(this,e)}return v(e,null,[{key:"generateDataTexture",value:function(e,t,n){for(var r=e*t,i=new Uint8Array(4*e*t),o=Math.floor(255*n.r),a=Math.floor(255*n.g),s=Math.floor(255*n.b),u=0;u<r;u++)i[3*u]=o,i[3*u+1]=a,i[3*u+2]=s;var c=new O.DataTexture(i,e,t,O.RGBAFormat);return c.needsUpdate=!0,c.magFilter=O.NearestFilter,c}},{key:"computeTransformedBoundingBox",value:function(e,t){var n=[new O.Vector3(e.min.x,e.min.y,e.min.z).applyMatrix4(t),new O.Vector3(e.min.x,e.min.y,e.min.z).applyMatrix4(t),new O.Vector3(e.max.x,e.min.y,e.min.z).applyMatrix4(t),new O.Vector3(e.min.x,e.max.y,e.min.z).applyMatrix4(t),new O.Vector3(e.min.x,e.min.y,e.max.z).applyMatrix4(t),new O.Vector3(e.min.x,e.max.y,e.max.z).applyMatrix4(t),new O.Vector3(e.max.x,e.max.y,e.min.z).applyMatrix4(t),new O.Vector3(e.max.x,e.min.y,e.max.z).applyMatrix4(t),new O.Vector3(e.max.x,e.max.y,e.max.z).applyMatrix4(t)],r=new O.Box3;return r.setFromPoints(n),r}}]),e}(),me={RAINBOW:[[0,new O.Color(.278,0,.714)],[1/6,new O.Color(0,0,1)],[2/6,new O.Color(0,1,1)],[.5,new O.Color(0,1,0)],[4/6,new O.Color(1,1,0)],[5/6,new O.Color(1,.64,0)],[1,new O.Color(1,0,0)]],SPECTRAL:[[0,new O.Color(.3686,.3098,.6353)],[.1,new O.Color(.1961,.5333,.7412)],[.2,new O.Color(.4,.7608,.6471)],[.3,new O.Color(.6706,.8667,.6431)],[.4,new O.Color(.902,.9608,.5961)],[.5,new O.Color(1,1,.749)],[.6,new O.Color(.9961,.8784,.5451)],[.7,new O.Color(.9922,.6824,.3804)],[.8,new O.Color(.9569,.4275,.2627)],[.9,new O.Color(.8353,.2431,.3098)],[1,new O.Color(.6196,.0039,.2588)]],PLASMA:[[0,new O.Color(.241,.015,.61)],[.1,new O.Color(.387,.001,.654)],[.2,new O.Color(.524,.025,.653)],[.3,new O.Color(.651,.125,.596)],[.4,new O.Color(.752,.227,.513)],[.5,new O.Color(.837,.329,.431)],[.6,new O.Color(.907,.435,.353)],[.7,new O.Color(.963,.554,.272)],[.8,new O.Color(.992,.681,.195)],[.9,new O.Color(.987,.822,.144)],[1,new O.Color(.94,.975,.131)]],YELLOW_GREEN:[[0,new O.Color(.1647,.2824,.3451)],[.1,new O.Color(.1338,.3555,.4227)],[.2,new O.Color(.061,.4319,.4864)],[.3,new O.Color(0,.5099,.5319)],[.4,new O.Color(0,.5881,.5569)],[.5,new O.Color(.137,.665,.5614)],[.6,new O.Color(.2906,.7395,.5477)],[.7,new O.Color(.4453,.8099,.5201)],[.8,new O.Color(.6102,.8748,.485)],[.9,new O.Color(.7883,.9323,.4514)],[1,new O.Color(.9804,.9804,.4314)]],VIRIDIS:[[0,new O.Color(.267,.005,.329)],[.1,new O.Color(.283,.141,.458)],[.2,new O.Color(.254,.265,.53)],[.3,new O.Color(.207,.372,.553)],[.4,new O.Color(.164,.471,.558)],[.5,new O.Color(.128,.567,.551)],[.6,new O.Color(.135,.659,.518)],[.7,new O.Color(.267,.749,.441)],[.8,new O.Color(.478,.821,.318)],[.9,new O.Color(.741,.873,.15)],[1,new O.Color(.993,.906,.144)]],INFERNO:[[0,new O.Color(.077,.042,.206)],[.1,new O.Color(.225,.036,.388)],[.2,new O.Color(.373,.074,.432)],[.3,new O.Color(.522,.128,.42)],[.4,new O.Color(.665,.182,.37)],[.5,new O.Color(.797,.255,.287)],[.6,new O.Color(.902,.364,.184)],[.7,new O.Color(.969,.516,.063)],[.8,new O.Color(.988,.683,.072)],[.9,new O.Color(.961,.859,.298)],[1,new O.Color(.988,.998,.645)]],GRAYSCALE:[[0,new O.Color(0,0,0)],[1,new O.Color(1,1,1)]]},ye={};ye.vertex="\nprecision highp float;\nprecision highp int;\n\n"+O.ShaderChunk.common+"\n"+O.ShaderChunk.logdepthbuf_pars_vertex+"\n\n// attribute vec3 position;\n// attribute vec3 color;\nattribute float intensity;\nattribute float classification;\nattribute float returnNumber;\nattribute float numberOfReturns;\nattribute float pointSourceID;\nattribute vec4 indices;\nattribute float spacing;\n\n// uniform mat4 modelMatrix;\n// uniform mat4 modelViewMatrix;\n// uniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\nuniform mat4 uViewInv;\n\nuniform float uScreenWidth;\nuniform float uScreenHeight;\n\nuniform float fov;\nuniform float near;\nuniform float far;\n\nuniform bool uDebug;\n\nuniform float size;\nuniform float minSize;\nuniform float maxSize;\n\nuniform float uPCIndex;\nuniform float uOctreeSpacing;\nuniform float uNodeSpacing;\nuniform float uOctreeSize;\nuniform vec3 uBBSize;\nuniform float uLevel;\nuniform float uVNStart;\nuniform bool uIsLeafNode;\n\nuniform vec3 uColor;\nuniform float uOpacity;\n\nuniform vec2 elevationRange;\nuniform vec2 intensityRange;\nuniform float intensityGamma;\nuniform float intensityContrast;\nuniform float intensityBrightness;\nuniform float rgbGamma;\n// uniform float rgbContrast;\nuniform float rgbBrightness;\nuniform float uTransition;\nuniform float wRGB;\nuniform float wIntensity;\nuniform float wElevation;\nuniform float wClassification;\nuniform float wReturnNumber;\nuniform float wSourceID;\n\nuniform sampler2D visibleNodes;\nuniform sampler2D gradient;\nuniform sampler2D classificationLUT;\n\n#if defined(num_clipplanes) && num_clipplanes > 0 \n\nuniform vec4 clipPlanes[num_clipplanes];\n\nbool isClipped(vec3 point) {\n\tbool clipped = false;\n\tfor (int i = 0; i < num_clipplanes; ++i) {\n\t\tvec4 p = clipPlanes[i];\n\t\tclipped = clipped || dot(-point, p.xyz) > p.w;\n\t}\n\treturn clipped;\n}\n\n#else\n\nbool isClipped(vec3 point) {\n\treturn false;\n}\n\n#endif\n\nvarying vec3 vColor;\nvarying float vLogDepth;\nvarying vec3 vViewPosition;\nvarying float vRadius;\nvarying float vPointSize;\n\n// The round() function is not available in WebGL 1.0\nfloat myRound(float number)\n{\n\treturn floor(number + 0.5);\n}\n\n//---------------------\n//OCTREE\n//---------------------\n\n#if (defined(adaptive_point_size) || defined(color_type_lod)) && defined(tree_type_octree)\n\t/**\n\t * number of 1-bits up to inclusive index position\n\t * number is treated as if it were an integer in the range 0-255\n\t */\n\tint numberOfOnes(int number, int index)\n\t{\n\t\tint numOnes = 0;\n\t\tint tmp = 128;\n\n\t\tfor(int i = 7; i >= 0; i--)\n\t\t{\n\t\t\tif(number >= tmp)\n\t\t\t{\n\t\t\t\tnumber = number - tmp;\n\n\t\t\t\tif(i <= index)\n\t\t\t\t{\n\t\t\t\t\tnumOnes++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttmp = tmp / 2;\n\t\t}\n\n\t\treturn numOnes;\n\t}\n\n\t/**\n\t * checks whether the bit at index is 1\n\t * number is treated as if it were an integer in the range 0-255\n\t */\n\tbool isBitSet(int number, int index)\n\t{\n\t\t//weird multi else if due to lack of proper array, int and bitwise support in WebGL 1.0\n\t\tint powi = 1;\n\n\t\tif(index == 0)\n\t\t{\n\t\t\tpowi = 1;\n\t\t}\n\t\telse if(index == 1)\n\t\t{\n\t\t\tpowi = 2;\n\t\t}\n\t\telse if(index == 2)\n\t\t{\n\t\t\tpowi = 4;\n\t\t}\n\t\telse if(index == 3)\n\t\t{\n\t\t\tpowi = 8;\n\t\t}\n\t\telse if(index == 4)\n\t\t{\n\t\t\tpowi = 16;\n\t\t}\n\t\telse if(index == 5)\n\t\t{\n\t\t\tpowi = 32;\n\t\t}\n\t\telse if(index == 6)\n\t\t{\n\t\t\tpowi = 64;\n\t\t}\n\t\telse if(index == 7)\n\t\t{\n\t\t\tpowi = 128;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tint ndp = number / powi;\n\n\t\treturn mod(float(ndp), 2.0) != 0.0;\n\t}\n\n\t/**\n\t * find the LOD at the point position\n\t */\n\tfloat getLOD()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tint iOffset = int(uVNStart);\n\t\tfloat depth = uLevel;\n\n\t\tfor(float i = 0.0; i <= 30.0; i++)\n\t\t{\n\t\t\tfloat nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n\t\t\t\n\t\t\tvec3 index3d = (position-offset) / nodeSizeAtLevel;\n\t\t\tindex3d = floor(index3d + 0.5);\n\t\t\tint index = int(myRound(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n\t\t\tint mask = int(myRound(value.r * 255.0));\n\n\t\t\tif(isBitSet(mask, index))\n\t\t\t{\n\t\t\t\t//there are more visible child nodes at this position\n\t\t\t\tint advanceG = int(myRound(value.g * 255.0)) * 256;\n\t\t\t\tint advanceB = int(myRound(value.b * 255.0));\n\t\t\t\tint advanceChild = numberOfOnes(mask, index - 1);\n\t\t\t\tint advance = advanceG + advanceB + advanceChild;\n\n\t\t\t\tiOffset = iOffset + advance;\n\t\t\t\t\n\t\t\t\tdepth++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//no more visible child nodes at this position\n\t\t\t\treturn value.a * 255.0;\n\t\t\t\t//return depth;\n\t\t\t}\n\t\t\t\n\t\t\toffset = offset + (vec3(1.0, 1.0, 1.0) * nodeSizeAtLevel * 0.5) * index3d;\n\t\t}\n\t\t\t\n\t\treturn depth;\n\t}\n\n\tfloat getSpacing()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tint iOffset = int(uVNStart);\n\t\tfloat depth = uLevel;\n\t\tfloat spacing = uNodeSpacing;\n\n\t\tfor(float i = 0.0; i <= 30.0; i++)\n\t\t{\n\t\t\tfloat nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n\t\t\t\n\t\t\tvec3 index3d = (position-offset) / nodeSizeAtLevel;\n\t\t\tindex3d = floor(index3d + 0.5);\n\t\t\tint index = int(myRound(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n\t\t\tint mask = int(myRound(value.r * 255.0));\n\t\t\tfloat spacingFactor = value.a;\n\n\t\t\tif(i > 0.0)\n\t\t\t{\n\t\t\t\tspacing = spacing / (255.0 * spacingFactor);\n\t\t\t}\n\t\t\t\n\t\t\tif(isBitSet(mask, index))\n\t\t\t{\n\t\t\t\t//there are more visible child nodes at this position\n\t\t\t\tint advanceG = int(myRound(value.g * 255.0)) * 256;\n\t\t\t\tint advanceB = int(myRound(value.b * 255.0));\n\t\t\t\tint advanceChild = numberOfOnes(mask, index - 1);\n\t\t\t\tint advance = advanceG + advanceB + advanceChild;\n\n\t\t\t\tiOffset = iOffset + advance;\n\n\t\t\t\tdepth++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//no more visible child nodes at this position\n\t\t\t\treturn spacing;\n\t\t\t}\n\t\t\t\n\t\t\toffset = offset + (vec3(1.0, 1.0, 1.0) * nodeSizeAtLevel * 0.5) * index3d;\n\t\t}\n\t\t\t\n\t\treturn spacing;\n\t}\n\n\tfloat getPointSizeAttenuation()\n\t{\n\t\treturn pow(2.0, getLOD());\n\t}\n#endif\n\n//---------------------\n//KD-TREE\n//---------------------\n#if (defined(adaptive_point_size) || defined(color_type_lod)) && defined(tree_type_kdtree)\n\tfloat getLOD()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tfloat iOffset = 0.0;\n\t\tfloat depth = 0.0;\n\t\t\t\n\t\tvec3 size = uBBSize;\t\n\t\tvec3 pos = position;\n\t\t\t\n\t\tfor(float i = 0.0; i <= 1000.0; i++)\n\t\t{\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(iOffset / 2048.0, 0.0));\n\t\t\t\n\t\t\tint children = int(value.r * 255.0);\n\t\t\tfloat next = value.g * 255.0;\n\t\t\tint split = int(value.b * 255.0);\n\t\t\t\n\t\t\tif(next == 0.0)\n\t\t\t{\n\t\t\t \treturn depth;\n\t\t\t}\n\t\t\t\n\t\t\tvec3 splitv = vec3(0.0, 0.0, 0.0);\n\t\t\tif(split == 1)\n\t\t\t{\n\t\t\t\tsplitv.x = 1.0;\n\t\t\t}\n\t\t\telse if(split == 2)\n\t\t\t{\n\t\t\t \tsplitv.y = 1.0;\n\t\t\t}\n\t\t\telse if(split == 4)\n\t\t\t{\n\t\t\t \tsplitv.z = 1.0;\n\t\t\t}\n\t\t\t\n\t\t\tiOffset = iOffset + next;\n\t\t\t\n\t\t\tfloat factor = length(pos * splitv / size);\n\n\t\t\t//Left\n\t\t\tif(factor < 0.5)\n\t\t\t{\n\t\t\t\tif(children == 0 || children == 2)\n\t\t\t\t{\n\t\t\t\t\treturn depth;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Right\n\t\t\telse\n\t\t\t{\n\t\t\t\tpos = pos - size * splitv * 0.5;\n\t\t\t\tif(children == 0 || children == 1)\n\t\t\t\t{\n\t\t\t\t\treturn depth;\n\t\t\t\t}\n\t\t\t\tif(children == 3)\n\t\t\t\t{\n\t\t\t\t\tiOffset = iOffset + 1.0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsize = size * ((1.0 - (splitv + 1.0) / 2.0) + 0.5);\n\t\t\tdepth++;\n\t\t}\n\t\t\t\n\t\treturn depth;\t\n\t}\n\n\tfloat getPointSizeAttenuation()\n\t{\n\t\treturn 0.5 * pow(1.3, getLOD());\n\t}\n#endif\n\n//formula adapted from: http://www.dfstudios.co.uk/articles/programming/image-programming-algorithms/image-processing-algorithms-part-5-contrast-adjustment/\nfloat getContrastFactor(float contrast)\n{\n\treturn (1.0158730158730156 * (contrast + 1.0)) / (1.0158730158730156 - contrast);\n}\n\nvec3 getRGB()\n{\n\tvec3 rgb = color;\n\t\n\trgb = pow(rgb, vec3(rgbGamma));\n\trgb = rgb + rgbBrightness;\n\trgb = clamp(rgb, 0.0, 1.0);\n\t\n\treturn rgb;\n}\n\nfloat getIntensity()\n{\n\tfloat w = (intensity - intensityRange.x) / (intensityRange.y - intensityRange.x);\n\tw = pow(w, intensityGamma);\n\tw = w + intensityBrightness;\n\tw = (w - 0.5) * getContrastFactor(intensityContrast) + 0.5;\n\tw = clamp(w, 0.0, 1.0);\n\n\treturn w;\n}\n\nvec3 getElevation()\n{\n\tvec4 world = modelMatrix * vec4( position, 1.0 );\n\tfloat w = (world.z - elevationRange.x) / (elevationRange.y - elevationRange.x);\n\treturn texture2D(gradient, vec2(w,1.0-w)).rgb;\n}\n\nvec4 getClassification()\n{\n\tvec2 uv = vec2(classification / 255.0, 0.5);\n\treturn texture2D(classificationLUT, uv);\n}\n\nvec3 getReturnNumber()\n{\n\tif(numberOfReturns == 1.0)\n\t{\n\t\treturn vec3(1.0, 1.0, 0.0);\n\t}\n\telse\n\t{\n\t\tif(returnNumber == 1.0)\n\t\t{\n\t\t\treturn vec3(1.0, 0.0, 0.0);\n\t\t}\n\t\telse if(returnNumber == numberOfReturns)\n\t\t{\n\t\t\treturn vec3(0.0, 0.0, 1.0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn vec3(0.0, 1.0, 0.0);\n\t\t}\n\t}\n}\n\nvec3 getSourceID()\n{\n\tfloat w = mod(pointSourceID, 10.0) / 10.0;\n\treturn texture2D(gradient, vec2(w,1.0 - w)).rgb;\n}\n\nvec3 getCompositeColor()\n{\n\tvec3 c;\n\tfloat w;\n\n\tc += wRGB * getRGB();\n\tw += wRGB;\n\t\n\tc += wIntensity * getIntensity() * vec3(1.0, 1.0, 1.0);\n\tw += wIntensity;\n\t\n\tc += wElevation * getElevation();\n\tw += wElevation;\n\t\n\tc += wReturnNumber * getReturnNumber();\n\tw += wReturnNumber;\n\t\n\tc += wSourceID * getSourceID();\n\tw += wSourceID;\n\t\n\tvec4 cl = wClassification * getClassification();\n    c += cl.a * cl.rgb;\n\tw += wClassification * cl.a;\n\n\tc = c / w;\n\t\n\tif(w == 0.0)\n\t{\n\t\tgl_Position = vec4(100.0, 100.0, 100.0, 0.0);\n\t}\n\t\n\treturn c;\n}\n\nvec3 getColor()\n{\n\tvec3 color;\n\t\n\t#ifdef color_type_rgb\n\t\tcolor = getRGB();\n\t#elif defined color_type_height\n\t\tcolor = getElevation();\n\t#elif defined color_type_rgb_height\n\t\tvec3 cHeight = getElevation();\n\t\tcolor = (1.0 - uTransition) * getRGB() + uTransition * cHeight;\n\t#elif defined color_type_depth\n\t\tfloat linearDepth = gl_Position.w;\n\t\tfloat expDepth = (gl_Position.z / gl_Position.w) * 0.5 + 0.5;\n\t\tcolor = vec3(linearDepth, expDepth, 0.0);\n\t#elif defined color_type_intensity\n\t\tfloat w = getIntensity();\n\t\tcolor = vec3(w, w, w);\n\t#elif defined color_type_intensity_gradient\n\t\tfloat w = getIntensity();\n\t\tcolor = texture2D(gradient, vec2(w,1.0-w)).rgb;\n\t#elif defined color_type_color\n\t\tcolor = uColor;\n\t#elif defined color_type_lod\n\t\tfloat depth = getLOD();\n\t\tfloat w = depth / 10.0;\n\t\tcolor = texture2D(gradient, vec2(w,1.0-w)).rgb;\n\t#elif defined color_type_point_index\n\t\tcolor = indices.rgb;\n\t#elif defined color_type_classification\n\t\tvec4 cl = getClassification(); \n\t\tcolor = cl.rgb;\n\t#elif defined color_type_return_number\n\t\tcolor = getReturnNumber();\n\t#elif defined color_type_source\n\t\tcolor = getSourceID();\n\t#elif defined color_type_normal\n\t\tcolor = (modelMatrix * vec4(normal, 0.0)).xyz;\n\t#elif defined color_type_phong\n\t\tcolor = color;\n\t#elif defined color_type_composite\n\t\tcolor = getCompositeColor();\n\t#endif\n\t\n\treturn color;\n}\n\nfloat getPointSize()\n{\n\tfloat pointSize = 1.0;\n\t\n\tfloat slope = tan(fov / 2.0);\n\tfloat projFactor = -0.5 * uScreenHeight / (slope * vViewPosition.z);\n\t\n\tfloat r = uOctreeSpacing * 1.7;\n\tvRadius = r;\n\n\t#if defined fixed_point_size\n\t\tpointSize = size;\n\t#elif defined attenuated_point_size\n\t\tpointSize = size * spacing * projFactor;\n\t#elif defined adaptive_point_size\n\t\tif(uIsLeafNode && false)\n\t\t{\n\t\t\tpointSize = size * spacing * projFactor;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfloat worldSpaceSize = 1.0 * size * r / getPointSizeAttenuation();\n\t\t\tpointSize = worldSpaceSize * projFactor;\n\t\t}\n\t#endif\n\n\tpointSize = max(minSize, pointSize);\n\tpointSize = min(maxSize, pointSize);\n\t\n\tvRadius = pointSize / projFactor;\n\n\treturn pointSize;\n}\n\nvoid main()\n{\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tvViewPosition = mvPosition.xyz;\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tvLogDepth = log2(-mvPosition.z);\n\n\t//POINT SIZE\n\tfloat pointSize = getPointSize();\n\tgl_PointSize = pointSize;\n\tvPointSize = pointSize;\n\t"+O.ShaderChunk.logdepthbuf_vertex+"\n\n\t//COLOR\n\tvColor = getColor();\n\n\t#if defined hq_depth_pass\n\t\tfloat originalDepth = gl_Position.w;\n\t\tfloat adjustedDepth = originalDepth + 2.0 * vRadius;\n\t\tfloat adjust = adjustedDepth / originalDepth;\n\n\t\tmvPosition.xyz = mvPosition.xyz * adjust;\n\t\tgl_Position = projectionMatrix * mvPosition;\n\t#endif\n\n\t// CLIPPING\n\tvec4 clipPosition = modelMatrix * vec4( position, 1.0 );\n\tif (isClipped(clipPosition.xyz)) {\n\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0); // Outside clip volume\n\t} \n}",ye.fragment="\n\n#if defined USE_LOGDEPTHBUF_EXT || defined paraboloid_point_shape\n\t#extension GL_EXT_frag_depth : enable\n#endif\n\nprecision highp float;\nprecision highp int;\n\n"+O.ShaderChunk.common+"\n"+O.ShaderChunk.logdepthbuf_pars_fragment+"\n\n// uniform mat4 viewMatrix;\nuniform mat4 uViewInv;\n// uniform mat4 uProjInv;\n// uniform vec3 cameraPosition;\n\nuniform mat4 projectionMatrix;\nuniform float uOpacity;\n\nuniform float fov;\nuniform float uSpacing;\nuniform float near;\nuniform float far;\nuniform float uPCIndex;\nuniform float uScreenWidth;\nuniform float uScreenHeight;\n\nvarying vec3 vColor;\nvarying float vLogDepth;\nvarying vec3 vViewPosition;\nvarying float vRadius;\nvarying float vPointSize;\nvarying vec3 vPosition;\n\nvoid main()\n{\n\tvec3 color = vColor;\n\tfloat depth = gl_FragCoord.z;\n\n\t#if defined circle_point_shape || defined paraboloid_point_shape\n\t\tfloat u = (2.0 * gl_PointCoord.x) - 1.0;\n\t\tfloat v = (2.0 * gl_PointCoord.y) - 1.0;\n\t#endif\n\t\n\t#if defined circle_point_shape\n\t\tfloat cc = (u*u) + (v*v);\n\t\tif(cc > 1.0)\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n\n\t#if defined color_type_point_index\n\t\tgl_FragColor = vec4(color, uPCIndex / 255.0);\n\t#else\n\t\tgl_FragColor = vec4(color, uOpacity);\n\t#endif\n\n\t#if defined paraboloid_point_shape\n\t\tfloat wi = -( u*u + v*v);\n\t\tvec4 pos = vec4(vViewPosition, 1.0);\n\t\tpos.z += wi * vRadius;\n\t\tfloat linearDepth = -pos.z;\n\t\tpos = projectionMatrix * pos;\n\t\tpos = pos / pos.w;\n\t\tfloat expDepth = pos.z;\n\t\tdepth = (pos.z + 1.0) / 2.0;\n\n\t\tgl_FragDepthEXT = depth;\n\t\t\n\t\t#if defined color_type_depth\n\t\t\tcolor.r = linearDepth;\n\t\t\tcolor.g = expDepth;\n\t\t#endif\n\t#endif\n\t\n\t"+O.ShaderChunk.logdepthbuf_fragment+"\n\n\t#if defined weighted_splats\n\t\tfloat distance = 2.0 * length(gl_PointCoord.xy - 0.5);\n\t\tfloat weight = max(0.0, 1.0 - distance);\n\t\tweight = pow(weight, 1.5);\n\n\t\tgl_FragColor.a = weight;\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * weight;\n\t#endif\n}";var ge=function(e){d(n,e);var t=f(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,n),(e=t.call(this)).visibleNodesTexture=ve.generateDataTexture(2048,1,new O.Color(16777215)),e.visibleNodesTexture.minFilter=O.NearestFilter,e.visibleNodesTexture.magFilter=O.NearestFilter;var i=function(e,t){return void 0!==e?e:t},o=i(r.size,1),a=i(r.minSize,2),s=i(r.maxSize,50),u=i(r.treeType,Oe.OCTREE);return e._pointSizeType=Ae.FIXED,e._shape=Pe.SQUARE,e._pointColorType=Ce.RGB,e._weighted=!1,e._gradient=me.SPECTRAL,e._treeType=u,e._defaultIntensityRangeChanged=!1,e._defaultElevationRangeChanged=!1,e.gradientTexture=n.generateGradientTexture(e._gradient),e.lights=!1,e.fog=!1,e.defines=new Map,e.attributes={position:{type:"fv",value:[]},color:{type:"fv",value:[]},normal:{type:"fv",value:[]},intensity:{type:"f",value:[]},classification:{type:"f",value:[]},returnNumber:{type:"f",value:[]},numberOfReturns:{type:"f",value:[]},pointSourceID:{type:"f",value:[]},indices:{type:"fv",value:[]}},e.uniforms={projectionMatrix:{value:new O.Matrix4},uViewInv:{value:new O.Matrix4},clipPlanes:{value:[]},level:{type:"f",value:0},vnStart:{type:"f",value:0},spacing:{type:"f",value:1},fov:{type:"f",value:1},uScreenWidth:{type:"f",value:1},uScreenHeight:{type:"f",value:1},uOctreeSpacing:{type:"f",value:0},near:{type:"f",value:.1},far:{type:"f",value:1},uColor:{type:"c",value:new O.Color(16777215)},uOpacity:{type:"f",value:1},size:{type:"f",value:o},minSize:{type:"f",value:a},maxSize:{type:"f",value:s},octreeSize:{type:"f",value:0},bbSize:{type:"fv",value:[0,0,0]},elevationRange:{type:"2fv",value:[0,0]},visibleNodes:{type:"t",value:e.visibleNodesTexture},gradient:{type:"t",value:e.gradientTexture},classificationLUT:{type:"t",value:null},diffuse:{type:"fv",value:[1,1,1]},transition:{type:"f",value:.5},intensityRange:{type:"fv",value:[0,65e3]},intensityGamma:{type:"f",value:1},intensityContrast:{type:"f",value:0},intensityBrightness:{type:"f",value:0},rgbGamma:{type:"f",value:1},rgbBrightness:{type:"f",value:0},uTransition:{type:"f",value:0},wRGB:{type:"f",value:1},wIntensity:{type:"f",value:0},wElevation:{type:"f",value:0},wClassification:{type:"f",value:0},wReturnNumber:{type:"f",value:0},wSourceID:{type:"f",value:0},logDepthBufFC:{type:"f",value:0},uPCIndex:{value:0}},e.classification=ke.DEFAULT,e.defaultAttributeValues.normal=[0,0,0],e.defaultAttributeValues.classification=[0,0,0],e.defaultAttributeValues.indices=[0,0,0,0],e.defines=e.getDefines(),e.vertexColors=O.VertexColors,e.vertexShader=ye.vertex,e.fragmentShader=ye.fragment,e}return v(n,[{key:"setDefine",value:function(e,t){null!=t?this.defines.get(e)!==t&&(this.defines.set(e,t),this.updateMaterial()):this.removeDefine(e)}},{key:"removeDefine",value:function(e){this.defines.delete(e)}},{key:"updateMaterial",value:function(){this.defines=this.getDefines(),1===this.opacity?(this.blending=O.NoBlending,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.depthFunc=O.LessEqualDepth):(this.blending=O.AdditiveBlending,this.transparent=!0,this.depthTest=!1,this.depthWrite=!0,this.depthFunc=O.AlwaysDepth),this.weighted&&(this.blending=O.AdditiveBlending,this.transparent=!0,this.depthTest=!0,this.depthWrite=!1),this.needsUpdate=!0}},{key:"onBeforeCompile",value:function(e,t){t.capabilities.logarithmicDepthBuffer&&(this.defines=o(o({},this.defines),{},{USE_LOGDEPTHBUF:!0,USE_LOGDEPTHBUF_EXT:!0,EPSILON:1e-6}))}},{key:"getDefines",value:function(){var e=[];e[Ae.FIXED]={fixed_point_size:!0},e[Ae.ATTENUATED]={attenuated_point_size:!0},e[Ae.ADAPTIVE]={adaptive_point_size:!0};var t=[];t[Pe.SQUARE]={square_point_shape:!0},t[Pe.CIRCLE]={circle_point_shape:!0},t[Pe.PARABOLOID]={paraboloid_point_shape:!0};var n=[];n[Ce.RGB]={color_type_rgb:!0},n[Ce.COLOR]={color_type_color:!0},n[Ce.DEPTH]={color_type_depth:!0},n[Ce.COLOR]={color_type_color:!0},n[Ce.HEIGHT]={color_type_height:!0},n[Ce.INTENSITY]={color_type_intensity:!0},n[Ce.INTENSITY_GRADIENT]={color_type_intensity_gradient:!0},n[Ce.POINT_INDEX]={color_type_point_index:!0},n[Ce.CLASSIFICATION]={color_type_classification:!0},n[Ce.RETURN_NUMBER]={color_type_return_number:!0},n[Ce.SOURCE]={color_type_source:!0},n[Ce.NORMAL]={color_type_normal:!0},n[Ce.RGB]={color_type_rgb:!0},n[Ce.PHONG]={color_type_phong:!0},n[Ce.RGB_HEIGHT]={color_type_rgb_height:!0},n[Ce.COMPOSITE]={color_type_composite:!0};var r=[];return r[Oe.OCTREE]={tree_type_octree:!0},r[Oe.KDTREE]={tree_type_kdtree:!0},o(o(o(o(o({},e[this.pointSizeType]),t[this.shape]),n[this._pointColorType]),r[this.treeType]),this.weighted?{weighted_splats:!0}:{})}},{key:"gradient",get:function(){return this._gradient},set:function(e){this._gradient!==e&&(this._gradient=e,this.gradientTexture=n.generateGradientTexture(this._gradient),this.uniforms.gradient.value=this.gradientTexture)}},{key:"classification",get:function(){return this._classification},set:function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++)t[s=r[n]]=e[s].clone();var i=!1;if(void 0===this._classification)i=!1;else for(var o=0,a=(i=Object.keys(t).length===Object.keys(this._classification).length,Object.keys(t));o<a.length;o++){var s=a[o];i=(i=i&&void 0!==this._classification[s])&&t[s].equals(this._classification[s])}i||(this._classification=t,this.recomputeClassification())}},{key:"recomputeClassification",value:function(){this.classificationTexture=n.generateClassificationTexture(this._classification),this.uniforms.classificationLUT.value=this.classificationTexture,this.dispatchEvent({type:"material_property_changed",target:this})}},{key:"spacing",get:function(){return this.uniforms.spacing.value},set:function(e){this.uniforms.spacing.value!==e&&(this.uniforms.spacing.value=e)}},{key:"weighted",get:function(){return this._weighted},set:function(e){this._weighted!==e&&(this._weighted=e,this.updateMaterial())}},{key:"fov",get:function(){return this.uniforms.fov.value},set:function(e){this.uniforms.fov.value!==e&&(this.uniforms.fov.value=e,this.updateMaterial())}},{key:"screenWidth",get:function(){return this.uniforms.screenWidth.value},set:function(e){this.uniforms.screenWidth.value!==e&&(this.uniforms.screenWidth.value=e,this.updateMaterial())}},{key:"screenHeight",get:function(){return this.uniforms.screenHeight.value},set:function(e){this.uniforms.screenHeight.value!==e&&(this.uniforms.screenHeight.value=e,this.updateMaterial())}},{key:"near",get:function(){return this.uniforms.near.value},set:function(e){this.uniforms.near.value!==e&&(this.uniforms.near.value=e)}},{key:"far",get:function(){return this.uniforms.far.value},set:function(e){this.uniforms.far.value!==e&&(this.uniforms.far.value=e)}},{key:"opacity",get:function(){return this.uniforms.uOpacity.value},set:function(e){this.uniforms&&this.uniforms.uOpacity&&this.uniforms.uOpacity.value!==e&&(this.uniforms.uOpacity.value=e,this.updateMaterial(),this.dispatchEvent({type:"opacity_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"pointColorType",get:function(){return this._pointColorType},set:function(e){this._pointColorType!==e&&(this._pointColorType=e,this.updateMaterial(),this.dispatchEvent({type:"point_color_type_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"pointSizeType",get:function(){return this._pointSizeType},set:function(e){this._pointSizeType!==e&&(this._pointSizeType=e,this.updateMaterial(),this.dispatchEvent({type:"point_size_type_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"color",get:function(){return this.uniforms.uColor.value},set:function(e){this.uniforms.uColor.value.equals(e)||(this.uniforms.uColor.value.copy(e),this.dispatchEvent({type:"color_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"shape",get:function(){return this._shape},set:function(e){this._shape!==e&&(this._shape=e,this.updateMaterial(),this.dispatchEvent({type:"point_shape_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"treeType",get:function(){return this._treeType},set:function(e){this._treeType!==e&&(this._treeType=e,this.updateMaterial())}},{key:"bbSize",get:function(){return this.uniforms.bbSize.value},set:function(e){this.uniforms.bbSize.value=e}},{key:"size",get:function(){return this.uniforms.size.value},set:function(e){this.uniforms.size.value!==e&&(this.uniforms.size.value=e,this.dispatchEvent({type:"point_size_changed",target:this}),this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"elevationRange",get:function(){return this.uniforms.elevationRange.value},set:function(e){(this.uniforms.elevationRange.value[0]!==e[0]||this.uniforms.elevationRange.value[1]!==e[1])&&(this.uniforms.elevationRange.value=e,this._defaultElevationRangeChanged=!0,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"heightMin",get:function(){return this.uniforms.elevationRange.value[0]},set:function(e){this.elevationRange=[e,this.elevationRange[1]]}},{key:"heightMax",get:function(){return this.uniforms.elevationRange.value[1]},set:function(e){this.elevationRange=[this.elevationRange[0],e]}},{key:"transition",get:function(){return this.uniforms.transition.value},set:function(e){this.uniforms.transition.value=e}},{key:"intensityRange",get:function(){return this.uniforms.intensityRange.value},set:function(e){e instanceof Array&&2===e.length&&(e[0]===this.uniforms.intensityRange.value[0]&&e[1]===this.uniforms.intensityRange.value[1]||(this.uniforms.intensityRange.value=e,this._defaultIntensityRangeChanged=!0,this.dispatchEvent({type:"material_property_changed",target:this})))}},{key:"intensityGamma",get:function(){return this.uniforms.intensityGamma.value},set:function(e){this.uniforms.intensityGamma.value!==e&&(this.uniforms.intensityGamma.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"intensityContrast",get:function(){return this.uniforms.intensityContrast.value},set:function(e){this.uniforms.intensityContrast.value!==e&&(this.uniforms.intensityContrast.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"intensityBrightness",get:function(){return this.uniforms.intensityBrightness.value},set:function(e){this.uniforms.intensityBrightness.value!==e&&(this.uniforms.intensityBrightness.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"rgbGamma",get:function(){return this.uniforms.rgbGamma.value},set:function(e){this.uniforms.rgbGamma.value!==e&&(this.uniforms.rgbGamma.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"rgbBrightness",get:function(){return this.uniforms.rgbBrightness.value},set:function(e){this.uniforms.rgbBrightness.value!==e&&(this.uniforms.rgbBrightness.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightRGB",get:function(){return this.uniforms.wRGB.value},set:function(e){this.uniforms.wRGB.value!==e&&(this.uniforms.wRGB.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightIntensity",get:function(){return this.uniforms.wIntensity.value},set:function(e){this.uniforms.wIntensity.value!==e&&(this.uniforms.wIntensity.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightElevation",get:function(){return this.uniforms.wElevation.value},set:function(e){this.uniforms.wElevation.value!==e&&(this.uniforms.wElevation.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightClassification",get:function(){return this.uniforms.wClassification.value},set:function(e){this.uniforms.wClassification.value!==e&&(this.uniforms.wClassification.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightReturnNumber",get:function(){return this.uniforms.wReturnNumber.value},set:function(e){this.uniforms.wReturnNumber.value!==e&&(this.uniforms.wReturnNumber.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"weightSourceID",get:function(){return this.uniforms.wSourceID.value},set:function(e){this.uniforms.wSourceID.value!==e&&(this.uniforms.wSourceID.value=e,this.dispatchEvent({type:"material_property_changed",target:this}))}},{key:"disableEvents",value:function(){void 0===this._hiddenListeners&&(this._hiddenListeners=this._listeners,this._listeners={})}},{key:"enableEvents",value:function(){this._listeners=this._hiddenListeners,this._hiddenListeners=void 0}},{key:"copyFrom",value:function(e){var t,n=h(this.uniforms);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.uniforms[r].value=e.uniforms[r].value}}catch(e){n.e(e)}finally{n.f()}}}],[{key:"generateGradientTexture",value:function(e){var t=document.createElement("canvas");t.width=64,t.height=64;var n=t.getContext("2d");n.rect(0,0,64,64);for(var r=n.createLinearGradient(0,0,64,64),i=0;i<e.length;i++){var o=e[i];r.addColorStop(o[0],"#"+o[1].getHexString())}n.fillStyle=r,n.fill();var a=new O.CanvasTexture(t);return a.needsUpdate=!0,a.minFilter=O.LinearFilter,a}},{key:"generateClassificationTexture",value:function(e){for(var t=new Uint8Array(262144),n=0;n<256;n++)for(var r=0;r<256;r++){var i,o=n+256*r;i=e[n]?e[n]:e[n%32]?e[n%32]:e.DEFAULT,t[4*o+0]=255*i.x,t[4*o+1]=255*i.y,t[4*o+2]=255*i.z,t[4*o+3]=255*i.w}var a=new O.DataTexture(t,256,256,O.RGBAFormat);return a.magFilter=O.NearestFilter,a.wrapS=a.wrapT=O.ClampToEdgeWrapping,a.needsUpdate=!0,a}}]),n}(O.ShaderMaterial),be=function(e){d(n,e);var t=f(n);function n(){var e;return m(this,n),(e=t.call(this)).children={},e.sceneNode=null,e.octree=null,e}return v(n,[{key:"getNumPoints",value:function(){return this.geometryNode.numPoints}},{key:"isLoaded",value:function(){return!0}},{key:"isTreeNode",value:function(){return!0}},{key:"isGeometryNode",value:function(){return!1}},{key:"getLevel",value:function(){return this.geometryNode.level}},{key:"getBoundingSphere",value:function(){return this.geometryNode.boundingSphere}},{key:"getBoundingBox",value:function(){return this.geometryNode.boundingBox}},{key:"getChildren",value:function(){for(var e=[],t=0;t<8;t++)this.children[t]&&e.push(this.children[t]);return e}},{key:"getPointsInBox",value:function(e){if(!this.sceneNode)return null;for(var t=this.geometryNode.buffer,n=t.offset("position"),r=t.stride,i=new DataView(t.data),o=(new O.Matrix4).getInverse(e.matrixWorld),a=(new O.Matrix4).multiplyMatrices(o,this.sceneNode.matrixWorld),s=[],u=new O.Vector4,c=0;c<t.numElements;c++){var l=i.getFloat32(c*r+n+0,!0),d=i.getFloat32(c*r+n+4,!0),f=i.getFloat32(c*r+n+8,!0);u.set(l,d,f,1),u.applyMatrix4(a),-.5<u.x&&u.x<.5&&-.5<u.y&&u.y<.5&&-.5<u.z&&u.z<.5&&(u.set(l,d,f,1).applyMatrix4(this.sceneNode.matrixWorld),s.push(new O.Vector3(u.x,u.y,u.z)))}return s}},{key:"name",get:function(){return this.geometryNode.name}}]),n}(z),xe=function(e){d(n,e);var t=f(n);function n(e,r){var i;m(this,n),(i=t.call(this)).pointBudget=1/0,i.pcoGeometry=e,i.boundingBox=i.pcoGeometry.boundingBox,i.boundingSphere=i.boundingBox.getBoundingSphere(new O.Sphere),i.material=r||new ge,i.visiblePointsTarget=2e6,i.minimumNodePixelSize=150,i.level=0,i.position.copy(e.offset),i.updateMatrix(),i.showBoundingBox=!1,i.boundingBoxNodes=[],i.loadQueue=[],i.visibleBounds=new O.Box3,i.visibleNodes=[],i.visibleGeometry=[],i.generateDEM=!1,i.profileRequests=[],i.name="",i.tempVector3=new O.Vector3;var o=[i.pcoGeometry.tightBoundingBox,i.getBoundingBoxWorld()].find((function(e){return void 0!==e}));i.updateMatrixWorld(!0);var a=(o=ve.computeTransformedBoundingBox(o,i.matrixWorld)).min.z,s=o.max.z;return i.material.heightMin=a,i.material.heightMax=s,i.projection=e.projection,i.root=i.pcoGeometry.root,i}return v(n,[{key:"setName",value:function(e){this.name!==e&&(this.name=e,this.dispatchEvent({type:"name_changed",name:e,pointcloud:this}))}},{key:"getName",value:function(){return this.name}},{key:"toTreeNode",value:function(e,t){var n=this,r=new be,i=new O.Points(e.geometry,this.material);for(var o in i.name=e.name,i.position.copy(e.boundingBox.min),i.frustumCulled=!0,i.onBeforeRender=function(t,i,o,a,s,u){var c=null;n.visibleNodeTextureOffsets&&(c=n.visibleNodeTextureOffsets.get(r));var l=r.pcIndex?r.pcIndex:n.visibleNodes.indexOf(r),d=e.getLevel();s.uniforms.level.value=d,s.uniforms.vnStart.value=c,s.uniforms.uPCIndex.value=l,n.updateMaterial(s,o,t)},r.geometryNode=e,r.sceneNode=i,r.pointcloud=this,r.children={},e.children)r.children[o]=e.children[o];if(t){var a=parseInt(e.name[e.name.length-1]);t.sceneNode.add(i),t.children[a]=r}else this.root=r,this.add(i);return e.oneTimeDisposeHandlers.push((function(){var n=parseInt(e.name[e.name.length-1]);t.sceneNode.remove(r.sceneNode),t.children[n]=e})),r}},{key:"updateVisibleBounds",value:function(){for(var e=[],t=0;t<this.visibleNodes.length;t++){for(var n=this.visibleNodes[t],r=!0,i=0;i<n.children.length;i++){var o=n.children[i];o instanceof be?r=r&&!o.sceneNode.visible:o instanceof oe&&(r=!0)}r&&e.push(n)}for(this.visibleBounds.min=new O.Vector3(1/0,1/0,1/0),this.visibleBounds.max=new O.Vector3(-1/0,-1/0,-1/0),t=0;t<e.length;t++)n=e[t],this.visibleBounds.expandByPoint(n.getBoundingBox().min),this.visibleBounds.expandByPoint(n.getBoundingBox().max)}},{key:"updateMaterial",value:function(e,t,n){var r=this.pcoGeometry.spacing*Math.max(this.scale.x,this.scale.y,this.scale.z),i=this.pcoGeometry.boundingBox.getSize(new O.Vector3).x;e.uniforms.fov.value=t.fov*(Math.PI/180),e.uniforms.uScreenWidth.value=n.domElement.clientWidth,e.uniforms.uScreenHeight.value=n.domElement.clientHeight,e.uniforms.uOctreeSpacing.value=r,e.uniforms.near.value=t.near,e.uniforms.far.value=t.far,e.uniforms.octreeSize.value=i,e.uniformsNeedUpdate=!0}},{key:"computeVisibilityTextureData",value:function(e,t){C.measureTimings&&performance.mark("computeVisibilityTextureData-start");var n=new Uint8Array(4*e.length),r=new Map;(e=e.slice()).sort((function(e,t){var n=e.geometryNode.name,r=t.geometryNode.name;return n.length!==r.length?n.length-r.length:n<r?-1:n>r?1:0}));for(var i=new O.Vector3,o=function(e,t){i.subVectors(t.center,e.origin);var n=i.dot(e.direction),r=i.dot(i)-n*n,o=t.radius*t.radius;if(r>o)return null;var a=n+Math.sqrt(o-r);return a<0?null:a},a=new Map,s=new Map,u=0;u<e.length;u++){var c=e[u];r.set(c,u);for(var l=[],d=0;d<8;d++)(f=c.children[d])&&f.constructor===be&&e.includes(f,u)&&l.push(f);for(n[4*u+0]=0,n[4*u+1]=0,n[4*u+2]=0,n[4*u+3]=c.getLevel(),d=0;d<l.length;d++){var f=l[d],v=parseInt(f.geometryNode.name.substr(-1));if(n[4*u+0]+=Math.pow(2,v),0===d){var m=e.indexOf(f,u);n[4*u+1]=m-u>>8,n[4*u+2]=(m-u)%256}}var y=c.getBoundingBox().clone().getBoundingSphere(new O.Sphere);y.applyMatrix4(c.sceneNode.matrixWorld),y.applyMatrix4(t.matrixWorldInverse);var g=o(new O.Ray(t.position,t.getWorldDirection(this.tempVector3)),y),b=y.center.distanceTo(t.position)+y.radius;if(null===g&&(g=b),g=Math.max(g,b),a.has(c.getLevel())){var x=a.get(c.getLevel()),_=Math.max(x,g);a.set(c.getLevel(),_)}else a.set(c.getLevel(),g);if(!c.geometryNode.hasChildren){var w={distance:g,i:u};s.set(c,w)}}var M,S=h(s);try{for(S.s();!(M=S.n()).done;){var T=p(M.value,2),E=(c=T[0],w=T[1],c.getLevel());if(g=w.distance,u=w.i,!(E<4)){var k,A=h(a);try{for(A.s();!(k=A.n()).done;){var P=p(k.value,2),I=P[0];g<1.2*P[1]&&(n[4*u+3]=I)}}catch(e){A.e(e)}finally{A.f()}}}}catch(e){S.e(e)}finally{S.f()}return C.measureTimings&&(performance.mark("computeVisibilityTextureData-end"),performance.measure("render.computeVisibilityTextureData","computeVisibilityTextureData-start","computeVisibilityTextureData-end")),{data:n,offsets:r}}},{key:"nodeIntersectsProfile",value:function(e,t){for(var n=e.boundingBox.clone().applyMatrix4(this.matrixWorld).getBoundingSphere(new O.Sphere),r=!1,i=0;i<t.points.length-1;i++){var o=new O.Vector3(t.points[i+0].x,t.points[i+0].y,n.center.z),a=new O.Vector3(t.points[i+1].x,t.points[i+1].y,n.center.z),s=new O.Line3(o,a).closestPointToPoint(n.center,!0).distanceTo(n.center);r=r||s<n.radius+t.width}return r}},{key:"nodesOnRay",value:function(e,t){for(var n=[],r=t.clone(),i=0;i<e.length;i++){var o=e[i],a=o.getBoundingSphere(new O.Sphere).clone().applyMatrix4(this.matrixWorld);r.intersectsSphere(a)&&n.push(o)}return n}},{key:"updateMatrixWorld",value:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==e||(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0)}},{key:"hideDescendants",value:function(e){for(var t=[],n=0;n<e.children.length;n++)(r=e.children[n]).visible&&t.push(r);for(;t.length>0;)for((e=t.shift()).visible=!1,n=0;n<e.children.length;n++){var r;(r=e.children[n]).visible&&t.push(r)}}},{key:"moveToOrigin",value:function(){this.position.set(0,0,0),this.updateMatrixWorld(!0);var e=this.boundingBox,t=this.matrixWorld,n=ve.computeTransformedBoundingBox(e,t);this.position.set(0,0,0).sub(n.getCenter(new O.Vector3))}},{key:"moveToGroundPlane",value:function(){this.updateMatrixWorld(!0);var e=this.boundingBox,t=this.matrixWorld,n=ve.computeTransformedBoundingBox(e,t);this.position.y+=-n.min.y}},{key:"getBoundingBoxWorld",value:function(){this.updateMatrixWorld(!0);var e=this.boundingBox,t=this.matrixWorld;return ve.computeTransformedBoundingBox(e,t)}},{key:"getPointsInProfile",value:function(e,t,n){for(var r={segments:[],boundingBox:new O.Box3,projectedBoundingBox:new O.Box2},i=0;i<e.points.length-1;i++){var o=e.points[i],a=e.points[i+1],s=this.getProfile(o,a,e.width,t),u={start:o,end:a,points:s,project:null};r.segments.push(u),r.boundingBox.expandByPoint(s.boundingBox.min),r.boundingBox.expandByPoint(s.boundingBox.max)}var c=new O.Vector3;for(i=0;i<r.segments.length;i++){var l=function(e,t,n,r){var i=e,o=t,a=n,s=r,u=new O.Vector3(1,0,0),c=(new O.Vector3).subVectors(o,i);c.y=0,c.normalize();var l=Math.acos(u.dot(c));return c.z>0&&(l=-l),function(e){var t=(new O.Matrix4).makeTranslation(-i.x,-s.min.y,-i.z),n=(new O.Matrix4).makeRotationY(-l),r=(new O.Matrix4).makeTranslation(a.x,0,0),o=e.clone();return o.applyMatrix4(t),o.applyMatrix4(n),o.applyMatrix4(r),o}}(o=(u=r.segments[i]).start,a=u.end,c.clone(),r.boundingBox.clone());u.project=l,c.x+=new O.Vector3(o.x,0,o.z).distanceTo(new O.Vector3(a.x,0,a.z)),c.y+=a.y-o.y}return r.projectedBoundingBox.min.x=0,r.projectedBoundingBox.min.y=r.boundingBox.min.y,r.projectedBoundingBox.max.x=c.x,r.projectedBoundingBox.max.y=r.boundingBox.max.y,r}},{key:"getProfile",value:function(e,t,n,r,i){}},{key:"getVisibleExtent",value:function(){return this.visibleBounds.applyMatrix4(this.matrixWorld)}},{key:"pick",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.renderer,o=e.pRenderer;performance.mark("pick-start");var a=function(e,t){return void 0!==e?e:t},s=a(r.pickWindowSize,17),u=i.getSize(new O.Vector3),c=Math.ceil(a(r.width,u.width)),l=Math.ceil(a(r.height,u.height)),d=a(r.pointSizeType,this.material.pointSizeType),f=a(r.pointSize,this.material.size),p=this.nodesOnRay(this.visibleNodes,n);if(0===p.length)return null;if(!this.pickState){var h=new O.Scene,v=new ge;v.pointColorType=Ce.POINT_INDEX;var m=new O.WebGLRenderTarget(1,1,{minFilter:O.LinearFilter,magFilter:O.NearestFilter,format:O.RGBAFormat});this.pickState={renderTarget:m,material:v,scene:h}}var y=this.pickState,g=y.material;g.pointSizeType=d,g.shape=this.material.shape,g.size=f,g.uniforms.minSize.value=this.material.uniforms.minSize.value,g.uniforms.maxSize.value=this.material.uniforms.maxSize.value,g.classification=this.material.classification,g.clippingPlanes=this.material.clippingPlanes,g.clipping=this.material.clipping,this.updateMaterial(g,t,i),y.renderTarget.setSize(c,l);var b=new O.Vector2(r.x,r.y),x=i.getContext();x.enable(x.SCISSOR_TEST),x.scissor(parseInt(b.x-(s-1)/2),parseInt(b.y-(s-1)/2),parseInt(s),parseInt(s)),i.state.buffers.depth.setTest(g.depthTest),i.state.buffers.depth.setMask(g.depthWrite),i.state.setBlending(O.NoBlending),i.setRenderTarget(y.renderTarget),x.clearColor(0,0,0,0),i.clearTarget(y.renderTarget,!0,!0,!0);var _=this.material;this.material=g,o.renderOctree(this,p,t,y.renderTarget),this.material=_;var w=function(e,t,n){return Math.min(Math.max(t,e),n)},M=parseInt(w(b.x-(s-1)/2,0,c)),S=parseInt(w(b.y-(s-1)/2,0,l)),T=parseInt(Math.min(M+s,c)-M),E=parseInt(Math.min(S+s,l)-S),k=new Uint8Array(T*E*4);x.readPixels(M,S,s,s,x.RGBA,x.UNSIGNED_BYTE,k),i.setRenderTarget(null),i.resetGLState(),i.setScissorTest(!1),x.disable(x.SCISSOR_TEST);for(var A=k,P=new Uint32Array(k.buffer),C=(Number.MAX_VALUE,[]),I=0;I<s;I++)for(var R=0;R<s;R++){var N=I+R*s,D=Math.pow(I-(s-1)/2,2)+Math.pow(R-(s-1)/2,2),L=A[4*N+3];A[4*N+3]=0;var B=P[N];if((0!==L||0!==B)&&void 0!==L&&void 0!==B){var F={pIndex:B,pcIndex:L,distanceToCenter:D};r.all?C.push(F):C.length>0?D<C[0].distanceToCenter&&(C[0]=F):C.push(F)}}for(var j=0,z=C;j<z.length;j++){var U={};if(!p[(F=z[j]).pcIndex])return null;var G=p[F.pcIndex],V=G.sceneNode,W=G.geometryNode.geometry;for(var H in W.attributes){var Z=W.attributes[H];if("position"===H){M=Z.array[3*F.pIndex+0],S=Z.array[3*F.pIndex+1];var q=Z.array[3*F.pIndex+2],Y=new O.Vector3(M,S,q);Y.applyMatrix4(V.matrixWorld),U[H]=Y}}F.point=U}return performance.mark("pick-end"),performance.measure("pick","pick-start","pick-end"),r.all?C.map((function(e){return e.point})):0===C.length?null:C[0].point}},{key:"getFittedBoxGen",value:u.mark((function e(t){var n,r,i,o,a,s,c,l,d,f,p,v,m,y,g,b,x,_;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new O.Box3,r=(new O.Matrix4).getInverse(t.matrixWorld),i=h(this.visibleNodes),e.prev=2,i.s();case 4:if((o=i.n()).done){e.next=12;break}if(!(a=o.value).sceneNode){e.next=10;break}for(s=a.geometryNode.buffer,c=s.offset("position"),l=s.stride,d=new DataView(s.data),f=(new O.Matrix4).multiplyMatrices(r,a.sceneNode.matrixWorld),p=new O.Vector4,v=0;v<s.numElements;v++)m=d.getFloat32(v*l+c+0,!0),y=d.getFloat32(v*l+c+4,!0),g=d.getFloat32(v*l+c+8,!0),p.set(m,y,g,1),p.applyMatrix4(f),-.5<p.x&&p.x<.5&&-.5<p.y&&p.y<.5&&-.5<p.z&&p.z<.5&&n.expandByPoint(p);return void(e.next=10);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:return b=n.getCenter(new O.Vector3).applyMatrix4(t.matrixWorld),(x=new O.Object3D).position.copy(b),x.scale.copy(t.scale),x.rotation.copy(t.rotation),_=(new O.Vector3).subVectors(n.max,n.min),x.scale.multiply(_),e.next=26,x;case 26:case"end":return e.stop()}}),e,this,[[2,14,17,20]])}))},{key:"getFittedBox",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=new O.Box3,i=(new O.Matrix4).getInverse(e.matrixWorld),o=h(this.visibleNodes);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a.sceneNode&&!(a.getLevel()>n))for(var s=a.geometryNode.buffer,u=s.offset("position"),c=s.stride,l=new DataView(s.data),d=(new O.Matrix4).multiplyMatrices(i,a.sceneNode.matrixWorld),f=new O.Vector4,p=0;p<s.numElements;p++){var v=l.getFloat32(p*c+u+0,!0),m=l.getFloat32(p*c+u+4,!0),y=l.getFloat32(p*c+u+8,!0);f.set(v,m,y,1),f.applyMatrix4(d),-.5<f.x&&f.x<.5&&-.5<f.y&&f.y<.5&&-.5<f.z&&f.z<.5&&r.expandByPoint(f)}}}catch(e){o.e(e)}finally{o.f()}var g=r.getCenter(new O.Vector3).applyMatrix4(e.matrixWorld),b=new O.Object3D;b.position.copy(g),b.scale.copy(e.scale),b.rotation.copy(e.rotation);var x=(new O.Vector3).subVectors(r.max,r.min);return b.scale.multiply(x),b}},{key:"progress",get:function(){return this.visibleNodes.length/this.visibleGeometry.length}},{key:"find",value:function(e){var t,n=null,r=h(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n="r"===i?this.root:n.children[i]}}catch(e){r.e(e)}finally{r.f()}return n}}]),n}(U),_e=function(e){d(n,e);var t=f(n);function n(){var e;return m(this,n),(e=t.call(this)).left=null,e.right=null,e.sceneNode=null,e.kdtree=null,e}return v(n,[{key:"getNumPoints",value:function(){return this.geometryNode.numPoints}},{key:"isLoaded",value:function(){return!0}},{key:"isTreeNode",value:function(){return!0}},{key:"isGeometryNode",value:function(){return!1}},{key:"getLevel",value:function(){return this.geometryNode.level}},{key:"getBoundingSphere",value:function(){return this.geometryNode.boundingSphere}},{key:"getBoundingBox",value:function(){return this.geometryNode.boundingBox}},{key:"toTreeNode",value:function(e){var t=null;if(this.left===e?t=this.left:this.right===e&&(t=this.right),t.loaded){var r=new n,i=O.PointCloud(t.geometry,this.kdtree.material);i.visible=!1,r.kdtree=this.kdtree,r.geometryNode=t,r.sceneNode=i,r.parent=this,r.left=this.geometryNode.left,r.right=this.geometryNode.right}}},{key:"getChildren",value:function(){var e=[];return this.left&&e.push(this.left),this.right&&e.push(this.right),e}}]),n}(z),we=function(e){d(n,e);var t=f(n);function n(e){var r;return m(this,n),(r=t.call(this)).root=null,e.root?r.root=e.root:e.addEventListener("hierarchy_loaded",(function(){r.root=e.root})),r.visiblePointsTarget=2e6,r.minimumNodePixelSize=150,r.position.sub(e.offset),r.updateMatrix(),r.numVisibleNodes=0,r.numVisiblePoints=0,r.boundingBoxNodes=[],r.loadQueue=[],r.visibleNodes=[],r.pcoGeometry=e,r.boundingBox=r.pcoGeometry.boundingBox,r.boundingSphere=r.pcoGeometry.boundingSphere,r.material=new ge({vertexColors:O.VertexColors,size:.05,treeType:Oe.KDTREE}),r.material.sizeType=Ae.ATTENUATED,r.material.size=.05,r.profileRequests=[],r.name="",r}return v(n,[{key:"getBoundingBoxWorld",value:function(){this.updateMatrixWorld(!0);var e=this.boundingBox,t=this.matrixWorld;return ve.computeTransformedBoundingBox(e,t)}},{key:"setName",value:function(e){this.name!==e&&(this.name=e,this.dispatchEvent({type:"name_changed",name:e,pointcloud:this}))}},{key:"getName",value:function(){return this.name}},{key:"getLevel",value:function(){return this.level}},{key:"toTreeNode",value:function(e,t){var n=this,r=new _e,i=new O.Points(e.geometry,this.material);return i.frustumCulled=!0,i.onBeforeRender=function(t,i,o,a,s,u){if(s.program){if(t.getContext().useProgram(s.program.program),s.program.getUniforms().map.level){var c=e.getLevel();s.uniforms.level.value=c,s.program.getUniforms().map.level.setValue(t.getContext(),c)}if(n.visibleNodeTextureOffsets&&s.program.getUniforms().map.vnStart){var l=n.visibleNodeTextureOffsets.get(r);s.uniforms.vnStart.value=l,s.program.getUniforms().map.vnStart.setValue(t.getContext(),l)}if(s.program.getUniforms().map.pcIndex){var d=r.pcIndex?r.pcIndex:n.visibleNodes.indexOf(r);s.uniforms.pcIndex.value=d,s.program.getUniforms().map.pcIndex.setValue(t.getContext(),d)}}},r.geometryNode=e,r.sceneNode=i,r.pointcloud=this,r.left=e.left,r.right=e.right,t?(t.sceneNode.add(i),t.left===e?t.left=r:t.right===e&&(t.right=r)):(this.root=r,this.add(i)),e.oneTimeDisposeHandlers.push((function(){t.sceneNode.remove(r.sceneNode),t.left===r?t.left=e:t.right===r&&(t.right=e)})),r}},{key:"updateMaterial",value:function(e,t,n,r){e.fov=n.fov*(Math.PI/180),e.screenWidth=r.domElement.clientWidth,e.screenHeight=r.domElement.clientHeight,e.spacing=this.pcoGeometry.spacing,e.near=n.near,e.far=n.far,this.maxLevel>e.levels&&(e.levels=this.maxLevel+2);var i=this.boundingBox.getSize(new O.Vector3);e.bbSize=[i.x,i.y,i.z]}},{key:"updateVisibleBounds",value:function(){}},{key:"hideDescendants",value:function(e){for(var t=[],n=0;n<e.children.length;n++)(r=e.children[n]).visible&&t.push(r);for(;t.length>0;){var r;for((r=t.shift()).visible=!1,r.boundingBoxNode&&(r.boundingBoxNode.visible=!1),n=0;n<r.children.length;n++){var i=r.children[n];i.visible&&t.push(i)}}}},{key:"updateMatrixWorld",value:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==e||(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0)}},{key:"nodesOnRay",value:function(e,t){for(var n=[],r=t.clone(),i=0;i<e.length;i++){var o=e[i],a=o.getBoundingSphere(new O.Sphere).clone().applyMatrix4(o.sceneNode.matrixWorld);r.intersectsSphere(a)&&n.push(o)}return n}},{key:"pick",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.renderer,o=e.pRenderer;performance.mark("pick-start");var a=function(e,t){return void 0!==e?e:t},s=a(r.pickWindowSize,17),u=i.getSize(new O.Vector3),c=Math.ceil(a(r.width,u.width)),l=Math.ceil(a(r.height,u.height)),d=(a(r.pointSizeType,this.material.pointSizeType),a(r.pointSize,this.material.size),this.nodesOnRay(this.visibleNodes,n));if(0===d.length)return null;if(!this.pickState){var f=new O.Scene,p=new ge;p.pointColorType=Ce.POINT_INDEX;var h=new O.WebGLRenderTarget(1,1,{minFilter:O.LinearFilter,magFilter:O.NearestFilter,format:O.RGBAFormat});this.pickState={renderTarget:h,material:p,scene:f}}var v=this.pickState,m=v.material;this.updateMaterial(m,d,t,i),v.renderTarget.setSize(c,l);var y=new O.Vector2(r.x,r.y),g=i.getContext();g.enable(g.SCISSOR_TEST),g.scissor(parseInt(y.x-(s-1)/2),parseInt(y.y-(s-1)/2),parseInt(s),parseInt(s)),i.state.buffers.depth.setTest(m.depthTest),i.state.buffers.depth.setMask(m.depthWrite),i.state.setBlending(O.NoBlending),i.clearTarget(v.renderTarget,!0,!0,!0),i.setRenderTarget(v.renderTarget),g.clearColor(0,0,0,0),i.clearTarget(v.renderTarget,!0,!0,!0);var b=this.material;this.material=m,o.renderOctree(this,d,t,v.renderTarget),this.material=b;var x=function(e,t,n){return Math.min(Math.max(t,e),n)},_=parseInt(x(y.x-(s-1)/2,0,c)),w=parseInt(x(y.y-(s-1)/2,0,l)),M=parseInt(Math.min(_+s,c)-_),S=parseInt(Math.min(w+s,l)-w),T=new Uint8Array(M*S*4);g.readPixels(_,w,s,s,g.RGBA,g.UNSIGNED_BYTE,T),i.setRenderTarget(null),i.resetGLState(),i.setScissorTest(!1),g.disable(g.SCISSOR_TEST);for(var E=T,k=new Uint32Array(T.buffer),A=(Number.MAX_VALUE,[]),P=0;P<s;P++)for(var C=0;C<s;C++){var I=P+C*s,R=Math.pow(P-(s-1)/2,2)+Math.pow(C-(s-1)/2,2),N=E[4*I+3];E[4*I+3]=0;var D=k[I];if((0!==N||0!==D)&&void 0!==N&&void 0!==D){var L={pIndex:D,pcIndex:N,distanceToCenter:R};r.all?A.push(L):A.length>0?R<A[0].distanceToCenter&&(A[0]=L):A.push(L)}}for(var B=0,F=A;B<F.length;B++){var j={};if(!d[(L=F[B]).pcIndex])return null;var z=d[L.pcIndex],U=z.sceneNode,G=z.geometryNode.geometry;for(var V in G.attributes){var W=G.attributes[V];if("position"===V){_=W.array[3*L.pIndex+0],w=W.array[3*L.pIndex+1];var H=W.array[3*L.pIndex+2],Z=new O.Vector3(_,w,H);Z.applyMatrix4(U.matrixWorld),j[V]=Z}}L.point=j}return performance.mark("pick-end"),performance.measure("pick","pick-start","pick-end"),r.all?A.map((function(e){return e.point})):0===A.length?null:A[0].point}},{key:"computeVisibilityTextureData",value:function(e){C.measureTimings&&performance.mark("computeVisibilityTextureData-start");var t=new Uint8Array(3*e.length),n=new Map;(e=e.slice()).sort((function(e,t){var n=e.geometryNode.level,r=t.geometryNode.level,i=e.geometryNode.number,o=t.geometryNode.number;return n!==r?n-r:i<o?-1:i>o?1:0}));for(var r=[],i=0;i<e.length;i++)r.push(e[i].geometryNode.number);for(i=0;i<e.length;i++){var o=e[i];n.set(o,i);var a=0,s=0,u=0;o.geometryNode.left&&r.indexOf(o.geometryNode.left.number)>0&&(a+=1,s=r.indexOf(o.geometryNode.left.number)-i),o.geometryNode.right&&r.indexOf(o.geometryNode.right.number)>0&&(a+=2,s=0===s?r.indexOf(o.geometryNode.right.number)-i:s),"X"===o.geometryNode.split?u=1:"Y"===o.geometryNode.split?u=2:"Z"===o.geometryNode.split&&(u=4),t[3*i+0]=a,t[3*i+1]=s,t[3*i+2]=u}return C.measureTimings&&(performance.mark("computeVisibilityTextureData-end"),performance.measure("render.computeVisibilityTextureData","computeVisibilityTextureData-start","computeVisibilityTextureData-end")),{data:t,offsets:n}}},{key:"progress",get:function(){return this.pcoGeometry.root?C.numNodesLoading>0?0:1:0}}]),n}(U),Me=function(){function e(){m(this,e),this.left=null,this.right=null,this.boundingBox=null,this.number=null,this.pcoGeometry=null,this.loaded=!1,this.numPoints=0,this.level=0,this.children=[],this.oneTimeDisposeHandlers=[]}return v(e,[{key:"isGeometryNode",value:function(){return!0}},{key:"isTreeNode",value:function(){return!1}},{key:"isLoaded",value:function(){return this.loaded}},{key:"getBoundingSphere",value:function(){return this.boundingSphere}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"getChildren",value:function(){var e=[];return this.left&&e.push(this.left),this.right&&e.push(this.right),e}},{key:"getLevel",value:function(){return this.level}},{key:"load",value:function(){if(!(this.loaded||this.loading||C.numNodesLoading>=C.maxNodesLoading)){this.loading=!0,C.numNodesLoading++;var e=this,t=this.pcoGeometry.url+"?node="+this.number,n=H.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){try{for(var t=n.response,r=new DataView(t),i=t.byteLength/17,o=new ArrayBuffer(28*i),a=(new DataView(o),L.POSITION_CARTESIAN,L.RGBA_PACKED,L.INTENSITY,L.CLASSIFICATION,new Float32Array(3*i)),s=new Uint8Array(4*i),u=new Float32Array(i),c=new Uint8Array(i),l=new ArrayBuffer(4*i),d=new Uint32Array(l),f=new O.Box3,p=0;p<i;p++){var h=r.getFloat32(17*p+0,!0)+e.boundingBox.min.x,v=r.getFloat32(17*p+4,!0)+e.boundingBox.min.y,m=r.getFloat32(17*p+8,!0)+e.boundingBox.min.z,y=r.getUint8(17*p+12,!0),g=r.getUint8(17*p+13,!0),b=r.getUint8(17*p+14,!0),x=r.getUint8(17*p+15,!0),_=r.getUint8(17*p+16,!0);f.expandByPoint(new O.Vector3(h,v,m)),a[3*p+0]=h,a[3*p+1]=v,a[3*p+2]=m,s[4*p+0]=y,s[4*p+1]=g,s[4*p+2]=b,s[4*p+3]=255,u[p]=x,c[p]=_,d[p]=p}var w=new O.BufferGeometry;w.setAttribute("position",new O.BufferAttribute(a,3)),w.setAttribute("color",new O.BufferAttribute(s,4,!0)),w.setAttribute("intensity",new O.BufferAttribute(u,1)),w.setAttribute("classification",new O.BufferAttribute(c,1));var M=new O.BufferAttribute(new Uint8Array(l),4,!0);w.setAttribute("indices",M),e.geometry=w,e.numPoints=i,e.loaded=!0,e.loading=!1,C.numNodesLoading--}catch(e){console.error("Potree: Exception thrown parsing points.",e),C.numNodesLoading--}},n.onerror=function(){C.numNodesLoading--,console.log("Potree: Failed to load file, "+n.status+", file: "+t)},n.send(null)}}},{key:"dispose",value:function(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1;for(var e=0;e<this.oneTimeDisposeHandlers.length;e++)(0,this.oneTimeDisposeHandlers[e])();this.oneTimeDisposeHandlers=[]}}},{key:"getNumPoints",value:function(){return this.numPoints}}]),e}(),Se=function(e){d(n,e);var t=f(n);function n(){var e;return m(this,n),(e=t.call(this)).numPoints=0,e.version=0,e.boundingBox=null,e.numNodes=0,e.name=null,e.provider=null,e.url=null,e.root=null,e.levels=0,e._spacing=null,e.pointAttributes=new B(["POSITION_CARTESIAN","COLOR_PACKED"]),e}return v(n,[{key:"loadHierarchy",value:function(){var e=this,t=this.url+"?tree",n=H.createXMLHttpRequest();n.overrideMimeType("text/plain"),n.open("GET",t,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){for(var t=n.response,r=t.byteLength/3,i=new DataView(t),o=[],a=null,s=0,u=0;u<r;u++){var c=i.getUint8(3*u+0,!0),l=(1&c)>0,d=(2&c)>0,f=null;(4&c)>0?f="X":(8&c)>0&&(f="Y"),(16&c)>0&&(f="Z");var p=new Me;if(p.hasLeft=l,p.hasRight=d,p.split=f,p.isLeaf=!l&&!d,p.number=u,p.left=null,p.right=null,p.pcoGeometry=e,p.level=o.length,s=Math.max(s,p.level),o.length>0){var h=o[o.length-1];p.boundingBox=h.boundingBox.clone();var v=h.boundingBox.getSize(new O.Vector3);if(h.hasLeft&&!h.left){h.left=p,h.children.push(p),"X"===h.split?p.boundingBox.max.x=p.boundingBox.min.x+v.x/2:"Y"===h.split?p.boundingBox.max.y=p.boundingBox.min.y+v.y/2:"Z"===h.split&&(p.boundingBox.max.z=p.boundingBox.min.z+v.z/2);var m=new O.Vector3;p.boundingBox.getCenter(m);var y=p.boundingBox.getSize(new O.Vector3).length()/2;p.boundingSphere=new O.Sphere(m,y)}else h.right=p,h.children.push(p),"X"===h.split?p.boundingBox.min.x=p.boundingBox.min.x+v.x/2:"Y"===h.split?p.boundingBox.min.y=p.boundingBox.min.y+v.y/2:"Z"===h.split&&(p.boundingBox.min.z=p.boundingBox.min.z+v.z/2),m=new O.Vector3,p.boundingBox.getCenter(m),y=p.boundingBox.getSize(new O.Vector3).length()/2,p.boundingSphere=new O.Sphere(m,y)}else(a=p).boundingBox=e.boundingBox.clone(),m=new O.Vector3,a.boundingBox.getCenter(m),y=a.boundingBox.getSize(new O.Vector3).length()/2,a.boundingSphere=new O.Sphere(m,y);var g=p.boundingBox.getSize(new O.Vector3);if(p.spacing=(g.x+g.y+g.z)/3/75,p.estimatedSpacing=p.spacing,o.push(p),p.isLeaf)for(var b=!1;!b&&o.length>0;){o.pop();var x=o[o.length-1];b=o.length>0&&x.hasRight&&null==x.right}}e.root=a,e.levels=s,e.dispatchEvent({type:"hierarchy_loaded"})}},n.send(null)}},{key:"spacing",get:function(){return this._spacing?this._spacing:this.root?this.root.spacing:void 0},set:function(e){this._spacing=e}}],[{key:"load",value:function(e,t){var r=H.createXMLHttpRequest();r.overrideMimeType("text/plain"),r.open("GET",e+"?info",!0),r.onreadystatechange=function(){try{if(4===r.readyState&&200===r.status){var i=JSON.parse(r.responseText),o=new n;o.url=e,o.name=i.Name,o.provider=i.Provider,o.numNodes=i.Nodes,o.numPoints=i.Points,o.version=i.Version,o.boundingBox=new O.Box3((new O.Vector3).fromArray(i.BoundingBox.slice(0,3)),(new O.Vector3).fromArray(i.BoundingBox.slice(3,6))),i.Spacing&&(o.spacing=i.Spacing);var a=o.boundingBox.min.clone().multiplyScalar(-1);o.boundingBox.min.add(a),o.boundingBox.max.add(a),o.offset=a;var s=new O.Vector3;o.boundingBox.getCenter(s);var u=o.boundingBox.getSize(new O.Vector3).length()/2;o.boundingSphere=new O.Sphere(s,u),o.loadHierarchy(),t(o)}else 4===r.readyState&&t(null)}catch(e){console.error(e.message),t(null)}},r.send(null)}}]),n}(O.EventDispatcher);function Te(e){this.content=[],this.scoreFunction=e}Te.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},remove:function(e){for(var t=this.content.length,n=0;n<t;n++)if(this.content[n]==e){var r=this.content.pop();if(n==t-1)break;this.content[n]=r,this.bubbleUp(n),this.sinkDown(n);break}},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e],n=this.scoreFunction(t);e>0;){var r=Math.floor((e+1)/2)-1,i=this.content[r];if(n>=this.scoreFunction(i))break;this.content[r]=t,this.content[e]=i,e=r}},sinkDown:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var i=2*(e+1),o=i-1,a=null;if(o<t){var s=this.content[o],u=this.scoreFunction(s);u<r&&(a=o)}if(i<t){var c=this.content[i];this.scoreFunction(c)<(null==a?r:u)&&(a=i)}if(null==a)break;this.content[e]=this.content[a],this.content[a]=n,e=a}}};var Ee={position:0,color:1,intensity:2,classification:3,returnNumber:4,numberOfReturns:5,pointSourceID:6,indices:7,normal:8,spacing:9},ke={DEFAULT:{0:new O.Vector4(.5,.5,.5,1),1:new O.Vector4(.5,.5,.5,1),2:new O.Vector4(.63,.32,.18,1),3:new O.Vector4(0,1,0,1),4:new O.Vector4(0,.8,0,1),5:new O.Vector4(0,.6,0,1),6:new O.Vector4(1,.66,0,1),7:new O.Vector4(1,0,1,1),8:new O.Vector4(1,0,0,1),9:new O.Vector4(0,0,1,1),12:new O.Vector4(1,1,0,1),DEFAULT:new O.Vector4(.3,.6,.6,.5)}},Ae={FIXED:0,ATTENUATED:1,ADAPTIVE:2},Pe={SQUARE:0,CIRCLE:1,PARABOLOID:2},Ce={RGB:0,COLOR:1,DEPTH:2,HEIGHT:3,ELEVATION:3,INTENSITY:4,INTENSITY_GRADIENT:5,LOD:6,LEVEL_OF_DETAIL:6,POINT_INDEX:7,CLASSIFICATION:8,RETURN_NUMBER:9,SOURCE:10,NORMAL:11,PHONG:12,RGB_HEIGHT:13,COMPOSITE:50},Oe={OCTREE:0,KDTREE:1};function Ie(e,t,n){var r=function(e){void 0!==t&&(e.name=t),n({type:"pointcloud_loaded",pointcloud:e})};if(0===e.indexOf("greyhound://"))Y.load(e,(function(e){void 0!==e&&r(new xe(e))}));else if(e.indexOf("cloud.js")>0)ae.load(e,(function(e){void 0!==e&&r(new xe(e))}));else if(e.indexOf("ept.json")>0)he.load(e,(function(e){void 0!==e&&r(new xe(e))}));else{if(!(e.indexOf(".vpc")>0))throw new Error("Potree: Failed to load point cloud from URL "+e);Se.load(e,(function(e){void 0!==e&&r(new we(e))}))}}function Re(e,t,n,r){var i=0,o=new Map(e.map((function(e){return[e,0]}))),a=[],s=[],u=[],c=1/0,l=De(e,t),d=l.frustums,f=l.camObjPositions,p=l.priorityQueue,v=0,m=(n.domElement.clientWidth,n.domElement.clientHeight);C.pointcloudTransformVersion||(C.pointcloudTransformVersion=new Map);for(var y=C.pointcloudTransformVersion,g=0;g<e.length;g++)if((M=e[g]).visible)if(M.updateMatrixWorld(),y.has(M)){var b=y.get(M);b.transform.equals(M.matrixWorld)||(b.number++,b.transform.copy(M.matrixWorld),M.dispatchEvent({type:"transformation_changed",target:M}))}else y.set(M,{number:0,transform:M.matrixWorld.clone()});for(;p.size()>0;){var x=p.pop(),_=x.node,w=x.parent,M=e[x.pointcloud],S=_.getBoundingBox(),T=d[x.pointcloud],E=f[x.pointcloud],k=T.intersectsBox(S),A=M.maxLevel||1/0,P=_.getLevel(),I=k;if(I=(I=(I=I&&i+_.getNumPoints()<=r)&&!(o.get(M)+_.getNumPoints()>M.pointBudget))&&P<A,_.spacing?c=Math.min(c,_.spacing):_.geometryNode&&_.geometryNode.spacing&&(c=Math.min(c,_.geometryNode.spacing)),I){i+=_.getNumPoints();var R=o.get(M);if(o.set(M,R+_.getNumPoints()),M.numVisibleNodes++,M.numVisiblePoints+=_.getNumPoints(),!_.isGeometryNode()||w&&!w.isTreeNode()||(_.isLoaded()&&v<C.maxNodesLoadGPUFrame?(_=M.toTreeNode(_,w),v++):(u.push(_),s.push(_))),_.isTreeNode()){C.lru.touch(_.geometryNode),_.sceneNode.visible=!0,_.sceneNode.material=M.material,a.push(_),M.visibleNodes.push(_),void 0===_._transformVersion&&(_._transformVersion=-1);var N=y.get(M);if(_._transformVersion!==N.number&&(_.sceneNode.updateMatrix(),_.sceneNode.matrixWorld.multiplyMatrices(M.matrixWorld,_.sceneNode.matrix),_._transformVersion=N.number),M.showBoundingBox&&!_.boundingBoxNode&&_.getBoundingBox){var D=new O.Box3Helper(_.getBoundingBox());D.matrixAutoUpdate=!1,M.boundingBoxNodes.push(D),_.boundingBoxNode=D,_.boundingBoxNode.matrix.copy(M.matrixWorld)}else M.showBoundingBox?(_.boundingBoxNode.visible=!0,_.boundingBoxNode.matrix.copy(M.matrixWorld)):!M.showBoundingBox&&_.boundingBoxNode&&(_.boundingBoxNode.visible=!1)}var L=_.getChildren();for(g=0;g<L.length;g++){var B=L[g],F=0;if(t.isPerspectiveCamera){var j=B.getBoundingSphere(new O.Sphere),z=(j.center,j.center.distanceTo(E)),U=j.radius,G=t.fov*Math.PI/180,V=U*(.5*m/(Math.tan(G/2)*z));if(V<M.minimumNodePixelSize)continue;F=V,z-U<0&&(F=Number.MAX_VALUE)}else{var W=B.getBoundingBox();z=B.getBoundingSphere(new O.Sphere).center.distanceTo(E),F=W.max.clone().sub(W.min).length()/z}p.push({pointcloud:x.pointcloud,node:B,parent:_,weight:F})}}}var H,Z=e.filter((function(e){return e.generateDEM&&e.dem instanceof DEM})),q=h(Z);try{for(q.s();!(H=q.n()).done;){var Y=(M=H.value).visibleNodes.filter((function(e){return e.getLevel()<=C.maxDEMLevel}));M.dem.update(Y)}}catch(e){q.e(e)}finally{q.f()}for(g=0;g<Math.min(C.maxNodesLoading,u.length);g++)u[g].load();return{visibleNodes:a,numVisiblePoints:i,lowestSpacing:c}}function Ne(e,t,n,r){for(var i=Re(e,t,n,r),o=0;o<e.length;o++)e[o].updateMaterial(e[o].material,t,n),e[o].updateVisibleBounds();return C.lru.freeMemory(),i}function De(e,t,n){for(var r=[],i=[],o=new Te((function(e){return 1/e.weight})),a=0;a<e.length;a++){var s=e[a];if(s.initialized()){s.numVisibleNodes=0,s.numVisiblePoints=0,s.deepestVisibleLevel=0,s.visibleNodes=[],s.visibleGeometry=[],t.updateMatrixWorld();var u=new O.Frustum,c=t.matrixWorldInverse,l=s.matrixWorld,d=t.clone();d.near=t.near,d.updateProjectionMatrix();var f=t.projectionMatrix,p=(new O.Matrix4).multiply(f).multiply(c).multiply(l);u.setFromProjectionMatrix(p),r.push(u);var h=t.matrixWorld,v=l.clone().invert(),m=(new O.Matrix4).multiply(v).multiply(h),y=(new O.Vector3).setFromMatrixPosition(m);i.push(y),s.visible&&null!==s.root&&o.push({pointcloud:a,node:s.root,weight:Number.MAX_VALUE}),s.root.isTreeNode()&&s.hideDescendants(s.root.sceneNode);for(var g=0;g<s.boundingBoxNodes.length;g++)s.boundingBoxNodes[g].visible=!1}}return{frustums:r,camObjPositions:i,priorityQueue:o}}var Le=function(){function e(){m(this,e),this.boundingBox=new O.Box3,this.numPoints=0,this.data={}}return v(e,[{key:"add",value:function(e){var t,n=this.numPoints,r=n+e.numPoints,i=Object.keys(this.data),o=Object.keys(e.data),a=new Set([].concat(s(i),s(o))),u=h(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;if(i.includes(c)&&o.includes(c)){var l=new(0,this.data[c].constructor)(this.data[c].length+e.data[c].length);l.set(this.data[c],0),l.set(e.data[c],this.data[c].length),this.data[c]=l}else if(i.includes(c)&&!o.includes(c)){var d=this.data[c].length/this.numPoints;(f=new(0,this.data[c].constructor)(d*r)).set(this.data[c],0),this.data[c]=f}else if(!i.includes(c)&&o.includes(c)){var f;d=e.data[c].length/e.numPoints,(f=new(0,e.data[c].constructor)(d*r)).set(e.data[c],d*n),this.data[c]=f}}}catch(e){u.e(e)}finally{u.f()}this.numPoints=r,this.boundingBox.union(e.boundingBox)}}]),e}(),Be=function(e){d(n,e);var t=f(n);function n(){var e;return m(this,n),(e=t.call(this,new O.BufferGeometry,new O.MeshBasicMaterial({opacity:0,wireframe:!1,transparent:!0}))).rotation.set(-Math.PI/2,0,0),e.frustumCulled=!0,e.pointclouds=[],e.nodeSize=30,e.pointBudget=1e10,e.nodeLoadRate=2,e}return v(n,[{key:"raycast",value:function(e,t){}},{key:"setPointBudget",value:function(e){this.pointBudget=e}},{key:"onBeforeRender",value:function(e,t,n,r,i,o){for(var a=0;a<this.pointclouds.length;a++)this.pointclouds[a].minimumNodePixelSize=this.nodeSize;Ne(this.pointclouds,n,e,this.pointBudget)}},{key:"recalculateBoxGeometry",value:function(){var e=this.getBoundingBox(),t=e.getSize(new O.Vector3),n=e.getCenter(new O.Vector3),r=new O.Matrix4;r.makeTranslation(n.x,-n.z,n.y);var i=new O.BoxBufferGeometry(t.x,t.z,t.y);i.applyMatrix4(r),this.geometry=i}},{key:"add",value:function(e){O.Object3D.prototype.add.call(this,e),e instanceof U&&(e.showBoundingBox=!1,e.generateDEM=!1,this.pointclouds.push(e),this.recalculateBoxGeometry())}},{key:"remove",value:function(e){if(O.Object3D.prototype.remove.call(this,e),e instanceof U){var t=this.pointclouds.indexOf(e);-1!==t&&(this.pointclouds.splice(t,1),this.recalculateBoxGeometry())}}},{key:"getBoundingBox",value:function(){var e=new O.Box3;this.updateMatrixWorld(!0);for(var t=0;t<this.pointclouds.length;t++){var n=this.pointclouds[t];n.updateMatrixWorld(!0);var r=n.pcoGeometry.tightBoundingBox?n.pcoGeometry.tightBoundingBox:n.boundingBox,i=ve.computeTransformedBoundingBox(r,n.matrixWorld);e.union(i)}return e}},{key:"estimateHeightAt",value:function(e){var t,n=null,r=1/0,i=h(this.pointclouds);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(void 0!==o.root.geometryNode){var a=null,s=1/0,u=e.clone().sub(o.position);u.z=0;for(var c=new O.Ray(u,new O.Vector3(0,0,1)),l=[o.root];l.length>0;){var d=l.pop(),f=d.getBoundingBox();if(c.intersectBox(f))for(var p=d.geometryNode.mean.z+o.position.z+d.geometryNode.boundingBox.min.z,v=0,m=(d.geometryNode.spacing<=s&&(a=p,s=d.geometryNode.spacing),Object.keys(d.children));v<m.length;v++){var y=m[v];d.children[y].geometryNode&&l.push(d.children[y])}}(null===n||s<r)&&(n=a,r=s)}}}catch(e){i.e(e)}finally{i.f()}return n}}]),n}(O.Mesh),Fe=function(e){d(n,e);var t=f(n);function n(){var e;return m(this,n),(e=t.call(this)).textures=new Map,e}return v(n,[{key:"onBeforeRender",value:function(e,t,o,a,s,u){r(i(n.prototype),"onBeforeRender",this).call(this,e,t,o,a,s,u);var c,l=this.fetchOctrees(),d=h(l.octrees);try{for(d.s();!(c=d.n()).done;){var f=c.value,p=f.visibleNodes;this.prepareOcttree(e,f,p,o)}}catch(e){d.e(e)}finally{d.f()}}},{key:"fetchOctrees",value:function(){for(var e=[],t=[this];t.length>0;){var n=t.pop();if(n instanceof U)e.push(n);else{var r=n.children.filter((function(e){return e.visible}));t.push.apply(t,s(r))}}return{octrees:e}}},{key:"prepareOcttree",value:function(e,t,n,r){var i=t.material,a=r.matrixWorld,s=r.projectionMatrix,u=null;if(i.pointSizeType===Ae.ADAPTIVE||i.pointColorType===Ce.LOD){u=t.computeVisibilityTextureData(n,r);var c=i.visibleNodesTexture;c.image.data.set(u.data),c.needsUpdate=!0}var l=i.clipping&&i.clippingPlanes&&i.clippingPlanes.length?i.clippingPlanes.length:0;if(i.defines.num_clipplanes!==l&&(i.defines=o(o({},i.defines),{},{num_clipplanes:l}),i.needsUpdate=!0),l>0)for(var d=i.clippingPlanes,f=new Array(4*i.clippingPlanes.length),p=0;p<d.length;p++)f[4*p+0]=d[p].normal.x,f[4*p+1]=d[p].normal.y,f[4*p+2]=d[p].normal.z,f[4*p+3]=d[p].constant;var h=i.clippingPlanes?i.clippingPlanes.map((function(e){return new O.Vector4(e.normal.x,e.normal.y,e.normal.z,e.constant)})):[];i.uniforms.projectionMatrix.value.copy(s),i.uniforms.uViewInv.value.copy(a),i.uniforms.clipPlanes.value=h,i.uniforms.fov.value=Math.PI*r.fov/180,i.uniforms.near.value=r.near,i.uniforms.far.value=r.far,i.uniforms.size.value=i.size,i.uniforms.uOctreeSpacing.value=i.spacing,i.uniforms.uColor.value=i.color,i.uniforms.uOpacity.value=i.opacity,i.uniforms.elevationRange.value=i.elevationRange,i.uniforms.intensityRange.value=i.intensityRange,i.uniforms.intensityGamma.value=i.intensityGamma,i.uniforms.intensityContrast.value=i.intensityContrast,i.uniforms.intensityBrightness.value=i.intensityBrightness,i.uniforms.rgbGamma.value=i.rgbGamma,i.uniforms.rgbBrightness.value=i.rgbBrightness,i.uniforms.uTransition.value=i.transition,i.uniforms.wRGB.value=i.weightRGB,i.uniforms.wIntensity.value=i.weightIntensity,i.uniforms.wElevation.value=i.weightElevation,i.uniforms.wClassification.value=i.weightClassification,i.uniforms.wReturnNumber.value=i.weightReturnNumber,i.uniforms.wSourceID.value=i.weightSourceID,i.uniforms.logDepthBufFC.value=e.capabilities.logarithmicDepthBuffer?2/(Math.log(r.far+1)/Math.LN2):void 0,i.uniformsNeedUpdate=!0}}]),n}(Be)}]))},71083:function(e,t,n){"use strict";n.r(t),n.d(t,{Easing:function(){return i},Group:function(){return a},Interpolation:function(){return s},Sequence:function(){return u},Tween:function(){return l},VERSION:function(){return d},add:function(){return m},getAll:function(){return h},nextId:function(){return f},now:function(){return o},remove:function(){return y},removeAll:function(){return v},update:function(){return g}});var r,i={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-i.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*i.Bounce.In(2*e):.5*i.Bounce.Out(2*e-1)+.5}}},o="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},a=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=o()),void 0===t&&(t=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var i=this._tweens[n[r]],a=!t;i&&!1===i.update(e,a)&&!t&&delete this._tweens[n[r]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),s={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=s.Utils.Linear;return t<0?o(e[0],e[1],r):t>1?o(e[n],e[n-1],n-r):o(e[i],e[i+1>n?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,o=s.Utils.Bernstein,a=0;a<=r;a++)n+=i(1-t,r-a)*i(t,a)*e[a]*o(r,a);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=s.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(r=n*(1+t))),o(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(o(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):o(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=s.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:(r=[1],function(e){var t=1;if(r[e])return r[e];for(var n=e;n>1;n--)t*=n;return r[e]=t,t}),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),a=.5*(r-t),s=i*i;return(2*t-2*n+o+a)*(i*s)+(-3*t+3*n-2*o-a)*s+o*i+t}}},u=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),c=new a,l=function(){function e(e,t){void 0===t&&(t=c),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=i.Linear.None,this._interpolationFunction=s.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=u.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},e.prototype.duration=function(e){return this._duration=e,this},e.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"==typeof e?o()+parseFloat(e):e:o(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(e,t,n,r){for(var i in n){var o=e[i],a=Array.isArray(o),s=a?"array":typeof o,u=!a&&Array.isArray(n[i]);if("undefined"!==s&&"function"!==s){if(u){var c=n[i];if(0===c.length)continue;c=c.map(this._handleRelativeValue.bind(this,o)),n[i]=[o].concat(c)}if("object"!==s&&!a||!o||u)void 0===t[i]&&(t[i]=o),a||(t[i]*=1),r[i]=u?n[i].slice().reverse():t[i]||0;else{for(var l in t[i]=a?[]:{},o)t[i][l]=o[l];r[i]=a?[]:{},this._setupProperties(o,t[i],n[i],r[i])}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=o()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=o()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return this._group=e,this},e.prototype.delay=function(e){return this._delayTime=e,this},e.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return this._yoyo=e,this},e.prototype.easing=function(e){return this._easingFunction=e,this},e.prototype.interpolation=function(e){return this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=o()),void 0===t&&(t=!0),this._isPaused)return!0;var n,r,i=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>i)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(e-this._startTime)/this._duration,r=0===this._duration||r>1?1:r;var a=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,u=this._chainedTweens.length;s<u;s++)this._chainedTweens[s].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,n,r){for(var i in n)if(void 0!==t[i]){var o=t[i]||0,a=n[i],s=Array.isArray(e[i]),u=Array.isArray(a);!s&&u?e[i]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(e[i],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[i]=o+(a-o)*r)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),d="18.6.4",f=u.nextId,p=c,h=p.getAll.bind(p),v=p.removeAll.bind(p),m=p.add.bind(p),y=p.remove.bind(p),g=p.update.bind(p),b={Easing:i,Group:a,Interpolation:s,now:o,Sequence:u,nextId:f,Tween:l,VERSION:d,getAll:h,removeAll:v,add:m,remove:y,update:g};t.default=b},71339:function(e,t,n){var r=n(81506).default,i=n(63038).default,o=n(87757),a=n(16525).default,s=n(29754).default,u=n(2205).default,c=n(99842).default,l=n(34575).default,d=n(93913).default;!function(e,t){"use strict";var n=function(){function e(){l(this,e),this.name="",this.minZoom=0,this.maxZoom=20,this.bounds=[],this.center=[]}return d(e,[{key:"fetchTile",value:function(e,t,n){return null}},{key:"getMetaData",value:function(){}}]),e}(),f=function(e){u(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://a.tile.openstreetmap.org/";return l(this,n),(e=t.call(this)).address=r,e.format="png",e}return d(n,[{key:"fetchTile",value:function(e,t,n){var r=this;return new Promise((function(i,o){var a=document.createElement("img");a.onload=function(){i(a)},a.onerror=function(){o()},a.crossOrigin="Anonymous",a.src=r.address+e+"/"+t+"/"+n+"."+r.format}))}}]),n}(n),p=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10;l(this,r),e=n.call(this);var d=[],f=[],p=[],h=[];return r.buildPlane(i,o,a,s,d,f,p,h),u&&r.buildSkirt(i,o,a,s,c,d,f,p,h),e.setIndex(d),e.setAttribute("position",new t.Float32BufferAttribute(f,3)),e.setAttribute("normal",new t.Float32BufferAttribute(p,3)),e.setAttribute("uv",new t.Float32BufferAttribute(h,2)),e}return d(r,null,[{key:"buildPlane",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=e/2,c=t/2,l=n+1,d=r+1,f=e/n,p=t/r,h=0;h<d;h++)for(var v=h*p-c,m=0;m<l;m++){var y=m*f-u;o.push(y,0,v),a.push(0,1,0),s.push(m/n,1-h/r)}for(var g=0;g<r;g++)for(var b=0;b<n;b++){var x=b+l*g,_=b+l*(g+1),w=b+1+l*(g+1),M=b+1+l*g;i.push(x,_,M,_,w,M)}}},{key:"buildSkirt",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=e/2,l=t/2,d=n+1,f=r+1,p=e/n,h=t/r,v=a.length/3,m=0;m<d;m++){var y=m*p-c,g=-l;a.push(y,-i,g),s.push(0,1,0),u.push(m/n,1)}for(var b=0;b<n;b++){var x=b,_=b+1,w=b+v,M=b+v+1;o.push(_,w,x,_,M,w)}v=a.length/3;for(var S=0;S<d;S++){var T=S*p-c,E=r*h-l;a.push(T,-i,E),s.push(0,1,0),u.push(S/n,0)}for(var k=d*f-n-1,A=0;A<n;A++){var P=k+A,C=k+A+1,O=A+v,I=A+v+1;o.push(P,O,C,O,I,C)}v=a.length/3;for(var R=0;R<f;R++){var N=R*h-l,D=-c;a.push(D,-i,N),s.push(0,1,0),u.push(0,1-R/r)}for(var L=0;L<r;L++){var B=L*f,F=(L+1)*f,j=L+v,z=L+v+1;o.push(B,j,F,j,z,F)}v=a.length/3;for(var U=0;U<f;U++){var G=U*h-l,V=n*p-c;a.push(V,-i,G),s.push(0,1,0),u.push(1,1-U/r)}for(var W=0;W<r;W++){var H=W*f+r,Z=(W+1)*f+r,q=W+v,Y=W+v+1;o.push(Z,q,H,Z,Y,q)}}}]),r}(t.BufferGeometry),h=function(){function e(){l(this,e)}return d(e,null,[{key:"createOffscreenCanvas",value:function(e,t){if(OffscreenCanvas)return new OffscreenCanvas(e,t);var n=document.createElement("canvas");return n.width=e,n.height=t,n}}]),e}(),v=function(e){u(r,e);var n=c(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.root,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return l(this,r),(e=n.call(this,c,d)).mapView=null,e.parentNode=null,e.nodesLoaded=0,e.subdivided=!1,e.childrenCache=null,e.cacheChild=!1,e.isMesh=!0,e.mapView=i,e.parentNode=t,e.location=o,e.level=a,e.x=s,e.y=u,e.initialize(),e}return d(r,[{key:"initialize",value:function(){}},{key:"createChildNodes",value:function(){}},{key:"subdivide",value:function(){var e=Math.min(this.mapView.provider.maxZoom,this.mapView.heightProvider.maxZoom);this.children.length>0||this.level+1>e||null!==this.parentNode&&this.parentNode.nodesLoaded<r.childrens||(this.subdivided=!0,this.cacheChild&&null!==this.childrenCache?(this.isMesh=!1,this.children=this.childrenCache):this.createChildNodes())}},{key:"simplify",value:function(){this.cacheChild&&this.children.length>0&&(this.childrenCache=this.children),this.subdivided=!1,this.isMesh=!0,this.children=[]}},{key:"loadTexture",value:function(){var e=this;this.mapView.provider.fetchTile(this.level,this.x,this.y).then((function(n){var r=new t.Texture(n);r.generateMipmaps=!1,r.format=t.RGBFormat,r.magFilter=t.LinearFilter,r.minFilter=t.LinearFilter,r.needsUpdate=!0,e.material.map=r,e.nodeReady()})).catch((function(){var n=h.createOffscreenCanvas(1,1),r=n.getContext("2d");r.fillStyle="#FF0000",r.fillRect(0,0,1,1);var i=new t.Texture(n);i.generateMipmaps=!1,i.needsUpdate=!0,e.material.map=i,e.nodeReady()}))}},{key:"nodeReady",value:function(){if(null!==this.parentNode){if(this.parentNode.nodesLoaded++,this.parentNode.nodesLoaded>=r.childrens){!0===this.parentNode.subdivided&&(this.parentNode.isMesh=!1);for(var e=0;e<this.parentNode.children.length;e++)this.parentNode.children[e].visible=!0}}else this.visible=!0}},{key:"getNeighborsDirection",value:function(e){return null}},{key:"getNeighbors",value:function(){return[]}}]),r}(t.Mesh);v.baseGeometry=null,v.baseScale=null,v.childrens=4,v.root=-1,v.topLeft=0,v.topRight=1,v.bottomLeft=2,v.bottomRight=3;var m=function(){function e(){l(this,e)}return d(e,null,[{key:"get",value:function(e,t){navigator.geolocation.getCurrentPosition((function(t){e(t.coords,t.timestamp)}),t)}},{key:"datumsToSpherical",value:function(n,r){var i=r*e.EARTH_ORIGIN/180,o=Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180);return o=o*e.EARTH_ORIGIN/180,new t.Vector2(i,o)}},{key:"sphericalToDatums",value:function(t,n){var r=t/e.EARTH_ORIGIN*180,i=n/e.EARTH_ORIGIN*180;return{latitude:i=180/Math.PI*(2*Math.atan(Math.exp(i*Math.PI/180))-Math.PI/2),longitude:r}}},{key:"quadtreeToDatums",value:function(e,t,n){var r=Math.pow(2,e),i=t/r*360-180;return{latitude:Math.atan(Math.sinh(Math.PI*(1-2*n/r)))/Math.PI*180,longitude:i}}}]),e}();m.EARTH_RADIUS=6378137,m.EARTH_PERIMETER=2*Math.PI*m.EARTH_RADIUS,m.EARTH_ORIGIN=m.EARTH_PERIMETER/2;var y=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.root,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return l(this,r),(e=n.call(this,i,o,a,s,u,c,r.geometry,new t.MeshBasicMaterial({wireframe:!1}))).matrixAutoUpdate=!1,e.isMesh=!0,e.visible=!1,e}return d(r,[{key:"initialize",value:function(){a(s(r.prototype),"initialize",this).call(this),this.loadTexture()}},{key:"createChildNodes",value:function(){var e=this.level+1,t=2*this.x,n=2*this.y,r=Object.getPrototypeOf(this).constructor,i=new r(this,this.mapView,v.topLeft,e,t,n);i.scale.set(.5,1,.5),i.position.set(-.25,0,-.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),(i=new r(this,this.mapView,v.topRight,e,t+1,n)).scale.set(.5,1,.5),i.position.set(.25,0,-.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),(i=new r(this,this.mapView,v.bottomLeft,e,t,n+1)).scale.set(.5,1,.5),i.position.set(-.25,0,.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),(i=new r(this,this.mapView,v.bottomRight,e,t+1,n+1)).scale.set(.5,1,.5),i.position.set(.25,0,.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0)}},{key:"raycast",value:function(e,t){return!0===this.isMesh&&a(s(r.prototype),"raycast",this).call(this,e,t)}}]),r}(v);y.geometry=new p(1,1,1,1,!1),y.baseGeometry=y.geometry,y.baseScale=new t.Vector3(m.EARTH_PERIMETER,1,m.EARTH_PERIMETER);var g=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];l(this,r),e=n.call(this);var h=[],v=[],m=[],y=[];p.buildPlane(i,o,a,s,h,v,m,y);for(var g=d.data,b=0,x=0;b<g.length&&x<v.length;b+=4,x+=3){var _=.1*(65536*g[b]+256*g[b+1]+g[b+2])-1e4;v[x+1]=_}return u&&p.buildSkirt(i,o,a,s,c,h,v,m,y),e.setIndex(h),e.setAttribute("position",new t.Float32BufferAttribute(v,3)),e.setAttribute("normal",new t.Float32BufferAttribute(m,3)),e.setAttribute("uv",new t.Float32BufferAttribute(y,2)),f&&e.computeNormals(a,s),e}return d(r,[{key:"computeNormals",value:function(e,n){var r=this.getAttribute("position");if(void 0!==r){for(var i=this.getAttribute("normal"),o=n*e,a=0;a<o;a++)i.setXYZ(a,0,0,0);for(var s=new t.Vector3,u=new t.Vector3,c=new t.Vector3,l=new t.Vector3,d=new t.Vector3,f=new t.Vector3,p=new t.Vector3,h=new t.Vector3,v=n*e*6,m=0;m<v;m+=3){var y=this.index.getX(m+0),g=this.index.getX(m+1),b=this.index.getX(m+2);s.fromBufferAttribute(r,y),u.fromBufferAttribute(r,g),c.fromBufferAttribute(r,b),p.subVectors(c,u),h.subVectors(s,u),p.cross(h),l.fromBufferAttribute(i,y),d.fromBufferAttribute(i,g),f.fromBufferAttribute(i,b),l.add(p),d.add(p),f.add(p),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(g,d.x,d.y,d.z),i.setXYZ(b,f.x,f.y,f.z)}this.normalizeNormals(),i.needsUpdate=!0}}}]),r}(t.BufferGeometry),b=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.root,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r.geometry,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:new t.MeshPhongMaterial({wireframe:!1,color:16777215});return l(this,r),(e=n.call(this,i,o,a,s,u,c,d,f)).heightLoaded=!1,e.textureLoaded=!1,e.geometrySize=16,e.geometryNormals=!1,e.isMesh=!0,e.visible=!1,e.matrixAutoUpdate=!1,e}return d(r,[{key:"initialize",value:function(){a(s(r.prototype),"initialize",this).call(this),this.loadTexture(),this.loadHeightGeometry()}},{key:"loadTexture",value:function(){var e=this;this.mapView.provider.fetchTile(this.level,this.x,this.y).then((function(n){var r=new t.Texture(n);r.generateMipmaps=!1,r.format=t.RGBFormat,r.magFilter=t.LinearFilter,r.minFilter=t.LinearFilter,r.needsUpdate=!0,e.material.map=r})).finally((function(){e.textureLoaded=!0,e.nodeReady()}))}},{key:"nodeReady",value:function(){this.heightLoaded&&this.textureLoaded&&(this.visible=!0,a(s(r.prototype),"nodeReady",this).call(this))}},{key:"createChildNodes",value:function(){var e=this.level+1,t=Object.getPrototypeOf(this).constructor,n=2*this.x,r=2*this.y,i=new t(this,this.mapView,v.topLeft,e,n,r);i.scale.set(.5,1,.5),i.position.set(-.25,0,-.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),(i=new t(this,this.mapView,v.topRight,e,n+1,r)).scale.set(.5,1,.5),i.position.set(.25,0,-.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),(i=new t(this,this.mapView,v.bottomLeft,e,n,r+1)).scale.set(.5,1,.5),i.position.set(-.25,0,.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),(i=new t(this,this.mapView,v.bottomRight,e,n+1,r+1)).scale.set(.5,1,.5),i.position.set(.25,0,.25),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0)}},{key:"loadHeightGeometry",value:function(){var e=this;if(null===this.mapView.heightProvider)throw new Error("GeoThree: MapView.heightProvider provider is null.");return this.mapView.heightProvider.fetchTile(this.level,this.x,this.y).then((function(t){var n=h.createOffscreenCanvas(e.geometrySize+1,e.geometrySize+1),i=n.getContext("2d");i.imageSmoothingEnabled=!1,i.drawImage(t,0,0,r.tileSize,r.tileSize,0,0,n.width,n.height);var o=i.getImageData(0,0,n.width,n.height),a=new g(1,1,e.geometrySize,e.geometrySize,!0,10,o,!0);e.geometry=a})).catch((function(){console.error("GeoThree: Failed to load height node data.",e)})).finally((function(){e.heightLoaded=!0,e.nodeReady()}))}},{key:"raycast",value:function(e,t){return!0===this.isMesh&&a(s(r.prototype),"raycast",this).call(this,e,t)}}]),r}(v);b.tileSize=256,b.geometry=new p(1,1,1,1),b.baseGeometry=y.geometry,b.baseScale=new t.Vector3(m.EARTH_PERIMETER,1,m.EARTH_PERIMETER);var x=function(e){u(r,e);var n=c(r);function r(e,i,o,a,s,u,c){var d;l(this,r),d=n.call(this);for(var f=u+c,p=0,h=[],v=new t.Vector3,m=new t.Vector3,y=[],g=[],b=[],x=[],_=0;_<=o;_++){for(var w=[],M=_/o,S=0;S<=i;S++){var T=S/i;v.x=-e*Math.cos(a+T*s)*Math.sin(u+M*c),v.y=e*Math.cos(u+M*c),v.z=e*Math.sin(a+T*s)*Math.sin(u+M*c),g.push(v.x,v.y,v.z),m.set(v.x,v.y,v.z).normalize(),b.push(m.x,m.y,m.z),x.push(T,1-M),w.push(p++)}h.push(w)}for(var E=0;E<o;E++)for(var k=0;k<i;k++){var A=h[E][k+1],P=h[E][k],C=h[E+1][k],O=h[E+1][k+1];(0!==E||u>0)&&y.push(A,P,O),(E!==o-1||f<Math.PI)&&y.push(P,C,O)}return d.setIndex(y),d.setAttribute("position",new t.Float32BufferAttribute(g,3)),d.setAttribute("normal",new t.Float32BufferAttribute(b,3)),d.setAttribute("uv",new t.Float32BufferAttribute(x,2)),d}return d(r)}(t.BufferGeometry),_=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.root,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return l(this,r),(e=n.call(this,i,o,a,s,u,c,r.createGeometry(s,u,c),new t.MeshBasicMaterial({wireframe:!1}))).applyScaleNode(),e.matrixAutoUpdate=!1,e.isMesh=!0,e.visible=!1,e}return d(r,[{key:"initialize",value:function(){a(s(r.prototype),"initialize",this).call(this),this.loadTexture()}},{key:"applyScaleNode",value:function(){this.geometry.computeBoundingBox();var e=this.geometry.boundingBox.clone().getCenter(new t.Vector3),n=new t.Matrix4;n.compose(new t.Vector3(-e.x,-e.y,-e.z),new t.Quaternion,new t.Vector3(m.EARTH_RADIUS,m.EARTH_RADIUS,m.EARTH_RADIUS)),this.geometry.applyMatrix4(n),this.position.copy(e),this.updateMatrix(),this.updateMatrixWorld()}},{key:"updateMatrix",value:function(){this.matrix.setPosition(this.position),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1)}},{key:"createChildNodes",value:function(){var e=this.level+1,t=2*this.x,n=2*this.y,r=Object.getPrototypeOf(this).constructor,i=new r(this,this.mapView,v.topLeft,e,t,n);this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),i=new r(this,this.mapView,v.topRight,e,t+1,n),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),i=new r(this,this.mapView,v.bottomLeft,e,t,n+1),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0),i=new r(this,this.mapView,v.bottomRight,e,t+1,n+1),this.add(i),i.updateMatrix(),i.updateMatrixWorld(!0)}},{key:"raycast",value:function(e,t){return!0===this.isMesh&&a(s(r.prototype),"raycast",this).call(this,e,t)}}],[{key:"createGeometry",value:function(e,t,n){var i=Math.pow(2,e),o=Math.floor(r.segments*(40/(e+1))/40),a=1/i*2*Math.PI,s=t*a,u=1/i*Math.PI;return new x(1,o,o,s,a,n*u,u)}}]),r}(v);_.baseGeometry=new x(m.EARTH_RADIUS,64,64,0,2*Math.PI,0,Math.PI),_.baseScale=new t.Vector3(1,1,1),_.segments=80;var w=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.root,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;l(this,r);var d=r.prepareMaterial(new t.MeshPhongMaterial({map:r.emptyTexture,color:16777215}));return(e=n.call(this,i,o,a,s,u,c,r.geometry,d)).frustumCulled=!1,e}return d(r,[{key:"loadTexture",value:function(){var e=this;this.mapView.provider.fetchTile(this.level,this.x,this.y).then((function(n){var r=new t.Texture(n);r.generateMipmaps=!1,r.format=t.RGBFormat,r.magFilter=t.LinearFilter,r.minFilter=t.LinearFilter,r.needsUpdate=!0,e.material.map=r,e.textureLoaded=!0,e.nodeReady()})).catch((function(e){console.error("GeoThree: Failed to load color node data.",e)})).finally((function(){e.textureLoaded=!0,e.nodeReady()})),this.loadHeightGeometry()}},{key:"loadHeightGeometry",value:function(){var e=this;if(null===this.mapView.heightProvider)throw new Error("GeoThree: MapView.heightProvider provider is null.");return this.mapView.heightProvider.fetchTile(this.level,this.x,this.y).then((function(n){var r=new t.Texture(n);r.generateMipmaps=!1,r.format=t.RGBFormat,r.magFilter=t.NearestFilter,r.minFilter=t.NearestFilter,r.needsUpdate=!0,e.material.userData.heightMap.value=r})).catch((function(e){console.error("GeoThree: Failed to load height node data.",e)})).finally((function(){e.heightLoaded=!0,e.nodeReady()}))}},{key:"raycast",value:function(e,t){if(!0===this.isMesh){this.geometry=y.geometry;var n=a(s(r.prototype),"raycast",this).call(this,e,t);return this.geometry=r.geometry,n}return!1}}],[{key:"prepareMaterial",value:function(e){return e.userData={heightMap:{value:r.emptyTexture}},e.onBeforeCompile=function(t){for(var n in e.userData)t.uniforms[n]=e.userData[n];t.vertexShader="\n\t\t\tuniform sampler2D heightMap;\n\t\t\t"+t.vertexShader,t.vertexShader=t.vertexShader.replace("#include <fog_vertex>","\n\t\t\t#include <fog_vertex>\n\t\n\t\t\t// Calculate height of the title\n\t\t\tvec4 _theight = texture2D(heightMap, vUv);\n\t\t\tfloat _height = ((_theight.r * 255.0 * 65536.0 + _theight.g * 255.0 * 256.0 + _theight.b * 255.0) * 0.1) - 10000.0;\n\t\t\tvec3 _transformed = position + _height * normal;\n\t\n\t\t\t// Vertex position based on height\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(_transformed, 1.0);\n\t\t\t")},e}}]),r}(b);w.emptyTexture=new t.Texture,w.geometrySize=256,w.geometry=new p(1,1,w.geometrySize,w.geometrySize,!0),w.baseGeometry=y.geometry,w.baseScale=new t.Vector3(m.EARTH_PERIMETER,1,m.EARTH_PERIMETER);var M=function(){function e(){l(this,e),this.subdivisionRays=1,this.thresholdUp=.6,this.thresholdDown=.15,this.raycaster=new t.Raycaster,this.mouse=new t.Vector2,this.powerDistance=!1,this.scaleDistance=!0}return d(e,[{key:"updateLOD",value:function(e,n,r,i){for(var o=[],a=0;a<this.subdivisionRays;a++)this.mouse.set(2*Math.random()-1,2*Math.random()-1),this.raycaster.setFromCamera(this.mouse,n),this.raycaster.intersectObjects(e.children,!0,o);for(var s=0;s<o.length;s++){var u=o[s].object,c=o[s].distance;if(this.powerDistance&&(c=Math.pow(2*c,u.level)),this.scaleDistance){var l=u.matrixWorld.elements;c=new t.Vector3(l[0],l[1],l[2]).length()/c}if(c>this.thresholdUp)return void u.subdivide();if(c<this.thresholdDown&&null!==u.parentNode)return void u.parentNode.simplify()}}}]),e}();function S(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}var T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:257;l(this,e),this.gridSize=t;var n=t-1;if(n&n-1)throw new Error("Expected grid size to be 2^n+1, got ".concat(t,"."));this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(4*this.numTriangles);for(var r=0;r<this.numTriangles;r++){var i=r+2,o=0,a=0,s=0,u=0,c=0,d=0;for(1&i?s=u=c=n:o=a=d=n;(i>>=1)>1;){var f=o+s>>1,p=a+u>>1;1&i?(s=o,u=a,o=c,a=d):(o=s,a=u,s=c,u=d),c=f,d=p}var h=4*r;this.coords[h+0]=o,this.coords[h+1]=a,this.coords[h+2]=s,this.coords[h+3]=u}}return d(e,[{key:"createTile",value:function(e){return new E(e,this)}}]),e}(),E=function(){function e(t,n){l(this,e);var r=n.gridSize;if(t.length!==r*r)throw new Error("Expected terrain data of length ".concat(r*r," (").concat(r," x ").concat(r,"), got ").concat(t.length,"."));this.terrain=t,this.martini=n,this.errors=new Float32Array(t.length),this.update()}return d(e,[{key:"update",value:function(){for(var e=this.martini,t=e.numTriangles,n=e.numParentTriangles,r=e.coords,i=e.gridSize,o=this.terrain,a=this.errors,s=t-1;s>=0;s--){var u=4*s,c=r[u+0],l=r[u+1],d=r[u+2],f=r[u+3],p=c+d>>1,h=l+f>>1,v=p+h-l,m=h+c-p,y=(o[l*i+c]+o[f*i+d])/2,g=h*i+p,b=Math.abs(y-o[g]);if(a[g]=Math.max(a[g],b),s<n){var x=(l+m>>1)*i+(c+v>>1),_=(f+m>>1)*i+(d+v>>1);a[g]=Math.max(a[g],a[x],a[_])}}}},{key:"getMesh",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.martini,o=i.gridSize,a=i.indices,s=this.errors,u=0,c=0,l=o-1,d=0,f=[],p=[],h=[],v=[];function m(i,y,g,b,x,_){var w=i+g>>1,M=y+b>>1;Math.abs(i-x)+Math.abs(y-_)>1&&s[M*o+w]>n?(m(x,_,i,y,w,M),m(g,b,x,_,w,M)):(t=b*o+g,d=_*o+x,0===a[e=y*o+i]&&(r&&(0===i?f.push(u):i===l&&p.push(u),0===y?h.push(u):y===l&&v.push(u)),a[e]=++u),0===a[t]&&(r&&(0===g?f.push(u):g===l&&p.push(u),0===b?h.push(u):b===l&&v.push(u)),a[t]=++u),0===a[d]&&(r&&(0===x?f.push(u):x===l&&p.push(u),0===_?h.push(u):_===l&&v.push(u)),a[d]=++u),c++)}a.fill(0),m(0,0,l,l,l,0),m(l,l,0,0,0,l);var y=2*u,g=3*c;r&&(y+=2*(f.length+p.length+h.length+v.length),g+=3*(2*(f.length-1)+2*(p.length-1)+2*(h.length-1)+2*(v.length-1)));var b=new Uint16Array(y),x=new Uint32Array(g),_=0;function w(e,t,r,i,u,c){var l=e+r>>1,d=t+i>>1;if(Math.abs(e-u)+Math.abs(t-c)>1&&s[d*o+l]>n)w(u,c,e,t,l,d),w(r,i,u,c,l,d);else{var f=a[t*o+e]-1,p=a[i*o+r]-1,h=a[c*o+u]-1;b[2*f]=e,b[2*f+1]=t,b[2*p]=r,b[2*p+1]=i,b[2*h]=u,b[2*h+1]=c,x[_++]=f,x[_++]=p,x[_++]=h}}if(w(0,0,l,l,l,0),w(l,l,0,0,0,l),r){var M=function(e){for(var t=e.length,n=0;n<t-1;n++){var r=e[n],i=e[n+1],o=S/2,a=(S+2)/2;b[S++]=b[2*r],b[S++]=b[2*r+1],x[_++]=r,x[_++]=o,x[_++]=i,x[_++]=o,x[_++]=a,x[_++]=i}b[S++]=b[2*e[t-1]],b[S++]=b[2*e[t-1]+1]};f.sort((function(e,t){return b[2*e+1]-b[2*t+1]})),p.sort((function(e,t){return b[2*t+1]-b[2*e+1]})),h.sort((function(e,t){return b[2*t]-b[2*e]})),v.sort((function(e,t){return b[2*e]-b[2*t]}));var S=2*u;M(f),M(p),M(h),M(v)}return{vertices:b,triangles:x,numVerticesWithoutSkirts:u}}}]),e}(),k=function(e){u(r,e);var n=c(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.root,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},f=d.elevationDecoder,p=void 0===f?null:f,h=d.meshMaxError,m=void 0===h?10:h,y=d.exageration,g=void 0===y?1:y;return l(this,r),(e=n.call(this,i,o,a,s,u,c,r.geometry,r.prepareMaterial(new t.MeshPhongMaterial({map:r.emptyTexture,color:16777215,side:t.DoubleSide}),s,g))).elevationDecoder={rScaler:256,gScaler:1,bScaler:1/256,offset:-32768},e.exageration=1,e.meshMaxError=10,p&&(e.elevationDecoder=p),e.meshMaxError=m,e.exageration=g,e.frustumCulled=!1,e}return d(r,[{key:"onHeightImage",value:function(e){return S(this,void 0,void 0,o.mark((function n(){var i,a,s,u,c,l,d,f,p,v,m,y,g,b;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=e.width,a=i+1,s=h.createOffscreenCanvas(i,i),(u=s.getContext("2d")).imageSmoothingEnabled=!1,u.drawImage(e,0,0,i,i,0,0,s.width,s.height),c=u.getImageData(0,0,s.width,s.height),l=c.data,d=r.getTerrain(l,i,this.elevationDecoder),f=new T(a),p=f.createTile(d),v=p.getMesh("function"==typeof this.meshMaxError?this.meshMaxError(this.level):this.meshMaxError),m=v.vertices,y=v.triangles,g=r.getMeshAttributes(m,d,i,[-.5,-.5,.5,.5],this.exageration),this.geometry=new t.BufferGeometry,this.geometry.setIndex(new t.Uint32BufferAttribute(y,1)),this.geometry.setAttribute("position",new t.Float32BufferAttribute(g.position.value,g.position.size)),this.geometry.setAttribute("uv",new t.Float32BufferAttribute(g.uv.value,g.uv.size)),this.geometry.rotateX(Math.PI),(b=new t.Texture(e)).generateMipmaps=!1,b.format=t.RGBFormat,b.magFilter=t.NearestFilter,b.minFilter=t.NearestFilter,b.needsUpdate=!0,this.material.userData.heightMap.value=b;case 25:case"end":return n.stop()}}),n,this)})))}},{key:"loadHeightGeometry",value:function(){var e=this;if(null===this.mapView.heightProvider)throw new Error("GeoThree: MapView.heightProvider provider is null.");return this.mapView.heightProvider.fetchTile(this.level,this.x,this.y).then((function(t){return S(e,void 0,void 0,o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onHeightImage(t);case 1:case"end":return e.stop()}}),e,this)})))})).finally((function(){e.heightLoaded=!0,e.nodeReady()}))}}],[{key:"prepareMaterial",value:function(e,t){return e.userData={heightMap:{value:r.emptyTexture},drawNormals:{value:0},drawBlack:{value:0},zoomlevel:{value:t},computeNormals:{value:1},drawTexture:{value:1}},e.onBeforeCompile=function(t){for(var n in e.userData)t.uniforms[n]=e.userData[n];t.vertexShader="\n\t\t\t\tuniform bool computeNormals;\n\t\t\t\tuniform float zoomlevel;\n\t\t\t\tuniform sampler2D heightMap;\n\t\t\t\t"+t.vertexShader,t.fragmentShader="\n\t\t\t\tuniform bool drawNormals;\n\t\t\t\tuniform bool drawTexture;\n\t\t\t\tuniform bool drawBlack;\n\t\t\t\t"+t.fragmentShader,t.fragmentShader=t.fragmentShader.replace("#include <dithering_fragment>","\n\t\t\t\tif(drawBlack) {\n\t\t\t\t\tgl_FragColor = vec4( 0.0,0.0,0.0, 1.0 );\n\t\t\t\t} else if(drawNormals) {\n\t\t\t\t\tgl_FragColor = vec4( ( 0.5 * vNormal + 0.5 ), 1.0 );\n\t\t\t\t} else if (!drawTexture) {\n\t\t\t\t\tgl_FragColor = vec4( 0.0,0.0,0.0, 0.0 );\n\t\t\t\t}"),t.vertexShader=t.vertexShader.replace("#include <fog_vertex>","\n\t\t\t\t#include <fog_vertex>\n\n\t\t\t\t// queried pixels:\n\t\t\t\t// +-----------+\n\t\t\t\t// |   |   |   |\n\t\t\t\t// | a | b | c |\n\t\t\t\t// |   |   |   |\n\t\t\t\t// +-----------+\n\t\t\t\t// |   |   |   |\n\t\t\t\t// | d | e | f |\n\t\t\t\t// |   |   |   |\n\t\t\t\t// +-----------+\n\t\t\t\t// |   |   |   |\n\t\t\t\t// | g | h | i |\n\t\t\t\t// |   |   |   |\n\t\t\t\t// +-----------+\n\n\t\t\t\tif (computeNormals) {\n\t\t\t\t\tfloat e = getElevation(vUv, 0.0);\n\t\t\t\t\tivec2 size = textureSize(heightMap, 0);\n\t\t\t\t\tfloat offset = 1.0 / float(size.x);\n\t\t\t\t\tfloat a = getElevation(vUv + vec2(-offset, -offset), 0.0);\n\t\t\t\t\tfloat b = getElevation(vUv + vec2(0, -offset), 0.0);\n\t\t\t\t\tfloat c = getElevation(vUv + vec2(offset, -offset), 0.0);\n\t\t\t\t\tfloat d = getElevation(vUv + vec2(-offset, 0), 0.0);\n\t\t\t\t\tfloat f = getElevation(vUv + vec2(offset, 0), 0.0);\n\t\t\t\t\tfloat g = getElevation(vUv + vec2(-offset, offset), 0.0);\n\t\t\t\t\tfloat h = getElevation(vUv + vec2(0, offset), 0.0);\n\t\t\t\t\tfloat i = getElevation(vUv + vec2(offset,offset), 0.0);\n\n\n\t\t\t\t\tfloat normalLength = 500.0 / zoomlevel;\n\n\t\t\t\t\tvec3 v0 = vec3(0.0, 0.0, 0.0);\n\t\t\t\t\tvec3 v1 = vec3(0.0, normalLength, 0.0);\n\t\t\t\t\tvec3 v2 = vec3(normalLength, 0.0, 0.0);\n\t\t\t\t\tv0.z = (e + d + g + h) / 4.0;\n\t\t\t\t\tv1.z = (e+ b + a + d) / 4.0;\n\t\t\t\t\tv2.z = (e+ h + i + f) / 4.0;\n\t\t\t\t\tvNormal = (normalize(cross(v2 - v0, v1 - v0))).rbg;\n\t\t\t\t}\n\t\t\t\t")},e}},{key:"getTerrain",value:function(e,t,n){for(var r=n.rScaler,i=n.bScaler,o=n.gScaler,a=n.offset,s=t+1,u=new Float32Array(s*s),c=0,l=0;l<t;l++)for(var d=0;d<t;d++,c++){var f=4*c,p=e[f+0],h=e[f+1],v=e[f+2];u[c+l]=p*r+h*o+v*i+a}for(var m=s*(s-1),y=0;y<s-1;y++,m++)u[m]=u[m-s];for(var g=s-1,b=0;b<s;b++,g+=s)u[g]=u[g-1];return u}},{key:"getMeshAttributes",value:function(e,t,n,r,o){for(var a=n+1,s=e.length/2,u=new Float32Array(3*s),c=new Float32Array(2*s),l=i(r||[0,0,n,n],4),d=l[0],f=l[1],p=l[2],h=l[3],v=(p-d)/n,m=(h-f)/n,y=0;y<s;y++){var g=e[2*y],b=e[2*y+1],x=b*a+g;u[3*y+0]=g*v+d,u[3*y+1]=-t[x]*o,u[3*y+2]=-b*m+h,c[2*y+0]=g/n,c[2*y+1]=b/n}return{position:{value:u,size:3},uv:{value:c,size:2}}}}]),r}(b);k.geometrySize=16,k.emptyTexture=new t.Texture,k.geometry=new p(1,1,1,1),k.tileSize=256;var A=function(e){u(i,e);var n=c(i);function i(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.PLANAR,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new f,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return l(this,i),(e=n.call(this,void 0,new t.MeshBasicMaterial({transparent:!0,opacity:0}))).lod=null,e.provider=null,e.heightProvider=null,e.root=null,e.onBeforeRender=function(t,n,i,o,a,s){e.lod.updateLOD(r(e),i,t,n)},e.lod=new M,e.provider=a,e.heightProvider=s,e.setRoot(o),e}return d(i,[{key:"setRoot",value:function(e){if("number"==typeof e){if(!i.mapModes.has(e))throw new Error("Map mode "+e+" does is not registered.");e=new(i.mapModes.get(e))(null,this)}null!==this.root&&(this.remove(this.root),this.root=null),this.root=e,null!==this.root&&(this.geometry=this.root.constructor.baseGeometry,this.scale.copy(this.root.constructor.baseScale),this.root.mapView=this,this.add(this.root))}},{key:"setProvider",value:function(e){e!==this.provider&&(this.provider=e,this.clear())}},{key:"setHeightProvider",value:function(e){e!==this.heightProvider&&(this.heightProvider=e,this.clear())}},{key:"clear",value:function(){return this.traverse((function(e){e.childrenCache&&(e.childrenCache=null),e.initialize&&e.initialize()})),this}},{key:"getMetaData",value:function(){this.provider.getMetaData()}},{key:"raycast",value:function(e,t){return!1}}]),i}(t.Mesh);A.PLANAR=200,A.SPHERICAL=201,A.HEIGHT=202,A.HEIGHT_SHADER=203,A.MARTINI=204,A.mapModes=new Map([[A.PLANAR,y],[A.SPHERICAL,_],[A.HEIGHT,b],[A.HEIGHT_SHADER,w],[A.MARTINI,k]]);var P=new t.Vector3,C=new t.Vector3,O=function(){function e(){l(this,e),this.subdivideDistance=50,this.simplifyDistance=300}return d(e,[{key:"updateLOD",value:function(e,t,n,r){var i=this;t.getWorldPosition(P),e.children[0].traverse((function(t){t.getWorldPosition(C);var n=P.distanceTo(C);(n/=Math.pow(2,e.provider.maxZoom-t.level))<i.subdivideDistance?t.subdivide():n>i.simplifyDistance&&t.parentNode&&t.parentNode.simplify()}))}}]),e}(),I=new t.Matrix4,R=new t.Vector3,N=new t.Frustum,D=new t.Vector3,L=function(e){u(n,e);var t=c(n);function n(){var e;return l(this,n),(e=t.apply(this,arguments)).subdivideDistance=120,e.simplifyDistance=400,e.testCenter=!0,e.pointOnly=!1,e}return d(n,[{key:"updateLOD",value:function(e,t,n,r){var i=this;I.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),N.setFromProjectionMatrix(I),t.getWorldPosition(R),e.children[0].traverse((function(t){t.getWorldPosition(D);var n=R.distanceTo(D);n/=Math.pow(2,e.provider.maxZoom-t.level);var r=i.pointOnly?N.containsPoint(D):N.intersectsObject(t);n<i.subdivideDistance&&r?t.subdivide():n>i.simplifyDistance&&t.parentNode&&t.parentNode.simplify()}))}}]),n}(O),B=function(){function e(){l(this,e)}return d(e,null,[{key:"get",value:function(e,t,n){var r=new XMLHttpRequest;return r.overrideMimeType("text/plain"),r.open("GET",e,!0),void 0!==t&&(r.onload=function(){t(r.response)}),void 0!==n&&(r.onerror=n),r.send(null),r}},{key:"getRaw",value:function(e,t,n){var r=new XMLHttpRequest;return r.responseType="arraybuffer",r.open("GET",e,!0),void 0!==t&&(r.onload=function(){t(r.response)}),void 0!==n&&(r.onerror=n),r.send(null),r}},{key:"request",value:function(e,t,n,r,i,o,a){var s=new XMLHttpRequest;if(s.overrideMimeType("text/plain"),s.open(t,e,!0),null!=n)for(var u in n)s.setRequestHeader(u,n[u]);return void 0!==i&&(s.onload=function(e){i(function(e){try{return JSON.parse(e)}catch(t){return e}}(s.response),s)}),void 0!==o&&(s.onerror=o),void 0!==a&&(s.onprogress=a),void 0!==r?s.send(r):s.send(null),s}}]),e}(),F=function(e){u(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.AERIAL;return l(this,n),(e=t.call(this)).maxZoom=19,e.format="jpeg",e.mapSize=512,e.subdomain="t1",e.apiKey=r,e.type=i,e}return d(n,[{key:"getMetaData",value:function(){var e="http://dev.virtualearth.net/REST/V1/Imagery/Metadata/RoadOnDemand?output=json&include=ImageryProviders&key="+this.apiKey;B.get(e,(function(e){JSON.parse(e)}))}},{key:"fetchTile",value:function(e,t,r){var i=this;return new Promise((function(o,a){var s=document.createElement("img");s.onload=function(){o(s)},s.onerror=function(){a()},s.crossOrigin="Anonymous",s.src="http://ecn."+i.subdomain+".tiles.virtualearth.net/tiles/"+i.type+n.quadKey(e,t,r)+".jpeg?g=1173"}))}}],[{key:"quadKey",value:function(e,t,n){for(var r="",i=e;i>0;i--){var o=1<<i-1,a=0;0!=(t&o)&&a++,0!=(n&o)&&(a+=2),r+=a}return r}}]),n}(n);F.AERIAL="a",F.ROAD="r",F.AERIAL_LABELS="h",F.OBLIQUE="o",F.OBLIQUE_LABELS="b";var j=function(e){u(n,e);var t=c(n);function n(e){var r;return l(this,n),(r=t.call(this)).sessionToken=null,r.orientation=0,r.format="png",r.mapType="roadmap",r.overlay=!1,r.apiToken=void 0!==e?e:"",r.createSession(),r}return d(n,[{key:"createSession",value:function(){var e=this,t="https://www.googleapis.com/tile/v1/createSession?key="+this.apiToken,n=JSON.stringify({mapType:this.mapType,language:"en-EN",region:"en",layerTypes:["layerRoadmap","layerStreetview"],overlay:this.overlay,scale:"scaleFactor1x"});B.request(t,"GET",{"Content-Type":"text/json"},n,(function(t,n){console.log("Created google maps session.",t,n),e.sessionToken=t.session}),(function(e){console.warn("Unable to create a google maps session.",e)}))}},{key:"fetchTile",value:function(e,t,n){var r=this;return new Promise((function(i,o){var a=document.createElement("img");a.onload=function(){i(a)},a.onerror=function(){o()},a.crossOrigin="Anonymous",a.src="https://www.googleapis.com/tile/v1/tiles/"+e+"/"+t+"/"+n+"?session="+r.sessionToken+"&orientation="+r.orientation+"&key="+r.apiToken}))}}]),n}(n),z=function(e){u(n,e);var t=c(n);function n(e,r,i,o,a,s){var u;return l(this,n),(u=t.call(this)).appId=void 0!==e?e:"",u.appCode=void 0!==r?r:"",u.style=void 0!==i?i:"base",u.scheme=void 0!==o?o:"normal.day",u.format=void 0!==a?a:"png",u.size=void 0!==s?s:512,u.version="newest",u.server=1,u}return d(n,[{key:"nextServer",value:function(){this.server=this.server%4==0?1:this.server+1}},{key:"getMetaData",value:function(){}},{key:"fetchTile",value:function(e,t,n){var r=this;return this.nextServer(),new Promise((function(i,o){var a=document.createElement("img");a.onload=function(){i(a)},a.onerror=function(){o()},a.crossOrigin="Anonymous",a.src="https://"+r.server+"."+r.style+".maps.api.here.com/maptile/2.1/maptile/"+r.version+"/"+r.scheme+"/"+e+"/"+t+"/"+n+"/"+r.size+"/"+r.format+"?app_id="+r.appId+"&app_code="+r.appCode}))}}]),n}(n);z.PATH="/maptile/2.1/";var U=function(e){u(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.STYLE,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"png",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"v4";return l(this,n),(e=t.call(this)).apiToken=r,e.format=a,e.useHDPI=s,e.mode=o,e.mapId=i,e.style=i,e.version=u,e}return d(n,[{key:"getMetaData",value:function(){var e=this,t=n.ADDRESS+this.version+"/"+this.mapId+".json?access_token="+this.apiToken;B.get(t,(function(t){var n=JSON.parse(t);e.name=n.name,e.minZoom=n.minZoom,e.maxZoom=n.maxZoom,e.bounds=n.bounds,e.center=n.center}))}},{key:"fetchTile",value:function(e,t,r){var i=this;return new Promise((function(o,a){var s=document.createElement("img");s.onload=function(){o(s)},s.onerror=function(){a()},s.crossOrigin="Anonymous",i.mode===n.STYLE?s.src=n.ADDRESS+"styles/v1/"+i.style+"/tiles/"+e+"/"+t+"/"+r+(i.useHDPI?"@2x?access_token=":"?access_token=")+i.apiToken:s.src=n.ADDRESS+"v4/"+i.mapId+"/"+e+"/"+t+"/"+r+(i.useHDPI?"@2x.":".")+i.format+"?access_token="+i.apiToken}))}}]),n}(n);U.ADDRESS="https://api.mapbox.com/",U.STYLE=100,U.MAP_ID=101;var G=function(e){u(n,e);var t=c(n);function n(e,r,i,o){var a;return l(this,n),(a=t.call(this)).apiKey=void 0!==e?e:"",a.format=void 0!==o?o:"png",a.category=void 0!==r?r:"maps",a.style=void 0!==i?i:"satellite",a.resolution=512,a}return d(n,[{key:"fetchTile",value:function(e,t,n){var r=this;return new Promise((function(i,o){var a=document.createElement("img");a.onload=function(){i(a)},a.onerror=function(){o()},a.crossOrigin="Anonymous",a.src="https://api.maptiler.com/"+r.category+"/"+r.style+"/"+e+"/"+t+"/"+n+"."+r.format+"?key="+r.apiKey}))}}]),n}(n),V=function(e){u(n,e);var t=c(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"klokantech-basic";return l(this,n),(r=t.call(this)).address=e,r.format=i,r.theme=o,r}return d(n,[{key:"getMetaData",value:function(){var e=this,t=this.address+"styles/"+this.theme+".json";B.get(t,(function(t){var n=JSON.parse(t);e.name=n.name,e.format=n.format,e.minZoom=n.minZoom,e.maxZoom=n.maxZoom,e.bounds=n.bounds,e.center=n.center}))}},{key:"fetchTile",value:function(e,t,n){var r=this;return new Promise((function(i,o){var a=document.createElement("img");a.onload=function(){i(a)},a.onerror=function(){o()},a.crossOrigin="Anonymous",a.src=r.address+"styles/"+r.theme+"/"+e+"/"+t+"/"+n+"."+r.format}))}}]),n}(n),W=function(e){u(r,e);var n=c(r);function r(){var e;return l(this,r),(e=n.apply(this,arguments)).resolution=256,e}return d(r,[{key:"fetchTile",value:function(e,n,r){var i=h.createOffscreenCanvas(this.resolution,this.resolution),o=i.getContext("2d"),a=new t.Color(65280),s=new t.Color(16711680),u=a.lerpHSL(s,(e-this.minZoom)/(this.maxZoom-this.minZoom));return o.fillStyle=u.getStyle(),o.fillRect(0,0,this.resolution,this.resolution),o.fillStyle="#000000",o.textAlign="center",o.textBaseline="middle",o.font="bold "+.1*this.resolution+"px arial",o.fillText("("+e+")",this.resolution/2,.4*this.resolution),o.fillText("("+n+", "+r+")",this.resolution/2,.6*this.resolution),Promise.resolve(i)}}]),r}(n),H=function(e){u(r,e);var n=c(r);function r(e){var i;return l(this,r),(i=n.call(this)).fromColor=new t.Color(16711680),i.toColor=new t.Color(65280),i.provider=e,i}return d(r,[{key:"fetchTile",value:function(e,t,n){var r=this;return new Promise((function(i,o){r.provider.fetchTile(e,t,n).then((function(e){var t=256,n=h.createOffscreenCanvas(t,t),o=n.getContext("2d");o.drawImage(e,0,0,t,t,0,0,t,t);for(var a=o.getImageData(0,0,t,t),s=a.data,u=0;u<s.length;u+=4){var c=.1*(65536*s[u]+256*s[u+1]+s[u+2])-1e4,l=r.fromColor.clone().lerpHSL(r.toColor,c/1667721.6);s[u]=255*l.r,s[u+1]=255*l.g,s[u+2]=255*l.b}o.putImageData(a,0,0),i(n)})).catch(o)}))}}]),r}(n),Z=function(){function e(t){var n=this;l(this,e),this.fulfilled=!1,this.rejected=!1,this.called=!1;var r=function(e){n.rejected=!0,n.value=e,"function"==typeof n.onReject&&(n.onReject(n.value),n.called=!0)};try{t((function(e){n.fulfilled=!0,n.value=e,"function"==typeof n.onResolve&&(n.onResolve(n.value),n.called=!0)}),r)}catch(e){r(e)}}return d(e,[{key:"cancel",value:function(){return!1}},{key:"then",value:function(e){return this.onResolve=e,this.fulfilled&&!this.called&&(this.called=!0,this.onResolve(this.value)),this}},{key:"catch",value:function(e){return this.onReject=e,this.rejected&&!this.called&&(this.called=!0,this.onReject(this.value)),this}},{key:"finally",value:function(e){return this}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"all",value:function(t){var n=[],r=[];return new e((function(e,i){t.forEach((function(o,a){return o.then((function(i){if(n.push(!0),r[a]=i,n.length===t.length)return e(r)})).catch((function(e){return i(e)}))}))}))}}]),e}();e.BingMapsProvider=F,e.CancelablePromise=Z,e.DebugProvider=W,e.GoogleMapsProvider=j,e.HeightDebugProvider=H,e.HereMapsProvider=z,e.LODFrustum=L,e.LODRadial=O,e.LODRaycast=M,e.MapBoxProvider=U,e.MapHeightNode=b,e.MapHeightNodeShader=w,e.MapNode=v,e.MapNodeGeometry=p,e.MapNodeHeightGeometry=g,e.MapPlaneNode=y,e.MapProvider=n,e.MapSphereNode=_,e.MapSphereNodeGeometry=x,e.MapTilerProvider=G,e.MapView=A,e.OpenMapTilesProvider=V,e.OpenStreetMapsProvider=f,e.UnitsUtils=m,e.XHRUtils=B,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(70497))},70497:function(e,t,n){"use strict";n.r(t),n.d(t,{ACESFilmicToneMapping:function(){return ge},AddEquation:function(){return U},AddOperation:function(){return pe},AdditiveAnimationBlendMode:function(){return cn},AdditiveBlending:function(){return B},AlphaFormat:function(){return Qe},AlwaysDepth:function(){return ie},AlwaysStencilFunc:function(){return zn},AmbientLight:function(){return wf},AmbientLightProbe:function(){return jf},AnimationClip:function(){return Zd},AnimationLoader:function(){return ef},AnimationMixer:function(){return yp},AnimationObjectGroup:function(){return vp},AnimationUtils:function(){return Rd},ArcCurve:function(){return pl},ArrayCamera:function(){return Lu},ArrowHelper:function(){return sh},Audio:function(){return Kf},AudioAnalyser:function(){return np},AudioContext:function(){return Lf},AudioListener:function(){return Xf},AudioLoader:function(){return Bf},AxesHelper:function(){return uh},AxisHelper:function(){return Bh},BackSide:function(){return O},BasicDepthPacking:function(){return _n},BasicShadowMap:function(){return E},BinaryTextureLoader:function(){return Gh},Bone:function(){return wc},BooleanKeyframeTrack:function(){return jd},BoundingBoxHelper:function(){return Fh},Box2:function(){return kp},Box3:function(){return Ir},Box3Helper:function(){return ih},BoxBufferGeometry:function(){return zo},BoxGeometry:function(){return zo},BoxHelper:function(){return rh},BufferAttribute:function(){return to},BufferGeometry:function(){return xo},BufferGeometryLoader:function(){return Cf},ByteType:function(){return Ue},Cache:function(){return Yd},Camera:function(){return Ho},CameraHelper:function(){return Qp},CanvasRenderer:function(){return Wh},CanvasTexture:function(){return $c},CatmullRomCurve3:function(){return bl},CineonToneMapping:function(){return ye},CircleBufferGeometry:function(){return tl},CircleGeometry:function(){return tl},ClampToEdgeWrapping:function(){return Ae},Clock:function(){return Vf},Color:function(){return Ji},ColorKeyframeTrack:function(){return zd},CompressedTexture:function(){return Qc},CompressedTextureLoader:function(){return tf},ConeBufferGeometry:function(){return rl},ConeGeometry:function(){return rl},CubeCamera:function(){return Yo},CubeReflectionMapping:function(){return _e},CubeRefractionMapping:function(){return we},CubeTexture:function(){return Xo},CubeTextureLoader:function(){return rf},CubeUVReflectionMapping:function(){return Te},CubeUVRefractionMapping:function(){return Ee},CubicBezierCurve:function(){return Ml},CubicBezierCurve3:function(){return Sl},CubicInterpolant:function(){return Dd},CullFaceBack:function(){return M},CullFaceFront:function(){return S},CullFaceFrontBack:function(){return T},CullFaceNone:function(){return w},Curve:function(){return dl},CurvePath:function(){return Ol},CustomBlending:function(){return z},CustomToneMapping:function(){return be},CylinderBufferGeometry:function(){return nl},CylinderGeometry:function(){return nl},Cylindrical:function(){return Tp},DataTexture:function(){return Mc},DataTexture2DArray:function(){return Wa},DataTexture3D:function(){return Ka},DataTextureLoader:function(){return of},DataUtils:function(){return fh},DecrementStencilOp:function(){return Pn},DecrementWrapStencilOp:function(){return On},DefaultLoadingManager:function(){return Kd},DepthFormat:function(){return it},DepthStencilFormat:function(){return ot},DepthTexture:function(){return el},DirectionalLight:function(){return _f},DirectionalLightHelper:function(){return Xp},DiscreteInterpolant:function(){return Bd},DodecahedronBufferGeometry:function(){return ol},DodecahedronGeometry:function(){return ol},DoubleSide:function(){return I},DstAlphaFactor:function(){return Q},DstColorFactor:function(){return ee},DynamicBufferAttribute:function(){return kh},DynamicCopyUsage:function(){return Yn},DynamicDrawUsage:function(){return Gn},DynamicReadUsage:function(){return Hn},EdgesGeometry:function(){return ll},EdgesHelper:function(){return jh},EllipseCurve:function(){return fl},EqualDepth:function(){return se},EqualStencilFunc:function(){return Dn},EquirectangularReflectionMapping:function(){return Me},EquirectangularRefractionMapping:function(){return Se},Euler:function(){return mi},EventDispatcher:function(){return Qn},ExtrudeBufferGeometry:function(){return ud},ExtrudeGeometry:function(){return ud},FaceColors:function(){return mh},FileLoader:function(){return $d},FlatShading:function(){return R},Float16BufferAttribute:function(){return co},Float32Attribute:function(){return Dh},Float32BufferAttribute:function(){return lo},Float64Attribute:function(){return Lh},Float64BufferAttribute:function(){return fo},FloatType:function(){return Ze},Fog:function(){return Zu},FogExp2:function(){return Hu},Font:function(){return Jh},FontLoader:function(){return Kh},FrontSide:function(){return C},Frustum:function(){return ra},GLBufferAttribute:function(){return xp},GLSL1:function(){return Kn},GLSL3:function(){return Jn},GammaEncoding:function(){return vn},GreaterDepth:function(){return ce},GreaterEqualDepth:function(){return ue},GreaterEqualStencilFunc:function(){return jn},GreaterStencilFunc:function(){return Bn},GridHelper:function(){return Wp},Group:function(){return Bu},HalfFloatType:function(){return qe},HemisphereLight:function(){return uf},HemisphereLightHelper:function(){return Vp},HemisphereLightProbe:function(){return Ff},IcosahedronBufferGeometry:function(){return ld},IcosahedronGeometry:function(){return ld},ImageBitmapLoader:function(){return Df},ImageLoader:function(){return nf},ImageUtils:function(){return xr},ImmediateRenderObject:function(){return Op},IncrementStencilOp:function(){return An},IncrementWrapStencilOp:function(){return Cn},InstancedBufferAttribute:function(){return kc},InstancedBufferGeometry:function(){return Af},InstancedInterleavedBuffer:function(){return bp},InstancedMesh:function(){return Ic},Int16Attribute:function(){return Oh},Int16BufferAttribute:function(){return oo},Int32Attribute:function(){return Rh},Int32BufferAttribute:function(){return so},Int8Attribute:function(){return Ah},Int8BufferAttribute:function(){return no},IntType:function(){return We},InterleavedBuffer:function(){return Yu},InterleavedBufferAttribute:function(){return Ku},Interpolant:function(){return Nd},InterpolateDiscrete:function(){return tn},InterpolateLinear:function(){return nn},InterpolateSmooth:function(){return rn},InvertStencilOp:function(){return In},JSONLoader:function(){return Hh},KeepStencilOp:function(){return En},KeyframeTrack:function(){return Fd},LOD:function(){return vc},LatheBufferGeometry:function(){return dd},LatheGeometry:function(){return dd},Layers:function(){return yi},LensFlare:function(){return qh},LessDepth:function(){return oe},LessEqualDepth:function(){return ae},LessEqualStencilFunc:function(){return Ln},LessStencilFunc:function(){return Nn},Light:function(){return sf},LightProbe:function(){return Tf},Line:function(){return jc},Line3:function(){return Cp},LineBasicMaterial:function(){return Rc},LineCurve:function(){return Tl},LineCurve3:function(){return El},LineDashedMaterial:function(){return Od},LineLoop:function(){return Vc},LinePieces:function(){return hh},LineSegments:function(){return Gc},LineStrip:function(){return ph},LinearEncoding:function(){return pn},LinearFilter:function(){return De},LinearInterpolant:function(){return Ld},LinearMipMapLinearFilter:function(){return je},LinearMipMapNearestFilter:function(){return Be},LinearMipmapLinearFilter:function(){return Fe},LinearMipmapNearestFilter:function(){return Le},LinearToneMapping:function(){return ve},Loader:function(){return Jd},LoaderUtils:function(){return kf},LoadingManager:function(){return Xd},LogLuvEncoding:function(){return yn},LoopOnce:function(){return Qt},LoopPingPong:function(){return en},LoopRepeat:function(){return $t},LuminanceAlphaFormat:function(){return nt},LuminanceFormat:function(){return tt},MOUSE:function(){return x},Material:function(){return Wi},MaterialLoader:function(){return Ef},Math:function(){return fr},MathUtils:function(){return fr},Matrix3:function(){return hr},Matrix4:function(){return ai},MaxEquation:function(){return H},Mesh:function(){return Fo},MeshBasicMaterial:function(){return Qi},MeshDepthMaterial:function(){return Cu},MeshDistanceMaterial:function(){return Ou},MeshFaceMaterial:function(){return gh},MeshLambertMaterial:function(){return Pd},MeshMatcapMaterial:function(){return Cd},MeshNormalMaterial:function(){return Ad},MeshPhongMaterial:function(){return Ed},MeshPhysicalMaterial:function(){return Td},MeshStandardMaterial:function(){return Sd},MeshToonMaterial:function(){return kd},MinEquation:function(){return W},MirroredRepeatWrapping:function(){return Pe},MixOperation:function(){return fe},MultiMaterial:function(){return bh},MultiplyBlending:function(){return j},MultiplyOperation:function(){return de},NearestFilter:function(){return Ce},NearestMipMapLinearFilter:function(){return Ne},NearestMipMapNearestFilter:function(){return Ie},NearestMipmapLinearFilter:function(){return Re},NearestMipmapNearestFilter:function(){return Oe},NeverDepth:function(){return re},NeverStencilFunc:function(){return Rn},NoBlending:function(){return D},NoColors:function(){return vh},NoToneMapping:function(){return he},NormalAnimationBlendMode:function(){return un},NormalBlending:function(){return L},NotEqualDepth:function(){return le},NotEqualStencilFunc:function(){return Fn},NumberKeyframeTrack:function(){return Ud},Object3D:function(){return Oi},ObjectLoader:function(){return Of},ObjectSpaceNormalMap:function(){return Sn},OctahedronBufferGeometry:function(){return fd},OctahedronGeometry:function(){return fd},OneFactor:function(){return q},OneMinusDstAlphaFactor:function(){return $},OneMinusDstColorFactor:function(){return te},OneMinusSrcAlphaFactor:function(){return J},OneMinusSrcColorFactor:function(){return X},OrthographicCamera:function(){return ma},PCFShadowMap:function(){return k},PCFSoftShadowMap:function(){return A},PMREMGenerator:function(){return Ia},ParametricGeometry:function(){return Yh},Particle:function(){return _h},ParticleBasicMaterial:function(){return Sh},ParticleSystem:function(){return wh},ParticleSystemMaterial:function(){return Th},Path:function(){return Il},PerspectiveCamera:function(){return Zo},Plane:function(){return ea},PlaneBufferGeometry:function(){return aa},PlaneGeometry:function(){return aa},PlaneHelper:function(){return oh},PointCloud:function(){return xh},PointCloudMaterial:function(){return Mh},PointLight:function(){return bf},PointLightHelper:function(){return jp},Points:function(){return Xc},PointsMaterial:function(){return Wc},PolarGridHelper:function(){return Hp},PolyhedronBufferGeometry:function(){return il},PolyhedronGeometry:function(){return il},PositionalAudio:function(){return tp},PropertyBinding:function(){return hp},PropertyMixer:function(){return rp},QuadraticBezierCurve:function(){return kl},QuadraticBezierCurve3:function(){return Al},Quaternion:function(){return Ar},QuaternionKeyframeTrack:function(){return Vd},QuaternionLinearInterpolant:function(){return Gd},REVISION:function(){return b},RGBADepthPacking:function(){return wn},RGBAFormat:function(){return et},RGBAIntegerFormat:function(){return dt},RGBA_ASTC_10x10_Format:function(){return Nt},RGBA_ASTC_10x5_Format:function(){return Ot},RGBA_ASTC_10x6_Format:function(){return It},RGBA_ASTC_10x8_Format:function(){return Rt},RGBA_ASTC_12x10_Format:function(){return Dt},RGBA_ASTC_12x12_Format:function(){return Lt},RGBA_ASTC_4x4_Format:function(){return Mt},RGBA_ASTC_5x4_Format:function(){return St},RGBA_ASTC_5x5_Format:function(){return Tt},RGBA_ASTC_6x5_Format:function(){return Et},RGBA_ASTC_6x6_Format:function(){return kt},RGBA_ASTC_8x5_Format:function(){return At},RGBA_ASTC_8x6_Format:function(){return Pt},RGBA_ASTC_8x8_Format:function(){return Ct},RGBA_BPTC_Format:function(){return Bt},RGBA_ETC2_EAC_Format:function(){return wt},RGBA_PVRTC_2BPPV1_Format:function(){return bt},RGBA_PVRTC_4BPPV1_Format:function(){return gt},RGBA_S3TC_DXT1_Format:function(){return pt},RGBA_S3TC_DXT3_Format:function(){return ht},RGBA_S3TC_DXT5_Format:function(){return vt},RGBDEncoding:function(){return xn},RGBEEncoding:function(){return mn},RGBEFormat:function(){return rt},RGBFormat:function(){return $e},RGBIntegerFormat:function(){return lt},RGBM16Encoding:function(){return bn},RGBM7Encoding:function(){return gn},RGB_ETC1_Format:function(){return xt},RGB_ETC2_Format:function(){return _t},RGB_PVRTC_2BPPV1_Format:function(){return yt},RGB_PVRTC_4BPPV1_Format:function(){return mt},RGB_S3TC_DXT1_Format:function(){return ft},RGFormat:function(){return ut},RGIntegerFormat:function(){return ct},RawShaderMaterial:function(){return ya},Ray:function(){return oi},Raycaster:function(){return _p},RectAreaLight:function(){return Mf},RedFormat:function(){return at},RedIntegerFormat:function(){return st},ReinhardToneMapping:function(){return me},RepeatWrapping:function(){return ke},ReplaceStencilOp:function(){return kn},ReverseSubtractEquation:function(){return V},RingBufferGeometry:function(){return pd},RingGeometry:function(){return pd},SRGB8_ALPHA8_ASTC_10x10_Format:function(){return Xt},SRGB8_ALPHA8_ASTC_10x5_Format:function(){return Zt},SRGB8_ALPHA8_ASTC_10x6_Format:function(){return qt},SRGB8_ALPHA8_ASTC_10x8_Format:function(){return Yt},SRGB8_ALPHA8_ASTC_12x10_Format:function(){return Kt},SRGB8_ALPHA8_ASTC_12x12_Format:function(){return Jt},SRGB8_ALPHA8_ASTC_4x4_Format:function(){return Ft},SRGB8_ALPHA8_ASTC_5x4_Format:function(){return jt},SRGB8_ALPHA8_ASTC_5x5_Format:function(){return zt},SRGB8_ALPHA8_ASTC_6x5_Format:function(){return Ut},SRGB8_ALPHA8_ASTC_6x6_Format:function(){return Gt},SRGB8_ALPHA8_ASTC_8x5_Format:function(){return Vt},SRGB8_ALPHA8_ASTC_8x6_Format:function(){return Wt},SRGB8_ALPHA8_ASTC_8x8_Format:function(){return Ht},Scene:function(){return qu},SceneUtils:function(){return Zh},ShaderChunk:function(){return sa},ShaderLib:function(){return ca},ShaderMaterial:function(){return Wo},ShadowMaterial:function(){return Md},Shape:function(){return Rl},ShapeBufferGeometry:function(){return hd},ShapeGeometry:function(){return hd},ShapePath:function(){return ch},ShapeUtils:function(){return od},ShortType:function(){return Ge},Skeleton:function(){return Ec},SkeletonHelper:function(){return Bp},SkinnedMesh:function(){return _c},SmoothShading:function(){return N},Sphere:function(){return Jr},SphereBufferGeometry:function(){return vd},SphereGeometry:function(){return vd},Spherical:function(){return Sp},SphericalHarmonics3:function(){return Sf},SplineCurve:function(){return Pl},SpotLight:function(){return hf},SpotLightHelper:function(){return Rp},Sprite:function(){return dc},SpriteMaterial:function(){return Qu},SrcAlphaFactor:function(){return K},SrcAlphaSaturateFactor:function(){return ne},SrcColorFactor:function(){return Y},StaticCopyUsage:function(){return qn},StaticDrawUsage:function(){return Un},StaticReadUsage:function(){return Wn},StereoCamera:function(){return Gf},StreamCopyUsage:function(){return Xn},StreamDrawUsage:function(){return Vn},StreamReadUsage:function(){return Zn},StringKeyframeTrack:function(){return Wd},SubtractEquation:function(){return G},SubtractiveBlending:function(){return F},TOUCH:function(){return _},TangentSpaceNormalMap:function(){return Mn},TetrahedronBufferGeometry:function(){return md},TetrahedronGeometry:function(){return md},TextGeometry:function(){return Xh},Texture:function(){return wr},TextureLoader:function(){return af},TorusBufferGeometry:function(){return yd},TorusGeometry:function(){return yd},TorusKnotBufferGeometry:function(){return gd},TorusKnotGeometry:function(){return gd},Triangle:function(){return Gi},TriangleFanDrawMode:function(){return fn},TriangleStripDrawMode:function(){return dn},TrianglesDrawMode:function(){return ln},TubeBufferGeometry:function(){return bd},TubeGeometry:function(){return bd},UVMapping:function(){return xe},Uint16Attribute:function(){return Ih},Uint16BufferAttribute:function(){return ao},Uint32Attribute:function(){return Nh},Uint32BufferAttribute:function(){return uo},Uint8Attribute:function(){return Ph},Uint8BufferAttribute:function(){return ro},Uint8ClampedAttribute:function(){return Ch},Uint8ClampedBufferAttribute:function(){return io},Uniform:function(){return gp},UniformsLib:function(){return ua},UniformsUtils:function(){return Vo},UnsignedByteType:function(){return ze},UnsignedInt248Type:function(){return Je},UnsignedIntType:function(){return He},UnsignedShort4444Type:function(){return Ye},UnsignedShort5551Type:function(){return Xe},UnsignedShort565Type:function(){return Ke},UnsignedShortType:function(){return Ve},VSMShadowMap:function(){return P},Vector2:function(){return pr},Vector3:function(){return Pr},Vector4:function(){return Sr},VectorKeyframeTrack:function(){return Hd},Vertex:function(){return Eh},VertexColors:function(){return yh},VideoTexture:function(){return Jc},WebGL1Renderer:function(){return Wu},WebGLCubeRenderTarget:function(){return Ko},WebGLMultipleRenderTargets:function(){return Er},WebGLMultisampleRenderTarget:function(){return kr},WebGLRenderTarget:function(){return Tr},WebGLRenderTargetCube:function(){return Vh},WebGLRenderer:function(){return Vu},WebGLUtils:function(){return Du},WireframeGeometry:function(){return xd},WireframeHelper:function(){return zh},WrapAroundEnding:function(){return sn},XHRLoader:function(){return Uh},ZeroCurvatureEnding:function(){return on},ZeroFactor:function(){return Z},ZeroSlopeEnding:function(){return an},ZeroStencilOp:function(){return Tn},sRGBEncoding:function(){return hn}});for(var r,i=n(15861),o=n(37762),a=n(4942),s=n(29439),u=n(82963),c=n(11752),l=n(61120),d=n(1413),f=n(97326),p=n(60136),h=n(29388),v=n(15671),m=n(43144),y=n(87757),g=n.n(y),b="133",x={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},_={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},w=0,M=1,S=2,T=3,E=0,k=1,A=2,P=3,C=0,O=1,I=2,R=1,N=2,D=0,L=1,B=2,F=3,j=4,z=5,U=100,G=101,V=102,W=103,H=104,Z=200,q=201,Y=202,X=203,K=204,J=205,Q=206,$=207,ee=208,te=209,ne=210,re=0,ie=1,oe=2,ae=3,se=4,ue=5,ce=6,le=7,de=0,fe=1,pe=2,he=0,ve=1,me=2,ye=3,ge=4,be=5,xe=300,_e=301,we=302,Me=303,Se=304,Te=306,Ee=307,ke=1e3,Ae=1001,Pe=1002,Ce=1003,Oe=1004,Ie=1004,Re=1005,Ne=1005,De=1006,Le=1007,Be=1007,Fe=1008,je=1008,ze=1009,Ue=1010,Ge=1011,Ve=1012,We=1013,He=1014,Ze=1015,qe=1016,Ye=1017,Xe=1018,Ke=1019,Je=1020,Qe=1021,$e=1022,et=1023,tt=1024,nt=1025,rt=et,it=1026,ot=1027,at=1028,st=1029,ut=1030,ct=1031,lt=1032,dt=1033,ft=33776,pt=33777,ht=33778,vt=33779,mt=35840,yt=35841,gt=35842,bt=35843,xt=36196,_t=37492,wt=37496,Mt=37808,St=37809,Tt=37810,Et=37811,kt=37812,At=37813,Pt=37814,Ct=37815,Ot=37816,It=37817,Rt=37818,Nt=37819,Dt=37820,Lt=37821,Bt=36492,Ft=37840,jt=37841,zt=37842,Ut=37843,Gt=37844,Vt=37845,Wt=37846,Ht=37847,Zt=37848,qt=37849,Yt=37850,Xt=37851,Kt=37852,Jt=37853,Qt=2200,$t=2201,en=2202,tn=2300,nn=2301,rn=2302,on=2400,an=2401,sn=2402,un=2500,cn=2501,ln=0,dn=1,fn=2,pn=3e3,hn=3001,vn=3007,mn=3002,yn=3003,gn=3004,bn=3005,xn=3006,_n=3200,wn=3201,Mn=0,Sn=1,Tn=0,En=7680,kn=7681,An=7682,Pn=7683,Cn=34055,On=34056,In=5386,Rn=512,Nn=513,Dn=514,Ln=515,Bn=516,Fn=517,jn=518,zn=519,Un=35044,Gn=35048,Vn=35040,Wn=35045,Hn=35049,Zn=35041,qn=35046,Yn=35050,Xn=35042,Kn="100",Jn="300 es",Qn=function(){function e(){(0,v.Z)(this,e)}return(0,m.Z)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),$n=1234567,er=Math.PI/180,tr=180/Math.PI,nr=[],rr=0;rr<256;rr++)nr[rr]=(rr<16?"0":"")+rr.toString(16);var ir="undefined"!=typeof crypto&&"randomUUID"in crypto;function or(){if(ir)return crypto.randomUUID().toUpperCase();var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(nr[255&e]+nr[e>>8&255]+nr[e>>16&255]+nr[e>>24&255]+"-"+nr[255&t]+nr[t>>8&255]+"-"+nr[t>>16&15|64]+nr[t>>24&255]+"-"+nr[63&n|128]+nr[n>>8&255]+"-"+nr[n>>16&255]+nr[n>>24&255]+nr[255&r]+nr[r>>8&255]+nr[r>>16&255]+nr[r>>24&255]).toUpperCase()}function ar(e,t,n){return Math.max(t,Math.min(n,e))}function sr(e,t){return(e%t+t)%t}function ur(e,t,n){return(1-n)*e+n*t}function cr(e){return 0==(e&e-1)&&0!==e}function lr(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function dr(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var fr=Object.freeze({__proto__:null,DEG2RAD:er,RAD2DEG:tr,generateUUID:or,clamp:ar,euclideanModulo:sr,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:ur,damp:function(e,t,n,r){return ur(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(sr(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&($n=e%2147483647),(($n=16807*$n%2147483647)-1)/2147483646},degToRad:function(e){return e*er},radToDeg:function(e){return e*tr},isPowerOfTwo:cr,ceilPowerOfTwo:lr,floorPowerOfTwo:dr,setQuaternionFromProperEuler:function(e,t,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),c=o((t+r)/2),l=a((t+r)/2),d=o((t-r)/2),f=a((t-r)/2),p=o((r-t)/2),h=a((r-t)/2);switch(i){case"XYX":e.set(s*l,u*d,u*f,s*c);break;case"YZY":e.set(u*f,s*l,u*d,s*c);break;case"ZXZ":e.set(u*d,u*f,s*l,s*c);break;case"XZX":e.set(s*l,u*h,u*p,s*c);break;case"YXY":e.set(u*p,s*l,u*h,s*c);break;case"ZYZ":e.set(u*h,u*p,s*l,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}}),pr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.Z)(this,t),this.x=e,this.y=n}return(0,m.Z)(t,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){return Math.atan2(-this.y,-this.x)+Math.PI}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:e,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);pr.prototype.isVector2=!0;var hr=function(){function e(){(0,v.Z)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return(0,m.Z)(e,[{key:"set",value:function(e,t,n,r,i,o,a,s,u){var c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],d=n[2],f=n[5],p=n[8],h=r[0],v=r[3],m=r[6],y=r[1],g=r[4],b=r[7],x=r[2],_=r[5],w=r[8];return i[0]=o*h+a*y+s*x,i[3]=o*v+a*g+s*_,i[6]=o*m+a*b+s*w,i[1]=u*h+c*y+l*x,i[4]=u*v+c*g+l*_,i[7]=u*m+c*b+l*w,i[2]=d*h+f*y+p*x,i[5]=d*v+f*g+p*_,i[8]=d*m+f*b+p*w,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-n*i*c+n*a*s+r*i*u-r*o*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=c*o-a*u,d=a*s-c*i,f=u*i-o*s,p=t*l+n*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);var h=1/p;return e[0]=l*h,e[1]=(r*u-c*n)*h,e[2]=(a*n-r*o)*h,e[3]=d*h,e[4]=(c*t-r*s)*h,e[5]=(r*i-a*t)*h,e[6]=f*h,e[7]=(n*s-u*t)*h,e[8]=(o*t-n*i)*h,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*o+u*a)+o+e,-r*u,r*s,-r*(-u*o+s*a)+a+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],c=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*u,r[6]=t*a+n*c,r[1]=-n*i+t*s,r[4]=-n*o+t*u,r[7]=-n*a+t*c,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();function vr(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}hr.prototype.isMatrix3=!0;var mr,yr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function gr(e,t){return new yr[e](t)}function br(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}var xr=function(){function e(){(0,v.Z)(this,e)}return(0,m.Z)(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===mr&&(mr=br("canvas")),mr.width=e.width,mr.height=e.height;var n=mr.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=mr}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}]),e}(),_r=0,wr=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ae,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ae,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:De,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Fe,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:et,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:ze,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:pn;return(0,v.Z)(this,n),e=t.call(this),Object.defineProperty((0,f.Z)(e),"id",{value:_r++}),e.uuid=or(),e.name="",e.image=r,e.mipmaps=[],e.mapping=i,e.wrapS=o,e.wrapT=a,e.magFilter=s,e.minFilter=u,e.anisotropy=d,e.format=c,e.internalFormat=null,e.type=l,e.offset=new pr(0,0),e.repeat=new pr(1,1),e.center=new pr(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new hr,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=p,e.version=0,e.onUpdate=null,e.isRenderTargetTexture=!1,e}return(0,m.Z)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=or()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)r[o].isDataTexture?i.push(Mr(r[o].image)):i.push(Mr(r[o]))}else i=Mr(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==xe)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ke:e.x=e.x-Math.floor(e.x);break;case Ae:e.x=e.x<0?0:1;break;case Pe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ke:e.y=e.y-Math.floor(e.y);break;case Ae:e.y=e.y<0?0:1;break;case Pe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(Qn);function Mr(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?xr.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}wr.DEFAULT_IMAGE=void 0,wr.DEFAULT_MAPPING=xe,wr.prototype.isTexture=!0;var Sr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,v.Z)(this,t),this.x=e,this.y=n,this.z=r,this.w=i}return(0,m.Z)(t,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,o=.01,a=.1,s=e.elements,u=s[0],c=s[4],l=s[8],d=s[1],f=s[5],p=s[9],h=s[2],v=s[6],m=s[10];if(Math.abs(c-d)<o&&Math.abs(l-h)<o&&Math.abs(p-v)<o){if(Math.abs(c+d)<a&&Math.abs(l+h)<a&&Math.abs(p+v)<a&&Math.abs(u+f+m-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var y=(u+1)/2,g=(f+1)/2,b=(m+1)/2,x=(c+d)/4,_=(l+h)/4,w=(p+v)/4;return y>g&&y>b?y<o?(n=0,r=.707106781,i=.707106781):(r=x/(n=Math.sqrt(y)),i=_/n):g>b?g<o?(n=.707106781,r=0,i=.707106781):(n=x/(r=Math.sqrt(g)),i=w/r):b<o?(n=.707106781,r=.707106781,i=0):(n=_/(i=Math.sqrt(b)),r=w/i),this.set(n,r,i,t),this}var M=Math.sqrt((v-p)*(v-p)+(l-h)*(l-h)+(d-c)*(d-c));return Math.abs(M)<.001&&(M=1),this.x=(v-p)/M,this.y=(l-h)/M,this.z=(d-c)/M,this.w=Math.acos((u+f+m-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:e,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);Sr.prototype.isVector4=!0;var Tr=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,v.Z)(this,n),(i=t.call(this)).width=e,i.height=r,i.depth=1,i.scissor=new Sr(0,0,e,r),i.scissorTest=!1,i.viewport=new Sr(0,0,e,r),i.texture=new wr(void 0,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),i.texture.isRenderTargetTexture=!0,i.texture.image={width:e,height:r,depth:1},i.texture.generateMipmaps=void 0!==o.generateMipmaps&&o.generateMipmaps,i.texture.internalFormat=void 0!==o.internalFormat?o.internalFormat:null,i.texture.minFilter=void 0!==o.minFilter?o.minFilter:De,i.depthBuffer=void 0===o.depthBuffer||o.depthBuffer,i.stencilBuffer=void 0!==o.stencilBuffer&&o.stencilBuffer,i.depthTexture=void 0!==o.depthTexture?o.depthTexture:null,i}return(0,m.Z)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=(0,d.Z)({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Qn);Tr.prototype.isWebGLRenderTarget=!0;var Er=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;(0,v.Z)(this,n);var a=(o=t.call(this,e,r)).texture;o.texture=[];for(var s=0;s<i;s++)o.texture[s]=a.clone();return o}return(0,m.Z)(n,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(var r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}},{key:"copy",value:function(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(var t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}]),n}(Tr);Er.prototype.isWebGLMultipleRenderTargets=!0;var kr=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this,e,r,i)).samples=4,o}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this}}]),n}(Tr);kr.prototype.isWebGLMultisampleRenderTarget=!0;var Ar=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,v.Z)(this,e),this._x=t,this._y=n,this._z=r,this._w=i}return(0,m.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e._order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),d=s(n/2),f=s(r/2),p=s(i/2);switch(o){case"XYZ":this._x=d*c*l+u*f*p,this._y=u*f*l-d*c*p,this._z=u*c*p+d*f*l,this._w=u*c*l-d*f*p;break;case"YXZ":this._x=d*c*l+u*f*p,this._y=u*f*l-d*c*p,this._z=u*c*p-d*f*l,this._w=u*c*l+d*f*p;break;case"ZXY":this._x=d*c*l-u*f*p,this._y=u*f*l+d*c*p,this._z=u*c*p+d*f*l,this._w=u*c*l-d*f*p;break;case"ZYX":this._x=d*c*l-u*f*p,this._y=u*f*l+d*c*p,this._z=u*c*p-d*f*l,this._w=u*c*l+d*f*p;break;case"YZX":this._x=d*c*l+u*f*p,this._y=u*f*l+d*c*p,this._z=u*c*p-d*f*l,this._w=u*c*l-d*f*p;break;case"XZY":this._x=d*c*l-u*f*p,this._y=u*f*l-d*c*p,this._z=u*c*p+d*f*l,this._w=u*c*l+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],a=t[5],s=t[9],u=t[2],c=t[6],l=t[10],d=n+a+l;if(d>0){var f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(c-s)*f,this._y=(i-u)*f,this._z=(o-r)*f}else if(n>a&&n>l){var p=2*Math.sqrt(1+n-a-l);this._w=(c-s)/p,this._x=.25*p,this._y=(r+o)/p,this._z=(i+u)/p}else if(a>l){var h=2*Math.sqrt(1+a-n-l);this._w=(i-u)/h,this._x=(r+o)/h,this._y=.25*h,this._z=(s+c)/h}else{var v=2*Math.sqrt(1+l-n-a);this._w=(o-r)/v,this._x=(i+u)/v,this._y=(s+c)/v,this._z=.25*v}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(ar(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,u=t._z,c=t._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var u=1-t;return this._w=u*o+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),l=Math.atan2(c,a),d=Math.sin((1-t)*l)/c,f=Math.sin(t*l)/c;return this._w=o*d+this._w*f,this._x=n*d+this._x*f,this._y=r*d+this._y*f,this._z=i*d+this._z*f,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,i,o,a){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],d=i[o+0],f=i[o+1],p=i[o+2],h=i[o+3];if(0===a)return e[t+0]=s,e[t+1]=u,e[t+2]=c,void(e[t+3]=l);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=h);if(l!==h||s!==d||u!==f||c!==p){var v=1-a,m=s*d+u*f+c*p+l*h,y=m>=0?1:-1,g=1-m*m;if(g>Number.EPSILON){var b=Math.sqrt(g),x=Math.atan2(b,m*y);v=Math.sin(v*x)/b,a=Math.sin(a*x)/b}var _=a*y;if(s=s*v+d*_,u=u*v+f*_,c=c*v+p*_,l=l*v+h*_,v===1-a){var w=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=w,u*=w,c*=w,l*=w}}e[t]=s,e[t+1]=u,e[t+2]=c,e[t+3]=l}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,o){var a=n[r],s=n[r+1],u=n[r+2],c=n[r+3],l=i[o],d=i[o+1],f=i[o+2],p=i[o+3];return e[t]=a*p+c*l+s*f-u*d,e[t+1]=s*p+c*d+u*l-a*f,e[t+2]=u*p+c*f+a*d-s*l,e[t+3]=c*p-a*l-s*d-u*f,e}}]),e}();Ar.prototype.isQuaternion=!0;var Pr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,v.Z)(this,t),this.x=e,this.y=n,this.z=r}return(0,m.Z)(t,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Or.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(Or.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,c=s*n+a*t-i*r,l=s*r+i*n-o*t,d=-i*t-o*n-a*r;return this.x=u*s+d*-i+c*-a-l*-o,this.y=c*s+d*-o+l*-i-u*-a,this.z=l*s+d*-a+u*-o-c*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return Cr.copy(this).projectOnVector(e),this.sub(Cr)}},{key:"reflect",value:function(e){return this.sub(Cr.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(ar(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}},{key:e,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);Pr.prototype.isVector3=!0;var Cr=new Pr,Or=new Ar,Ir=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr(-1/0,-1/0,-1/0);(0,v.Z)(this,e),this.min=t,this.max=n}return(0,m.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.length;s<u;s+=3){var c=e[s],l=e[s+1],d=e[s+2];c<t&&(t=c),l<n&&(n=l),d<r&&(r=d),c>i&&(i=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.count;s<u;s++){var c=e.getX(s),l=e.getY(s),d=e.getZ(s);c<t&&(t=c),l<n&&(n=l),d<r&&(r=d),c>i&&(i=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Nr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Dr.copy(t.boundingBox),Dr.applyMatrix4(e.matrixWorld),this.union(Dr));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,Nr),Nr.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(Gr),Vr.subVectors(this.max,Gr),Lr.subVectors(e.a,Gr),Br.subVectors(e.b,Gr),Fr.subVectors(e.c,Gr),jr.subVectors(Br,Lr),zr.subVectors(Fr,Br),Ur.subVectors(Lr,Fr);var t=[0,-jr.z,jr.y,0,-zr.z,zr.y,0,-Ur.z,Ur.y,jr.z,0,-jr.x,zr.z,0,-zr.x,Ur.z,0,-Ur.x,-jr.y,jr.x,0,-zr.y,zr.x,0,-Ur.y,Ur.x,0];return!!Zr(t,Lr,Br,Fr,Vr)&&!!Zr(t=[1,0,0,0,1,0,0,0,1],Lr,Br,Fr,Vr)&&(Wr.crossVectors(jr,zr),Zr(t=[Wr.x,Wr.y,Wr.z],Lr,Br,Fr,Vr))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Nr.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Nr).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(Rr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Rr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Rr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Rr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Rr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Rr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Rr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Rr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Rr)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Ir.prototype.isBox3=!0;var Rr=[new Pr,new Pr,new Pr,new Pr,new Pr,new Pr,new Pr,new Pr],Nr=new Pr,Dr=new Ir,Lr=new Pr,Br=new Pr,Fr=new Pr,jr=new Pr,zr=new Pr,Ur=new Pr,Gr=new Pr,Vr=new Pr,Wr=new Pr,Hr=new Pr;function Zr(e,t,n,r,i){for(var o=0,a=e.length-3;o<=a;o+=3){Hr.fromArray(e,o);var s=i.x*Math.abs(Hr.x)+i.y*Math.abs(Hr.y)+i.z*Math.abs(Hr.z),u=t.dot(Hr),c=n.dot(Hr),l=r.dot(Hr);if(Math.max(-Math.max(u,c,l),Math.min(u,c,l))>s)return!1}return!0}var qr=new Ir,Yr=new Pr,Xr=new Pr,Kr=new Pr,Jr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,v.Z)(this,e),this.center=t,this.radius=n}return(0,m.Z)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):qr.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){Kr.subVectors(e,this.center);var t=Kr.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Kr.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return Xr.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Yr.copy(e.center).add(Xr)),this.expandByPoint(Yr.copy(e.center).sub(Xr)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Qr=new Pr,$r=new Pr,ei=new Pr,ti=new Pr,ni=new Pr,ri=new Pr,ii=new Pr,oi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr(0,0,-1);(0,v.Z)(this,e),this.origin=t,this.direction=n}return(0,m.Z)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,Qr)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=Qr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Qr.copy(this.direction).multiplyScalar(t).add(this.origin),Qr.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){$r.copy(e).add(t).multiplyScalar(.5),ei.copy(t).sub(e).normalize(),ti.copy(this.origin).sub($r);var i,o,a,s,u=.5*e.distanceTo(t),c=-this.direction.dot(ei),l=ti.dot(this.direction),d=-ti.dot(ei),f=ti.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(o=c*l-d,s=u*p,(i=c*d-l)>=0)if(o>=-s)if(o<=s){var h=1/p;a=(i*=h)*(i+c*(o*=h)+2*l)+o*(c*i+o+2*d)+f}else o=u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+f;else o=-u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+f;else o<=-s?a=-(i=Math.max(0,-(-c*u+l)))*i+(o=i>0?-u:Math.min(Math.max(-u,-d),u))*(o+2*d)+f:o<=s?(i=0,a=(o=Math.min(Math.max(-u,-d),u))*(o+2*d)+f):a=-(i=Math.max(0,-(c*u+l)))*i+(o=i>0?u:Math.min(Math.max(-u,-d),u))*(o+2*d)+f;else o=c>0?-u:u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ei).multiplyScalar(o).add($r),a}},{key:"intersectSphere",value:function(e,t){Qr.subVectors(e.center,this.origin);var n=Qr.dot(this.direction),r=Qr.dot(Qr)-n*n,i=e.radius*e.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,o,a,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,d=this.origin;return u>=0?(n=(e.min.x-d.x)*u,r=(e.max.x-d.x)*u):(n=(e.max.x-d.x)*u,r=(e.min.x-d.x)*u),c>=0?(i=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(i=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(e.min.z-d.z)*l,s=(e.max.z-d.z)*l):(a=(e.max.z-d.z)*l,s=(e.min.z-d.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,Qr)}},{key:"intersectTriangle",value:function(e,t,n,r,i){ni.subVectors(t,e),ri.subVectors(n,e),ii.crossVectors(ni,ri);var o,a=this.direction.dot(ii);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}ti.subVectors(this.origin,e);var s=o*this.direction.dot(ri.crossVectors(ti,ri));if(s<0)return null;var u=o*this.direction.dot(ni.cross(ti));if(u<0)return null;if(s+u>a)return null;var c=-o*ti.dot(ii);return c<0?null:this.at(c/a,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ai=function(){function e(){(0,v.Z)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return(0,m.Z)(e,[{key:"set",value:function(e,t,n,r,i,o,a,s,u,c,l,d,f,p,h,v){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=u,m[6]=c,m[10]=l,m[14]=d,m[3]=f,m[7]=p,m[11]=h,m[15]=v,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/si.setFromMatrixColumn(e,0).length(),i=1/si.setFromMatrixColumn(e,1).length(),o=1/si.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var d=o*c,f=o*l,p=a*c,h=a*l;t[0]=s*c,t[4]=-s*l,t[8]=u,t[1]=f+p*u,t[5]=d-h*u,t[9]=-a*s,t[2]=h-d*u,t[6]=p+f*u,t[10]=o*s}else if("YXZ"===e.order){var v=s*c,m=s*l,y=u*c,g=u*l;t[0]=v+g*a,t[4]=y*a-m,t[8]=o*u,t[1]=o*l,t[5]=o*c,t[9]=-a,t[2]=m*a-y,t[6]=g+v*a,t[10]=o*s}else if("ZXY"===e.order){var b=s*c,x=s*l,_=u*c,w=u*l;t[0]=b-w*a,t[4]=-o*l,t[8]=_+x*a,t[1]=x+_*a,t[5]=o*c,t[9]=w-b*a,t[2]=-o*u,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){var M=o*c,S=o*l,T=a*c,E=a*l;t[0]=s*c,t[4]=T*u-S,t[8]=M*u+E,t[1]=s*l,t[5]=E*u+M,t[9]=S*u-T,t[2]=-u,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var k=o*s,A=o*u,P=a*s,C=a*u;t[0]=s*c,t[4]=C-k*l,t[8]=P*l+A,t[1]=l,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=A*l+P,t[10]=k-C*l}else if("XZY"===e.order){var O=o*s,I=o*u,R=a*s,N=a*u;t[0]=s*c,t[4]=-l,t[8]=u*c,t[1]=O*l+N,t[5]=o*c,t[9]=I*l-R,t[2]=R*l-I,t[6]=a*c,t[10]=N*l+O}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(ci,e,li)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return pi.subVectors(e,t),0===pi.lengthSq()&&(pi.z=1),pi.normalize(),di.crossVectors(n,pi),0===di.lengthSq()&&(1===Math.abs(n.z)?pi.x+=1e-4:pi.z+=1e-4,pi.normalize(),di.crossVectors(n,pi)),di.normalize(),fi.crossVectors(pi,di),r[0]=di.x,r[4]=fi.x,r[8]=pi.x,r[1]=di.y,r[5]=fi.y,r[9]=pi.y,r[2]=di.z,r[6]=fi.z,r[10]=pi.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],d=n[9],f=n[13],p=n[2],h=n[6],v=n[10],m=n[14],y=n[3],g=n[7],b=n[11],x=n[15],_=r[0],w=r[4],M=r[8],S=r[12],T=r[1],E=r[5],k=r[9],A=r[13],P=r[2],C=r[6],O=r[10],I=r[14],R=r[3],N=r[7],D=r[11],L=r[15];return i[0]=o*_+a*T+s*P+u*R,i[4]=o*w+a*E+s*C+u*N,i[8]=o*M+a*k+s*O+u*D,i[12]=o*S+a*A+s*I+u*L,i[1]=c*_+l*T+d*P+f*R,i[5]=c*w+l*E+d*C+f*N,i[9]=c*M+l*k+d*O+f*D,i[13]=c*S+l*A+d*I+f*L,i[2]=p*_+h*T+v*P+m*R,i[6]=p*w+h*E+v*C+m*N,i[10]=p*M+h*k+v*O+m*D,i[14]=p*S+h*A+v*I+m*L,i[3]=y*_+g*T+b*P+x*R,i[7]=y*w+g*E+b*C+x*N,i[11]=y*M+g*k+b*O+x*D,i[15]=y*S+g*A+b*I+x*L,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],u=e[13],c=e[2],l=e[6],d=e[10],f=e[14];return e[3]*(+i*s*l-r*u*l-i*a*d+n*u*d+r*a*f-n*s*f)+e[7]*(+t*s*f-t*u*d+i*o*d-r*o*f+r*u*c-i*s*c)+e[11]*(+t*u*l-t*a*f-i*o*l+n*o*f+i*a*c-n*u*c)+e[15]*(-r*a*c-t*s*l+t*a*d+r*o*l-n*o*d+n*s*c)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],h=e[13],v=e[14],m=e[15],y=l*v*u-h*d*u+h*s*f-a*v*f-l*s*m+a*d*m,g=p*d*u-c*v*u-p*s*f+o*v*f+c*s*m-o*d*m,b=c*h*u-p*l*u+p*a*f-o*h*f-c*a*m+o*l*m,x=p*l*s-c*h*s-p*a*d+o*h*d+c*a*v-o*l*v,_=t*y+n*g+r*b+i*x;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/_;return e[0]=y*w,e[1]=(h*d*i-l*v*i-h*r*f+n*v*f+l*r*m-n*d*m)*w,e[2]=(a*v*i-h*s*i+h*r*u-n*v*u-a*r*m+n*s*m)*w,e[3]=(l*s*i-a*d*i-l*r*u+n*d*u+a*r*f-n*s*f)*w,e[4]=g*w,e[5]=(c*v*i-p*d*i+p*r*f-t*v*f-c*r*m+t*d*m)*w,e[6]=(p*s*i-o*v*i-p*r*u+t*v*u+o*r*m-t*s*m)*w,e[7]=(o*d*i-c*s*i+c*r*u-t*d*u-o*r*f+t*s*f)*w,e[8]=b*w,e[9]=(p*l*i-c*h*i-p*n*f+t*h*f+c*n*m-t*l*m)*w,e[10]=(o*h*i-p*a*i+p*n*u-t*h*u-o*n*m+t*a*m)*w,e[11]=(c*a*i-o*l*i-c*n*u+t*l*u+o*n*f-t*a*f)*w,e[12]=x*w,e[13]=(c*h*r-p*l*r+p*n*d-t*h*d-c*n*v+t*l*v)*w,e[14]=(p*a*r-o*h*r-p*n*s+t*h*s+o*n*v-t*a*v)*w,e[15]=(o*l*r-c*a*r+c*n*s-t*l*s-o*n*d+t*a*d)*w,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,u=i+i,c=o+o,l=a+a,d=i*u,f=i*c,p=i*l,h=o*c,v=o*l,m=a*l,y=s*u,g=s*c,b=s*l,x=n.x,_=n.y,w=n.z;return r[0]=(1-(h+m))*x,r[1]=(f+b)*x,r[2]=(p-g)*x,r[3]=0,r[4]=(f-b)*_,r[5]=(1-(d+m))*_,r[6]=(v+y)*_,r[7]=0,r[8]=(p+g)*w,r[9]=(v-y)*w,r[10]=(1-(d+h))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=si.set(r[0],r[1],r[2]).length(),o=si.set(r[4],r[5],r[6]).length(),a=si.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],ui.copy(this);var s=1/i,u=1/o,c=1/a;return ui.elements[0]*=s,ui.elements[1]*=s,ui.elements[2]*=s,ui.elements[4]*=u,ui.elements[5]*=u,ui.elements[6]*=u,ui.elements[8]*=c,ui.elements[9]*=c,ui.elements[10]*=c,t.setFromRotationMatrix(ui),n.x=i,n.y=o,n.z=a,this}},{key:"makePerspective",value:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),u=2*i/(n-r),c=(t+e)/(t-e),l=(n+r)/(n-r),d=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),u=1/(n-r),c=1/(o-i),l=(t+e)*s,d=(n+r)*u,f=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();ai.prototype.isMatrix4=!0;var si=new Pr,ui=new ai,ci=new Pr(0,0,0),li=new Pr(1,1,1),di=new Pr,fi=new Pr,pi=new Pr,hi=new ai,vi=new Ar,mi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;(0,v.Z)(this,e),this._x=t,this._y=n,this._z=r,this._order=i}return(0,m.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,i=r[0],o=r[4],a=r[8],s=r[1],u=r[5],c=r[9],l=r[2],d=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(ar(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ar(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-l,i),this._z=0);break;case"ZXY":this._x=Math.asin(ar(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-l,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-ar(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(ar(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-ar(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return hi.makeRotationFromQuaternion(e),this.setFromRotationMatrix(hi,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return vi.setFromEuler(this),this.setFromQuaternion(vi,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new Pr(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();mi.prototype.isEuler=!0,mi.DefaultOrder="XYZ",mi.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var yi=function(){function e(){(0,v.Z)(this,e),this.mask=1}return(0,m.Z)(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!=(this.mask&e.mask)}}]),e}(),gi=0,bi=new Pr,xi=new Ar,_i=new ai,wi=new Pr,Mi=new Pr,Si=new Pr,Ti=new Ar,Ei=new Pr(1,0,0),ki=new Pr(0,1,0),Ai=new Pr(0,0,1),Pi={type:"added"},Ci={type:"removed"},Oi=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;(0,v.Z)(this,n),e=t.call(this),Object.defineProperty((0,f.Z)(e),"id",{value:gi++}),e.uuid=or(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DefaultUp.clone();var r=new Pr,i=new mi,o=new Ar,a=new Pr(1,1,1);return i._onChange((function(){o.setFromEuler(i,!1)})),o._onChange((function(){i.setFromQuaternion(o,void 0,!1)})),Object.defineProperties((0,f.Z)(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new ai},normalMatrix:{value:new hr}}),e.matrix=new ai,e.matrixWorld=new ai,e.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,e.matrixWorldNeedsUpdate=!1,e.layers=new yi,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return(0,m.Z)(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return xi.setFromAxisAngle(e,t),this.quaternion.multiply(xi),this}},{key:"rotateOnWorldAxis",value:function(e,t){return xi.setFromAxisAngle(e,t),this.quaternion.premultiply(xi),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(Ei,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(ki,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(Ai,e)}},{key:"translateOnAxis",value:function(e,t){return bi.copy(e).applyQuaternion(this.quaternion),this.position.add(bi.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(Ei,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(ki,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(Ai,e)}},{key:"localToWorld",value:function(e){return e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return e.applyMatrix4(_i.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?wi.copy(e):wi.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Mi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_i.lookAt(Mi,wi,this.up):_i.lookAt(wi,Mi,this.up),this.quaternion.setFromRotationMatrix(_i),r&&(_i.extractRotation(r.matrixWorld),xi.setFromRotationMatrix(_i),this.quaternion.premultiply(xi.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Pi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Ci)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Ci)}return this.children.length=0,this}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),_i.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),_i.multiply(e.parent.matrixWorld)),e.applyMatrix4(_i),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Mi,e,Si),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Mi,Ti,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var c=a[s];i(e.shapes,c)}else i(e.shapes,a)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var l=[],d=0,f=this.material.length;d<f;d++)l.push(i(e.materials,this.material[d]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var p=0;p<this.children.length;p++)r.children.push(this.children[p].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var h=0;h<this.animations.length;h++){var v=this.animations[h];r.animations.push(i(e.animations,v))}}if(t){var m=M(e.geometries),y=M(e.materials),g=M(e.textures),b=M(e.images),x=M(e.shapes),_=M(e.skeletons),w=M(e.animations);m.length>0&&(n.geometries=m),y.length>0&&(n.materials=y),g.length>0&&(n.textures=g),b.length>0&&(n.images=b),x.length>0&&(n.shapes=x),_.length>0&&(n.skeletons=_),w.length>0&&(n.animations=w)}return n.object=r,n;function M(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}(Qn);Oi.DefaultUp=new Pr(0,1,0),Oi.DefaultMatrixAutoUpdate=!0,Oi.prototype.isObject3D=!0;var Ii=new Pr,Ri=new Pr,Ni=new Pr,Di=new Pr,Li=new Pr,Bi=new Pr,Fi=new Pr,ji=new Pr,zi=new Pr,Ui=new Pr,Gi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Pr;(0,v.Z)(this,e),this.a=t,this.b=n,this.c=r}return(0,m.Z)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return Ii.subVectors(this.c,this.b),Ri.subVectors(this.a,this.b),.5*Ii.cross(Ri).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,o){return e.getUV(t,this.a,this.b,this.c,n,r,i,o)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,o=this.b,a=this.c;Li.subVectors(o,i),Bi.subVectors(a,i),ji.subVectors(e,i);var s=Li.dot(ji),u=Bi.dot(ji);if(s<=0&&u<=0)return t.copy(i);zi.subVectors(e,o);var c=Li.dot(zi),l=Bi.dot(zi);if(c>=0&&l<=c)return t.copy(o);var d=s*l-c*u;if(d<=0&&s>=0&&c<=0)return n=s/(s-c),t.copy(i).addScaledVector(Li,n);Ui.subVectors(e,a);var f=Li.dot(Ui),p=Bi.dot(Ui);if(p>=0&&f<=p)return t.copy(a);var h=f*u-s*p;if(h<=0&&u>=0&&p<=0)return r=u/(u-p),t.copy(i).addScaledVector(Bi,r);var v=c*p-f*l;if(v<=0&&l-c>=0&&f-p>=0)return Fi.subVectors(a,o),r=(l-c)/(l-c+(f-p)),t.copy(o).addScaledVector(Fi,r);var m=1/(v+h+d);return n=h*m,r=d*m,t.copy(i).addScaledVector(Li,n).addScaledVector(Bi,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),Ii.subVectors(e,t),r.cross(Ii);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){Ii.subVectors(r,t),Ri.subVectors(n,t),Ni.subVectors(e,t);var o=Ii.dot(Ii),a=Ii.dot(Ri),s=Ii.dot(Ni),u=Ri.dot(Ri),c=Ri.dot(Ni),l=o*u-a*a;if(0===l)return i.set(-2,-1,-1);var d=1/l,f=(u*s-a*c)*d,p=(o*c-a*s)*d;return i.set(1-f-p,p,f)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,Di),Di.x>=0&&Di.y>=0&&Di.x+Di.y<=1}},{key:"getUV",value:function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,Di),s.set(0,0),s.addScaledVector(i,Di.x),s.addScaledVector(o,Di.y),s.addScaledVector(a,Di.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return Ii.subVectors(n,t),Ri.subVectors(e,t),Ii.cross(Ri).dot(r)<0}}]),e}(),Vi=0,Wi=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),e=t.call(this),Object.defineProperty((0,f.Z)(e),"id",{value:Vi++}),e.uuid=or(),e.name="",e.type="Material",e.fog=!0,e.blending=L,e.side=C,e.vertexColors=!1,e.opacity=1,e.format=et,e.transparent=!1,e.blendSrc=K,e.blendDst=J,e.blendEquation=U,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthFunc=ae,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=zn,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=En,e.stencilZFail=En,e.stencilZPass=En,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return(0,m.Z)(n,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===R;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenTint&&this.sheenTint.isColor&&(n.sheenTint=this.sheenTint.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(n.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(n.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(n.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==L&&(n.blending=this.blending),this.side!==C&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==et&&(n.format=this.format),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(Qn);Wi.prototype.isMaterial=!0;var Hi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zi={h:0,s:0,l:0},qi={h:0,s:0,l:0};function Yi(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Xi(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ki(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Ji=function(){function e(t,n,r){return(0,v.Z)(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return(0,m.Z)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){if(e=sr(e,1),t=ar(t,0,1),n=ar(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Yi(i,r,e+1/3),this.g=Yi(i,r,e),this.b=Yi(i,r,e-1/3)}return this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=Hi[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=Xi(e.r),this.g=Xi(e.g),this.b=Xi(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Ki(e.r),this.g=Ki(e.g),this.b=Ki(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)t=0,n=0;else{var c=a-s;switch(n=u<=.5?c/(a+s):c/(2-a-s),a){case r:t=(i-o)/c+(i<o?6:0);break;case i:t=(o-r)/c+2;break;case o:t=(r-i)/c+4}t/=6}return e.h=t,e.s=n,e.l=u,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Zi),Zi.h+=e,Zi.s+=t,Zi.l+=n,this.setHSL(Zi.h,Zi.s,Zi.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Zi),e.getHSL(qi);var n=ur(Zi.h,qi.h,t),r=ur(Zi.s,qi.s,t),i=ur(Zi.l,qi.l,t);return this.setHSL(n,r,i),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();Ji.NAMES=Hi,Ji.prototype.isColor=!0,Ji.prototype.r=1,Ji.prototype.g=1,Ji.prototype.b=1;var Qi=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new Ji(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=de,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(Wi);Qi.prototype.isMeshBasicMaterial=!0;var $i=new Pr,eo=new pr,to=function(){function e(t,n,r){if((0,v.Z)(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=!0===r,this.usage=Un,this.updateRange={offset:0,count:-1},this.version=0}return(0,m.Z)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"copyColorsArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Ji),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}},{key:"copyVector2sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new pr),t[n++]=o.x,t[n++]=o.y}return this}},{key:"copyVector3sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Pr),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}},{key:"copyVector4sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Sr),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)eo.fromBufferAttribute(this,t),eo.applyMatrix3(e),this.setXY(t,eo.x,eo.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)$i.fromBufferAttribute(this,r),$i.applyMatrix3(e),this.setXYZ(r,$i.x,$i.y,$i.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)$i.x=this.getX(t),$i.y=this.getY(t),$i.z=this.getZ(t),$i.applyMatrix4(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)$i.x=this.getX(t),$i.y=this.getY(t),$i.z=this.getZ(t),$i.applyNormalMatrix(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)$i.x=this.getX(t),$i.y=this.getY(t),$i.z=this.getZ(t),$i.transformDirection(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getX",value:function(e){return this.array[e*this.itemSize]}},{key:"setX",value:function(e,t){return this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){return this.array[e*this.itemSize+1]}},{key:"setY",value:function(e,t){return this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){return this.array[e*this.itemSize+2]}},{key:"setZ",value:function(e,t){return this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){return this.array[e*this.itemSize+3]}},{key:"setW",value:function(e,t){return this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Un&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}]),e}();to.prototype.isBufferAttribute=!0;var no=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Int8Array(e),r,i)}return(0,m.Z)(n)}(to),ro=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Uint8Array(e),r,i)}return(0,m.Z)(n)}(to),io=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Uint8ClampedArray(e),r,i)}return(0,m.Z)(n)}(to),oo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Int16Array(e),r,i)}return(0,m.Z)(n)}(to),ao=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,m.Z)(n)}(to),so=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Int32Array(e),r,i)}return(0,m.Z)(n)}(to),uo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Uint32Array(e),r,i)}return(0,m.Z)(n)}(to),co=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,m.Z)(n)}(to);co.prototype.isFloat16BufferAttribute=!0;var lo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Float32Array(e),r,i)}return(0,m.Z)(n)}(to),fo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){return(0,v.Z)(this,n),t.call(this,new Float64Array(e),r,i)}return(0,m.Z)(n)}(to),po=0,ho=new ai,vo=new Oi,mo=new Pr,yo=new Ir,go=new Ir,bo=new Pr,xo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),e=t.call(this),Object.defineProperty((0,f.Z)(e),"id",{value:po++}),e.uuid=or(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return(0,m.Z)(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(vr(e)>65535?uo:ao)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new hr).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return ho.makeRotationFromQuaternion(e),this.applyMatrix4(ho),this}},{key:"rotateX",value:function(e){return ho.makeRotationX(e),this.applyMatrix4(ho),this}},{key:"rotateY",value:function(e){return ho.makeRotationY(e),this.applyMatrix4(ho),this}},{key:"rotateZ",value:function(e){return ho.makeRotationZ(e),this.applyMatrix4(ho),this}},{key:"translate",value:function(e,t,n){return ho.makeTranslation(e,t,n),this.applyMatrix4(ho),this}},{key:"scale",value:function(e,t,n){return ho.makeScale(e,t,n),this.applyMatrix4(ho),this}},{key:"lookAt",value:function(e){return vo.lookAt(e),vo.updateMatrix(),this.applyMatrix4(vo.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(mo).negate(),this.translate(mo.x,mo.y,mo.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new lo(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new Ir);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Pr(-1/0,-1/0,-1/0),new Pr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];yo.setFromBufferAttribute(i),this.morphTargetsRelative?(bo.addVectors(this.boundingBox.min,yo.min),this.boundingBox.expandByPoint(bo),bo.addVectors(this.boundingBox.max,yo.max),this.boundingBox.expandByPoint(bo)):(this.boundingBox.expandByPoint(yo.min),this.boundingBox.expandByPoint(yo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new Jr);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Pr,1/0);if(e){var n=this.boundingSphere.center;if(yo.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var o=t[r];go.setFromBufferAttribute(o),this.morphTargetsRelative?(bo.addVectors(yo.min,go.min),yo.expandByPoint(bo),bo.addVectors(yo.max,go.max),yo.expandByPoint(bo)):(yo.expandByPoint(go.min),yo.expandByPoint(go.max))}yo.getCenter(n);for(var a=0,s=0,u=e.count;s<u;s++)bo.fromBufferAttribute(e,s),a=Math.max(a,n.distanceToSquared(bo));if(t)for(var c=0,l=t.length;c<l;c++)for(var d=t[c],f=this.morphTargetsRelative,p=0,h=d.count;p<h;p++)bo.fromBufferAttribute(d,p),f&&(mo.fromBufferAttribute(e,p),bo.add(mo)),a=Math.max(a,n.distanceToSquared(bo));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,o=t.uv.array,a=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new to(new Float32Array(4*a),4));for(var s=t.tangent.array,u=[],c=[],l=0;l<a;l++)u[l]=new Pr,c[l]=new Pr;var d=new Pr,f=new Pr,p=new Pr,h=new pr,v=new pr,m=new pr,y=new Pr,g=new Pr,b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(var x=0,_=b.length;x<_;++x)for(var w=b[x],M=w.start,S=M,T=M+w.count;S<T;S+=3)L(n[S+0],n[S+1],n[S+2]);for(var E=new Pr,k=new Pr,A=new Pr,P=new Pr,C=0,O=b.length;C<O;++C)for(var I=b[C],R=I.start,N=R,D=R+I.count;N<D;N+=3)B(n[N+0]),B(n[N+1]),B(n[N+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function L(e,t,n){d.fromArray(r,3*e),f.fromArray(r,3*t),p.fromArray(r,3*n),h.fromArray(o,2*e),v.fromArray(o,2*t),m.fromArray(o,2*n),f.sub(d),p.sub(d),v.sub(h),m.sub(h);var i=1/(v.x*m.y-m.x*v.y);isFinite(i)&&(y.copy(f).multiplyScalar(m.y).addScaledVector(p,-v.y).multiplyScalar(i),g.copy(p).multiplyScalar(v.x).addScaledVector(f,-m.x).multiplyScalar(i),u[e].add(y),u[t].add(y),u[n].add(y),c[e].add(g),c[t].add(g),c[n].add(g))}function B(e){A.fromArray(i,3*e),P.copy(A);var t=u[e];E.copy(t),E.sub(A.multiplyScalar(A.dot(t))).normalize(),k.crossVectors(P,t);var n=k.dot(c[e])<0?-1:1;s[4*e]=E.x,s[4*e+1]=E.y,s[4*e+2]=E.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new to(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var o=new Pr,a=new Pr,s=new Pr,u=new Pr,c=new Pr,l=new Pr,d=new Pr,f=new Pr;if(e)for(var p=0,h=e.count;p<h;p+=3){var v=e.getX(p+0),m=e.getX(p+1),y=e.getX(p+2);o.fromBufferAttribute(t,v),a.fromBufferAttribute(t,m),s.fromBufferAttribute(t,y),d.subVectors(s,a),f.subVectors(o,a),d.cross(f),u.fromBufferAttribute(n,v),c.fromBufferAttribute(n,m),l.fromBufferAttribute(n,y),u.add(d),c.add(d),l.add(d),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(m,c.x,c.y,c.z),n.setXYZ(y,l.x,l.y,l.z)}else for(var g=0,b=t.count;g<b;g+=3)o.fromBufferAttribute(t,g+0),a.fromBufferAttribute(t,g+1),s.fromBufferAttribute(t,g+2),d.subVectors(s,a),f.subVectors(o,a),d.cross(f),n.setXYZ(g+0,d.x,d.y,d.z),n.setXYZ(g+1,d.x,d.y,d.z),n.setXYZ(g+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"merge",value:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=o.itemSize*t,u=Math.min(a.length,i.length-s),c=0,l=s;c<u;c++,l++)i[l]=a[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)bo.fromBufferAttribute(e,t),bo.normalize(),e.setXYZ(t,bo.x,bo.y,bo.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r),a=0,s=0,u=0,c=t.length;u<c;u++){a=e.isInterleavedBufferAttribute?t[u]*e.data.stride+e.offset:t[u]*r;for(var l=0;l<r;l++)o[s++]=n[a++]}return new to(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var o in i){var a=e(i[o],r);t.setAttribute(o,a)}var s=this.morphAttributes;for(var u in s){for(var c=[],l=s[u],d=0,f=l.length;d<f;d++){var p=e(l[d],r);c.push(p)}t.morphAttributes[u]=c}t.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,v=0,m=h.length;v<m;v++){var y=h[v];t.addGroup(y.start,y.count,y.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var o in i){var a=i[o];e.data.attributes[o]=a.toJSON(e.data)}var s={},u=!1;for(var c in this.morphAttributes){for(var l=this.morphAttributes[c],d=[],f=0,p=l.length;f<p;f++){var h=l[f];d.push(h.toJSON(e.data))}d.length>0&&(s[c]=d,u=!0)}u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(e.data.groups=JSON.parse(JSON.stringify(v)));var m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var o=r[i];this.setAttribute(i,o.clone(t))}var a=e.morphAttributes;for(var s in a){for(var u=[],c=a[s],l=0,d=c.length;l<d;l++)u.push(c[l].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var f=e.groups,p=0,h=f.length;p<h;p++){var v=f[p];this.addGroup(v.start,v.count,v.materialIndex)}var m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());var y=e.boundingSphere;return null!==y&&(this.boundingSphere=y.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Qn);xo.prototype.isBufferGeometry=!0;var _o=new ai,wo=new oi,Mo=new Jr,So=new Pr,To=new Pr,Eo=new Pr,ko=new Pr,Ao=new Pr,Po=new Pr,Co=new Pr,Oo=new Pr,Io=new Pr,Ro=new pr,No=new pr,Do=new pr,Lo=new Pr,Bo=new Pr,Fo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xo,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qi;return(0,v.Z)(this,n),(e=t.call(this)).type="Mesh",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"raycast",value:function(e,t){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Mo.copy(r.boundingSphere),Mo.applyMatrix4(o),!1!==e.ray.intersectsSphere(Mo)&&(_o.copy(o).invert(),wo.copy(e.ray).applyMatrix4(_o),null===r.boundingBox||!1!==wo.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a=r.index,s=r.attributes.position,u=r.morphAttributes.position,c=r.morphTargetsRelative,l=r.attributes.uv,d=r.attributes.uv2,f=r.groups,p=r.drawRange;if(null!==a)if(Array.isArray(i))for(var h=0,v=f.length;h<v;h++)for(var m=f[h],y=i[m.materialIndex],g=Math.max(m.start,p.start),b=Math.min(a.count,Math.min(m.start+m.count,p.start+p.count));g<b;g+=3){var x=a.getX(g),_=a.getX(g+1),w=a.getX(g+2);(n=jo(this,y,e,wo,s,u,c,l,d,x,_,w))&&(n.faceIndex=Math.floor(g/3),n.face.materialIndex=m.materialIndex,t.push(n))}else for(var M=Math.max(0,p.start),S=Math.min(a.count,p.start+p.count);M<S;M+=3){var T=a.getX(M),E=a.getX(M+1),k=a.getX(M+2);(n=jo(this,i,e,wo,s,u,c,l,d,T,E,k))&&(n.faceIndex=Math.floor(M/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var A=0,P=f.length;A<P;A++)for(var C=f[A],O=i[C.materialIndex],I=Math.max(C.start,p.start),R=Math.min(s.count,Math.min(C.start+C.count,p.start+p.count));I<R;I+=3)(n=jo(this,O,e,wo,s,u,c,l,d,I,I+1,I+2))&&(n.faceIndex=Math.floor(I/3),n.face.materialIndex=C.materialIndex,t.push(n));else for(var N=Math.max(0,p.start),D=Math.min(s.count,p.start+p.count);N<D;N+=3)(n=jo(this,i,e,wo,s,u,c,l,d,N,N+1,N+2))&&(n.faceIndex=Math.floor(N/3),t.push(n))}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}]),n}(Oi);function jo(e,t,n,r,i,o,a,s,u,c,l,d){So.fromBufferAttribute(i,c),To.fromBufferAttribute(i,l),Eo.fromBufferAttribute(i,d);var f=e.morphTargetInfluences;if(o&&f){Co.set(0,0,0),Oo.set(0,0,0),Io.set(0,0,0);for(var p=0,h=o.length;p<h;p++){var v=f[p],m=o[p];0!==v&&(ko.fromBufferAttribute(m,c),Ao.fromBufferAttribute(m,l),Po.fromBufferAttribute(m,d),a?(Co.addScaledVector(ko,v),Oo.addScaledVector(Ao,v),Io.addScaledVector(Po,v)):(Co.addScaledVector(ko.sub(So),v),Oo.addScaledVector(Ao.sub(To),v),Io.addScaledVector(Po.sub(Eo),v)))}So.add(Co),To.add(Oo),Eo.add(Io)}e.isSkinnedMesh&&(e.boneTransform(c,So),e.boneTransform(l,To),e.boneTransform(d,Eo));var y=function(e,t,n,r,i,o,a,s){if(null===(t.side===O?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side!==I,s)))return null;Bo.copy(s),Bo.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(Bo);return u<n.near||u>n.far?null:{distance:u,point:Bo.clone(),object:e}}(e,t,n,r,So,To,Eo,Lo);if(y){s&&(Ro.fromBufferAttribute(s,c),No.fromBufferAttribute(s,l),Do.fromBufferAttribute(s,d),y.uv=Gi.getUV(Lo,So,To,Eo,Ro,No,Do,new pr)),u&&(Ro.fromBufferAttribute(u,c),No.fromBufferAttribute(u,l),Do.fromBufferAttribute(u,d),y.uv2=Gi.getUV(Lo,So,To,Eo,Ro,No,Do,new pr));var g={a:c,b:l,c:d,normal:new Pr,materialIndex:0};Gi.getNormal(So,To,Eo,g.normal),y.face=g}return y}Fo.prototype.isMesh=!0;var zo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,v.Z)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:o,widthSegments:a,heightSegments:s,depthSegments:u};var c=(0,f.Z)(e);a=Math.floor(a),s=Math.floor(s),u=Math.floor(u);var l=[],d=[],p=[],h=[],m=0,y=0;function g(e,t,n,r,i,o,a,s,u,f,v){for(var g=o/u,b=a/f,x=o/2,_=a/2,w=s/2,M=u+1,S=f+1,T=0,E=0,k=new Pr,A=0;A<S;A++)for(var P=A*b-_,C=0;C<M;C++){var O=C*g-x;k[e]=O*r,k[t]=P*i,k[n]=w,d.push(k.x,k.y,k.z),k[e]=0,k[t]=0,k[n]=s>0?1:-1,p.push(k.x,k.y,k.z),h.push(C/u),h.push(1-A/f),T+=1}for(var I=0;I<f;I++)for(var R=0;R<u;R++){var N=m+R+M*I,D=m+R+M*(I+1),L=m+(R+1)+M*(I+1),B=m+(R+1)+M*I;l.push(N,D,B),l.push(D,L,B),E+=6}c.addGroup(y,E,v),y+=E,m+=T}return g("z","y","x",-1,-1,o,i,r,u,s,0),g("z","y","x",1,-1,o,i,-r,u,s,1),g("x","z","y",1,1,r,o,i,a,u,2),g("x","z","y",1,-1,r,o,-i,a,u,3),g("x","y","z",1,-1,r,i,o,a,s,4),g("x","y","z",-1,-1,r,i,-o,a,s,5),e.setIndex(l),e.setAttribute("position",new lo(d,3)),e.setAttribute("normal",new lo(p,3)),e.setAttribute("uv",new lo(h,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),n}(xo);function Uo(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function Go(e){for(var t={},n=0;n<e.length;n++){var r=Uo(e[n]);for(var i in r)t[i]=r[i]}return t}var Vo={clone:Uo,merge:Go},Wo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="ShaderMaterial",r.defines={},r.uniforms={},r.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",r.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),r.setValues(e)),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Uo(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var o={};for(var a in this.extensions)!0===this.extensions[a]&&(o[a]=!0);return Object.keys(o).length>0&&(t.extensions=o),t}}]),n}(Wi);Wo.prototype.isShaderMaterial=!0;var Ho=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="Camera",e.matrixWorldInverse=new ai,e.projectionMatrix=new ai,e.projectionMatrixInverse=new ai,e}return(0,m.Z)(n,[{key:"copy",value:function(e,t){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}},{key:"updateMatrixWorld",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){(0,c.Z)((0,l.Z)(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(Oi);Ho.prototype.isCamera=!0;var Zo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return(0,v.Z)(this,n),(e=t.call(this)).type="PerspectiveCamera",e.fov=r,e.zoom=1,e.near=o,e.far=a,e.focus=10,e.aspect=i,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return(0,m.Z)(n,[{key:"copy",value:function(e,t){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*tr*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*er*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*tr*Math.atan(Math.tan(.5*er*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*er*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(Ho);Zo.prototype.isPerspectiveCamera=!0;var qo=90,Yo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;if((0,v.Z)(this,n),(o=t.call(this)).type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),(0,u.Z)(o);o.renderTarget=i;var a=new Zo(qo,1,e,r);a.layers=o.layers,a.up.set(0,-1,0),a.lookAt(new Pr(1,0,0)),o.add(a);var s=new Zo(qo,1,e,r);s.layers=o.layers,s.up.set(0,-1,0),s.lookAt(new Pr(-1,0,0)),o.add(s);var c=new Zo(qo,1,e,r);c.layers=o.layers,c.up.set(0,0,1),c.lookAt(new Pr(0,1,0)),o.add(c);var l=new Zo(qo,1,e,r);l.layers=o.layers,l.up.set(0,0,-1),l.lookAt(new Pr(0,-1,0)),o.add(l);var d=new Zo(qo,1,e,r);d.layers=o.layers,d.up.set(0,-1,0),d.lookAt(new Pr(0,0,1)),o.add(d);var f=new Zo(qo,1,e,r);return f.layers=o.layers,f.up.set(0,-1,0),f.lookAt(new Pr(0,0,-1)),o.add(f),o}return(0,m.Z)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=(0,s.Z)(this.children,6),i=r[0],o=r[1],a=r[2],u=r[3],c=r[4],l=r[5],d=e.xr.enabled,f=e.getRenderTarget();e.xr.enabled=!1;var p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,o),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,u),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=p,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(f),e.xr.enabled=d}}]),n}(Oi),Xo=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o,a,s,u,c,l,d){var f;return(0,v.Z)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:_e,(f=t.call(this,e,r,i,o,a,s,u,c,l,d)).flipY=!1,f}return(0,m.Z)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(wr);Xo.prototype.isCubeTexture=!0;var Ko=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;return(0,v.Z)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),o=t.call(this,e,e,r),r=r||{},o.texture=new Xo(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),o.texture.isRenderTargetTexture=!0,o.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,o.texture.minFilter=void 0!==r.minFilter?r.minFilter:De,o.texture._needsFlipEnvMap=!1,o}return(0,m.Z)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=et,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n=new zo(5,5,5),r=new Wo({name:"CubemapFromEquirect",uniforms:Uo({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:O,blending:D});r.uniforms.tEquirect.value=t;var i=new Fo(n,r),o=t.minFilter;return t.minFilter===Fe&&(t.minFilter=De),new Yo(1,10,this).update(e,i),t.minFilter=o,i.geometry.dispose(),i.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(Tr);Ko.prototype.isWebGLCubeRenderTarget=!0;var Jo=new Pr,Qo=new Pr,$o=new hr,ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.Z)(this,e),this.normal=t,this.constant=n}return(0,m.Z)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=Jo.subVectors(n,t).cross(Qo.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){var n=e.delta(Jo),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||$o.getNormalMatrix(e),r=this.coplanarPoint(Jo).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();ea.prototype.isPlane=!0;var ta=new Jr,na=new Pr,ra=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ea,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ea,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ea,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ea,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ea,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new ea;(0,v.Z)(this,e),this.planes=[t,n,r,i,o,a]}return(0,m.Z)(e,[{key:"set",value:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=n[8],f=n[9],p=n[10],h=n[11],v=n[12],m=n[13],y=n[14],g=n[15];return t[0].setComponents(a-r,l-s,h-d,g-v).normalize(),t[1].setComponents(a+r,l+s,h+d,g+v).normalize(),t[2].setComponents(a+i,l+u,h+f,g+m).normalize(),t[3].setComponents(a-i,l-u,h-f,g-m).normalize(),t[4].setComponents(a-o,l-c,h-p,g-y).normalize(),t[5].setComponents(a+o,l+c,h+p,g+y).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ta.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ta)}},{key:"intersectsSprite",value:function(e){return ta.center.set(0,0,0),ta.radius=.7071067811865476,ta.applyMatrix4(e.matrixWorld),this.intersectsSphere(ta)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(na.x=r.normal.x>0?e.max.x:e.min.x,na.y=r.normal.y>0?e.max.y:e.min.y,na.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(na)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function ia(){var e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function oa(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var o=r.get(t);(!o||o.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var a=r.get(t);void 0===a?r.set(t,function(t,r){var i=t.array,o=t.usage,a=e.createBuffer();e.bindBuffer(r,a),e.bufferData(r,i,o),t.onUploadCallback();var s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(s=5121),{buffer:a,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(function(t,r,i){var o=r.array,a=r.updateRange;e.bindBuffer(i,t),-1===a.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(a.buffer,t,i),a.version=t.version)}}}}var aa=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,v.Z)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:o,heightSegments:a};for(var s=r/2,u=i/2,c=Math.floor(o),l=Math.floor(a),d=c+1,f=l+1,p=r/c,h=i/l,m=[],y=[],g=[],b=[],x=0;x<f;x++)for(var _=x*h-u,w=0;w<d;w++){var M=w*p-s;y.push(M,-_,0),g.push(0,0,1),b.push(w/c),b.push(1-x/l)}for(var S=0;S<l;S++)for(var T=0;T<c;T++){var E=T+d*S,k=T+d*(S+1),A=T+1+d*(S+1),P=T+1+d*S;m.push(E,k,P),m.push(k,A,P)}return e.setIndex(m),e.setAttribute("position",new lo(y,3)),e.setAttribute("normal",new lo(g,3)),e.setAttribute("uv",new lo(b,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}}]),n}(xo),sa={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenTint, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenTint * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenTint, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n\tuniform float sheenRoughness;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ua={common:{diffuse:{value:new Ji(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new hr},uv2Transform:{value:new hr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ji(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ji(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new hr}},sprite:{diffuse:{value:new Ji(16777215)},opacity:{value:1},center:{value:new pr(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new hr}}},ca={basic:{uniforms:Go([ua.common,ua.specularmap,ua.envmap,ua.aomap,ua.lightmap,ua.fog]),vertexShader:sa.meshbasic_vert,fragmentShader:sa.meshbasic_frag},lambert:{uniforms:Go([ua.common,ua.specularmap,ua.envmap,ua.aomap,ua.lightmap,ua.emissivemap,ua.fog,ua.lights,{emissive:{value:new Ji(0)}}]),vertexShader:sa.meshlambert_vert,fragmentShader:sa.meshlambert_frag},phong:{uniforms:Go([ua.common,ua.specularmap,ua.envmap,ua.aomap,ua.lightmap,ua.emissivemap,ua.bumpmap,ua.normalmap,ua.displacementmap,ua.fog,ua.lights,{emissive:{value:new Ji(0)},specular:{value:new Ji(1118481)},shininess:{value:30}}]),vertexShader:sa.meshphong_vert,fragmentShader:sa.meshphong_frag},standard:{uniforms:Go([ua.common,ua.envmap,ua.aomap,ua.lightmap,ua.emissivemap,ua.bumpmap,ua.normalmap,ua.displacementmap,ua.roughnessmap,ua.metalnessmap,ua.fog,ua.lights,{emissive:{value:new Ji(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:sa.meshphysical_vert,fragmentShader:sa.meshphysical_frag},toon:{uniforms:Go([ua.common,ua.aomap,ua.lightmap,ua.emissivemap,ua.bumpmap,ua.normalmap,ua.displacementmap,ua.gradientmap,ua.fog,ua.lights,{emissive:{value:new Ji(0)}}]),vertexShader:sa.meshtoon_vert,fragmentShader:sa.meshtoon_frag},matcap:{uniforms:Go([ua.common,ua.bumpmap,ua.normalmap,ua.displacementmap,ua.fog,{matcap:{value:null}}]),vertexShader:sa.meshmatcap_vert,fragmentShader:sa.meshmatcap_frag},points:{uniforms:Go([ua.points,ua.fog]),vertexShader:sa.points_vert,fragmentShader:sa.points_frag},dashed:{uniforms:Go([ua.common,ua.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:sa.linedashed_vert,fragmentShader:sa.linedashed_frag},depth:{uniforms:Go([ua.common,ua.displacementmap]),vertexShader:sa.depth_vert,fragmentShader:sa.depth_frag},normal:{uniforms:Go([ua.common,ua.bumpmap,ua.normalmap,ua.displacementmap,{opacity:{value:1}}]),vertexShader:sa.meshnormal_vert,fragmentShader:sa.meshnormal_frag},sprite:{uniforms:Go([ua.sprite,ua.fog]),vertexShader:sa.sprite_vert,fragmentShader:sa.sprite_frag},background:{uniforms:{uvTransform:{value:new hr},t2D:{value:null}},vertexShader:sa.background_vert,fragmentShader:sa.background_frag},cube:{uniforms:Go([ua.envmap,{opacity:{value:1}}]),vertexShader:sa.cube_vert,fragmentShader:sa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:sa.equirect_vert,fragmentShader:sa.equirect_frag},distanceRGBA:{uniforms:Go([ua.common,ua.displacementmap,{referencePosition:{value:new Pr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:sa.distanceRGBA_vert,fragmentShader:sa.distanceRGBA_frag},shadow:{uniforms:Go([ua.lights,ua.fog,{color:{value:new Ji(0)},opacity:{value:1}}]),vertexShader:sa.shadow_vert,fragmentShader:sa.shadow_frag}};function la(e,t,n,r,i){var o,a,s=new Ji(0),u=0,c=null,l=0,d=null;function f(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),f(s,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){f(s,u=e)},render:function(n,i){var p=!1,h=!0===i.isScene?i.background:null;h&&h.isTexture&&(h=t.get(h));var v=e.xr,m=v.getSession&&v.getSession();m&&"additive"===m.environmentBlendMode&&(h=null),null===h?f(s,u):h&&h.isColor&&(f(h,1),p=!0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),h&&(h.isCubeTexture||h.mapping===Te)?(void 0===a&&((a=new Fo(new zo(1,1,1),new Wo({name:"BackgroundCubeMaterial",uniforms:Uo(ca.cube.uniforms),vertexShader:ca.cube.vertexShader,fragmentShader:ca.cube.fragmentShader,side:O,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),a.material.uniforms.envMap.value=h,a.material.uniforms.flipEnvMap.value=h.isCubeTexture&&!1===h.isRenderTargetTexture?-1:1,c===h&&l===h.version&&d===e.toneMapping||(a.material.needsUpdate=!0,c=h,l=h.version,d=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):h&&h.isTexture&&(void 0===o&&((o=new Fo(new aa(2,2),new Wo({name:"BackgroundMaterial",uniforms:Uo(ca.background.uniforms),vertexShader:ca.background.vertexShader,fragmentShader:ca.background.fragmentShader,side:C,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=h,!0===h.matrixAutoUpdate&&h.updateMatrix(),o.material.uniforms.uvTransform.value.copy(h.matrix),c===h&&l===h.version&&d===e.toneMapping||(o.material.needsUpdate=!0,c=h,l=h.version,d=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function da(e,t,n,r){var i=e.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),a=r.isWebGL2||null!==o,s={},u=f(null),c=u;function l(t){return r.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function f(e){for(var t=[],n=[],r=[],o=0;o<i;o++)t[o]=0,n[o]=0,r[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){for(var e=c.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function h(e){v(e,0)}function v(n,i){var o=c.newAttributes,a=c.enabledAttributes,s=c.attributeDivisors;o[n]=1,0===a[n]&&(e.enableVertexAttribArray(n),a[n]=1),s[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function m(){for(var t=c.newAttributes,n=c.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,i,o,a,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,o,a,s):e.vertexAttribIPointer(t,n,i,a,s)}function g(){b(),c!==u&&l((c=u).object)}function b(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,d,g,b){var x=!1;if(a){var _=function(t,n,i){var a=!0===i.wireframe,u=s[t.id];void 0===u&&(u={},s[t.id]=u);var c=u[n.id];void 0===c&&(c={},u[n.id]=c);var l=c[a];return void 0===l&&(l=f(r.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),c[a]=l),l}(g,d,u);c!==_&&l((c=_).object),x=function(e,t){var n=c.attributes,r=e.attributes,i=0;for(var o in r){var a=n[o],s=r[o];if(void 0===a)return!0;if(a.attribute!==s)return!0;if(a.data!==s.data)return!0;i++}return c.attributesNum!==i||c.index!==t}(g,b),x&&function(e,t){var n={},r=e.attributes,i=0;for(var o in r){var a=r[o],s={};s.attribute=a,a.data&&(s.data=a.data),n[o]=s,i++}c.attributes=n,c.attributesNum=i,c.index=t}(g,b)}else{var w=!0===u.wireframe;c.geometry===g.id&&c.program===d.id&&c.wireframe===w||(c.geometry=g.id,c.program=d.id,c.wireframe=w,x=!0)}!0===i.isInstancedMesh&&(x=!0),null!==b&&n.update(b,34963),x&&(function(i,o,a,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){p();var u=s.attributes,c=a.getAttributes(),l=o.defaultAttributeValues;for(var d in c){var f=c[d];if(f.location>=0){var g=u[d];if(void 0===g&&("instanceMatrix"===d&&i.instanceMatrix&&(g=i.instanceMatrix),"instanceColor"===d&&i.instanceColor&&(g=i.instanceColor)),void 0!==g){var b=g.normalized,x=g.itemSize,_=n.get(g);if(void 0===_)continue;var w=_.buffer,M=_.type,S=_.bytesPerElement;if(g.isInterleavedBufferAttribute){var T=g.data,E=T.stride,k=g.offset;if(T&&T.isInstancedInterleavedBuffer){for(var A=0;A<f.locationSize;A++)v(f.location+A,T.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=T.meshPerAttribute*T.count)}else for(var P=0;P<f.locationSize;P++)h(f.location+P);e.bindBuffer(34962,w);for(var C=0;C<f.locationSize;C++)y(f.location+C,x/f.locationSize,M,b,E*S,(k+x/f.locationSize*C)*S)}else{if(g.isInstancedBufferAttribute){for(var O=0;O<f.locationSize;O++)v(f.location+O,g.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=g.meshPerAttribute*g.count)}else for(var I=0;I<f.locationSize;I++)h(f.location+I);e.bindBuffer(34962,w);for(var R=0;R<f.locationSize;R++)y(f.location+R,x/f.locationSize,M,b,x*S,x/f.locationSize*R*S)}}else if(void 0!==l){var N=l[d];if(void 0!==N)switch(N.length){case 2:e.vertexAttrib2fv(f.location,N);break;case 3:e.vertexAttrib3fv(f.location,N);break;case 4:e.vertexAttrib4fv(f.location,N);break;default:e.vertexAttrib1fv(f.location,N)}}}}m()}}(i,u,d,g),null!==b&&e.bindBuffer(34963,n.get(b).buffer))},reset:g,resetDefaultState:b,dispose:function(){for(var e in g(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)d(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:p,enableAttribute:h,disableUnusedAttributes:m}}function fa(e,t,n,r){var i,o=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,a,s){if(0!==s){var u,c;if(o)u=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](i,r,a,s),n.update(a,i,s)}}}function pa(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var u=o||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),d=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),h=e.getParameter(34921),v=e.getParameter(36347),m=e.getParameter(36348),y=e.getParameter(36349),g=d>0,b=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:h,maxVertexUniforms:v,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:g,floatFragmentTextures:b,floatVertexTextures:g&&b,maxSamples:o?e.getParameter(36183):0}}function ha(e){var t=this,n=null,r=0,i=!1,o=!1,a=new ea,s=new hr,u={value:null,needsUpdate:!1};function c(){u.value!==n&&(u.value=n,u.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function l(e,n,r,i){var o=null!==e?e.length:0,c=null;if(0!==o){if(c=u.value,!0!==i||null===c){var l=r+4*o,d=n.matrixWorldInverse;s.getNormalMatrix(d),(null===c||c.length<l)&&(c=new Float32Array(l));for(var f=0,p=r;f!==o;++f,p+=4)a.copy(e[f]).applyMatrix4(d,s),a.normal.toArray(c,p),c[p+3]=a.constant}u.value=c,u.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,c}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,o){var a=0!==e.length||t||0!==r||i;return i=t,n=l(e,o,0),r=e.length,a},this.beginShadows=function(){o=!0,l(null)},this.endShadows=function(){o=!1,c()},this.setState=function(t,a,s){var d=t.clippingPlanes,f=t.clipIntersection,p=t.clipShadows,h=e.get(t);if(!i||null===d||0===d.length||o&&!p)o?l(null):c();else{var v=o?0:r,m=4*v,y=h.clippingState||null;u.value=y,y=l(d,a,m,s);for(var g=0;g!==m;++g)y[g]=n[g];h.clippingState=y,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=v}}}function va(e){var t=new WeakMap;function n(e,t){return t===Me?e.mapping=_e:t===Se&&(e.mapping=we),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var o=i.mapping;if(o===Me||o===Se){if(t.has(i))return n(t.get(i).texture,i.mapping);var a=i.image;if(a&&a.height>0){var s=e.getRenderTarget(),u=new Ko(a.height/2);return u.fromEquirectangularTexture(e,i),t.set(i,u),e.setRenderTarget(s),i.addEventListener("dispose",r),n(u.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}ca.physical={uniforms:Go([ca.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new pr(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenTint:{value:new Ji(0)},sheenRoughness:{value:0},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new pr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Ji(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Ji(1,1,1)},specularTintMap:{value:null}}]),vertexShader:sa.meshphysical_vert,fragmentShader:sa.meshphysical_frag};var ma=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return(0,v.Z)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=o,e.bottom=a,e.near=s,e.far=u,e.updateProjectionMatrix(),e}return(0,m.Z)(n,[{key:"copy",value:function(e,t){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=u*this.view.offsetX)+u*this.view.width,s=(a-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(Ho);ma.prototype.isOrthographicCamera=!0;var ya=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return(0,m.Z)(n)}(Wo);ya.prototype.isRawShaderMaterial=!0;var ga=Math.pow(2,8),ba=[.125,.215,.35,.446,.526,.582],xa=5+ba.length,_a=(r={},(0,a.Z)(r,pn,0),(0,a.Z)(r,hn,1),(0,a.Z)(r,mn,2),(0,a.Z)(r,gn,3),(0,a.Z)(r,bn,4),(0,a.Z)(r,xn,5),(0,a.Z)(r,vn,6),r),wa=new ma,Ma=Na(),Sa=Ma._lodPlanes,Ta=Ma._sizeLods,Ea=Ma._sigmas,ka=new Ji,Aa=null,Pa=(1+Math.sqrt(5))/2,Ca=1/Pa,Oa=[new Pr(1,1,1),new Pr(-1,1,1),new Pr(1,1,-1),new Pr(-1,1,-1),new Pr(0,Pa,Ca),new Pr(0,Pa,-Ca),new Pr(Ca,0,Pa),new Pr(-Ca,0,Pa),new Pr(Pa,Ca,0),new Pr(-Pa,Ca,0)],Ia=function(){function e(t){var n,r;(0,v.Z)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(20,n=new Float32Array(20),r=new Pr(0,1,0),new ya({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:_a[pn]},outputEncoding:{value:_a[pn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:D,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return(0,m.Z)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Aa=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=Fa(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=Ba(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Sa.length;e++)Sa[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Aa),e.scissorTest=!1,La(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){Aa=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:Ce,minFilter:Ce,generateMipmaps:!1,type:ze,format:rt,encoding:Ra(e)?e.encoding:mn,depthBuffer:!1},n=Da(t);return n.depthBuffer=!e,this._pingPongRenderTarget=Da(t),n}},{key:"_compileMaterial",value:function(e){var t=new Fo(Sa[0],e);this._renderer.compile(t,wa)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new Zo(90,1,t,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,c=s.outputEncoding,l=s.toneMapping;s.getClearColor(ka),s.toneMapping=he,s.outputEncoding=pn,s.autoClear=!1;var d=new Qi({name:"PMREM.Background",side:O,depthWrite:!1,depthTest:!1}),f=new Fo(new zo,d),p=!1,h=e.background;h?h.isColor&&(d.color.copy(h),e.background=null,p=!0):(d.color.copy(ka),p=!0);for(var v=0;v<6;v++){var m=v%3;0==m?(i.up.set(0,o[v],0),i.lookAt(a[v],0,0)):1==m?(i.up.set(0,0,o[v]),i.lookAt(0,a[v],0)):(i.up.set(0,o[v],0),i.lookAt(0,0,a[v])),La(r,m*ga,v>2?ga:0,ga,ga),s.setRenderTarget(r),p&&s.render(f,i),s.render(e,i)}f.geometry.dispose(),f.material.dispose(),s.toneMapping=l,s.outputEncoding=c,s.autoClear=u,e.background=h}},{key:"_setEncoding",value:function(e,t){!0===this._renderer.capabilities.isWebGL2&&t.format===et&&t.type===ze&&t.encoding===hn?e.value=_a[pn]:e.value=_a[t.encoding]}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Fa()):null==this._equirectShader&&(this._equirectShader=Ba());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new Fo(Sa[0],r),o=r.uniforms;o.envMap.value=e,e.isCubeTexture||o.texelSize.value.set(1/e.image.width,1/e.image.height),this._setEncoding(o.inputEncoding,e),this._setEncoding(o.outputEncoding,t.texture),La(t,0,0,3*ga,2*ga),n.setRenderTarget(t),n.render(i,wa)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<xa;r++){var i=Math.sqrt(Ea[r]*Ea[r]-Ea[r-1]*Ea[r-1]),o=Oa[(r-1)%Oa.length];this._blur(e,r-1,r,i,o)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,o,a){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new Fo(Sa[r],u),l=u.uniforms,d=Ta[n]-1,f=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,p=i/f,h=isFinite(i)?1+Math.floor(3*p):20;h>20&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(h," samples when the maximum is set to ").concat(20));for(var v=[],m=0,y=0;y<20;++y){var g=y/p,b=Math.exp(-g*g/2);v.push(b),0==y?m+=b:y<h&&(m+=2*b)}for(var x=0;x<v.length;x++)v[x]=v[x]/m;l.envMap.value=e.texture,l.samples.value=h,l.weights.value=v,l.latitudinal.value="latitudinal"===o,a&&(l.poleAxis.value=a),l.dTheta.value=f,l.mipInt.value=8-n,this._setEncoding(l.inputEncoding,e.texture),this._setEncoding(l.outputEncoding,e.texture);var _=Ta[r];La(t,3*Math.max(0,ga-2*_),(0===r?0:2*ga)+2*_*(r>4?r-8+4:0),3*_,2*_),s.setRenderTarget(t),s.render(c,wa)}}]),e}();function Ra(e){return void 0!==e&&e.type===ze&&(e.encoding===pn||e.encoding===hn||e.encoding===vn)}function Na(){for(var e=[],t=[],n=[],r=8,i=0;i<xa;i++){var o=Math.pow(2,r);t.push(o);var a=1/o;i>4?a=ba[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],d=new Float32Array(108),f=new Float32Array(72),p=new Float32Array(36),h=0;h<6;h++){var v=h%3*2/3-1,m=h>2?0:-1,y=[v,m,0,v+2/3,m,0,v+2/3,m+1,0,v,m,0,v+2/3,m+1,0,v,m+1,0];d.set(y,18*h),f.set(l,12*h);var g=[h,h,h,h,h,h];p.set(g,6*h)}var b=new xo;b.setAttribute("position",new to(d,3)),b.setAttribute("uv",new to(f,2)),b.setAttribute("faceIndex",new to(p,1)),e.push(b),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function Da(e){var t=new Tr(3*ga,3*ga,e);return t.texture.mapping=Te,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function La(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Ba(){var e=new pr(1,1);return new ya({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:_a[pn]},outputEncoding:{value:_a[pn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:D,depthTest:!1,depthWrite:!1})}function Fa(){return new ya({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:_a[pn]},outputEncoding:{value:_a[pn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:D,depthTest:!1,depthWrite:!1})}function ja(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var o=i.mapping,a=o===Me||o===Se,s=o===_e||o===we;if(a||s){if(t.has(i))return t.get(i).texture;var u=i.image;if(a&&u&&u.height>0||s&&u&&function(e){for(var t=0,n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(u)){var c=e.getRenderTarget();null===n&&(n=new Ia(e));var l=a?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,l),e.setRenderTarget(c),i.addEventListener("dispose",r),l.texture}return null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function za(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("EXT_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Ua(e,t,n,r){var i={},o=new WeakMap;function a(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",a),delete i[s.id];var c=o.get(s);c&&(t.remove(c),o.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var u=0,c=s.length;u<c;u+=3){var l=s[u+0],d=s[u+1],f=s[u+2];n.push(l,d,d,f,f,l)}}else{var p=i.array;a=i.version;for(var h=0,v=p.length/3-1;h<v;h+=3){var m=h+0,y=h+1,g=h+2;n.push(m,y,y,g,g,m)}}var b=new(vr(n)>65535?uo:ao)(n,1);b.version=a;var x=o.get(e);x&&t.remove(x),o.set(e,b)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",a),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var o in i)for(var a=i[o],s=0,u=a.length;s<u;s++)t.update(a[s],34962)},getWireframeAttribute:function(e){var t=o.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return o.get(e)}}}function Ga(e,t,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i,1)},this.renderInstances=function(r,u,c){if(0!==c){var l,d;if(s)l=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[d](i,u,o,r*a,c),n.update(u,i,c)}}}function Va(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}var Wa=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.Z)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:o,depth:a},e.magFilter=Ce,e.minFilter=Ce,e.wrapR=Ae,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,m.Z)(n)}(wr);function Ha(e,t){return e[0]-t[0]}function Za(e,t){return Math.abs(t[1])-Math.abs(e[1])}function qa(e,t){var n=1,r=t.isInterleavedBufferAttribute?t.data.array:t.array;r instanceof Int8Array?n=127:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),e.divideScalar(n)}function Ya(e,t,n){for(var r={},i=new Float32Array(8),o=new WeakMap,a=new Pr,s=[],u=0;u<8;u++)s[u]=[u,0];return{update:function(u,c,l,d){var f=u.morphTargetInfluences;if(!0===t.isWebGL2){var p=c.morphAttributes.position.length,h=o.get(c);if(void 0===h||h.count!==p){void 0!==h&&h.texture.dispose();var v=void 0!==c.morphAttributes.normal,m=c.morphAttributes.position,y=c.morphAttributes.normal||[],g=!0===v?2:1,b=c.attributes.position.count*g,x=1;b>t.maxTextureSize&&(x=Math.ceil(b/t.maxTextureSize),b=t.maxTextureSize);var _=new Float32Array(b*x*4*p),w=new Wa(_,b,x,p);w.format=et,w.type=Ze;for(var M=4*g,S=0;S<p;S++)for(var T=m[S],E=y[S],k=b*x*4*S,A=0;A<T.count;A++){a.fromBufferAttribute(T,A),!0===T.normalized&&qa(a,T);var P=A*M;_[k+P+0]=a.x,_[k+P+1]=a.y,_[k+P+2]=a.z,_[k+P+3]=0,!0===v&&(a.fromBufferAttribute(E,A),!0===E.normalized&&qa(a,E),_[k+P+4]=a.x,_[k+P+5]=a.y,_[k+P+6]=a.z,_[k+P+7]=0)}h={count:p,texture:w,size:new pr(b,x)},o.set(c,h)}for(var C=0,O=0;O<f.length;O++)C+=f[O];var I=c.morphTargetsRelative?1:1-C;d.getUniforms().setValue(e,"morphTargetBaseInfluence",I),d.getUniforms().setValue(e,"morphTargetInfluences",f),d.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),d.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}else{var R=void 0===f?0:f.length,N=r[c.id];if(void 0===N||N.length!==R){N=[];for(var D=0;D<R;D++)N[D]=[D,0];r[c.id]=N}for(var L=0;L<R;L++){var B=N[L];B[0]=L,B[1]=f[L]}N.sort(Za);for(var F=0;F<8;F++)F<R&&N[F][1]?(s[F][0]=N[F][0],s[F][1]=N[F][1]):(s[F][0]=Number.MAX_SAFE_INTEGER,s[F][1]=0);s.sort(Ha);for(var j=c.morphAttributes.position,z=c.morphAttributes.normal,U=0,G=0;G<8;G++){var V=s[G],W=V[0],H=V[1];W!==Number.MAX_SAFE_INTEGER&&H?(j&&c.getAttribute("morphTarget"+G)!==j[W]&&c.setAttribute("morphTarget"+G,j[W]),z&&c.getAttribute("morphNormal"+G)!==z[W]&&c.setAttribute("morphNormal"+G,z[W]),i[G]=H,U+=H):(j&&!0===c.hasAttribute("morphTarget"+G)&&c.deleteAttribute("morphTarget"+G),z&&!0===c.hasAttribute("morphNormal"+G)&&c.deleteAttribute("morphNormal"+G),i[G]=0)}var Z=c.morphTargetsRelative?1:1-U;d.getUniforms().setValue(e,"morphTargetBaseInfluence",Z),d.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function Xa(e,t,n,r){var i=new WeakMap;function o(e){var t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var a=r.render.frame,s=e.geometry,u=t.get(e,s);return i.get(u)!==a&&(t.update(u),i.set(u,a)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",o)&&e.addEventListener("dispose",o),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),u},dispose:function(){i=new WeakMap}}}Wa.prototype.isDataTexture2DArray=!0;var Ka=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.Z)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:o,depth:a},e.magFilter=Ce,e.minFilter=Ce,e.wrapR=Ae,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,m.Z)(n)}(wr);Ka.prototype.isDataTexture3D=!0;var Ja=new wr,Qa=new Wa,$a=new Ka,es=new Xo,ts=[],ns=[],rs=new Float32Array(16),is=new Float32Array(9),os=new Float32Array(4);function as(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=ts[i];if(void 0===o&&(o=new Float32Array(i),ts[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function ss(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function us(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function cs(e,t){var n=ns[t];void 0===n&&(n=new Int32Array(t),ns[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ls(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ds(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ss(n,t))return;e.uniform2fv(this.addr,t),us(n,t)}}function fs(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ss(n,t))return;e.uniform3fv(this.addr,t),us(n,t)}}function ps(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ss(n,t))return;e.uniform4fv(this.addr,t),us(n,t)}}function hs(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ss(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),us(n,t)}else{if(ss(n,r))return;os.set(r),e.uniformMatrix2fv(this.addr,!1,os),us(n,r)}}function vs(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ss(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),us(n,t)}else{if(ss(n,r))return;is.set(r),e.uniformMatrix3fv(this.addr,!1,is),us(n,r)}}function ms(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ss(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),us(n,t)}else{if(ss(n,r))return;rs.set(r),e.uniformMatrix4fv(this.addr,!1,rs),us(n,r)}}function ys(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function gs(e,t){var n=this.cache;ss(n,t)||(e.uniform2iv(this.addr,t),us(n,t))}function bs(e,t){var n=this.cache;ss(n,t)||(e.uniform3iv(this.addr,t),us(n,t))}function xs(e,t){var n=this.cache;ss(n,t)||(e.uniform4iv(this.addr,t),us(n,t))}function _s(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function ws(e,t){var n=this.cache;ss(n,t)||(e.uniform2uiv(this.addr,t),us(n,t))}function Ms(e,t){var n=this.cache;ss(n,t)||(e.uniform3uiv(this.addr,t),us(n,t))}function Ss(e,t){var n=this.cache;ss(n,t)||(e.uniform4uiv(this.addr,t),us(n,t))}function Ts(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Ja,i)}function Es(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||$a,i)}function ks(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||es,i)}function As(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Qa,i)}function Ps(e,t){e.uniform1fv(this.addr,t)}function Cs(e,t){var n=as(t,this.size,2);e.uniform2fv(this.addr,n)}function Os(e,t){var n=as(t,this.size,3);e.uniform3fv(this.addr,n)}function Is(e,t){var n=as(t,this.size,4);e.uniform4fv(this.addr,n)}function Rs(e,t){var n=as(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Ns(e,t){var n=as(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Ds(e,t){var n=as(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Ls(e,t){e.uniform1iv(this.addr,t)}function Bs(e,t){e.uniform2iv(this.addr,t)}function Fs(e,t){e.uniform3iv(this.addr,t)}function js(e,t){e.uniform4iv(this.addr,t)}function zs(e,t){e.uniform1uiv(this.addr,t)}function Us(e,t){e.uniform2uiv(this.addr,t)}function Gs(e,t){e.uniform3uiv(this.addr,t)}function Vs(e,t){e.uniform4uiv(this.addr,t)}function Ws(e,t,n){var r=t.length,i=cs(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(t[o]||Ja,i[o])}function Hs(e,t,n){var r=t.length,i=cs(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(t[o]||es,i[o])}function Zs(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ls;case 35664:return ds;case 35665:return fs;case 35666:return ps;case 35674:return hs;case 35675:return vs;case 35676:return ms;case 5124:case 35670:return ys;case 35667:case 35671:return gs;case 35668:case 35672:return bs;case 35669:case 35673:return xs;case 5125:return _s;case 36294:return ws;case 36295:return Ms;case 36296:return Ss;case 35678:case 36198:case 36298:case 36306:case 35682:return Ts;case 35679:case 36299:case 36307:return Es;case 35680:case 36300:case 36308:case 36293:return ks;case 36289:case 36303:case 36311:case 36292:return As}}(t.type)}function qs(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ps;case 35664:return Cs;case 35665:return Os;case 35666:return Is;case 35674:return Rs;case 35675:return Ns;case 35676:return Ds;case 5124:case 35670:return Ls;case 35667:case 35671:return Bs;case 35668:case 35672:return Fs;case 35669:case 35673:return js;case 5125:return zs;case 36294:return Us;case 36295:return Gs;case 36296:return Vs;case 35678:case 36198:case 36298:case 36306:case 35682:return Ws;case 35680:case 36300:case 36308:case 36293:return Hs}}(t.type)}function Ys(e){this.id=e,this.seq=[],this.map={}}qs.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),us(t,e)},Ys.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var Xs=/(\w+)(\])?(\[|\.)?/g;function Ks(e,t){e.seq.push(t),e.map[t.id]=t}function Js(e,t,n){var r=e.name,i=r.length;for(Xs.lastIndex=0;;){var o=Xs.exec(r),a=Xs.lastIndex,s=o[1],u="]"===o[2],c=o[3];if(u&&(s|=0),void 0===c||"["===c&&a+2===i){Ks(n,void 0===c?new Zs(s,e,t):new qs(s,e,t));break}var l=n.map[s];void 0===l&&Ks(n,l=new Ys(s)),n=l}}function Qs(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Js(i,e.getUniformLocation(t,i.name),this)}}function $s(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Qs.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Qs.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Qs.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},Qs.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var eu=0;function tu(e){switch(e){case pn:return["Linear","( value )"];case hn:return["sRGB","( value )"];case mn:return["RGBE","( value )"];case gn:return["RGBM","( value, 7.0 )"];case bn:return["RGBM","( value, 16.0 )"];case xn:return["RGBD","( value, 256.0 )"];case vn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case yn:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function nu(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":n.toUpperCase()+"\n\n"+i+"\n\n"+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function ru(e,t){var n=tu(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function iu(e,t){var n;switch(t){case ve:n="Linear";break;case me:n="Reinhard";break;case ye:n="OptimizedCineon";break;case ge:n="ACESFilmic";break;case be:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ou(e){return""!==e}function au(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function su(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var uu=/^[ \t]*#include +<([\w\d./]+)>/gm;function cu(e){return e.replace(uu,lu)}function lu(e,t){var n=sa[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return cu(n)}var du=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,fu=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pu(e){return e.replace(fu,vu).replace(du,hu)}function hu(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),vu(0,t,n,r)}function vu(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function mu(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function yu(e,t,n,r){var i,o,a,s,u=e.getContext(),c=n.defines,l=n.vertexShader,d=n.fragmentShader,f=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===k?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===A?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===P&&(t="SHADOWMAP_TYPE_VSM"),t}(n),p=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case _e:case we:t="ENVMAP_TYPE_CUBE";break;case Te:case Ee:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),h=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case we:case Ee:t="ENVMAP_MODE_REFRACTION"}return t}(n),v=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case de:t="ENVMAP_BLENDING_MULTIPLY";break;case fe:t="ENVMAP_BLENDING_MIX";break;case pe:t="ENVMAP_BLENDING_ADD"}return t}(n),m=e.gammaFactor>0?e.gammaFactor:1,y=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ou).join("\n")}(n),g=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(c),b=u.createProgram(),x=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[g].filter(ou).join("\n")).length>0&&(i+="\n"),(o=[y,g].filter(ou).join("\n")).length>0&&(o+="\n")):(i=[mu(n),"#define SHADER_NAME "+n.shaderName,g,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularTintMap?"#define USE_SPECULARTINTMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ou).join("\n"),o=[y,mu(n),"#define SHADER_NAME "+n.shaderName,g,"#define GAMMA_FACTOR "+m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+h:"",n.envMap?"#define "+v:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularTintMap?"#define USE_SPECULARTINTMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==he?"#define TONE_MAPPING":"",n.toneMapping!==he?sa.tonemapping_pars_fragment:"",n.toneMapping!==he?iu("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.format===$e?"#define OPAQUE":"",sa.encodings_pars_fragment,n.map?ru("mapTexelToLinear",n.mapEncoding):"",n.matcap?ru("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?ru("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?ru("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.specularTintMap?ru("specularTintMapTexelToLinear",n.specularTintMapEncoding):"",n.lightMap?ru("lightMapTexelToLinear",n.lightMapEncoding):"",("linearToOutputTexel",a=n.outputEncoding,s=tu(a),"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ou).join("\n")),l=su(l=au(l=cu(l),n),n),d=su(d=au(d=cu(d),n),n),l=pu(l),d=pu(d),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(x="#version 300 es\n",i=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,o=["#define varying in",n.glslVersion===Jn?"":"out highp vec4 pc_fragColor;",n.glslVersion===Jn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+o);var _,w,M=x+o+d,S=$s(u,35633,x+i+l),T=$s(u,35632,M);if(u.attachShader(b,S),u.attachShader(b,T),void 0!==n.index0AttributeName?u.bindAttribLocation(b,0,n.index0AttributeName):!0===n.morphTargets&&u.bindAttribLocation(b,0,"position"),u.linkProgram(b),e.debug.checkShaderErrors){var E=u.getProgramInfoLog(b).trim(),C=u.getShaderInfoLog(S).trim(),O=u.getShaderInfoLog(T).trim(),I=!0,R=!0;if(!1===u.getProgramParameter(b,35714)){I=!1;var N=nu(u,S,"vertex"),D=nu(u,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+u.getError()+" - VALIDATE_STATUS "+u.getProgramParameter(b,35715)+"\n\nProgram Info Log: "+E+"\n"+N+"\n"+D)}else""!==E?console.warn("THREE.WebGLProgram: Program Info Log:",E):""!==C&&""!==O||(R=!1);R&&(this.diagnostics={runnable:I,programLog:E,vertexShader:{log:C,prefix:i},fragmentShader:{log:O,prefix:o}})}return u.deleteShader(S),u.deleteShader(T),this.getUniforms=function(){return void 0===_&&(_=new Qs(u,b)),_},this.getAttributes=function(){return void 0===w&&(w=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var o=e.getActiveAttrib(t,i),a=o.name,s=1;35674===o.type&&(s=2),35675===o.type&&(s=3),35676===o.type&&(s=4),n[a]={type:o.type,location:e.getAttribLocation(t,a),locationSize:s}}return n}(u,b)),w},this.destroy=function(){r.releaseStatesOfProgram(this),u.deleteProgram(b),this.program=void 0},this.name=n.shaderName,this.id=eu++,this.cacheKey=t,this.usedTimes=1,this.program=b,this.vertexShader=S,this.fragmentShader=T,this}function gu(e,t,n,r,i,o,a){var s=[],u=i.isWebGL2,c=i.logarithmicDepthBuffer,l=i.floatVertexTextures,d=i.maxVertexUniforms,f=i.vertexTextures,p=i.precision,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},v=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheen","transmission","transmissionMap","thicknessMap"];function m(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=pn,u&&e&&e.isTexture&&e.format===et&&e.type===ze&&e.encoding===hn&&(t=pn),t}return{getParameters:function(o,s,v,y,g){var b,x,_=y.fog,w=o.isMeshStandardMaterial?y.environment:null,M=(o.isMeshStandardMaterial?n:t).get(o.envMap||w),S=h[o.type],T=g.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(l)return 1024;var n=d,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(g):0;if(null!==o.precision&&(p=i.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",p,"instead."),S){var E=ca[S];b=E.vertexShader,x=E.fragmentShader}else b=o.vertexShader,x=o.fragmentShader;var k=e.getRenderTarget(),A=o.alphaTest>0,P=o.clearcoat>0;return{isWebGL2:u,shaderID:S,shaderName:o.type,vertexShader:b,fragmentShader:x,defines:o.defines,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:p,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:f,outputEncoding:null!==k?m(k.texture):e.outputEncoding,map:!!o.map,mapEncoding:m(o.map),matcap:!!o.matcap,matcapEncoding:m(o.matcap),envMap:!!M,envMapMode:M&&M.mapping,envMapEncoding:m(M),envMapCubeUV:!!M&&(M.mapping===Te||M.mapping===Ee),lightMap:!!o.lightMap,lightMapEncoding:m(o.lightMap),aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,emissiveMapEncoding:m(o.emissiveMap),bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===Sn,tangentSpaceNormalMap:o.normalMapType===Mn,clearcoat:P,clearcoatMap:P&&!!o.clearcoatMap,clearcoatRoughnessMap:P&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:P&&!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularTintMap:!!o.specularTintMap,specularTintMapEncoding:m(o.specularTintMap),alphaMap:!!o.alphaMap,alphaTest:A,gradientMap:!!o.gradientMap,sheen:o.sheen>0,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!g.geometry&&!!g.geometry.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!g.geometry&&!!g.geometry.attributes.color&&4===g.geometry.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularTintMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularTintMap||!o.displacementMap),fog:!!_,useFog:o.fog,fogExp2:_&&_.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:c,skinning:!0===g.isSkinnedMesh&&T>0,maxBones:T,useVertexTexture:l,morphTargets:!!g.geometry&&!!g.geometry.morphAttributes.position,morphNormals:!!g.geometry&&!!g.geometry.morphAttributes.normal,morphTargetsCount:g.geometry&&g.geometry.morphAttributes.position?g.geometry.morphAttributes.position.length:0,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,format:o.format,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&v.length>0,shadowMapType:e.shadowMap.type,toneMapping:o.toneMapped?e.toneMapping:he,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===I,flipSided:o.side===O,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<v.length;i++)n.push(t[v[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=h[e.type];if(n){var r=ca[n];t=Vo.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,a=s.length;i<a;i++){var u=s[i];if(u.cacheKey===n){++(r=u).usedTimes;break}}return void 0===r&&(r=new yu(e,n,t,o),s.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=s.indexOf(e);s[t]=s[s.length-1],s.pop(),e.destroy()}},programs:s}}function bu(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function xu(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function _u(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function wu(e){var t=[],n=0,r=[],i=[],o=[],a={id:-1};function s(r,i,o,s,u,c){var l=t[n],d=e.get(o);return void 0===l?(l={id:r.id,object:r,geometry:i,material:o,program:d.program||a,groupOrder:s,renderOrder:r.renderOrder,z:u,group:c},t[n]=l):(l.id=r.id,l.object=r,l.geometry=i,l.material=o,l.program=d.program||a,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=u,l.group=c),n++,l}return{opaque:r,transmissive:i,transparent:o,init:function(){n=0,r.length=0,i.length=0,o.length=0},push:function(e,t,n,a,u,c){var l=s(e,t,n,a,u,c);n.transmission>0?i.push(l):!0===n.transparent?o.push(l):r.push(l)},unshift:function(e,t,n,a,u,c){var l=s(e,t,n,a,u,c);n.transmission>0?i.unshift(l):!0===n.transparent?o.unshift(l):r.unshift(l)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||xu),i.length>1&&i.sort(t||_u),o.length>1&&o.sort(t||_u)}}}function Mu(e){var t=new WeakMap;return{get:function(n,r){var i;return!1===t.has(n)?(i=new wu(e),t.set(n,[i])):r>=t.get(n).length?(i=new wu(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new WeakMap}}}function Su(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Pr,color:new Ji};break;case"SpotLight":n={position:new Pr,direction:new Pr,color:new Ji,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Pr,color:new Ji,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Pr,skyColor:new Ji,groundColor:new Ji};break;case"RectAreaLight":n={color:new Ji,position:new Pr,halfWidth:new Pr,halfHeight:new Pr}}return e[t.id]=n,n}}}var Tu=0;function Eu(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function ku(e,t){for(var n,r=new Su,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pr};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pr,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)o.probe.push(new Pr);var s=new Pr,u=new ai,c=new ai;return{setup:function(n,a){for(var s=0,u=0,c=0,l=0;l<9;l++)o.probe[l].set(0,0,0);var d=0,f=0,p=0,h=0,v=0,m=0,y=0,g=0;n.sort(Eu);for(var b=!0!==a?Math.PI:1,x=0,_=n.length;x<_;x++){var w=n[x],M=w.color,S=w.intensity,T=w.distance,E=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)s+=M.r*S*b,u+=M.g*S*b,c+=M.b*S*b;else if(w.isLightProbe)for(var k=0;k<9;k++)o.probe[k].addScaledVector(w.sh.coefficients[k],S);else if(w.isDirectionalLight){var A=r.get(w);if(A.color.copy(w.color).multiplyScalar(w.intensity*b),w.castShadow){var P=w.shadow,C=i.get(w);C.shadowBias=P.bias,C.shadowNormalBias=P.normalBias,C.shadowRadius=P.radius,C.shadowMapSize=P.mapSize,o.directionalShadow[d]=C,o.directionalShadowMap[d]=E,o.directionalShadowMatrix[d]=w.shadow.matrix,m++}o.directional[d]=A,d++}else if(w.isSpotLight){var O=r.get(w);if(O.position.setFromMatrixPosition(w.matrixWorld),O.color.copy(M).multiplyScalar(S*b),O.distance=T,O.coneCos=Math.cos(w.angle),O.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),O.decay=w.decay,w.castShadow){var I=w.shadow,R=i.get(w);R.shadowBias=I.bias,R.shadowNormalBias=I.normalBias,R.shadowRadius=I.radius,R.shadowMapSize=I.mapSize,o.spotShadow[p]=R,o.spotShadowMap[p]=E,o.spotShadowMatrix[p]=w.shadow.matrix,g++}o.spot[p]=O,p++}else if(w.isRectAreaLight){var N=r.get(w);N.color.copy(M).multiplyScalar(S),N.halfWidth.set(.5*w.width,0,0),N.halfHeight.set(0,.5*w.height,0),o.rectArea[h]=N,h++}else if(w.isPointLight){var D=r.get(w);if(D.color.copy(w.color).multiplyScalar(w.intensity*b),D.distance=w.distance,D.decay=w.decay,w.castShadow){var L=w.shadow,B=i.get(w);B.shadowBias=L.bias,B.shadowNormalBias=L.normalBias,B.shadowRadius=L.radius,B.shadowMapSize=L.mapSize,B.shadowCameraNear=L.camera.near,B.shadowCameraFar=L.camera.far,o.pointShadow[f]=B,o.pointShadowMap[f]=E,o.pointShadowMatrix[f]=w.shadow.matrix,y++}o.point[f]=D,f++}else if(w.isHemisphereLight){var F=r.get(w);F.skyColor.copy(w.color).multiplyScalar(S*b),F.groundColor.copy(w.groundColor).multiplyScalar(S*b),o.hemi[v]=F,v++}}h>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(o.rectAreaLTC1=ua.LTC_FLOAT_1,o.rectAreaLTC2=ua.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=ua.LTC_HALF_1,o.rectAreaLTC2=ua.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=s,o.ambient[1]=u,o.ambient[2]=c;var j=o.hash;j.directionalLength===d&&j.pointLength===f&&j.spotLength===p&&j.rectAreaLength===h&&j.hemiLength===v&&j.numDirectionalShadows===m&&j.numPointShadows===y&&j.numSpotShadows===g||(o.directional.length=d,o.spot.length=p,o.rectArea.length=h,o.point.length=f,o.hemi.length=v,o.directionalShadow.length=m,o.directionalShadowMap.length=m,o.pointShadow.length=y,o.pointShadowMap.length=y,o.spotShadow.length=g,o.spotShadowMap.length=g,o.directionalShadowMatrix.length=m,o.pointShadowMatrix.length=y,o.spotShadowMatrix.length=g,j.directionalLength=d,j.pointLength=f,j.spotLength=p,j.rectAreaLength=h,j.hemiLength=v,j.numDirectionalShadows=m,j.numPointShadows=y,j.numSpotShadows=g,o.version=Tu++)},setupView:function(e,t){for(var n=0,r=0,i=0,a=0,l=0,d=t.matrixWorldInverse,f=0,p=e.length;f<p;f++){var h=e[f];if(h.isDirectionalLight){var v=o.directional[n];v.direction.setFromMatrixPosition(h.matrixWorld),s.setFromMatrixPosition(h.target.matrixWorld),v.direction.sub(s),v.direction.transformDirection(d),n++}else if(h.isSpotLight){var m=o.spot[i];m.position.setFromMatrixPosition(h.matrixWorld),m.position.applyMatrix4(d),m.direction.setFromMatrixPosition(h.matrixWorld),s.setFromMatrixPosition(h.target.matrixWorld),m.direction.sub(s),m.direction.transformDirection(d),i++}else if(h.isRectAreaLight){var y=o.rectArea[a];y.position.setFromMatrixPosition(h.matrixWorld),y.position.applyMatrix4(d),c.identity(),u.copy(h.matrixWorld),u.premultiply(d),c.extractRotation(u),y.halfWidth.set(.5*h.width,0,0),y.halfHeight.set(0,.5*h.height,0),y.halfWidth.applyMatrix4(c),y.halfHeight.applyMatrix4(c),a++}else if(h.isPointLight){var g=o.point[r];g.position.setFromMatrixPosition(h.matrixWorld),g.position.applyMatrix4(d),r++}else if(h.isHemisphereLight){var b=o.hemi[l];b.direction.setFromMatrixPosition(h.matrixWorld),b.direction.transformDirection(d),b.direction.normalize(),l++}}},state:o}}function Au(e,t){var n=new ku(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Pu(e,t){var n=new WeakMap;return{get:function(r){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(i=new Au(e,t),n.set(r,[i])):o>=n.get(r).length?(i=new Au(e,t),n.get(r).push(i)):i=n.get(r)[o],i},dispose:function(){n=new WeakMap}}}var Cu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=_n,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(Wi);Cu.prototype.isMeshDepthMaterial=!0;var Ou=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new Pr,r.nearDistance=1,r.farDistance=1e3,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(Wi);function Iu(e,t,n){var r=new ra,i=new pr,o=new pr,a=new Sr,s=new Cu({depthPacking:wn}),u=new Ou,c={},l=n.maxTextureSize,d={0:O,1:C,2:I},f=new Wo({uniforms:{shadow_pass:{value:null},resolution:{value:new pr},radius:{value:4},samples:{value:8}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=f.clone();p.defines.HORIZONTAL_PASS=1;var h=new xo;h.setAttribute("position",new to(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new Fo(h,f),m=this;function y(n,r){var i=t.update(v);f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,f.uniforms.samples.value=n.blurSamples,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,f,v,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,p.uniforms.samples.value=n.blurSamples,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,v,null)}function g(t,n,r,i,o,a,l){var f=null,p=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(f=void 0!==p?p:!0===i.isPointLight?u:s,e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0){var h=f.uuid,v=r.uuid,m=c[h];void 0===m&&(m={},c[h]=m);var y=m[v];void 0===y&&(y=f.clone(),m[v]=y),f=y}return f.visible=r.visible,f.wireframe=r.wireframe,f.side=l===P?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:d[r.side],f.alphaMap=r.alphaMap,f.alphaTest=r.alphaTest,f.clipShadows=r.clipShadows,f.clippingPlanes=r.clippingPlanes,f.clipIntersection=r.clipIntersection,f.displacementMap=r.displacementMap,f.displacementScale=r.displacementScale,f.displacementBias=r.displacementBias,f.wireframeLinewidth=r.wireframeLinewidth,f.linewidth=r.linewidth,!0===i.isPointLight&&!0===f.isMeshDistanceMaterial&&(f.referencePosition.setFromMatrixPosition(i.matrixWorld),f.nearDistance=o,f.farDistance=a),f}function b(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===P)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var u=t.update(n),c=n.material;if(Array.isArray(c))for(var l=u.groups,d=0,f=l.length;d<f;d++){var p=l[d],h=c[p.materialIndex];if(h&&h.visible){var v=g(n,0,h,a,o.near,o.far,s);e.renderBufferDirect(o,null,u,v,n,p)}}else if(c.visible){var m=g(n,0,c,a,o.near,o.far,s);e.renderBufferDirect(o,null,u,m,n,null)}}for(var y=n.children,x=0,_=y.length;x<_;x++)b(y[x],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=k,this.render=function(t,n,s){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.state;f.setBlending(D),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var p=0,h=t.length;p<h;p++){var v=t[p],g=v.shadow;if(void 0!==g){if(!1!==g.autoUpdate||!1!==g.needsUpdate){i.copy(g.mapSize);var x=g.getFrameExtents();if(i.multiply(x),o.copy(g.mapSize),(i.x>l||i.y>l)&&(i.x>l&&(o.x=Math.floor(l/x.x),i.x=o.x*x.x,g.mapSize.x=o.x),i.y>l&&(o.y=Math.floor(l/x.y),i.y=o.y*x.y,g.mapSize.y=o.y)),null===g.map&&!g.isPointLightShadow&&this.type===P){var _={minFilter:De,magFilter:De,format:et};g.map=new Tr(i.x,i.y,_),g.map.texture.name=v.name+".shadowMap",g.mapPass=new Tr(i.x,i.y,_),g.camera.updateProjectionMatrix()}if(null===g.map){var w={minFilter:Ce,magFilter:Ce,format:et};g.map=new Tr(i.x,i.y,w),g.map.texture.name=v.name+".shadowMap",g.camera.updateProjectionMatrix()}e.setRenderTarget(g.map),e.clear();for(var M=g.getViewportCount(),S=0;S<M;S++){var T=g.getViewport(S);a.set(o.x*T.x,o.y*T.y,o.x*T.z,o.y*T.w),f.viewport(a),g.updateMatrices(v,S),r=g.getFrustum(),b(n,s,g.camera,v,this.type)}g.isPointLightShadow||this.type!==P||y(g,s),g.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(u,c,d)}}}function Ru(e,t,n){var r,i,o=n.isWebGL2,s=new function(){var t=!1,n=new Sr,r=null,i=new Sr(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},u=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?_e(2929):we(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case re:e.depthFunc(512);break;case ie:e.depthFunc(519);break;case oe:e.depthFunc(513);break;case ae:e.depthFunc(515);break;case se:e.depthFunc(514);break;case ue:e.depthFunc(518);break;case ce:e.depthFunc(516);break;case le:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},c=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(e){t||(e?_e(2960):we(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&u===r||(e.stencilOp(t,n,r),a=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null}}},l={},d=null,f={},p=null,h=!1,v=null,m=null,y=null,g=null,b=null,x=null,_=null,T=!1,E=null,k=null,A=null,P=null,C=null,R=e.getParameter(35661),N=!1,de=0,fe=e.getParameter(7938);-1!==fe.indexOf("WebGL")?(de=parseFloat(/^WebGL (\d)/.exec(fe)[1]),N=de>=1):-1!==fe.indexOf("OpenGL ES")&&(de=parseFloat(/^OpenGL ES (\d)/.exec(fe)[1]),N=de>=2);var pe=null,he={},ve=e.getParameter(3088),me=e.getParameter(2978),ye=(new Sr).fromArray(ve),ge=(new Sr).fromArray(me);function be(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var a=0;a<r;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var xe={};function _e(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function we(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}xe[3553]=be(3553,3553,1),xe[34067]=be(34067,34069,6),s.setClear(0,0,0,1),u.setClear(1),c.setClear(0),_e(2929),u.setFunc(ae),ke(!1),Ae(M),_e(2884),Ee(D);var Me=(r={},(0,a.Z)(r,U,32774),(0,a.Z)(r,G,32778),(0,a.Z)(r,V,32779),r);if(o)Me[W]=32775,Me[H]=32776;else{var Se=t.get("EXT_blend_minmax");null!==Se&&(Me[W]=Se.MIN_EXT,Me[H]=Se.MAX_EXT)}var Te=(i={},(0,a.Z)(i,Z,0),(0,a.Z)(i,q,1),(0,a.Z)(i,Y,768),(0,a.Z)(i,K,770),(0,a.Z)(i,ne,776),(0,a.Z)(i,ee,774),(0,a.Z)(i,Q,772),(0,a.Z)(i,X,769),(0,a.Z)(i,J,771),(0,a.Z)(i,te,775),(0,a.Z)(i,$,773),i);function Ee(t,n,r,i,o,a,s,u){if(t!==D){if(!1===h&&(_e(3042),h=!0),t===z)o=o||n,a=a||r,s=s||i,n===m&&o===b||(e.blendEquationSeparate(Me[n],Me[o]),m=n,b=o),r===y&&i===g&&a===x&&s===_||(e.blendFuncSeparate(Te[r],Te[i],Te[a],Te[s]),y=r,g=i,x=a,_=s),v=t,T=null;else if(t!==v||u!==T){if(m===U&&b===U||(e.blendEquation(32774),m=U,b=U),u)switch(t){case L:e.blendFuncSeparate(1,771,1,771);break;case B:e.blendFunc(1,1);break;case F:e.blendFuncSeparate(0,0,769,771);break;case j:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case L:e.blendFuncSeparate(770,771,1,771);break;case B:e.blendFunc(770,1);break;case F:e.blendFunc(0,769);break;case j:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}y=null,g=null,x=null,_=null,v=t,T=u}}else!0===h&&(we(3042),h=!1)}function ke(t){E!==t&&(t?e.frontFace(2304):e.frontFace(2305),E=t)}function Ae(t){t!==w?(_e(2884),t!==k&&(t===M?e.cullFace(1029):t===S?e.cullFace(1028):e.cullFace(1032))):we(2884),k=t}function Pe(t,n,r){t?(_e(32823),P===n&&C===r||(e.polygonOffset(n,r),P=n,C=r)):we(32823)}function Ce(t){void 0===t&&(t=33984+R-1),pe!==t&&(e.activeTexture(t),pe=t)}return{buffers:{color:s,depth:u,stencil:c},enable:_e,disable:we,bindFramebuffer:function(t,n){return null===n&&null!==d&&(n=d),f[t]!==n&&(e.bindFramebuffer(t,n),f[t]=n,o&&(36009===t&&(f[36160]=n),36160===t&&(f[36009]=n)),!0)},bindXRFramebuffer:function(t){t!==d&&(e.bindFramebuffer(36160,t),d=t)},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:Ee,setMaterial:function(e,t){e.side===I?we(2884):_e(2884);var n=e.side===O;t&&(n=!n),ke(n),e.blending===L&&!1===e.transparent?Ee(D):Ee(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),u.setFunc(e.depthFunc),u.setTest(e.depthTest),u.setMask(e.depthWrite),s.setMask(e.colorWrite);var r=e.stencilWrite;c.setTest(r),r&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Pe(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?_e(32926):we(32926)},setFlipSided:ke,setCullFace:Ae,setLineWidth:function(t){t!==A&&(N&&e.lineWidth(t),A=t)},setPolygonOffset:Pe,setScissorTest:function(e){e?_e(3089):we(3089)},activeTexture:Ce,bindTexture:function(t,n){null===pe&&Ce();var r=he[pe];void 0===r&&(r={type:void 0,texture:void 0},he[pe]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||xe[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=he[pe];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===ye.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ye.copy(t))},viewport:function(t){!1===ge.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ge.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===o&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},pe=null,he={},d=null,f={},p=null,h=!1,v=null,m=null,y=null,g=null,b=null,x=null,_=null,T=!1,E=null,k=null,A=null,P=null,C=null,ye.set(0,0,e.canvas.width,e.canvas.height),ge.set(0,0,e.canvas.width,e.canvas.height),s.reset(),u.reset(),c.reset()}}}function Nu(e,t,n,r,i,o,s){var u,c,l,d=i.isWebGL2,f=i.maxTextures,p=i.maxCubemapSize,h=i.maxTextureSize,v=i.maxSamples,m=new WeakMap,y=!1;try{y="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function g(e,t){return y?new OffscreenCanvas(e,t):br("canvas")}function b(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var o=t?dr:Math.floor,a=o(i*e.width),s=o(i*e.height);void 0===l&&(l=g(a,s));var u=n?g(a,s):l;return u.width=a,u.height=s,u.getContext("2d").drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return cr(e.width)&&cr(e.height)}function _(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ce&&e.minFilter!==De}function w(t,n,i,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.generateMipmap(t);var s=r.get(n);s.__maxMipLevel=Math.log2(Math.max(i,o,a))}function M(n,r,i,o){if(!1===d)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=o===hn?35907:32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function S(e){return e===Ce||e===Oe||e===Re?9728:9729}function T(t){var n=t.target;n.removeEventListener("dispose",T),function(t){var n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(n),n.isVideoTexture&&m.delete(n),s.memory.textures--}function E(t){var n=t.target;n.removeEventListener("dispose",E),function(t){var n=t.texture,i=r.get(t),o=r.get(n);if(t){if(void 0!==o.__webglTexture&&(e.deleteTexture(o.__webglTexture),s.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)e.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[a]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(var u=0,c=n.length;u<c;u++){var l=r.get(n[u]);l.__webglTexture&&(e.deleteTexture(l.__webglTexture),s.memory.textures--),r.remove(n[u])}r.remove(n),r.remove(t)}}(n)}var k=0;function A(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=s.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var o=e.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void N(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function P(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?function(t,r,i){if(6===r.image.length){R(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var a=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,u=[],c=0;c<6;c++)u[c]=a||s?s?r.image[c].image:r.image[c]:b(r.image[c],!1,!0,p);var l,f=u[0],h=x(f)||d,v=o.convert(r.format),m=o.convert(r.type),y=M(r.internalFormat,v,m,r.encoding);if(I(34067,r,h),a){for(var g=0;g<6;g++){l=u[g].mipmaps;for(var S=0;S<l.length;S++){var T=l[S];r.format!==et&&r.format!==$e?null!==v?n.compressedTexImage2D(34069+g,S,y,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+g,S,y,T.width,T.height,0,v,m,T.data)}}t.__maxMipLevel=l.length-1}else{l=r.mipmaps;for(var E=0;E<6;E++)if(s){n.texImage2D(34069+E,0,y,u[E].width,u[E].height,0,v,m,u[E].data);for(var k=0;k<l.length;k++){var A=l[k].image[E].image;n.texImage2D(34069+E,k+1,y,A.width,A.height,0,v,m,A.data)}}else{n.texImage2D(34069+E,0,y,v,m,u[E]);for(var P=0;P<l.length;P++){var C=l[P];n.texImage2D(34069+E,P+1,y,v,m,C.image[E])}}t.__maxMipLevel=l.length}_(r,h)&&w(34067,r,f.width,f.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}}(a,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture))}var C=(u={},(0,a.Z)(u,ke,10497),(0,a.Z)(u,Ae,33071),(0,a.Z)(u,Pe,33648),u),O=(c={},(0,a.Z)(c,Ce,9728),(0,a.Z)(c,Oe,9984),(0,a.Z)(c,Re,9986),(0,a.Z)(c,De,9729),(0,a.Z)(c,Le,9985),(0,a.Z)(c,Fe,9987),c);function I(n,o,a){if(a?(e.texParameteri(n,10242,C[o.wrapS]),e.texParameteri(n,10243,C[o.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[o.wrapR]),e.texParameteri(n,10240,O[o.magFilter]),e.texParameteri(n,10241,O[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===Ae&&o.wrapT===Ae||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,S(o.magFilter)),e.texParameteri(n,10241,S(o.minFilter)),o.minFilter!==Ce&&o.minFilter!==De&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(o.type===Ze&&!1===t.has("OES_texture_float_linear"))return;if(!1===d&&o.type===qe&&!1===t.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function R(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",T),t.__webglTexture=e.createTexture(),s.memory.textures++)}function N(t,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),R(t,r),n.activeTexture(33984+i),n.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var s,u=function(e){return!d&&(e.wrapS!==Ae||e.wrapT!==Ae||e.minFilter!==Ce&&e.minFilter!==De)}(r)&&!1===x(r.image),c=b(r.image,u,!1,h),l=x(c)||d,f=o.convert(r.format),p=o.convert(r.type),v=M(r.internalFormat,f,p,r.encoding);I(a,r,l);var m=r.mipmaps;if(r.isDepthTexture)v=6402,d?v=r.type===Ze?36012:r.type===He?33190:r.type===Je?35056:33189:r.type===Ze&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===it&&6402===v&&r.type!==Ve&&r.type!==He&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Ve,p=o.convert(r.type)),r.format===ot&&6402===v&&(v=34041,r.type!==Je&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Je,p=o.convert(r.type))),n.texImage2D(3553,0,v,c.width,c.height,0,f,p,null);else if(r.isDataTexture)if(m.length>0&&l){for(var y=0,g=m.length;y<g;y++)s=m[y],n.texImage2D(3553,y,v,s.width,s.height,0,f,p,s.data);r.generateMipmaps=!1,t.__maxMipLevel=m.length-1}else n.texImage2D(3553,0,v,c.width,c.height,0,f,p,c.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var S=0,T=m.length;S<T;S++)s=m[S],r.format!==et&&r.format!==$e?null!==f?n.compressedTexImage2D(3553,S,v,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,S,v,s.width,s.height,0,f,p,s.data);t.__maxMipLevel=m.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,v,c.width,c.height,c.depth,0,f,p,c.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,v,c.width,c.height,c.depth,0,f,p,c.data),t.__maxMipLevel=0;else if(m.length>0&&l){for(var E=0,k=m.length;E<k;E++)s=m[E],n.texImage2D(3553,E,v,f,p,s);r.generateMipmaps=!1,t.__maxMipLevel=m.length-1}else n.texImage2D(3553,0,v,f,p,c),t.__maxMipLevel=0;_(r,l)&&w(a,r,c.width,c.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function D(t,i,a,s,u){var c=o.convert(a.format),l=o.convert(a.type),d=M(a.internalFormat,c,l,a.encoding);32879===u||35866===u?n.texImage3D(u,0,d,i.width,i.height,i.depth,0,c,l,null):n.texImage2D(u,0,d,i.width,i.height,0,c,l,null),n.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,s,u,r.get(a).__webglTexture,0),n.bindFramebuffer(36160,null)}function L(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var a=n.depthTexture;a&&a.isDepthTexture&&(a.type===Ze?i=36012:a.type===He&&(i=33190));var s=B(n);e.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var u=B(n);e.renderbufferStorageMultisample(36161,u,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var c=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,l=o.convert(c.format),d=o.convert(c.type),f=M(c.internalFormat,l,d,c.encoding);if(r){var p=B(n);e.renderbufferStorageMultisample(36161,p,f,n.width,n.height)}else e.renderbufferStorage(36161,f,n.width,n.height)}e.bindRenderbuffer(36161,null)}function B(e){return d&&e.isWebGLMultisampleRenderTarget?Math.min(v,e.samples):0}var F=!1,j=!1;this.allocateTextureUnit=function(){var e=k;return e>=f&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+f),k+=1,e},this.resetTextureUnits=function(){k=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?N(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?N(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=P,this.setupRenderTarget=function(t){var a=t.texture,u=r.get(t),c=r.get(a);t.addEventListener("dispose",E),!0!==t.isWebGLMultipleRenderTargets&&(c.__webglTexture=e.createTexture(),c.__version=a.version,s.memory.textures++);var l=!0===t.isWebGLCubeRenderTarget,f=!0===t.isWebGLMultipleRenderTargets,p=!0===t.isWebGLMultisampleRenderTarget,h=a.isDataTexture3D||a.isDataTexture2DArray,v=x(t)||d;if(!d||a.format!==$e||a.type!==Ze&&a.type!==qe||(a.format=et,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),l){u.__webglFramebuffer=[];for(var m=0;m<6;m++)u.__webglFramebuffer[m]=e.createFramebuffer()}else if(u.__webglFramebuffer=e.createFramebuffer(),f)if(i.drawBuffers)for(var y=t.texture,g=0,b=y.length;g<b;g++){var S=r.get(y[g]);void 0===S.__webglTexture&&(S.__webglTexture=e.createTexture(),s.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(p)if(d){u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,u.__webglColorRenderbuffer);var T=o.convert(a.format),k=o.convert(a.type),P=M(a.internalFormat,T,k,a.encoding),C=B(t);e.renderbufferStorageMultisample(36161,C,P,t.width,t.height),n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,u.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),L(u.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){n.bindTexture(34067,c.__webglTexture),I(34067,a,v);for(var O=0;O<6;O++)D(u.__webglFramebuffer[O],t,a,36064,34069+O);_(a,v)&&w(34067,a,t.width,t.height),n.unbindTexture()}else if(f){for(var R=t.texture,N=0,F=R.length;N<F;N++){var j=R[N],z=r.get(j);n.bindTexture(3553,z.__webglTexture),I(3553,j,v),D(u.__webglFramebuffer,t,j,36064+N,3553),_(j,v)&&w(3553,j,t.width,t.height)}n.unbindTexture()}else{var U=3553;h&&(d?U=a.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(U,c.__webglTexture),I(U,a,v),D(u.__webglFramebuffer,t,a,36064,U),_(a,v)&&w(U,a,t.width,t.height,t.depth),n.unbindTexture()}t.depthBuffer&&function(t){var i=r.get(t),o=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),A(i.depthTexture,0);var o=r.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===it)e.framebufferTexture2D(36160,36096,3553,o,0);else{if(i.depthTexture.format!==ot)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,o,0)}}(i.__webglFramebuffer,t)}else if(o){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)n.bindFramebuffer(36160,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=e.createRenderbuffer(),L(i.__webglDepthbuffer[a],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),L(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){for(var t=x(e)||d,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture],o=0,a=i.length;o<a;o++){var s=i[o];if(_(s,t)){var u=e.isWebGLCubeRenderTarget?34067:3553,c=r.get(s).__webglTexture;n.bindTexture(u,c),w(u,s,e.width,e.height),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(d){var i=t.width,o=t.height,a=16384;t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024);var s=r.get(t);n.bindFramebuffer(36008,s.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,s.__webglFramebuffer),e.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,s.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===j&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),j=!0),e=e.texture),P(e,t)}}function Du(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===ze)return 5121;if(e===Ye)return 32819;if(e===Xe)return 32820;if(e===Ke)return 33635;if(e===Ue)return 5120;if(e===Ge)return 5122;if(e===Ve)return 5123;if(e===We)return 5124;if(e===He)return 5125;if(e===Ze)return 5126;if(e===qe)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===Qe)return 6406;if(e===$e)return 6407;if(e===et)return 6408;if(e===tt)return 6409;if(e===nt)return 6410;if(e===it)return 6402;if(e===ot)return 34041;if(e===at)return 6403;if(e===st)return 36244;if(e===ut)return 33319;if(e===ct)return 33320;if(e===lt)return 36248;if(e===dt)return 36249;if(e===ft||e===pt||e===ht||e===vt){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===ft)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===pt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===ht)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===vt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===mt||e===yt||e===gt||e===bt){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===mt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===yt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===gt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===bt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===xt)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===_t||e===wt)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===_t)return n.COMPRESSED_RGB8_ETC2;if(e===wt)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===Mt||e===St||e===Tt||e===Et||e===kt||e===At||e===Pt||e===Ct||e===Ot||e===It||e===Rt||e===Nt||e===Dt||e===Lt||e===Ft||e===jt||e===zt||e===Ut||e===Gt||e===Vt||e===Wt||e===Ht||e===Zt||e===qt||e===Yt||e===Xt||e===Kt||e===Jt?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===Bt?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===Je?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}Ou.prototype.isMeshDistanceMaterial=!0;var Lu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,v.Z)(this,n),(e=t.call(this)).cameras=r,e}return(0,m.Z)(n)}(Zo);Lu.prototype.isArrayCamera=!0;var Bu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="Group",e}return(0,m.Z)(n)}(Oi);Bu.prototype.isGroup=!0;var Fu={type:"move"},ju=function(){function e(){(0,v.Z)(this,e),this._targetRay=null,this._grip=null,this._hand=null}return(0,m.Z)(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new Bu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new Bu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Pr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Pr),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new Bu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Pr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Pr),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,s=this._targetRay,u=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==s&&null!==(r=t.getPose(e.targetRaySpace,n))&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Fu)),c&&e.hand){a=!0;var l,d=(0,o.Z)(e.hand.values());try{for(d.s();!(l=d.n()).done;){var f=l.value,p=t.getJointPose(f,n);if(void 0===c.joints[f.jointName]){var h=new Bu;h.matrixAutoUpdate=!1,h.visible=!1,c.joints[f.jointName]=h,c.add(h)}var v=c.joints[f.jointName];null!==p&&(v.matrix.fromArray(p.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=p.radius),v.visible=null!==p}}catch(e){d.e(e)}finally{d.f()}var m=c.joints["index-finger-tip"],y=c.joints["thumb-tip"],g=m.position.distanceTo(y.position);c.inputState.pinching&&g>.025?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&g<=.015&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==u&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1);return null!==s&&(s.visible=null!==r),null!==u&&(u.visible=null!==i),null!==c&&(c.visible=null!==a),this}}]),e}(),zu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var o;(0,v.Z)(this,n),o=t.call(this);var a=(0,f.Z)(o),s=e.state,u=null,c=1,l=null,d="local-floor",p=null,h=null,m=null,y=null,b=null,x=!1,_=null,w=null,M=null,S=null,T=null,E=null,k=e.extensions.has("EXT_multisampled_render_to_texture"),A=null,P=[],C=new Map,O=new Zo;O.layers.enable(1),O.viewport=new Sr;var I=new Zo;I.layers.enable(2),I.viewport=new Sr;var R=[O,I],N=new Lu;N.layers.enable(1),N.layers.enable(2);var D=null,L=null;function B(e){var t=C.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function F(){C.forEach((function(e,t){e.disconnect(t)})),C.clear(),D=null,L=null,s.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),m&&r.deleteFramebuffer(m),_&&r.deleteFramebuffer(_),w&&r.deleteRenderbuffer(w),M&&r.deleteRenderbuffer(M),m=null,_=null,w=null,M=null,b=null,y=null,h=null,u=null,W.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function j(e){for(var t=u.inputSources,n=0;n<P.length;n++)C.set(t[n],P[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],o=C.get(i);o&&(o.dispatchEvent({type:"disconnected",data:i}),C.delete(i))}for(var a=0;a<e.added.length;a++){var s=e.added[a],c=C.get(s);c&&c.dispatchEvent({type:"connected",data:s})}}o.cameraAutoUpdate=!0,o.enabled=!1,o.isPresenting=!1,o.getController=function(e){var t=P[e];return void 0===t&&(t=new ju,P[e]=t),t.getTargetRaySpace()},o.getControllerGrip=function(e){var t=P[e];return void 0===t&&(t=new ju,P[e]=t),t.getGripSpace()},o.getHand=function(e){var t=P[e];return void 0===t&&(t=new ju,P[e]=t),t.getHandSpace()},o.setFramebufferScaleFactor=function(e){c=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},o.setReferenceSpaceType=function(e){d=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},o.getReferenceSpace=function(){return l},o.getBaseLayer=function(){return null!==y?y:b},o.getBinding=function(){return h},o.getFrame=function(){return S},o.getSession=function(){return u},o.setSession=function(){var t=(0,i.Z)(g().mark((function t(n){var i,o,f,p,v;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(u=n)){t.next=22;break}if(u.addEventListener("select",B),u.addEventListener("selectstart",B),u.addEventListener("selectend",B),u.addEventListener("squeeze",B),u.addEventListener("squeezestart",B),u.addEventListener("squeezeend",B),u.addEventListener("end",F),u.addEventListener("inputsourceschange",j),!0===(i=r.getContextAttributes()).xrCompatible){t.next=14;break}return t.next=14,r.makeXRCompatible();case 14:return void 0===u.renderState.layers?(o={antialias:i.antialias,alpha:i.alpha,depth:i.depth,stencil:i.stencil,framebufferScaleFactor:c},b=new XRWebGLLayer(u,r,o),u.updateRenderState({baseLayer:b})):r instanceof WebGLRenderingContext?(f={antialias:!0,alpha:i.alpha,depth:i.depth,stencil:i.stencil,framebufferScaleFactor:c},b=new XRWebGLLayer(u,r,f),u.updateRenderState({layers:[b]})):(x=i.antialias,p=null,i.depth&&(E=256,i.stencil&&(E|=1024),T=i.stencil?33306:36096,p=i.stencil?35056:33190),v={colorFormat:i.alpha?32856:32849,depthFormat:p,scaleFactor:c},h=new XRWebGLBinding(u,r),y=h.createProjectionLayer(v),m=r.createFramebuffer(),u.updateRenderState({layers:[y]}),x&&k?A=e.extensions.get("EXT_multisampled_render_to_texture"):x&&(_=r.createFramebuffer(),w=r.createRenderbuffer(),r.bindRenderbuffer(36161,w),r.renderbufferStorageMultisample(36161,4,32856,y.textureWidth,y.textureHeight),s.bindFramebuffer(36160,_),r.framebufferRenderbuffer(36160,36064,36161,w),r.bindRenderbuffer(36161,null),null!==p&&(M=r.createRenderbuffer(),r.bindRenderbuffer(36161,M),r.renderbufferStorageMultisample(36161,4,p,y.textureWidth,y.textureHeight),r.framebufferRenderbuffer(36160,T,36161,M),r.bindRenderbuffer(36161,null)),s.bindFramebuffer(36160,null))),t.next=17,u.requestReferenceSpace(d);case 17:l=t.sent,W.setContext(u),W.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var z=new Pr,U=new Pr;function G(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}o.updateCamera=function(e){if(null!==u){N.near=I.near=O.near=e.near,N.far=I.far=O.far=e.far,D===N.near&&L===N.far||(u.updateRenderState({depthNear:N.near,depthFar:N.far}),D=N.near,L=N.far);var t=e.parent,n=N.cameras;G(N,t);for(var r=0;r<n.length;r++)G(n[r],t);N.matrixWorld.decompose(N.position,N.quaternion,N.scale),e.position.copy(N.position),e.quaternion.copy(N.quaternion),e.scale.copy(N.scale),e.matrix.copy(N.matrix),e.matrixWorld.copy(N.matrixWorld);for(var i=e.children,o=0,a=i.length;o<a;o++)i[o].updateMatrixWorld(!0);2===n.length?function(e,t,n){z.setFromMatrixPosition(t.matrixWorld),U.setFromMatrixPosition(n.matrixWorld);var r=z.distanceTo(U),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],d=(o[8]+1)/o[0],f=a*l,p=a*d,h=r/(-l+d),v=h*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(v),e.translateZ(h),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var m=a+h,y=s+h,g=f-v,b=p+(r-v),x=u*s/y*m,_=c*s/y*m;e.projectionMatrix.makePerspective(g,b,x,_,m,y)}(N,O,I):N.projectionMatrix.copy(O.projectionMatrix)}},o.getCamera=function(){return N},o.getFoveation=function(){return null!==y?y.fixedFoveation:null!==b?b.fixedFoveation:void 0},o.setFoveation=function(e){null!==y&&(y.fixedFoveation=e),null!==b&&void 0!==b.fixedFoveation&&(b.fixedFoveation=e)};var V=null,W=new ia;return W.setAnimationLoop((function(e,t){if(p=t.getViewerPose(l),S=t,null!==p){var n=p.views;null!==b&&s.bindXRFramebuffer(b.framebuffer);var i=!1;n.length!==N.cameras.length&&(N.cameras.length=0,i=!0);for(var o=0;o<n.length;o++){var a=n[o],c=null;if(null!==b)c=b.getViewport(a);else{var d=h.getViewSubImage(y,a);s.bindXRFramebuffer(m),x&&k?(void 0!==d.depthStencilTexture&&A.framebufferTexture2DMultisampleEXT(36160,T,3553,d.depthStencilTexture,0,4),A.framebufferTexture2DMultisampleEXT(36160,36064,3553,d.colorTexture,0,4)):(void 0!==d.depthStencilTexture&&r.framebufferTexture2D(36160,T,3553,d.depthStencilTexture,0),r.framebufferTexture2D(36160,36064,3553,d.colorTexture,0)),c=d.viewport}var f=R[o];f.matrix.fromArray(a.transform.matrix),f.projectionMatrix.fromArray(a.projectionMatrix),f.viewport.set(c.x,c.y,c.width,c.height),0===o&&N.matrix.copy(f.matrix),!0===i&&N.cameras.push(f)}x&&!k&&(s.bindXRFramebuffer(_),null!==E&&r.clear(E))}for(var v=u.inputSources,g=0;g<P.length;g++){var w=P[g],M=v[g];w.update(M,t,l)}if(V&&V(e,t),x&&!k){var C=y.textureWidth,O=y.textureHeight;s.bindFramebuffer(36008,_),s.bindFramebuffer(36009,m),r.invalidateFramebuffer(36008,[T]),r.invalidateFramebuffer(36009,[T]),r.blitFramebuffer(0,0,C,O,0,0,C,O,16384,9728),r.invalidateFramebuffer(36008,[36064]),s.bindFramebuffer(36008,null),s.bindFramebuffer(36009,null),s.bindFramebuffer(36160,_)}S=null})),o.setAnimationLoop=function(e){V=e},o.dispose=function(){},o}return(0,m.Z)(n)}(Qn);function Uu(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap),n.alphaTest>0&&(t.alphaTest.value=n.alphaTest);var r,i,o=e.get(n).envMap;if(o){t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,t.reflectivity.value=n.reflectivity,t.ior.value=n.ior,t.refractionRatio.value=n.refractionRatio;var a=e.get(o).__maxMipLevel;void 0!==a&&(t.maxMipLevel.value=a)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularTintMap?r=n.specularTintMap:n.transmissionMap?r=n.transmissionMap:n.thicknessMap&&(r=n.thicknessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===O&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===O&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,o,a){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===O&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===O&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===O&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===O&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t,r){n(e,t),e.ior.value=t.ior,t.sheen>0&&(e.sheenTint.value.copy(t.sheenTint).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===O&&e.clearcoatNormalScale.value.negate())),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationTint.value.copy(t.attenuationTint)),e.specularIntensity.value=t.specularIntensity,e.specularTint.value.copy(t.specularTint),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularTintMap&&(e.specularTintMap.value=t.specularTintMap)}(e,r,a):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===O&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===O&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===O&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===O&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){var i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,o):r.isSpriteMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Gu(){var e=br("canvas");return e.style.display="block",e}function Vu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0!==e.canvas?e.canvas:Gu(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",l=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,d=null,f=null,p=[],h=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=pn,this.physicallyCorrectLights=!1,this.toneMapping=he,this.toneMappingExposure=1;var v=this,m=!1,y=0,g=0,b=null,x=-1,_=null,w=new Sr,M=new Sr,S=null,T=t.width,E=t.height,k=1,A=null,P=null,R=new Sr(0,0,T,E),N=new Sr(0,0,T,E),D=!1,L=[],B=new ra,F=!1,j=!1,z=null,U=new ai,G=new Pr,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===b?k:1}var H,Z,q,Y,X,K,J,Q,$,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,de,fe,pe,ve=n;function me(e,n){for(var r=0;r<e.length;r++){var i=e[r],o=t.getContext(i,n);if(null!==o)return o}return null}try{var ye={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:l};if(t.addEventListener("webglcontextlost",_e,!1),t.addEventListener("webglcontextrestored",we,!1),null===ve){var ge=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&ge.shift(),null===(ve=me(ge,ye)))throw me(ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ve.getShaderPrecisionFormat&&(ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function be(){H=new za(ve),Z=new pa(ve,H,e),H.init(Z),fe=new Du(ve,H,Z),q=new Ru(ve,H,Z),L[0]=1029,Y=new Va(ve),X=new bu,K=new Nu(ve,H,q,X,Z,fe,Y),J=new va(v),Q=new ja(v),$=new oa(ve,Z),pe=new da(ve,H,$,Z),ee=new Ua(ve,$,Y,pe),te=new Xa(ve,ee,$,Y),ce=new Ya(ve,Z,K),ae=new ha(X),ne=new gu(v,J,Q,H,Z,pe,ae),re=new Uu(X),ie=new Mu(X),oe=new Pu(H,Z),ue=new la(v,J,q,te,s),se=new Iu(v,te,Z),le=new fa(ve,H,Y,Z),de=new Ga(ve,H,Y,Z),Y.programs=ne.programs,v.capabilities=Z,v.extensions=H,v.properties=X,v.renderLists=ie,v.shadowMap=se,v.state=q,v.info=Y}be();var xe=new zu(v,ve);function _e(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function we(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;var e=Y.autoReset,t=se.enabled,n=se.autoUpdate,r=se.needsUpdate,i=se.type;be(),Y.autoReset=e,se.enabled=t,se.autoUpdate=n,se.needsUpdate=r,se.type=i}function Me(e){var t=e.target;t.removeEventListener("dispose",Me),Se(t)}function Se(e){Te(e),X.remove(e)}function Te(e){var t=X.get(e).programs;void 0!==t&&t.forEach((function(e){ne.releaseProgram(e)}))}function Ee(e,t){e.render((function(e){v.renderBufferImmediate(e,t)}))}this.xr=xe,this.getContext=function(){return ve},this.getContextAttributes=function(){return ve.getContextAttributes()},this.forceContextLoss=function(){var e=H.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=H.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(e){void 0!==e&&(k=e,this.setSize(T,E,!1))},this.getSize=function(e){return e.set(T,E)},this.setSize=function(e,n,r){xe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(T=e,E=n,t.width=Math.floor(e*k),t.height=Math.floor(n*k),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(T*k,E*k).floor()},this.setDrawingBufferSize=function(e,n,r){T=e,E=n,k=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(w)},this.getViewport=function(e){return e.copy(R)},this.setViewport=function(e,t,n,r){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,r),q.viewport(w.copy(R).multiplyScalar(k).floor())},this.getScissor=function(e){return e.copy(N)},this.setScissor=function(e,t,n,r){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,r),q.scissor(M.copy(N).multiplyScalar(k).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(e){q.setScissorTest(D=e)},this.setOpaqueSort=function(e){A=e},this.setTransparentSort=function(e){P=e},this.getClearColor=function(e){return e.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ve.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",_e,!1),t.removeEventListener("webglcontextrestored",we,!1),ie.dispose(),oe.dispose(),X.dispose(),J.dispose(),Q.dispose(),te.dispose(),pe.dispose(),xe.dispose(),xe.removeEventListener("sessionstart",Oe),xe.removeEventListener("sessionend",Ie),z&&(z.dispose(),z=null),Re.stop()},this.renderBufferImmediate=function(e,t){pe.initAttributes();var n=X.get(e);e.hasPositions&&!n.position&&(n.position=ve.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ve.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ve.createBuffer()),e.hasColors&&!n.color&&(n.color=ve.createBuffer());var r=t.getAttributes();e.hasPositions&&(ve.bindBuffer(34962,n.position),ve.bufferData(34962,e.positionArray,35048),pe.enableAttribute(r.position.location),ve.vertexAttribPointer(r.position.location,3,5126,!1,0,0)),e.hasNormals&&(ve.bindBuffer(34962,n.normal),ve.bufferData(34962,e.normalArray,35048),pe.enableAttribute(r.normal.location),ve.vertexAttribPointer(r.normal.location,3,5126,!1,0,0)),e.hasUvs&&(ve.bindBuffer(34962,n.uv),ve.bufferData(34962,e.uvArray,35048),pe.enableAttribute(r.uv.location),ve.vertexAttribPointer(r.uv.location,2,5126,!1,0,0)),e.hasColors&&(ve.bindBuffer(34962,n.color),ve.bufferData(34962,e.colorArray,35048),pe.enableAttribute(r.color.location),ve.vertexAttribPointer(r.color.location,3,5126,!1,0,0)),pe.disableUnusedAttributes(),ve.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=V);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=Ve(e,t,r,i);q.setMaterial(r,a);var u=n.index,c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;var l,d=1;!0===r.wireframe&&(u=ee.getWireframeAttribute(n),d=2),void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||ce.update(i,n,r,s),pe.setup(i,r,s,n,u);var f=le;null!==u&&(l=$.get(u),(f=de).setIndex(l));var p=null!==u?u.count:c.count,h=n.drawRange.start*d,v=n.drawRange.count*d,m=null!==o?o.start*d:0,y=null!==o?o.count*d:1/0,g=Math.max(h,m),b=Math.min(p,h+v,m+y)-1,x=Math.max(0,b-g+1);if(0!==x){if(i.isMesh)!0===r.wireframe?(q.setLineWidth(r.wireframeLinewidth*W()),f.setMode(1)):f.setMode(4);else if(i.isLine){var _=r.linewidth;void 0===_&&(_=1),q.setLineWidth(_*W()),i.isLineSegments?f.setMode(1):i.isLineLoop?f.setMode(2):f.setMode(3)}else i.isPoints?f.setMode(0):i.isSprite&&f.setMode(4);if(i.isInstancedMesh)f.renderInstances(g,x,i.count);else if(n.isInstancedBufferGeometry){var w=Math.min(n.instanceCount,n._maxInstanceCount);f.renderInstances(g,x,w)}else f.render(g,x)}},this.compile=function(e,t){(f=oe.get(e)).init(),h.push(f),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(v.physicallyCorrectLights),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++)Ue(n[r],e,t);else Ue(n,e,t)})),h.pop(),f=null};var ke=null;function Pe(e){ke&&ke(e)}function Oe(){Re.stop()}function Ie(){Re.start()}var Re=new ia;function Ne(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||B.intersectsSprite(e)){r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(U);var i=te.update(e),o=e.material;o.visible&&d.push(e,i,o,n,G.z,null)}}else if(e.isImmediateRenderObject)r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(U),d.push(e,null,e.material,n,G.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Y.render.frame&&(e.skeleton.update(),e.skeleton.frame=Y.render.frame),!e.frustumCulled||B.intersectsObject(e))){r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(U);var a=te.update(e),s=e.material;if(Array.isArray(s))for(var u=a.groups,c=0,l=u.length;c<l;c++){var p=u[c],h=s[p.materialIndex];h&&h.visible&&d.push(e,a,h,n,G.z,p)}else s.visible&&d.push(e,a,s,n,G.z,null)}for(var v=e.children,m=0,y=v.length;m<y;m++)Ne(v[m],t,n,r)}}function De(e,t,n,r){var i=e.opaque,o=e.transmissive,a=e.transparent;f.setupLightsView(n),o.length>0&&Le(i,t,n),r&&q.viewport(w.copy(r)),i.length>0&&Be(i,t,n),o.length>0&&Be(o,t,n),a.length>0&&Be(a,t,n)}function Le(e,t,n){if(null===z){var r=!0===a&&!0===Z.isWebGL2;z=new(r?kr:Tr)(1024,1024,{generateMipmaps:!0,type:null!==fe.convert(qe)?qe:ze,minFilter:Fe,magFilter:Ce,wrapS:Ae,wrapT:Ae})}var i=v.getRenderTarget();v.setRenderTarget(z),v.clear();var o=v.toneMapping;v.toneMapping=he,Be(e,t,n),v.toneMapping=o,K.updateMultisampleRenderTarget(z),K.updateRenderTargetMipmap(z),v.setRenderTarget(i)}function Be(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,u=a.geometry,c=null===r?a.material:r,l=a.group;s.layers.test(n.layers)&&je(s,t,n,u,c,l)}}function je(e,t,n,r,i,o){if(e.onBeforeRender(v,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(v,t,n,r,e,o),e.isImmediateRenderObject){var a=Ve(n,t,i,e);q.setMaterial(i),pe.reset(),Ee(e,a)}else!0===i.transparent&&i.side===I?(i.side=O,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,o),i.side=C,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,o),i.side=I):v.renderBufferDirect(n,t,r,i,e,o);e.onAfterRender(v,t,n,r,i,o)}function Ue(e,t,n){!0!==t.isScene&&(t=V);var r=X.get(e),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=ne.getParameters(e,i.state,o,t,n),u=ne.getProgramCacheKey(s),c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?Q:J).get(e.envMap||r.environment),void 0===c&&(e.addEventListener("dispose",Me),c=new Map,r.programs=c);var l=c.get(u);if(void 0!==l){if(r.currentProgram===l&&r.lightsStateVersion===a)return Ge(e,s),l}else s.uniforms=ne.getUniforms(e),e.onBuild(s,v),e.onBeforeCompile(s,v),l=ne.acquireProgram(s,u),c.set(u,l),r.uniforms=s.uniforms;var d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=ae.uniform),Ge(e,s),r.needsLights=He(e),r.lightsStateVersion=a,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);var p=l.getUniforms(),h=Qs.seqWithValue(p.seq,d);return r.currentProgram=l,r.uniformsList=h,l}function Ge(e,t){var n=X.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents}function Ve(e,t,n,r){!0!==t.isScene&&(t=V),K.resetTextureUnits();var i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=null===b?v.outputEncoding:b.texture.encoding,s=(n.isMeshStandardMaterial?Q:J).get(n.envMap||o),u=!0===n.vertexColors&&!!r.geometry&&!!r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,c=!!n.normalMap&&!!r.geometry&&!!r.geometry.attributes.tangent,l=!!r.geometry&&!!r.geometry.morphAttributes.position,d=!!r.geometry&&!!r.geometry.morphAttributes.normal,p=r.geometry&&r.geometry.morphAttributes.position?r.geometry.morphAttributes.position.length:0,h=X.get(n),m=f.state.lights;if(!0===F&&(!0===j||e!==_)){var y=e===_&&n.id===x;ae.setState(n,e,y)}var g=!1;n.version===h.__version?h.needsLights&&h.lightsStateVersion!==m.state.version||h.outputEncoding!==a||r.isInstancedMesh&&!1===h.instancing?g=!0:r.isInstancedMesh||!0!==h.instancing?r.isSkinnedMesh&&!1===h.skinning?g=!0:r.isSkinnedMesh||!0!==h.skinning?h.envMap!==s||n.fog&&h.fog!==i?g=!0:void 0===h.numClippingPlanes||h.numClippingPlanes===ae.numPlanes&&h.numIntersection===ae.numIntersection?(h.vertexAlphas!==u||h.vertexTangents!==c||h.morphTargets!==l||h.morphNormals!==d||!0===Z.isWebGL2&&h.morphTargetsCount!==p)&&(g=!0):g=!0:g=!0:g=!0:(g=!0,h.__version=n.version);var w=h.currentProgram;!0===g&&(w=Ue(n,t,r));var M=!1,S=!1,T=!1,A=w.getUniforms(),P=h.uniforms;if(q.useProgram(w.program)&&(M=!0,S=!0,T=!0),n.id!==x&&(x=n.id,S=!0),M||_!==e){if(A.setValue(ve,"projectionMatrix",e.projectionMatrix),Z.logarithmicDepthBuffer&&A.setValue(ve,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),_!==e&&(_=e,S=!0,T=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var C=A.map.cameraPosition;void 0!==C&&C.setValue(ve,G.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&A.setValue(ve,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||r.isSkinnedMesh)&&A.setValue(ve,"viewMatrix",e.matrixWorldInverse)}if(r.isSkinnedMesh){A.setOptional(ve,r,"bindMatrix"),A.setOptional(ve,r,"bindMatrixInverse");var O=r.skeleton;O&&(Z.floatVertexTextures?(null===O.boneTexture&&O.computeBoneTexture(),A.setValue(ve,"boneTexture",O.boneTexture,K),A.setValue(ve,"boneTextureSize",O.boneTextureSize)):A.setOptional(ve,O,"boneMatrices"))}return(S||h.receiveShadow!==r.receiveShadow)&&(h.receiveShadow=r.receiveShadow,A.setValue(ve,"receiveShadow",r.receiveShadow)),S&&(A.setValue(ve,"toneMappingExposure",v.toneMappingExposure),h.needsLights&&We(P,T),i&&n.fog&&re.refreshFogUniforms(P,i),re.refreshMaterialUniforms(P,n,k,E,z),Qs.upload(ve,h.uniformsList,P,K)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Qs.upload(ve,h.uniformsList,P,K),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&A.setValue(ve,"center",r.center),A.setValue(ve,"modelViewMatrix",r.modelViewMatrix),A.setValue(ve,"normalMatrix",r.normalMatrix),A.setValue(ve,"modelMatrix",r.matrixWorld),w}function We(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function He(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}Re.setAnimationLoop(Pe),"undefined"!=typeof window&&Re.setContext(window),this.setAnimationLoop=function(e){ke=e,xe.setAnimationLoop(e),null===e?Re.stop():Re.start()},xe.addEventListener("sessionstart",Oe),xe.addEventListener("sessionend",Ie),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==m){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===xe.enabled&&!0===xe.isPresenting&&(!0===xe.cameraAutoUpdate&&xe.updateCamera(t),t=xe.getCamera()),!0===e.isScene&&e.onBeforeRender(v,e,t,b),(f=oe.get(e,h.length)).init(),h.push(f),U.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(U),j=this.localClippingEnabled,F=ae.init(this.clippingPlanes,j,t),(d=ie.get(e,p.length)).init(),p.push(d),Ne(e,t,0,v.sortObjects),d.finish(),!0===v.sortObjects&&d.sort(A,P),!0===F&&ae.beginShadows();var n=f.state.shadowsArray;if(se.render(n,e,t),!0===F&&ae.endShadows(),!0===this.info.autoReset&&this.info.reset(),ue.render(d,e),f.setupLights(v.physicallyCorrectLights),t.isArrayCamera)for(var r=t.cameras,i=0,o=r.length;i<o;i++){var a=r[i];De(d,e,a,a.viewport)}else De(d,e,t);null!==b&&(K.updateMultisampleRenderTarget(b),K.updateRenderTargetMipmap(b)),!0===e.isScene&&e.onAfterRender(v,e,t),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1),pe.resetDefaultState(),x=-1,_=null,h.pop(),f=h.length>0?h[h.length-1]:null,p.pop(),d=p.length>0?p[p.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return g},this.getRenderTarget=function(){return b},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b=e,y=t,g=n,e&&void 0===X.get(e).__webglFramebuffer&&K.setupRenderTarget(e);var r=null,i=!1,o=!1;if(e){var a=e.texture;(a.isDataTexture3D||a.isDataTexture2DArray)&&(o=!0);var s=X.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=s[t],i=!0):r=e.isWebGLMultisampleRenderTarget?X.get(e).__webglMultisampledFramebuffer:s,w.copy(e.viewport),M.copy(e.scissor),S=e.scissorTest}else w.copy(R).multiplyScalar(k).floor(),M.copy(N).multiplyScalar(k).floor(),S=D;var u=q.bindFramebuffer(36160,r);if(u&&Z.drawBuffers){var c=!1;if(e)if(e.isWebGLMultipleRenderTargets){var l=e.texture;if(L.length!==l.length||36064!==L[0]){for(var d=0,f=l.length;d<f;d++)L[d]=36064+d;L.length=l.length,c=!0}}else 1===L.length&&36064===L[0]||(L[0]=36064,L.length=1,c=!0);else 1===L.length&&1029===L[0]||(L[0]=1029,L.length=1,c=!0);c&&(Z.isWebGL2?ve.drawBuffers(L):H.get("WEBGL_draw_buffers").drawBuffersWEBGL(L))}if(q.viewport(w),q.scissor(M),q.setScissorTest(S),i){var p=X.get(e.texture);ve.framebufferTexture2D(36160,36064,34069+t,p.__webglTexture,n)}else if(o){var h=X.get(e.texture),v=t||0;ve.framebufferTextureLayer(36160,36064,h.__webglTexture,n||0,v)}x=-1},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(e&&e.isWebGLRenderTarget){var s=X.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){q.bindFramebuffer(36160,s);try{var u=e.texture,c=u.format,l=u.type;if(c!==et&&fe.convert(c)!==ve.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var d=l===qe&&(H.has("EXT_color_buffer_half_float")||Z.isWebGL2&&H.has("EXT_color_buffer_float"));if(!(l===ze||fe.convert(l)===ve.getParameter(35738)||l===Ze&&(Z.isWebGL2||H.has("OES_texture_float")||H.has("WEBGL_color_buffer_float"))||d))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ve.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ve.readPixels(t,n,r,i,fe.convert(c),fe.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var f=null!==b?X.get(b).__webglFramebuffer:null;q.bindFramebuffer(36160,f)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r),a=fe.convert(t.format);Z.isWebGL2&&(6407===a&&(a=32849),6408===a&&(a=32856)),K.setTexture2D(t,0),ve.copyTexImage2D(3553,n,a,e.x,e.y,i,o,0),q.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,o=t.image.height,a=fe.convert(n.format),s=fe.convert(n.type);K.setTexture2D(n,0),ve.pixelStorei(37440,n.flipY),ve.pixelStorei(37441,n.premultiplyAlpha),ve.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ve.texSubImage2D(3553,r,e.x,e.y,i,o,a,s,t.image.data):t.isCompressedTexture?ve.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):ve.texSubImage2D(3553,r,e.x,e.y,a,s,t.image),0===r&&n.generateMipmaps&&ve.generateMipmap(3553),q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(v.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var o,a=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,u=e.max.z-e.min.z+1,c=fe.convert(r.format),l=fe.convert(r.type);if(r.isDataTexture3D)K.setTexture3D(r,0),o=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");K.setTexture2DArray(r,0),o=35866}ve.pixelStorei(37440,r.flipY),ve.pixelStorei(37441,r.premultiplyAlpha),ve.pixelStorei(3317,r.unpackAlignment);var d=ve.getParameter(3314),f=ve.getParameter(32878),p=ve.getParameter(3316),h=ve.getParameter(3315),m=ve.getParameter(32877),y=n.isCompressedTexture?n.mipmaps[0]:n.image;ve.pixelStorei(3314,y.width),ve.pixelStorei(32878,y.height),ve.pixelStorei(3316,e.min.x),ve.pixelStorei(3315,e.min.y),ve.pixelStorei(32877,e.min.z),n.isDataTexture||n.isDataTexture3D?ve.texSubImage3D(o,i,t.x,t.y,t.z,a,s,u,c,l,y.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ve.compressedTexSubImage3D(o,i,t.x,t.y,t.z,a,s,u,c,y.data)):ve.texSubImage3D(o,i,t.x,t.y,t.z,a,s,u,c,l,y),ve.pixelStorei(3314,d),ve.pixelStorei(32878,f),ve.pixelStorei(3316,p),ve.pixelStorei(3315,h),ve.pixelStorei(32877,m),0===i&&r.generateMipmaps&&ve.generateMipmap(o),q.unbindTexture()}},this.initTexture=function(e){K.setTexture2D(e,0),q.unbindTexture()},this.resetState=function(){y=0,g=0,b=null,q.reset(),pe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var Wu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n)}(Vu);Wu.prototype.isWebGL1Renderer=!0;var Hu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;(0,v.Z)(this,e),this.name="",this.color=new Ji(t),this.density=n}return(0,m.Z)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();Hu.prototype.isFogExp2=!0;var Zu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,v.Z)(this,e),this.name="",this.color=new Ji(t),this.near=n,this.far=r}return(0,m.Z)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();Zu.prototype.isFog=!0;var qu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:(0,f.Z)(e)})),e}return(0,m.Z)(n,[{key:"copy",value:function(e,t){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(Oi);qu.prototype.isScene=!0;var Yu=function(){function e(t,n){(0,v.Z)(this,e),this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=Un,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=or()}return(0,m.Z)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"clone",value:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=or()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=or()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}();Yu.prototype.isInterleavedBuffer=!0;var Xu=new Pr,Ku=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,v.Z)(this,e),this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=!0===i}return(0,m.Z)(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)Xu.x=this.getX(t),Xu.y=this.getY(t),Xu.z=this.getZ(t),Xu.applyMatrix4(e),this.setXYZ(t,Xu.x,Xu.y,Xu.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)Xu.x=this.getX(t),Xu.y=this.getY(t),Xu.z=this.getZ(t),Xu.applyNormalMatrix(e),this.setXYZ(t,Xu.x,Xu.y,Xu.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)Xu.x=this.getX(t),Xu.y=this.getY(t),Xu.z=this.getZ(t),Xu.transformDirection(e),this.setXYZ(t,Xu.x,Xu.y,Xu.z);return this}},{key:"setX",value:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){return this.data.array[e*this.data.stride+this.offset]}},{key:"getY",value:function(e){return this.data.array[e*this.data.stride+this.offset+1]}},{key:"getZ",value:function(e){return this.data.array[e*this.data.stride+this.offset+2]}},{key:"getW",value:function(e){return this.data.array[e*this.data.stride+this.offset+3]}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)n.push(this.data.array[i+o]);return new to(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}();Ku.prototype.isInterleavedBufferAttribute=!0;var Ju,Qu=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new Ji(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Wi);Qu.prototype.isSpriteMaterial=!0;var $u=new Pr,ec=new Pr,tc=new Pr,nc=new pr,rc=new pr,ic=new ai,oc=new Pr,ac=new Pr,sc=new Pr,uc=new pr,cc=new pr,lc=new pr,dc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;if((0,v.Z)(this,n),(r=t.call(this)).type="Sprite",void 0===Ju){Ju=new xo;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o=new Yu(i,5);Ju.setIndex([0,1,2,0,2,3]),Ju.setAttribute("position",new Ku(o,3,0,!1)),Ju.setAttribute("uv",new Ku(o,2,3,!1))}return r.geometry=Ju,r.material=void 0!==e?e:new Qu,r.center=new pr(.5,.5),r}return(0,m.Z)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ec.setFromMatrixScale(this.matrixWorld),ic.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),tc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ec.multiplyScalar(-tc.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;fc(oc.set(-.5,-.5,0),tc,o,ec,n,r),fc(ac.set(.5,-.5,0),tc,o,ec,n,r),fc(sc.set(.5,.5,0),tc,o,ec,n,r),uc.set(0,0),cc.set(1,0),lc.set(1,1);var a=e.ray.intersectTriangle(oc,ac,sc,!1,$u);if(null!==a||(fc(ac.set(-.5,.5,0),tc,o,ec,n,r),cc.set(0,1),null!==(a=e.ray.intersectTriangle(oc,sc,ac,!1,$u)))){var s=e.ray.origin.distanceTo($u);s<e.near||s>e.far||t.push({distance:s,point:$u.clone(),uv:Gi.getUV($u,oc,ac,sc,uc,cc,lc,new pr),face:null,object:this})}}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(Oi);function fc(e,t,n,r,i,o){nc.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(rc.x=o*nc.x-i*nc.y,rc.y=i*nc.x+o*nc.y):rc.copy(nc),e.copy(t),e.x+=rc.x,e.y+=rc.y,e.applyMatrix4(ic)}dc.prototype.isSprite=!0;var pc=new Pr,hc=new Pr,vc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties((0,f.Z)(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return(0,m.Z)(n,[{key:"copy",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,i=t.length;r<i;r++){var o=t[r];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){pc.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(pc);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){pc.setFromMatrixPosition(e.matrixWorld),hc.setFromMatrixPosition(this.matrixWorld);var n,r,i=pc.distanceTo(hc)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,o=r.length;i<o;i++){var a=r[i];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}]),n}(Oi),mc=new Pr,yc=new Sr,gc=new Sr,bc=new Pr,xc=new ai,_c=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="SkinnedMesh",i.bindMode="attached",i.bindMatrix=new ai,i.bindMatrixInverse=new ai,i}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new Sr,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"boneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;yc.fromBufferAttribute(r.attributes.skinIndex,e),gc.fromBufferAttribute(r.attributes.skinWeight,e),mc.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var o=gc.getComponent(i);if(0!==o){var a=yc.getComponent(i);xc.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(bc.copy(mc).applyMatrix4(xc),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}]),n}(Fo);_c.prototype.isSkinnedMesh=!0;var wc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="Bone",e}return(0,m.Z)(n)}(Oi);wc.prototype.isBone=!0;var Mc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Ce,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Ce,p=arguments.length>10?arguments[10]:void 0,h=arguments.length>11?arguments[11]:void 0;return(0,v.Z)(this,n),(e=t.call(this,null,u,c,l,d,f,a,s,p,h)).image={data:r,width:i,height:o},e.magFilter=d,e.minFilter=f,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,m.Z)(n)}(wr);Mc.prototype.isDataTexture=!0;var Sc=new ai,Tc=new ai,Ec=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,v.Z)(this,e),this.uuid=or(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return(0,m.Z)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new ai)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new ai;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var o=this.bones[r];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:Tc;Sc.multiplyMatrices(a,t[i]),Sc.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var e=Math.sqrt(4*this.bones.length);e=lr(e),e=Math.max(e,4);var t=new Float32Array(e*e*4);t.set(this.boneMatrices);var n=new Mc(t,e,e,et,Ze);return this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],o=t[i];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new wc),this.bones.push(o),this.boneInverses.push((new ai).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var o=t[r];e.bones.push(o.uuid);var a=n[r];e.boneInverses.push(a.toArray())}return e}}]),e}(),kc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.Z)(this,n),"number"==typeof i&&(a=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),(o=t.call(this,e,r,i)).meshPerAttribute=a,o}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),n}(to);kc.prototype.isInstancedBufferAttribute=!0;var Ac=new ai,Pc=new ai,Cc=[],Oc=new Fo,Ic=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this,e,r)).instanceMatrix=new kc(new Float32Array(16*i),16),o.instanceColor=null,o.count=i,o.frustumCulled=!1,o}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}},{key:"getColorAt",value:function(e,t){t.fromArray(this.instanceColor.array,3*e)}},{key:"getMatrixAt",value:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)}},{key:"raycast",value:function(e,t){var n=this.matrixWorld,r=this.count;if(Oc.geometry=this.geometry,Oc.material=this.material,void 0!==Oc.material)for(var i=0;i<r;i++){this.getMatrixAt(i,Ac),Pc.multiplyMatrices(n,Ac),Oc.matrixWorld=Pc,Oc.raycast(e,Cc);for(var o=0,a=Cc.length;o<a;o++){var s=Cc[o];s.instanceId=i,s.object=this,t.push(s)}Cc.length=0}}},{key:"setColorAt",value:function(e,t){null===this.instanceColor&&(this.instanceColor=new kc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}},{key:"setMatrixAt",value:function(e,t){t.toArray(this.instanceMatrix.array,16*e)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Fo);Ic.prototype.isInstancedMesh=!0;var Rc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new Ji(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}]),n}(Wi);Rc.prototype.isLineBasicMaterial=!0;var Nc=new Pr,Dc=new Pr,Lc=new ai,Bc=new oi,Fc=new Jr,jc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xo,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Rc;return(0,v.Z)(this,n),(e=t.call(this)).type="Line",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Nc.fromBufferAttribute(t,r-1),Dc.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Nc.distanceTo(Dc);e.setAttribute("lineDistance",new lo(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Fc.copy(n.boundingSphere),Fc.applyMatrix4(r),Fc.radius+=i,!1!==e.ray.intersectsSphere(Fc)){Lc.copy(r).invert(),Bc.copy(e.ray).applyMatrix4(Lc);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,u=new Pr,c=new Pr,l=new Pr,d=new Pr,f=this.isLineSegments?2:1;if(n.isBufferGeometry){var p=n.index,h=n.attributes.position;if(null!==p)for(var v=Math.max(0,o.start),m=Math.min(p.count,o.start+o.count)-1;v<m;v+=f){var y=p.getX(v),g=p.getX(v+1);if(u.fromBufferAttribute(h,y),c.fromBufferAttribute(h,g),!(Bc.distanceSqToSegment(u,c,d,l)>s)){d.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(d);b<e.near||b>e.far||t.push({distance:b,point:l.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var x=Math.max(0,o.start),_=Math.min(h.count,o.start+o.count)-1;x<_;x+=f)if(u.fromBufferAttribute(h,x),c.fromBufferAttribute(h,x+1),!(Bc.distanceSqToSegment(u,c,d,l)>s)){d.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(d);w<e.near||w>e.far||t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Oi);jc.prototype.isLine=!0;var zc=new Pr,Uc=new Pr,Gc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="LineSegments",i}return(0,m.Z)(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)zc.fromBufferAttribute(t,r),Uc.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+zc.distanceTo(Uc);e.setAttribute("lineDistance",new lo(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}]),n}(jc);Gc.prototype.isLineSegments=!0;var Vc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="LineLoop",i}return(0,m.Z)(n)}(jc);Vc.prototype.isLineLoop=!0;var Wc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new Ji(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Wi);Wc.prototype.isPointsMaterial=!0;var Hc=new ai,Zc=new oi,qc=new Jr,Yc=new Pr,Xc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xo,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Wc;return(0,v.Z)(this,n),(e=t.call(this)).type="Points",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qc.copy(n.boundingSphere),qc.applyMatrix4(r),qc.radius+=i,!1!==e.ray.intersectsSphere(qc)){Hc.copy(r).invert(),Zc.copy(e.ray).applyMatrix4(Hc);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(n.isBufferGeometry){var u=n.index,c=n.attributes.position;if(null!==u)for(var l=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);l<d;l++){var f=u.getX(l);Yc.fromBufferAttribute(c,f),Kc(Yc,f,s,r,e,t,this)}else for(var p=Math.max(0,o.start),h=Math.min(c.count,o.start+o.count);p<h;p++)Yc.fromBufferAttribute(c,p),Kc(Yc,p,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Oi);function Kc(e,t,n,r,i,o,a){var s=Zc.distanceSqToPoint(e);if(s<n){var u=new Pr;Zc.closestPointToPoint(e,u),u.applyMatrix4(r);var c=i.ray.origin.distanceTo(u);if(c<i.near||c>i.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:a})}}Xc.prototype.isPoints=!0;var Jc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o,a,s,u,c,l){var d;(0,v.Z)(this,n),(d=t.call(this,e,r,i,o,a,s,u,c,l)).format=void 0!==u?u:$e,d.minFilter=void 0!==s?s:De,d.magFilter=void 0!==a?a:De,d.generateMipmaps=!1;var p=(0,f.Z)(d);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){p.needsUpdate=!0,e.requestVideoFrameCallback(t)})),d}return(0,m.Z)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(wr);Jc.prototype.isVideoTexture=!0;var Qc=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o,a,s,u,c,l,d,f,p){var h;return(0,v.Z)(this,n),(h=t.call(this,null,s,u,c,l,d,o,a,f,p)).image={width:r,height:i},h.mipmaps=e,h.flipY=!1,h.generateMipmaps=!1,h}return(0,m.Z)(n)}(wr);Qc.prototype.isCompressedTexture=!0;var $c=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o,a,s,u,c,l){var d;return(0,v.Z)(this,n),(d=t.call(this,e,r,i,o,a,s,u,c,l)).needsUpdate=!0,d}return(0,m.Z)(n)}(wr);$c.prototype.isCanvasTexture=!0;var el=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o,a,s,u,c,l,d){var f;if((0,v.Z)(this,n),(d=void 0!==d?d:it)!==it&&d!==ot)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===i&&d===it&&(i=Ve),void 0===i&&d===ot&&(i=Je),(f=t.call(this,null,o,a,s,u,c,d,i,l)).image={width:e,height:r},f.magFilter=void 0!==u?u:Ce,f.minFilter=void 0!==c?c:Ce,f.flipY=!1,f.generateMipmaps=!1,f}return(0,m.Z)(n)}(wr);el.prototype.isDepthTexture=!0;var tl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,v.Z)(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:i,thetaStart:o,thetaLength:a},i=Math.max(3,i);var s=[],u=[],c=[],l=[],d=new Pr,f=new pr;u.push(0,0,0),c.push(0,0,1),l.push(.5,.5);for(var p=0,h=3;p<=i;p++,h+=3){var m=o+p/i*a;d.x=r*Math.cos(m),d.y=r*Math.sin(m),u.push(d.x,d.y,d.z),c.push(0,0,1),f.x=(u[h]/r+1)/2,f.y=(u[h+1]/r+1)/2,l.push(f.x,f.y)}for(var y=1;y<=i;y++)s.push(y,y+1,0);return e.setIndex(s),e.setAttribute("position",new lo(u,3)),e.setAttribute("normal",new lo(c,3)),e.setAttribute("uv",new lo(l,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.segments,e.thetaStart,e.thetaLength)}}]),n}(xo),nl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;(0,v.Z)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:o,radialSegments:a,heightSegments:s,openEnded:u,thetaStart:c,thetaLength:l};var d=(0,f.Z)(e);a=Math.floor(a),s=Math.floor(s);var p=[],h=[],m=[],y=[],g=0,b=[],x=o/2,_=0;function w(){for(var e=new Pr,t=new Pr,n=0,u=(i-r)/o,f=0;f<=s;f++){for(var v=[],w=f/s,M=w*(i-r)+r,S=0;S<=a;S++){var T=S/a,E=T*l+c,k=Math.sin(E),A=Math.cos(E);t.x=M*k,t.y=-w*o+x,t.z=M*A,h.push(t.x,t.y,t.z),e.set(k,u,A).normalize(),m.push(e.x,e.y,e.z),y.push(T,1-w),v.push(g++)}b.push(v)}for(var P=0;P<a;P++)for(var C=0;C<s;C++){var O=b[C][P],I=b[C+1][P],R=b[C+1][P+1],N=b[C][P+1];p.push(O,I,N),p.push(I,R,N),n+=6}d.addGroup(_,n,0),_+=n}function M(e){for(var t=g,n=new pr,o=new Pr,s=0,u=!0===e?r:i,f=!0===e?1:-1,v=1;v<=a;v++)h.push(0,x*f,0),m.push(0,f,0),y.push(.5,.5),g++;for(var b=g,w=0;w<=a;w++){var M=w/a*l+c,S=Math.cos(M),T=Math.sin(M);o.x=u*T,o.y=x*f,o.z=u*S,h.push(o.x,o.y,o.z),m.push(0,f,0),n.x=.5*S+.5,n.y=.5*T*f+.5,y.push(n.x,n.y),g++}for(var E=0;E<a;E++){var k=t+E,A=b+E;!0===e?p.push(A,A+1,k):p.push(A+1,A,k),s+=3}d.addGroup(_,s,!0===e?1:2),_+=s}return w(),!1===u&&(r>0&&M(!0),i>0&&M(!1)),e.setIndex(p),e.setAttribute("position",new lo(h,3)),e.setAttribute("normal",new lo(m,3)),e.setAttribute("uv",new lo(y,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(xo),rl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return(0,v.Z)(this,n),(e=t.call(this,0,r,i,o,a,s,u,c)).type="ConeGeometry",e.parameters={radius:r,height:i,radialSegments:o,heightSegments:a,openEnded:s,thetaStart:u,thetaLength:c},e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(nl),il=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,v.Z)(this,n),(e=t.call(this)).type="PolyhedronGeometry",e.parameters={vertices:r,indices:i,radius:o,detail:a};var s=[],u=[];function c(e){for(var t=new Pr,n=new Pr,r=new Pr,o=0;o<i.length;o+=3)m(i[o+0],t),m(i[o+1],n),m(i[o+2],r),l(t,n,r,e)}function l(e,t,n,r){for(var i=r+1,o=[],a=0;a<=i;a++){o[a]=[];for(var s=e.clone().lerp(n,a/i),u=t.clone().lerp(n,a/i),c=i-a,l=0;l<=c;l++)o[a][l]=0===l&&a===i?s:s.clone().lerp(u,l/c)}for(var d=0;d<i;d++)for(var f=0;f<2*(i-d)-1;f++){var p=Math.floor(f/2);f%2==0?(h(o[d][p+1]),h(o[d+1][p]),h(o[d][p])):(h(o[d][p+1]),h(o[d+1][p+1]),h(o[d+1][p]))}}function d(e){for(var t=new Pr,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}function f(){for(var e=new Pr,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=b(e)/2/Math.PI+.5,r=x(e)/Math.PI+.5;u.push(n,1-r)}y(),p()}function p(){for(var e=0;e<u.length;e+=6){var t=u[e+0],n=u[e+2],r=u[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(u[e+0]+=1),n<.2&&(u[e+2]+=1),r<.2&&(u[e+4]+=1))}}function h(e){s.push(e.x,e.y,e.z)}function m(e,t){var n=3*e;t.x=r[n+0],t.y=r[n+1],t.z=r[n+2]}function y(){for(var e=new Pr,t=new Pr,n=new Pr,r=new Pr,i=new pr,o=new pr,a=new pr,c=0,l=0;c<s.length;c+=9,l+=6){e.set(s[c+0],s[c+1],s[c+2]),t.set(s[c+3],s[c+4],s[c+5]),n.set(s[c+6],s[c+7],s[c+8]),i.set(u[l+0],u[l+1]),o.set(u[l+2],u[l+3]),a.set(u[l+4],u[l+5]),r.copy(e).add(t).add(n).divideScalar(3);var d=b(r);g(i,l+0,e,d),g(o,l+2,t,d),g(a,l+4,n,d)}}function g(e,t,n,r){r<0&&1===e.x&&(u[t]=e.x-1),0===n.x&&0===n.z&&(u[t]=r/2/Math.PI+.5)}function b(e){return Math.atan2(e.z,-e.x)}function x(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return c(a),d(o),f(),e.setAttribute("position",new lo(s,3)),e.setAttribute("normal",new lo(s.slice(),3)),e.setAttribute("uv",new lo(u,2)),0===a?e.computeVertexNormals():e.normalizeNormals(),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.vertices,e.indices,e.radius,e.details)}}]),n}(xo),ol=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.Z)(this,n);var o=(1+Math.sqrt(5))/2,a=1/o,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-o,0,-a,o,0,a,-o,0,a,o,-a,-o,0,-a,o,0,a,-o,0,a,o,0,-o,0,-a,o,0,-a,-o,0,a,o,0,a],u=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return(e=t.call(this,s,u,r,i)).type="DodecahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(il),al=new Pr,sl=new Pr,ul=new Pr,cl=new Gi,ll=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,v.Z)(this,n),(e=t.call(this)).type="EdgesGeometry",e.parameters={geometry:r,thresholdAngle:i},null!==r){for(var o=4,a=Math.pow(10,o),s=Math.cos(er*i),u=r.getIndex(),c=r.getAttribute("position"),l=u?u.count:c.count,d=[0,0,0],f=["a","b","c"],p=new Array(3),h={},m=[],y=0;y<l;y+=3){u?(d[0]=u.getX(y),d[1]=u.getX(y+1),d[2]=u.getX(y+2)):(d[0]=y,d[1]=y+1,d[2]=y+2);var g=cl.a,b=cl.b,x=cl.c;if(g.fromBufferAttribute(c,d[0]),b.fromBufferAttribute(c,d[1]),x.fromBufferAttribute(c,d[2]),cl.getNormal(ul),p[0]="".concat(Math.round(g.x*a),",").concat(Math.round(g.y*a),",").concat(Math.round(g.z*a)),p[1]="".concat(Math.round(b.x*a),",").concat(Math.round(b.y*a),",").concat(Math.round(b.z*a)),p[2]="".concat(Math.round(x.x*a),",").concat(Math.round(x.y*a),",").concat(Math.round(x.z*a)),p[0]!==p[1]&&p[1]!==p[2]&&p[2]!==p[0])for(var _=0;_<3;_++){var w=(_+1)%3,M=p[_],S=p[w],T=cl[f[_]],E=cl[f[w]],k="".concat(M,"_").concat(S),A="".concat(S,"_").concat(M);A in h&&h[A]?(ul.dot(h[A].normal)<=s&&(m.push(T.x,T.y,T.z),m.push(E.x,E.y,E.z)),h[A]=null):k in h||(h[k]={index0:d[_],index1:d[w],normal:ul.clone()})}}for(var P in h)if(h[P]){var C=h[P],O=C.index0,I=C.index1;al.fromBufferAttribute(c,O),sl.fromBufferAttribute(c,I),m.push(al.x,al.y,al.z),m.push(sl.x,sl.y,sl.z)}e.setAttribute("position",new lo(m,3))}return e}return(0,m.Z)(n)}(xo),dl=function(){function e(){(0,v.Z)(this,e),this.type="Curve",this.arcLengthDivisions=200}return(0,m.Z)(e,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var o=1;o<=e;o++)i+=(t=this.getPoint(o/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e,t){var n,r=this.getLengths(),i=0,o=r.length;n=t||e*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(o-1)}},{key:"getTangent",value:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var o=this.getPoint(r),a=this.getPoint(i),s=t||(o.isVector2?new pr:new Pr);return s.copy(a).sub(o).normalize(),s}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e,t){for(var n=new Pr,r=[],i=[],o=[],a=new Pr,s=new ai,u=0;u<=e;u++){var c=u/e;r[u]=this.getTangentAt(c,new Pr)}i[0]=new Pr,o[0]=new Pr;var l=Number.MAX_VALUE,d=Math.abs(r[0].x),f=Math.abs(r[0].y),p=Math.abs(r[0].z);d<=l&&(l=d,n.set(1,0,0)),f<=l&&(l=f,n.set(0,1,0)),p<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(var h=1;h<=e;h++){if(i[h]=i[h-1].clone(),o[h]=o[h-1].clone(),a.crossVectors(r[h-1],r[h]),a.length()>Number.EPSILON){a.normalize();var v=Math.acos(ar(r[h-1].dot(r[h]),-1,1));i[h].applyMatrix4(s.makeRotationAxis(a,v))}o[h].crossVectors(r[h],i[h])}if(!0===t){var m=Math.acos(ar(i[0].dot(i[e]),-1,1));m/=e,r[0].dot(a.crossVectors(i[0],i[e]))>0&&(m=-m);for(var y=1;y<=e;y++)i[y].applyMatrix4(s.makeRotationAxis(r[y],m*y)),o[y].crossVectors(r[y],i[y])}return{tangents:r,normals:i,binormals:o}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),fl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return(0,v.Z)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=i,e.xRadius=o,e.yRadius=a,e.aStartAngle=s,e.aEndAngle=u,e.aClockwise=c,e.aRotation=l,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new pr,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),d=s-this.aX,f=u-this.aY;s=d*c-f*l+this.aX,u=d*l+f*c+this.aY}return n.set(s,u)}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(dl);fl.prototype.isEllipseCurve=!0;var pl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o,a,s){var u;return(0,v.Z)(this,n),(u=t.call(this,e,r,i,i,o,a,s)).type="ArcCurve",u}return(0,m.Z)(n)}(fl);function hl(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){var u=(t-e)/o-(n-e)/(o+a)+(n-t)/a,c=(n-t)/a-(r-t)/(a+s)+(r-n)/s;i(t,n,u*=a,c*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}pl.prototype.isArcCurve=!0;var vl=new Pr,ml=new hl,yl=new hl,gl=new hl,bl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return(0,v.Z)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=i,e.curveType=o,e.tension=a,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,i=r,o=this.points,a=o.length,s=(a-(this.closed?0:1))*e,u=Math.floor(s),c=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/a)+1)*a:0===c&&u===a-1&&(u=a-2,c=1),this.closed||u>0?t=o[(u-1)%a]:(vl.subVectors(o[0],o[1]).add(o[0]),t=vl);var l=o[u%a],d=o[(u+1)%a];if(this.closed||u+2<a?n=o[(u+2)%a]:(vl.subVectors(o[a-1],o[a-2]).add(o[a-1]),n=vl),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,p=Math.pow(t.distanceToSquared(l),f),h=Math.pow(l.distanceToSquared(d),f),v=Math.pow(d.distanceToSquared(n),f);h<1e-4&&(h=1),p<1e-4&&(p=h),v<1e-4&&(v=h),ml.initNonuniformCatmullRom(t.x,l.x,d.x,n.x,p,h,v),yl.initNonuniformCatmullRom(t.y,l.y,d.y,n.y,p,h,v),gl.initNonuniformCatmullRom(t.z,l.z,d.z,n.z,p,h,v)}else"catmullrom"===this.curveType&&(ml.initCatmullRom(t.x,l.x,d.x,n.x,this.tension),yl.initCatmullRom(t.y,l.y,d.y,n.y,this.tension),gl.initCatmullRom(t.z,l.z,d.z,n.z,this.tension));return i.set(ml.calc(c),yl.calc(c),gl.calc(c)),i}},{key:"copy",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Pr).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(dl);function xl(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n),s=e*e;return(2*n-2*r+o+a)*(e*s)+(-3*n+3*r-2*o-a)*s+o*e+n}function _l(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function wl(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}bl.prototype.isCatmullRomCurve3=!0;var Ml=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new pr,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new pr;return(0,v.Z)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=i,e.v2=o,e.v3=a,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr,n=t,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(wl(e,r.x,i.x,o.x,a.x),wl(e,r.y,i.y,o.y,a.y)),n}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(dl);Ml.prototype.isCubicBezierCurve=!0;var Sl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Pr,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Pr;return(0,v.Z)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=i,e.v2=o,e.v3=a,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,n=t,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(wl(e,r.x,i.x,o.x,a.x),wl(e,r.y,i.y,o.y,a.y),wl(e,r.z,i.z,o.z,a.z)),n}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(dl);Sl.prototype.isCubicBezierCurve3=!0;var Tl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr;return(0,v.Z)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=i,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){var n=t||new pr;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(dl);Tl.prototype.isLineCurve=!0;var El=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr;return(0,v.Z)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=i,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(dl),kl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new pr;return(0,v.Z)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=i,e.v2=o,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr,n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(_l(e,r.x,i.x,o.x),_l(e,r.y,i.y,o.y)),n}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(dl);kl.prototype.isQuadraticBezierCurve=!0;var Al=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Pr;return(0,v.Z)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=i,e.v2=o,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr,n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(_l(e,r.x,i.x,o.x),_l(e,r.y,i.y,o.y),_l(e,r.z,i.z,o.z)),n}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(dl);Al.prototype.isQuadraticBezierCurve3=!0;var Pl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,v.Z)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return(0,m.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr,n=t,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(xl(a,s.x,u.x,c.x,l.x),xl(a,s.y,u.y,c.y,l.y)),n}},{key:"copy",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new pr).fromArray(i))}return this}}]),n}(dl);Pl.prototype.isSplineCurve=!0;var Cl=Object.freeze({__proto__:null,ArcCurve:pl,CatmullRomCurve3:bl,CubicBezierCurve:Ml,CubicBezierCurve3:Sl,EllipseCurve:fl,LineCurve:Tl,LineCurve3:El,QuadraticBezierCurve:kl,QuadraticBezierCurve3:Al,SplineCurve:Pl}),Ol=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return(0,m.Z)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Tl(t,e))}},{key:"getPoint",value:function(e,t){for(var n=e*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var o=r[i]-n,a=this.curves[i],s=a.getLength(),u=0===s?0:1-o/s;return a.getPointAt(u,t)}i++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new Cl[i.type]).fromJSON(i))}return this}}]),n}(dl),Il=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new pr,e&&r.setFromPoints(e),r}return(0,m.Z)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new Tl(this.currentPoint.clone(),new pr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new kl(this.currentPoint.clone(),new pr(e,t),new pr(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,o){var a=new Ml(this.currentPoint.clone(),new pr(e,t),new pr(n,r),new pr(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new Pl(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,n,r,i,o),this}},{key:"absarc",value:function(e,t,n,r,i,o){return this.absellipse(e,t,n,n,r,i,o),this}},{key:"ellipse",value:function(e,t,n,r,i,o,a,s){var u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,n,r,i,o,a,s),this}},{key:"absellipse",value:function(e,t,n,r,i,o,a,s){var u=new fl(e,t,n,r,i,o,a,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);return this.currentPoint.copy(l),this}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(Ol),Rl=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e)).uuid=or(),r.type="Shape",r.holes=[],r}return(0,m.Z)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new Il).fromJSON(i))}return this}}]),n}(Il);function Nl(e,t,n,r,i){var o,a;if(i===function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)a=nd(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=nd(o,e[o],e[o+1],a);return a&&Kl(a,a.next)&&(rd(a),a=a.next),a}function Dl(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Kl(r,r.next)&&0!==Xl(r.prev,r,r.next))r=r.next;else{if(rd(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Ll(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=Hl(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(e,r,i,o);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?Fl(e,r,i,o):Bl(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),rd(e),e=u.next,c=u.next;else if((e=u)===c){a?1===a?Ll(e=jl(Dl(e),t,n),t,n,r,i,o,2):2===a&&zl(e,t,n,r,i,o):Ll(Dl(e),t,n,r,i,o,1);break}}}function Bl(e){var t=e.prev,n=e,r=e.next;if(Xl(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(ql(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Xl(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Fl(e,t,n,r){var i=e.prev,o=e,a=e.next;if(Xl(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=Hl(s,u,t,n,r),f=Hl(c,l,t,n,r),p=e.prevZ,h=e.nextZ;p&&p.z>=d&&h&&h.z<=f;){if(p!==e.prev&&p!==e.next&&ql(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Xl(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,h!==e.prev&&h!==e.next&&ql(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Xl(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&ql(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Xl(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;h&&h.z<=f;){if(h!==e.prev&&h!==e.next&&ql(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Xl(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function jl(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!Kl(i,o)&&Jl(i,r,r.next,o)&&ed(i,o)&&ed(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),rd(r),rd(r.next),r=e=o),r=r.next}while(r!==e);return Dl(r)}function zl(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Yl(a,s)){var u=td(a,s);return a=Dl(a,a.next),u=Dl(u,u.next),Ll(a,t,n,r,i,o),void Ll(u,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function Ul(e,t,n,r){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=Nl(e,t[i]*r,i<o-1?t[i+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(Zl(a));for(s.sort(Gl),i=0;i<s.length;i++)Vl(s[i],n),n=Dl(n,n.next);return n}function Gl(e,t){return e.x-t.x}function Vl(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,d=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&ql(o<d?i:a,o,l,d,o<d?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),ed(r,e)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&Wl(n,r)))&&(n=r,f=u)),r=r.next}while(r!==c);return n}(e,t),t){var n=td(t,e);Dl(t,t.next),Dl(n,n.next)}}function Wl(e,t){return Xl(e.prev,e,t.prev)<0&&Xl(t.next,e,e.next)<0}function Hl(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Zl(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function ql(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Yl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Jl(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(ed(e,t)&&ed(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Xl(e.prev,e,t.prev)||Xl(e,t.prev,t))||Kl(e,t)&&Xl(e.prev,e,e.next)>0&&Xl(t.prev,t,t.next)>0)}function Xl(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Kl(e,t){return e.x===t.x&&e.y===t.y}function Jl(e,t,n,r){var i=$l(Xl(e,t,n)),o=$l(Xl(e,t,r)),a=$l(Xl(n,r,e)),s=$l(Xl(n,r,t));return i!==o&&a!==s||!(0!==i||!Ql(e,n,t))||!(0!==o||!Ql(e,r,t))||!(0!==a||!Ql(n,e,r))||!(0!==s||!Ql(n,t,r))}function Ql(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function $l(e){return e>0?1:e<0?-1:0}function ed(e,t){return Xl(e.prev,e,e.next)<0?Xl(e,t,e.next)>=0&&Xl(e,e.prev,t)>=0:Xl(e,t,e.prev)<0||Xl(e,e.next,t)<0}function td(e,t){var n=new id(e.i,e.x,e.y),r=new id(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function nd(e,t,n,r){var i=new id(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function rd(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function id(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var od=function(){function e(){(0,v.Z)(this,e)}return(0,m.Z)(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];ad(e),sd(n,e);var o=e.length;t.forEach(ad);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,sd(n,t[a]);for(var s=function(e,t){var n,r,i,o,a,s,u,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,l=t&&t.length,d=l?t[0]*c:e.length,f=Nl(e,0,d,c,!0),p=[];if(!f||f.next===f.prev)return p;if(l&&(f=Ul(e,t,f,c)),e.length>80*c){n=i=e[0],r=o=e[1];for(var h=c;h<d;h+=c)(a=e[h])<n&&(n=a),(s=e[h+1])<r&&(r=s),a>i&&(i=a),s>o&&(o=s);u=0!==(u=Math.max(i-n,o-r))?1/u:0}return Ll(f,p,c,n,r,u),p}(n,r),u=0;u<s.length;u+=3)i.push(s.slice(u,u+3));return i}}]),e}();function ad(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function sd(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var ud=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Rl([new pr(.5,.5),new pr(-.5,.5),new pr(-.5,-.5),new pr(.5,-.5)]),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,v.Z)(this,n),(e=t.call(this)).type="ExtrudeGeometry",e.parameters={shapes:r,options:i},r=Array.isArray(r)?r:[r];for(var o=(0,f.Z)(e),a=[],s=[],u=0,c=r.length;u<c;u++){var l=r[u];d(l)}function d(e){var t=[],n=void 0!==i.curveSegments?i.curveSegments:12,r=void 0!==i.steps?i.steps:1,u=void 0!==i.depth?i.depth:1,c=void 0===i.bevelEnabled||i.bevelEnabled,l=void 0!==i.bevelThickness?i.bevelThickness:.2,d=void 0!==i.bevelSize?i.bevelSize:l-.1,f=void 0!==i.bevelOffset?i.bevelOffset:0,p=void 0!==i.bevelSegments?i.bevelSegments:3,h=i.extrudePath,v=void 0!==i.UVGenerator?i.UVGenerator:cd;void 0!==i.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=i.amount);var m,y,g,b,x,_=!1;h&&(m=h.getSpacedPoints(r),_=!0,c=!1,y=h.computeFrenetFrames(r,!1),g=new Pr,b=new Pr,x=new Pr),c||(p=0,l=0,d=0,f=0);var w=e.extractPoints(n),M=w.shape,S=w.holes;if(!od.isClockWise(M)){M=M.reverse();for(var T=0,E=S.length;T<E;T++){var k=S[T];od.isClockWise(k)&&(S[T]=k.reverse())}}for(var A=od.triangulateShape(M,S),P=M,C=0,O=S.length;C<O;C++){var I=S[C];M=M.concat(I)}function R(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var N=M.length,D=A.length;function L(e,t,n){var r,i,o,a=e.x-t.x,s=e.y-t.y,u=n.x-e.x,c=n.y-e.y,l=a*a+s*s,d=a*c-s*u;if(Math.abs(d)>Number.EPSILON){var f=Math.sqrt(l),p=Math.sqrt(u*u+c*c),h=t.x-s/f,v=t.y+a/f,m=((n.x-c/p-h)*c-(n.y+u/p-v)*u)/(a*c-s*u),y=(r=h+a*m-e.x)*r+(i=v+s*m-e.y)*i;if(y<=2)return new pr(r,i);o=Math.sqrt(y/2)}else{var g=!1;a>Number.EPSILON?u>Number.EPSILON&&(g=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(g=!0):Math.sign(s)===Math.sign(c)&&(g=!0),g?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new pr(r/o,i/o)}for(var B=[],F=0,j=P.length,z=j-1,U=F+1;F<j;F++,z++,U++)z===j&&(z=0),U===j&&(U=0),B[F]=L(P[F],P[z],P[U]);for(var G,V=[],W=B.concat(),H=0,Z=S.length;H<Z;H++){var q=S[H];G=[];for(var Y=0,X=q.length,K=X-1,J=Y+1;Y<X;Y++,K++,J++)K===X&&(K=0),J===X&&(J=0),G[Y]=L(q[Y],q[K],q[J]);V.push(G),W=W.concat(G)}for(var Q=0;Q<p;Q++){for(var $=Q/p,ee=l*Math.cos($*Math.PI/2),te=d*Math.sin($*Math.PI/2)+f,ne=0,re=P.length;ne<re;ne++){var ie=R(P[ne],B[ne],te);Oe(ie.x,ie.y,-ee)}for(var oe=0,ae=S.length;oe<ae;oe++){var se=S[oe];G=V[oe];for(var ue=0,ce=se.length;ue<ce;ue++){var le=R(se[ue],G[ue],te);Oe(le.x,le.y,-ee)}}}for(var de=d+f,fe=0;fe<N;fe++){var pe=c?R(M[fe],W[fe],de):M[fe];_?(b.copy(y.normals[0]).multiplyScalar(pe.x),g.copy(y.binormals[0]).multiplyScalar(pe.y),x.copy(m[0]).add(b).add(g),Oe(x.x,x.y,x.z)):Oe(pe.x,pe.y,0)}for(var he=1;he<=r;he++)for(var ve=0;ve<N;ve++){var me=c?R(M[ve],W[ve],de):M[ve];_?(b.copy(y.normals[he]).multiplyScalar(me.x),g.copy(y.binormals[he]).multiplyScalar(me.y),x.copy(m[he]).add(b).add(g),Oe(x.x,x.y,x.z)):Oe(me.x,me.y,u/r*he)}for(var ye=p-1;ye>=0;ye--){for(var ge=ye/p,be=l*Math.cos(ge*Math.PI/2),xe=d*Math.sin(ge*Math.PI/2)+f,_e=0,we=P.length;_e<we;_e++){var Me=R(P[_e],B[_e],xe);Oe(Me.x,Me.y,u+be)}for(var Se=0,Te=S.length;Se<Te;Se++){var Ee=S[Se];G=V[Se];for(var ke=0,Ae=Ee.length;ke<Ae;ke++){var Pe=R(Ee[ke],G[ke],xe);_?Oe(Pe.x,Pe.y+m[r-1].y,m[r-1].x+be):Oe(Pe.x,Pe.y,u+be)}}}function Ce(e,t){for(var n=e.length;--n>=0;){var i=n,o=n-1;o<0&&(o=e.length-1);for(var a=0,s=r+2*p;a<s;a++){var u=N*a,c=N*(a+1);Re(t+i+u,t+o+u,t+o+c,t+i+c)}}}function Oe(e,n,r){t.push(e),t.push(n),t.push(r)}function Ie(e,t,n){Ne(e),Ne(t),Ne(n);var r=a.length/3,i=v.generateTopUV(o,a,r-3,r-2,r-1);De(i[0]),De(i[1]),De(i[2])}function Re(e,t,n,r){Ne(e),Ne(t),Ne(r),Ne(t),Ne(n),Ne(r);var i=a.length/3,s=v.generateSideWallUV(o,a,i-6,i-3,i-2,i-1);De(s[0]),De(s[1]),De(s[3]),De(s[1]),De(s[2]),De(s[3])}function Ne(e){a.push(t[3*e+0]),a.push(t[3*e+1]),a.push(t[3*e+2])}function De(e){s.push(e.x),s.push(e.y)}!function(){var e=a.length/3;if(c){for(var t=0,n=N*t,i=0;i<D;i++){var s=A[i];Ie(s[2]+n,s[1]+n,s[0]+n)}n=N*(t=r+2*p);for(var u=0;u<D;u++){var l=A[u];Ie(l[0]+n,l[1]+n,l[2]+n)}}else{for(var d=0;d<D;d++){var f=A[d];Ie(f[2],f[1],f[0])}for(var h=0;h<D;h++){var v=A[h];Ie(v[0]+N*r,v[1]+N*r,v[2]+N*r)}}o.addGroup(e,a.length/3-e,0)}(),function(){var e=a.length/3,t=0;Ce(P,t),t+=P.length;for(var n=0,r=S.length;n<r;n++){var i=S[n];Ce(i,t),t+=i.length}o.addGroup(e,a.length/3-e,1)}()}return e.setAttribute("position",new lo(a,3)),e.setAttribute("uv",new lo(s,2)),e.computeVertexNormals(),e}return(0,m.Z)(n,[{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,o=e.shapes.length;i<o;i++){var a=t[e.shapes[i]];r.push(a)}var s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new Cl[s.type]).fromJSON(s)),new n(r,e.options)}}]),n}(xo),cd={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r],u=t[3*r+1],c=t[3*i],l=t[3*i+1];return[new pr(o,a),new pr(s,u),new pr(c,l)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],u=t[3*n+2],c=t[3*r],l=t[3*r+1],d=t[3*r+2],f=t[3*i],p=t[3*i+1],h=t[3*i+2],v=t[3*o],m=t[3*o+1],y=t[3*o+2];return Math.abs(s-l)<Math.abs(a-c)?[new pr(a,1-u),new pr(c,1-d),new pr(f,1-h),new pr(v,1-y)]:[new pr(s,1-u),new pr(l,1-d),new pr(p,1-h),new pr(m,1-y)]}},ld=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.Z)(this,n);var o=(1+Math.sqrt(5))/2,a=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return(e=t.call(this,a,s,r,i)).type="IcosahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(il),dd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new pr(0,.5),new pr(.5,0),new pr(0,-.5)],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,v.Z)(this,n),(e=t.call(this)).type="LatheGeometry",e.parameters={points:r,segments:i,phiStart:o,phiLength:a},i=Math.floor(i),a=ar(a,0,2*Math.PI);for(var s=[],u=[],c=[],l=1/i,d=new Pr,f=new pr,p=0;p<=i;p++)for(var h=o+p*l*a,m=Math.sin(h),y=Math.cos(h),g=0;g<=r.length-1;g++)d.x=r[g].x*m,d.y=r[g].y,d.z=r[g].x*y,u.push(d.x,d.y,d.z),f.x=p/i,f.y=g/(r.length-1),c.push(f.x,f.y);for(var b=0;b<i;b++)for(var x=0;x<r.length-1;x++){var _=x+b*r.length,w=_,M=_+r.length,S=_+r.length+1,T=_+1;s.push(w,M,T),s.push(M,S,T)}if(e.setIndex(s),e.setAttribute("position",new lo(u,3)),e.setAttribute("uv",new lo(c,2)),e.computeVertexNormals(),a===2*Math.PI)for(var E=e.attributes.normal.array,k=new Pr,A=new Pr,P=new Pr,C=i*r.length*3,O=0,I=0;O<r.length;O++,I+=3)k.x=E[I+0],k.y=E[I+1],k.z=E[I+2],A.x=E[C+I+0],A.y=E[C+I+1],A.z=E[C+I+2],P.addVectors(k,A).normalize(),E[I+0]=E[C+I+0]=P.x,E[I+1]=E[C+I+1]=P.y,E[I+2]=E[C+I+2]=P.z;return e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.points,e.segments,e.phiStart,e.phiLength)}}]),n}(xo),fd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.Z)(this,n);var o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],a=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=t.call(this,o,a,r,i)).type="OctahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(il),pd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;(0,v.Z)(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:i,thetaSegments:o,phiSegments:a,thetaStart:s,thetaLength:u},o=Math.max(3,o);for(var c=[],l=[],d=[],f=[],p=r,h=(i-r)/(a=Math.max(1,a)),m=new Pr,y=new pr,g=0;g<=a;g++){for(var b=0;b<=o;b++){var x=s+b/o*u;m.x=p*Math.cos(x),m.y=p*Math.sin(x),l.push(m.x,m.y,m.z),d.push(0,0,1),y.x=(m.x/i+1)/2,y.y=(m.y/i+1)/2,f.push(y.x,y.y)}p+=h}for(var _=0;_<a;_++)for(var w=_*(o+1),M=0;M<o;M++){var S=M+w,T=S,E=S+o+1,k=S+o+2,A=S+1;c.push(T,E,A),c.push(E,k,A)}return e.setIndex(c),e.setAttribute("position",new lo(l,3)),e.setAttribute("normal",new lo(d,3)),e.setAttribute("uv",new lo(f,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}]),n}(xo),hd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Rl([new pr(0,.5),new pr(-.5,-.5),new pr(.5,-.5)]),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;(0,v.Z)(this,n),(e=t.call(this)).type="ShapeGeometry",e.parameters={shapes:r,curveSegments:i};var o=[],a=[],s=[],u=[],c=0,l=0;if(!1===Array.isArray(r))f(r);else for(var d=0;d<r.length;d++)f(r[d]),e.addGroup(c,l,d),c+=l,l=0;function f(e){var t=a.length/3,n=e.extractPoints(i),r=n.shape,c=n.holes;!1===od.isClockWise(r)&&(r=r.reverse());for(var d=0,f=c.length;d<f;d++){var p=c[d];!0===od.isClockWise(p)&&(c[d]=p.reverse())}for(var h=od.triangulateShape(r,c),v=0,m=c.length;v<m;v++){var y=c[v];r=r.concat(y)}for(var g=0,b=r.length;g<b;g++){var x=r[g];a.push(x.x,x.y,0),s.push(0,0,1),u.push(x.x,x.y)}for(var _=0,w=h.length;_<w;_++){var M=h[_],S=M[0]+t,T=M[1]+t,E=M[2]+t;o.push(S,T,E),l+=3}}return e.setIndex(o),e.setAttribute("position",new lo(a,3)),e.setAttribute("normal",new lo(s,3)),e.setAttribute("uv",new lo(u,2)),e}return(0,m.Z)(n,[{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,o=e.shapes.length;i<o;i++){var a=t[e.shapes[i]];r.push(a)}return new n(r,e.curveSegments)}}]),n}(xo),vd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,v.Z)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:o,phiStart:a,phiLength:s,thetaStart:u,thetaLength:c},i=Math.max(3,Math.floor(i)),o=Math.max(2,Math.floor(o));for(var l=Math.min(u+c,Math.PI),d=0,f=[],p=new Pr,h=new Pr,m=[],y=[],g=[],b=[],x=0;x<=o;x++){var _=[],w=x/o,M=0;0==x&&0==u?M=.5/i:x==o&&l==Math.PI&&(M=-.5/i);for(var S=0;S<=i;S++){var T=S/i;p.x=-r*Math.cos(a+T*s)*Math.sin(u+w*c),p.y=r*Math.cos(u+w*c),p.z=r*Math.sin(a+T*s)*Math.sin(u+w*c),y.push(p.x,p.y,p.z),h.copy(p).normalize(),g.push(h.x,h.y,h.z),b.push(T+M,1-w),_.push(d++)}f.push(_)}for(var E=0;E<o;E++)for(var k=0;k<i;k++){var A=f[E][k+1],P=f[E][k],C=f[E+1][k],O=f[E+1][k+1];(0!==E||u>0)&&m.push(A,P,O),(E!==o-1||l<Math.PI)&&m.push(P,C,O)}return e.setIndex(m),e.setAttribute("position",new lo(y,3)),e.setAttribute("normal",new lo(g,3)),e.setAttribute("uv",new lo(b,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),n}(xo),md=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.Z)(this,n);var o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],a=[2,1,0,0,3,2,1,3,0,2,3,1];return(e=t.call(this,o,a,r,i)).type="TetrahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(il),yd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;(0,v.Z)(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:i,radialSegments:o,tubularSegments:a,arc:s},o=Math.floor(o),a=Math.floor(a);for(var u=[],c=[],l=[],d=[],f=new Pr,p=new Pr,h=new Pr,m=0;m<=o;m++)for(var y=0;y<=a;y++){var g=y/a*s,b=m/o*Math.PI*2;p.x=(r+i*Math.cos(b))*Math.cos(g),p.y=(r+i*Math.cos(b))*Math.sin(g),p.z=i*Math.sin(b),c.push(p.x,p.y,p.z),f.x=r*Math.cos(g),f.y=r*Math.sin(g),h.subVectors(p,f).normalize(),l.push(h.x,h.y,h.z),d.push(y/a),d.push(m/o)}for(var x=1;x<=o;x++)for(var _=1;_<=a;_++){var w=(a+1)*x+_-1,M=(a+1)*(x-1)+_-1,S=(a+1)*(x-1)+_,T=(a+1)*x+_;u.push(w,M,T),u.push(M,S,T)}return e.setIndex(u),e.setAttribute("position",new lo(c,3)),e.setAttribute("normal",new lo(l,3)),e.setAttribute("uv",new lo(d,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}]),n}(xo),gd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;(0,v.Z)(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:i,tubularSegments:o,radialSegments:a,p:s,q:u},o=Math.floor(o),a=Math.floor(a);for(var c=[],l=[],d=[],f=[],p=new Pr,h=new Pr,m=new Pr,y=new Pr,g=new Pr,b=new Pr,x=new Pr,_=0;_<=o;++_){var w=_/o*s*Math.PI*2;R(w,s,u,r,m),R(w+.01,s,u,r,y),b.subVectors(y,m),x.addVectors(y,m),g.crossVectors(b,x),x.crossVectors(g,b),g.normalize(),x.normalize();for(var M=0;M<=a;++M){var S=M/a*Math.PI*2,T=-i*Math.cos(S),E=i*Math.sin(S);p.x=m.x+(T*x.x+E*g.x),p.y=m.y+(T*x.y+E*g.y),p.z=m.z+(T*x.z+E*g.z),l.push(p.x,p.y,p.z),h.subVectors(p,m).normalize(),d.push(h.x,h.y,h.z),f.push(_/o),f.push(M/a)}}for(var k=1;k<=o;k++)for(var A=1;A<=a;A++){var P=(a+1)*(k-1)+(A-1),C=(a+1)*k+(A-1),O=(a+1)*k+A,I=(a+1)*(k-1)+A;c.push(P,C,I),c.push(C,O,I)}function R(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}return e.setIndex(c),e.setAttribute("position",new lo(l,3)),e.setAttribute("normal",new lo(d,3)),e.setAttribute("uv",new lo(f,2)),e}return(0,m.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}]),n}(xo),bd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Al(new Pr(-1,-1,0),new Pr(-1,1,0),new Pr(1,1,0)),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,v.Z)(this,n),(e=t.call(this)).type="TubeGeometry",e.parameters={path:r,tubularSegments:i,radius:o,radialSegments:a,closed:s};var u=r.computeFrenetFrames(i,s);e.tangents=u.tangents,e.normals=u.normals,e.binormals=u.binormals;var c=new Pr,l=new Pr,d=new pr,f=new Pr,p=[],h=[],m=[],y=[];function g(){for(var e=0;e<i;e++)b(e);b(!1===s?i:0),_(),x()}function b(e){f=r.getPointAt(e/i,f);for(var t=u.normals[e],n=u.binormals[e],s=0;s<=a;s++){var d=s/a*Math.PI*2,v=Math.sin(d),m=-Math.cos(d);l.x=m*t.x+v*n.x,l.y=m*t.y+v*n.y,l.z=m*t.z+v*n.z,l.normalize(),h.push(l.x,l.y,l.z),c.x=f.x+o*l.x,c.y=f.y+o*l.y,c.z=f.z+o*l.z,p.push(c.x,c.y,c.z)}}function x(){for(var e=1;e<=i;e++)for(var t=1;t<=a;t++){var n=(a+1)*(e-1)+(t-1),r=(a+1)*e+(t-1),o=(a+1)*e+t,s=(a+1)*(e-1)+t;y.push(n,r,s),y.push(r,o,s)}}function _(){for(var e=0;e<=i;e++)for(var t=0;t<=a;t++)d.x=e/i,d.y=t/a,m.push(d.x,d.y)}return g(),e.setIndex(y),e.setAttribute("position",new lo(p,3)),e.setAttribute("normal",new lo(h,3)),e.setAttribute("uv",new lo(m,2)),e}return(0,m.Z)(n,[{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this);return e.path=this.parameters.path.toJSON(),e}}],[{key:"fromJSON",value:function(e){return new n((new Cl[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}]),n}(xo),xd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if((0,v.Z)(this,n),(e=t.call(this)).type="WireframeGeometry",e.parameters={geometry:r},null!==r){var i=[],o=new Set,a=new Pr,s=new Pr;if(null!==r.index){var u=r.attributes.position,c=r.index,l=r.groups;0===l.length&&(l=[{start:0,count:c.count,materialIndex:0}]);for(var d=0,f=l.length;d<f;++d)for(var p=l[d],h=p.start,m=p.count,y=h,g=h+m;y<g;y+=3)for(var b=0;b<3;b++){var x=c.getX(y+b),_=c.getX(y+(b+1)%3);a.fromBufferAttribute(u,x),s.fromBufferAttribute(u,_),!0===_d(a,s,o)&&(i.push(a.x,a.y,a.z),i.push(s.x,s.y,s.z))}}else for(var w=r.attributes.position,M=0,S=w.count/3;M<S;M++)for(var T=0;T<3;T++){var E=3*M+T,k=3*M+(T+1)%3;a.fromBufferAttribute(w,E),s.fromBufferAttribute(w,k),!0===_d(a,s,o)&&(i.push(a.x,a.y,a.z),i.push(s.x,s.y,s.z))}e.setAttribute("position",new lo(i,3))}return e}return(0,m.Z)(n)}(xo);function _d(e,t,n){var r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r,i),!0)}var wd=Object.freeze({__proto__:null,BoxGeometry:zo,BoxBufferGeometry:zo,CircleGeometry:tl,CircleBufferGeometry:tl,ConeGeometry:rl,ConeBufferGeometry:rl,CylinderGeometry:nl,CylinderBufferGeometry:nl,DodecahedronGeometry:ol,DodecahedronBufferGeometry:ol,EdgesGeometry:ll,ExtrudeGeometry:ud,ExtrudeBufferGeometry:ud,IcosahedronGeometry:ld,IcosahedronBufferGeometry:ld,LatheGeometry:dd,LatheBufferGeometry:dd,OctahedronGeometry:fd,OctahedronBufferGeometry:fd,PlaneGeometry:aa,PlaneBufferGeometry:aa,PolyhedronGeometry:il,PolyhedronBufferGeometry:il,RingGeometry:pd,RingBufferGeometry:pd,ShapeGeometry:hd,ShapeBufferGeometry:hd,SphereGeometry:vd,SphereBufferGeometry:vd,TetrahedronGeometry:md,TetrahedronBufferGeometry:md,TorusGeometry:yd,TorusBufferGeometry:yd,TorusKnotGeometry:gd,TorusKnotBufferGeometry:gd,TubeGeometry:bd,TubeBufferGeometry:bd,WireframeGeometry:xd}),Md=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new Ji(0),r.transparent=!0,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(Wi);Md.prototype.isShadowMaterial=!0;var Sd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).defines={STANDARD:""},r.type="MeshStandardMaterial",r.color=new Ji(16777215),r.roughness=1,r.metalness=0,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ji(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Mn,r.normalScale=new pr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.roughnessMap=null,r.metalnessMap=null,r.alphaMap=null,r.envMap=null,r.envMapIntensity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}]),n}(Wi);Sd.prototype.isMeshStandardMaterial=!0;var Td=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).defines={STANDARD:"",PHYSICAL:""},r.type="MeshPhysicalMaterial",r.clearcoatMap=null,r.clearcoatRoughness=0,r.clearcoatRoughnessMap=null,r.clearcoatNormalScale=new pr(1,1),r.clearcoatNormalMap=null,r.ior=1.5,Object.defineProperty((0,f.Z)(r),"reflectivity",{get:function(){return ar(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),r.sheenTint=new Ji(0),r.sheenRoughness=1,r.transmissionMap=null,r.thickness=.01,r.thicknessMap=null,r.attenuationDistance=0,r.attenuationTint=new Ji(1,1,1),r.specularIntensity=1,r.specularIntensityMap=null,r.specularTint=new Ji(1,1,1),r.specularTintMap=null,r._sheen=0,r._clearcoat=0,r._transmission=0,r.setValues(e),r}return(0,m.Z)(n,[{key:"sheen",get:function(){return this._sheen},set:function(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}},{key:"clearcoat",get:function(){return this._clearcoat},set:function(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}},{key:"transmission",get:function(){return this._transmission},set:function(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenTint.copy(e.sheenTint),this.sheenRoughness=e.sheenRoughness,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}]),n}(Sd);Td.prototype.isMeshPhysicalMaterial=!0;var Ed=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new Ji(16777215),r.specular=new Ji(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ji(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Mn,r.normalScale=new pr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=de,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}]),n}(Wi);Ed.prototype.isMeshPhongMaterial=!0;var kd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new Ji(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ji(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Mn,r.normalScale=new pr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(Wi);kd.prototype.isMeshToonMaterial=!0;var Ad=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Mn,r.normalScale=new pr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.flatShading=!1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}]),n}(Wi);Ad.prototype.isMeshNormalMaterial=!0;var Pd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new Ji(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Ji(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=de,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(Wi);Pd.prototype.isMeshLambertMaterial=!0;var Cd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new Ji(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Mn,r.normalScale=new pr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.flatShading=!1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}]),n}(Wi);Cd.prototype.isMeshMatcapMaterial=!0;var Od=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(Rc);Od.prototype.isLineDashedMaterial=!0;var Id=Object.freeze({__proto__:null,ShadowMaterial:Md,SpriteMaterial:Qu,RawShaderMaterial:ya,ShaderMaterial:Wo,PointsMaterial:Wc,MeshPhysicalMaterial:Td,MeshStandardMaterial:Sd,MeshPhongMaterial:Ed,MeshToonMaterial:kd,MeshNormalMaterial:Ad,MeshLambertMaterial:Pd,MeshDepthMaterial:Cu,MeshDistanceMaterial:Ou,MeshBasicMaterial:Qi,MeshMatcapMaterial:Cd,LineDashedMaterial:Od,LineBasicMaterial:Rc,Material:Wi}),Rd={arraySlice:function(e,t,n){return Rd.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,u=0;u!==t;++u)i[a++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),o=e[i++]}while(void 0!==o)}},subclip:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,o=e.clone();o.name=t;for(var a=[],s=0;s<o.tracks.length;++s){for(var u=o.tracks[s],c=u.getValueSize(),l=[],d=[],f=0;f<u.times.length;++f){var p=u.times[f]*i;if(!(p<n||p>=r)){l.push(u.times[f]);for(var h=0;h<c;++h)d.push(u.values[f*c+h])}}0!==l.length&&(u.times=Rd.convertArray(l,u.times.constructor),u.values=Rd.convertArray(d,u.values.constructor),a.push(u))}o.tracks=a;for(var v=1/0,m=0;m<o.tracks.length;++m)v>o.tracks[m].times[0]&&(v=o.tracks[m].times[0]);for(var y=0;y<o.tracks.length;++y)o.tracks[y].shift(-1*v);return o.resetDuration(),o},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var i=n.tracks.length,o=t/r,a=function(t){var r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var a=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===a)return"continue";var s=0,u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=u/3);var c=0,l=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=l/3);var d=r.times.length-1,f=void 0;if(o<=r.times[0]){var p=s,h=u-s;f=Rd.arraySlice(r.values,p,h)}else if(o>=r.times[d]){var v=d*u+s,m=v+u-s;f=Rd.arraySlice(r.values,v,m)}else{var y=r.createInterpolant(),g=s,b=u-s;y.evaluate(o),f=Rd.arraySlice(y.resultBuffer,g,b)}"quaternion"===i&&(new Ar).fromArray(f).normalize().conjugate().toArray(f);for(var x=a.times.length,_=0;_<x;++_){var w=_*l+c;if("quaternion"===i)Ar.multiplyQuaternionsFlat(a.values,w,f,0,a.values,w);else for(var M=l-2*c,S=0;S<M;++S)a.values[w+S]-=f[S]}},s=0;s<i;++s)a(s);return e.blendMode=cn,e}},Nd=function(){function e(t,n,r,i){(0,v.Z)(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return(0,m.Z)(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var o;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}o=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var u=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===u)break;if(r=i,e>=(i=t[--n-1]))break t}o=n,n=0}for(;n<o;){var c=n+o>>>1;e<t[c]?o=c:n=c+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}();Nd.prototype.beforeStart_=Nd.prototype.copySampleValue_,Nd.prototype.afterEnd_=Nd.prototype.copySampleValue_;var Dd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this,e,r,i,o))._weightPrev=-0,a._offsetPrev=-0,a._weightNext=-0,a._offsetNext=-0,a.DefaultSettings_={endingStart:on,endingEnd:on},a}return(0,m.Z)(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case an:i=e,a=2*t-n;break;case sn:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case an:o=e,s=2*n-t;break;case sn:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var u=.5*(n-t),c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),h=p*p,v=h*p,m=-d*v+2*d*h-d*p,y=(1+d)*v+(-1.5-2*d)*h+(-.5+d)*p+1,g=(-1-f)*v+(1.5+f)*h+.5*p,b=f*v-f*h,x=0;x!==a;++x)i[x]=m*o[c+x]+y*o[u+x]+g*o[s+x]+b*o[l+x];return i}}]),n}(Nd),Ld=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o){return(0,v.Z)(this,n),t.call(this,e,r,i,o)}return(0,m.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,c=(n-t)/(r-t),l=1-c,d=0;d!==a;++d)i[d]=o[u+d]*l+o[s+d]*c;return i}}]),n}(Nd),Bd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o){return(0,v.Z)(this,n),t.call(this,e,r,i,o)}return(0,m.Z)(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(Nd),Fd=function(){function e(t,n,r,i){if((0,v.Z)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Rd.convertArray(n,this.TimeBufferType),this.values=Rd.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return(0,m.Z)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new Bd(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Ld(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Dd(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case tn:t=this.InterpolantFactoryMethodDiscrete;break;case nn:t=this.InterpolantFactoryMethodLinear;break;case rn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return tn;case this.InterpolantFactoryMethodLinear:return nn;case this.InterpolantFactoryMethodSmooth:return rn}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Rd.arraySlice(n,i,o),this.values=Rd.arraySlice(this.values,i*a,o*a)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&Rd.isTypedArray(r))for(var u=0,c=r.length;u!==c;++u){var l=r[u];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,l),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=Rd.arraySlice(this.times),t=Rd.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===rn,i=e.length-1,o=1,a=1;a<i;++a){var s=!1,u=e[a];if(u!==e[a+1]&&(1!==a||u!==e[0]))if(r)s=!0;else for(var c=a*n,l=c-n,d=c+n,f=0;f!==n;++f){var p=t[c+f];if(p!==t[l+f]||p!==t[d+f]){s=!0;break}}if(s){if(a!==o){e[o]=e[a];for(var h=a*n,v=o*n,m=0;m!==n;++m)t[v+m]=t[h+m]}++o}}if(i>0){e[o]=e[i];for(var y=i*n,g=o*n,b=0;b!==n;++b)t[g+b]=t[y+b];++o}return o!==e.length?(this.times=Rd.arraySlice(e,0,o),this.values=Rd.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=Rd.arraySlice(this.times,0),t=Rd.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Rd.convertArray(e.times,Array),values:Rd.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Fd.prototype.TimeBufferType=Float32Array,Fd.prototype.ValueBufferType=Float32Array,Fd.prototype.DefaultInterpolation=nn;var jd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n)}(Fd);jd.prototype.ValueTypeName="bool",jd.prototype.ValueBufferType=Array,jd.prototype.DefaultInterpolation=tn,jd.prototype.InterpolantFactoryMethodLinear=void 0,jd.prototype.InterpolantFactoryMethodSmooth=void 0;var zd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n)}(Fd);zd.prototype.ValueTypeName="color";var Ud=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n)}(Fd);Ud.prototype.ValueTypeName="number";var Gd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i,o){return(0,v.Z)(this,n),t.call(this,e,r,i,o)}return(0,m.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-t)/(r-t),u=e*a,c=u+a;u!==c;u+=4)Ar.slerpFlat(i,0,o,u-a,o,u,s);return i}}]),n}(Nd),Vd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Gd(this.times,this.values,this.getValueSize(),e)}}]),n}(Fd);Vd.prototype.ValueTypeName="quaternion",Vd.prototype.DefaultInterpolation=nn,Vd.prototype.InterpolantFactoryMethodSmooth=void 0;var Wd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n)}(Fd);Wd.prototype.ValueTypeName="string",Wd.prototype.ValueBufferType=Array,Wd.prototype.DefaultInterpolation=tn,Wd.prototype.InterpolantFactoryMethodLinear=void 0,Wd.prototype.InterpolantFactoryMethodSmooth=void 0;var Hd=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,m.Z)(n)}(Fd);Hd.prototype.ValueTypeName="vector";var Zd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:un;(0,v.Z)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=or(),this.duration<0&&this.resetDuration()}return(0,m.Z)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(qd(n[i]).scale(r));var a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,o=n.length;i!==o;++i)t.push(Fd.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var c=Rd.getKeyframeOrder(s);s=Rd.sortedArray(s,1,c),u=Rd.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new Ud(".morphTargetInfluences["+t[a].name+"]",s,u).scale(1/n))}return new this(e,-1,o)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],u=s.name.match(i);if(u&&u.length>1){var c=u[1],l=r[c];l||(r[c]=l=[]),l.push(s)}}var d=[];for(var f in r)d.push(this.CreateFromMorphTargetSequence(f,r[f],t,n));return d}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var o=[],a=[];Rd.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a))}},r=[],i=e.name||"default",o=e.fps||30,a=e.blendMode,s=e.length||-1,u=e.hierarchy||[],c=0;c<u.length;c++){var l=u[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){var d={},f=void 0;for(f=0;f<l.length;f++)if(l[f].morphTargets)for(var p=0;p<l[f].morphTargets.length;p++)d[l[f].morphTargets[p]]=-1;for(var h in d){for(var v=[],m=[],y=0;y!==l[f].morphTargets.length;++y){var g=l[f];v.push(g.time),m.push(g.morphTarget===h?1:0)}r.push(new Ud(".morphTargetInfluence["+h+"]",v,m))}s=d.length*(o||1)}else{var b=".bones["+t[c].name+"]";n(Hd,b+".position",l,"pos",r),n(Vd,b+".quaternion",l,"rot",r),n(Hd,b+".scale",l,"scl",r)}}return 0===r.length?null:new this(i,s,r,a)}}]),e}();function qd(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ud;case"vector":case"vector2":case"vector3":case"vector4":return Hd;case"color":return zd;case"quaternion":return Vd;case"bool":case"boolean":return jd;case"string":return Wd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Rd.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var Yd={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Xd=(0,m.Z)((function e(t,n,r){(0,v.Z)(this,e);var i=this,o=!1,a=0,s=0,u=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===o&&void 0!==i.onStart&&i.onStart(e,a,s),o=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,s),a===s&&(o=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return u?u(e):e},this.setURLModifier=function(e){return u=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=c.length;t<n;t+=2){var r=c[t],i=c[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),Kd=new Xd,Jd=function(){function e(t){(0,v.Z)(this,e),this.manager=void 0!==t?t:Kd,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return(0,m.Z)(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}(),Qd={},$d=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Yd.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;if(void 0===Qd[e]){var a,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var u=s[1],c=!!s[2],l=s[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var d,f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":for(var p=new Uint8Array(l.length),h=0;h<l.length;h++)p[h]=l.charCodeAt(h);d="blob"===f?new Blob([p.buffer],{type:u}):p.buffer;break;case"document":var v=new DOMParser;d=v.parseFromString(l,u);break;case"json":d=JSON.parse(l);break;default:d=l}setTimeout((function(){t&&t(d),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var m in Qd[e]=[],Qd[e].push({onLoad:t,onProgress:n,onError:r}),(a=new XMLHttpRequest).open("GET",e,!0),a.addEventListener("load",(function(t){var n=this.response,r=Qd[e];if(delete Qd[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Yd.add(e,n);for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(var u=0,c=r.length;u<c;u++){var l=r[u];l.onError&&l.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),a.addEventListener("progress",(function(t){for(var n=Qd[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}}),!1),a.addEventListener("error",(function(t){var n=Qd[e];delete Qd[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),a.addEventListener("abort",(function(t){var n=Qd[e];delete Qd[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)a.setRequestHeader(m,this.requestHeader[m]);a.send(null)}return i.manager.itemStart(e),a}Qd[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),n}(Jd),ef=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,o=new $d(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=Zd.parse(e[n]);t.push(r)}return t}}]),n}(Jd),tf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,o=[],a=new Qc,s=new $d(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var u=0;function c(c){s.load(e[c],(function(e){var n=i.parse(e,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(a.minFilter=De),a.image=o,a.format=n.format,a.needsUpdate=!0,t&&t(a))}),n,r)}if(Array.isArray(e))for(var l=0,d=e.length;l<d;++l)c(l);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=De),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,r);return a}}]),n}(Jd),nf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Yd.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a=br("img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),Yd.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}}]),n}(Jd),rf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new Xo,o=new nf(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],(function(e){i.images[n]=e,6==++a&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return i}}]),n}(Jd),of=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,o=new Mc,a=new $d(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Ae,o.wrapT=void 0!==n.wrapT?n.wrapT:Ae,o.magFilter=void 0!==n.magFilter?n.magFilter:De,o.minFilter=void 0!==n.minFilter?n.minFilter:De,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=Fe),1===n.mipmapCount&&(o.minFilter=De),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,t&&t(o,n))}),n,r),o}}]),n}(Jd),af=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new wr,o=new nf(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),n}(Jd),sf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,v.Z)(this,n),(r=t.call(this)).type="Light",r.color=new Ji(e),r.intensity=i,r}return(0,m.Z)(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(Oi);sf.prototype.isLight=!0;var uf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this,e,i)).type="HemisphereLight",o.position.copy(Oi.DefaultUp),o.updateMatrix(),o.groundColor=new Ji(r),o}return(0,m.Z)(n,[{key:"copy",value:function(e){return sf.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(sf);uf.prototype.isHemisphereLight=!0;var cf=new ai,lf=new Pr,df=new Pr,ff=function(){function e(t){(0,v.Z)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new pr(512,512),this.map=null,this.mapPass=null,this.matrix=new ai,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ra,this._frameExtents=new pr(1,1),this._viewportCount=1,this._viewports=[new Sr(0,0,1,1)]}return(0,m.Z)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;lf.setFromMatrixPosition(e.matrixWorld),t.position.copy(lf),df.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(df),t.updateMatrixWorld(),cf.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cf),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),pf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this,new Zo(50,1,.5,500))).focus=1,e}return(0,m.Z)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*tr*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;r===t.fov&&i===t.aspect&&o===t.far||(t.fov=r,t.aspect=i,t.far=o,t.updateProjectionMatrix()),(0,c.Z)((0,l.Z)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(ff);pf.prototype.isSpotLightShadow=!0;var hf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="SpotLight",i.position.copy(Oi.DefaultUp),i.updateMatrix(),i.target=new Oi,i.distance=o,i.angle=a,i.penumbra=s,i.decay=u,i.shadow=new pf,i}return(0,m.Z)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(sf);hf.prototype.isSpotLight=!0;var vf=new ai,mf=new Pr,yf=new Pr,gf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this,new Zo(90,1,.5,500)))._frameExtents=new pr(4,2),e._viewportCount=6,e._viewports=[new Sr(2,1,1,1),new Sr(0,1,1,1),new Sr(3,1,1,1),new Sr(1,1,1,1),new Sr(3,0,1,1),new Sr(1,0,1,1)],e._cubeDirections=[new Pr(1,0,0),new Pr(-1,0,0),new Pr(0,0,1),new Pr(0,0,-1),new Pr(0,1,0),new Pr(0,-1,0)],e._cubeUps=[new Pr(0,1,0),new Pr(0,1,0),new Pr(0,1,0),new Pr(0,1,0),new Pr(0,0,1),new Pr(0,0,-1)],e}return(0,m.Z)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),mf.setFromMatrixPosition(e.matrixWorld),n.position.copy(mf),yf.copy(n.position),yf.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(yf),n.updateMatrixWorld(),r.makeTranslation(-mf.x,-mf.y,-mf.z),vf.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vf)}}]),n}(ff);gf.prototype.isPointLightShadow=!0;var bf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="PointLight",i.distance=o,i.decay=a,i.shadow=new gf,i}return(0,m.Z)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(sf);bf.prototype.isPointLight=!0;var xf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){return(0,v.Z)(this,n),t.call(this,new ma(-5,5,5,-5,.5,500))}return(0,m.Z)(n)}(ff);xf.prototype.isDirectionalLightShadow=!0;var _f=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="DirectionalLight",i.position.copy(Oi.DefaultUp),i.updateMatrix(),i.target=new Oi,i.shadow=new xf,i}return(0,m.Z)(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(sf);_f.prototype.isDirectionalLight=!0;var wf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="AmbientLight",i}return(0,m.Z)(n)}(sf);wf.prototype.isAmbientLight=!0;var Mf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(0,v.Z)(this,n),(i=t.call(this,e,r)).type="RectAreaLight",i.width=o,i.height=a,i}return(0,m.Z)(n,[{key:"power",get:function(){return this.intensity*this.width*this.height*Math.PI},set:function(e){this.intensity=e/(this.width*this.height*Math.PI)}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(sf);Mf.prototype.isRectAreaLight=!0;var Sf=function(){function e(){(0,v.Z)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Pr)}return(0,m.Z)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*i*1.092548),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],n*i*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*i),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],.858086*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}();Sf.prototype.isSphericalHarmonics3=!0;var Tf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sf,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,v.Z)(this,n),(e=t.call(this,void 0,i)).sh=r,e}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(sf);Tf.prototype.isLightProbe=!0;var Ef=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e)).textures={},r}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,o=new $d(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Id[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenTint&&(r.sheenTint=(new Ji).setHex(e.sheenTint)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularTint&&void 0!==r.specularTint&&r.specularTint.setHex(e.specularTint),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationTint&&void 0!==r.attenuationTint&&r.attenuationTint.setHex(e.attenuationTint),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.format&&(r.format=e.format),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new Ji).setHex(o.value);break;case"v2":r.uniforms[i].value=(new pr).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new Pr).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new Sr).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new hr).fromArray(o.value);break;case"m4":r.uniforms[i].value=(new ai).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)r.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new pr).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularTintMap&&(r.specularTintMap=n(e.specularTintMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new pr).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),r}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(Jd),kf=function(){function e(){(0,v.Z)(this,e)}return(0,m.Z)(e,null,[{key:"decodeText",value:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}}]),e}(),Af=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="InstancedBufferGeometry",e.instanceCount=1/0,e}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),n}(xo);Af.prototype.isInstancedBufferGeometry=!0;var Pf,Cf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,o=new $d(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],o=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),a=gr(i.type,o),s=new Yu(a,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new Af:new xo,o=e.data.index;if(void 0!==o){var a=gr(o.type,o.array);i.setIndex(new to(a,1))}var s=e.data.attributes;for(var u in s){var c=s[u],l=void 0;if(c.isInterleavedBufferAttribute){var d=r(e.data,c.data);l=new Ku(d,c.itemSize,c.offset,c.normalized)}else{var f=gr(c.type,c.array);l=new(c.isInstancedBufferAttribute?kc:to)(f,c.itemSize,c.normalized)}void 0!==c.name&&(l.name=c.name),void 0!==c.usage&&l.setUsage(c.usage),void 0!==c.updateRange&&(l.updateRange.offset=c.updateRange.offset,l.updateRange.count=c.updateRange.count),i.setAttribute(u,l)}var p=e.data.morphAttributes;if(p)for(var h in p){for(var v=p[h],m=[],y=0,g=v.length;y<g;y++){var b=v[y],x=void 0;if(b.isInterleavedBufferAttribute){var _=r(e.data,b.data);x=new Ku(_,b.itemSize,b.offset,b.normalized)}else{var w=gr(b.type,b.array);x=new to(w,b.itemSize,b.normalized)}void 0!==b.name&&(x.name=b.name),m.push(x)}i.morphAttributes[h]=m}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var M=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==M)for(var S=0,T=M.length;S!==T;++S){var E=M[S];i.addGroup(E.start,E.count,E.materialIndex)}var k=e.data.boundingSphere;if(void 0!==k){var A=new Pr;void 0!==k.center&&A.fromArray(k.center),i.boundingSphere=new Jr(A,k.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}]),n}(Jd),Of=function(e){(0,p.Z)(a,e);var t,n,r,o=(0,h.Z)(a);function a(e){return(0,v.Z)(this,a),o.call(this,e)}return(0,m.Z)(a,[{key:"load",value:function(e,t,n,r){var i=this,o=""===this.path?kf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;var a=new $d(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"loadAsync",value:(r=(0,i.Z)(g().mark((function e(t,n){var r,i,o,a,s,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,i=""===this.path?kf.extractUrlBase(t):this.path,this.resourcePath=this.resourcePath||i,(o=new $d(this.manager)).setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),e.next=9,o.loadAsync(t,n);case 9:if(a=e.sent,s=JSON.parse(a),void 0!==(u=s.metadata)&&void 0!==u.type&&"geometry"!==u.type.toLowerCase()){e.next=14;break}throw new Error("THREE.ObjectLoader: Can't load "+t);case 14:return e.next=16,r.parseAsync(s);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,(function(){void 0!==t&&t(u)})),a=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,i,s,a,n),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),void 0!==t){var l=!1;for(var d in o)if(o[d]instanceof HTMLImageElement){l=!0;break}!1===l&&t(u)}return u}},{key:"parseAsync",value:(n=(0,i.Z)(g().mark((function e(t){var n,r,i,o,a,s,u,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),e.next=5,this.parseImagesAsync(t.images);case 5:return o=e.sent,a=this.parseTextures(t.textures,o),s=this.parseMaterials(t.materials,a),u=this.parseObject(t.object,i,s,a,n),c=this.parseSkeletons(t.skeletons,u),this.bindSkeletons(u,c),e.abrupt("return",u);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Rl).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=(new Ec).fromJSON(e[i],r);n[a.uuid]=a}return n}},{key:"parseGeometries",value:function(e,t){var n={};if(void 0!==e)for(var r=new Cf,i=0,o=e.length;i<o;i++){var a=void 0,s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in wd?a=wd[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new Ef;i.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var u=[],c=0;c<s.materials.length;c++){var l=s.materials[c];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),u.push(n[l.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=Zd.parse(r);t[i.uuid]=i}return t}},{key:"parseImages",value:function(e,t){var n,r=this,i={};function o(e){if("string"==typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:gr(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var a=new Xd(t);(n=new nf(a)).setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var c=e[s],l=c.url;if(Array.isArray(l)){i[c.uuid]=[];for(var d=0,f=l.length;d<f;d++){var p=o(l[d]);null!==p&&(p instanceof HTMLImageElement?i[c.uuid].push(p):i[c.uuid].push(new Mc(p.data,p.width,p.height)))}}else{var h=o(c.url);null!==h&&(i[c.uuid]=h)}}}return i}},{key:"parseImagesAsync",value:(t=(0,i.Z)(g().mark((function e(t){var n,r,o,a,s,u,c,l,d,f,p,h,v,m;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(){return s=(0,i.Z)(g().mark((function e(t){var r,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=8;break}return i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r=t)?r:n.resourcePath+r,e.next=5,o.loadAsync(i);case 5:return e.abrupt("return",e.sent);case 8:if(!t.data){e.next=12;break}return e.abrupt("return",{data:gr(t.type,t.data),width:t.width,height:t.height});case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)},a=function(e){return s.apply(this,arguments)},n=this,r={},!(void 0!==t&&t.length>0)){e.next=32;break}(o=new nf(this.manager)).setCrossOrigin(this.crossOrigin),u=0,c=t.length;case 8:if(!(u<c)){e.next=32;break}if(l=t[u],d=l.url,!Array.isArray(d)){e.next=25;break}r[l.uuid]=[],f=0,p=d.length;case 14:if(!(f<p)){e.next=23;break}return h=d[f],e.next=18,a(h);case 18:null!==(v=e.sent)&&(v instanceof HTMLImageElement?r[l.uuid].push(v):r[l.uuid].push(new Mc(v.data,v.width,v.height)));case 20:f++,e.next=14;break;case 23:e.next=29;break;case 25:return e.next=27,a(l.url);case 27:null!==(m=e.sent)&&(r[l.uuid]=m);case 29:u++,e.next=8;break;case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=e[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=void 0,u=t[a.image];Array.isArray(u)?(s=new Xo(u),6===u.length&&(s.needsUpdate=!0)):(s=u&&u.data?new Mc(u.data,u.width,u.height):new wr(u),u&&(s.needsUpdate=!0)),s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,If)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],Rf),s.wrapT=n(a.wrap[1],Rf)),void 0!==a.format&&(s.format=a.format),void 0!==a.type&&(s.type=a.type),void 0!==a.encoding&&(s.encoding=a.encoding),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,Nf)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,Nf)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(s.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(s.unpackAlignment=a.unpackAlignment),r[a.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r,i){var o,a,s;function u(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function l(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":o=new qu,void 0!==e.background&&(Number.isInteger(e.background)?o.background=new Ji(e.background):o.background=l(e.background)),void 0!==e.environment&&(o.environment=l(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new Zu(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new Hu(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new Zo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ma(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new wf(e.color,e.intensity);break;case"DirectionalLight":o=new _f(e.color,e.intensity);break;case"PointLight":o=new bf(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Mf(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new hf(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new uf(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new Tf).fromJSON(e);break;case"SkinnedMesh":a=u(e.geometry),s=c(e.material),o=new _c(a,s),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":a=u(e.geometry),s=c(e.material),o=new Fo(a,s);break;case"InstancedMesh":a=u(e.geometry),s=c(e.material);var d=e.count,f=e.instanceMatrix,p=e.instanceColor;(o=new Ic(a,s,d)).instanceMatrix=new kc(new Float32Array(f.array),16),void 0!==p&&(o.instanceColor=new kc(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new vc;break;case"Line":o=new jc(u(e.geometry),c(e.material));break;case"LineLoop":o=new Vc(u(e.geometry),c(e.material));break;case"LineSegments":o=new Gc(u(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new Xc(u(e.geometry),c(e.material));break;case"Sprite":o=new dc(c(e.material));break;case"Group":o=new Bu;break;case"Bone":o=new wc;break;default:o=new Oi}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children)for(var h=e.children,v=0;v<h.length;v++)o.add(this.parseObject(h[v],t,n,r,i));if(void 0!==e.animations)for(var m=e.animations,y=0;y<m.length;y++){var g=m[y];o.animations.push(i[g])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);for(var b=e.levels,x=0;x<b.length;x++){var _=b[x],w=o.getObjectByProperty("uuid",_.object);void 0!==w&&o.addLevel(w,_.distance)}}return o}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),a}(Jd),If={UVMapping:xe,CubeReflectionMapping:_e,CubeRefractionMapping:we,EquirectangularReflectionMapping:Me,EquirectangularRefractionMapping:Se,CubeUVReflectionMapping:Te,CubeUVRefractionMapping:Ee},Rf={RepeatWrapping:ke,ClampToEdgeWrapping:Ae,MirroredRepeatWrapping:Pe},Nf={NearestFilter:Ce,NearestMipmapNearestFilter:Oe,NearestMipmapLinearFilter:Re,LinearFilter:De,LinearMipmapNearestFilter:Le,LinearMipmapLinearFilter:Fe},Df=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),r=t.call(this,e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),r.options={premultiplyAlpha:"none"},r}return(0,m.Z)(n,[{key:"setOptions",value:function(e){return this.options=e,this}},{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Yd.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){Yd.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}]),n}(Jd);Df.prototype.isImageBitmapLoader=!0;var Lf={getContext:function(){return void 0===Pf&&(Pf=new(window.AudioContext||window.webkitAudioContext)),Pf},setContext:function(e){Pf=e}},Bf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,v.Z)(this,n),t.call(this,e)}return(0,m.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,o=new $d(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{var o=n.slice(0);Lf.getContext().decodeAudioData(o,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}}]),n}(Jd),Ff=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,v.Z)(this,n),i=t.call(this,void 0,o);var a=(new Ji).set(e),s=(new Ji).set(r),u=new Pr(a.r,a.g,a.b),c=new Pr(s.r,s.g,s.b),l=Math.sqrt(Math.PI),d=l*Math.sqrt(.75);return i.sh.coefficients[0].copy(u).add(c).multiplyScalar(l),i.sh.coefficients[1].copy(u).sub(c).multiplyScalar(d),i}return(0,m.Z)(n)}(Tf);Ff.prototype.isHemisphereLightProbe=!0;var jf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,v.Z)(this,n),r=t.call(this,void 0,i);var o=(new Ji).set(e);return r.sh.coefficients[0].set(o.r,o.g,o.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return(0,m.Z)(n)}(Tf);jf.prototype.isAmbientLightProbe=!0;var zf=new ai,Uf=new ai,Gf=function(){function e(){(0,v.Z)(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return(0,m.Z)(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),o=t.eyeSep/2,a=o*t.near/t.focus,s=t.near*Math.tan(er*t.fov*.5)/t.zoom;Uf.elements[12]=-o,zf.elements[12]=o,n=-s*t.aspect+a,r=s*t.aspect+a,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-a,r=s*t.aspect-a,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Uf),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zf)}}]),e}(),Vf=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,v.Z)(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return(0,m.Z)(e,[{key:"start",value:function(){this.startTime=Wf(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=Wf();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function Wf(){return("undefined"==typeof performance?Date:performance).now()}var Hf=new Pr,Zf=new Ar,qf=new Pr,Yf=new Pr,Xf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).type="AudioListener",e.context=Lf.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new Vf,e}return(0,m.Z)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){(0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Hf,Zf,qf),Yf.set(0,0,-1).applyQuaternion(Zf),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Hf.x,i),t.positionY.linearRampToValueAtTime(Hf.y,i),t.positionZ.linearRampToValueAtTime(Hf.z,i),t.forwardX.linearRampToValueAtTime(Yf.x,i),t.forwardY.linearRampToValueAtTime(Yf.y,i),t.forwardZ.linearRampToValueAtTime(Yf.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(Hf.x,Hf.y,Hf.z),t.setOrientation(Yf.x,Yf.y,Yf.z,r.x,r.y,r.z)}}]),n}(Oi),Kf=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return(0,m.Z)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(Oi),Jf=new Pr,Qf=new Ar,$f=new Pr,ep=new Pr,tp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return(0,m.Z)(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if((0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Jf,Qf,$f),ep.set(0,0,1).applyQuaternion(Qf);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Jf.x,r),t.positionY.linearRampToValueAtTime(Jf.y,r),t.positionZ.linearRampToValueAtTime(Jf.z,r),t.orientationX.linearRampToValueAtTime(ep.x,r),t.orientationY.linearRampToValueAtTime(ep.y,r),t.orientationZ.linearRampToValueAtTime(ep.z,r)}else t.setPosition(Jf.x,Jf.y,Jf.z),t.setOrientation(ep.x,ep.y,ep.z)}}}]),n}(Kf),np=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;(0,v.Z)(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return(0,m.Z)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),rp=function(){function e(t,n,r){var i,o,a;switch((0,v.Z)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,o=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,o=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,o=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=o,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return(0,m.Z)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var u=t,c=t+t;u!==c;++u)if(n[u]!==n[u+t]){a.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)e[t+o]=e[n+o]}},{key:"_slerp",value:function(e,t,n,r){Ar.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){var o=this._workIndex*i;Ar.multiplyQuaternionsFlat(e,o,e,t,e,n),Ar.slerpFlat(e,t,e,t,e,o,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var o=0;o!==i;++o){var a=t+o;e[a]=e[a]+e[n+o]*r}}}]),e}(),ip=new RegExp("[\\[\\]\\.:\\/]","g"),op="[^\\[\\]\\.:\\/]",ap="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",sp=/((?:WC+[\/:])*)/.source.replace("WC",op),up=/(WCOD+)?/.source.replace("WCOD",ap),cp=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",op),lp=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",op),dp=new RegExp("^"+sp+up+cp+lp+"$"),fp=["material","materials","bones"],pp=function(){function e(t,n,r){(0,v.Z)(this,e);var i=r||hp.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return(0,m.Z)(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),hp=function(){function e(t,n,r){(0,v.Z)(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return(0,m.Z)(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,o=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var a=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===a){a=s;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var u=t[i];if(void 0!==u){var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=o}else void 0!==u.fromArray&&void 0!==u.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(l=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var d=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(ip,"")}},{key:"parseTrackName",value:function(e){var t=dp.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==fp.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var o=e(i.children);if(o)return o}return null}(e.children);if(r)return r}return null}}]),e}();hp.Composite=pp,hp.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},hp.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},hp.prototype.GetterByBindingType=[hp.prototype._getValue_direct,hp.prototype._getValue_array,hp.prototype._getValue_arrayElement,hp.prototype._getValue_toArray],hp.prototype.SetterByBindingTypeAndVersioning=[[hp.prototype._setValue_direct,hp.prototype._setValue_direct_setNeedsUpdate,hp.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[hp.prototype._setValue_array,hp.prototype._setValue_array_setNeedsUpdate,hp.prototype._setValue_array_setMatrixWorldNeedsUpdate],[hp.prototype._setValue_arrayElement,hp.prototype._setValue_arrayElement_setNeedsUpdate,hp.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[hp.prototype._setValue_fromArray,hp.prototype._setValue_fromArray_setNeedsUpdate,hp.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var vp=function(){function e(){(0,v.Z)(this,e),this.uuid=or(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return(0,m.Z)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length,a=void 0,s=e.length,u=this.nCachedObjects_,c=0,l=arguments.length;c!==l;++c){var d=arguments[c],f=d.uuid,p=t[f];if(void 0===p){p=s++,t[f]=p,e.push(d);for(var h=0,v=o;h!==v;++h)i[h].push(new hp(d,n[h],r[h]))}else if(p<u){a=e[p];var m=--u,y=e[m];t[y.uuid]=p,e[p]=y,t[f]=m,e[m]=d;for(var g=0,b=o;g!==b;++g){var x=i[g],_=x[m],w=x[p];x[p]=_,void 0===w&&(w=new hp(d,n[g],r[g])),x[m]=w}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,c=t[u];if(void 0!==c&&c>=i){var l=i++,d=e[l];t[d.uuid]=c,e[c]=d,t[u]=l,e[l]=s;for(var f=0,p=r;f!==p;++f){var h=n[f],v=h[l],m=h[c];h[c]=v,h[l]=m}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=e.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=t[c];if(void 0!==l)if(delete t[c],l<i){var d=--i,f=e[d],p=--o,h=e[p];t[f.uuid]=l,e[l]=f,t[h.uuid]=d,e[d]=h,e.pop();for(var v=0,m=r;v!==m;++v){var y=n[v],g=y[d],b=y[p];y[l]=g,y[d]=b,y.pop()}}else{var x=--o,_=e[x];x>0&&(t[_.uuid]=l),e[l]=_,e.pop();for(var w=0,M=r;w!==M;++w){var S=n[w];S[l]=S[x],S.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(l);for(var d=c,f=s.length;d!==f;++d){var p=s[d];l[d]=new hp(p,e,t)}return l}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}]),e}();vp.prototype.isAnimationObjectGroup=!0;var mp=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;(0,v.Z)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var o=n.tracks,a=o.length,s=new Array(a),u={endingStart:on,endingEnd:on},c=0;c!==a;++c){var l=o[c].createInterpolant(null);s[c]=l,l.settings=u}this._interpolantSettings=u,this._interpolants=s,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=$t,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return(0,m.Z)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,o=i/r,a=r/i;e.warp(1,o,t),this.warp(a,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,i=r.time,o=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/o,u[1]=t/o,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0){var u=this._interpolants,c=this._propertyBindings;if(this.blendMode===cn)for(var l=0,d=u.length;l!==d;++l)u[l].evaluate(a),c[l].accumulateAdditive(s);else for(var f=0,p=u.length;f!==p;++f)u[f].evaluate(a),c[f].accumulate(r,s)}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,o=n===en;if(0===e)return-1===i?r:o&&1==(1&i)?t-r:r;if(n===Qt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){var a=Math.floor(r/t);r-=t*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&i))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=an,r.endingEnd=an):(r.endingStart=e?this.zeroSlopeAtStart?an:on:sn,r.endingEnd=t?this.zeroSlopeAtEnd?an:on:sn)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=n,this}}]),e}(),yp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return(0,m.Z)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var d=r[l],f=d.name,p=c[f];if(void 0!==p)o[l]=p;else{if(void 0!==(p=o[l])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,f));continue}var h=t&&t._propertyBindings[l].binding.parsedPath;++(p=new rp(hp.create(n,f,h),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(p,s,f),o[l]=p}a[l].resultBuffer=p.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Ld(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,i=r.uuid,o="string"==typeof e?Zd.findByName(r,e):e,a=null!==o?o.uuid:e,s=this._actionsByClip[a],u=null;if(void 0===n&&(n=null!==o?o.blendMode:un),void 0!==s){var c=s.actionByRoot[i];if(void 0!==c&&c.blendMode===n)return c;u=s.knownActions[0],null===o&&(o=u._clip)}if(null===o)return null;var l=new mp(this,o,t,n);return this._bindAction(l,u),this._addInactiveAction(l,a,i),l}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Zd.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a)t[a]._update(r,e,i,o);for(var s=this._bindings,u=this._nActiveBindings,c=0;c!==u;++c)s[c].apply(o);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var c=u._cacheIndex,l=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,t[c]=l,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(Qn);yp.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var gp=function(){function e(t){(0,v.Z)(this,e),"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return(0,m.Z)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}(),bp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,v.Z)(this,n),(i=t.call(this,e,r)).meshPerAttribute=o,i}return(0,m.Z)(n,[{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"clone",this).call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t}},{key:"toJSON",value:function(e){var t=(0,c.Z)((0,l.Z)(n.prototype),"toJSON",this).call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}]),n}(Yu);bp.prototype.isInstancedInterleavedBuffer=!0;var xp=function(){function e(t,n,r,i,o){(0,v.Z)(this,e),this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=o,this.version=0}return(0,m.Z)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setBuffer",value:function(e){return this.buffer=e,this}},{key:"setType",value:function(e,t){return this.type=e,this.elementSize=t,this}},{key:"setItemSize",value:function(e){return this.itemSize=e,this}},{key:"setCount",value:function(e){return this.count=e,this}}]),e}();xp.prototype.isGLBufferAttribute=!0;var _p=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;(0,v.Z)(this,e),this.ray=new oi(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new yi,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return(0,m.Z)(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"intersectObject",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Mp(e,this,n,t),n.sort(wp),n}},{key:"intersectObjects",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)Mp(e[r],this,n,t);return n.sort(wp),n}}]),e}();function wp(e,t){return e.distance-t.distance}function Mp(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,o=0,a=i.length;o<a;o++)Mp(i[o],t,n,!0)}var Sp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,v.Z)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return(0,m.Z)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ar(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Tp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,v.Z)(this,e),this.radius=t,this.theta=n,this.y=r,this}return(0,m.Z)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ep=new pr,kp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new pr(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new pr(-1/0,-1/0);(0,v.Z)(this,e),this.min=t,this.max=n}return(0,m.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Ep.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Ep.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();kp.prototype.isBox2=!0;var Ap=new Pr,Pp=new Pr,Cp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr;(0,v.Z)(this,e),this.start=t,this.end=n}return(0,m.Z)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){Ap.subVectors(e,this.start),Pp.subVectors(this.end,this.start);var n=Pp.dot(Pp),r=Pp.dot(Ap)/n;return t&&(r=ar(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Op=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).material=e,r.render=function(){},r.hasPositions=!1,r.hasNormals=!1,r.hasColors=!1,r.hasUvs=!1,r.positionArray=null,r.normalArray=null,r.colorArray=null,r.uvArray=null,r.count=0,r}return(0,m.Z)(n)}(Oi);Op.prototype.isImmediateRenderObject=!0;var Ip=new Pr,Rp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){var i;(0,v.Z)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;for(var o=new xo,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,u=1;s<32;s++,u++){var c=s/32*Math.PI*2,l=u/32*Math.PI*2;a.push(Math.cos(c),Math.sin(c),1,Math.cos(l),Math.sin(l),1)}o.setAttribute("position",new lo(a,3));var d=new Rc({fog:!1,toneMapped:!1});return i.cone=new Gc(o,d),i.add(i.cone),i.update(),i}return(0,m.Z)(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Ip.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ip),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(Oi),Np=new Pr,Dp=new ai,Lp=new ai,Bp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;(0,v.Z)(this,n);for(var i=Fp(e),o=new xo,a=[],s=[],u=new Ji(0,0,1),c=new Ji(0,1,0),l=0;l<i.length;l++){var d=i[l];d.parent&&d.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),s.push(u.r,u.g,u.b),s.push(c.r,c.g,c.b))}o.setAttribute("position",new lo(a,3)),o.setAttribute("color",new lo(s,3));var f=new Rc({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,o,f)).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=e,r.bones=i,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return(0,m.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,i=r.getAttribute("position");Lp.copy(this.root.matrixWorld).invert();for(var o=0,a=0;o<t.length;o++){var s=t[o];s.parent&&s.parent.isBone&&(Dp.multiplyMatrices(Lp,s.matrixWorld),Np.setFromMatrixPosition(Dp),i.setXYZ(a,Np.x,Np.y,Np.z),Dp.multiplyMatrices(Lp,s.parent.matrixWorld),Np.setFromMatrixPosition(Dp),i.setXYZ(a+1,Np.x,Np.y,Np.z),a+=2)}r.getAttribute("position").needsUpdate=!0,(0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(Gc);function Fp(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,Fp(e.children[n]));return t}var jp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;(0,v.Z)(this,n);var a=new vd(r,4,2),s=new Qi({wireframe:!0,fog:!1,toneMapped:!1});return(o=t.call(this,a,s)).light=e,o.light.updateMatrixWorld(),o.color=i,o.type="PointLightHelper",o.matrix=o.light.matrixWorld,o.matrixAutoUpdate=!1,o.update(),o}return(0,m.Z)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(Fo),zp=new Pr,Up=new Ji,Gp=new Ji,Vp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;(0,v.Z)(this,n),(o=t.call(this)).light=e,o.light.updateMatrixWorld(),o.matrix=e.matrixWorld,o.matrixAutoUpdate=!1,o.color=i;var a=new fd(r);a.rotateY(.5*Math.PI),o.material=new Qi({wireframe:!0,fog:!1,toneMapped:!1}),void 0===o.color&&(o.material.vertexColors=!0);var s=a.getAttribute("position"),u=new Float32Array(3*s.count);return a.setAttribute("color",new to(u,3)),o.add(new Fo(a,o.material)),o.update(),o}return(0,m.Z)(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Up.copy(this.light.color),Gp.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?Up:Gp;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(zp.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(Oi),Wp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;(0,v.Z)(this,n),o=new Ji(o),a=new Ji(a);for(var s=i/2,u=r/i,c=r/2,l=[],d=[],f=0,p=0,h=-c;f<=i;f++,h+=u){l.push(-c,0,h,c,0,h),l.push(h,0,-c,h,0,c);var m=f===s?o:a;m.toArray(d,p),p+=3,m.toArray(d,p),p+=3,m.toArray(d,p),p+=3,m.toArray(d,p),p+=3}var y=new xo;y.setAttribute("position",new lo(l,3)),y.setAttribute("color",new lo(d,3));var g=new Rc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,y,g)).type="GridHelper",e}return(0,m.Z)(n)}(Gc),Hp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;(0,v.Z)(this,n),s=new Ji(s),u=new Ji(u);for(var c=[],l=[],d=0;d<=i;d++){var f=d/i*(2*Math.PI),p=Math.sin(f)*r,h=Math.cos(f)*r;c.push(0,0,0),c.push(p,0,h);var m=1&d?s:u;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(var y=0;y<=o;y++)for(var g=1&y?s:u,b=r-r/o*y,x=0;x<a;x++){var _=x/a*(2*Math.PI),w=Math.sin(_)*b,M=Math.cos(_)*b;c.push(w,0,M),l.push(g.r,g.g,g.b),_=(x+1)/a*(2*Math.PI),w=Math.sin(_)*b,M=Math.cos(_)*b,c.push(w,0,M),l.push(g.r,g.g,g.b)}var S=new xo;S.setAttribute("position",new lo(c,3)),S.setAttribute("color",new lo(l,3));var T=new Rc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,S,T)).type="PolarGridHelper",e}return(0,m.Z)(n)}(Gc),Zp=new Pr,qp=new Pr,Yp=new Pr,Xp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e,r,i){var o;(0,v.Z)(this,n),(o=t.call(this)).light=e,o.light.updateMatrixWorld(),o.matrix=e.matrixWorld,o.matrixAutoUpdate=!1,o.color=i,void 0===r&&(r=1);var a=new xo;a.setAttribute("position",new lo([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new Rc({fog:!1,toneMapped:!1});return o.lightPlane=new jc(a,s),o.add(o.lightPlane),(a=new xo).setAttribute("position",new lo([0,0,0,0,0,1],3)),o.targetLine=new jc(a,s),o.add(o.targetLine),o.update(),o}return(0,m.Z)(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){Zp.setFromMatrixPosition(this.light.matrixWorld),qp.setFromMatrixPosition(this.light.target.matrixWorld),Yp.subVectors(qp,Zp),this.lightPlane.lookAt(qp),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(qp),this.targetLine.scale.z=Yp.length()}}]),n}(Oi),Kp=new Pr,Jp=new Ho,Qp=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;(0,v.Z)(this,n);var i=new xo,o=new Rc({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],s=[],u={},c=new Ji(16755200),l=new Ji(16711680),d=new Ji(43775),f=new Ji(16777215),p=new Ji(3355443);function h(e,t,n){m(e,n),m(t,n)}function m(e,t){a.push(0,0,0),s.push(t.r,t.g,t.b),void 0===u[e]&&(u[e]=[]),u[e].push(a.length/3-1)}return h("n1","n2",c),h("n2","n4",c),h("n4","n3",c),h("n3","n1",c),h("f1","f2",c),h("f2","f4",c),h("f4","f3",c),h("f3","f1",c),h("n1","f1",c),h("n2","f2",c),h("n3","f3",c),h("n4","f4",c),h("p","n1",l),h("p","n2",l),h("p","n3",l),h("p","n4",l),h("u1","u2",d),h("u2","u3",d),h("u3","u1",d),h("c","t",f),h("p","c",p),h("cn1","cn2",p),h("cn3","cn4",p),h("cf1","cf2",p),h("cf3","cf4",p),i.setAttribute("position",new lo(a,3)),i.setAttribute("color",new lo(s,3)),(r=t.call(this,i,o)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=u,r.update(),r}return(0,m.Z)(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;Jp.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$p("c",t,e,Jp,0,0,-1),$p("t",t,e,Jp,0,0,1),$p("n1",t,e,Jp,-1,-1,-1),$p("n2",t,e,Jp,1,-1,-1),$p("n3",t,e,Jp,-1,1,-1),$p("n4",t,e,Jp,1,1,-1),$p("f1",t,e,Jp,-1,-1,1),$p("f2",t,e,Jp,1,-1,1),$p("f3",t,e,Jp,-1,1,1),$p("f4",t,e,Jp,1,1,1),$p("u1",t,e,Jp,.7,1.1,-1),$p("u2",t,e,Jp,-.7,1.1,-1),$p("u3",t,e,Jp,0,2,-1),$p("cf1",t,e,Jp,-1,0,1),$p("cf2",t,e,Jp,1,0,1),$p("cf3",t,e,Jp,0,-1,1),$p("cf4",t,e,Jp,0,1,1),$p("cn1",t,e,Jp,-1,0,-1),$p("cn2",t,e,Jp,1,0,-1),$p("cn3",t,e,Jp,0,-1,-1),$p("cn4",t,e,Jp,0,1,-1),e.getAttribute("position").needsUpdate=!0}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(Gc);function $p(e,t,n,r,i,o,a){Kp.set(i,o,a).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),c=0,l=s.length;c<l;c++)u.setXYZ(s[c],Kp.x,Kp.y,Kp.z)}var eh,th,nh=new Ir,rh=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,v.Z)(this,n);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(24),s=new xo;return s.setIndex(new to(o,1)),s.setAttribute("position",new to(a,3)),(r=t.call(this,s,new Rc({color:i,toneMapped:!1}))).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}return(0,m.Z)(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&nh.setFromObject(this.object),!nh.isEmpty()){var t=nh.min,n=nh.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return Gc.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(Gc),ih=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,v.Z)(this,n);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new xo;return s.setIndex(new to(o,1)),s.setAttribute("position",new lo(a,3)),(r=t.call(this,s,new Rc({color:i,toneMapped:!1}))).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return(0,m.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),(0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(Gc),oh=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;(0,v.Z)(this,n);var a=o,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],u=new xo;u.setAttribute("position",new lo(s,3)),u.computeBoundingSphere(),(r=t.call(this,u,new Rc({color:a,toneMapped:!1}))).type="PlaneHelper",r.plane=e,r.size=i;var c=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],l=new xo;return l.setAttribute("position",new lo(c,3)),l.computeBoundingSphere(),r.add(new Fo(l,new Qi({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}return(0,m.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?O:C,this.lookAt(this.plane.normal),(0,c.Z)((0,l.Z)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(jc),ah=new Pr,sh=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr(0,0,1),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pr(0,0,0),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*o,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*s;return(0,v.Z)(this,n),(e=t.call(this)).type="ArrowHelper",void 0===eh&&((eh=new xo).setAttribute("position",new lo([0,0,0,0,1,0],3)),(th=new nl(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(i),e.line=new jc(eh,new Rc({color:a,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new Fo(th,new Qi({color:a,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(o,s,u),e}return(0,m.Z)(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{ah.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(ah,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return(0,c.Z)((0,l.Z)(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(Oi),uh=function(e){(0,p.Z)(n,e);var t=(0,h.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,v.Z)(this,n);var i=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],a=new xo;a.setAttribute("position",new lo(i,3)),a.setAttribute("color",new lo(o,3));var s=new Rc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,a,s)).type="AxesHelper",e}return(0,m.Z)(n,[{key:"setColors",value:function(e,t,n){var r=new Ji,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(Gc),ch=function(){function e(){(0,v.Z)(this,e),this.type="ShapePath",this.color=new Ji,this.subPaths=[],this.currentPath=null}return(0,m.Z)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new Il,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,o){return this.currentPath.bezierCurveTo(e,t,n,r,i,o),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Rl;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=t[o],u=-u,s=t[i],c=-c),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var l=c*(e.x-a.x)-u*(e.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return r}var i,o,a,s=od.isClockWise,u=this.subPaths;if(0===u.length)return[];if(!0===t)return n(u);var c=[];if(1===u.length)return o=u[0],(a=new Rl).curves=o.curves,c.push(a),c;var l=!s(u[0].getPoints());l=e?!l:l;var d,f,p=[],h=[],v=[],m=0;h[m]=void 0,v[m]=[];for(var y=0,g=u.length;y<g;y++)i=s(d=(o=u[y]).getPoints()),(i=e?!i:i)?(!l&&h[m]&&m++,h[m]={s:new Rl,p:d},h[m].s.curves=o.curves,l&&m++,v[m]=[]):v[m].push({h:o,p:d[0]});if(!h[0])return n(u);if(h.length>1){for(var b=!1,x=[],_=0,w=h.length;_<w;_++)p[_]=[];for(var M=0,S=h.length;M<S;M++)for(var T=v[M],E=0;E<T.length;E++){for(var k=T[E],A=!0,P=0;P<h.length;P++)r(k.p,h[P].p)&&(M!==P&&x.push({froms:M,tos:P,hole:E}),A?(A=!1,p[P].push(k)):b=!0);A&&p[M].push(k)}x.length>0&&(b||(v=p))}for(var C=0,O=h.length;C<O;C++){a=h[C].s,c.push(a);for(var I=0,R=(f=v[C]).length;I<R;I++)a.holes.push(f[I].h)}return c}}]),e}(),lh=new Float32Array(1),dh=new Int32Array(lh.buffer),fh=function(){function e(){(0,v.Z)(this,e)}return(0,m.Z)(e,null,[{key:"toHalfFloat",value:function(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),lh[0]=e;var t=dh[0],n=t>>16&32768,r=t>>12&2047,i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)}}]),e}(),ph=0,hh=1,vh=0,mh=1,yh=2;function gh(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function bh(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function xh(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Xc(e,t)}function _h(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new dc(e)}function wh(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Xc(e,t)}function Mh(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Wc(e)}function Sh(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Wc(e)}function Th(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Wc(e)}function Eh(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Pr(e,t,n)}function kh(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new to(e,t).setUsage(Gn)}function Ah(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new no(e,t)}function Ph(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ro(e,t)}function Ch(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new io(e,t)}function Oh(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new oo(e,t)}function Ih(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ao(e,t)}function Rh(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new so(e,t)}function Nh(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new uo(e,t)}function Dh(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new lo(e,t)}function Lh(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new fo(e,t)}function Bh(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new uh(e)}function Fh(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rh(e,t)}function jh(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Gc(new ll(e.geometry),new Rc({color:void 0!==t?t:16777215}))}function zh(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Gc(new xd(e.geometry),new Rc({color:void 0!==t?t:16777215}))}function Uh(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new $d(e)}function Gh(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new of(e)}function Vh(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ko(e,n)}function Wh(){console.error("THREE.CanvasRenderer has been removed")}function Hh(){console.error("THREE.JSONLoader has been removed.")}dl.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(dl.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Il.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},Wp.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Bp.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Jd.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),kf.extractUrlBase(e)},Jd.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},kp.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},kp.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},kp.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},kp.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Ir.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ir.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ir.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ir.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Ir.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Jr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ra.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Cp.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},hr.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},hr.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},hr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},hr.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},hr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},hr.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ai.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},ai.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},ai.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Pr).setFromMatrixColumn(this,3)},ai.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},ai.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},ai.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ai.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ai.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},ai.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},ai.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ai.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},ai.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},ai.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},ai.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},ai.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},ai.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},ai.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},ai.prototype.makeFrustum=function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)},ai.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ea.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ar.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Ar.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},oi.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},oi.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},oi.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Gi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Gi.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Gi.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Gi.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Gi.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Gi.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Gi.getBarycoord(e,t,n,r,i)},Gi.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Gi.getNormal(e,t,n,r)},Rl.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Rl.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ud(this,e)},Rl.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new hd(this,e)},pr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},pr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},pr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Pr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Pr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Pr.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Pr.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Pr.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Pr.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Pr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Pr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Pr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Sr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Sr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Oi.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Oi.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Oi.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Oi.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Oi.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Oi.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Fo.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Fo.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),ln},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),_c.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Zo.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(sf.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(to.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Gn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Gn)}}}),to.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Gn:Un),this},to.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},to.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},xo.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},xo.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new to(arguments[1],arguments[2])))},xo.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},xo.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},xo.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},xo.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},xo.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(xo.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Yu.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Gn:Un),this},Yu.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ud.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},ud.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},ud.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},qu.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},gp.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Wi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ji}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===R}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Wo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Vu.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},Vu.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},Vu.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Vu.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Vu.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Vu.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Vu.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Vu.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Vu.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Vu.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Vu.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Vu.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Vu.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Vu.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Vu.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},Vu.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Vu.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Vu.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Vu.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Vu.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Vu.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Vu.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Vu.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Vu.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Vu.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Vu.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?hn:pn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Iu.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Tr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Kf.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Bf).load(e,(function(e){t.setBuffer(e)})),this},np.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Yo.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Yo.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},xr.crossOrigin=void 0,xr.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new af;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},xr.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new rf;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},xr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},xr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Zh={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function qh(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function Yh(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new xo}function Xh(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new xo}function Kh(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function Jh(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:b}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=b)},8190:function(e,t,n){var r=n(16525).default,i=n(29754).default,o=n(69100).default,a=n(81506).default,s=n(319).default,u=n(48926).default,c=n(81109).default,l=n(2205).default,d=n(99842).default,f=n(43269).default,p=n(87757),h=n(63038).default,v=n(34575).default,m=n(93913).default;"undefined"!=typeof self&&self,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://apps-cdn.cogniteapp.com/@cognite/reveal-parser-worker/1.3.0/",n(n.s=65)}([function(e,t){e.exports=n(70497)},function(e,t,n){"use strict";function r(e,t){if(t(e))for(var n=0;n<e.children.length;n++)r(e.children[n],t)}function i(e,t){if(void 0!==e){var n=e.position,r=e.target;return n.applyMatrix4(t),r.applyMatrix4(t),{position:n,target:r}}}n.d(t,"u",(function(){return r})),n.d(t,"t",(function(){return i})),n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return x})),n.d(t,"o",(function(){return _})),n.d(t,"l",(function(){return w})),n.d(t,"i",(function(){return M})),n.d(t,"m",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"r",(function(){return I})),n.d(t,"c",(function(){return L})),n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return z})),n.d(t,"p",(function(){return U})),n.d(t,"q",(function(){return G})),n.d(t,"j",(function(){return V})),n.d(t,"k",(function(){return q})),n.d(t,"g",(function(){return X})),n.d(t,"h",(function(){return K})),n.d(t,"n",(function(){return J})),n.d(t,"s",(function(){return H}));var o=n(0),a=function(){function e(){v(this,e)}return m(e,null,[{key:"color",value:function(t){var n=e._colors.get(t);if(void 0!==n)return n;var r=e.generateRandomColor();return e._colors.set(t,r),r}},{key:"colorRGB",value:function(t){var n=e.color(t);return[Math.floor(255*n.r),Math.floor(255*n.g),Math.floor(255*n.b)]}},{key:"colorCSS",value:function(t){var n=e.colorRGB(t),r=h(n,3),i=r[0],o=r[1],a=r[2];return"rgb(".concat(i,", ").concat(o,", ").concat(a,")")}},{key:"generateRandomColor",value:function(){var e=Math.random(),t=.4+.6*Math.random(),n=.3+.4*Math.random();return(new o.Color).setHSL(e,t,n)}}]),e}();function s(e,t){var n=t.getBoundingClientRect();if(e instanceof MouseEvent)return{offsetX:e.clientX-n.left,offsetY:e.clientY-n.top};if(e.changedTouches.length>0){var r=e.changedTouches[0];return{offsetX:r.clientX-n.left,offsetY:r.clientY-n.top}}return{offsetX:-1,offsetY:-1}}a._colors=new Map;var y=function(){function e(){v(this,e),this._listeners=[]}return m(e,[{key:"subscribe",value:function(e){this._listeners.push(e)}},{key:"unsubscribe",value:function(e){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},{key:"unsubscribeAll",value:function(){this._listeners.splice(0)}},{key:"fire",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._listeners.forEach((function(e){return e.apply(void 0,t)}))}}]),e}(),g=n(14),b=n.n(g),x=function(){function e(t){var n=this;v(this,e),this._events={click:new y,hover:new y},this.onHoverCallback=b()((function(e){n._events.hover.fire(s(e,n.domElement))}),100),this.domElement=t,this.setupEventListeners()}return m(e,[{key:"on",value:function(e,t){switch(e){case"click":this._events.click.subscribe(t);break;case"hover":this._events.hover.subscribe(t);break;default:w(e)}}},{key:"off",value:function(e,t){switch(e){case"click":this._events.click.unsubscribe(t);break;case"hover":this._events.hover.unsubscribe(t);break;default:w(e)}}},{key:"dispose",value:function(){_(this._events)}},{key:"setupEventListeners",value:function(){var e=this,t=this.domElement,n=!1,r=0,i=!1,a=new o.Vector2,u=function o(s){e.handleClickEvent(s,a,n,i,r),n=!1,i=!1,t.removeEventListener("mouseup",o),t.removeEventListener("touchend",o),t.addEventListener("mousemove",e.onHoverCallback)},c=function(o){n=!0,i=!0,r=o.timeStamp;var c=s(o,t),l=c.offsetX,d=c.offsetY;a.set(l,d),t.addEventListener("mouseup",u),t.addEventListener("touchend",u),t.removeEventListener("mousemove",e.onHoverCallback)};t.addEventListener("mousedown",c),t.addEventListener("touchstart",c),t.addEventListener("mousemove",this.onHoverCallback)}},{key:"isProperClick",value:function(t,n,r,i,o){var a=s(t,this.domElement),u=a.offsetX,c=a.offsetY,l=t.timeStamp-o,d=Math.abs(u-n.x)+Math.abs(c-n.y)>e.maxMoveDistance;return r&&i&&l<e.maxClickDuration&&!d}},{key:"handleClickEvent",value:function(e,t,n,r,i){this.isProperClick(e,t,n,r,i)&&this._events.click.fire(s(e,this.domElement))}}]),e}();function _(e){for(var t=0,n=Object.keys(e);t<n.length;t++)e[n[t]].unsubscribeAll()}function w(e,t){throw new Error(t||"Unexpected object: "+e)}x.maxMoveDistance=8,x.maxClickDuration=250;var M=function(){function e(t,n){if(v(this,e),n<0)throw new Error("Range cannot have negative number of elements");this.from=t,this.count=n,this.toInclusive=t+n-1}return m(e,[{key:"values",value:p.mark((function e(){var t;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.from;case 1:if(!(t<=this.toInclusive)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"toArray",value:function(){return Array.from(this.values())}},{key:"equal",value:function(e){return this.from===e.from&&this.count===e.count}},{key:"contains",value:function(e){return e>=this.from&&e<=this.toInclusive}},{key:"intersects",value:function(e){return this.from<=e.toInclusive&&this.toInclusive>=e.from}},{key:"intersectsOrCoinciding",value:function(e){return this.from<=e.toInclusive+1&&this.toInclusive+1>=e.from}},{key:"intersectionWith",value:function(t){return this.intersects(t)?e.createFromInterval(Math.max(this.from,t.from),Math.min(this.toInclusive,t.toInclusive)):void 0}},{key:"isInside",value:function(e){return this.from>=e.from&&this.toInclusive<=e.toInclusive}},{key:"union",value:function(t){return e.createFromInterval(Math.min(this.from,t.from),Math.max(this.toInclusive,t.toInclusive))}},{key:"forEach",value:function(e){for(var t=this.from;t<=this.toInclusive;++t)e(t)}},{key:"toString",value:function(){return"("+this.from+", "+this.toInclusive+")"}}],[{key:"createFromInterval",value:function(t,n){return new e(t,n-t+1)}},{key:"isNumericRange",value:function(e){if(!e)return!1;var t=e;return void 0!==t.from&&void 0!==t.count&&void 0!==t.toInclusive}}]),e}();function S(e){var t=Math.max(1,E(Math.sqrt(e)));return{width:t,height:Math.max(1,E(e/t))}}var T=Math.log(2);function E(e){return Math.pow(2,Math.ceil(Math.log(e)/T))}var k=n(7),A=n.n(k),P=function(){function e(t,n){v(this,e),this.left=t,this.right=n,this.maxSubtreeDepth=Math.max(this.left.maxSubtreeDepth,this.right.maxSubtreeDepth)+1,this.range=M.createFromInterval(this.left.range.from,this.right.range.toInclusive),this.count=this.left.count+this.right.count}return m(e,[{key:"traverse",value:function(e){this.left.traverse(e),this.right.traverse(e)}},{key:"contains",value:function(e){return!!this.range.contains(e)&&(this.left.contains(e)||this.right.contains(e))}},{key:"addRange",value:function(t){if(!t.intersectsOrCoinciding(this.range)){if(t.from<this.range.from){var n=this.left.addRange(t);return e.fromIndexNodesAndBalance(n,this.right)}var r=this.right.addRange(t);return e.fromIndexNodesAndBalance(this.left,r)}var i=t.intersectsOrCoinciding(this.left.range),o=t.intersectsOrCoinciding(this.right.range);if(i&&o){var a=this.left.soak(t),s=h(a,2),u=s[0],c=s[1],l=this.right.soak(t),d=h(l,2),f=d[0],p=d[1],v=c.union(p);return void 0===u&&void 0===f?new C(v):void 0===u&&void 0!==f?f.addRange(v):void 0===f&&void 0!==u?u.addRange(v):e.fromIndexNodesAndBalance(u,f).addRange(v)}return i?e.fromIndexNodesAndBalance(this.left.addRange(t),this.right):o?e.fromIndexNodesAndBalance(this.left,this.right.addRange(t)):this.left.maxSubtreeDepth<this.right.maxSubtreeDepth?e.fromIndexNodesAndBalance(this.left.addRange(t),this.right):e.fromIndexNodesAndBalance(this.left,this.right.addRange(t))}},{key:"removeRange",value:function(t){if(!t.intersects(this.range))return this;var n=this.soak(t),r=h(n,2),i=r[0],o=r[1],a=void 0,s=void 0;if(o.from<t.from&&(a=M.createFromInterval(o.from,t.from-1)),o.toInclusive>t.toInclusive&&(s=M.createFromInterval(t.toInclusive+1,o.toInclusive)),void 0===i)return void 0!==a&&void 0!==s?e.fromIndexNodesAndBalance(new C(a),new C(s)):null!=a?new C(a):null!=s?new C(s):void 0;var u=i;return void 0!==a&&(u=u.addRange(a)),void 0!==s&&(u=u.addRange(s)),u}},{key:"balance",value:function(){var t=this.left.maxSubtreeDepth,n=this.right.maxSubtreeDepth;if(n+2<=t)return new e(this.left.rotateSmallerRight(),this.right).rotateRight().balance();if(t+2<=n){var r=this.right.rotateSmallerLeft();return new e(this.left,r).rotateLeft().balance()}return this}},{key:"clone",value:function(){return e.fromIndexNodesAndBalance(this.left.clone(),this.right.clone())}},{key:"hasIntersectionWith",value:function(e){return!!e.range.intersects(this.range)&&(this.range.isInside(e.range)?e.hasIntersectionWith(this):!(!this.left.range.intersects(e.range)||!this.left.hasIntersectionWith(e))||!(!this.right.range.intersects(e.range)||!this.right.hasIntersectionWith(e)))}},{key:"soak",value:function(t){var n,r,i,o,a=[this.left,t],s=a[0],u=a[1],c=[this.right,t],l=c[0],d=c[1];if(this.right.range.isInside(t)&&this.left.range.isInside(t))return[void 0,t];this.left.range.intersectsOrCoinciding(t)&&(n=this.left.soak(t),s=(r=h(n,2))[0],u=r[1]),this.right.range.intersectsOrCoinciding(t)&&(i=this.right.soak(t),l=(o=h(i,2))[0],d=o[1]);var f=u.union(d);return null==l?[s,f]:null==s?[l,f]:[e.fromIndexNodesAndBalance(s,l),f]}},{key:"rotateRight",value:function(){return"right"in this.left?new e(this.left.left,new e(this.left.right,this.right)):this}},{key:"rotateLeft",value:function(){return"left"in this.right?new e(new e(this.left,this.right.left),this.right.right):this}},{key:"rotateSmallerLeft",value:function(){if(this.left.maxSubtreeDepth>this.right.maxSubtreeDepth){var e=this.rotateRight();return e.rotateSmallerLeft()}return this}},{key:"rotateSmallerRight",value:function(){if(this.right.maxSubtreeDepth>this.left.maxSubtreeDepth){var e=this.rotateLeft();return e.rotateSmallerRight()}return this}}],[{key:"fromIndexNodesAndBalance",value:function(t,n){return t.range.from>n.range.toInclusive+1?new e(n,t).balance():t.range.toInclusive+1<n.range.from?new e(t,n).balance():void A()(!1,"Internal error in IndexSet: Overlapping nodes")}}]),e}(),C=function(){function e(t){v(this,e),this.range=t,this.maxSubtreeDepth=0,this.count=t.count}return m(e,[{key:"traverse",value:function(e){e(this.range)}},{key:"contains",value:function(e){return this.range.contains(e)}},{key:"addRange",value:function(t){return this.range.intersectsOrCoinciding(t)?new e(this.range.union(t)):P.fromIndexNodesAndBalance(this,new e(t))}},{key:"removeRange",value:function(t){if(!t.intersects(this.range))return this;if(!this.range.isInside(t)){var n=void 0,r=void 0;return this.range.from<t.from&&(n=M.createFromInterval(this.range.from,t.from-1)),this.range.toInclusive>t.toInclusive&&(r=M.createFromInterval(t.toInclusive+1,this.range.toInclusive)),null!=n&&null!=r?P.fromIndexNodesAndBalance(new e(n),new e(r)):null!=n?new e(n):null!=r?new e(r):void 0}}},{key:"hasIntersectionWith",value:function(e){return e.range.intersects(this.range)}},{key:"soak",value:function(e){return this.range.intersectsOrCoinciding(e)?[void 0,this.range.union(e)]:[this,e]}},{key:"clone",value:function(){return new e(this.range)}}],[{key:"fromInterval",value:function(t,n){return new e(M.createFromInterval(t,n))}}]),e}(),O=function(){function e(t){if(v(this,e),null==t)this.rootNode=void 0;else if(M.isNumericRange(t))this.addRange(t);else{var n,r=f(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.add(i)}}catch(e){r.e(e)}finally{r.f()}}}return m(e,[{key:"forEachRange",value:function(e){this.rootNode&&this.rootNode.traverse(e)}},{key:"add",value:function(e){var t=new M(e,1);this.addRange(t)}},{key:"addRange",value:function(e){this.rootNode?this.rootNode=this.rootNode.addRange(e):this.rootNode=new C(e)}},{key:"remove",value:function(e){var t=new M(e,1);this.removeRange(t)}},{key:"removeRange",value:function(e){this.rootNode&&(this.rootNode=this.rootNode.removeRange(e))}},{key:"contains",value:function(e){return!!this.rootNode&&this.rootNode.contains(e)}},{key:"count",get:function(){return this.rootNode?this.rootNode.count:0}},{key:"toRangeArray",value:function(){var e=[];return this.forEachRange((function(t){e.push(t)})),e}},{key:"toIndexArray",value:function(){var e=[];return this.rootNode&&this.forEachRange((function(t){t.forEach((function(t){e.push(t)}))})),e}},{key:"toPlainSet",value:function(){var e=this.toIndexArray();return new Set(e)}},{key:"invertedRanges",value:function(){for(var e=this.toRangeArray(),t=[],n=0;n<e.length-1;n++)e[n].toInclusive+1>=e[n+1].from||t.push(M.createFromInterval(e[n].toInclusive+1,e[n+1].from-1));return t}},{key:"unionWith",value:function(e){var t=this;return this.rootNode?e.forEachRange((function(e){t.rootNode=t.rootNode.addRange(e)})):this.rootNode=e.rootNode,this}},{key:"differenceWith",value:function(e){var t=this;return this.rootNode&&e.forEachRange((function(e){var n;t.rootNode=null===(n=t.rootNode)||void 0===n?void 0:n.removeRange(e)})),this}},{key:"hasIntersectionWith",value:function(t){if(t instanceof e)return void 0!==this.rootNode&&void 0!==t.rootNode&&this.rootNode.hasIntersectionWith(t.rootNode);var n,r=f(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(this.contains(i))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"intersectWith",value:function(e){var t=this;if(this.rootNode&&e.rootNode){if(this.rootNode.range.from<e.rootNode.range.from){var n=M.createFromInterval(this.rootNode.range.from,e.rootNode.range.from-1);if(this.rootNode=this.rootNode.removeRange(n),!this.rootNode)return this}if(this.rootNode.range.toInclusive>e.rootNode.range.toInclusive){var r=M.createFromInterval(e.rootNode.range.toInclusive+1,this.rootNode.range.toInclusive);this.rootNode=this.rootNode.removeRange(r)}e.invertedRanges().forEach((function(e){t.rootNode&&(t.rootNode=t.rootNode.removeRange(e))}))}else this.rootNode&&(this.rootNode=void 0);return this}},{key:"clear",value:function(){this.rootNode=void 0}},{key:"clone",value:function(){var t=new e;return this.rootNode&&(t.rootNode=this.rootNode.clone()),t}}]),e}();function I(e,t,n){var r=function(e){return Math.abs(e)}(e);if(0!=r){var i=function(e,t){return t<e?0:1}(0,-e),o=D(function(e){return Math.log(e)/Math.log(2)}(r)),a=r/R(o);a<1&&(o-=1),o+=127,t[n]=128*i+D(o*R(-1)),t[n+1]=128*N(o,2)+N(D(128*a),128),t[n+2]=D(N(D(a*R(15)),R(8))),t[n+3]=D(R(23)*N(a,R(-15)))}}function R(e){return Math.pow(2,e)}function N(e,t){return e-t*D(e/t)}function D(e){return Math.floor(e)}var L=function(){function e(t,n){v(this,e),this._numFilled=0,this._batchIdCounter=0,this._batchMap=new Map,this._type=n;var r=Math.pow(2,Math.ceil(Math.log2(t)));this._buffer=new n(r)}return m(e,[{key:"length",get:function(){return this._numFilled}},{key:"buffer",get:function(){return this._buffer}},{key:"add",value:function(e){var t=!1;if(this._numFilled+e.length>this._buffer.length){var n=Math.pow(2,Math.ceil(Math.log2(this._numFilled+e.length)));this.allocateNewBuffer(n),t=!0}this._buffer.set(e,this._numFilled);var r=this.createBatch(e);return this._numFilled+=e.length,{batchId:r,bufferIsReallocated:t}}},{key:"remove",value:function(e){var t=this._batchMap.get(e);if(!t)throw new Error("batch does not exist in buffer");this._buffer.copyWithin(t.from,t.from+t.count,this.buffer.length),this._numFilled-=t.count,this._currentTail===t&&(this._currentTail=t.prev);var n=t.prev,r=t.next;n&&(n.next=r),r&&(r.prev=n);for(var i=r;i;)i.from-=t.count,i=i.next;this._batchMap.delete(e)}},{key:"createBatch",value:function(e){var t={from:this._numFilled,count:e.length,prev:this._currentTail,next:void 0};this._currentTail&&(this._currentTail.next=t),this._currentTail=t;var n=this._batchIdCounter;return this._batchIdCounter++,this._batchMap.set(n,t),n}},{key:"allocateNewBuffer",value:function(e){var t=new this._type(e);t.set(this._buffer),this._buffer=t}}]),e}(),B=new o.BufferGeometry,F=function(e){l(n,e);var t=d(n);function n(){var e;return v(this,n),(e=t.apply(this,arguments))._isDisposed=!1,e._referenceCount=0,e}return m(n,[{key:"reference",value:function(){this.ensureNotDisposed(),this._referenceCount++}},{key:"dereference",value:function(){if(this.ensureNotDisposed(),0===this._referenceCount)throw new Error("No references");0==--this._referenceCount&&this.dispose()}},{key:"dispose",value:function(){this.ensureNotDisposed(),this._isDisposed=!0;var e,t=this.children.filter((function(e){return e instanceof o.Mesh})).map((function(e){return e})),n=f(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;void 0!==r.geometry&&(r.geometry.dispose(),r.geometry=B)}}catch(e){n.e(e)}finally{n.f()}}},{key:"ensureNotDisposed",value:function(){if(this._isDisposed)throw new Error("Already disposed/dereferenced")}}]),n}(o.Group),j={camPos:new o.Vector3,bounds:new o.Box3},z=function(e){l(n,e);var t=d(n);function n(e){var r;return v(this,n),(r=t.call(this))._activeLevel=0,r._levels=[],r.isLOD=!0,r.autoUpdate=!0,r._boundingBox=e.clone(),r.type="BoundingBoxLOD",r}return m(n,[{key:"setBoundingBox",value:function(e){this._boundingBox.copy(e)}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._levels.push({object:e,distance:Math.abs(t)}),this._levels.sort((function(e,t){return t.distance-e.distance})),e.visible=!1,this.add(e)}},{key:"getCurrentLevel",value:function(){return this._levels.length>0?this._levels.length-this._activeLevel-1:0}},{key:"update",value:function(e){this.updateCurrentLevel(e)}},{key:"updateCurrentLevel",value:function(e){var t=this._levels,n=j.camPos,r=j.bounds;r.copy(this._boundingBox).applyMatrix4(this.matrixWorld);var i=e instanceof o.PerspectiveCamera?e.zoom:1;if(t.length>0){n.setFromMatrixPosition(e.matrixWorld);var a=r.distanceToPoint(n)/i;t[this._activeLevel].object.visible=!1,this._activeLevel=t.findIndex((function(e){return a>=e.distance})),this._activeLevel=this._activeLevel>=0?this._activeLevel:t.length-1,t[this._activeLevel].object.visible=!0}}}]),n}(o.Object3D);function U(e){return[new o.Vector3(e.min.x,e.min.y,e.min.z),new o.Vector3(e.min.x,e.min.y,e.max.z),new o.Vector3(e.min.x,e.max.y,e.min.z),new o.Vector3(e.min.x,e.max.y,e.max.z),new o.Vector3(e.max.x,e.min.y,e.min.z),new o.Vector3(e.max.x,e.min.y,e.max.z),new o.Vector3(e.max.x,e.max.y,e.min.z),new o.Vector3(e.max.x,e.max.y,e.max.z)]}function G(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}var V=function(){function e(t){v(this,e),this._originalState={},this._renderer=t,this._originalState={}}return m(e,[{key:"setClearColor",value:function(e,t){this._originalState=c({clearColor:this._renderer.getClearColor(new o.Color),clearAlpha:this._renderer.getClearAlpha()},this._originalState),this._renderer.setClearColor(e,t)}},{key:"setSize",value:function(e,t){this._originalState=c({size:this._renderer.getSize(new o.Vector2)},this._originalState),this._renderer.setSize(e,t)}},{key:"localClippingEnabled",set:function(e){this._originalState=c({localClippingEnabled:this._renderer.localClippingEnabled},this._originalState),this._renderer.localClippingEnabled=e}},{key:"autoClear",set:function(e){this._originalState=c({autoClear:this._renderer.autoClear},this._originalState),this._renderer.autoClear=e}},{key:"setRenderTarget",value:function(e){this._originalState=c({renderTarget:this._renderer.getRenderTarget()},this._originalState),this._renderer.setRenderTarget(e)}},{key:"resetState",value:function(){void 0!==this._originalState.autoClear&&(this._renderer.autoClear=this._originalState.autoClear),void 0!==this._originalState.clearColor&&this._renderer.setClearColor(this._originalState.clearColor,this._originalState.clearAlpha),void 0!==this._originalState.localClippingEnabled&&(this._renderer.localClippingEnabled=this._originalState.localClippingEnabled),void 0!==this._originalState.size&&this._renderer.setSize(this._originalState.size.width,this._originalState.size.height),void 0!==this._originalState.renderTarget&&this._renderer.setRenderTarget(this._originalState.renderTarget),this._originalState={}}}]),e}(),W=n(22),H={publicPath:""},Z=n(10),q=function(){function e(){v(this,e),this.workerList=[];for(var t,n=this.determineNumberOfWorkers(),r=0;r<n;r++){var i={worker:Object(W.wrap)(this.createWorker()),activeJobCount:0,messageIdCounter:0};this.workerList.push(i)}(t=u(p.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,f,v,m;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getVersion();case 3:n=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),n="1.1.0";case 9:if(i=(r="1.3.0").split(".").map((function(e){return parseInt(e,10)})),o=h(i,3),a=o[0],s=o[1],u=o[2],c=n.split(".").map((function(e){return parseInt(e,10)})),l=h(c,3),d=l[0],f=l[1],v=l[2],m="Update your local copy of @cognite/reveal-parser-worker. Required version is ".concat(r,". Received ").concat(n,"."),a===d){e.next=12;break}throw new Error(m);case 12:if(!(f<s)){e.next=14;break}throw new Error(m);case 14:if(!(f===s&&v<u)){e.next=16;break}throw new Error(m);case 16:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return t.apply(this,arguments)})(this.workerList[0].worker).catch((function(e){return Z.a.error(e)})),this.workerObjUrl&&URL.revokeObjectURL(this.workerObjUrl)}return m(e,[{key:"createWorker",value:function(){var e=(H.publicPath||n.p)+"reveal.parser.worker.js",t={name:"reveal.parser #"+this.workerList.length};if(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.origin,n=function(e){return!e.match(/^.*\/\//)};if(n(t))throw new Error("isTheSameDomain: the second argument must be an absolute url or omitted. Received "+t);if(n(e))return!0;try{var r=[e,t].map((function(e){return e.startsWith("//")?"https:"+e:e})).map((function(e){return new URL(e)}));return r[0].host===r[1].host}catch(n){return console.error("can not create URLs for ".concat(e," and ").concat(t),n),!1}}(e))return new Worker(e,t);if(!this.workerObjUrl){var r=new Blob(["importScripts(".concat(JSON.stringify(e),");")],{type:"text/javascript"});this.workerObjUrl=URL.createObjectURL(r)}return new Worker(this.workerObjUrl,t)}},{key:"postWorkToAvailable",value:(t=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.workerList.reduce((function(e,t){return e.activeJobCount>t.activeJobCount?t:e}),this.workerList[0]),n.activeJobCount+=1,e.next=4,u(p.mark((function e(){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(n.worker);case 3:return e.abrupt("return",e.sent);case 4:return e.prev=4,n.activeJobCount-=1,e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[0,,4,7]])})))();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"determineNumberOfWorkers",value:function(){return Math.max(2,Math.min(4,window.navigator.hardwareConcurrency||2))}}],[{key:"defaultPool",get:function(){return e._defaultPool=e._defaultPool||new e,e._defaultPool}}]),e;var t}(),Y=function(){function e(t){v(this,e),this._value=t,this._lastAccessTime=Date.now()}return m(e,[{key:"value",get:function(){return this.touch(),this._value}},{key:"lastAccessTime",get:function(){return this._lastAccessTime}},{key:"touch",value:function(){this._lastAccessTime=Date.now()}}]),e}(),X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;v(this,e),this._data=new Map,this._maxElementsInCache=t,this._defaultCleanupCount=r,this._removeCallback=n}return m(e,[{key:"has",value:function(e){return this._data.has(e)}},{key:"forceInsert",value:function(e,t){this.isFull()&&this.cleanCache(this._defaultCleanupCount),this.insert(e,t)}},{key:"insert",value:function(e,t){if(!(this._data.size<this._maxElementsInCache))throw new Error("Cache full, please clean Cache and retry adding data");this._data.set(e,new Y(t))}},{key:"remove",value:function(e){if(void 0!==this._removeCallback){var t=this._data.get(e);void 0!==t&&this._removeCallback(t.value)}this._data.delete(e)}},{key:"get",value:function(e){var t=this._data.get(e);if(void 0!==t)return t.value;throw new Error("Cache element ".concat(e," does not exist"))}},{key:"isFull",value:function(){return!(this._data.size<this._maxElementsInCache)}},{key:"cleanCache",value:function(e){var t=Array.from(this._data.entries());t.sort((function(e,t){return t[1].lastAccessTime-e[1].lastAccessTime}));for(var n=0;n<e;n++){var r=t.pop();if(void 0===r)return;this.remove(r[0])}}},{key:"clear",value:function(){if(void 0!==this._removeCallback){var e,t=f(this._data.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this._removeCallback(n.value)}}catch(e){t.e(e)}finally{t.f()}}this._data.clear()}}]),e}(),K=function(){function e(t,n){v(this,e),this._cache=new Map,this._retrieves=new Map,this._capacity=t,this._disposeCallback=n}return m(e,[{key:"get",value:function(e){var t=this._retrieves.get(e)||0;return this._retrieves.set(e,t+1),this._cache.get(e)}},{key:"set",value:function(e,t){return this._cache.has(e)||this._capacity<this._cache.size?(this._cache.set(e,t),!0):(this._cache.set(e,t),this.ensureWithinCapacity(),this._cache.has(e))}},{key:"remove",value:function(e){this._retrieves.delete(e);var t=this._cache.get(e);return void 0!==t&&(void 0!==this._disposeCallback&&this._disposeCallback(t),this._cache.delete(e),!0)}},{key:"clear",value:function(){if(void 0!==this._disposeCallback){var e,t=f(this._cache.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this._disposeCallback(n)}}catch(e){t.e(e)}finally{t.f()}}this._retrieves.clear(),this._cache.clear()}},{key:"ensureWithinCapacity",value:function(){var e=this;if(!(this._capacity>=this._cache.size)){var t,n=Array.from(this._cache.keys()).map((function(t){return{key:t,retrivalCount:e._retrieves.get(t)||0}})).sort((function(e,t){return e.retrivalCount-t.retrivalCount})).slice(0,this._cache.size-this._capacity).map((function(e){return e.key})),r=f(n);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.remove(i)}}catch(e){r.e(e)}finally{r.f()}}}}]),e}();function J(){this.array=null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"f",(function(){return E})),n.d(t,"e",(function(){return k})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return b})),n.d(t,"n",(function(){return N})),n.d(t,"o",(function(){return D})),n.d(t,"p",(function(){return B})),n.d(t,"q",(function(){return L})),n.d(t,"m",(function(){return j})),n.d(t,"i",(function(){return U})),n.d(t,"t",(function(){return W})),n.d(t,"k",(function(){return X})),n.d(t,"w",(function(){return q})),n.d(t,"r",(function(){return $})),n.d(t,"v",(function(){return J})),n.d(t,"j",(function(){return G})),n.d(t,"u",(function(){return H})),n.d(t,"s",(function(){return ee})),n.d(t,"h",(function(){return _})),n.d(t,"l",(function(){return te}));var r=n(0),i=n(1),o=n(24),y=n.n(o),g=function(){function e(t,n,r,i,o){v(this,e),this.version=t,this.maxTreeIndex=n,this.root=i,this.sectors=o,this.unit=r}return m(e,[{key:"sectorCount",get:function(){return this.sectors.size}},{key:"getSectorById",value:function(e){return this.sectors.get(e)}},{key:"getAllSectors",value:function(){return s(this.sectors.values())}},{key:"getSectorsContainingPoint",value:function(e){var t=[];return Object(i.u)(this.root,(function(n){return!!n.bounds.containsPoint(e)&&(t.push(n),!0)})),t}},{key:"getSectorsIntersectingBox",value:function(e){var t=[];return Object(i.u)(this.root,(function(n){return!!n.bounds.intersectsBox(e)&&(t.push(n),!0)})),t}},{key:"getBoundsOfMostGeometry",value:function(){if(0===this.root.children.length)return this.root.bounds;var e=[],t=[];Object(i.u)(this.root,(function(n){return 0===n.children.length&&(t.push(n.bounds.min.toArray(),n.bounds.max.toArray()),e.push(n.bounds,n.bounds)),!0}));var n=Math.min(t.length,4),o=y()(t,n,"kmpp",10),a=new Array(o.idxs.length).fill(0),s=a.map((function(e){return new r.Box3}));o.idxs.map((function(e){return a[e]++}));var u=a.reduce((function(e,t,n){return t>e.count&&(e.count=t,e.idx=n),e}),{count:0,idx:-1}).idx;o.idxs.forEach((function(t,n){a[t]++,s[t].expandByPoint(e[n].min),s[t].expandByPoint(e[n].max)}));var c=s.filter((function(e,t){return!(t===u||!e.intersectsBox(s[u]))}));if(c.length>0){var l=s[u].clone();return c.forEach((function(e){l.expandByPoint(e.min),l.expandByPoint(e.max)})),l}return s[u]}},{key:"getSectorsIntersectingFrustum",value:function(e,t){var n=(new r.Matrix4).multiplyMatrices(e,t),o=(new r.Frustum).setFromProjectionMatrix(n),a=[];return Object(i.u)(this.root,(function(e){return!!o.intersectsBox(e.bounds)&&(a.push(e),!0)})),a}}]),e}();var b,x=function(){function e(){v(this,e)}return m(e,[{key:"parse",value:function(e){var t=e.version;switch(t){case 8:return function(e){var t=new Map,n=[];e.sectors.forEach((function(e){var i=function(e){var t=function(e){return e.facesFile?c(c({},e.facesFile),{},{recursiveCoverageFactors:e.facesFile.recursiveCoverageFactors||e.facesFile.coverageFactors}):{quadSize:-1,coverageFactors:{xy:-1,yz:-1,xz:-1},recursiveCoverageFactors:{xy:-1,yz:-1,xz:-1},fileName:null,downloadSize:e.indexFile.downloadSize}}(e),n=e.boundingBox,i=n.min.x,o=n.min.y,a=n.min.z,s=n.max.x,u=n.max.y,l=n.max.z;return{id:e.id,path:e.path,depth:e.depth,bounds:new r.Box3(new r.Vector3(i,o,a),new r.Vector3(s,u,l)),estimatedDrawCallCount:e.estimatedDrawCallCount,estimatedRenderCost:e.estimatedTriangleCount||0,indexFile:c({},e.indexFile),facesFile:t,children:[]}}(e);t.set(e.id,i),n[e.id]=e.parentId}));var i,o=f(t.values());try{for(o.s();!(i=o.n()).done;){var a=i.value,s=n[a.id];-1!==s&&t.get(s).children.push(a)}}catch(e){o.e(e)}finally{o.f()}var u=t.get(0);if(!u)throw new Error("Root sector not found, must have ID 0");!function e(t,n){!function(e){return-1===e.facesFile.coverageFactors.xy}(t)?t.children.forEach((function(n){return e(n,t.facesFile)})):(t.facesFile.coverageFactors.xy=n.recursiveCoverageFactors.xy,t.facesFile.coverageFactors.yz=n.recursiveCoverageFactors.yz,t.facesFile.coverageFactors.xz=n.recursiveCoverageFactors.xz,t.facesFile.recursiveCoverageFactors.xy=n.recursiveCoverageFactors.xy,t.facesFile.recursiveCoverageFactors.yz=n.recursiveCoverageFactors.yz,t.facesFile.recursiveCoverageFactors.xz=n.recursiveCoverageFactors.xz,t.children.forEach((function(t){return e(t,n)})))}(u,u.facesFile);var l=null!==e.unit?e.unit:"Meters";return new g(e.version,e.maxTreeIndex,l,u,t)}(e);case void 0:throw new Error('Metadata must contain a "version"-field');default:throw new Error("Version ".concat(t," is not supported"))}}}]),e}(),_=new Map([["Meters",1],["Centimeters",.01],["Millimeters",.001],["Micrometers",1e-6],["Kilometers",1e3],["Feet",.3048],["Inches",.0254],["Yards",.9144],["Miles",1609.34],["Mils",254e-7],["Microinches",2.54e-8]]),w=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"scene.json";v(this,e),this._currentModelIdentifier=0,this._modelMetadataProvider=t,this._modelDataProvider=n,this._cadSceneParser=r,this._blobFileName=i}return m(e,[{key:"loadData",value:(t=u(p.mark((function e(t){var n,o,a,s,u,c,l,d,f;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._modelMetadataProvider.getModelUri(t),o=this._modelMetadataProvider.getModelMatrix(t),a=this._modelMetadataProvider.getModelCamera(t),e.next=5,n;case 5:return s=e.sent,e.next=8,this._modelDataProvider.getJsonFile(s,this._blobFileName);case 8:return u=e.sent,c=this._cadSceneParser.parse(u),e.t0=function(e,t){var n=_.get(e);if(void 0===n)throw new Error("Unknown model unit '".concat(e,"'"));return(new r.Matrix4).makeScale(n,n,n).multiply(t)},e.t1=c.unit,e.next=14,o;case 14:return e.t2=e.sent,l=(0,e.t0)(e.t1,e.t2),d=(new r.Matrix4).copy(l).invert(),e.next=19,a;case 19:return f=e.sent,e.abrupt("return",{modelIdentifier:""+this._currentModelIdentifier++,modelBaseUrl:s,geometryClipBox:null,modelMatrix:l,inverseModelMatrix:d,cameraConfiguration:Object(i.t)(f,l),scene:c});case 21:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t}(),M=n(7),S=n.n(M),T=function(){function e(){v(this,e)}return m(e,[{key:"createSectorScene",value:function(e,t,n,r){S()(8===e,"Only version 8 is currently supported");var o=new Map;return Object(i.u)(r,(function(e){return o.set(e.id,e),!0})),new g(e,t,n,r,o)}}]),e}();!function(e){e[e.Discarded=0]="Discarded",e[e.Simple=1]="Simple",e[e.Detailed=2]="Detailed"}(b||(b={}));var E=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return v(this,n),(o=t.call(this))._lod=b.Discarded,o._updatedTimestamp=Date.now(),o.name="Sector ".concat(r," [id=").concat(e,"]"),o.sectorId=e,o.sectorPath=r,o.bounds=i,o.depth=function(e){for(var t=0,n=0;n<e.length;++n)t+="/"===e[n]?1:0;return t-1}(r),o}return m(n,[{key:"levelOfDetail",get:function(){return this._lod}},{key:"group",get:function(){return this._group}},{key:"updatedTimestamp",get:function(){return this._updatedTimestamp}},{key:"updateGeometry",value:function(e,t){this.resetGeometry(),this._group=e,void 0!==this._group&&this._group.reference(),this._lod=t,this._updatedTimestamp=Date.now(),this.visible=this._lod!==b.Discarded,this.updateMatrixWorld(!0)}},{key:"resetGeometry",value:function(){void 0!==this._group&&(this._group.dereference(),this.remove(this._group)),this._group=void 0,this._lod=b.Discarded,this._updatedTimestamp=Date.now()}}]),n}(r.Group),k=function(e){l(n,e);var t=d(n);function n(e){var r;v(this,n);var i=e.scene.root.bounds.clone();i.applyMatrix4(e.modelMatrix),r=t.call(this,0,"/",i);var o=e.scene,s=e.modelMatrix;return r.sectorNodeMap=new Map,function e(t,n,r,i){var o=t.bounds.clone();o.applyMatrix4(i);var a=new E(t.id,t.path,o);a.name="Sector "+t.id,n.add(a),a.matrixAutoUpdate=!1,a.updateMatrixWorld(!0),r.set(t.id,a);var s,u=f(t.children);try{for(u.s();!(s=u.n()).done;)e(s.value,a,r,i)}catch(e){u.e(e)}finally{u.f()}}(o.root,a(r),r.sectorNodeMap,s),r.matrixAutoUpdate=!1,r.setModelTransformation(s),r}return m(n,[{key:"setModelTransformation",value:function(e){this.matrix.copy(e),this.updateMatrixWorld(!0)}},{key:"getModelTransformation",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Matrix4).copy(this.matrix)}}]),n}(E),A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.k.defaultPool;v(this,e),this.workerPool=t}return m(e,[{key:"parseI3D",value:function(e){return this.parseDetailed(e)}},{key:"parseF3D",value:function(e){return this.parseSimple(e)}},{key:"parseCTM",value:function(e){return this.parseCtm(e)}},{key:"parseSimple",value:(r=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.workerPool.postWorkToAvailable(function(){var e=u(p.mark((function e(n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.parseQuads(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"parseDetailed",value:(n=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.workerPool.postWorkToAvailable(function(){var e=u(p.mark((function e(n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.parseSector(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parseCtm",value:(t=u(p.mark((function e(t){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.workerPool.postWorkToAvailable(function(){var e=u(p.mark((function e(n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.parseCtm(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t,n,r}(),P={centerA:new r.Vector3,centerB:new r.Vector3,sphere:new r.Sphere,box:new r.Box3},C={vertex1:new r.Vector3,vertex2:new r.Vector3,vertex3:new r.Vector3,vertex4:new r.Vector3},O={instanceMatrix:new r.Matrix4},I={center:new r.Vector3,size:new r.Vector3};function R(e,t,n,i){for(var o=Array.from(t.values()).reduce((function(e,t){return Math.max(e,t.offset+t.size)}),0),a=e.length/o,s=new Float32Array(e.buffer),u=new r.Box3,c=new Uint8Array(e.length),l=0,d=0;d<a;++d)if(i(d,o,s,u),n.intersectsBox(u)){var f=e.subarray(d*o,(d+1)*o);c.set(f,l*o),l++}return c.slice(0,l*o)}function N(e,t,n,r){if(null===r)return e;var i=t.get("instanceMatrix");return S()(void 0!==i),R(e,t,r,(function(e,t,r,o){!function(e,t,n,r,i,o){var a=O.instanceMatrix,s=(r*n+e.offset)/t.BYTES_PER_ELEMENT;a.set(t[s+0],t[s+4],t[s+8],t[s+12],t[s+1],t[s+5],t[s+9],t[s+13],t[s+2],t[s+6],t[s+10],t[s+14],t[s+3],t[s+7],t[s+11],t[s+15]),o.copy(i).applyMatrix4(a)}(i,r,t,e,n,o)}))}function D(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"radiusA",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"radiusB";if(null===n)return e;var o=t.get("centerA"),a=t.get("centerB"),s=t.get(r),u=t.get(i);return S()(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==u),R(e,t,n,(function(e,t,n,r){!function(e,t,n,r,i,o,a,s){var u=P.centerA,c=P.centerB,l=P.sphere,d=P.box;function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a*o+e.offset)/i.BYTES_PER_ELEMENT;return i[n+t]}u.set(f(e,0),f(e,1),f(e,2)),c.set(f(t,0),f(t,1),f(t,2));var p=f(n),h=f(r);l.set(u,p),l.getBoundingBox(s),l.set(c,h),l.getBoundingBox(d),s.expandByPoint(d.min),s.expandByPoint(d.max)}(o,a,s,u,n,t,e,r)}))}function L(e,t,n){if(null===n)return e;var r=t.get("vertex1"),i=t.get("vertex2"),o=t.get("vertex3"),a=t.get("vertex4");return S()(void 0!==r&&void 0!==i&&void 0!==o&&void 0!==a),R(e,t,n,(function(e,t,n,s){!function(e,t,n,r,i,o,a,s){var u=C.vertex1,c=C.vertex2,l=C.vertex3,d=C.vertex4;function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a*o+e.offset)/i.BYTES_PER_ELEMENT;return i[n+t]}u.set(f(e,0),f(e,1),f(e,2)),c.set(f(t,0),f(t,1),f(t,2)),l.set(f(n,0),f(n,1),f(n,2)),d.set(f(r,0),f(r,1),f(r,2)),s.setFromPoints([u,c,l,d])}(r,i,o,a,n,t,e,s)}))}function B(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"horizontalRadius",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"verticalRadius";if(null===n)return e;var o=t.get("center"),a=t.get(r),s=t.get(i),u=t.get("height");return S()(void 0!==o&&void 0!==a&&void 0!==s&&void 0!==u),R(e,t,n,(function(e,t,n,r){!function(e,t,n,r,i,o,a,s){var u=I.center,c=I.size;function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(a*o+e.offset)/i.BYTES_PER_ELEMENT;return i[n+t]}u.set(l(e,0),l(e,1),l(e,2));var d=l(t),f=l(n),p=l(r),h=2*Math.max(d,f,p);c.set(h,h,h),s.setFromCenterAndSize(u,c)}(o,a,s,u,n,t,e,r)}))}var F={p:new r.Vector3,instanceMatrix:new r.Matrix4,baseBounds:new r.Box3,instanceBounds:new r.Box3};function j(e,t,n,r){if(null===r)return n;var i=F.p,o=F.instanceMatrix,a=F.baseBounds,s=F.instanceBounds;a.makeEmpty();for(var u=n.triangleOffset;u<n.triangleOffset+n.triangleCount;++u){var c=t[3*u+0],l=t[3*u+1],d=t[3*u+2];i.set(e[c+0],e[c+1],e[c+2]),a.expandByPoint(i),i.set(e[l+0],e[l+1],e[l+2]),a.expandByPoint(i),i.set(e[d+0],e[d+1],e[d+2]),a.expandByPoint(i)}for(var f,p,h=0,v=n.treeIndices.length,m=new Float32Array(n.instanceMatrices.length),y=new Float32Array(v),g=new Uint8Array(4*v),b=0;b<v;++b)if(f=n.instanceMatrices,p=b,o.set(f[p+0],f[p+4],f[p+8],f[p+12],f[p+1],f[p+5],f[p+9],f[p+13],f[p+2],f[p+6],f[p+10],f[p+14],f[p+3],f[p+7],f[p+11],f[p+15]),s.copy(a).applyMatrix4(o),r.intersectsBox(s)){var x=n.instanceMatrices.subarray(16*b,16*(b+1)),_=n.colors.subarray(4*b,4*(b+1)),w=n.treeIndices[b];m.set(x,16*h),g.set(_,4*h),y[h]=w,h++}return v===h?n:{triangleCount:n.triangleCount,triangleOffset:n.triangleOffset,instanceMatrices:m.slice(0,16*h),colors:g.slice(0,4*h),treeIndices:y.slice(0,h)}}var z=function(){var e=new r.BoxBufferGeometry(1,1,1,1,1,1);try{var t={index:e.getIndex(),position:e.getAttribute("position"),normal:e.getAttribute("normal")};return e.computeBoundingBox(),{boxGeometry:t,boxGeometryBoundingBox:e.boundingBox}}finally{e.dispose()}}(),U=z.boxGeometry,G=z.boxGeometryBoundingBox,V=function(){var e=new r.PlaneBufferGeometry(1,1,1,1);try{var t={index:e.getIndex(),position:e.getAttribute("position"),normal:e.getAttribute("normal")};return e.computeBoundingBox(),{quadGeometry:t,quadGeometryBoundingBox:e.boundingBox}}finally{e.dispose()}}(),W=V.quadGeometry,H=V.quadGeometryBoundingBox,Z=function(){var e=[0,0,0,1,1,1,2,2,2,3,3,3];return{trapeziumGeometry:{index:new r.BufferAttribute(new Uint16Array([0,1,3,0,3,2]),1),position:new r.BufferAttribute(new Float32Array(e),3)},trapeziumGeometryBoundingBox:(new r.Box3).setFromArray(e)}}(),q=Z.trapeziumGeometry,Y=(Z.trapeziumGeometryBoundingBox,function(){var e=[];e.push(-1,1,-1),e.push(-1,-1,-1),e.push(1,1,-1),e.push(1,-1,-1),e.push(1,1,1),e.push(1,-1,1);var t=new Uint16Array([1,2,0,1,3,2,3,4,2,3,5,4]);return{coneGeometry:{index:new r.BufferAttribute(t,1),position:new r.BufferAttribute(new Float32Array(e),3)},coneGeometryBoundingBox:(new r.Box3).setFromArray(e)}}()),X=Y.coneGeometry,K=(Y.coneGeometryBoundingBox,function(){var e=function(e,t){return[e,2*t*Math.PI]};return{torusLodGeometries:[{tubularSegments:9,radialSegments:18},{tubularSegments:5,radialSegments:12},{tubularSegments:4,radialSegments:5}].map((function(t){var n=t.tubularSegments;return function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return[e,t,0]},i=[],o=[],a=1/e,s=1/t,u=0;u<=t;u++)for(var c=0;c<=e;c++){var l=n(c*a,u*s),d=h(l,3),f=d[0],p=d[1],v=d[2];i.push(f||0,p||0,v||0)}for(var m=1;m<=t;m++)for(var y=1;y<=e;y++){var g=(e+1)*m+y-1,b=(e+1)*(m-1)+y-1,x=(e+1)*(m-1)+y,_=(e+1)*m+y;o.push(g,b,_),o.push(b,x,_)}return{index:new r.Uint16BufferAttribute(o,1),position:new r.Float32BufferAttribute(i,3)}}(t.radialSegments,n,e)}))}}()),J=K.torusLodGeometries,Q=function(){var e=new r.CylinderBufferGeometry(.5,.5,1,6);try{e.applyMatrix4((new r.Matrix4).makeRotationX(-Math.PI/2));var t={index:e.getIndex(),position:e.getAttribute("position"),normal:e.getAttribute("normal")};return{nutGeometry:t,nutGeometryBoundingBox:(new r.Box3).setFromArray(t.position.array)}}finally{e.dispose()}}(),$=Q.nutGeometry,ee=Q.nutGeometryBoundingBox;function te(e,t,n,o){var a,s=[],u=e.filter((function(e){return null===o||function(e,t){var n=ne.p,r=ne.box;r.makeEmpty();for(var i=0;i<e.vertices.length;i+=3)n.set(e.vertices[i+0],e.vertices[i+1],e.vertices[i+2]),r.expandByPoint(n);return t.intersectsBox(r)}(e,o)})),c=f(u);try{for(c.s();!(a=c.n()).done;){var l=a.value,d=new r.BufferGeometry,p=new r.Uint32BufferAttribute(l.indices.buffer,1).onUpload(i.n),h=new r.Float32BufferAttribute(l.vertices.buffer,3).onUpload(i.n),v=new r.Uint8BufferAttribute(l.colors.buffer,3).onUpload(i.n),m=new r.Float32BufferAttribute(l.treeIndices.buffer,1).onUpload(i.n);d.setIndex(p),d.setAttribute("color",v),d.setAttribute("position",h),d.setAttribute("treeIndex",m),d.boundingBox=t.clone(),d.boundingSphere=new r.Sphere,t.getBoundingSphere(d.boundingSphere);var y=new r.Mesh(d,n);y.name="Triangle mesh "+l.fileId,y.userData.treeIndices=new Set(l.treeIndices),s.push(y)}}catch(e){c.e(e)}finally{c.f()}return s}var ne={p:new r.Vector3,box:new r.Box3}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return M})),n.d(t,"h",(function(){return S})),n.d(t,"e",(function(){return r}));var r,i=function(){function e(t){v(this,e),this.client=t,this.authenticationPromise=t.authenticate()}return m(e,[{key:"headers",get:function(){return this.client.getDefaultRequestHeaders()}},{key:"getBinaryFile",value:(r=u(p.mark((function e(t,n){var r,i;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t,"/").concat(n),i=c(c({},this.client.getDefaultRequestHeaders()),{},{Accept:"*/*"}),e.next=3,this.fetchWithRetry(r,{headers:i,method:"GET"});case 3:return e.abrupt("return",e.sent.arrayBuffer());case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"getJsonFile",value:(n=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.get("".concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchWithRetry",value:(t=u(p.mark((function e(t,n){var r,i,o,a,s=arguments;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.length>2&&void 0!==s[2]?s[2]:3,o=0;case 2:if(!(o<r)){e.next=21;break}return e.prev=3,e.next=6,this.authenticationPromise;case 6:return e.next=8,fetch(t,n);case 8:if(401!==(a=e.sent).status){e.next=12;break}return this.authenticationPromise=this.client.authenticate(),e.abrupt("continue",18);case 12:return e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(3),void 0!==i&&(i=e.t0);case 18:o++,e.next=2;break;case 21:throw i;case 22:case"end":return e.stop()}}),e,this,[[3,15]])}))),function(e,n){return t.apply(this,arguments)})}]),e;var t,n,r}(),a=function(){function e(t,n,r){v(this,e),this.revealInternalId=Symbol("".concat(t,"/").concat(n,"[").concat(r,"]")),this.modelId=t,this.revisionId=n,this.modelFormat=r}return m(e,[{key:"toString",value:function(){return"".concat(e.name," (").concat(String(this.revealInternalId)," - ").concat(this.modelFormat,")")}}]),e}(),l=n(0);!function(e){e.EptPointCloud="ept-pointcloud",e.RevealCadModel="reveal-directory",e.AnyFormat="all-outputs"}(r||(r={}));var d=(new l.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);function f(e,t){switch(t){case r.RevealCadModel:e.premultiply(d);break;case r.EptPointCloud:break;default:throw new Error("Unknown model format '"+t)}}var h=function(){function e(t,n,r){v(this,e),this.modelId=t,this.revisionId=n,this.outputs=r}return m(e,[{key:"findMostRecentOutput",value:function(e,t){var n=this.outputs.filter((function(n){return n.format===e&&(!t||-1!==t.indexOf(n.version))}));return n.length>0?n.reduce((function(e,t){return t.version>e.version?t:e})):void 0}}]),e}(),y=function(){function e(t){v(this,e),this._client=t}return m(e,[{key:"getModelMatrix",value:(i=u(p.mark((function e(t){var n,r,i,u,c;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof a){e.next=2;break}throw new Error("Model must be a ".concat(a.name,", but got ").concat(t.toString()));case 2:return n=t.modelId,r=t.revisionId,i=t.modelFormat,e.next=7,this._client.revisions3D.retrieve(n,r);case 7:return u=e.sent,c=new l.Matrix4,e.abrupt("return",(u.rotation&&c.makeRotationFromEuler(o(l.Euler,s(u.rotation))),f(c,i),c));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getModelCamera",value:(r=u(p.mark((function e(t){var n,r,i,o,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof a){e.next=2;break}throw new Error("Model must be a ".concat(a.name,", but got ").concat(t.toString()));case 2:return n=t.modelId,r=t.revisionId,e.next=6,this._client.revisions3D.retrieve(n,r);case 6:if(!((i=e.sent).camera&&i.camera.position&&i.camera.target)){e.next=10;break}return o=i.camera,s=o.position,u=o.target,e.abrupt("return",{position:new l.Vector3(s[0],s[1],s[2]),target:new l.Vector3(u[0],u[1],u[2])});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getModelUri",value:(n=u(p.mark((function e(t){var n,r,i,o,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof a){e.next=2;break}throw new Error("Model must be a ".concat(a.name,", but got ").concat(t.toString()));case 2:return n=t.modelId,r=t.revisionId,i=t.modelFormat,e.next=7,this.getOutputs(t);case 7:if(o=e.sent.findMostRecentOutput(i)){e.next=10;break}throw new Error("Model '".concat(n,"/").concat(r,"' is not compatible with this version of Reveal, because no outputs for format '(").concat(i,")' was found. If this model works with a previous version of Reveal it must be reprocessed to support this version."));case 10:return s=o.blobId,e.abrupt("return","".concat(this._client.getBaseUrl()).concat(this.getRequestPath(s)));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getOutputs",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.modelId,r=t.revisionId,i=t.modelFormat,o="/api/v1/projects/".concat(this._client.project,"/3d/models/").concat(n,"/revisions/").concat(r,"/outputs"),a=void 0!==i?{params:{format:i}}:void 0,e.next=7,this._client.get(o,a);case 7:if(200!==(s=e.sent).status){e.next=10;break}return e.abrupt("return",new h(n,r,s.data.items));case 10:throw new Error("Unexpected response ".concat(s.status," (payload: '").concat(s.data,")"));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getRequestPath",value:function(e){return"/api/v1/projects/".concat(this._client.project,"/3d/files/").concat(e)}}]),e;var t,n,r,i}(),g=function(){function e(t){v(this,e),this._client=t}return m(e,[{key:"getOutputs",value:(t=u(p.mark((function e(t){var n,r,i,o,a,s;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.modelId,r=t.revisionId,i=t.modelFormat,o="/api/v1/projects/".concat(this._client.project,"/3d/models/").concat(n,"/revisions/").concat(r,"/outputs"),a=void 0!==i?{params:{format:i}}:void 0,e.next=7,this._client.get(o,a);case 7:if(200!==(s=e.sent).status){e.next=10;break}return e.abrupt("return",new h(n,r,s.data.items));case 10:throw new Error("Unexpected response ".concat(s.status," (payload: '").concat(s.data,")"));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e;var t}(),b=n(18);function x(e){return _.apply(this,arguments)}function _(){return _=u(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=6;break}throw r={},n.headers.forEach((function(e,t){r[e]=t})),new b.HttpError(n.status,n.body,r);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}var w=function(){function e(){v(this,e)}return m(e,[{key:"headers",get:function(){return{}}},{key:"getBinaryFile",value:(n=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("".concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent.arrayBuffer());case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"getJsonFile",value:(t=u(p.mark((function e(t,n){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("".concat(t,"/").concat(n));case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e;var t,n}(),M=function(){function e(t){v(this,e),this.revealInternalId=Symbol(t),this.localPath=t}return m(e,[{key:"toString",value:function(){return"".concat(e.name," (").concat(this.localPath,")")}}]),e}(),S=function(){function e(){v(this,e)}return m(e,[{key:"getModelUri",value:function(e){if(!(e instanceof M))throw new Error("Model must be a ".concat(M.name,", but got ").concat(e.toString()));return Promise.resolve("".concat(location.origin,"/").concat(e.localPath))}},{key:"getModelMatrix",value:(t=u(p.mark((function e(t){var n;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof M){e.next=2;break}throw new Error("Model must be a ".concat(M.name,", but got ").concat(t.toString()));case 2:return n=new l.Matrix4,e.abrupt("return",(f(n,r.RevealCadModel),n));case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getModelCamera",value:function(e){if(!(e instanceof M))throw new Error("Model must be a ".concat(M.name,", but got ").concat(e.toString()));return Promise.resolve(void 0)}}]),e;var t}()},function(e,t){e.exports=n(11011)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),i=n.n(r),o=n(10),a="2.3.0",s="8c900bdfe458e32b768450c20750853d",u=function(){function e(t,n,r){v(this,e),i.a.init(s,{disable_cookie:!0,disable_persistence:!0,ip:!1,property_blacklist:["$city","$region","mp_country_code","$geo_source","$timezone","mp_lib","$lib_version","$device_id","$user_id","$current_url","$screen_width","$screen_height","$referrer","$referring_domain","$initial_referrer","$initial_referring_domain"]}),i.a.reset(),i.a.identify("reveal-single-user"),this._sessionProps={VERSION:a,project:"unknown",application:"unknown",sessionId:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},t&&(this._sessionProps.project=t),n&&(this._sessionProps.application=n),this.innerTrackEvent("init",r)}return m(e,[{key:"innerTrackEvent",value:function(e,t){var n=c(c({},this._sessionProps),t);i.a.track(e,n)}}],[{key:"init",value:function(t,n,r,i){if(void 0===globalThis.revealMetricsLogger&&t){var o=new e(n,r,i);globalThis.revealMetricsLogger={metricsLogger:o}}}},{key:"trackEvent",value:function(e,t){globalThis.revealMetricsLogger&&globalThis.revealMetricsLogger.metricsLogger.innerTrackEvent(e,t)}},{key:"trackCreateTool",value:function(t){e.trackEvent("toolCreated",{toolName:t})}},{key:"trackLoadModel",value:function(t,n){e.trackEvent("loadModel",c(c({},t),{},{modelIdentifier:n}))}},{key:"trackCadModelStyled",value:function(t,n){e.trackEvent("cadModelStyleAssigned",{nodeCollectionClassToken:t,style:n})}},{key:"trackError",value:function(e,t){o.a.error(e),this.trackEvent("error",c({message:e.message,name:e.name,stack:e.stack},t))}},{key:"trackCameraNavigation",value:function(t){e.trackEvent("cameraNavigated",t)}}]),e}()},,function(e,t,n){"use strict";var r=n(23);t.a=r},function(e,t){e.exports=n(71083)},function(e,t){e.exports=n(60797)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(0),i={renderSize:new r.Vector2,position:new r.Vector3};function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.Vector3,o=i.position;o.copy(t),o.project(e);var a=(o.x+1)/2,s=(1-o.y)/2;return n.set(a,s,o.z)}function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new r.Vector3;o(t,n,a);var s=i.renderSize;e.getSize(s);var u=e.domElement.getBoundingClientRect(),c=u.width,l=u.height;return a.x=Math.round(a.x*c),a.y=Math.round(a.y*l),a}},function(e,t){e.exports=n(39807)},function(e,t){e.exports=n(72518)},function(e,t){e.exports=n(48543)},function(e,t){e.exports=n(71339)},function(e,t){e.exports=n(16529)},function(e,t,n){"use strict";var r=n(13);n.d(t,"d",(function(){return r.b}));var i=n(20);n.d(t,"a",(function(){return i.a}));var o=n(1);n.d(t,"c",(function(){return o.l})),n.d(t,"b",(function(){return o.d})),n(6)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(t){v(this,e),this._clippingPlanes=[new r.Plane,new r.Plane,new r.Plane,new r.Plane,new r.Plane,new r.Plane],this._box=t||new r.Box3,this.updatePlanes()}return m(e,[{key:"minX",get:function(){return this._box.min.x},set:function(e){this._box.min.x=e,this.updatePlanes()}},{key:"minY",get:function(){return this._box.min.y},set:function(e){this._box.min.y=e,this.updatePlanes()}},{key:"minZ",get:function(){return this._box.min.z},set:function(e){this._box.min.z=e,this.updatePlanes()}},{key:"maxX",get:function(){return this._box.max.x},set:function(e){this._box.max.x=e,this.updatePlanes()}},{key:"maxY",get:function(){return this._box.max.y},set:function(e){this._box.max.y=e,this.updatePlanes()}},{key:"maxZ",get:function(){return this._box.max.z},set:function(e){this._box.max.z=e,this.updatePlanes()}},{key:"updatePlanes",value:function(){this._clippingPlanes[0].setFromNormalAndCoplanarPoint(new r.Vector3(1,0,0),new r.Vector3(this.minX,0,0)),this._clippingPlanes[1].setFromNormalAndCoplanarPoint(new r.Vector3(-1,0,0),new r.Vector3(this.maxX,0,0)),this._clippingPlanes[2].setFromNormalAndCoplanarPoint(new r.Vector3(0,1,0),new r.Vector3(0,this.minY,0)),this._clippingPlanes[3].setFromNormalAndCoplanarPoint(new r.Vector3(0,-1,0),new r.Vector3(0,this.maxY,0)),this._clippingPlanes[4].setFromNormalAndCoplanarPoint(new r.Vector3(0,0,1),new r.Vector3(0,0,this.minZ)),this._clippingPlanes[5].setFromNormalAndCoplanarPoint(new r.Vector3(0,0,-1),new r.Vector3(0,0,this.maxZ))}},{key:"clippingPlanes",get:function(){return this._clippingPlanes}}]),e}()},,function(e,t){e.exports=n(20867)},function(e,t){e.exports=n(37702)},function(e,t){e.exports=n(18187)},,,,,,,,function(e,t){e.exports=n(53151)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"HtmlOverlayTool",(function(){return T})),n.d(t,"ExplodedViewTool",(function(){return A})),n.d(t,"DebugCameraTool",(function(){return P})),n.d(t,"AxisViewTool",(function(){return X})),n.d(t,"Corner",(function(){return k})),n.d(t,"GeomapTool",(function(){return Q})),n.d(t,"MapProviders",(function(){return L})),n.d(t,"MapboxMode",(function(){return B})),n.d(t,"MapboxStyle",(function(){return F})),n.d(t,"MapboxImageFormat",(function(){return z})),n.d(t,"BingMapType",(function(){return U})),n.d(t,"BingMapImageFormat",(function(){return G})),n.d(t,"HereMapType",(function(){return V})),n.d(t,"HereMapScheme",(function(){return W})),n.d(t,"HereMapImageFormat",(function(){return H})),n.d(t,"TimelineTool",(function(){return ee})),n.d(t,"Keyframe",(function(){return $})),n.d(t,"Cognite3DViewerToolBase",(function(){return g})),n.d(t,"DebugLoadedSectorsTool",(function(){return ne}));var o=n(0),y=n(19),g=function(){function e(){v(this,e),this._disposedEvent=new y.b,this._disposed=!1}return m(e,[{key:"on",value:function(e,t){"disposed"===e?this._disposedEvent.subscribe(t):Object(y.c)(e)}},{key:"off",value:function(e,t){"disposed"===e?this._disposedEvent.unsubscribe(t):Object(y.c)(e)}},{key:"dispose",value:function(){if(this._disposed)throw new Error("Already disposed");this._disposed=!0,this._disposedEvent.fire(),this._disposedEvent.unsubscribeAll()}},{key:"ensureNotDisposed",value:function(){if(this._disposed)throw new Error("The tool has been disposed")}}]),e}(),b=n(16),x=n.n(b),_=function(){function e(t,n){v(this,e),this._removedElements=new Set,this._dimensions=n,this._cells=x()(0,n[0]*n[1]).map((function(){return new Array})),this._bounds=t}return m(e,[{key:"insert",value:function(e,t){if(!this._bounds.intersectsBox(e))throw new Error("Element to be added must be partially inside grid");if(this._removedElements.has(t))throw new Error("Re-adding previously taken elements is currently not supported");var n,r=f(this.cellsIntersecting(e));try{for(r.s();!(n=r.n()).done;)n.value.push({bounds:e,element:t})}catch(e){r.e(e)}finally{r.f()}}},{key:"overlappingElements",value:p.mark((function e(t){var n,r,i,o,a,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._bounds.intersectsBox(t)){e.next=2;break}return e.abrupt("return");case 2:n=new Set,r=f(this.cellsIntersecting(t)),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=30;break}o=i.value,a=f(o),e.prev=9,a.s();case 11:if((s=a.n()).done){e.next=20;break}if(u=s.value,e.t0=n.has(u.element)||this._removedElements.has(u.element)||!t.intersectsBox(u.bounds),e.t0){e.next=18;break}return n.add(u.element),e.next=18,u.element;case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(9),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:e.next=6;break;case 30:e.next=35;break;case 32:e.prev=32,e.t2=e.catch(4),r.e(e.t2);case 35:return e.prev=35,r.f(),e.finish(35);case 38:case"end":return e.stop()}}),e,this,[[4,32,35,38],[9,22,25,28]])}))},{key:"removeOverlappingElements",value:p.mark((function e(t){var n,r,i,o,a;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bounds.intersectsBox(t)){e.next=27;break}n=f(this.cellsIntersecting(t)),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=19;break}i=r.value,o=0;case 7:if(!(o<i.length)){e.next=17;break}if(a=i[o],e.t0=!this._removedElements.has(a.element)&&t.intersectsBox(a.bounds),!e.t0){e.next=14;break}return this._removedElements.add(a.element),e.next=14,a.element;case 14:o++,e.next=7;break;case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(2),n.e(e.t1);case 24:return e.prev=24,n.f(),e.finish(24);case 27:case"end":return e.stop()}}),e,this,[[2,21,24,27]])}))},{key:"cellsIntersecting",value:p.mark((function e(t){var n,r,i,a,s,u,c,l,d,f,h,v,m,y,g,b;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this._bounds,r=n.min,i=n.max,a=this._dimensions[0],s=this._dimensions[1],u=(t.min.x-r.x)/(i.x-r.x),c=(t.max.x-r.x)/(i.x-r.x),l=(t.min.y-r.y)/(i.y-r.y),d=(t.max.y-r.y)/(i.y-r.y),f=o.MathUtils.clamp,h=f(Math.floor(a*u),0,a-1),v=f(Math.floor(a*c),0,a-1),m=f(Math.floor(s*l),0,s-1),y=f(Math.floor(s*d),0,s-1),g=m;case 2:if(!(g<=y)){e.next=13;break}b=h;case 4:if(!(b<=v)){e.next=10;break}return e.next=7,this._cells[g*a+b];case 7:++b,e.next=4;break;case 10:++g,e.next=2;break;case 13:case"end":return e.stop()}}),e,this)}))}]),e}(),w=n(8),M=n(14),S=n.n(M),T=function(e){l(n,e);var t=d(n);function n(e,r){var i;return v(this,n),(i=t.call(this))._htmlOverlays=new Map,i._compositeOverlays=[],i._preallocatedVariables={camPos:new o.Vector3,camNormal:new o.Vector3,point:new o.Vector3,nearPlane:new o.Plane,farPlane:new o.Plane,position2D:new o.Vector2},i._onSceneRenderedHandler=i.onSceneRendered.bind(a(i)),i._onViewerDisposedHandler=i.onViewerDisposed.bind(a(i)),i._options=null!=r?r:{},i._viewer=e,i._viewer.on("sceneRendered",i._onSceneRenderedHandler),i._viewer.on("disposed",i._onViewerDisposedHandler),i.scheduleUpdate=S()((function(){return i.forceUpdate()}),20),w.a.trackCreateTool("HtmlOverlayTool"),i}return m(n,[{key:"viewerDomElement",get:function(){return this._viewer.domElement}},{key:"viewerCamera",get:function(){return this._viewer.getCamera()}},{key:"viewerRenderer",get:function(){return this._viewer.renderer}},{key:"elements",get:function(){return Array.from(this._htmlOverlays.entries()).map((function(e){var t=h(e,2);return{element:t[0],position3D:t[1].position3D}}))}},{key:"dispose",value:function(){this._viewer.off("sceneRendered",this._onSceneRenderedHandler),this._viewer.off("disposed",this._onViewerDisposedHandler),this.clear(),r(i(n.prototype),"dispose",this).call(this)}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.ensureNotDisposed(),this.viewerDomElement.contains(e))throw new Error("Element is already attached to viewer");e.style.visibility="hidden",this.viewerDomElement.appendChild(e);var r=getComputedStyle(e);if("absolute"!==r.position)throw this.viewerDomElement.removeChild(e),new Error("htmlElement style must have a position of absolute. but was '".concat(r.position,"'"));var i={position3D:t,options:n,state:{position2D:new o.Vector2,width:-1,height:-1,visible:!0}};this._htmlOverlays.set(e,i),this.scheduleUpdate()}},{key:"remove",value:function(e){if(this.ensureNotDisposed(),!this.viewerDomElement.contains(e)||!this._htmlOverlays.has(e))throw new Error("Element is not attached to viewer");this.viewerDomElement.removeChild(e),this._htmlOverlays.delete(e)}},{key:"clear",value:function(){for(var e=0,t=Array.from(this._htmlOverlays.keys());e<t.length;e++){var n=t[e];this.remove(n)}this.forceUpdate()}},{key:"forceUpdate",value:function(){if(this.ensureNotDisposed(),this.cleanupClusterElements(),0!==this._htmlOverlays.size){this.updateNewElementSizes();var e=this.viewerCamera,t=this.viewerRenderer,n=this._preallocatedVariables,r=n.camPos,i=n.camNormal,o=n.point,a=n.nearPlane,s=n.farPlane,u=n.position2D;e.getWorldPosition(r),e.getWorldDirection(i),o.copy(r).addScaledVector(i,e.near),a.setFromNormalAndCoplanarPoint(i,o),o.copy(r).addScaledVector(i,e.far),s.setFromNormalAndCoplanarPoint(i,o),this._htmlOverlays.forEach((function(n,i){var o=n.position3D,c=n.options,l=c.positionUpdatedCallback,d=c.userData,f=n.state,p=a.distanceToPoint(o)>=0&&s.distanceToPoint(o)<=0,h=Object(y.d)(t,e,o),v=h.x,m=h.y;if(p?(f.position2D.set(v,m),f.visible=!0):f.visible=!1,l){u.set(v,m);var g=r.distanceTo(o);l(i,u,o,g,d)}})),this.clusterElements(),this.commitDOMChanges()}}},{key:"updateNewElementSizes",value:function(){this._htmlOverlays.forEach((function(e,t){if(-1===e.state.width){var n=t.getBoundingClientRect();e.state.width=n.width,e.state.height=n.height}}))}},{key:"commitDOMChanges",value:function(){var e=this,t=this.viewerRenderer.domElement,n=t.offsetLeft,r=t.offsetTop;this._htmlOverlays.forEach((function(e,t){var i=e.state;t.style.left=i.position2D.x+n+"px",t.style.top=i.position2D.y+r+"px",i.visible&&"visible"!==t.style.visibility?function(e){e.style.visibility="visible",e.style.opacity="1",e.style.transition="opacity 0.2s linear"}(t):i.visible||"hidden"===t.style.visibility||function(e){e.style.visibility="hidden",e.style.opacity="0",e.style.transition="visibility 0s 0.2s, opacity 0.2s linear"}(t)})),this._compositeOverlays.forEach((function(t){e.viewerDomElement.appendChild(t)}))}},{key:"clusterElements",value:function(){var e=this._options.clusteringOptions;void 0!==e&&("overlapInScreenSpace"===e.mode?this.clusterByOverlapInScreenSpace(e.createClusterElementCallback):Object(y.c)(e.mode,"Unsupported clustering mode: '"+e.mode))}},{key:"cleanupClusterElements",value:function(){var e=this;this._compositeOverlays.forEach((function(t){e.viewerDomElement.removeChild(t)})),this._compositeOverlays.splice(0)}},{key:"clusterByOverlapInScreenSpace",value:function(e){var t,n,r=(t=this.viewerRenderer.domElement.getBoundingClientRect(),(n=null!=n?n:new o.Box2).min.set(t.left,t.top),n.max.set(t.right,t.bottom),n),i=r.getSize(new o.Vector2);r.set(new o.Vector2(0,0),i);var a,s=new _(r,[10,10]),u=f(this._htmlOverlays.entries());try{for(u.s();!(a=u.n()).done;){var l=h(a.value,2),d=l[0],p=l[1],v=p.state,m=E(p);v.visible&&m.intersectsBox(r)&&s.insert(m,c({htmlElement:d},p))}}catch(e){u.e(e)}finally{u.f()}var y,g=new o.Box2,b=new o.Vector2,x=f(this._htmlOverlays.values());try{for(x.s();!(y=x.n()).done;){var w=y.value,M=w.state;if(E(w,g),M.visible&&g.intersectsBox(r)){var S=Array.from(s.removeOverlappingElements(g));if(S.length>1){var T=S.reduce((function(e,t){return e.add(t.state.position2D)}),b.set(0,0)).divideScalar(S.length),k=e(S.map((function(e){return{htmlElement:e.htmlElement,userData:e.options.userData}})));S.forEach((function(e){return e.state.visible=!1})),this.addComposite(k,T)}}}}catch(e){x.e(e)}finally{x.f()}}},{key:"addComposite",value:function(e,t){var n=this.viewerRenderer.domElement;e.style.visibility="visible",e.style.left=t.x+n.offsetLeft+"px",e.style.top=t.y+n.offsetTop+"px",this._compositeOverlays.push(e)}},{key:"onSceneRendered",value:function(){this.forceUpdate()}},{key:"onViewerDisposed",value:function(){this.dispose()}}]),n}(g);function E(e,t){var n=e.state;return(t=null!=t?t:new o.Box2).min.set(n.position2D.x,n.position2D.y),t.max.set(n.position2D.x+n.width,n.position2D.y+n.height),t}var k,A=function(e){l(r,e);var t,n=d(r);function r(e,t){var i;return v(this,r),(i=n.call(this))._cadModel=t,i._rootTreeIndex=e,i.preloadBoundingBoxData(t,e),w.a.trackCreateTool("ExplodedViewTool"),i}return m(r,[{key:"readyPromise",get:function(){return this._treeBoundingBoxdata.then()}},{key:"expand",value:(t=u(p.mark((function e(t){var n,r=this;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._treeBoundingBoxdata;case 2:return n=e.sent,e.next=5,Promise.all(n.map((function(e){var n=e.treeIndex,i=e.direction,o=e.transform;return 0===t?(r._cadModel.resetNodeTransformByTreeIndex(n),Promise.resolve(0)):(o.setPosition(i.x*t,i.y*t,i.z*t),r._cadModel.setNodeTransformByTreeIndex(n,o))})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this._cadModel.resetNodeTransformByTreeIndex(this._rootTreeIndex,!0)}},{key:"preloadBoundingBoxData",value:function(e,t){var n=e.getBoundingBoxByTreeIndex(t).then((function(e){return e.getCenter(new o.Vector3)})),r=e.getSubtreeTreeIndices(t).then((function(e){if(e.count>1e3)throw new Error("Subtree size of ".concat(e.count," is too large (max size = 1000)"));return e})).then((function(t){return Promise.all(t.toArray().map(function(){var t=u(p.mark((function t(n){return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n,t.next=3,e.getBoundingBoxByTreeIndex(n);case 3:return t.t1=t.sent.getCenter(new o.Vector3),t.abrupt("return",{subTreeIndex:t.t0,subTreeIndexBoundingBoxCenter:t.t1});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}));this._treeBoundingBoxdata=Promise.all([n,r]).then((function(e){var t=h(e,2),n=t[0];return t[1].map((function(e){var t=e.subTreeIndex,r=e.subTreeIndexBoundingBoxCenter;return{treeIndex:t,direction:(new o.Vector3).subVectors(r,n),transform:new o.Matrix4}}))})).then(function(){var t=u(p.mark((function t(n){return p.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.map((function(t){return e.setNodeTransformByTreeIndex(t.treeIndex,t.transform)})));case 2:return t.abrupt("return",n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]),r}(g),P=function(e){l(n,e);var t=d(n);function n(e){var r;return v(this,n),(r=t.call(this))._onViewerDisposedHandler=r.onViewerDisposed.bind(a(r)),r._viewer=e,r._viewer.on("disposed",r._onViewerDisposedHandler),r}return m(n,[{key:"viewerCamera",get:function(){return this._viewer.getCamera()}},{key:"dispose",value:function(){this._viewer.off("disposed",this._onViewerDisposedHandler),r(i(n.prototype),"dispose",this).call(this)}},{key:"showCameraHelper",value:function(){this.hideCameraHelper(),this._cameraHelper=new o.CameraHelper(this.viewerCamera.clone()),this._viewer.addObject3D(this._cameraHelper)}},{key:"hideCameraHelper",value:function(){void 0!==this._cameraHelper&&(this._viewer.removeObject3D(this._cameraHelper),this._cameraHelper=void 0)}},{key:"onViewerDisposed",value:function(){this.dispose()}}]),n}(g),C=n(15),O=n.n(C),I=n(32),R=n.n(I),N=n(11),D=n.n(N);!function(e){e[e.TopRight=0]="TopRight",e[e.TopLeft=1]="TopLeft",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight"}(k||(k={}));var L,B,F,j,z,U,G,V,W,H,Z={ringLabel:"N",labelDelta:Math.PI,fontSize:void 0,fontColor:new o.Color(16711680),tickColor:new o.Color(9737364)},q={label:"",fontSize:void 0,fontColor:new o.Color(3355443),outlineSize:void 0,outlineColor:new o.Color(3355443),faceColor:new o.Color(9737364)},Y={size:128,position:{corner:k.BottomRight,padding:new o.Vector2},animationSpeed:200,faces:{xPositiveFace:c(c({},q),{},{label:"Right"}),xNegativeFace:c(c({},q),{},{label:"Left"}),yPositiveFace:c(c({},q),{},{label:"Up"}),yNegativeFace:c(c({},q),{},{label:"Down"}),zPositiveFace:c(c({},q),{},{label:"Front"}),zNegativeFace:c(c({},q),{},{label:"Back"})},compass:Z},X=function(e){l(n,e);var t=d(n);function n(e,r){var i,a,s;return v(this,n),(s=t.call(this))._dynamicUpdatePosition=function(){},s._updateClickDiv=function(){},s._screenPosition=new o.Vector2,s._boxFaceGeometry=new o.PlaneGeometry(.85,.85,1,1),s._raycastCamera=new o.OrthographicCamera(-1,1,1,-1,-1,1),s._raycaster=new o.Raycaster,s._viewer=e,s._layoutConfig=R()(O()(Y),r),s._axisGroup=new o.Group,s._interactiveObjects=s.createAxisCross(s._axisGroup),i=s.createClickDiv(e),a=h(i,2),s._updateClickDiv=a[0],s._disposeClickDiv=a[1],s.addAxisBoxToViewer(s._axisGroup,s._layoutConfig.position),w.a.trackCreateTool("AxisViewTool"),s}return m(n,[{key:"dispose",value:function(){r(i(n.prototype),"dispose",this).call(this),this._viewer.removeUiObject(this._axisGroup),this._disposeClickDiv()}},{key:"createClickDiv",value:function(e){var t=this;if(null===e.domElement.querySelector("canvas"))throw new Error("Could not find canvas");var n=document.createElement("div");n.style.position="absolute",n.style.height=this._layoutConfig.size+"px",n.style.width=this._layoutConfig.size+"px",n.style.zIndex="1";var r=0,i=0;return n.addEventListener("mousedown",(function(t){var n=new MouseEvent("mousedown",{clientX:t.clientX,clientY:t.clientY,button:t.button});r=t.clientX,i=t.clientY,e.renderer.domElement.dispatchEvent(n)})),n.addEventListener("mousemove",(function(t){var n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY,button:t.button});e.renderer.domElement.dispatchEvent(n)})),n.addEventListener("contextmenu",(function(e){return e.preventDefault()})),n.addEventListener("mouseup",(function(n){var o=new MouseEvent("mouseup",{clientX:n.clientX,clientY:n.clientY,button:n.button}),a=e.domElement.getBoundingClientRect(),s=n.clientX-a.left,u=n.clientY-a.top;Math.abs(r-n.clientX)+Math.abs(i-n.clientY)<=10&&!t.handleClick(s,u,a)&&e.renderer.domElement.dispatchEvent(o)})),e.domElement.appendChild(n),[function(){n.style.left=t._screenPosition.x+"px",n.style.bottom=t._screenPosition.y+"px"},function(){e.domElement.removeChild(n)}]}},{key:"addAxisBoxToViewer",value:function(e,t){var n=this,r=this._layoutConfig.size;if(function(e){return void 0!==e.xAbsolute&&void 0!==e.yAbsolute}(t))this._screenPosition.x=t.xAbsolute,this._screenPosition.y=t.yAbsolute;else{switch(t.corner){case k.BottomRight:this._screenPosition.y=t.padding.y,this._dynamicUpdatePosition=function(){n._screenPosition.x=n._viewer.renderer.domElement.clientWidth-t.padding.x-r};break;case k.TopRight:this._dynamicUpdatePosition=function(){n._screenPosition.x=n._viewer.renderer.domElement.clientWidth-t.padding.x-r,n._screenPosition.y=n._viewer.renderer.domElement.clientHeight-t.padding.y-r};break;case k.TopLeft:this._screenPosition.x=t.padding.x,this._dynamicUpdatePosition=function(){n._screenPosition.y=n._viewer.renderer.domElement.clientHeight-t.padding.y-r};break;case k.BottomLeft:this._screenPosition.x=t.padding.x,this._screenPosition.y=t.padding.y;break;default:throw new Error("Unknown corner position for Axis Cross: Corner = "+t.corner)}this._dynamicUpdatePosition()}this._viewer.addUiObject(e,this._screenPosition,new o.Vector2(r,r))}},{key:"handleClick",value:function(e,t,n){var r=2*(e-this._screenPosition.x)/this._layoutConfig.size-1,i=2*(n.height-t-this._screenPosition.y)/this._layoutConfig.size-1;this._raycaster.setFromCamera({x:r,y:i},this._raycastCamera);var a=new o.Vector3(r,i,1),s=new o.Vector3(0,0,-1).normalize();this._raycaster.set(a,s);var u=this._raycaster.intersectObjects(this._interactiveObjects);if(!(u.length>0))return!1;var c=u[0].object.position.clone().normalize(),l=u[0].object.userData.upVector.clone();return this.moveCameraTo(this._viewer.getCamera(),this._viewer.cameraControls,c,l),!0}},{key:"createAxisCross",value:function(e){var t=this.createBoxFaces();e.add.apply(e,s(t));var n=this.createCompass();return e.add(n),this.setupTransformOnRender(e),t}},{key:"setupTransformOnRender",value:function(e){var t=this;e.children[0].onBeforeRender=function(){t._dynamicUpdatePosition(),e.quaternion.copy(t._viewer.getCamera().quaternion).invert(),e.updateMatrixWorld(),t._updateClickDiv()}}},{key:"createBoxFaces",value:function(){var e=this._layoutConfig.faces;return[this.createBoxFace(new o.Vector3(1,0,0),e.xPositiveFace),this.createBoxFace(new o.Vector3(-1,0,0),e.xNegativeFace),this.createBoxFace(new o.Vector3(0,1,0),e.yPositiveFace,new o.Vector3(0,0,-1)),this.createBoxFace(new o.Vector3(0,-1,0),e.yNegativeFace,new o.Vector3(0,0,1)),this.createBoxFace(new o.Vector3(0,0,1),e.zPositiveFace),this.createBoxFace(new o.Vector3(0,0,-1),e.zNegativeFace)]}},{key:"createCompass",value:function(){var e=new o.PlaneGeometry(2.1,2.1,1,1),t=new o.Mesh(e,new o.MeshBasicMaterial({map:this.createCompassTexture(),side:o.DoubleSide,transparent:!0})),n=Math.sin(this._layoutConfig.compass.labelDelta),r=Math.cos(this._layoutConfig.compass.labelDelta);return t.position.y=-.5,t.up.copy(new o.Vector3(n,0,r)),t.lookAt(0,0,0),t}},{key:"createCompassTexture",value:function(){var e,t=this._layoutConfig.compass,n=this._layoutConfig.size,r=document.createElement("canvas");r.width=n,r.height=n;var i=r.getContext("2d"),a=n/2,s=a-a/4,u=n/32,c=n/8;if(i.strokeStyle=t.tickColor.getStyle(),i.lineWidth=n/16,i.setLineDash([u,c]),i.beginPath(),i.arc(a,a,s,0,2*Math.PI),i.stroke(),t.ringLabel&&t.ringLabel.length>0){var l=null!==(e=t.fontSize)&&void 0!==e?e:n/5;i.font="bold ".concat(l,"px Arial"),i.textAlign="center",i.fillStyle=t.fontColor.getStyle(),i.fillText(t.ringLabel,a,a*(1/4)+l/3)}return new o.CanvasTexture(r)}},{key:"getFaceTexture",value:function(e,t){var n,r,i=t/2,a=document.createElement("canvas");a.width=i,a.height=i;var s=a.getContext("2d");s.fillStyle=e.outlineColor.getStyle(),s.fillRect(0,0,i,i),s.fillStyle=e.faceColor.getStyle();var u=null!==(n=e.outlineSize)&&void 0!==n?n:i/32;if(s.fillRect(u,u,i-2*u,i-2*u),s.fill(),""!==e.label){var c=null!==(r=e.fontSize)&&void 0!==r?r:i/3;s.font="bold ".concat(c,"px Arial"),s.textAlign="center",s.fillStyle=e.fontColor.getStyle(),s.fillText(e.label,i/2,i/2+c/3)}return new o.CanvasTexture(a)}},{key:"createBoxFace",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new o.Vector3(0,1,0),r=new o.Mesh(this._boxFaceGeometry,new o.MeshBasicMaterial({map:this.getFaceTexture(t,this._layoutConfig.size)}));return r.position.copy(e.multiplyScalar(.5*this._boxFaceGeometry.parameters.width)),r.lookAt(e.multiplyScalar(2)),r.userData.upVector=n,r}},{key:"moveCameraTo",value:function(e,t,n,r){var i=e.position.clone(),a=t.getState().target,s=i.clone().sub(a),u=s.length(),c=s.clone().normalize(),l=Math.acos(c.dot(n)),d={t:0},f=new D.a.Tween(d),p=n.clone(),h=e.quaternion.clone(),v=(new o.Quaternion).setFromRotationMatrix((new o.Matrix4).makeBasis(r.clone().cross(p),r,p));if(!(h.angleTo(v)<1e-6)){var m,y=new o.Vector3,g=new o.Quaternion;f.to({t:1},this._layoutConfig.animationSpeed).onUpdate((function(){y.copy(c).multiplyScalar(Math.sin((1-d.t)*l)/Math.sin(l)).add(n.clone().multiplyScalar(Math.sin(d.t*l)/Math.sin(l))),y.multiplyScalar(u),y.add(a),g.slerpQuaternions(h,v,d.t),e.position.copy(y),e.setRotationFromQuaternion(g)})).start(D.a.now()).onStart((function(){m=t.enabled,t.enabled=!1})).onComplete((function(){t.setState(e.position,a),t.enabled=m})).update(D.a.now())}}}]),n}(g),K=n(17);!function(e){e.BingMap="BingMap",e.HereMap="HereMap",e.MapboxMap="MapboxMap",e.OpenStreetMap="OpenStreetMap"}(L||(L={})),function(e){e[e.Style=100]="Style",e[e.Map_Id=101]="Map_Id"}(B||(B={})),function(e){e.Streets="mapbox/streets-v10",e.Outdoor="mapbox/outdoors-v10",e.Light="mapbox/light-v9",e.Dark="mapbox/dark-v9",e.Satellite="mapbox/satellite-v9",e.Satellite_Streets="mapbox/satellite-streets-v10",e.Navigation_Day="mapbox/navigation-preview-day-v4",e.Navigation_Night="mapbox/navigation-preview-night-v4",e.Navigation_Guide_Day="mapbox/navigation-guidance-day-v4",e.Navigation_Guide_Night="mapbox/navigation-guidance-night-v4"}(F||(F={})),function(e){e.Streets="mapbox.mapbox-streets-v7",e.Satellite="mapbox.satellite",e.Terrain="mapbox.mapbox-terrain-v2",e.Traffic="mapbox.mapbox-traffic-v1",e.TerrainRGB="mapbox.terrain-rgb"}(j||(j={})),function(e){e.PNG="png",e.PNG32="png32",e.PNG64="png64",e.PNG128="png128",e.PNG256="png256",e.JPG70="jpg70",e.JPG80="jpg80",e.JPG90="jpg90",e.PNGRAW="pngraw"}(z||(z={})),function(e){e.Aerial="a",e.Road="r",e.Aerial_Labels="h",e.Oblique="o",e.Oblique_Labels="b"}(U||(U={})),function(e){e.GIF="gif",e.JPEG="jpeg",e.PNG="png"}(G||(G={})),function(e){e.Aerial="aerial",e.Base="base",e.Pano="pano",e.Traffic="traffic"}(V||(V={})),function(e){e.Day="normal.day",e.Night="normal.night",e.Terrain="terrain.day",e.Satellite="satellite.day"}(W||(W={})),function(e){e.PNG="png",e.PNG8="png8",e.JPG="jpg"}(H||(H={}));var J=function(){function e(t,n){v(this,e),this._intervalId=0,this._onCameraChange=this.handleCameraChange.bind(this),this._viewer=t;var r=this.getMapProvider(n);this._map=new K.MapView(K.MapView.PLANAR,r,r),this._viewer.addObject3D(this._map);var i=K.UnitsUtils.datumsToSpherical(n.latlong.latitude,n.latlong.longitude),o=this._viewer.models[0].getModelBoundingBox();this._map.position.set(-i.x,o.min.y,i.y),this._map.updateMatrixWorld(!0),this.requestRedraw(1e4),this._viewer.on("cameraChange",this._onCameraChange)}return m(e,[{key:"requestRedraw",value:function(e){var t=this;0==this._intervalId&&(this._intervalId=setInterval((function(){t._viewer.requestRedraw()}),100),setTimeout((function(){clearInterval(t._intervalId),t._intervalId=0}),e))}},{key:"getMapProvider",value:function(e){var t;switch(e.provider){case L.BingMap:t=new K.BingMapsProvider(e.APIKey,e.type);break;case L.HereMap:t=new K.HereMapsProvider(e.APIKey,e.appCode,e.style,e.scheme,e.imageFormat,e.size);break;case L.MapboxMap:t=new K.MapBoxProvider(e.APIKey,e.id,e.mode,e.tileFormat);break;case L.OpenStreetMap:t=new K.OpenStreetMapsProvider;break;default:throw new Error("Unsupported map provider")}return t}},{key:"latLongToWorldCoordinates",value:function(e){return K.UnitsUtils.datumsToSpherical(e.latitude,e.longitude)}},{key:"handleCameraChange",value:function(){this.requestRedraw(1e3)}},{key:"dispose",value:function(){this._viewer.removeObject3D(this._map),this._viewer.off("cameraChange",this._onCameraChange)}}]),e}(),Q=function(e){l(n,e);var t=d(n);function n(e,r){var i;return v(this,n),(i=t.call(this))._viewer=e,i._maps=new J(i._viewer,r),w.a.trackCreateTool("AxisViewTool"),i}return m(n,[{key:"latLongToWorldCoordinates",value:function(e){return this._maps.latLongToWorldCoordinates(e)}},{key:"dispose",value:function(){r(i(n.prototype),"dispose",this).call(this),this._maps.dispose()}}]),n}(g),$=function(){function e(t,n){v(this,e),this._nodeCollectionAndAppearance=[],this._model=t,this._date=n}return m(e,[{key:"getKeyframeDate",value:function(){return this._date}},{key:"activate",value:function(){var e=this;this._nodeCollectionAndAppearance.forEach((function(t,n){e._model.assignStyledNodeCollection(t.nodes,t.nodeAppearance)}))}},{key:"deactivate",value:function(){var e=this;this._nodeCollectionAndAppearance.forEach((function(t,n){e._model.unassignStyledNodeCollection(t.nodes)}))}},{key:"assignStyledNodeCollection",value:function(e,t){if(w.a.trackCadModelStyled(e.classToken,t),-1!==this._nodeCollectionAndAppearance.findIndex((function(t){return t.nodes===e})))throw new Error("Node collection as already been assigned, use updateStyledNodeCollection() to update the appearance");this._nodeCollectionAndAppearance.push({nodes:e,nodeAppearance:t})}},{key:"unassignStyledNodeCollection",value:function(e){var t=this._nodeCollectionAndAppearance.findIndex((function(t){return t.nodes===e}));if(-1===t)throw new Error("Node collection has not been assigned to model");this._nodeCollectionAndAppearance.splice(t,1)}}]),e}(),ee=function(e){l(n,e);var t=d(n);function n(e){var r;return v(this,n),(r=t.call(this))._playback=void 0,r._events={dateChanged:new y.b},r._model=e,r._keyframes=new Array,r}return m(n,[{key:"subscribe",value:function(e,t){"dateChanged"===e?this._events.dateChanged.subscribe(t):Object(y.c)(e,"Unsupported event: '".concat(e,"'"))}},{key:"unsubscribe",value:function(e,t){"dateChanged"===e?this._events.dateChanged.unsubscribe(t):Object(y.c)(e,"Unsupported event: '".concat(e,"'"))}},{key:"createKeyframe",value:function(e){var t=new $(this._model,e);return this._keyframes.push(t),this.sortKeyframesByDates(),t}},{key:"getKeyframeByDate",value:function(e){return this._keyframes.find((function(t){return t.getKeyframeDate()===e}))}},{key:"removeKeyframe",value:function(e){var t=this._keyframes.findIndex((function(t){return t===e}));t>-1&&this._keyframes.splice(t,1)}},{key:"removeKeyframeByDate",value:function(e){var t=this._keyframes.findIndex((function(t){return t.getKeyframeDate()===e}));t>-1&&this._keyframes.splice(t,1)}},{key:"play",value:function(e,t,n){var r=this;this.stop();var i={dateInMs:e.getTime()},o={dateInMs:t.getTime()},a=new D.a.Tween(i).to(o,n),s=-1;a.onUpdate((function(){for(var n=new Date(i.dateInMs),o=s;s<r._keyframes.length-1&&r._keyframes[s+1].getKeyframeDate().getTime()<=n.getTime();)s++;s!==o&&(-1!==o&&r._keyframes[o].deactivate(),r._keyframes[s].activate()),r._events.dateChanged.fire({date:n,activeKeyframe:r._keyframes[s],startDate:e,endDate:t})})),this._playback=a,a.start()}},{key:"stop",value:function(){void 0!==this._playback&&(this._playback.stop(),this._playback=void 0)}},{key:"pause",value:function(){void 0!==this._playback&&this._playback.isPlaying()&&this._playback.pause()}},{key:"resume",value:function(){void 0!==this._playback&&this._playback.isPaused()&&this._playback.resume()}},{key:"getAllKeyframes",value:function(){return this._keyframes.slice()}},{key:"dispose",value:function(){r(i(n.prototype),"dispose",this).call(this),this._events.dateChanged.unsubscribeAll()}},{key:"sortKeyframesByDates",value:function(){this._keyframes.length>1&&this._keyframes.sort((function(e,t){return e.getKeyframeDate().getTime()-t.getKeyframeDate().getTime()}))}}]),n}(g),te=n(2),ne=function(e){l(n,e);var t=d(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,n),(r=t.call(this))._boundingBoxes=new o.Group,r._viewer=e,r._viewer.addObject3D(r._boundingBoxes),r._options={},r.setOptions(i),r}return m(n,[{key:"setOptions",value:function(e){this._options=c({showDetailedSectors:!0,showDiscardedSectors:!1,showSimpleSectors:!0,colorBy:"lod",leafsOnly:!1,sectorPathFilterRegex:".*"},e)}},{key:"dispose",value:function(){this._viewer.removeObject3D(this._boundingBoxes)}},{key:"showSectorBoundingBoxes",value:function(e){this._model=e,this.updateBoundingBoxes()}},{key:"updateBoundingBoxes",value:function(){var e=this;if(this._boundingBoxes.clear(),void 0!==this._model){this._model.getModelTransformation(this._boundingBoxes.matrix);var t=[];t[te.d.Discarded]=this._options.showDiscardedSectors,t[te.d.Simple]=this._options.showSimpleSectors,t[te.d.Detailed]=this._options.showDetailedSectors;var n=[];this._model.cadNode.traverse((function(r){if(ie(r)){var i=r;e.isSectorAcceptedByCurrentFilter(i)&&t[i.levelOfDetail]&&(!e._options.leafsOnly||function(e){return!e.children.some((function(e){return ie(e)}))}(i))&&n.push(i)}})),n.forEach((function(t){var r=e.createBboxNodeFor(t,n);e._boundingBoxes.add(r)})),this._boundingBoxes.updateMatrixWorld(!0),this._viewer.requestRedraw()}}},{key:"isSectorAcceptedByCurrentFilter",value:function(e){return new RegExp(this._options.sectorPathFilterRegex).test(e.sectorPath)}},{key:"createBboxNodeFor",value:function(e,t){var n=this._options,r=function(){switch(n.colorBy){case"depth":var r=Math.min(1,e.depth/8);return new o.Color(re.green).lerpHSL(re.red,r);case"lod":switch(e.levelOfDetail){case te.d.Simple:return re.yellow;case te.d.Detailed:return re.green;case te.d.Discarded:return re.red;default:Object(y.c)(e.levelOfDetail)}case"loadedTimestamp":var i=s(t).sort((function(e,t){return e.updatedTimestamp-t.updatedTimestamp})),a=i.findIndex((function(t){return t===e})),u=(i.length-1-a)/Math.max(i.length-1,1);return new o.Color(re.green).lerpHSL(re.red,u);case"random":return(new o.Color).setHSL(Math.random(),1,.5);default:Object(y.c)(n.colorBy)}}();return new o.Box3Helper(e.bounds,r)}}]),n}(g),re={green:new o.Color("#00ff00"),yellow:new o.Color("yellow"),red:new o.Color("red")};function ie(e){return e.name.match(/^Sector \d+$/)}}])},16529:function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(74634)),o=r(n(36095)),a=r(n(42457)),s=r(n(83080)),u=r(n(13863)),c=r(n(26624)),l=r(n(60584)),d=n(5796),f=n(1380),p=r(f),h=n(72082),v=r(n(1015)),m=r(n(25107)),y=r(n(99367)),g="cognitedata.com",b="https://api.cognitedata.com",x="Authorization",_="api-key",w="x-cdp-app",M="x-cdp-sdk",S="x-request-id",T=Object.freeze({__proto__:null,DEFAULT_CLUSTER:"api",DEFAULT_DOMAIN:g,BASE_URL:b,AUTHORIZATION_HEADER:x,API_KEY_HEADER:_,X_CDF_APP_HEADER:w,X_CDF_SDK_HEADER:M,X_REQUEST_ID:S,LOCAL_STORAGE_PREFIX:"@cognite/sdk:"}),E=function(){var e=this;this.add=function(t){e.data.unshift(t)},this.remove=function(){e.data.pop()},this.first=function(){return e.data[0]},this.last=function(){return e.data[e.data.length-1]},this.size=function(){return e.data.length},this.data=[]},k=Object.freeze({__proto__:null,topologicalSort:function(e){var t=new E,n=[],r=function(e){var t=new Map;return e.forEach((function(e){t.set(e,[])})),e.forEach((function(e){var n=e.parentNode;n&&t.get(n).push(e)})),t}(e);for(e.forEach((function(e){e.parentNode||t.add(e)}));0!==t.size();){var i=t.last();t.remove(),n.push(i);var o=r.get(i);o&&o.forEach(t.add)}if(n.length!==e.length)throw Error("Impossible to topological sort nodes");return n}}),A=function(e,t){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},A(e,t)};function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C.apply(this,arguments)};function O(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function I(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function R(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function N(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(R(arguments[t]));return e}void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.for("asyncIterator"));var D=function(e){function t(n,r,i,o){void 0===o&&(o={});var a=this,s=n+" | code: "+r;i&&(s+=" | X-Request-ID: "+i);var u=o.missing,c=o.duplicated,l=o.extra;return(u||c)&&(s+="\n"+JSON.stringify(o,null,2)),a=e.call(this,s)||this,Object.setPrototypeOf(a,t.prototype),a.errorMessage=n,a.status=r,a.requestId=i,a.missing=u,a.duplicated=c,a.extra=l,Error.captureStackTrace?Error.captureStackTrace(a,a.constructor):a.stack=new Error(s).stack,a}return P(t,e),t.prototype.toJSON=function(){var e={status:this.status,message:this.errorMessage};return this.requestId&&(e.requestId=this.requestId),this.missing&&(e.missing=this.missing),this.duplicated&&(e.duplicated=this.duplicated),this.extra&&(e.extra=this.extra),e},t}(Error);function L(e){return e.map((function(e){if(e instanceof D)return e;var t=e.message;return{name:e.name,message:t,stack:e.stack}}))}var B=function(e){function t(n){var r,i,o=n.succeded,a=n.responses,s=n.failed,u=n.errors,c=e.call(this,"The API Failed to process some items\n"+JSON.stringify({succeded:o,responses:a,failed:s,errors:L(u)},null,2))||this;c.missing=[],c.duplicated=[],c.statuses=[],c.requestIds=[],c.responses=[],Object.setPrototypeOf(c,t.prototype),c.responses=a.map((function(e){return e.data})),c.errors=u,c.succeded=o.reduce((function(e,t){return e.concat(t)}),[]),c.failed=s.reduce((function(e,t){return e.concat(t)}),[]),c.status=u[0].status,c.requestId=u[0].requestId;try{for(var l=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(u),d=l.next();!d.done;d=l.next()){var f=d.value;f instanceof D&&(f.missing&&(c.missing=c.missing.concat(f.missing)),f.duplicated&&(c.duplicated=c.duplicated.concat(f.duplicated)),f.requestId&&c.requestIds.push(f.requestId),c.statuses.push(f.status))}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return Error.captureStackTrace?Error.captureStackTrace(c,c.constructor):c.stack=new Error(c.message).stack,c}return P(t,e),t}(Error);function F(e){return e||b}var j=function(e){return void 0===e&&(e="v1"),"/api/"+e};function z(e){return"Bearer "+e}function U(){return"undefined"!=typeof window&&void 0!==window.document}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=window.location.href;e.forEach((function(e){n=V(n,e)})),window.history.replaceState(null,"",n)}function V(e,t){return e.replace(new RegExp("[?#&]"+t+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?#&])"+t+"=[^&]*&"),"$1")}function W(e){return(u(e)||i(e))&&!c(e)&&!(e instanceof ArrayBuffer)&&!(e instanceof Date)}function H(e){return new Promise((function(t){setTimeout(t,e)}))}function Z(e,t){return O(this,void 0,void 0,(function(){var n,r,i,o,a,s;return I(this,(function(u){switch(u.label){case 0:return n=[],r=[],i=[],o=[],a=e.map((function(e){return t(e)})),s=a.map((function(t,a){return t.then((function(t){r.push(e[a]),i.push(t)})).catch((function(t){n.push(e[a]),o.push(t)}))})),[4,Promise.all(s)];case 1:if(u.sent(),n.length)throw{succeded:r,responses:i,failed:n,errors:o};return[2,i]}}))}))}function q(e,t,n){return O(this,void 0,void 0,(function(){var r;return I(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),n?[4,Y(e,t)]:[3,2];case 1:case 3:return[2,i.sent()];case 2:return[4,Z(e,t)];case 4:return[3,6];case 5:throw r=i.sent(),new B(r);case 6:return[2]}}))}))}function Y(e,t){return O(this,void 0,void 0,(function(){var n=this;return I(this,(function(r){return[2,e.reduce((function(r,i,o){return O(n,void 0,void 0,(function(){var n,a,s;return I(this,(function(u){switch(u.label){case 0:return[4,r];case 1:n=u.sent(),u.label=2;case 2:return u.trys.push([2,4,,5]),s=(a=n).concat,[4,t(i)];case 3:return[2,s.apply(a,[u.sent()])];case 4:throw{errors:[u.sent()],failed:e.slice(o),succeded:e.slice(0,o),responses:n};case 5:return[2]}}))}))}),Promise.resolve(new Array))]}))}))}function X(e,t){return t?t(e):e}function K(){return U()&&"https:"===location.protocol.toLowerCase()}var J,Q=function(){function e(e,t){var n=this;this.path=e,this.datePropNames=t,this.isDatePropName=function(e){return"string"==typeof e&&-1!=n.datePropNames.indexOf(e)},this.isPath=function(e){return"string"==typeof e&&-1!=n.path.indexOf(e)}}return e.prototype.parseToDates=function(e){var t=this;return l(e,(function(e,n,r){return t.isDatePropName(n)?new Date(e):void 0===n||t.isPath(n)||r instanceof Array?void 0:e}))},e.parseFromDates=function(e){return l(e,(function(e){if(e instanceof Date)return e.getTime()}))},e}(),$=function(){function e(e,t,n){var r=this;this.resourcePath=e,this.httpClient=t,this.map=n,this.get=this.requestWrapper(this.httpClient.get.bind(this.httpClient)),this.post=this.requestWrapper(this.httpClient.post.bind(this.httpClient)),this.put=this.requestWrapper(this.httpClient.put.bind(this.httpClient)),this.callListEndpointWithGet=function(e){return O(r,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return[4,this.get(this.listGetUrl,{params:e})];case 1:return[2,t.sent()]}}))}))},this.callListEndpointWithPost=function(e){return O(r,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return[4,this.post(this.listPostUrl,{data:e||{}})];case 1:return[2,t.sent()]}}))}))},this.dateParser=new(Q.bind.apply(Q,N([void 0],this.getDateProps())))}return Object.defineProperty(e.prototype,"listGetUrl",{get:function(){return this.url("")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listPostUrl",{get:function(){return this.url("list")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"byIdsUrl",{get:function(){return this.url("byids")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateUrl",{get:function(){return this.url("update")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"searchUrl",{get:function(){return this.url("search")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deleteUrl",{get:function(){return this.url("delete")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aggregateUrl",{get:function(){return this.url("aggregate")},enumerable:!1,configurable:!0}),e.chunk=function(e,t){return 0===e.length?[[]]:s(e,t)},e.prototype.getMetadataMap=function(){return this.map},e.prototype.getDateProps=function(){return[[],[]]},e.prototype.pickDateProps=function(e,t){return[e,t]},e.prototype.url=function(e){return void 0===e&&(e=""),this.resourcePath+"/"+e},e.prototype.requestWrapper=function(e){var t=this;return function(n,r){return O(t,void 0,void 0,(function(){var t;return I(this,(function(i){switch(i.label){case 0:return void 0!==r&&(r=C(C({},r),{params:Q.parseFromDates(r.params),data:Q.parseFromDates(r.data)})),[4,e(n,r)];case 1:return t=i.sent(),[2,C(C({},t),{data:this.dateParser.parseToDates(t.data)})]}}))}))}},e.prototype.createEndpoint=function(e,t,n,r){return void 0===t&&(t=this.url()),O(this,void 0,void 0,(function(){var i=this;return I(this,(function(o){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return i.callCreateEndpoint(e,t)}),n,r)]}))}))},e.prototype.listEndpoint=function(e,t){var n=this,r=e(t).then((function(r){return n.addNextPageFunction(e.bind(n),r.data,t)})),i=function(e){var t,n=e,r=0;function i(e){return r<e.items.length?{value:e.items[r++],done:!1}:e.next?(r=0,(n=e.next()).then(i)):{value:void 0,done:!0}}function o(){return O(this,void 0,void 0,(function(){return I(this,(function(e){switch(e.label){case 0:return[4,n];case 1:return[2,i(e.sent())]}}))}))}var a=function(e){return function(t){return O(this,void 0,void 0,(function(){function n(){return O(this,void 0,void 0,(function(){var r,i;return I(this,(function(o){switch(o.label){case 0:return[4,e()];case 1:return(r=o.sent()).done?[2]:(i=r.value,[4,t(i)]);case 2:return!1===o.sent()?[2]:[4,n()];case 3:return o.sent(),[2]}}))}))}return I(this,(function(e){switch(e.label){case 0:return[4,n()];case 1:return e.sent(),[2]}}))}))}}(o),s=function(e){return function(t){return O(this,void 0,void 0,(function(){var n,r,i=this;return I(this,(function(o){switch(o.label){case 0:return-1===(n=t&&t.limit||25)&&(n=1/0),r=[],[4,e((function(e){return O(i,void 0,void 0,(function(){return I(this,(function(t){return r.push(e),r.length>=n?[2,!1]:[2]}))}))}))];case 1:return o.sent(),[2,r]}}))}))}}(a),u=((t={autoPagingEach:a,autoPagingToArray:s,next:o,return:function(){return{}}})[Symbol.asyncIterator]=function(){return u},t);return u}(r);return Object.assign(r,i)},e.prototype.retrieveEndpoint=function(e,t,n){return O(this,void 0,void 0,(function(){var r=this;return I(this,(function(i){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return r.callRetrieveEndpoint(e,n,t)}))]}))}))},e.prototype.updateEndpoint=function(e,t){return O(this,void 0,void 0,(function(){var n=this;return I(this,(function(r){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return n.callUpdateEndpoint(e,t)}))]}))}))},e.prototype.searchEndpoint=function(e,t,n){return O(this,void 0,void 0,(function(){var r=this;return I(this,(function(i){return[2,this.callEndpointWithTransform(e,(function(e){return r.callSearchEndpoint(e,t,n)}))]}))}))},e.prototype.deleteEndpoint=function(e,t,n){return O(this,void 0,void 0,(function(){var r;return I(this,(function(i){switch(i.label){case 0:return[4,this.callDeleteEndpoint(e,t,n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn({},r[0])]}}))}))},e.prototype.aggregateEndpoint=function(e,t){return O(this,void 0,void 0,(function(){var n;return I(this,(function(r){switch(r.label){case 0:return[4,this.callAggregateEndpoint(e,t)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e.prototype.callRetrieveEndpoint=function(e,t,n){return void 0===t&&(t=this.byIdsUrl),O(this,void 0,void 0,(function(){return I(this,(function(r){return[2,this.postInParallelWithAutomaticChunking({params:n,path:t,items:e})]}))}))},e.prototype.callUpdateEndpoint=function(e,t){return void 0===t&&(t=this.updateUrl),O(this,void 0,void 0,(function(){return I(this,(function(n){return[2,this.postInParallelWithAutomaticChunking({path:t,items:e})]}))}))},e.prototype.callSearchEndpoint=function(e,t,n){return void 0===t&&(t=this.searchUrl),O(this,void 0,void 0,(function(){return I(this,(function(r){return[2,this.post(t,{data:e,params:n})]}))}))},e.prototype.callDeleteEndpoint=function(e,t,n){return void 0===n&&(n=this.deleteUrl),this.postInParallelWithAutomaticChunking({path:n,items:e,params:t})},e.prototype.callAggregateEndpoint=function(e,t){return void 0===t&&(t=this.aggregateUrl),O(this,void 0,void 0,(function(){return I(this,(function(n){return[2,this.post(t,{data:e})]}))}))},e.prototype.addToMapAndReturn=function(e,t){return this.map.addAndReturn(e,t)},e.prototype.callEndpointWithMergeAndTransform=function(e,t,n,r){return O(this,void 0,void 0,(function(){var i,o,a,s;return I(this,(function(u){switch(u.label){case 0:return i=X(e,n),[4,t.bind(this)(i)];case 1:return o=u.sent(),a=this.mergeItemsFromItemsResponse(o),s=X(a,r),[2,this.addToMapAndReturn(s,o[0])]}}))}))},e.prototype.callEndpointWithTransform=function(e,t){return O(this,void 0,void 0,(function(){var n;return I(this,(function(r){switch(r.label){case 0:return[4,t.bind(this)(e)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},e.prototype.mergeItemsFromItemsResponse=function(e){return e.map((function(e){return e.data.items})).reduce((function(e,t){return N(e,t)}),[])},e.prototype.addNextPageFunction=function(e,t,n){var r=this;void 0===n&&(n={});var i=t.nextCursor,o=i?function(){return e(C(C({},n),{cursor:i})).then((function(t){return r.addNextPageFunction(e,t.data,n)}))}:void 0;return C(C({},t),{next:o})},e.prototype.postInParallelWithAutomaticChunking=function(t){var n=this,r=t.path,i=t.items,o=t.params,a=t.queryParams,s=t.chunkSize,u=void 0===s?1e3:s;return q(e.chunk(i,u),(function(e){return n.post(r,{data:C(C({},o),{items:e}),params:a})}),!1)},e.prototype.callCreateEndpoint=function(e,t){return O(this,void 0,void 0,(function(){return I(this,(function(n){return[2,this.postInSequenceWithAutomaticChunking(t,e)]}))}))},e.prototype.postInSequenceWithAutomaticChunking=function(t,n,r){var i=this;return q(e.chunk(n,1e3),(function(e){return i.post(t,{data:{items:e},params:r})}),!0)},e}(),ee=function(e){function t(n,r,i){var o=e.call(this,"Request failed | status code: "+n)||this;return o.status=n,o.data=r,o.headers=i,Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace?Error.captureStackTrace(o,o.constructor):o.stack=new Error(o.message).stack,o}return P(t,e),t}(Error),te=function(){function e(e){var t=this;this.baseUrl=e,this.defaultHeaders={},this.setCluster=function(e){t.baseUrl="https://"+e+"."+g}}return e.validateStatusCode=function(e){return e>=200&&e<300},e.throwCustomErrorResponse=function(e){throw new ee(e.status,e.data,e.headers)},e.jsonResponseHandler=function(e){return e.json()},e.textResponseHandler=function(e){return e.text()},e.arrayBufferResponseHandler=function(e){return e.blob().then((function(e){return new f.Response(e).arrayBuffer()}))},e.getResponseHandler=function(t){switch(t){case ne.ArrayBuffer:return e.arrayBufferResponseHandler;case ne.Text:return e.textResponseHandler;default:return e.jsonResponseHandler}},e.convertFetchHeaders=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t},e.transformRequestBody=function(e){return W(e)?JSON.stringify(e,null,2):e},e.resolveUrl=function(e,t){return e.replace(/\/$/,"")+(("/"===t[0]?"":"/")+t).replace(/\/+$/,"")},e.prototype.setDefaultHeader=function(e,t){return this.defaultHeaders[e]=t,this},e.prototype.getDefaultHeaders=function(){return C({},this.defaultHeaders)},e.prototype.setBaseUrl=function(e){this.baseUrl=e},e.prototype.getBaseUrl=function(){return this.baseUrl},e.prototype.get=function(e,n){return void 0===n&&(n={}),this.request(C(C({},n),{path:e,method:t.HttpMethod.Get}))},e.prototype.post=function(e,n){return void 0===n&&(n={}),this.request(C(C({},n),{path:e,method:t.HttpMethod.Post}))},e.prototype.put=function(e,n){return void 0===n&&(n={}),this.request(C(C({},n),{path:e,method:t.HttpMethod.Put}))},e.prototype.delete=function(e,n){return void 0===n&&(n={}),this.request(C(C({},n),{path:e,method:t.HttpMethod.Delete}))},e.prototype.patch=function(e,n){return void 0===n&&(n={}),this.request(C(C({},n),{path:e,method:t.HttpMethod.Patch}))},e.prototype.preRequest=function(e){return O(this,void 0,void 0,(function(){var t;return I(this,(function(n){return t=this.populateDefaultHeaders(e.headers),[2,C(C({},e),{headers:t})]}))}))},e.prototype.postRequest=function(t,n){return O(this,void 0,void 0,(function(){return I(this,(function(n){return e.validateStatusCode(t.status)||e.throwCustomErrorResponse(t),[2,t]}))}))},e.prototype.populateDefaultHeaders=function(e){return void 0===e&&(e={}),C(C({},this.defaultHeaders),e)},e.prototype.rawRequest=function(t){return O(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return I(this,(function(d){switch(d.label){case 0:return n=this.constructUrl(t.path,t.params),r=function(e,t,n){void 0===e&&(e={});var r=function(e){var t=[];for(var n in e)t.push(n.toLowerCase());return t}(e),i=t.toLowerCase();return r.includes(i)||(e.Accept="application/json"),e}(t.headers,"Accept"),W(i=t.data)&&(i=e.transformRequestBody(i),r["Content-Type"]="application/json"),[4,p(n,{body:i,method:t.method,headers:r})];case 1:return o=d.sent(),a=e.getResponseHandler(t.responseType),s=o.clone(),[4,Promise.all([a(o).catch((function(){})),s.text()])];case 2:return u=R.apply(void 0,[d.sent(),2]),c=u[0],l=u[1],[2,{headers:e.convertFetchHeaders(o.headers),status:o.status,data:c||l}]}}))}))},e.prototype.request=function(e){return O(this,void 0,void 0,(function(){var t,n;return I(this,(function(r){switch(r.label){case 0:return[4,this.preRequest(e)];case 1:return t=r.sent(),[4,this.rawRequest(t)];case 2:return n=r.sent(),[2,this.postRequest(n,e)]}}))}))},e.prototype.constructUrl=function(t,n){void 0===n&&(n={});var r=t;return Object.keys(n).length>0&&(r+="?"+h.stringify(n)),null!==r.match(/^https?:\/\//i)?r:e.resolveUrl(this.baseUrl,r)},e}();(J=t.HttpMethod||(t.HttpMethod={})).Get="GET",J.Post="POST",J.Put="PUT",J.Delete="DELETE",J.Patch="PATCH";var ne={Json:"json",ArrayBuffer:"arraybuffer",Text:"text"},re=function(e){function t(t,n){var r=e.call(this,t)||this;return r.retryValidator=n,r}return P(t,e),t.calculateRetryDelayInMs=function(e){return 250+(Math.pow(2,e)-1)/2*1e3},t.prototype.rawRequest=function(n){return O(this,void 0,void 0,(function(){var r,i;return I(this,(function(o){switch(o.label){case 0:r=0,o.label=1;case 1:return[4,e.prototype.rawRequest.call(this,n)];case 2:return i=o.sent(),this.retryValidator(n,i,r)?[4,H(t.calculateRetryDelayInMs(r))]:[2,i];case 3:return o.sent(),r++,[3,1];case 4:return[2]}}))}))},t}(te),ie=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.oneTimeHeaders={},r.setBearerToken=function(e){r.setDefaultHeader(x,z(e))},r.response401Handler=function(e,t,n){return n()},r}return P(t,e),t.serializeQueryParameters=function(e){return void 0===e&&(e={}),Object.keys(e).reduce((function(t,n){var r=e[n];return t[n]=W(r)?JSON.stringify(r):r,t}),{})},t.isSameOrigin=function(e,t){var n=d.parse(e),r=n.protocol,i=n.host,o=d.parse(d.resolve(e,t)),a=o.protocol,s=o.host;return r===a&&i===s},t.filterHeaders=function(e,n){return n.reduce((function(e,n){return t.filterHeader(e,n)}),e)},t.filterHeader=function(e,t){var n=C({},e);return delete n[t],n},t.prototype.addOneTimeHeader=function(e,t){return this.oneTimeHeaders[e]=t,this},t.prototype.set401ResponseHandler=function(e){this.response401Handler=e},t.prototype.preRequest=function(e){return O(this,void 0,void 0,(function(){var n,r,i,o;return I(this,(function(a){return n=this.populateDefaultHeaders(e.headers),r=e.withCredentials?n:this.preventTokenLeakage(n,e.path),i=e.data,o=t.serializeQueryParameters(e.params),[2,C(C({},e),{data:i,headers:r,params:o})]}))}))},t.prototype.request=function(t){return O(this,void 0,void 0,(function(){return I(this,(function(n){return t.headers=this.enrichWithOneTimeHeaders(t.headers),[2,e.prototype.request.call(this,t)]}))}))},t.prototype.postRequest=function(t,n){return O(this,void 0,void 0,(function(){var r,i=this;return I(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.prototype.postRequest.call(this,t,n)];case 1:return[2,o.sent()];case 2:if(401===(r=o.sent()).status&&!this.isLoginOrLogoutApi(n.path)&&!this.isTokenInspect(n.path))return[2,new Promise((function(e,t){i.response401Handler(r,(function(){return e(i.request(n))}),(function(){return t(r)}))}))];throw function(e){var t,n,r,i,o,a;try{t=e.status,n=e.data.error.duplicated,i=e.data.error.message,o=e.data.error.missing,r=e.data.error.extra,a=function(e,t){var n=t.toLowerCase();for(var r in e)if(r.toLowerCase()==n)return e[r]}(e.headers||{},S)}catch(t){throw e}throw new D(i,t,a,{duplicated:n,extra:r,missing:o})}(r);case 3:return[2]}}))}))},t.prototype.enrichWithOneTimeHeaders=function(e){var t=this.oneTimeHeaders;return this.oneTimeHeaders={},C(C({},e),t)},t.prototype.preventTokenLeakage=function(e,n){return t.isSameOrigin(this.baseUrl,n)?e:t.filterHeaders(e,[x,_,w,M])},t.prototype.isLoginOrLogoutApi=function(e){var t=e.toLowerCase();return-1!==t.indexOf("/logout/url")||-1!==t.indexOf("/login/status")},t.prototype.isTokenInspect=function(e){return-1!==e.toLowerCase().indexOf("/token/inspect")},t}(re),oe=function(e){function t(t){var n=e.call(this,t||"Not able to login")||this;return Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=new Error(n.message).stack,n}return P(t,e),t}(Error),ae="cognite-js-sdk-auth-popup",se="access_token",ue="id_token";function ce(){return window.name===ae}function le(e,t){return O(this,void 0,void 0,(function(){var n;return I(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e("/logout/url",{params:t})];case 1:return[2,r.sent().data.data.url];case 2:if(401===(n=r.sent()).status)return[2,null];throw n;case 3:return[2]}}))}))}function de(e){var t=h.parse(e),n=t.access_token,r=t.id_token,i=t.error,a=t.error_description;if(void 0!==i)throw Error(i+": "+a);return o(n)&&o(r)?{accessToken:n,idToken:r}:null}function fe(e){return new Promise((function(t,n){var r,i=(r=he(e),window.open(r,"cognite-js-sdk-auth-popup","height=500,width=400,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes"));null!==i?window.addEventListener("message",(function e(r){r.source===i&&(r.data&&!r.data.error?(window.removeEventListener("message",e),t(r.data)):n(new oe))}),!1):n(new oe("Failed to create login popup window"))}))}function pe(e,t,n,r){return void 0===n&&(n="silentLoginIframe"),void 0===r&&(r="hash"),O(this,void 0,void 0,(function(){return I(this,(function(i){return[2,new Promise((function(i,o){var a=function(e,t){var n=document.createElement("iframe");return n.name=t,n.style.width="0",n.style.height="0",n.style.border="0",n.style.border="none",n.style.visibility="hidden",n.setAttribute("id",t),n.setAttribute("aria-hidden","true"),n.src=e,n}(e,n);a.onload=function(){try{var e=t(a.contentWindow.location[r]);if(null===e)throw Error("Failed to login silently");i(e)}catch(e){o(e)}finally{document.body.removeChild(a)}},document.body.appendChild(a)}))]}))}))}function he(e){var t=e.project,n=e.baseUrl,r=e.redirectUrl,i={project:t,redirectUrl:r,errorRedirectUrl:e.errorRedirectUrl||r};return n+"/login/redirect?"+h.stringify(i)}var ve=function(e){return void 0===e&&(e=5),function(t,n,r){return!(r>=e)&&(429===n.status||!(-1===["GET","HEAD","OPTIONS","DELETE","PUT"].indexOf(t.method.toUpperCase()))&&me(n.status))}};function me(e){return v(e,100,200)||v(e,429,430)||v(e,500,600)}var ye="POPUP";function ge(e,t){return O(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return I(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,e("/login/status",{headers:t})];case 1:return n=c.sent(),r=n.data.data,i=r.loggedIn,o=r.user,a=r.project,s=r.projectId,i?[2,{user:o,project:a,projectId:s}]:[2,null];case 2:if(401===(u=c.sent()).status)return[2,null];throw u;case 3:return[2]}}))}))}var be=function(){function e(e){var t=e.project,n=e.baseUrl;if(!o(t))throw Error("options.project is required and must be of type string");this.baseUrl=n||F(n),this.httpClient=new ie(this.baseUrl,ve()),this.project=t}return e.prototype.login=function(e){var t=this,n=e.onAuthenticate,r=n===ye?_e:a(n)?n:xe;return new Promise((function(e,n){var i={skip:function(){e(null)},redirect:function(e){(function(e){return new Promise((function(){var t=he(e);window.location.assign(t)}))})(C({baseUrl:t.baseUrl,project:t.project},e)).catch(n)},popup:function(r){return O(t,void 0,void 0,(function(){var t,i,o;return I(this,(function(a){switch(a.label){case 0:t=C({baseUrl:this.baseUrl,project:this.project},r),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fe(t)];case 2:return(i=a.sent())?(this.setTokens(i),e(i)):n(new oe),[3,4];case 3:return o=a.sent(),n(o),[3,4];case 4:return[2]}}))}))}};r(i)}))},e.prototype.getCDFToken=function(){return O(this,void 0,void 0,(function(){var e,t,n;return I(this,(function(r){switch(r.label){case 0:return this.authTokens?(e=this.authTokens,t=e.accessToken,n=e.idToken,[4,we(this.httpClient,this.project,{accessToken:t,idToken:n})]):[3,2];case 1:if(r.sent())return[2,{accessToken:t,idToken:n}];r.label=2;case 2:return[2,null]}}))}))},e.prototype.handleLoginRedirect=function(){return O(this,void 0,void 0,(function(){var e,t;return I(this,(function(n){switch(n.label){case 0:return K()||U()&&"localhost"===location.hostname?(e=function(){try{var e=de(window.location.search);return G(se,ue),e}catch(e){throw G("error","error_description"),e}}(),(t=null!==e)?[4,we(this.httpClient,this.project,e)]:[3,2]):[2,null];case 1:t=n.sent(),n.label=2;case 2:return t?(G(se,ue),this.setTokens(e),[2,e]):[2,null]}}))}))},e.prototype.setTokens=function(e){var t=e.accessToken,n=e.idToken;this.authTokens={accessToken:t,idToken:n}},e}();function xe(e){e.redirect({redirectUrl:window.location.href})}function _e(e){e.popup({redirectUrl:window.location.href})}function we(e,t,n){return O(this,void 0,void 0,(function(){var r;return I(this,(function(i){switch(i.label){case 0:return[4,Me(e,n.accessToken)];case 1:return[2,null!==(r=i.sent())&&(o=r.project,a=t,o.toLowerCase()===a.toLowerCase())]}var o,a}))}))}function Me(e,t){var n;return ge(e.get.bind(e),((n={}).Authorization=z(t),n))}var Se=function(e){function t(t,n){var r=e.call(this,"",t,n)||this;return r.status=function(){return ge(r.get,{})},r}return P(t,e),t}($),Te=function(e){function t(t,n){var r=e.call(this,"",t,n)||this;return r.getUrl=function(e){return void 0===e&&(e={}),le(r.get,e)},r}return P(t,e),t}($),Ee=function(){function e(){this.map=new WeakMap}return e.prototype.addAndReturn=function(e,t){return this.map.set(e,{status:t.status,headers:t.headers}),e},e.prototype.get=function(e){return this.map.get(e)},e}(),ke=function(){function e(e,t){var n=this;if(void 0===t&&(t="v1"),this.authenticate=function(){return O(n,void 0,void 0,(function(){var e;return I(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.getToken()];case 1:return e=t.sent(),this.apiKeyMode?this.httpClient.setDefaultHeader(_,e):this.httpClient.setDefaultHeader(x,z(e)),[2,e];case 2:return t.sent(),[2];case 3:return[2]}}))}))},this.getMetadata=function(e){return n.metadataMap.get(e)},this.get=function(e,t){return n.httpClient.get(e,t)},this.put=function(e,t){return n.httpClient.put(e,t)},this.post=function(e,t){return n.httpClient.post(e,t)},this.delete=function(e,t){return n.httpClient.delete(e,t)},this.patch=function(e,t){return n.httpClient.patch(e,t)},this.apiFactory=function(e,t){return new e(n.projectUrl+"/"+t,n.httpClient,n.metadataMap)},!i(e))throw Error("`CogniteClient` is missing parameter `options`");if(!o(e.appId))throw Error("options.appId is required and must be of type string");if(!o(e.project))throw Error("options.project is required and must be of type string");if(!a(e.getToken))throw Error("options.getToken is required and must be of type () => Promise<string>");U()&&!K()&&console.warn("You should use SSL (https) when you login with OAuth since CDF only allows redirecting back to an HTTPS site");var r=e.baseUrl;this.http=new ie(F(r),this.getRetryValidator()),this.httpClient.setDefaultHeader(w,e.appId).setDefaultHeader(M,"CogniteJavaScriptSDK:"+this.version),this.metadata=new Ee,this.loginApi=new Se(this.httpClient,this.metadataMap),this.logoutApi=new Te(this.httpClient,this.metadataMap),this.apiVersion=t,this.project=e.project,this.apiKeyMode=!!e.apiKeyMode,this.getToken=function(){return O(n,void 0,void 0,(function(){return I(this,(function(t){return[2,e.getToken()]}))}))},this.httpClient.set401ResponseHandler((function(e,t,r){return O(n,void 0,void 0,(function(){var e;return I(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.authenticate()];case 1:return(e=n.sent())&&e!==this.previousToken?(this.previousToken=e,t()):r(),[3,3];case 2:return n.sent(),r(),[3,3];case 3:return[2]}}))}))})),this.initAPIs()}return Object.defineProperty(e.prototype,"login",{get:function(){return this.loginApi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logout",{get:function(){return this.logoutApi},enumerable:!1,configurable:!0}),e.prototype.getBaseUrl=function(){return this.httpClient.getBaseUrl()},e.prototype.getDefaultRequestHeaders=function(){return C({},this.httpClient.getDefaultHeaders())},e.prototype.initAPIs=function(){},e.prototype.getRetryValidator=function(){return ve()},Object.defineProperty(e.prototype,"version",{get:function(){return"4.1.2-core"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectUrl",{get:function(){return function(e,t){return void 0===t&&(t="v1"),j(t)+"/projects/"+encodeURIComponent(e)}(this.project,this.apiVersion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadataMap",{get:function(){return this.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this.http},enumerable:!1,configurable:!0}),e}(),Ae="TEST_PROJECT",Pe="user@example.com",Ce={data:{loggedIn:!0,user:Pe,project:Ae,projectId:123}},Oe="https://example.com";function Ie(e){return void 0===e&&(e=b),new ke({appId:"JS SDK integration tests",project:{NODE_ENV:"production",PUBLIC_URL:"https://cdn.cogniteapp.com/cdf-datastudio/v.670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SENTRY_DSN:"https://d09f6d3557114e6cbaa63b56d7ef86cc@o124058.ingest.sentry.io/1288725",REACT_APP_APP_ID:"cdf-datastudio",REACT_APP_LOCIZE_PROJECT_ID:"0774e318-387b-4e68-94cc-7b270321bbf1",REACT_APP_VERSION_NAME:"1.2.28",REACT_APP_VERSION_SHA:"670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",REACT_APP_RELEASE_ID:"cdf-datastudio-1.2.28-670ad52"}.COGNITE_PROJECT,apiKeyMode:!0,getToken:function(){return Promise.resolve({NODE_ENV:"production",PUBLIC_URL:"https://cdn.cogniteapp.com/cdf-datastudio/v.670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SENTRY_DSN:"https://d09f6d3557114e6cbaa63b56d7ef86cc@o124058.ingest.sentry.io/1288725",REACT_APP_APP_ID:"cdf-datastudio",REACT_APP_LOCIZE_PROJECT_ID:"0774e318-387b-4e68-94cc-7b270321bbf1",REACT_APP_VERSION_NAME:"1.2.28",REACT_APP_VERSION_SHA:"670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",REACT_APP_RELEASE_ID:"cdf-datastudio-1.2.28-670ad52"}.COGNITE_CREDENTIALS)},baseUrl:e})}var Re=function(e,t){return e-t},Ne=Object.freeze({__proto__:null,apiKey:"TEST_KEY",project:Ae,projectId:123,user:Pe,loggedInResponse:Ce,notLoggedInResponse:{data:{loggedIn:!1,user:"",project:""}},mockBaseUrl:Oe,authTokens:{accessToken:"abc",idToken:"def"},setupClient:Ie,setupLoggedInClient:function(){return jest.setTimeout(6e4),Ie()},setupMockableClient:function(){return Ie(Oe)},retryInSeconds:function(e,t,n,r){return void 0===t&&(t=3),void 0===n&&(n=404),void 0===r&&(r=300),O(this,void 0,void 0,(function(){var i,o;return I(this,(function(a){switch(a.label){case 0:i=Date.now(),a.label=1;case 1:if(!(Date.now()-i<1e3*r))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,e()];case 3:return[2,a.sent()];case 4:if(o=a.sent(),Number(o.status)!==n)throw o;return[4,H(1e3*t)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:throw new Error("Time limit has been exceeded")}}))}))},runTestWithRetryWhenFailing:function(e){return O(this,void 0,void 0,(function(){var t,n,r,i,o,a;return I(this,(function(s){switch(s.label){case 0:jest.setTimeout(18e4),t=15,n=2,r=500,i=0,s.label=1;case 1:return s.trys.push([1,3,,5]),[4,e()];case 2:return s.sent(),[2];case 3:return a=s.sent(),o=a,[4,H(r)];case 4:return s.sent(),r*=n,i++,[3,5];case 5:if(i<t)return[3,1];s.label=6;case 6:throw o}}))}))},simpleCompare:Re,getSortedPropInArray:function(e,t){return e.map((function(e){return e[t]})).sort(Re)},string2arrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return t},randomInt:function(){return Math.floor(1e10*Math.random())}}),De={clientId:"client_id",scope:"scope",redirectUri:"redirect_uri",responseMode:"response_mode",responseType:"response_type",resource:"resource"},Le=function(){function e(e){var t=e.authority,n=e.requestParams;this.token=null,this.authority=t,this.queryParams=this.getADFSQueryParams(n)}return e.prototype.login=function(){return O(this,void 0,void 0,(function(){var e,t=this;return I(this,(function(n){switch(n.label){case 0:return[4,this.acquireTokenSilently()];case 1:return e=n.sent(),[2,new Promise((function(n){e&&n(e.accessToken);var r=t.authority+"?"+t.getADFSQueryParamString(t.queryParams);window.location.href=r}))]}}))}))},e.prototype.handleLoginRedirect=function(){try{var e=window.location.hash;if(!e)return null;var t=Be(e);return G("access_token","id_token","expires_in","scope","token_type"),this.token=t,t}catch(e){console.error(e)}return null},e.prototype.getCDFToken=function(){return O(this,void 0,void 0,(function(){var e;return I(this,(function(t){switch(t.label){case 0:return[4,this.acquireTokenSilently()];case 1:return[2,(e=t.sent())?e.accessToken:this.token?this.token.accessToken:null]}}))}))},e.prototype.getIdToken=function(){return O(this,void 0,void 0,(function(){var e;return I(this,(function(t){switch(t.label){case 0:return[4,this.acquireTokenSilently()];case 1:return[2,(e=t.sent())?e.idToken:this.token?this.token.idToken:null]}}))}))},e.prototype.acquireTokenSilently=function(){return O(this,void 0,void 0,(function(){var e,t;return I(this,(function(n){switch(n.label){case 0:e=this.authority+"?prompt=none&"+this.getADFSQueryParamString(this.queryParams),t=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,pe(e,Be,"adfsSilentLoginIframe")];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),y(),[3,4];case 4:return t&&(this.token=t),[2,t]}}))}))},e.prototype.getADFSQueryParams=function(e){var t=e.resource,n={clientId:e.clientId,scope:"user_impersonation IDENTITY",responseMode:"fragment",responseType:"id_token token",resource:t,redirectUri:window.location.href};return Object.entries(n).reduce((function(e,t){var n=R(t,2),r=n[0],i=n[1];return e[De[r]]=i,e}),{})},e.prototype.getADFSQueryParamString=function(e){return Object.entries(e).reduce((function(e,t){var n=R(t,2),r=n[0],i=n[1];return e+(e.length>1?"&":"")+r+"="+i}),"")},e}();function Be(e){var t=h.parse(e),n=t.access_token,r=t.id_token,i=t.expires_in;return o(n)&&o(r)?{accessToken:n,idToken:r,expiresIn:Date.now()+Number(i)}:null}t.ADFS=Le,t.BaseCogniteClient=ke,t.BaseResourceAPI=$,t.BasicHttpClient=te,t.CDFHttpClient=ie,t.CogniteAuthentication=be,t.CogniteError=D,t.CogniteLoginError=oe,t.CogniteMultiError=B,t.Constants=T,t.DateParser=Q,t.GraphUtils=k,t.HttpError=ee,t.HttpResponseType=ne,t.MetadataMap=Ee,t.POPUP=ye,t.REDIRECT="REDIRECT",t.RetryableHttpClient=re,t.RevertableArraySorter=function(e){var t=this;this.sortFunction=e,this.originalIndexMap=new Map,this.sort=function(e){return t.originalIndexMap=new Map,t.originalArray=e,e.forEach((function(e,n){t.originalIndexMap.set(e,n)})),t.sortedArray=t.sortFunction(e),t.sortedArray},this.unsort=function(e){if(!t.originalArray||!t.sortedArray)throw Error("Impossible to unsort. Call sort(...) first.");if(e.length!==t.originalArray.length)throw Error("Impossible to unsort. Input array has a different length from original.");var n=[];return t.sortedArray.forEach((function(r,i){var o=t.originalIndexMap.get(r);n[o]=e[i]})),n}},t.TestUtils=Ne,t.accessApi=function(e){if(void 0===e)throw Error("API not found");return e},t.apiUrl=j,t.createRetryValidator=function(e,t){void 0===t&&(t=5);var n=ve(t);return function(r,i,o){if(o>=t)return!1;if(!me(i.status))return!1;if(n(r,i,o))return!0;var a=e[r.method]||[];return!!function(e,t){return m(t,(function(t){return function(e,t){return-1!==e.toUpperCase().indexOf(t.toUpperCase())}(e,t)}))}(r.path,a)}},t.createUniversalRetryValidator=ve,t.getIdInfo=ge,t.getLogoutUrl=le,t.isLoginPopupWindow=ce,t.loginPopupHandler=function(){if(ce())try{var e=de(window.location.search);window.opener.postMessage(e)}catch(e){window.opener.postMessage({error:e.message})}finally{window.close()}},t.promiseAllAtOnce=Z,t.promiseAllWithData=q,t.promiseEachInSequence=Y,t.sleepPromise=H},72082:function(e,t,n){"use strict";var r=n(89848),i=n(98583),o=n(11517);function a(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function s(e){return Array.isArray(e)?e.sort():"object"==typeof e?s(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function u(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function c(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=i({arrayFormat:"none"},t)),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),a=t.length>0?t.join("="):void 0;a=void 0===a?null:o(a),n(o(i),a,r)})),Object.keys(r).sort().reduce((function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=s(n):e[t]=n,e}),Object.create(null))):r}t.extract=u,t.parse=c,t.stringify=function(e,t){!1===(t=i({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[a(t,e),"[",r,"]"].join(""):[a(t,e),"[",a(r,e),"]=",a(n,e)].join("")};case"bracket":return function(t,n){return null===n?a(t,e):[a(t,e),"[]=",a(n,e)].join("")};default:return function(t,n){return null===n?a(t,e):[a(t,e),"=",a(n,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(r){var i=e[r];if(void 0===i)return"";if(null===i)return a(r,t);if(Array.isArray(i)){var o=[];return i.slice().forEach((function(e){void 0!==e&&o.push(n(r,e,o.length))})),o.join("&")}return a(r,t)+"="+a(i,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:c(u(e),t)}}},89848:function(e){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},60623:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchApi=t.listApi=t.aggregateApi=t.post=void 0,t.post=function(e,t,n){return e.post("/api/v1/projects/".concat(e.project).concat(t),{data:n}).then((function(e){return e.data}))},t.aggregateApi=function(e,n,r){return t.post(e,"/".concat(n,"/aggregate"),{filter:r}).then((function(e){return(null==e?void 0:e.items[0])||{count:0}}))},t.listApi=function(e,n,r){return t.post(e,"/".concat(n,"/list"),r).then((function(e){return null==e?void 0:e.items}))};var n=function(e,t){switch(e){case"files":return{name:t};case"events":return{description:t};default:return{query:t}}};t.searchApi=function(e,r,i,o){return t.post(e,"/".concat(r,"/search"),Object.assign(Object.assign({},o),{search:n(r,i)})).then((function(e){return null==e?void 0:e.items}))}},58096:function(e,t,n){"use strict";var r=n(319).default,i=n(87757),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useCapabilities=t.useGroup=t.usePermissions=t.useInfiniteList=t.useInfiniteSearch=t.useSearch=t.useList=t.useCdfItems=t.useCdfItem=t.useAggregate=t.listApi=t.aggregate=void 0;var u=n(45571),c=s(n(46813)),l=n(71908),d=n(31308),f=n(60623);t.aggregate=f.aggregateApi,t.listApi=f.listApi,t.useAggregate=function(e,t,n){var r=l.useSDK();return u.useQuery(d.aggregateKey(e,t),(function(){return f.aggregateApi(r,e,t)}),n)},t.useCdfItem=function(e,t,n){var r=l.useSDK(),i=[t];return u.useQuery(d.byIdKey(e,t),(function(){return f.post(r,"/".concat(e,"/byids"),{items:i}).then((function(e){return null==e?void 0:e.items[0]}))}),n)},t.useCdfItems=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=l.useSDK(),o=t.filter((function(e){return!!e.id||!!e.externalId})).sort((function(e,t){return"".concat(null==e?void 0:e.id).concat(null==e?void 0:e.externalId).localeCompare("".concat(null==t?void 0:t.id).concat(null==t?void 0:t.externalId))}));return u.useQuery(d.retrieveItemsKey(e,o),(function(){return o.length>0?f.post(i,"/".concat(e,"/byids"),{items:o,ignoreUnknownIds:n}).then((function(e){return null==e?void 0:e.items})):[]}),r)},t.useList=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=l.useSDK(),o=r?t:p(t);return u.useQuery(d.listKey(e,o),(function(){return f.listApi(i,e,o)}),n)},t.useSearch=function(e,t,n,r){var i=l.useSDK(),o=p(n);return u.useQuery(d.searchCacheKey(e,t,o),(function(){return f.searchApi(i,e,t,o)}),r)},t.useInfiniteSearch=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,s=l.useSDK();return u.useInfiniteQuery(d.infiniteSearchCacheKey(e,t,r),(function(a){var u=a.pageParam;return o(void 0,void 0,void 0,i.mark((function o(){var a,c,l;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=u?n+u:n,c=r?{filter:r,limit:a}:{limit:a},i.next=4,f.searchApi(s,e,t,c);case 4:if(l=i.sent,!u){i.next=7;break}return i.abrupt("return",l.slice(u,u+n));case 7:return i.abrupt("return",l);case 8:case"end":return i.stop()}}),o)})))}),Object.assign({getNextPageParam:function(e,t){var r=t.reduce((function(e,t){return e+t.length}),0);if(e.length===n)return r}},a))},t.useInfiniteList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=l.useSDK();return u.useInfiniteQuery(d.infiniteListCacheKey(e,n),(function(r){var o=r.pageParam;return f.post(i,"/".concat(e,"/list"),p({limit:t,filter:n,cursor:o}))}),Object.assign({getNextPageParam:function(e){return null==e?void 0:e.nextCursor}},r))};var p=function(e){var t=Object.assign({},e);return t.filter&&"object"==typeof t.filter&&0===Object.keys(t.filter).length&&delete t.filter,0===Object.keys(t).length&&(t=void 0),t};t.usePermissions=function(e,n,r,i,o){var s,u=t.useCapabilities(e,o),l=u.data,d=a(u,["data"]),f=null!==(s=null==l?void 0:l.filter((function(e){return e.acl===n&&(!i||c.default(e.scope,i))})))&&void 0!==s?s:[];return Object.assign(Object.assign({},d),{data:!!f.length&&(!r||f.some((function(e){return e.actions.some((function(e){return e.toLowerCase()===r.toLowerCase()}))})))})},t.useGroup=function(e,t){var n=l.useSDK(),r=u.useQuery(d.listGroupsKey({all:!0}),(function(){return n.groups.list({all:!0})}),t);return Object.assign(Object.assign({},r),{data:(r.data||[]).find((function(t){return t.name===e}))})},t.useCapabilities=function(e,t){var n=l.useSDK(),a="COGNITE_AUTH"!==e&&"UNKNOWN"!==e;return u.useQuery(d.capabilitiesKey(),(function(){return a?function(e){return o(void 0,void 0,void 0,i.mark((function t(){var n,r,o;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("/api/v1/token/inspect");case 2:return n=t.sent,r=n.data,o=r.capabilities||[],t.abrupt("return",o.map((function(e){var t=Object.keys(e).filter((function(e){return e.includes("Acl")}))[0];return{acl:t,actions:e[t].actions,scope:e[t].scope}})));case 6:case"end":return t.stop()}}),t)})))}(n):function(e){return o(void 0,void 0,void 0,i.mark((function t(){var n,o;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.groups.list();case 2:return n=t.sent,o=[],n.forEach((function(e){var t;null===(t=e.capabilities)||void 0===t||t.forEach((function(e){var t=Object.keys(e).filter((function(e){return e.includes("Acl")}))[0],n=e[t],r=n.actions,i=n.scope,a=o.find((function(e){return e.acl===t&&c.default(i,e.scope)}));a?a.actions=a.actions.concat(r):o.push({acl:t,actions:r,scope:i})}))})),t.abrupt("return",o.map((function(e){return Object.assign(Object.assign({},e),{actions:r(new Set(e.actions))})})));case 6:case"end":return t.stop()}}),t)})))}(n)}),t)}},74672:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(58096),t),i(n(31308),t)},31308:function(e,t,n){"use strict";var r=n(319).default;Object.defineProperty(t,"__esModule",{value:!0}),t.listGroupsKey=t.infiniteSearchCacheKey=t.searchCacheKey=t.retrieveItemsKey=t.listKey=t.infiniteListCacheKey=t.byIdKey=t.infiniteBaseListCacheKey=t.infiniteBaseSearchCacheKey=t.listBaseCacheKey=t.searchBaseCacheKey=t.aggregateKey=t.capabilitiesKey=t.baseCacheKey=void 0;var i="sdk-react-query-hooks";t.baseCacheKey=function(e){return[i,"cdf",e]},t.capabilitiesKey=function(){return[i,"capabilities"]},t.aggregateKey=function(e,n){return[].concat(r(t.baseCacheKey(e)),["aggregate",n])},t.searchBaseCacheKey=function(e){return[].concat(r(t.baseCacheKey(e)),["search"])},t.listBaseCacheKey=function(e){return[].concat(r(t.baseCacheKey(e)),["list"])},t.infiniteBaseSearchCacheKey=function(e){return[].concat(r(t.searchBaseCacheKey(e)),["infinite"])},t.infiniteBaseListCacheKey=function(e){return[].concat(r(t.listBaseCacheKey(e)),["infinite"])},t.byIdKey=function(e,n){return[].concat(r(t.baseCacheKey(e)),["get","byId",n])},t.infiniteListCacheKey=function(e,n){return[].concat(r(t.infiniteBaseListCacheKey(e)),[{filter:n}])},t.listKey=function(e,n){return[].concat(r(t.listBaseCacheKey(e)),[n])},t.retrieveItemsKey=function(e,n){return[].concat(r(t.baseCacheKey(e)),["get","byIds",n])},t.searchCacheKey=function(e,n,i){return[].concat(r(t.searchBaseCacheKey(e)),[n,i]).filter((function(e){return void 0!==e}))},t.infiniteSearchCacheKey=function(e,n,i){return[].concat(r(t.infiniteBaseSearchCacheKey(e)),[{query:n},{filter:i}])},t.listGroupsKey=function(e){return[].concat(r(t.baseCacheKey("groups")),[e])}},27364:function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16529),o=r(n(96918)),a=r(n(1938)),s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},s(e,t)};function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)};function l(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function d(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function f(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.list=function(n,r,i){var o=t.encodeUrl(n,r);return e.prototype.listEndpoint.call(t,(function(e){return t.get(o,{params:e})}),i)},t.filter=function(n,r,i){var o=t.encodeUrl(n,r)+"/list";return e.prototype.listEndpoint.call(t,(function(e){return t.post(o,{data:e})}),i)},t.create=function(n,r,i){var o=t.encodeUrl(n,r);return e.prototype.createEndpoint.call(t,i,o)},t.delete=function(n,r,i){var o=t.encodeUrl(n,r)+"/delete";return e.prototype.deleteEndpoint.call(t,i,void 0,o)},t}return u(t,e),t.prototype.encodeUrl=function(e,t){return this.url(e+"/revisions/"+t+"/mappings")},t}(i.BaseResourceAPI),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url(""+e),[4,this.get(t,{responseType:i.HttpResponseType.ArrayBuffer})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}return u(t,e),t}(i.BaseResourceAPI),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(n){return e.prototype.createEndpoint.call(t,n)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithGet,n)},t.retrieve=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url(""+e),[4,this.get(t)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.update=function(n){return e.prototype.updateEndpoint.call(t,n)},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(i.BaseResourceAPI),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(n,r,i){var o=t.url(n+"/revisions/"+r+"/nodes/byids");return e.prototype.retrieveEndpoint.call(t,i,{},o)},t}return u(t,e),t.prototype.list=function(t,n,r){var i=this,o=this.url(t+"/revisions/"+n+"/nodes");return e.prototype.listEndpoint.call(this,(function(e){return i.get(o,{params:e})}),r)},t.prototype.filter=function(t,n,r){var i=this,o=this.url(t+"/revisions/"+n+"/nodes/list");return e.prototype.listEndpoint.call(this,(function(e){return i.post(o,{data:e})}),r)},t.prototype.listAncestors=function(t,n,r,i){var o=this,a=this.url(t+"/revisions/"+n+"/nodes/"+r+"/ancestors");return e.prototype.listEndpoint.call(this,(function(e){return o.get(a,{params:e})}),i)},t}(i.BaseResourceAPI),b=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.create=function(t,n){return e.prototype.createEndpoint.call(i,n,i.url(t+"/revisions"))},i.list=function(t,n){var r=i.url(t+"/revisions");return e.prototype.listEndpoint.call(i,(function(e){return i.get(r,{params:e})}),n)},i.retrieve=function(e,t){return d(i,void 0,void 0,(function(){var n,r;return f(this,(function(i){switch(i.label){case 0:return n=this.url(e+"/revisions/"+t),[4,this.get(n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},i.update=function(t,n){var r=i.url(t+"/revisions/update");return e.prototype.updateEndpoint.call(i,n,r)},i.delete=function(t,n){var r=i.url(t+"/revisions/delete");return e.prototype.deleteEndpoint.call(i,n,void 0,r)},i.updateThumbnail=function(e,t,n){return d(i,void 0,void 0,(function(){var r,i;return f(this,(function(o){switch(o.label){case 0:return r=this.url(e+"/revisions/"+t+"/thumbnail"),[4,this.post(r,{data:{fileId:n}})];case 1:return i=o.sent(),[2,this.addToMapAndReturn({},i)]}}))}))},i.list3DNodes=function(e,t,n){return i.nodes3DApi.list(e,t,n)},i.filter3DNodes=function(e,t,n){return i.nodes3DApi.filter(e,t,n)},i.retrieve3DNodes=function(e,t,n){return i.nodes3DApi.retrieve(e,t,n)},i.list3DNodeAncestors=function(e,t,n,r){return i.nodes3DApi.listAncestors(e,t,n,r)},i.nodes3DApi=new g(t,n,r),i}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(i.BaseResourceAPI),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.list=function(t,n,r){var i=this,o=this.encodeUrl(t,n);return e.prototype.listEndpoint.call(this,(function(e){return i.get(o,{params:e})}),r)},t.prototype.listAncestors=function(t,n,r,i){var o=this,a=this.encodeUrl(t,n)+"/"+r+"/ancestors";return e.prototype.listEndpoint.call(this,(function(e){return o.get(a,{params:e})}),i)},t.prototype.encodeUrl=function(e,t){return this.url("models/"+e+"/revisions/"+t+"/nodes")},t}(i.BaseResourceAPI),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t.prototype.retrieve=function(e,t){return d(this,void 0,void 0,(function(){var n,r;return f(this,(function(i){switch(i.label){case 0:return n=this.url("models/"+e+"/revisions/"+t),[4,this.get(n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}(i.BaseResourceAPI),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.list=function(t,n,r){var i=this,o=this.url("models/"+t+"/revisions/"+n+"/sectors");return e.prototype.listEndpoint.call(this,(function(e){return i.get(o,{params:e})}),r)},t}(i.BaseResourceAPI),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t.prototype.retrieve=function(e,t){return d(this,void 0,void 0,(function(){var n,r;return f(this,(function(i){switch(i.label){case 0:return n=this.url("models/"+e+"/revisions/"+t),[4,this.get(n)];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}(i.BaseResourceAPI),S=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;i.retrieveRevealRevision3D=function(e,t){return i.revealRevisions3DAPI.retrieve(e,t)},i.listRevealNodes3D=function(e,t,n){return i.revealNodes3DAPI.list(e,t,n)},i.listRevealNode3DAncestors=function(e,t,n,r){return i.revealNodes3DAPI.listAncestors(e,t,n,r)},i.listRevealSectors3D=function(e,t,n){return i.revealSectors3DAPI.list(e,t,n)},i.retrieveUnrealRevision3D=function(e,t){return i.unrealRevisions3DAPI.retrieve(e,t)};var o=t+"/reveal",a=t+"/unreal";return i.revealRevisions3DAPI=new _(o,n,r),i.revealNodes3DAPI=new x(o,n,r),i.revealSectors3DAPI=new w(o,n,r),i.unrealRevisions3DAPI=new M(a,n,r),i}return u(t,e),t}(i.BaseResourceAPI),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.get(t,{params:e})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(i.BaseResourceAPI);function E(e){var t=function(e){var t=new Map,n=e.map((function(e){return{data:e}}));return n.forEach((function(e){var n=e.data.externalId;n&&t.set(n,e)})),n.forEach((function(e){var n=e.data.parentExternalId;n&&t.has(n)&&(e.parentNode=t.get(n))})),n}(e);return i.GraphUtils.topologicalSort(t).map((function(e){return e.data}))}var k,A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(n){var r=new i.RevertableArraySorter(E),o=r.sort,a=r.unsort;return e.prototype.createEndpoint.call(t,n,void 0,o,a)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.aggregate=function(n){return e.prototype.aggregateEndpoint.call(t,n)},t.retrieve=function(n,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(t,n,r)},t.update=function(n){return e.prototype.updateEndpoint.call(t,n)},t.search=function(n){return e.prototype.searchEndpoint.call(t,n)},t.delete=function(n,r){void 0===r&&(r={});var i=c(c({},r),{ignoreUnknownIds:!0});return e.prototype.deleteEndpoint.call(t,n,i)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(i.BaseResourceAPI),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.insert=function(e){return t.insertEndpoint(e)},t.retrieve=function(e){return t.retrieveDatapointsEndpoint(e)},t.retrieveLatest=function(e,n){return void 0===n&&(n={}),t.retrieveLatestEndpoint(e,n)},t.delete=function(e){return t.deleteDatapointsEndpoint(e)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","datapoints"],["timestamp"])},t.prototype.insertEndpoint=function(e){return d(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.postInParallelWithAutomaticChunking({path:t,items:e})];case 1:return n.sent(),[2,{}]}}))}))},t.prototype.retrieveDatapointsEndpoint=function(e){return d(this,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.listPostUrl,[4,this.post(t,{data:e})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t.prototype.retrieveLatestEndpoint=function(e,t){return d(this,void 0,void 0,(function(){var n,r;return f(this,(function(i){switch(i.label){case 0:return n=this.url("latest"),[4,this.post(n,{data:c({items:e},t)})];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.prototype.deleteDatapointsEndpoint=function(e){return d(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.postInParallelWithAutomaticChunking({chunkSize:1e4,items:e,path:this.deleteUrl})];case 1:return t.sent(),[2,{}]}}))}))},t}(i.BaseResourceAPI),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(n){return e.prototype.createEndpoint.call(t,n)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.aggregate=function(n){return e.prototype.aggregateEndpoint.call(t,n)},t.retrieve=function(n){return e.prototype.retrieveEndpoint.call(t,n)},t.update=function(n){return e.prototype.updateEndpoint.call(t,n)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(i.BaseResourceAPI),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.documentAsPdf=function(e){return t.pdfPreviewEndpoint(e)},t.documentAsImage=function(e,n){return t.imagePreviewEndpoint(e,n)},t.pdfTemporaryLink=function(e){return t.pdfTemporaryLinkEndpoint(e)},t.pdfBuildPreviewURI=function(e){return""+t.url()+e.toString()+"/preview/pdf"},t.imageBuildPreviewURI=function(e,n){return void 0===n&&(n=1),""+t.url()+e.toString()+"/preview/image/pages/"+n.toString()},t.pdfBuildTemporaryLinkURI=function(e){return""+t.url()+e.toString()+"/preview/pdf/temporarylink"},t}return u(t,e),t.prototype.pdfPreviewEndpoint=function(e){return d(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return t=this.pdfBuildPreviewURI(e),[4,this.get(t,{responseType:i.HttpResponseType.ArrayBuffer,headers:{Accept:"application/pdf"}})];case 1:return[2,n.sent().data]}}))}))},t.prototype.imagePreviewEndpoint=function(e,t){return void 0===t&&(t=1),d(this,void 0,void 0,(function(){var n;return f(this,(function(r){switch(r.label){case 0:return n=this.imageBuildPreviewURI(e,t),[4,this.get(n,{responseType:i.HttpResponseType.ArrayBuffer,headers:{Accept:"image/png"}})];case 1:return[2,r.sent().data]}}))}))},t.prototype.pdfTemporaryLinkEndpoint=function(e){return d(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return t=this.pdfBuildTemporaryLinkURI(e),[4,this.get(t)];case 1:return[2,n.sent().data]}}))}))},t}(i.BaseResourceAPI),I=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,h(t))||this;r.search=function(e){return r.searchDocuments(e)};var i=p(t,3),o=i[0],a=i[1],s=i[2];return r.previewAPI=new O(o,a,s),r}return u(t,e),Object.defineProperty(t.prototype,"preview",{get:function(){return this.previewAPI},enumerable:!1,configurable:!0}),t.prototype.searchDocuments=function(e){return d(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return[4,this.post(this.searchUrl,{data:e})];case 1:return t=n.sent(),[2,this.addToMapAndReturn(t.data,t)]}}))}))},t}(i.BaseResourceAPI),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.post(t,{data:e})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.retrieve=function(n){return e.prototype.retrieveEndpoint.call(t,n)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.update=function(n){return e.prototype.updateEndpoint.call(t,n)},t.delete=function(n){return d(t,void 0,void 0,(function(){return f(this,(function(t){return[2,e.prototype.deleteEndpoint.call(this,n)]}))}))},t.predict=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url("predict"),[4,this.post(t,{data:e})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.predictResult=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url("jobs/"+e),[4,this.get(t)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.refit=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url("refit"),[4,this.post(t,{data:e})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","startTime","statusTime"])},t}(i.BaseResourceAPI),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=function(n){return e.prototype.aggregateEndpoint.call(t,n)},t.uniqueValues=function(n){return e.prototype.aggregateEndpoint.call(t,c(c({},n),{aggregate:"uniqueValues"}))},t}return u(t,e),t}(i.BaseResourceAPI),D=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,h(t))||this;return r.create=function(t){return e.prototype.createEndpoint.call(r,t)},r.list=function(t){var n=t||{},i=n.sort,o=void 0===i?{}:i,a=l(n,["sort"]),s=c({sort:r.convertSortObjectToArray(o)},a);return e.prototype.listEndpoint.call(r,r.callListEndpointWithPost,s)},r.retrieve=function(t,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(r,t,n)},r.update=function(t){return e.prototype.updateEndpoint.call(r,t)},r.search=function(t){return e.prototype.searchEndpoint.call(r,t)},r.delete=function(t){return e.prototype.deleteEndpoint.call(r,t)},r.aggregateAPI=new(N.bind.apply(N,h([void 0],t))),r}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},Object.defineProperty(t.prototype,"aggregate",{get:function(){return this.aggregateAPI},enumerable:!1,configurable:!0}),t.prototype.convertSortObjectToArray=function(e){return Object.entries(e).map((function(e){var t=p(e,2);return t[0]+":"+t[1]}))},t}(i.BaseResourceAPI),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upload=function(e,n,r,i){return void 0===r&&(r=!1),void 0===i&&(i=!1),t.uploadEndpoint(e,n,r,i)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.aggregate=function(n){return e.prototype.aggregateEndpoint.call(t,n)},t.retrieve=function(n,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(t,n,r)},t.update=function(n){return e.prototype.updateEndpoint.call(t,n)},t.search=function(n){return e.prototype.searchEndpoint.call(t,n)},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t.getDownloadUrls=function(e){return t.getDownloadUrlsEndpoint(e)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime","sourceCreatedTime","sourceModifiedTime","uploadedTime"])},t.prototype.uploadEndpoint=function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),d(this,void 0,void 0,(function(){var i,o,a,s,u;return f(this,(function(c){switch(c.label){case 0:if(null==t&&r)throw Error("Don't set waitUntilAcknowledged to true when you are not uploading a file");return i={overwrite:n},o=this.url(),[4,this.post(o,{params:i,data:e})];case 1:return a=c.sent(),s=a.data,null==t?[3,3]:[4,this.uploadFile(s.uploadUrl,t,e.mimeType)];case 2:c.sent(),c.label=3;case 3:return r?[4,this.waitUntilFileIsUploaded(s.id)]:[3,5];case 4:return u=c.sent(),[2,this.addToMapAndReturn(u,a)];case 5:return[2,this.addToMapAndReturn(s,a)]}}))}))},t.prototype.uploadFile=function(e,t,n){var r={"Content-Type":n||"application/octet-stream"};return this.put(e,{headers:r,data:t})},t.prototype.waitUntilFileIsUploaded=function(e){return d(this,void 0,void 0,(function(){var t,n,r,o,a;return f(this,(function(s){switch(s.label){case 0:t=10,n=500,r=0,s.label=1;case 1:return[4,this.retrieve([{id:e}])];case 2:return o=p.apply(void 0,[s.sent(),1]),(a=o[0]).uploaded?[2,a]:(r++,[4,i.sleepPromise(n)]);case 3:s.sent(),s.label=4;case 4:if(r<t)return[3,1];s.label=5;case 5:throw Error("File never marked as 'uploaded'")}}))}))},t.prototype.getDownloadUrlsEndpoint=function(e){return d(this,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url("downloadlink"),[4,this.post(t,{data:{items:e}})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t}(i.BaseResourceAPI),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.get(t,{params:e})];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t.listServiceAccounts=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.encodeServiceAccountUrl(e),[4,this.get(t)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t.addServiceAccounts=function(e,n){return d(t,void 0,void 0,(function(){var t,r;return f(this,(function(i){switch(i.label){case 0:return t=this.encodeServiceAccountUrl(e),[4,this.post(t,{data:{items:n}})];case 1:return r=i.sent(),[2,this.addToMapAndReturn({},r)]}}))}))},t.removeServiceAccounts=function(e,n){return d(t,void 0,void 0,(function(){var t,r;return f(this,(function(i){switch(i.label){case 0:return t=this.encodeServiceAccountUrl(e)+"/remove",[4,this.post(t,{data:{items:n}})];case 1:return r=i.sent(),[2,this.addToMapAndReturn({},r)]}}))}))},t.encodeServiceAccountUrl=function(e){return t.url(e+"/serviceaccounts")},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["deletedTime"])},t}(i.BaseResourceAPI),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(n){return e.prototype.createEndpoint.call(t,n)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(i.BaseResourceAPI),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(e){return d(t,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:return t=this.encodeUrl(e),[4,this.get(t)];case 1:return n=r.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.update=function(e,n){return d(t,void 0,void 0,(function(){var t,r;return f(this,(function(i){switch(i.label){case 0:return t=this.encodeUrl(e),[4,this.put(t,{data:n})];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.updateProject=function(e,n){return d(t,void 0,void 0,(function(){var t,r;return f(this,(function(i){switch(i.label){case 0:return t=this.encodeUrl(e)+"/update",[4,this.post(t,{data:n})];case 1:return r=i.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}return u(t,e),t.prototype.encodeUrl=function(e){return this.url("projects/"+encodeURIComponent(e))},t}(i.BaseResourceAPI),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["lastUpdatedTime"])},t.prototype.insert=function(e,t,n,r){return void 0===r&&(r=!1),d(this,void 0,void 0,(function(){var i;return f(this,(function(o){switch(o.label){case 0:return i=this.encodeUrl(e,t)+"/rows",[4,this.postInParallelWithAutomaticChunking({path:i,items:n,chunkSize:1e4,queryParams:{ensureParent:r}})];case 1:return o.sent(),[2,{}]}}))}))},t.prototype.list=function(t,n,r){var i=this;void 0===r&&(r={});var o=r.onlyRowKeys,a=r.columns,s=l(r,["onlyRowKeys","columns"]);o&&(s.columns=","),a&&(s.columns=a.join(","));var u=this.encodeUrl(t,n)+"/rows";return e.prototype.listEndpoint.call(this,(function(e){return d(i,void 0,void 0,(function(){return f(this,(function(t){return[2,this.get(u,{params:e})]}))}))}),s)},t.prototype.retrieve=function(e,t,n){return d(this,void 0,void 0,(function(){var r,i;return f(this,(function(o){switch(o.label){case 0:return r=this.encodeUrl(e,t)+"/rows/"+encodeURIComponent(n),[4,this.get(r)];case 1:return i=o.sent(),[2,this.addToMapAndReturn(i.data,i)]}}))}))},t.prototype.delete=function(e,t,n){return d(this,void 0,void 0,(function(){var r;return f(this,(function(i){switch(i.label){case 0:return r=this.encodeUrl(e,t)+"/rows/delete",[4,this.postInParallelWithAutomaticChunking({path:r,items:n})];case 1:return i.sent(),[2,{}]}}))}))},t.prototype.encodeUrl=function(e,t){return this.url(encodeURIComponent(e)+"/tables/"+encodeURIComponent(t))},t}(i.BaseResourceAPI),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.create=function(e,t,n){return void 0===n&&(n=!1),d(this,void 0,void 0,(function(){var r,i;return f(this,(function(o){switch(o.label){case 0:return r=this.encodeUrl(e)+"/tables",[4,this.postInParallelWithAutomaticChunking({queryParams:{ensureParent:n},items:t,path:r})];case 1:return i=o.sent(),[2,this.mergeItemsFromItemsResponse(i)]}}))}))},t.prototype.list=function(t,n){var r=this,i=this.encodeUrl(t)+"/tables";return e.prototype.listEndpoint.call(this,(function(e){return d(r,void 0,void 0,(function(){return f(this,(function(t){return[2,this.get(i,{params:e})]}))}))}),n)},t.prototype.delete=function(e,t){var n=this.encodeUrl(e)+"/tables/delete";return this.deleteEndpoint(t,{},n)},t.prototype.encodeUrl=function(e){return this.url(""+encodeURIComponent(e))},t}(i.BaseResourceAPI),G=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.createDatabases=function(t){return e.prototype.createEndpoint.call(i,t)},i.listDatabases=function(t){return e.prototype.listEndpoint.call(i,i.callListEndpointWithGet,t)},i.deleteDatabases=function(t,n){return e.prototype.deleteEndpoint.call(i,t,n)},i.createTables=function(e,t,n){return void 0===n&&(n=!1),i.rawTablesApi.create(e,t,n)},i.listTables=function(e,t){return i.rawTablesApi.list(e,t)},i.deleteTables=function(e,t){return i.rawTablesApi.delete(e,t)},i.insertRows=function(e,t,n,r){return void 0===r&&(r=!1),i.rawRowsApi.insert(e,t,n,r)},i.listRows=function(e,t,n){return i.rawRowsApi.list(e,t,n)},i.retrieveRow=function(e,t,n){return i.rawRowsApi.retrieve(e,t,n)},i.deleteRows=function(e,t,n){return i.rawRowsApi.delete(e,t,n)},i.rawTablesApi=new U(t,n,r),i.rawRowsApi=new z(t,n,r),i}return u(t,e),t}(i.BaseResourceAPI),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.retrieve=function(n,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(t,n,r)},t.delete=function(n,r){return void 0===r&&(r={}),e.prototype.deleteEndpoint.call(t,n,r)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(i.BaseResourceAPI),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithGet,n)},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t}return u(t,e),t}(i.BaseResourceAPI),H=function(e){function t(t,n,r){var i=e.apply(this,h(n))||this;return i.rowNumber=t,i.columns=r,i}return u(t,e),t}(Array),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.insert=function(e){return d(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.postInParallelWithAutomaticChunking({path:this.url(),items:e,chunkSize:1e4})];case 1:return t.sent(),[2,{}]}}))}))},t.prototype.retrieve=function(t){var n=this;return e.prototype.listEndpoint.call(this,(function(e){return n.post(n.listPostUrl,{data:e}).then(n.transformRetrieveResponse)}),t)},t.prototype.delete=function(e){return this.deleteEndpoint(e)},t.prototype.transformRetrieveResponse=function(e){var t=e.data,n=t.rows,r=t.nextCursor,i=t.columns,o=n.map((function(e){var t=e.rowNumber,n=e.values;return new H(t,n,i)}));return c(c({},e),{data:{items:o,nextCursor:r}})},t}(i.BaseResourceAPI),q=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.create=function(t){return e.prototype.createEndpoint.call(i,t)},i.list=function(t){return e.prototype.listEndpoint.call(i,i.callListEndpointWithPost,t)},i.aggregate=function(t){return e.prototype.aggregateEndpoint.call(i,t)},i.retrieve=function(t,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(i,t,n)},i.update=function(t){return e.prototype.updateEndpoint.call(i,t)},i.search=function(t){return e.prototype.searchEndpoint.call(i,t)},i.delete=function(t){return e.prototype.deleteEndpoint.call(i,t)},i.insertRows=function(e){return i.sequenceRowsAPI.insert(e)},i.retrieveRows=function(e){return i.sequenceRowsAPI.retrieve(e)},i.deleteRows=function(e){return i.sequenceRowsAPI.delete(e)},i.sequenceRowsAPI=new Z(i.url()+"data",n,r),i}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","columns"],["createdTime","lastUpdatedTime"])},t}(i.BaseResourceAPI),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(){return d(t,void 0,void 0,(function(){var e,t;return f(this,(function(n){switch(n.label){case 0:return e=this.url(),[4,this.get(e)];case 1:return t=n.sent(),[2,this.addToMapAndReturn(t.data.items,t)]}}))}))},t.delete=function(n){return e.prototype.deleteEndpoint.call(t,n)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["deletedTime"])},t}(i.BaseResourceAPI),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(e){return t.listEndpoint(t.callListEndpointWithGet,e)},t.delete=function(e){return t.deleteEndpoint(e)},t}return u(t,e),t}(i.BaseResourceAPI),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e,n){return t.createEndpoint(n,t.url(e+"/features"))},t.retrieve=function(e,n,r){return t.callEndpointWithMergeAndTransform(n,(function(n){return t.postInParallelWithAutomaticChunking({path:t.url(e+"/features/byids"),items:n,params:r})}))},t.update=function(e,n){return t.updateEndpoint(n,t.url(e+"/features/update"))},t.delete=function(e,n){return t.deleteEndpoint(n,{},t.url(e+"/features/delete"))},t.search=function(e,n){return void 0===n&&(n={}),t.searchEndpoint(n,t.url(e+"/features/search"))},t.searchStream=function(e,n){return void 0===n&&(n={}),t.searchEndpoint(n,t.url(e+"/features/search-streaming"))},t.aggregate=function(e,n){return t.aggregateEndpoint(n,t.url(e+"/features/aggregate"))},t}return u(t,e),t}(i.BaseResourceAPI),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(){return t.listEndpoint(t.callListEndpointWithPost)},t.delete=function(e,n){return void 0===n&&(n={}),t.deleteEndpoint(e,n)},t.update=function(e){return t.updateEndpoint(e)},t}return u(t,e),t}(i.BaseResourceAPI),Q=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,h(t))||this,i=p(t,3),o=i[1],a=i[2];return r.crsAPI=new X(r.url("crs"),o,a),r.featureTypeAPI=new J(r.url("featuretypes"),o,a),r.featureAPI=new K(r.url("featuretypes"),o,a),r}return u(t,e),Object.defineProperty(t.prototype,"crs",{get:function(){return this.crsAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"feature",{get:function(){return this.featureAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"featureType",{get:function(){return this.featureTypeAPI},enumerable:!1,configurable:!0}),t}(i.BaseResourceAPI),$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.runQuery=function(e){var n=e.query,r=e.variables,i=e.operationName;return d(t,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this.post(this.url(),{data:{query:n,variables:r,operationName:i}})];case 1:return[2,e.sent().data]}}))}))},t}return u(t,e),t}(i.BaseResourceAPI),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upsert=function(e){return t.post(t.url("upsert"),{data:e}).then((function(e){return e.data}))},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.delete=function(e){return t.post(t.url("delete"),{data:{version:e}})},t}return u(t,e),t}(i.BaseResourceAPI),te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(n){return e.prototype.createEndpoint.call(t,n)},t.upsert=function(n){return e.prototype.createEndpoint.call(t,n,t.url("upsert"))},t.retrieve=function(n,r){return e.prototype.retrieveEndpoint.call(t,n,r||{ignoreUnknownIds:!1})},t.list=function(n){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,n)},t.delete=function(n,r){return e.prototype.deleteEndpoint.call(t,n,r||{ignoreUnknownIds:!1})},t}return u(t,e),t}(i.BaseResourceAPI);(k=t.ConflictMode||(t.ConflictMode={})).Patch="Patch",k.Update="Update",k.Force="Force";var ne,re=function(e){this.type="constant",this.value=e},ie=function(e,t,n,r){this.type="raw",this.dbName=e,this.tableName=t,this.rowKey=n,this.columnName=r},oe=function(e,t,n,r,i,o,a){this.type="syntheticTimeSeries",this.expression=e,this.name=t,this.metadata=n,this.description=r,this.isStep=i,this.isString=o,this.unit=a},ae=function(e,t){this.type="view",this.externalId=e,this.input=t},se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(n){return e.prototype.createEndpoint.call(t,ue.encodeTemplateInstances(n)).then(ue.decodeTemplateInstances)},t.upsert=function(n){return e.prototype.createEndpoint.call(t,ue.encodeTemplateInstances(n),t.url("upsert")).then(ue.decodeTemplateInstances)},t.update=function(n){return e.prototype.updateEndpoint.call(t,n.map(ue.encodePatch)).then(ue.decodeTemplateInstances)},t.retrieve=function(n,r){return e.prototype.retrieveEndpoint.call(t,n,r||{ignoreUnknownIds:!1}).then(ue.decodeTemplateInstances)},t.list=function(n){return e.prototype.listEndpoint.call(t,(function(e){return d(t,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return[4,this.callListEndpointWithPost(e)];case 1:return t=n.sent(),[2,c(c({},t),{data:c(c({},t.data),{items:ue.decodeTemplateInstances(t.data.items)})})]}}))}))}),n)},t.delete=function(n,r){return e.prototype.deleteEndpoint.call(t,n,r||{ignoreUnknownIds:!1})},t}return u(t,e),t}(i.BaseResourceAPI),ue=function(){function e(){}return e.encodeTemplateInstances=function(t){return t.map((function(t){return c(c({},t),{fieldResolvers:e.encodeFieldResolvers(t.fieldResolvers)})}))},e.encodePatch=function(t){return c(c({},t),{update:{fieldResolvers:{add:"add"in t.update.fieldResolvers?e.encodeFieldResolvers(t.update.fieldResolvers.add):void 0,remove:"remove"in t.update.fieldResolvers?t.update.fieldResolvers.remove:void 0,set:"set"in t.update.fieldResolvers?e.encodeFieldResolvers(t.update.fieldResolvers.set):void 0}}})},e.encodeFieldResolvers=function(e){var t=this,n=a(e).map((function(e){var n=p(e,2),r=n[0],i=n[1];return void 0===i||t.isFieldResolver(i)?[r,i]:[r,new re(i)]}));return o(n)},e.decodeTemplateInstances=function(t){return t.map((function(t){return c(c({},t),{fieldResolvers:e.decodeFieldResolvers(t.fieldResolvers)})}))},e.decodeFieldResolvers=function(t){var n=a(t).map((function(t){var n=p(t,2),r=n[0],i=n[1];return[r,e.decodeFieldResolver(i)]}));return o(n)},e.decodeFieldResolver=function(e){switch(e.type){case"constant":return e.value;case"raw":return new ie(e.dbName,e.tableName,e.rowKey,e.columnName);case"syntheticTimeSeries":return new oe(e.expression,e.name,e.metadata,e.description,e.isStep,e.isString,e.unit);case"view":return new ae(e.externalId,e.input);default:throw new Error("Unknown field resolver type")}},e.isFieldResolver=function(e){return e instanceof re||e instanceof ie||e instanceof oe||e instanceof ae},e}(),ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.upsert=function(e){return t.createEndpoint(e,t.url("upsert"))},t.list=function(e){return t.listEndpoint(t.callListEndpointWithPost,e)},t.resolve=function(e){return t.listEndpoint((function(e){return d(t,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.post(this.url("resolve"),{data:e||{}})];case 1:return[2,t.sent()]}}))}))}),e)},t.delete=function(n,r){return e.prototype.deleteEndpoint.call(t,n,r||{ignoreUnknownIds:!1})},t}return u(t,e),t}(i.BaseResourceAPI),le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.query=function(e){return t.querySyntheticEndpoint(e)},t}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","datapoints"],["timestamp"])},t.prototype.querySyntheticEndpoint=function(e){return d(this,void 0,void 0,(function(){var t,n=this;return f(this,(function(r){return t=this.url("query"),[2,this.callEndpointWithMergeAndTransform(e,(function(e){return n.postInParallelWithAutomaticChunking({path:t,items:e,chunkSize:10})}))]}))}))},t}(i.BaseResourceAPI),de=function(e){function t(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=e.apply(this,h([t],n))||this;return i.create=function(t){return e.prototype.createEndpoint.call(i,t)},i.list=function(t){return e.prototype.listEndpoint.call(i,i.callListEndpointWithPost,t)},i.aggregate=function(t){return e.prototype.aggregateEndpoint.call(i,t)},i.retrieve=function(t,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(i,t,n)},i.update=function(t){return e.prototype.updateEndpoint.call(i,t)},i.search=function(t){return e.prototype.searchEndpoint.call(i,t)},i.delete=function(t){return e.prototype.deleteEndpoint.call(i,t)},i.syntheticQuery=function(e){return i.syntheticTimeseriesApi.query(e)},i.syntheticTimeseriesApi=new(le.bind.apply(le,h([void 0,i.url("synthetic")],n))),i}return u(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(i.BaseResourceAPI),fe=((ne={})[i.HttpMethod.Post]=["/assets/list","/assets/byids","/assets/search","/events/list","/events/byids","/events/search","/files/list","/files/byids","/files/search","/files/initupload","/files/downloadlink","/timeseries/byids","/timeseries/search","/timeseries/data","/timeseries/data/list","/timeseries/data/latest","/timeseries/data/delete","/timeseries/synthetic/query"],ne),pe=i.createRetryValidator(fe),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"assets",{get:function(){return i.accessApi(this.assetsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeseries",{get:function(){return i.accessApi(this.timeSeriesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datapoints",{get:function(){return i.accessApi(this.dataPointsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sequences",{get:function(){return i.accessApi(this.sequencesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return i.accessApi(this.eventsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return i.accessApi(this.filesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labels",{get:function(){return i.accessApi(this.labelsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return i.accessApi(this.rawApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projects",{get:function(){return i.accessApi(this.projectsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return i.accessApi(this.groupsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"securityCategories",{get:function(){return i.accessApi(this.securityCategoriesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceAccounts",{get:function(){return i.accessApi(this.serviceAccountsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"models3D",{get:function(){return i.accessApi(this.models3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"revisions3D",{get:function(){return i.accessApi(this.revisions3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"files3D",{get:function(){return i.accessApi(this.files3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasets",{get:function(){return i.accessApi(this.datasetsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"assetMappings3D",{get:function(){return i.accessApi(this.assetMappings3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewer3D",{get:function(){return i.accessApi(this.viewer3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiKeys",{get:function(){return i.accessApi(this.apiKeysApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relationships",{get:function(){return i.accessApi(this.relationshipsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityMatching",{get:function(){return i.accessApi(this.entityMatchingApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"geospatial",{get:function(){return i.accessApi(this.geospatialApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"documents",{get:function(){return i.accessApi(this.documentsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"templates",{get:function(){var e=this;return{groups:i.accessApi(this.apiFactory(te,"templategroups")),group:function(n){var r="templategroups/"+t.urlEncodeExternalId(n)+"/versions";return{versions:i.accessApi(e.apiFactory(ee,r)),version:function(t){var n=r+"/"+t,o=e.apiFactory($,n+"/graphql");return{instances:i.accessApi(e.apiFactory(se,n+"/instances")),runQuery:function(t){return d(e,void 0,void 0,(function(){return f(this,(function(e){return[2,o.runQuery(t)]}))}))},views:i.accessApi(e.apiFactory(ce,n+"/views"))}}}}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return"7.2.3"},enumerable:!1,configurable:!0}),t.prototype.getRetryValidator=function(){return pe},t.prototype.initAPIs=function(){var e="3d/models";this.httpClient.setDefaultHeader("cdf-version","V20210406"),this.assetsApi=this.apiFactory(A,"assets"),this.timeSeriesApi=this.apiFactory(de,"timeseries"),this.dataPointsApi=this.apiFactory(P,"timeseries/data"),this.sequencesApi=this.apiFactory(q,"sequences"),this.eventsApi=this.apiFactory(D,"events"),this.filesApi=this.apiFactory(L,"files"),this.labelsApi=this.apiFactory(F,"labels"),this.datasetsApi=this.apiFactory(C,"datasets"),this.rawApi=this.apiFactory(G,"raw/dbs"),this.groupsApi=this.apiFactory(B,"groups"),this.securityCategoriesApi=this.apiFactory(W,"securitycategories"),this.serviceAccountsApi=this.apiFactory(Y,"serviceaccounts"),this.apiKeysApi=this.apiFactory(T,"apikeys"),this.models3DApi=this.apiFactory(y,e),this.relationshipsApi=this.apiFactory(V,"relationships"),this.entityMatchingApi=this.apiFactory(R,"context/entitymatching"),this.revisions3DApi=this.apiFactory(b,e),this.files3DApi=this.apiFactory(m,"3d/files"),this.assetMappings3DApi=this.apiFactory(v,e),this.viewer3DApi=this.apiFactory(S,"3d"),this.projectsApi=new j(i.apiUrl(),this.httpClient,this.metadataMap),this.geospatialApi=this.apiFactory(Q,"geospatial"),this.documentsApi=this.apiFactory(I,"documents")},t.urlEncodeExternalId=function(e){return encodeURIComponent(e)},t}(i.BaseCogniteClient);Object.defineProperty(t,"CogniteAuthentication",{enumerable:!0,get:function(){return i.CogniteAuthentication}}),Object.defineProperty(t,"CogniteError",{enumerable:!0,get:function(){return i.CogniteError}}),Object.defineProperty(t,"CogniteLoginError",{enumerable:!0,get:function(){return i.CogniteLoginError}}),Object.defineProperty(t,"CogniteMultiError",{enumerable:!0,get:function(){return i.CogniteMultiError}}),Object.defineProperty(t,"HttpError",{enumerable:!0,get:function(){return i.HttpError}}),Object.defineProperty(t,"HttpResponseType",{enumerable:!0,get:function(){return i.HttpResponseType}}),Object.defineProperty(t,"POPUP",{enumerable:!0,get:function(){return i.POPUP}}),Object.defineProperty(t,"REDIRECT",{enumerable:!0,get:function(){return i.REDIRECT}}),Object.defineProperty(t,"isLoginPopupWindow",{enumerable:!0,get:function(){return i.isLoginPopupWindow}}),Object.defineProperty(t,"loginPopupHandler",{enumerable:!0,get:function(){return i.loginPopupHandler}}),t.ApiKeysAPI=T,t.AssetMappings3DAPI=v,t.AssetsAPI=A,t.CogniteClient=he,t.ConstantResolver=re,t.ContextJobStatus={QUEUED:"QUEUED",RUNNING:"RUNNING",COMPLETED:"COMPLETED",FAILED:"FAILED"},t.DataPointsAPI=P,t.DataSetsAPI=C,t.EntityMatchingApi=R,t.EntityMatchingClassifier={RANDOM_FOREST:"randomforest",DECISION_TREE:"decisiontree",LOGISTIC_REGRESSION:"logisticregression",AUGMENTED_LOGISTIC_REGRESSION:"augmentedlogisticregression",AUGMENTED_RANDOM_FOREST:"augmentedrandomforest"},t.EntityMatchingFeatureType={SIMPLE:"simple",BIGRAM:"bigram",FREQUENCY_WEIGHTED_BIGRAM:"frequencyweightedbigram",BIGRAM_EXTRA_TOKENIZERS:"bigramextratokenizers",BIGRAM_COMBO:"bigramcombo"},t.EventsAPI=D,t.EventsAggregateAPI=N,t.Files3DAPI=m,t.FilesAPI=L,t.GroupsAPI=B,t.LabelsAPI=F,t.Models3DAPI=y,t.Nodes3DAPI=g,t.ProjectsAPI=j,t.RawAPI=G,t.RawResolver=ie,t.RawRowsAPI=z,t.RawTablesAPI=U,t.RelationshipsApi=V,t.RevealNodes3DAPI=x,t.RevealRevisions3DAPI=_,t.RevealSectors3DAPI=w,t.Revisions3DAPI=b,t.SecurityCategoriesAPI=W,t.SequenceRowsAPI=Z,t.SequenceValueType={STRING:"STRING",DOUBLE:"DOUBLE",LONG:"LONG"},t.SequencesAPI=q,t.ServiceAccountsAPI=Y,t.SortOrder={ASC:"asc",DESC:"desc"},t.SyntheticTimeSeriesAPI=le,t.SyntheticTimeSeriesResolver=oe,t.TemplateGraphQlApi=$,t.TemplateGroupVersionsApi=ee,t.TemplateGroupsApi=te,t.TemplateInstancesApi=se,t.TimeSeriesAPI=de,t.UnrealRevisions3DAPI=M,t.ViewResolver=ae,t.Viewer3DAPI=S,t.ViewsApi=ce},46661:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(5954),i=n(60493),o=n(969),a=n(19295),s=n.n(a),u=n(18777),c=n(7815),l=n(962),d=n(89395);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function y(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function x(){}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(w,e);var t,n,a,f,_=(a=w,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(a);if(f){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function w(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),(t=_.call(this,e)).handleClose=function(e){e.preventDefault();var n=i.findDOMNode(g(t));n.style.height="".concat(n.offsetHeight,"px"),n.style.height="".concat(n.offsetHeight,"px"),t.setState({closing:!0}),(t.props.onClose||x)(e)},t.animationEnd=function(){t.setState({closing:!1,closed:!0}),(t.props.afterClose||x)()},t.renderAlert=function(e){var n,i=e.getPrefixCls,a=t.props,c=a.description,d=a.prefixCls,f=a.message,v=a.closeText,m=a.banner,y=a.className,g=void 0===y?"":y,b=a.style,x=a.icon,_=t.props,w=_.closable,M=_.type,S=_.showIcon,T=_.iconType,E=t.state,k=E.closing,A=E.closed,P=i("alert",d);S=!(!m||void 0!==S)||S,M=m&&void 0===M?"warning":M||"info";var C="filled";if(!T){switch(M){case"success":T="check-circle";break;case"info":T="info-circle";break;case"error":T="close-circle";break;case"warning":T="exclamation-circle";break;default:T="default"}c&&(C="outlined")}v&&(w=!0);var O=s()(P,"".concat(P,"-").concat(M),(h(n={},"".concat(P,"-closing"),k),h(n,"".concat(P,"-with-description"),!!c),h(n,"".concat(P,"-no-icon"),!S),h(n,"".concat(P,"-banner"),!!m),h(n,"".concat(P,"-closable"),w),n),g),I=w?r.createElement("button",{type:"button",onClick:t.handleClose,className:"".concat(P,"-close-icon"),tabIndex:0},v?r.createElement("span",{className:"".concat(P,"-close-text")},v):r.createElement(u.Z,{type:"close"})):null,R=(0,l.Z)(t.props),N=x&&(r.isValidElement(x)?r.cloneElement(x,{className:s()("".concat(P,"-icon"),h({},x.props.className,x.props.className))}):r.createElement("span",{className:"".concat(P,"-icon")},x))||r.createElement(u.Z,{className:"".concat(P,"-icon"),type:T,theme:C});return A?null:r.createElement(o.Z,{component:"",showProp:"data-show",transitionName:"".concat(P,"-slide-up"),onEnd:t.animationEnd},r.createElement("div",p({"data-show":!k,className:O,style:b},R),S?N:null,r.createElement("span",{className:"".concat(P,"-message")},f),r.createElement("span",{className:"".concat(P,"-description")},c),I))},(0,d.Z)(!("iconType"in e),"Alert","`iconType` is deprecated. Please use `icon` instead."),t.state={closing:!1,closed:!1},t}return t=w,(n=[{key:"render",value:function(){return r.createElement(c.C,null,this.renderAlert)}}])&&v(t.prototype,n),w}(r.Component)},26823:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(5954),i=n(19295),o=n.n(i),a=n(18777),s=n(7815);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(g,e);var t,n,i,u,y=(i=g,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(i);if(u){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function g(){var e;return d(this,g),(e=y.apply(this,arguments)).state={scale:1,mounted:!1,isImgExist:!0},e.setScale=function(){if(e.avatarChildren&&e.avatarNode){var t=e.avatarChildren.offsetWidth,n=e.avatarNode.offsetWidth;0===t||0===n||e.lastChildrenWidth===t&&e.lastNodeWidth===n||(e.lastChildrenWidth=t,e.lastNodeWidth=n,e.setState({scale:n-8<t?(n-8)/t:1}))}},e.handleImgLoadError=function(){var t=e.props.onError;!1!==(t?t():void 0)&&e.setState({isImgExist:!1})},e.renderAvatar=function(t){var n,i,s=t.getPrefixCls,u=e.props,d=u.prefixCls,f=u.shape,p=u.size,h=u.src,v=u.srcSet,y=u.icon,g=u.className,b=u.alt,x=m(u,["prefixCls","shape","size","src","srcSet","icon","className","alt"]),_=e.state,w=_.isImgExist,M=_.scale,S=(_.mounted,s("avatar",d)),T=o()((l(n={},"".concat(S,"-lg"),"large"===p),l(n,"".concat(S,"-sm"),"small"===p),n)),E=o()(S,g,T,(l(i={},"".concat(S,"-").concat(f),f),l(i,"".concat(S,"-image"),h&&w),l(i,"".concat(S,"-icon"),y),i)),k="number"==typeof p?{width:p,height:p,lineHeight:"".concat(p,"px"),fontSize:y?p/2:18}:{},A=e.props.children;if(h&&w)A=r.createElement("img",{src:h,srcSet:v,onError:e.handleImgLoadError,alt:b});else if(y)A="string"==typeof y?r.createElement(a.Z,{type:y}):y;else if(e.avatarChildren||1!==M){var P="scale(".concat(M,") translateX(-50%)"),C={msTransform:P,WebkitTransform:P,transform:P},O="number"==typeof p?{lineHeight:"".concat(p,"px")}:{};A=r.createElement("span",{className:"".concat(S,"-string"),ref:function(t){return e.avatarChildren=t},style:c(c({},O),C)},A)}else A=r.createElement("span",{className:"".concat(S,"-string"),style:{opacity:0},ref:function(t){return e.avatarChildren=t}},A);return r.createElement("span",c({},x,{style:c(c({},k),x.style),className:E,ref:function(t){return e.avatarNode=t}}),A)},e}return t=g,(n=[{key:"componentDidMount",value:function(){this.setScale(),this.setState({mounted:!0})}},{key:"componentDidUpdate",value:function(e){this.setScale(),e.src!==this.props.src&&this.setState({isImgExist:!0,scale:1})}},{key:"render",value:function(){return r.createElement(s.C,null,this.renderAvatar)}}])&&f(t.prototype,n),g}(r.Component);y.defaultProps={shape:"circle",size:"default"}},99118:function(e,t,n){"use strict";n.d(t,{Z:function(){return N}});var r=n(5954),i=n(96504),o=n(19295),a=n.n(o),s=n(31009),u=n(99491),c=n(7815),l=n(22861),d=n(91901),f=n(30858);function p(e){if(!r.isValidElement(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return r.cloneElement.apply(r,[e].concat(n))}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function b(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}function _(){return _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}var w=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function M(e,t){return e[t]&&Math.floor(24/e[t])}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(u,e);var t,n,i,o,s=(i=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(i);if(o){var n=x(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function u(){var e;return m(this,u),(e=s.apply(this,arguments)).renderItem=function(t){var n=t.getPrefixCls,i=e.context,o=i.grid,s=i.itemLayout,u=e.props,c=u.prefixCls,l=u.children,d=u.actions,h=u.extra,m=u.className,y=w(u,["prefixCls","children","actions","extra","className"]),g=n("list",c),b=d&&d.length>0&&r.createElement("ul",{className:"".concat(g,"-item-action"),key:"actions"},d.map((function(e,t){return r.createElement("li",{key:"".concat(g,"-item-action-").concat(t)},e,t!==d.length-1&&r.createElement("em",{className:"".concat(g,"-item-action-split")}))}))),x=o?"div":"li",S=r.createElement(x,_({},y,{className:a()("".concat(g,"-item"),m,v({},"".concat(g,"-item-no-flex"),!e.isFlexMode()))}),"vertical"===s&&h?[r.createElement("div",{className:"".concat(g,"-item-main"),key:"content"},l,b),r.createElement("div",{className:"".concat(g,"-item-extra"),key:"extra"},h)]:[l,b,p(h,{key:"extra"})]);return o?r.createElement(f.Z,{span:M(o,"column"),xs:M(o,"xs"),sm:M(o,"sm"),md:M(o,"md"),lg:M(o,"lg"),xl:M(o,"xl"),xxl:M(o,"xxl")},S):S},e}return t=u,(n=[{key:"isItemContainsTextNodeAndNotSingular",value:function(){var e,t=this.props.children;return r.Children.forEach(t,(function(t){"string"==typeof t&&(e=!0)})),e&&r.Children.count(t)>1}},{key:"isFlexMode",value:function(){var e=this.props.extra;return"vertical"===this.context.itemLayout?!!e:!this.isItemContainsTextNodeAndNotSingular()}},{key:"render",value:function(){return r.createElement(c.C,null,this.renderItem)}}])&&y(t.prototype,n),u}(r.Component);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function E(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(){return A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A.apply(this,arguments)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}function I(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}S.Meta=function(e){return r.createElement(c.C,null,(function(t){var n=t.getPrefixCls,i=e.prefixCls,o=e.className,s=e.avatar,u=e.title,c=e.description,l=w(e,["prefixCls","className","avatar","title","description"]),d=n("list",i),f=a()("".concat(d,"-item-meta"),o),p=r.createElement("div",{className:"".concat(d,"-item-meta-content")},u&&r.createElement("h4",{className:"".concat(d,"-item-meta-title")},u),c&&r.createElement("div",{className:"".concat(d,"-item-meta-description")},c));return r.createElement("div",_({},l,{className:f}),s&&r.createElement("div",{className:"".concat(d,"-item-meta-avatar")},s),(u||c)&&p)}))},S.contextTypes={grid:i.any,itemLayout:i.string};var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(p,e);var t,n,i,o,f=(i=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(i);if(o){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return I(this,e)});function p(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=f.call(this,e)).defaultPaginationProps={current:1,total:0},t.keys={},t.onPaginationChange=t.triggerPaginationEvent("onChange"),t.onPaginationShowSizeChange=t.triggerPaginationEvent("onShowSizeChange"),t.renderItem=function(e,n){var r,i=t.props,o=i.renderItem,a=i.rowKey;return o?((r="function"==typeof a?a(e):"string"==typeof a?e[a]:e.key)||(r="list-item-".concat(n)),t.keys[n]=r,o(e,n)):null},t.renderEmpty=function(e,n){var i=t.props.locale;return r.createElement("div",{className:"".concat(e,"-empty-text")},i&&i.emptyText||n("List"))},t.renderList=function(e){var n,i=e.getPrefixCls,o=e.renderEmpty,c=t.state,f=c.paginationCurrent,p=c.paginationSize,h=t.props,v=h.prefixCls,m=h.bordered,y=h.split,g=h.className,b=h.children,x=h.itemLayout,_=h.loadMore,w=h.pagination,M=h.grid,S=h.dataSource,T=void 0===S?[]:S,k=h.size,C=h.header,O=h.footer,I=h.loading,R=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(h,["prefixCls","bordered","split","className","children","itemLayout","loadMore","pagination","grid","dataSource","size","header","footer","loading"]),N=i("list",v),D=I;"boolean"==typeof D&&(D={spinning:D});var L=D&&D.spinning,B="";switch(k){case"large":B="lg";break;case"small":B="sm"}var F=a()(N,g,(P(n={},"".concat(N,"-vertical"),"vertical"===x),P(n,"".concat(N,"-").concat(B),B),P(n,"".concat(N,"-split"),y),P(n,"".concat(N,"-bordered"),m),P(n,"".concat(N,"-loading"),L),P(n,"".concat(N,"-grid"),M),P(n,"".concat(N,"-something-after-last-item"),t.isSomethingAfterLastItem()),n)),j=A(A(A({},t.defaultPaginationProps),{total:T.length,current:f,pageSize:p}),w||{}),z=Math.ceil(j.total/j.pageSize);j.current>z&&(j.current=z);var U,G=w?r.createElement("div",{className:"".concat(N,"-pagination")},r.createElement(l.Z,A({},j,{onChange:t.onPaginationChange,onShowSizeChange:t.onPaginationShowSizeChange}))):null,V=E(T);if(w&&T.length>(j.current-1)*j.pageSize&&(V=E(T).splice((j.current-1)*j.pageSize,j.pageSize)),U=L&&r.createElement("div",{style:{minHeight:53}}),V.length>0){var W=V.map((function(e,n){return t.renderItem(e,n)})),H=[];r.Children.forEach(W,(function(e,n){H.push(r.cloneElement(e,{key:t.keys[n]}))})),U=M?r.createElement(d.Z,{gutter:M.gutter},H):r.createElement("ul",{className:"".concat(N,"-items")},H)}else b||L||(U=t.renderEmpty(N,o));var Z=j.position||"bottom";return r.createElement("div",A({className:F},(0,s.default)(R,["rowKey","renderItem","locale"])),("top"===Z||"both"===Z)&&G,C&&r.createElement("div",{className:"".concat(N,"-header")},C),r.createElement(u.Z,D,U,b),O&&r.createElement("div",{className:"".concat(N,"-footer")},O),_||("bottom"===Z||"both"===Z)&&G)};var n=e.pagination,i=n&&"object"===T(n)?n:{};return t.state={paginationCurrent:i.defaultCurrent||1,paginationSize:i.defaultPageSize||10},t}return t=p,(n=[{key:"getChildContext",value:function(){return{grid:this.props.grid,itemLayout:this.props.itemLayout}}},{key:"triggerPaginationEvent",value:function(e){var t=this;return function(n,r){var i=t.props.pagination;t.setState({paginationCurrent:n,paginationSize:r}),i&&i[e]&&i[e](n,r)}}},{key:"isSomethingAfterLastItem",value:function(){var e=this.props,t=e.loadMore,n=e.pagination,r=e.footer;return!!(t||n||r)}},{key:"render",value:function(){return r.createElement(c.C,null,this.renderList)}}])&&C(t.prototype,n),p}(r.Component);N.Item=S,N.childContextTypes={grid:i.any,itemLayout:i.string},N.defaultProps={dataSource:[],bordered:!1,split:!0,loading:!1,pagination:!1}},439:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var r=n(96504),i=n(5954),o=n(19295),a=n.n(o),s=n(31009),u=n(18777),c=n(7815),l=n(52312);function d(e){return!e||e<0?0:e>100?100:e}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function(e){var t=e.from,n=void 0===t?"#1890ff":t,r=e.to,i=void 0===r?"#1890ff":r,o=e.direction,a=void 0===o?"to right":o,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["from","to","direction"]);if(0!==Object.keys(s).length){var u=function(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var i=(u=r[n],c=2,function(e){if(Array.isArray(e))return e}(u)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(u,c)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(u,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],a=i[1],s=parseFloat(o.replace(/%/g,""));if(isNaN(s))return{};t.push({key:s,value:a})}var u,c;return(t=t.sort((function(e,t){return e.key-t.key}))).map((function(e){var t=e.key,n=e.value;return"".concat(n," ").concat(t,"%")})).join(", ")}(s);return{backgroundImage:"linear-gradient(".concat(a,", ").concat(u,")")}}return{backgroundImage:"linear-gradient(".concat(a,", ").concat(n,", ").concat(i,")")}},v=function(e){var t,n=e.prefixCls,r=e.percent,o=e.successPercent,a=e.strokeWidth,s=e.size,u=e.strokeColor,c=e.strokeLinecap,l=e.children;t=u&&"string"!=typeof u?h(u):{background:u};var p=f({width:"".concat(d(r),"%"),height:a||("small"===s?6:8),borderRadius:"square"===c?0:""},t),v={width:"".concat(d(o),"%"),height:a||("small"===s?6:8),borderRadius:"square"===c?0:""},m=void 0!==o?i.createElement("div",{className:"".concat(n,"-success-bg"),style:v}):null;return i.createElement("div",null,i.createElement("div",{className:"".concat(n,"-outer")},i.createElement("div",{className:"".concat(n,"-inner")},i.createElement("div",{className:"".concat(n,"-bg"),style:p}),m)),l)},m=n(81963),y={normal:"#108ee9",exception:"#ff5500",success:"#87d068"};function g(e){var t=e.percent,n=e.successPercent,r=d(t);if(!n)return r;var i=d(n);return[n,d(r-i)]}var b=function(e){var t,n,r,o,s,u,c,l=e.prefixCls,d=e.width,f=e.strokeWidth,p=e.trailColor,h=e.strokeLinecap,v=e.gapPosition,b=e.gapDegree,x=e.type,_=e.children,w=d||120,M={width:w,height:w,fontSize:.15*w+6},S=f||6,T=v||"dashboard"===x&&"bottom"||"top",E=b||("dashboard"===x?75:void 0),k=(n=(t=e).progressStatus,r=t.successPercent,o=t.strokeColor||y[n],r?[y.success,o]:o),A="[object Object]"===Object.prototype.toString.call(k),P=a()("".concat(l,"-inner"),(s={},c=A,(u="".concat(l,"-circle-gradient"))in s?Object.defineProperty(s,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[u]=c,s));return i.createElement("div",{className:P,style:M},i.createElement(m.Circle,{percent:g(e),strokeWidth:S,trailWidth:S,strokeColor:k,strokeLinecap:h,trailColor:p,prefixCls:l,gapDegree:E,gapPosition:T}),_)};function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},T(e,t)}function E(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?k(e):t}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var P=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},C=(0,l.b)("line","circle","dashboard"),O=(0,l.b)("normal","exception","active","success"),I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(f,e);var t,n,r,o,l=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(r);if(o){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function f(){var e;return M(this,f),(e=l.apply(this,arguments)).renderProgress=function(t){var n,r,o=t.getPrefixCls,u=k(e).props,c=u.prefixCls,l=u.className,d=u.size,f=u.type,p=u.showInfo,h=P(u,["prefixCls","className","size","type","showInfo"]),m=o("progress",c),y=e.getProgressStatus(),g=e.renderProcessInfo(m,y);"line"===f?r=i.createElement(v,w({},e.props,{prefixCls:m}),g):"circle"!==f&&"dashboard"!==f||(r=i.createElement(b,w({},e.props,{prefixCls:m,progressStatus:y}),g));var x=a()(m,(_(n={},"".concat(m,"-").concat("dashboard"===f?"circle":f),!0),_(n,"".concat(m,"-status-").concat(y),!0),_(n,"".concat(m,"-show-info"),p),_(n,"".concat(m,"-").concat(d),d),n),l);return i.createElement("div",w({},(0,s.default)(h,["status","format","trailColor","successPercent","strokeWidth","width","gapDegree","gapPosition","strokeColor","strokeLinecap","percent"]),{className:x}),r)},e}return t=f,n=[{key:"getPercentNumber",value:function(){var e=this.props,t=e.successPercent,n=e.percent,r=void 0===n?0:n;return parseInt(void 0!==t?t.toString():r.toString(),10)}},{key:"getProgressStatus",value:function(){var e=this.props.status;return O.indexOf(e)<0&&this.getPercentNumber()>=100?"success":e||"normal"}},{key:"renderProcessInfo",value:function(e,t){var n,r=this.props,o=r.showInfo,a=r.format,s=r.type,c=r.percent,l=r.successPercent;if(!o)return null;var f="circle"===s||"dashboard"===s?"":"-circle";return a||"exception"!==t&&"success"!==t?n=(a||function(e){return"".concat(e,"%")})(d(c),d(l)):"exception"===t?n=i.createElement(u.Z,{type:"close".concat(f),theme:"line"===s?"filled":"outlined"}):"success"===t&&(n=i.createElement(u.Z,{type:"check".concat(f),theme:"line"===s?"filled":"outlined"})),i.createElement("span",{className:"".concat(e,"-text"),title:"string"==typeof n?n:void 0},n)}},{key:"render",value:function(){return i.createElement(c.C,null,this.renderProgress)}}],n&&S(t.prototype,n),f}(i.Component);I.defaultProps={type:"line",percent:0,showInfo:!0,trailColor:"#f3f3f3",size:"default",gapDegree:0,strokeLinecap:"round"},I.propTypes={status:r.oneOf(O),type:r.oneOf(C),showInfo:r.bool,percent:r.number,width:r.number,strokeWidth:r.number,strokeLinecap:r.oneOf(["round","square"]),strokeColor:r.oneOfType([r.string,r.object]),trailColor:r.string,format:r.func,gapDegree:r.number};var R=I},95615:function(e,t,n){"use strict";n.d(t,{ZP:function(){return f}});var r=n(5954),i=n(19295),o=n.n(i),a=n(7815),s=n(18777),u={success:"check-circle",error:"close-circle",info:"exclamation-circle",warning:"warning"},c={404:function(){return r.createElement("svg",{width:"252",height:"294"},r.createElement("defs",null,r.createElement("path",{d:"M0 .387h251.772v251.772H0z"})),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("g",{transform:"translate(0 .012)"},r.createElement("mask",{fill:"#fff"}),r.createElement("path",{d:"M0 127.32v-2.095C0 56.279 55.892.387 124.838.387h2.096c68.946 0 124.838 55.892 124.838 124.838v2.096c0 68.946-55.892 124.838-124.838 124.838h-2.096C55.892 252.16 0 196.267 0 127.321",fill:"#E4EBF7",mask:"url(#b)"})),r.createElement("path",{d:"M39.755 130.84a8.276 8.276 0 1 1-16.468-1.66 8.276 8.276 0 0 1 16.468 1.66",fill:"#FFF"}),r.createElement("path",{d:"M36.975 134.297l10.482 5.943M48.373 146.508l-12.648 10.788",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{d:"M39.875 159.352a5.667 5.667 0 1 1-11.277-1.136 5.667 5.667 0 0 1 11.277 1.136M57.588 143.247a5.708 5.708 0 1 1-11.358-1.145 5.708 5.708 0 0 1 11.358 1.145M99.018 26.875l29.82-.014a4.587 4.587 0 1 0-.003-9.175l-29.82.013a4.587 4.587 0 1 0 .003 9.176M110.424 45.211l29.82-.013a4.588 4.588 0 0 0-.004-9.175l-29.82.013a4.587 4.587 0 1 0 .004 9.175",fill:"#FFF"}),r.createElement("path",{d:"M112.798 26.861v-.002l15.784-.006a4.588 4.588 0 1 0 .003 9.175l-15.783.007v-.002a4.586 4.586 0 0 0-.004-9.172M184.523 135.668c-.553 5.485-5.447 9.483-10.931 8.93-5.485-.553-9.483-5.448-8.93-10.932.552-5.485 5.447-9.483 10.932-8.93 5.485.553 9.483 5.447 8.93 10.932",fill:"#FFF"}),r.createElement("path",{d:"M179.26 141.75l12.64 7.167M193.006 156.477l-15.255 13.011",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{d:"M184.668 170.057a6.835 6.835 0 1 1-13.6-1.372 6.835 6.835 0 0 1 13.6 1.372M203.34 153.325a6.885 6.885 0 1 1-13.7-1.382 6.885 6.885 0 0 1 13.7 1.382",fill:"#FFF"}),r.createElement("path",{d:"M151.931 192.324a2.222 2.222 0 1 1-4.444 0 2.222 2.222 0 0 1 4.444 0zM225.27 116.056a2.222 2.222 0 1 1-4.445 0 2.222 2.222 0 0 1 4.444 0zM216.38 151.08a2.223 2.223 0 1 1-4.446-.001 2.223 2.223 0 0 1 4.446 0zM176.917 107.636a2.223 2.223 0 1 1-4.445 0 2.223 2.223 0 0 1 4.445 0zM195.291 92.165a2.223 2.223 0 1 1-4.445 0 2.223 2.223 0 0 1 4.445 0zM202.058 180.711a2.223 2.223 0 1 1-4.446 0 2.223 2.223 0 0 1 4.446 0z",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{stroke:"#FFF",strokeWidth:"2",d:"M214.404 153.302l-1.912 20.184-10.928 5.99M173.661 174.792l-6.356 9.814h-11.36l-4.508 6.484M174.941 125.168v-15.804M220.824 117.25l-12.84 7.901-15.31-7.902V94.39"}),r.createElement("path",{d:"M166.588 65.936h-3.951a4.756 4.756 0 0 1-4.743-4.742 4.756 4.756 0 0 1 4.743-4.743h3.951a4.756 4.756 0 0 1 4.743 4.743 4.756 4.756 0 0 1-4.743 4.742",fill:"#FFF"}),r.createElement("path",{d:"M174.823 30.03c0-16.281 13.198-29.48 29.48-29.48 16.28 0 29.48 13.199 29.48 29.48 0 16.28-13.2 29.48-29.48 29.48-16.282 0-29.48-13.2-29.48-29.48",fill:"#1890FF"}),r.createElement("path",{d:"M205.952 38.387c.5.5.785 1.142.785 1.928s-.286 1.465-.785 1.964c-.572.5-1.214.75-2 .75-.785 0-1.429-.285-1.929-.785-.572-.5-.82-1.143-.82-1.929s.248-1.428.82-1.928c.5-.5 1.144-.75 1.93-.75.785 0 1.462.25 1.999.75m4.285-19.463c1.428 1.249 2.143 2.963 2.143 5.142 0 1.712-.427 3.13-1.219 4.25-.067.096-.137.18-.218.265-.416.429-1.41 1.346-2.956 2.699a5.07 5.07 0 0 0-1.428 1.75 5.207 5.207 0 0 0-.536 2.357v.5h-4.107v-.5c0-1.357.215-2.536.714-3.5.464-.964 1.857-2.464 4.178-4.536l.43-.5c.643-.785.964-1.643.964-2.535 0-1.18-.358-2.108-1-2.785-.678-.68-1.643-1.001-2.858-1.001-1.536 0-2.642.464-3.357 1.43-.37.5-.621 1.135-.76 1.904a1.999 1.999 0 0 1-1.971 1.63h-.004c-1.277 0-2.257-1.183-1.98-2.43.337-1.518 1.02-2.78 2.073-3.784 1.536-1.5 3.607-2.25 6.25-2.25 2.32 0 4.214.607 5.642 1.894",fill:"#FFF"}),r.createElement("path",{d:"M52.04 76.131s21.81 5.36 27.307 15.945c5.575 10.74-6.352 9.26-15.73 4.935-10.86-5.008-24.7-11.822-11.577-20.88",fill:"#FFB594"}),r.createElement("path",{d:"M90.483 67.504l-.449 2.893c-.753.49-4.748-2.663-4.748-2.663l-1.645.748-1.346-5.684s6.815-4.589 8.917-5.018c2.452-.501 9.884.94 10.7 2.278 0 0 1.32.486-2.227.69-3.548.203-5.043.447-6.79 3.132-1.747 2.686-2.412 3.624-2.412 3.624",fill:"#FFC6A0"}),r.createElement("path",{d:"M128.055 111.367c-2.627-7.724-6.15-13.18-8.917-15.478-3.5-2.906-9.34-2.225-11.366-4.187-1.27-1.231-3.215-1.197-3.215-1.197s-14.98-3.158-16.828-3.479c-2.37-.41-2.124-.714-6.054-1.405-1.57-1.907-2.917-1.122-2.917-1.122l-7.11-1.383c-.853-1.472-2.423-1.023-2.423-1.023l-2.468-.897c-1.645 9.976-7.74 13.796-7.74 13.796 1.795 1.122 15.703 8.3 15.703 8.3l5.107 37.11s-3.321 5.694 1.346 9.109c0 0 19.883-3.743 34.921-.329 0 0 3.047-2.546.972-8.806.523-3.01 1.394-8.263 1.736-11.622.385.772 2.019 1.918 3.14 3.477 0 0 9.407-7.365 11.052-14.012-.832-.723-1.598-1.585-2.267-2.453-.567-.736-.358-2.056-.765-2.717-.669-1.084-1.804-1.378-1.907-1.682",fill:"#FFF"}),r.createElement("path",{d:"M101.09 289.998s4.295 2.041 7.354 1.021c2.821-.94 4.53.668 7.08 1.178 2.55.51 6.874 1.1 11.686-1.26-.103-5.51-6.889-3.98-11.96-6.713-2.563-1.38-3.784-4.722-3.598-8.799h-9.402s-1.392 10.52-1.16 14.573",fill:"#CBD1D1"}),r.createElement("path",{d:"M101.067 289.826s2.428 1.271 6.759.653c3.058-.437 3.712.481 7.423 1.031 3.712.55 10.724-.069 11.823-.894.413 1.1-.343 2.063-.343 2.063s-1.512.603-4.812.824c-2.03.136-5.8.291-7.607-.503-1.787-1.375-5.247-1.903-5.728-.241-3.918.95-7.355-.286-7.355-.286l-.16-2.647z",fill:"#2B0849"}),r.createElement("path",{d:"M108.341 276.044h3.094s-.103 6.702 4.536 8.558c-4.64.618-8.558-2.303-7.63-8.558",fill:"#A4AABA"}),r.createElement("path",{d:"M57.542 272.401s-2.107 7.416-4.485 12.306c-1.798 3.695-4.225 7.492 5.465 7.492 6.648 0 8.953-.48 7.423-6.599-1.53-6.12.266-13.199.266-13.199h-8.669z",fill:"#CBD1D1"}),r.createElement("path",{d:"M51.476 289.793s2.097 1.169 6.633 1.169c6.083 0 8.249-1.65 8.249-1.65s.602 1.114-.619 2.165c-.993.855-3.597 1.591-7.39 1.546-4.145-.048-5.832-.566-6.736-1.168-.825-.55-.687-1.58-.137-2.062",fill:"#2B0849"}),r.createElement("path",{d:"M58.419 274.304s.033 1.519-.314 2.93c-.349 1.42-1.078 3.104-1.13 4.139-.058 1.151 4.537 1.58 5.155.034.62-1.547 1.294-6.427 1.913-7.252.619-.825-4.903-2.119-5.624.15",fill:"#A4AABA"}),r.createElement("path",{d:"M99.66 278.514l13.378.092s1.298-54.52 1.853-64.403c.554-9.882 3.776-43.364 1.002-63.128l-12.547-.644-22.849.78s-.434 3.966-1.195 9.976c-.063.496-.682.843-.749 1.365-.075.585.423 1.354.32 1.966-2.364 14.08-6.377 33.104-8.744 46.677-.116.666-1.234 1.009-1.458 2.691-.04.302.211 1.525.112 1.795-6.873 18.744-10.949 47.842-14.277 61.885l14.607-.014s2.197-8.57 4.03-16.97c2.811-12.886 23.111-85.01 23.111-85.01l3.016-.521 1.043 46.35s-.224 1.234.337 2.02c.56.785-.56 1.123-.392 2.244l.392 1.794s-.449 7.178-.898 11.89c-.448 4.71-.092 39.165-.092 39.165",fill:"#7BB2F9"}),r.createElement("path",{d:"M76.085 221.626c1.153.094 4.038-2.019 6.955-4.935M106.36 225.142s2.774-1.11 6.103-3.883",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M107.275 222.1s2.773-1.11 6.102-3.884",stroke:"#648BD8",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M74.74 224.767s2.622-.591 6.505-3.365M86.03 151.634c-.27 3.106.3 8.525-4.336 9.123M103.625 149.88s.11 14.012-1.293 15.065c-2.219 1.664-2.99 1.944-2.99 1.944M99.79 150.438s.035 12.88-1.196 24.377M93.673 175.911s7.212-1.664 9.431-1.664M74.31 205.861a212.013 212.013 0 0 1-.979 4.56s-1.458 1.832-1.009 3.776c.449 1.944-.947 2.045-4.985 15.355-1.696 5.59-4.49 18.591-6.348 27.597l-.231 1.12M75.689 197.807a320.934 320.934 0 0 1-.882 4.754M82.591 152.233L81.395 162.7s-1.097.15-.5 2.244c.113 1.346-2.674 15.775-5.18 30.43M56.12 274.418h13.31",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M116.241 148.22s-17.047-3.104-35.893.2c.158 2.514-.003 4.15-.003 4.15s14.687-2.818 35.67-.312c.252-2.355.226-4.038.226-4.038",fill:"#192064"}),r.createElement("path",{d:"M106.322 151.165l.003-4.911a.81.81 0 0 0-.778-.815c-2.44-.091-5.066-.108-7.836-.014a.818.818 0 0 0-.789.815l-.003 4.906a.81.81 0 0 0 .831.813c2.385-.06 4.973-.064 7.73.017a.815.815 0 0 0 .842-.81",fill:"#FFF"}),r.createElement("path",{d:"M105.207 150.233l.002-3.076a.642.642 0 0 0-.619-.646 94.321 94.321 0 0 0-5.866-.01.65.65 0 0 0-.63.647v3.072a.64.64 0 0 0 .654.644 121.12 121.12 0 0 1 5.794.011c.362.01.665-.28.665-.642",fill:"#192064"}),r.createElement("path",{d:"M100.263 275.415h12.338M101.436 270.53c.006 3.387.042 5.79.111 6.506M101.451 264.548a915.75 915.75 0 0 0-.015 4.337M100.986 174.965l.898 44.642s.673 1.57-.225 2.692c-.897 1.122 2.468.673.898 2.243-1.57 1.57.897 1.122 0 3.365-.596 1.489-.994 21.1-1.096 35.146",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M46.876 83.427s-.516 6.045 7.223 5.552c11.2-.712 9.218-9.345 31.54-21.655-.786-2.708-2.447-4.744-2.447-4.744s-11.068 3.11-22.584 8.046c-6.766 2.9-13.395 6.352-13.732 12.801M104.46 91.057l.941-5.372-8.884-11.43-5.037 5.372-1.74 7.834a.321.321 0 0 0 .108.32c.965.8 6.5 5.013 14.347 3.544a.332.332 0 0 0 .264-.268",fill:"#FFC6A0"}),r.createElement("path",{d:"M93.942 79.387s-4.533-2.853-2.432-6.855c1.623-3.09 4.513 1.133 4.513 1.133s.52-3.642 3.121-3.642c.52-1.04 1.561-4.162 1.561-4.162s11.445 2.601 13.526 3.121c0 5.203-2.304 19.424-7.84 19.861-8.892.703-12.449-9.456-12.449-9.456",fill:"#FFC6A0"}),r.createElement("path",{d:"M113.874 73.446c2.601-2.081 3.47-9.722 3.47-9.722s-2.479-.49-6.64-2.05c-4.683-2.081-12.798-4.747-17.48.976-9.668 3.223-2.05 19.823-2.05 19.823l2.713-3.021s-3.935-3.287-2.08-6.243c2.17-3.462 3.92 1.073 3.92 1.073s.637-2.387 3.581-3.342c.355-.71 1.036-2.674 1.432-3.85a1.073 1.073 0 0 1 1.263-.704c2.4.558 8.677 2.019 11.356 2.662.522.125.871.615.82 1.15l-.305 3.248z",fill:"#520038"}),r.createElement("path",{d:"M104.977 76.064c-.103.61-.582 1.038-1.07.956-.489-.083-.801-.644-.698-1.254.103-.61.582-1.038 1.07-.956.488.082.8.644.698 1.254M112.132 77.694c-.103.61-.582 1.038-1.07.956-.488-.083-.8-.644-.698-1.254.103-.61.582-1.038 1.07-.956.488.082.8.643.698 1.254",fill:"#552950"}),r.createElement("path",{stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round",d:"M110.13 74.84l-.896 1.61-.298 4.357h-2.228"}),r.createElement("path",{d:"M110.846 74.481s1.79-.716 2.506.537",stroke:"#5C2552",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M92.386 74.282s.477-1.114 1.113-.716c.637.398 1.274 1.433.558 1.99-.717.556.159 1.67.159 1.67",stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M103.287 72.93s1.83 1.113 4.137.954",stroke:"#5C2552",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M103.685 81.762s2.227 1.193 4.376 1.193M104.64 84.308s.954.398 1.511.318M94.693 81.205s2.308 7.4 10.424 7.639",stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M81.45 89.384s.45 5.647-4.935 12.787M69 82.654s-.726 9.282-8.204 14.206",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M129.405 122.865s-5.272 7.403-9.422 10.768",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M119.306 107.329s.452 4.366-2.127 32.062",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M150.028 151.232h-49.837a1.01 1.01 0 0 1-1.01-1.01v-31.688c0-.557.452-1.01 1.01-1.01h49.837c.558 0 1.01.453 1.01 1.01v31.688a1.01 1.01 0 0 1-1.01 1.01",fill:"#F2D7AD"}),r.createElement("path",{d:"M150.29 151.232h-19.863v-33.707h20.784v32.786a.92.92 0 0 1-.92.92",fill:"#F4D19D"}),r.createElement("path",{d:"M123.554 127.896H92.917a.518.518 0 0 1-.425-.816l6.38-9.113c.193-.277.51-.442.85-.442h31.092l-7.26 10.371z",fill:"#F2D7AD"}),r.createElement("path",{fill:"#CC9B6E",d:"M123.689 128.447H99.25v-.519h24.169l7.183-10.26.424.298z"}),r.createElement("path",{d:"M158.298 127.896h-18.669a2.073 2.073 0 0 1-1.659-.83l-7.156-9.541h19.965c.49 0 .95.23 1.244.622l6.69 8.92a.519.519 0 0 1-.415.83",fill:"#F4D19D"}),r.createElement("path",{fill:"#CC9B6E",d:"M157.847 128.479h-19.384l-7.857-10.475.415-.31 7.7 10.266h19.126zM130.554 150.685l-.032-8.177.519-.002.032 8.177z"}),r.createElement("path",{fill:"#CC9B6E",d:"M130.511 139.783l-.08-21.414.519-.002.08 21.414zM111.876 140.932l-.498-.143 1.479-5.167.498.143zM108.437 141.06l-2.679-2.935 2.665-3.434.41.318-2.397 3.089 2.384 2.612zM116.607 141.06l-.383-.35 2.383-2.612-2.397-3.089.41-.318 2.665 3.434z"}),r.createElement("path",{d:"M154.316 131.892l-3.114-1.96.038 3.514-1.043.092c-1.682.115-3.634.23-4.789.23-1.902 0-2.693 2.258 2.23 2.648l-2.645-.596s-2.168 1.317.504 2.3c0 0-1.58 1.217.561 2.58-.584 3.504 5.247 4.058 7.122 3.59 1.876-.47 4.233-2.359 4.487-5.16.28-3.085-.89-5.432-3.35-7.238",fill:"#FFC6A0"}),r.createElement("path",{d:"M153.686 133.577s-6.522.47-8.36.372c-1.836-.098-1.904 2.19 2.359 2.264 3.739.15 5.451-.044 5.451-.044",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M145.16 135.877c-1.85 1.346.561 2.355.561 2.355s3.478.898 6.73.617",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M151.89 141.71s-6.28.111-6.73-2.132c-.223-1.346.45-1.402.45-1.402M146.114 140.868s-1.103 3.16 5.44 3.533M151.202 129.932v3.477M52.838 89.286c3.533-.337 8.423-1.248 13.582-7.754",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M168.567 248.318a6.647 6.647 0 0 1-6.647-6.647v-66.466a6.647 6.647 0 1 1 13.294 0v66.466a6.647 6.647 0 0 1-6.647 6.647",fill:"#5BA02E"}),r.createElement("path",{d:"M176.543 247.653a6.647 6.647 0 0 1-6.646-6.647v-33.232a6.647 6.647 0 1 1 13.293 0v33.232a6.647 6.647 0 0 1-6.647 6.647",fill:"#92C110"}),r.createElement("path",{d:"M186.443 293.613H158.92a3.187 3.187 0 0 1-3.187-3.187v-46.134a3.187 3.187 0 0 1 3.187-3.187h27.524a3.187 3.187 0 0 1 3.187 3.187v46.134a3.187 3.187 0 0 1-3.187 3.187",fill:"#F2D7AD"}),r.createElement("path",{d:"M88.979 89.48s7.776 5.384 16.6 2.842",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"})))},500:function(){return r.createElement("svg",{width:"254",height:"294"},r.createElement("defs",null,r.createElement("path",{d:"M0 .335h253.49v253.49H0z"}),r.createElement("path",{d:"M0 293.665h253.49V.401H0z"})),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("g",{transform:"translate(0 .067)"},r.createElement("mask",{fill:"#fff"}),r.createElement("path",{d:"M0 128.134v-2.11C0 56.608 56.273.334 125.69.334h2.11c69.416 0 125.69 56.274 125.69 125.69v2.11c0 69.417-56.274 125.69-125.69 125.69h-2.11C56.273 253.824 0 197.551 0 128.134",fill:"#E4EBF7",mask:"url(#b)"})),r.createElement("path",{d:"M39.989 132.108a8.332 8.332 0 1 1-16.581-1.671 8.332 8.332 0 0 1 16.58 1.671",fill:"#FFF"}),r.createElement("path",{d:"M37.19 135.59l10.553 5.983M48.665 147.884l-12.734 10.861",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{d:"M40.11 160.816a5.706 5.706 0 1 1-11.354-1.145 5.706 5.706 0 0 1 11.354 1.145M57.943 144.6a5.747 5.747 0 1 1-11.436-1.152 5.747 5.747 0 0 1 11.436 1.153M99.656 27.434l30.024-.013a4.619 4.619 0 1 0-.004-9.238l-30.024.013a4.62 4.62 0 0 0 .004 9.238M111.14 45.896l30.023-.013a4.62 4.62 0 1 0-.004-9.238l-30.024.013a4.619 4.619 0 1 0 .004 9.238",fill:"#FFF"}),r.createElement("path",{d:"M113.53 27.421v-.002l15.89-.007a4.619 4.619 0 1 0 .005 9.238l-15.892.007v-.002a4.618 4.618 0 0 0-.004-9.234M150.167 70.091h-3.979a4.789 4.789 0 0 1-4.774-4.775 4.788 4.788 0 0 1 4.774-4.774h3.979a4.789 4.789 0 0 1 4.775 4.774 4.789 4.789 0 0 1-4.775 4.775",fill:"#FFF"}),r.createElement("path",{d:"M171.687 30.234c0-16.392 13.289-29.68 29.681-29.68 16.392 0 29.68 13.288 29.68 29.68 0 16.393-13.288 29.681-29.68 29.681s-29.68-13.288-29.68-29.68",fill:"#FF603B"}),r.createElement("path",{d:"M203.557 19.435l-.676 15.035a1.514 1.514 0 0 1-3.026 0l-.675-15.035a2.19 2.19 0 1 1 4.377 0m-.264 19.378c.513.477.77 1.1.77 1.87s-.257 1.393-.77 1.907c-.55.476-1.21.733-1.943.733a2.545 2.545 0 0 1-1.87-.77c-.55-.514-.806-1.136-.806-1.87 0-.77.256-1.393.806-1.87.513-.513 1.137-.733 1.87-.733.77 0 1.43.22 1.943.733",fill:"#FFF"}),r.createElement("path",{d:"M119.3 133.275c4.426-.598 3.612-1.204 4.079-4.778.675-5.18-3.108-16.935-8.262-25.118-1.088-10.72-12.598-11.24-12.598-11.24s4.312 4.895 4.196 16.199c1.398 5.243.804 14.45.804 14.45s5.255 11.369 11.78 10.487",fill:"#FFB594"}),r.createElement("path",{d:"M100.944 91.61s1.463-.583 3.211.582c8.08 1.398 10.368 6.706 11.3 11.368 1.864 1.282 1.864 2.33 1.864 3.496.365.777 1.515 3.03 1.515 3.03s-7.225 1.748-10.954 6.758c-1.399-6.41-6.936-25.235-6.936-25.235",fill:"#FFF"}),r.createElement("path",{d:"M94.008 90.5l1.019-5.815-9.23-11.874-5.233 5.581-2.593 9.863s8.39 5.128 16.037 2.246",fill:"#FFB594"}),r.createElement("path",{d:"M82.931 78.216s-4.557-2.868-2.445-6.892c1.632-3.107 4.537 1.139 4.537 1.139s.524-3.662 3.139-3.662c.523-1.046 1.569-4.184 1.569-4.184s11.507 2.615 13.6 3.138c-.001 5.23-2.317 19.529-7.884 19.969-8.94.706-12.516-9.508-12.516-9.508",fill:"#FFC6A0"}),r.createElement("path",{d:"M102.971 72.243c2.616-2.093 3.489-9.775 3.489-9.775s-2.492-.492-6.676-2.062c-4.708-2.092-12.867-4.771-17.575.982-9.54 4.41-2.062 19.93-2.062 19.93l2.729-3.037s-3.956-3.304-2.092-6.277c2.183-3.48 3.943 1.08 3.943 1.08s.64-2.4 3.6-3.36c.356-.714 1.04-2.69 1.44-3.872a1.08 1.08 0 0 1 1.27-.707c2.41.56 8.723 2.03 11.417 2.676.524.126.876.619.825 1.156l-.308 3.266z",fill:"#520038"}),r.createElement("path",{d:"M101.22 76.514c-.104.613-.585 1.044-1.076.96-.49-.082-.805-.646-.702-1.26.104-.613.585-1.044 1.076-.961.491.083.805.647.702 1.26M94.26 75.074c-.104.613-.585 1.044-1.076.96-.49-.082-.805-.646-.702-1.26.104-.613.585-1.044 1.076-.96.491.082.805.646.702 1.26",fill:"#552950"}),r.createElement("path",{stroke:"#DB836E",strokeWidth:"1.063",strokeLinecap:"round",strokeLinejoin:"round",d:"M99.206 73.644l-.9 1.62-.3 4.38h-2.24"}),r.createElement("path",{d:"M99.926 73.284s1.8-.72 2.52.54",stroke:"#5C2552",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M81.367 73.084s.48-1.12 1.12-.72c.64.4 1.28 1.44.56 2s.16 1.68.16 1.68",stroke:"#DB836E",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M92.326 71.724s1.84 1.12 4.16.96",stroke:"#5C2552",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M92.726 80.604s2.24 1.2 4.4 1.2M93.686 83.164s.96.4 1.52.32M83.687 80.044s1.786 6.547 9.262 7.954",stroke:"#DB836E",strokeWidth:"1.063",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M95.548 91.663s-1.068 2.821-8.298 2.105c-7.23-.717-10.29-5.044-10.29-5.044",stroke:"#E4EBF7",strokeWidth:"1.136",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M78.126 87.478s6.526 4.972 16.47 2.486c0 0 9.577 1.02 11.536 5.322 5.36 11.77.543 36.835 0 39.962 3.496 4.055-.466 8.483-.466 8.483-15.624-3.548-35.81-.6-35.81-.6-4.849-3.546-1.223-9.044-1.223-9.044L62.38 110.32c-2.485-15.227.833-19.803 3.549-20.743 3.03-1.049 8.04-1.282 8.04-1.282.496-.058 1.08-.076 1.37-.233 2.36-1.282 2.787-.583 2.787-.583",fill:"#FFF"}),r.createElement("path",{d:"M65.828 89.81s-6.875.465-7.59 8.156c-.466 8.857 3.03 10.954 3.03 10.954s6.075 22.102 16.796 22.957c8.39-2.176 4.758-6.702 4.661-11.42-.233-11.304-7.108-16.897-7.108-16.897s-4.212-13.75-9.789-13.75",fill:"#FFC6A0"}),r.createElement("path",{d:"M71.716 124.225s.855 11.264 9.828 6.486c4.765-2.536 7.581-13.828 9.789-22.568 1.456-5.768 2.58-12.197 2.58-12.197l-4.973-1.709s-2.408 5.516-7.769 12.275c-4.335 5.467-9.144 11.11-9.455 17.713",fill:"#FFC6A0"}),r.createElement("path",{d:"M108.463 105.191s1.747 2.724-2.331 30.535c2.376 2.216 1.053 6.012-.233 7.51",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M123.262 131.527s-.427 2.732-11.77 1.981c-15.187-1.006-25.326-3.25-25.326-3.25l.933-5.8s.723.215 9.71-.068c11.887-.373 18.714-6.07 24.964-1.022 4.039 3.263 1.489 8.16 1.489 8.16",fill:"#FFC6A0"}),r.createElement("path",{d:"M70.24 90.974s-5.593-4.739-11.054 2.68c-3.318 7.223.517 15.284 2.664 19.578-.31 3.729 2.33 4.311 2.33 4.311s.108.895 1.516 2.68c4.078-7.03 6.72-9.166 13.711-12.546-.328-.656-1.877-3.265-1.825-3.767.175-1.69-1.282-2.623-1.282-2.623s-.286-.156-1.165-2.738c-.788-2.313-2.036-5.177-4.895-7.575",fill:"#FFF"}),r.createElement("path",{d:"M90.232 288.027s4.855 2.308 8.313 1.155c3.188-1.063 5.12.755 8.002 1.331 2.881.577 7.769 1.243 13.207-1.424-.117-6.228-7.786-4.499-13.518-7.588-2.895-1.56-4.276-5.336-4.066-9.944H91.544s-1.573 11.89-1.312 16.47",fill:"#CBD1D1"}),r.createElement("path",{d:"M90.207 287.833s2.745 1.437 7.639.738c3.456-.494 3.223.66 7.418 1.282 4.195.621 13.092-.194 14.334-1.126.466 1.242-.388 2.33-.388 2.33s-1.709.682-5.438.932c-2.295.154-8.098.276-10.14-.621-2.02-1.554-4.894-1.515-6.06-.234-4.427 1.075-7.184-.31-7.184-.31l-.181-2.991z",fill:"#2B0849"}),r.createElement("path",{d:"M98.429 272.257h3.496s-.117 7.574 5.127 9.671c-5.244.7-9.672-2.602-8.623-9.671",fill:"#A4AABA"}),r.createElement("path",{d:"M44.425 272.046s-2.208 7.774-4.702 12.899c-1.884 3.874-4.428 7.854 5.729 7.854 6.97 0 9.385-.503 7.782-6.917-1.604-6.415.279-13.836.279-13.836h-9.088z",fill:"#CBD1D1"}),r.createElement("path",{d:"M38.066 290.277s2.198 1.225 6.954 1.225c6.376 0 8.646-1.73 8.646-1.73s.63 1.168-.649 2.27c-1.04.897-3.77 1.668-7.745 1.621-4.347-.05-6.115-.593-7.062-1.224-.864-.577-.72-1.657-.144-2.162",fill:"#2B0849"}),r.createElement("path",{d:"M45.344 274.041s.035 1.592-.329 3.07c-.365 1.49-1.13 3.255-1.184 4.34-.061 1.206 4.755 1.657 5.403.036.65-1.622 1.357-6.737 2.006-7.602.648-.865-5.14-2.222-5.896.156",fill:"#A4AABA"}),r.createElement("path",{d:"M89.476 277.57l13.899.095s1.349-56.643 1.925-66.909c.576-10.267 3.923-45.052 1.042-65.585l-13.037-.669-23.737.81s-.452 4.12-1.243 10.365c-.065.515-.708.874-.777 1.417-.078.608.439 1.407.332 2.044-2.455 14.627-5.797 32.736-8.256 46.837-.121.693-1.282 1.048-1.515 2.796-.042.314.22 1.584.116 1.865-7.14 19.473-12.202 52.601-15.66 67.19l15.176-.015s2.282-10.145 4.185-18.871c2.922-13.389 24.012-88.32 24.012-88.32l3.133-.954-.158 48.568s-.233 1.282.35 2.098c.583.815-.581 1.167-.408 2.331l.408 1.864s-.466 7.458-.932 12.352c-.467 4.895 1.145 40.69 1.145 40.69",fill:"#7BB2F9"}),r.createElement("path",{d:"M64.57 218.881c1.197.099 4.195-2.097 7.225-5.127M96.024 222.534s2.881-1.152 6.34-4.034",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M96.973 219.373s2.882-1.153 6.34-4.034",stroke:"#648BD8",strokeWidth:"1.032",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M63.172 222.144s2.724-.614 6.759-3.496M74.903 146.166c-.281 3.226.31 8.856-4.506 9.478M93.182 144.344s.115 14.557-1.344 15.65c-2.305 1.73-3.107 2.02-3.107 2.02M89.197 144.923s.269 13.144-1.01 25.088M83.525 170.71s6.81-1.051 9.116-1.051M46.026 270.045l-.892 4.538M46.937 263.289l-.815 4.157M62.725 202.503c-.33 1.618-.102 1.904-.449 3.438 0 0-2.756 1.903-2.29 3.923.466 2.02-.31 3.424-4.505 17.252-1.762 5.807-4.233 18.922-6.165 28.278-.03.144-.521 2.646-1.14 5.8M64.158 194.136c-.295 1.658-.6 3.31-.917 4.938M71.33 146.787l-1.244 10.877s-1.14.155-.519 2.33c.117 1.399-2.778 16.39-5.382 31.615M44.242 273.727H58.07",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M106.18 142.117c-3.028-.489-18.825-2.744-36.219.2a.625.625 0 0 0-.518.644c.063 1.307.044 2.343.015 2.995a.617.617 0 0 0 .716.636c3.303-.534 17.037-2.412 35.664-.266.347.04.66-.214.692-.56.124-1.347.16-2.425.17-3.029a.616.616 0 0 0-.52-.62",fill:"#192064"}),r.createElement("path",{d:"M96.398 145.264l.003-5.102a.843.843 0 0 0-.809-.847 114.104 114.104 0 0 0-8.141-.014.85.85 0 0 0-.82.847l-.003 5.097c0 .476.388.857.864.845 2.478-.064 5.166-.067 8.03.017a.848.848 0 0 0 .876-.843",fill:"#FFF"}),r.createElement("path",{d:"M95.239 144.296l.002-3.195a.667.667 0 0 0-.643-.672c-1.9-.061-3.941-.073-6.094-.01a.675.675 0 0 0-.654.672l-.002 3.192c0 .376.305.677.68.669 1.859-.042 3.874-.043 6.02.012.376.01.69-.291.691-.668",fill:"#192064"}),r.createElement("path",{d:"M90.102 273.522h12.819M91.216 269.761c.006 3.519-.072 5.55 0 6.292M90.923 263.474c-.009 1.599-.016 2.558-.016 4.505M90.44 170.404l.932 46.38s.7 1.631-.233 2.796c-.932 1.166 2.564.7.932 2.33-1.63 1.633.933 1.166 0 3.497-.618 1.546-1.031 21.921-1.138 36.513",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M73.736 98.665l2.214 4.312s2.098.816 1.865 2.68l.816 2.214M64.297 116.611c.233-.932 2.176-7.147 12.585-10.488M77.598 90.042s7.691 6.137 16.547 2.72",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M91.974 86.954s5.476-.816 7.574-4.545c1.297-.345.72 2.212-.33 3.671-.7.971-1.01 1.554-1.01 1.554s.194.31.155.816c-.053.697-.175.653-.272 1.048-.081.335.108.657 0 1.049-.046.17-.198.5-.382.878-.12.249-.072.687-.2.948-.231.469-1.562 1.87-2.622 2.855-3.826 3.554-5.018 1.644-6.001-.408-.894-1.865-.661-5.127-.874-6.875-.35-2.914-2.622-3.03-1.923-4.429.343-.685 2.87.69 3.263 1.748.757 2.04 2.952 1.807 2.622 1.69",fill:"#FFC6A0"}),r.createElement("path",{d:"M99.8 82.429c-.465.077-.35.272-.97 1.243-.622.971-4.817 2.932-6.39 3.224-2.589.48-2.278-1.56-4.254-2.855-1.69-1.107-3.562-.638-1.398 1.398.99.932.932 1.107 1.398 3.205.335 1.506-.64 3.67.7 5.593",stroke:"#DB836E",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M79.543 108.673c-2.1 2.926-4.266 6.175-5.557 8.762",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M87.72 124.768s-2.098-1.942-5.127-2.719c-3.03-.777-3.574-.155-5.516.078-1.942.233-3.885-.932-3.652.7.233 1.63 5.05 1.01 5.206 2.097.155 1.087-6.37 2.796-8.313 2.175-.777.777.466 1.864 2.02 2.175.233 1.554 2.253 1.554 2.253 1.554s.699 1.01 2.641 1.088c2.486 1.32 8.934-.7 10.954-1.554 2.02-.855-.466-5.594-.466-5.594",fill:"#FFC6A0"}),r.createElement("path",{d:"M73.425 122.826s.66 1.127 3.167 1.418c2.315.27 2.563.583 2.563.583s-2.545 2.894-9.07 2.272M72.416 129.274s3.826.097 4.933-.718M74.98 130.75s1.961.136 3.36-.505M77.232 131.916s1.748.019 2.914-.505M73.328 122.321s-.595-1.032 1.262-.427c1.671.544 2.833.055 5.128.155 1.389.061 3.067-.297 3.982.15 1.606.784 3.632 2.181 3.632 2.181s10.526 1.204 19.033-1.127M78.864 108.104s-8.39 2.758-13.168 12.12",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M109.278 112.533s3.38-3.613 7.575-4.662",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M107.375 123.006s9.697-2.745 11.445-.88",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M194.605 83.656l3.971-3.886M187.166 90.933l3.736-3.655M191.752 84.207l-4.462-4.56M198.453 91.057l-4.133-4.225M129.256 163.074l3.718-3.718M122.291 170.039l3.498-3.498M126.561 163.626l-4.27-4.27M132.975 170.039l-3.955-3.955",stroke:"#BFCDDD",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M190.156 211.779h-1.604a4.023 4.023 0 0 1-4.011-4.011V175.68a4.023 4.023 0 0 1 4.01-4.01h1.605a4.023 4.023 0 0 1 4.011 4.01v32.088a4.023 4.023 0 0 1-4.01 4.01",fill:"#A3B4C6"}),r.createElement("path",{d:"M237.824 212.977a4.813 4.813 0 0 1-4.813 4.813h-86.636a4.813 4.813 0 0 1 0-9.626h86.636a4.813 4.813 0 0 1 4.813 4.813",fill:"#A3B4C6"}),r.createElement("mask",{fill:"#fff"}),r.createElement("path",{fill:"#A3B4C6",mask:"url(#d)",d:"M154.098 190.096h70.513v-84.617h-70.513z"}),r.createElement("path",{d:"M224.928 190.096H153.78a3.219 3.219 0 0 1-3.208-3.209V167.92a3.219 3.219 0 0 1 3.208-3.21h71.148a3.219 3.219 0 0 1 3.209 3.21v18.967a3.219 3.219 0 0 1-3.21 3.209M224.928 130.832H153.78a3.218 3.218 0 0 1-3.208-3.208v-18.968a3.219 3.219 0 0 1 3.208-3.209h71.148a3.219 3.219 0 0 1 3.209 3.21v18.967a3.218 3.218 0 0 1-3.21 3.208",fill:"#BFCDDD",mask:"url(#d)"}),r.createElement("path",{d:"M159.563 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M166.98 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M174.397 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M222.539 120.546h-22.461a.802.802 0 0 1-.802-.802v-3.208c0-.443.359-.803.802-.803h22.46c.444 0 .803.36.803.803v3.208c0 .443-.36.802-.802.802",fill:"#FFF",mask:"url(#d)"}),r.createElement("path",{d:"M224.928 160.464H153.78a3.218 3.218 0 0 1-3.208-3.209v-18.967a3.219 3.219 0 0 1 3.208-3.209h71.148a3.219 3.219 0 0 1 3.209 3.209v18.967a3.218 3.218 0 0 1-3.21 3.209",fill:"#BFCDDD",mask:"url(#d)"}),r.createElement("path",{d:"M173.455 130.832h49.301M164.984 130.832h6.089M155.952 130.832h6.75M173.837 160.613h49.3M165.365 160.613h6.089M155.57 160.613h6.751",stroke:"#7C90A5",strokeWidth:"1.124",strokeLinecap:"round",strokeLinejoin:"round",mask:"url(#d)"}),r.createElement("path",{d:"M159.563 151.038a2.407 2.407 0 1 1 0-4.814 2.407 2.407 0 0 1 0 4.814M166.98 151.038a2.407 2.407 0 1 1 0-4.814 2.407 2.407 0 0 1 0 4.814M174.397 151.038a2.407 2.407 0 1 1 .001-4.814 2.407 2.407 0 0 1 0 4.814M222.539 151.038h-22.461a.802.802 0 0 1-.802-.802v-3.209c0-.443.359-.802.802-.802h22.46c.444 0 .803.36.803.802v3.209c0 .443-.36.802-.802.802M159.563 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M166.98 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M174.397 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M222.539 179.987h-22.461a.802.802 0 0 1-.802-.802v-3.209c0-.443.359-.802.802-.802h22.46c.444 0 .803.36.803.802v3.209c0 .443-.36.802-.802.802",fill:"#FFF",mask:"url(#d)"}),r.createElement("path",{d:"M203.04 221.108h-27.372a2.413 2.413 0 0 1-2.406-2.407v-11.448a2.414 2.414 0 0 1 2.406-2.407h27.372a2.414 2.414 0 0 1 2.407 2.407V218.7a2.413 2.413 0 0 1-2.407 2.407",fill:"#BFCDDD",mask:"url(#d)"}),r.createElement("path",{d:"M177.259 207.217v11.52M201.05 207.217v11.52",stroke:"#A3B4C6",strokeWidth:"1.124",strokeLinecap:"round",strokeLinejoin:"round",mask:"url(#d)"}),r.createElement("path",{d:"M162.873 267.894a9.422 9.422 0 0 1-9.422-9.422v-14.82a9.423 9.423 0 0 1 18.845 0v14.82a9.423 9.423 0 0 1-9.423 9.422",fill:"#5BA02E",mask:"url(#d)"}),r.createElement("path",{d:"M171.22 267.83a9.422 9.422 0 0 1-9.422-9.423v-3.438a9.423 9.423 0 0 1 18.845 0v3.438a9.423 9.423 0 0 1-9.422 9.423",fill:"#92C110",mask:"url(#d)"}),r.createElement("path",{d:"M181.31 293.666h-27.712a3.209 3.209 0 0 1-3.209-3.21V269.79a3.209 3.209 0 0 1 3.209-3.21h27.711a3.209 3.209 0 0 1 3.209 3.21v20.668a3.209 3.209 0 0 1-3.209 3.209",fill:"#F2D7AD",mask:"url(#d)"})))},403:function(){return r.createElement("svg",{width:"251",height:"294"},r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M0 129.023v-2.084C0 58.364 55.591 2.774 124.165 2.774h2.085c68.574 0 124.165 55.59 124.165 124.165v2.084c0 68.575-55.59 124.166-124.165 124.166h-2.085C55.591 253.189 0 197.598 0 129.023",fill:"#E4EBF7"}),r.createElement("path",{d:"M41.417 132.92a8.231 8.231 0 1 1-16.38-1.65 8.231 8.231 0 0 1 16.38 1.65",fill:"#FFF"}),r.createElement("path",{d:"M38.652 136.36l10.425 5.91M49.989 148.505l-12.58 10.73",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{d:"M41.536 161.28a5.636 5.636 0 1 1-11.216-1.13 5.636 5.636 0 0 1 11.216 1.13M59.154 145.261a5.677 5.677 0 1 1-11.297-1.138 5.677 5.677 0 0 1 11.297 1.138M100.36 29.516l29.66-.013a4.562 4.562 0 1 0-.004-9.126l-29.66.013a4.563 4.563 0 0 0 .005 9.126M111.705 47.754l29.659-.013a4.563 4.563 0 1 0-.004-9.126l-29.66.013a4.563 4.563 0 1 0 .005 9.126",fill:"#FFF"}),r.createElement("path",{d:"M114.066 29.503V29.5l15.698-.007a4.563 4.563 0 1 0 .004 9.126l-15.698.007v-.002a4.562 4.562 0 0 0-.004-9.122M185.405 137.723c-.55 5.455-5.418 9.432-10.873 8.882-5.456-.55-9.432-5.418-8.882-10.873.55-5.455 5.418-9.432 10.873-8.882 5.455.55 9.432 5.418 8.882 10.873",fill:"#FFF"}),r.createElement("path",{d:"M180.17 143.772l12.572 7.129M193.841 158.42L178.67 171.36",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{d:"M185.55 171.926a6.798 6.798 0 1 1-13.528-1.363 6.798 6.798 0 0 1 13.527 1.363M204.12 155.285a6.848 6.848 0 1 1-13.627-1.375 6.848 6.848 0 0 1 13.626 1.375",fill:"#FFF"}),r.createElement("path",{d:"M152.988 194.074a2.21 2.21 0 1 1-4.42 0 2.21 2.21 0 0 1 4.42 0zM225.931 118.217a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.421 0zM217.09 153.051a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.42 0zM177.84 109.842a2.21 2.21 0 1 1-4.422 0 2.21 2.21 0 0 1 4.421 0zM196.114 94.454a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.421 0zM202.844 182.523a2.21 2.21 0 1 1-4.42 0 2.21 2.21 0 0 1 4.42 0z",stroke:"#FFF",strokeWidth:"2"}),r.createElement("path",{stroke:"#FFF",strokeWidth:"2",d:"M215.125 155.262l-1.902 20.075-10.87 5.958M174.601 176.636l-6.322 9.761H156.98l-4.484 6.449M175.874 127.28V111.56M221.51 119.404l-12.77 7.859-15.228-7.86V96.668"}),r.createElement("path",{d:"M180.68 29.32C180.68 13.128 193.806 0 210 0c16.193 0 29.32 13.127 29.32 29.32 0 16.194-13.127 29.322-29.32 29.322-16.193 0-29.32-13.128-29.32-29.321",fill:"#A26EF4"}),r.createElement("path",{d:"M221.45 41.706l-21.563-.125a1.744 1.744 0 0 1-1.734-1.754l.071-12.23a1.744 1.744 0 0 1 1.754-1.734l21.562.125c.964.006 1.74.791 1.735 1.755l-.071 12.229a1.744 1.744 0 0 1-1.754 1.734",fill:"#FFF"}),r.createElement("path",{d:"M215.106 29.192c-.015 2.577-2.049 4.654-4.543 4.64-2.494-.014-4.504-2.115-4.489-4.693l.04-6.925c.016-2.577 2.05-4.654 4.543-4.64 2.494.015 4.504 2.116 4.49 4.693l-.04 6.925zm-4.53-14.074a6.877 6.877 0 0 0-6.916 6.837l-.043 7.368a6.877 6.877 0 0 0 13.754.08l.042-7.368a6.878 6.878 0 0 0-6.837-6.917zM167.566 68.367h-3.93a4.73 4.73 0 0 1-4.717-4.717 4.73 4.73 0 0 1 4.717-4.717h3.93a4.73 4.73 0 0 1 4.717 4.717 4.73 4.73 0 0 1-4.717 4.717",fill:"#FFF"}),r.createElement("path",{d:"M168.214 248.838a6.611 6.611 0 0 1-6.61-6.611v-66.108a6.611 6.611 0 0 1 13.221 0v66.108a6.611 6.611 0 0 1-6.61 6.61",fill:"#5BA02E"}),r.createElement("path",{d:"M176.147 248.176a6.611 6.611 0 0 1-6.61-6.61v-33.054a6.611 6.611 0 1 1 13.221 0v33.053a6.611 6.611 0 0 1-6.61 6.611",fill:"#92C110"}),r.createElement("path",{d:"M185.994 293.89h-27.376a3.17 3.17 0 0 1-3.17-3.17v-45.887a3.17 3.17 0 0 1 3.17-3.17h27.376a3.17 3.17 0 0 1 3.17 3.17v45.886a3.17 3.17 0 0 1-3.17 3.17",fill:"#F2D7AD"}),r.createElement("path",{d:"M81.972 147.673s6.377-.927 17.566-1.28c11.729-.371 17.57 1.086 17.57 1.086s3.697-3.855.968-8.424c1.278-12.077 5.982-32.827.335-48.273-1.116-1.339-3.743-1.512-7.536-.62-1.337.315-7.147-.149-7.983-.1l-15.311-.347s-3.487-.17-8.035-.508c-1.512-.113-4.227-1.683-5.458-.338-.406.443-2.425 5.669-1.97 16.077l8.635 35.642s-3.141 3.61 1.219 7.085",fill:"#FFF"}),r.createElement("path",{d:"M75.768 73.325l-.9-6.397 11.982-6.52s7.302-.118 8.038 1.205c.737 1.324-5.616.993-5.616.993s-1.836 1.388-2.615 2.5c-1.654 2.363-.986 6.471-8.318 5.986-1.708.284-2.57 2.233-2.57 2.233",fill:"#FFC6A0"}),r.createElement("path",{d:"M52.44 77.672s14.217 9.406 24.973 14.444c1.061.497-2.094 16.183-11.892 11.811-7.436-3.318-20.162-8.44-21.482-14.496-.71-3.258 2.543-7.643 8.401-11.76M141.862 80.113s-6.693 2.999-13.844 6.876c-3.894 2.11-10.137 4.704-12.33 7.988-6.224 9.314 3.536 11.22 12.947 7.503 6.71-2.651 28.999-12.127 13.227-22.367",fill:"#FFB594"}),r.createElement("path",{d:"M76.166 66.36l3.06 3.881s-2.783 2.67-6.31 5.747c-7.103 6.195-12.803 14.296-15.995 16.44-3.966 2.662-9.754 3.314-12.177-.118-3.553-5.032.464-14.628 31.422-25.95",fill:"#FFC6A0"}),r.createElement("path",{d:"M64.674 85.116s-2.34 8.413-8.912 14.447c.652.548 18.586 10.51 22.144 10.056 5.238-.669 6.417-18.968 1.145-20.531-.702-.208-5.901-1.286-8.853-2.167-.87-.26-1.611-1.71-3.545-.936l-1.98-.869zM128.362 85.826s5.318 1.956 7.325 13.734c-.546.274-17.55 12.35-21.829 7.805-6.534-6.94-.766-17.393 4.275-18.61 4.646-1.121 5.03-1.37 10.23-2.929",fill:"#FFF"}),r.createElement("path",{d:"M78.18 94.656s.911 7.41-4.914 13.078",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M87.397 94.68s3.124 2.572 10.263 2.572c7.14 0 9.074-3.437 9.074-3.437",stroke:"#E4EBF7",strokeWidth:".932",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M117.184 68.639l-6.781-6.177s-5.355-4.314-9.223-.893c-3.867 3.422 4.463 2.083 5.653 4.165 1.19 2.082.848 1.143-2.083.446-5.603-1.331-2.082.893 2.975 5.355 2.091 1.845 6.992.955 6.992.955l2.467-3.851z",fill:"#FFC6A0"}),r.createElement("path",{d:"M105.282 91.315l-.297-10.937-15.918-.027-.53 10.45c-.026.403.17.788.515.999 2.049 1.251 9.387 5.093 15.799.424.287-.21.443-.554.431-.91",fill:"#FFB594"}),r.createElement("path",{d:"M107.573 74.24c.817-1.147.982-9.118 1.015-11.928a1.046 1.046 0 0 0-.965-1.055l-4.62-.365c-7.71-1.044-17.071.624-18.253 6.346-5.482 5.813-.421 13.244-.421 13.244s1.963 3.566 4.305 6.791c.756 1.041.398-3.731 3.04-5.929 5.524-4.594 15.899-7.103 15.899-7.103",fill:"#5C2552"}),r.createElement("path",{d:"M88.426 83.206s2.685 6.202 11.602 6.522c7.82.28 8.973-7.008 7.434-17.505l-.909-5.483c-6.118-2.897-15.478.54-15.478.54s-.576 2.044-.19 5.504c-2.276 2.066-1.824 5.618-1.824 5.618s-.905-1.922-1.98-2.321c-.86-.32-1.897.089-2.322 1.98-1.04 4.632 3.667 5.145 3.667 5.145",fill:"#FFC6A0"}),r.createElement("path",{stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round",d:"M100.843 77.099l1.701-.928-1.015-4.324.674-1.406"}),r.createElement("path",{d:"M105.546 74.092c-.022.713-.452 1.279-.96 1.263-.51-.016-.904-.607-.882-1.32.021-.713.452-1.278.96-1.263.51.016.904.607.882 1.32M97.592 74.349c-.022.713-.452 1.278-.961 1.263-.509-.016-.904-.607-.882-1.32.022-.713.452-1.279.961-1.263.51.016.904.606.882 1.32",fill:"#552950"}),r.createElement("path",{d:"M91.132 86.786s5.269 4.957 12.679 2.327",stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M99.776 81.903s-3.592.232-1.44-2.79c1.59-1.496 4.897-.46 4.897-.46s1.156 3.906-3.457 3.25",fill:"#DB836E"}),r.createElement("path",{d:"M102.88 70.6s2.483.84 3.402.715M93.883 71.975s2.492-1.144 4.778-1.073",stroke:"#5C2552",strokeWidth:"1.526",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M86.32 77.374s.961.879 1.458 2.106c-.377.48-1.033 1.152-.236 1.809M99.337 83.719s1.911.151 2.509-.254",stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M87.782 115.821l15.73-3.012M100.165 115.821l10.04-2.008",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M66.508 86.763s-1.598 8.83-6.697 14.078",stroke:"#E4EBF7",strokeWidth:"1.114",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M128.31 87.934s3.013 4.121 4.06 11.785",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M64.09 84.816s-6.03 9.912-13.607 9.903",stroke:"#DB836E",strokeWidth:".795",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M112.366 65.909l-.142 5.32s5.993 4.472 11.945 9.202c4.482 3.562 8.888 7.455 10.985 8.662 4.804 2.766 8.9 3.355 11.076 1.808 4.071-2.894 4.373-9.878-8.136-15.263-4.271-1.838-16.144-6.36-25.728-9.73",fill:"#FFC6A0"}),r.createElement("path",{d:"M130.532 85.488s4.588 5.757 11.619 6.214",stroke:"#DB836E",strokeWidth:".75",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M121.708 105.73s-.393 8.564-1.34 13.612",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M115.784 161.512s-3.57-1.488-2.678-7.14",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M101.52 290.246s4.326 2.057 7.408 1.03c2.842-.948 4.564.673 7.132 1.186 2.57.514 6.925 1.108 11.772-1.269-.104-5.551-6.939-4.01-12.048-6.763-2.582-1.39-3.812-4.757-3.625-8.863h-9.471s-1.402 10.596-1.169 14.68",fill:"#CBD1D1"}),r.createElement("path",{d:"M101.496 290.073s2.447 1.281 6.809.658c3.081-.44 3.74.485 7.479 1.039 3.739.554 10.802-.07 11.91-.9.415 1.108-.347 2.077-.347 2.077s-1.523.608-4.847.831c-2.045.137-5.843.293-7.663-.507-1.8-1.385-5.286-1.917-5.77-.243-3.947.958-7.41-.288-7.41-.288l-.16-2.667z",fill:"#2B0849"}),r.createElement("path",{d:"M108.824 276.19h3.116s-.103 6.751 4.57 8.62c-4.673.624-8.62-2.32-7.686-8.62",fill:"#A4AABA"}),r.createElement("path",{d:"M57.65 272.52s-2.122 7.47-4.518 12.396c-1.811 3.724-4.255 7.548 5.505 7.548 6.698 0 9.02-.483 7.479-6.648-1.541-6.164.268-13.296.268-13.296H57.65z",fill:"#CBD1D1"}),r.createElement("path",{d:"M51.54 290.04s2.111 1.178 6.682 1.178c6.128 0 8.31-1.662 8.31-1.662s.605 1.122-.624 2.18c-1 .862-3.624 1.603-7.444 1.559-4.177-.049-5.876-.57-6.786-1.177-.831-.554-.692-1.593-.138-2.078",fill:"#2B0849"}),r.createElement("path",{d:"M58.533 274.438s.034 1.529-.315 2.95c-.352 1.431-1.087 3.127-1.139 4.17-.058 1.16 4.57 1.592 5.194.035.623-1.559 1.303-6.475 1.927-7.306.622-.831-4.94-2.135-5.667.15",fill:"#A4AABA"}),r.createElement("path",{d:"M100.885 277.015l13.306.092s1.291-54.228 1.843-64.056c.552-9.828 3.756-43.13.997-62.788l-12.48-.64-22.725.776s-.433 3.944-1.19 9.921c-.062.493-.677.838-.744 1.358-.075.582.42 1.347.318 1.956-2.35 14.003-6.343 32.926-8.697 46.425-.116.663-1.227 1.004-1.45 2.677-.04.3.21 1.516.112 1.785-6.836 18.643-10.89 47.584-14.2 61.551l14.528-.014s2.185-8.524 4.008-16.878c2.796-12.817 22.987-84.553 22.987-84.553l3-.517 1.037 46.1s-.223 1.228.334 2.008c.558.782-.556 1.117-.39 2.233l.39 1.784s-.446 7.14-.892 11.826c-.446 4.685-.092 38.954-.092 38.954",fill:"#7BB2F9"}),r.createElement("path",{d:"M77.438 220.434c1.146.094 4.016-2.008 6.916-4.91M107.55 223.931s2.758-1.103 6.069-3.862",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M108.459 220.905s2.759-1.104 6.07-3.863",stroke:"#648BD8",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M76.099 223.557s2.608-.587 6.47-3.346M87.33 150.82c-.27 3.088.297 8.478-4.315 9.073M104.829 149.075s.11 13.936-1.286 14.983c-2.207 1.655-2.975 1.934-2.975 1.934M101.014 149.63s.035 12.81-1.19 24.245M94.93 174.965s7.174-1.655 9.38-1.655M75.671 204.754c-.316 1.55-.64 3.067-.973 4.535 0 0-1.45 1.822-1.003 3.756.446 1.934-.943 2.034-4.96 15.273-1.686 5.559-4.464 18.49-6.313 27.447-.078.38-4.018 18.06-4.093 18.423M77.043 196.743a313.269 313.269 0 0 1-.877 4.729M83.908 151.414l-1.19 10.413s-1.091.148-.496 2.23c.111 1.34-2.66 15.692-5.153 30.267M57.58 272.94h13.238",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M117.377 147.423s-16.955-3.087-35.7.199c.157 2.501-.002 4.128-.002 4.128s14.607-2.802 35.476-.31c.251-2.342.226-4.017.226-4.017",fill:"#192064"}),r.createElement("path",{d:"M107.511 150.353l.004-4.885a.807.807 0 0 0-.774-.81c-2.428-.092-5.04-.108-7.795-.014a.814.814 0 0 0-.784.81l-.003 4.88c0 .456.371.82.827.808a140.76 140.76 0 0 1 7.688.017.81.81 0 0 0 .837-.806",fill:"#FFF"}),r.createElement("path",{d:"M106.402 149.426l.002-3.06a.64.64 0 0 0-.616-.643 94.135 94.135 0 0 0-5.834-.009.647.647 0 0 0-.626.643l-.001 3.056c0 .36.291.648.651.64 1.78-.04 3.708-.041 5.762.012.36.009.662-.279.662-.64",fill:"#192064"}),r.createElement("path",{d:"M101.485 273.933h12.272M102.652 269.075c.006 3.368.04 5.759.11 6.47M102.667 263.125c-.009 1.53-.015 2.98-.016 4.313M102.204 174.024l.893 44.402s.669 1.561-.224 2.677c-.892 1.116 2.455.67.893 2.231-1.562 1.562.893 1.116 0 3.347-.592 1.48-.988 20.987-1.09 34.956",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"})))}},l=Object.keys(c),d=function(e){return r.createElement(a.C,null,(function(t){var n=t.getPrefixCls,i=e.prefixCls,a=e.className,d=e.subTitle,f=e.title,p=e.style,h=e.children,v=e.status,m=n("result",i),y=o()(m,"".concat(m,"-").concat(v),a);return r.createElement("div",{className:y,style:p},function(e,t){var n=t.status,i=t.icon,a=o()("".concat(e,"-icon"));if(l.includes("".concat(n))){var d=c[n];return r.createElement("div",{className:"".concat(a," ").concat(e,"-image")},r.createElement(d,null))}var f=u[n],p=i||r.createElement(s.Z,{type:f,theme:"filled"});return r.createElement("div",{className:a},p)}(m,e),r.createElement("div",{className:"".concat(m,"-title")},f),d&&r.createElement("div",{className:"".concat(m,"-subtitle")},d),h&&r.createElement("div",{className:"".concat(m,"-content")},h),function(e,t){var n=t.extra;return n&&r.createElement("div",{className:"".concat(e,"-extra")},n)}(m,e))}))};d.defaultProps={status:"info"},d.PRESENTED_IMAGE_403=c[403],d.PRESENTED_IMAGE_404=c[404],d.PRESENTED_IMAGE_500=c[500];var f=d},83924:function(e,t,n){"use strict";n.d(t,{Z:function(){return ge}});var r=n(5954),i=n(19295),o=n.n(i),a=n(7815),s=n(89395);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){"function"==typeof e?e(t):"object"===u(e)&&e&&"current"in e&&(e.current=t)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}var y,g=function(e,t){var n=e.prefixCls,i=e.component,u=void 0===i?"article":i,l=e.className,d=e["aria-label"],f=e.setContentRef,p=e.children,h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["prefixCls","component","className","aria-label","setContentRef","children"]),v=t;return f&&((0,s.Z)(!1,"Typography","`setContentRef` is deprecated. Please use `ref` instead."),v=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){c(t,e)}))}}(t,f)),r.createElement(a.C,null,(function(e){var t=e.getPrefixCls,i=u,a=t("typography",n);return r.createElement(i,m({className:o()(a,l),"aria-label":d,ref:v},h),p)}))};if(r.forwardRef)(y=r.forwardRef(g)).displayName="Typography";else{var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(s,e);var t,n,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(i);if(o){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function s(){var e;return d(this,s),(e=a.apply(this,arguments)).state={},e}return t=s,(n=[{key:"render",value:function(){return r.createElement(g,this.props)}}])&&f(t.prototype,n),s}(r.Component);y=b}var x=y,_=n(94286),w=n(11526),M=n(60493),S=n(97556),T=n.n(S),E=n(31009),k=n(58291),A=n.n(k),P=n(27842),C=n(45656),O=n(12770),I=n(24837),R=n(3677),N=n(18777),D=n(71526),L=n(95516),B=n(3166);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},U(e,t)}function G(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(c,e);var t,n,i,a,s,u=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=V(a);if(s){var n=V(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return G(this,e)});function c(){var e;return j(this,c),(e=u.apply(this,arguments)).inComposition=!1,e.state={current:""},e.onChange=function(t){var n=t.target.value;e.setState({current:n.replace(/[\r\n]/g,"")})},e.onCompositionStart=function(){e.inComposition=!0},e.onCompositionEnd=function(){e.inComposition=!1},e.onKeyDown=function(t){var n=t.keyCode;e.inComposition||(e.lastKeyCode=n)},e.onKeyUp=function(t){var n=t.keyCode,r=t.ctrlKey,i=t.altKey,o=t.metaKey,a=t.shiftKey,s=e.props.onCancel;e.lastKeyCode!==n||e.inComposition||r||i||o||a||(n===L.Z.ENTER?e.confirmChange():n===L.Z.ESC&&s())},e.onBlur=function(){e.confirmChange()},e.confirmChange=function(){var t=e.state.current;(0,e.props.onSave)(t.trim())},e.setTextarea=function(t){e.textarea=t},e}return t=c,i=[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.prevValue,r=e.value,i={prevValue:r};return n!==r&&(i.current=r),i}}],(n=[{key:"componentDidMount",value:function(){if(this.textarea&&this.textarea.resizableTextArea){var e=this.textarea.resizableTextArea.textArea;e.focus();var t=e.value.length;e.setSelectionRange(t,t)}}},{key:"render",value:function(){var e=this.state.current,t=this.props,n=t.prefixCls,i=t["aria-label"],a=t.className,s=t.style;return r.createElement("div",{className:o()(n,"".concat(n,"-edit-content"),a),style:s},r.createElement(B.Z,{ref:this.setTextarea,value:e,onChange:this.onChange,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onBlur:this.onBlur,"aria-label":i,autoSize:!0}),r.createElement(N.Z,{type:"enter",className:"".concat(n,"-edit-content-confirm")}))}}])&&z(t.prototype,n),i&&z(t,i),c}(r.Component);(0,_.polyfill)(W);var H,Z=W,q={padding:0,margin:0,display:"inline",lineHeight:"inherit"};function Y(e){if(!e)return 0;var t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}var X=function(e,t,n,i,o){H||((H=document.createElement("div")).setAttribute("aria-hidden","true"),document.body.appendChild(H));var a,s=window.getComputedStyle(e),u=(a=s,Array.prototype.slice.apply(a).map((function(e){return"".concat(e,": ").concat(a.getPropertyValue(e),";")})).join("")),c=Y(s.lineHeight)*(t+1)+Y(s.paddingTop)+Y(s.paddingBottom);H.setAttribute("style",u),H.style.position="fixed",H.style.left="0",H.style.height="auto",H.style.minHeight="auto",H.style.maxHeight="auto",H.style.top="-999999px",H.style.zIndex="-1000",H.style.textOverflow="clip",H.style.whiteSpace="normal",H.style.webkitLineClamp="none";var l,d,f=(l=(0,w.Z)(n),d=[],l.forEach((function(e){var t=d[d.length-1];"string"==typeof e&&"string"==typeof t?d[d.length-1]+=e:d.push(e)})),d);function p(){return H.offsetHeight<c}if((0,M.render)(r.createElement("div",{style:q},r.createElement("span",{style:q},f),r.createElement("span",{style:q},i)),H),p())return(0,M.unmountComponentAtNode)(H),{content:n,text:H.innerHTML,ellipsis:!1};var h=Array.prototype.slice.apply(H.childNodes[0].childNodes[0].cloneNode(!0).childNodes).filter((function(e){return 8!==e.nodeType})),v=Array.prototype.slice.apply(H.childNodes[0].childNodes[1].cloneNode(!0).childNodes);(0,M.unmountComponentAtNode)(H);var m=[];H.innerHTML="";var y=document.createElement("span");H.appendChild(y);var g=document.createTextNode(o);function b(e){y.insertBefore(e,g)}function x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=Math.floor((n+r)/2),a=t.slice(0,o);if(e.textContent=a,n>=r-1)for(var s=r;s>=n;s-=1){var u=t.slice(0,s);if(e.textContent=u,p())return s===t.length?{finished:!1,reactNode:t}:{finished:!0,reactNode:u}}return p()?x(e,t,o,r,o):x(e,t,n,o,i)}function _(e,t){var n=e.nodeType;if(1===n)return b(e),p()?{finished:!1,reactNode:f[t]}:(y.removeChild(e),{finished:!0,reactNode:null});if(3===n){var r=e.textContent||"",i=document.createTextNode(r);return b(i),x(i,r)}return{finished:!1,reactNode:null}}return y.appendChild(g),v.forEach((function(e){H.appendChild(e)})),h.some((function(e,t){var n=_(e,t),r=n.finished,i=n.reactNode;return i&&m.push(i),r})),{content:m,text:H.innerHTML,ellipsis:!0}};function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function $(){return $=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$.apply(this,arguments)}function ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ne(e,t){return ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ne(e,t)}function re(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}var oe=(0,R.Z)("webkitLineClamp"),ae=(0,R.Z)("textOverflow"),se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(l,e);var t,n,i,a,u,c=(a=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ie(a);if(u){var n=ie(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return re(this,e)});function l(){var e;return ee(this,l),(e=c.apply(this,arguments)).state={edit:!1,copied:!1,ellipsisText:"",ellipsisContent:null,isEllipsis:!1,expanded:!1,clientRendered:!1},e.onExpandClick=function(){var t=e.getEllipsis().onExpand;e.setState({expanded:!0}),t&&t()},e.onEditClick=function(){e.triggerEdit(!0)},e.onEditChange=function(t){var n=e.getEditable().onChange;n&&n(t),e.triggerEdit(!1)},e.onEditCancel=function(){e.triggerEdit(!1)},e.onCopyClick=function(){var t=e.props,n=t.children,r=t.copyable,i=$({},"object"===Q(r)?r:null);void 0===i.text&&(i.text=String(n)),T()(i.text||""),e.setState({copied:!0},(function(){i.onCopy&&i.onCopy(),e.copyId=window.setTimeout((function(){e.setState({copied:!1})}),3e3)}))},e.setContentRef=function(t){e.content=t},e.setEditRef=function(t){e.editIcon=t},e.triggerEdit=function(t){var n=e.getEditable().onStart;t&&n&&n(),e.setState({edit:t},(function(){!t&&e.editIcon&&e.editIcon.focus()}))},e.resizeOnNextFrame=function(){I.Z.cancel(e.rafId),e.rafId=(0,I.Z)((function(){e.syncEllipsis()}))},e}return t=l,n=[{key:"componentDidMount",value:function(){this.setState({clientRendered:!0}),this.resizeOnNextFrame()}},{key:"componentDidUpdate",value:function(e){var t=this.props.children,n=this.getEllipsis(),r=this.getEllipsis(e);t===e.children&&n.rows===r.rows||this.resizeOnNextFrame()}},{key:"componentWillUnmount",value:function(){window.clearTimeout(this.copyId),I.Z.cancel(this.rafId)}},{key:"getEditable",value:function(e){var t=this.state.edit,n=(e||this.props).editable;return n?$({editing:t},"object"===Q(n)?n:null):{editing:t}}},{key:"getEllipsis",value:function(e){var t=(e||this.props).ellipsis;return t?$({rows:1,expandable:!1},"object"===Q(t)?t:null):{}}},{key:"canUseCSSEllipsis",value:function(){var e=this.state.clientRendered,t=this.props,n=t.editable,r=t.copyable,i=this.getEllipsis(),o=i.rows,a=i.expandable;return!(n||r||a||!e)&&(1===o?ae:oe)}},{key:"syncEllipsis",value:function(){var e=this.state,t=e.ellipsisText,n=e.isEllipsis,r=e.expanded,i=this.getEllipsis().rows,o=this.props.children;if(i&&!(i<0)&&this.content&&!r&&!this.canUseCSSEllipsis()){(0,s.Z)((0,w.Z)(o).every((function(e){return"string"==typeof e})),"Typography","`ellipsis` should use string as children only.");var a,u=X((a=this.content)instanceof HTMLElement?a:M.default.findDOMNode(a),i,o,this.renderOperations(!0),"..."),c=u.content,l=u.text,d=u.ellipsis;t===l&&n===d||this.setState({ellipsisText:l,ellipsisContent:c,isEllipsis:d})}}},{key:"renderExpand",value:function(e){var t=this.getEllipsis().expandable,n=this.props.prefixCls,i=this.state,o=i.expanded,a=i.isEllipsis;return t&&(e||!o&&a)?r.createElement("a",{key:"expand",className:"".concat(n,"-expand"),onClick:this.onExpandClick,"aria-label":this.expandStr},this.expandStr):null}},{key:"renderEdit",value:function(){var e=this.props,t=e.editable,n=e.prefixCls;if(t)return r.createElement(D.Z,{key:"edit",title:this.editStr},r.createElement(O.Z,{ref:this.setEditRef,className:"".concat(n,"-edit"),onClick:this.onEditClick,"aria-label":this.editStr},r.createElement(N.Z,{role:"button",type:"edit"})))}},{key:"renderCopy",value:function(){var e=this.state.copied,t=this.props,n=t.copyable,i=t.prefixCls;if(n){var a=e?this.copiedStr:this.copyStr;return r.createElement(D.Z,{key:"copy",title:a},r.createElement(O.Z,{className:o()("".concat(i,"-copy"),e&&"".concat(i,"-copy-success")),onClick:this.onCopyClick,"aria-label":a},r.createElement(N.Z,{role:"button",type:e?"check":"copy"})))}}},{key:"renderEditInput",value:function(){var e=this.props,t=e.children,n=e.prefixCls,i=e.className,o=e.style;return r.createElement(Z,{value:"string"==typeof t?t:"",onSave:this.onEditChange,onCancel:this.onEditCancel,prefixCls:n,className:i,style:o})}},{key:"renderOperations",value:function(e){return[this.renderExpand(e),this.renderEdit(),this.renderCopy()].filter((function(e){return e}))}},{key:"renderContent",value:function(){var e,t=this,n=this.state,i=n.ellipsisContent,a=n.isEllipsis,s=n.expanded,u=this.props,c=u.component,l=u.children,d=u.className,f=u.prefixCls,p=u.type,h=u.disabled,v=u.style,m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(u,["component","children","className","prefixCls","type","disabled","style"]),y=this.getEllipsis().rows,g=(0,E.default)(m,["prefixCls","editable","copyable","ellipsis","mark","underline","mark","code","delete","underline","strong"].concat(function(e){if(Array.isArray(e))return J(e)}(e=P.nf)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),b=this.canUseCSSEllipsis(),_=1===y&&b,w=y&&y>1&&b,M=l,S=null;return y&&a&&!s&&!b&&(S=String(l),M=r.createElement("span",{title:String(l),"aria-hidden":"true"},i,"...")),M=function(e,t){var n=e.mark,i=e.code,o=e.underline,a=e.delete,s=e.strong,u=t;function c(e,t){e&&(u=r.createElement(t,{},u))}return c(s,"strong"),c(o,"u"),c(a,"del"),c(i,"code"),c(n,"mark"),u}(this.props,M),r.createElement(C.Z,{componentName:"Text"},(function(e){var n,i=e.edit,a=e.copy,s=e.copied,u=e.expand;return t.editStr=i,t.copyStr=a,t.copiedStr=s,t.expandStr=u,r.createElement(A(),{onResize:t.resizeOnNextFrame,disabled:!y},r.createElement(x,$({className:o()(d,(n={},K(n,"".concat(f,"-").concat(p),p),K(n,"".concat(f,"-disabled"),h),K(n,"".concat(f,"-ellipsis"),y),K(n,"".concat(f,"-ellipsis-single-line"),_),K(n,"".concat(f,"-ellipsis-multiple-line"),w),n)),style:$($({},v),{WebkitLineClamp:w?y:null}),component:c,ref:t.setContentRef,"aria-label":S},g),M,t.renderOperations()))}))}},{key:"render",value:function(){return this.getEditable().editing?this.renderEditInput():this.renderContent()}}],i=[{key:"getDerivedStateFromProps",value:function(e){var t=e.children,n=e.editable;return(0,s.Z)(!n||"string"==typeof t,"Typography","When `editable` is enabled, the `children` should use string."),{}}}],n&&te(t.prototype,n),i&&te(t,i),l}(r.Component);se.defaultProps={children:""},(0,_.polyfill)(se);var ue=(0,a.PG)({prefixCls:"typography"})(se);function ce(){return ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ce.apply(this,arguments)}function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}var de=n(1524),fe=n.n(de),pe=n(52312);function he(){return he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},he.apply(this,arguments)}var ve=(0,pe.a)(1,2,3,4);function me(){return me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},me.apply(this,arguments)}var ye=x;ye.Text=function(e){var t=e.ellipsis,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["ellipsis"]);return(0,s.Z)("object"!==le(t),"Typography.Text","`ellipsis` only supports boolean value."),r.createElement(ue,ce({},n,{ellipsis:!!t,component:"span"}))},ye.Title=function(e){var t,n=e.level,i=void 0===n?1:n,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["level"]);return-1!==ve.indexOf(i)?t="h".concat(i):(fe()(!1,"Title only accept `1 | 2 | 3 | 4` as `level` value."),t="h1"),r.createElement(ue,he({},o,{component:t}))},ye.Paragraph=function(e){return r.createElement(ue,me({},e,{component:"div"}))};var ge=ye},29260:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}var o;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.responsiveMap=t.responsiveArray=void 0,"undefined"!=typeof window&&(window.matchMedia||(window.matchMedia=function(e){return{media:e,matches:!1,addListener:function(){},removeListener:function(){}}}),o=n(57606)),t.responsiveArray=["xxl","xl","lg","md","sm","xs"];var a={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"};t.responsiveMap=a;var s=[],u=-1,c={},l={dispatch:function(e){return c=e,!(s.length<1||(s.forEach((function(e){e.func(c)})),0))},subscribe:function(e){0===s.length&&this.register();var t=(++u).toString();return s.push({token:t,func:e}),e(c),t},unsubscribe:function(e){0===(s=s.filter((function(t){return t.token!==e}))).length&&this.unregister()},unregister:function(){Object.keys(a).map((function(e){return o.unregister(a[e])}))},register:function(){var e=this;Object.keys(a).map((function(t){return o.register(a[t],{match:function(){var n=i(i({},c),r({},t,!0));e.dispatch(n)},unmatch:function(){var n=i(i({},c),r({},t,!1));e.dispatch(n)},destroy:function(){}})}))}};t.default=l},74605:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(n(5954)),a=(i=n(19295))&&i.__esModule?i:{default:i},s=n(37534);function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}t.default=function(e){return o.createElement(s.ConfigConsumer,null,(function(t){var n=t.getPrefixCls,r=e.prefixCls,i=e.className,s=e.hoverable,u=void 0===s||s,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["prefixCls","className","hoverable"]),d=n("card",r),f=(0,a.default)("".concat(d,"-grid"),i,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},"".concat(d,"-grid-hoverable"),u));return o.createElement("div",c({},l,{className:f}))}))}},27324:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(n(5954)),a=(i=n(19295))&&i.__esModule?i:{default:i},s=n(37534);function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}t.default=function(e){return o.createElement(s.ConfigConsumer,null,(function(t){var n=t.getPrefixCls,r=e.prefixCls,i=e.className,s=e.avatar,u=e.title,l=e.description,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["prefixCls","className","avatar","title","description"]),f=n("card",r),p=(0,a.default)("".concat(f,"-meta"),i),h=s?o.createElement("div",{className:"".concat(f,"-meta-avatar")},s):null,v=u?o.createElement("div",{className:"".concat(f,"-meta-title")},u):null,m=l?o.createElement("div",{className:"".concat(f,"-meta-description")},l):null,y=v||m?o.createElement("div",{className:"".concat(f,"-meta-detail")},v,m):null;return o.createElement("div",c({},d,{className:p}),h,y)}))}},20885:function(e,t,n){"use strict";t.Z=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==v(e)&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(n(5954)),i=p(n(19295)),o=p(n(31009)),a=p(n(74605)),s=p(n(27324)),u=p(n(21968)),c=p(n(28384)),l=p(n(84474)),d=n(37534),f=p(n(90146));function p(e){return e&&e.__esModule?e:{default:e}}function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},x(e,t)}function _(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var M=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function S(e){return e.map((function(t,n){return r.createElement("li",{style:{width:"".concat(100/e.length,"%")},key:"action-".concat(n)},r.createElement("span",null,t))}))}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(v,e);var t,n,s,p,h=(s=v,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(s);if(p){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function v(){var e;return g(this,v),(e=h.apply(this,arguments)).onTabChange=function(t){e.props.onTabChange&&e.props.onTabChange(t)},e.renderCard=function(t){var n,a,s,d=t.getPrefixCls,f=e.props,p=f.prefixCls,h=f.className,v=f.extra,g=f.headStyle,b=void 0===g?{}:g,x=f.bodyStyle,_=void 0===x?{}:x,w=f.title,T=f.loading,E=f.bordered,k=void 0===E||E,A=f.size,P=void 0===A?"default":A,C=f.type,O=f.cover,I=f.actions,R=f.tabList,N=f.children,D=f.activeTabKey,L=f.defaultActiveTabKey,B=f.tabBarExtraContent,F=M(f,["prefixCls","className","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent"]),j=d("card",p),z=(0,i.default)(j,h,(y(n={},"".concat(j,"-loading"),T),y(n,"".concat(j,"-bordered"),k),y(n,"".concat(j,"-hoverable"),e.getCompatibleHoverable()),y(n,"".concat(j,"-contain-grid"),e.isContainGrid()),y(n,"".concat(j,"-contain-tabs"),R&&R.length),y(n,"".concat(j,"-").concat(P),"default"!==P),y(n,"".concat(j,"-type-").concat(C),!!C),n)),U=0===_.padding||"0px"===_.padding?{padding:24}:void 0,G=r.createElement("div",{className:"".concat(j,"-loading-content"),style:U},r.createElement(c.default,{gutter:8},r.createElement(l.default,{span:22},r.createElement("div",{className:"".concat(j,"-loading-block")}))),r.createElement(c.default,{gutter:8},r.createElement(l.default,{span:8},r.createElement("div",{className:"".concat(j,"-loading-block")})),r.createElement(l.default,{span:15},r.createElement("div",{className:"".concat(j,"-loading-block")}))),r.createElement(c.default,{gutter:8},r.createElement(l.default,{span:6},r.createElement("div",{className:"".concat(j,"-loading-block")})),r.createElement(l.default,{span:18},r.createElement("div",{className:"".concat(j,"-loading-block")}))),r.createElement(c.default,{gutter:8},r.createElement(l.default,{span:13},r.createElement("div",{className:"".concat(j,"-loading-block")})),r.createElement(l.default,{span:9},r.createElement("div",{className:"".concat(j,"-loading-block")}))),r.createElement(c.default,{gutter:8},r.createElement(l.default,{span:4},r.createElement("div",{className:"".concat(j,"-loading-block")})),r.createElement(l.default,{span:3},r.createElement("div",{className:"".concat(j,"-loading-block")})),r.createElement(l.default,{span:16},r.createElement("div",{className:"".concat(j,"-loading-block")})))),V=void 0!==D,W=(y(a={},V?"activeKey":"defaultActiveKey",V?D:L),y(a,"tabBarExtraContent",B),a),H=R&&R.length?r.createElement(u.default,m({},W,{className:"".concat(j,"-head-tabs"),size:"large",onChange:e.onTabChange}),R.map((function(e){return r.createElement(u.default.TabPane,{tab:e.tab,disabled:e.disabled,key:e.key})}))):null;(w||v||H)&&(s=r.createElement("div",{className:"".concat(j,"-head"),style:b},r.createElement("div",{className:"".concat(j,"-head-wrapper")},w&&r.createElement("div",{className:"".concat(j,"-head-title")},w),v&&r.createElement("div",{className:"".concat(j,"-extra")},v)),H));var Z=O?r.createElement("div",{className:"".concat(j,"-cover")},O):null,q=r.createElement("div",{className:"".concat(j,"-body"),style:_},T?G:N),Y=I&&I.length?r.createElement("ul",{className:"".concat(j,"-actions")},S(I)):null,X=(0,o.default)(F,["onTabChange","noHovering","hoverable"]);return r.createElement("div",m({},X,{className:z}),s,Z,q,Y)},e}return t=v,(n=[{key:"componentDidMount",value:function(){"noHovering"in this.props&&((0,f.default)(!this.props.noHovering,"Card","`noHovering` is deprecated, you can remove it safely or use `hoverable` instead."),(0,f.default)(!!this.props.noHovering,"Card","`noHovering={false}` is deprecated, use `hoverable` instead."))}},{key:"getCompatibleHoverable",value:function(){var e=this.props,t=e.noHovering,n=e.hoverable;return"noHovering"in this.props?!t||n:!!n}},{key:"isContainGrid",value:function(){var e;return r.Children.forEach(this.props.children,(function(t){t&&t.type&&t.type===a.default&&(e=!0)})),e}},{key:"render",value:function(){return r.createElement(d.ConfigConsumer,null,this.renderCard)}}])&&b(t.prototype,n),v}(r.Component);t.Z=T,T.Grid=a.default,T.Meta=s.default},84474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(33876).Col;t.default=r},87188:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=(0,((r=n(98837))&&r.__esModule?r:{default:r}).default)({});t.default=i},52661:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(5954)),i=l(n(96504)),o=u(n(19295)),a=u(n(87188)),s=n(37534);function u(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!==p(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function y(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var x=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},_=i.oneOfType([i.object,i.number]),w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(l,e);var t,n,i,u,c=(i=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(i);if(u){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function l(){var e;return h(this,l),(e=c.apply(this,arguments)).renderCol=function(t){var n,i=t.getPrefixCls,s=g(e).props,u=s.prefixCls,c=s.span,l=s.order,h=s.offset,v=s.push,m=s.pull,y=s.className,b=s.children,_=x(s,["prefixCls","span","order","offset","push","pull","className","children"]),w=i("col",u),M={};["xs","sm","md","lg","xl","xxl"].forEach((function(e){var t,n={},r=s[e];"number"==typeof r?n.span=r:"object"===p(r)&&(n=r||{}),delete _[e],M=f(f({},M),(d(t={},"".concat(w,"-").concat(e,"-").concat(n.span),void 0!==n.span),d(t,"".concat(w,"-").concat(e,"-order-").concat(n.order),n.order||0===n.order),d(t,"".concat(w,"-").concat(e,"-offset-").concat(n.offset),n.offset||0===n.offset),d(t,"".concat(w,"-").concat(e,"-push-").concat(n.push),n.push||0===n.push),d(t,"".concat(w,"-").concat(e,"-pull-").concat(n.pull),n.pull||0===n.pull),t))}));var S=(0,o.default)(w,(d(n={},"".concat(w,"-").concat(c),void 0!==c),d(n,"".concat(w,"-order-").concat(l),l),d(n,"".concat(w,"-offset-").concat(h),h),d(n,"".concat(w,"-push-").concat(v),v),d(n,"".concat(w,"-pull-").concat(m),m),n),y,M);return r.createElement(a.default.Consumer,null,(function(e){var t=e.gutter,n=_.style;return t&&(n=f(f(f({},t[0]>0?{paddingLeft:t[0]/2,paddingRight:t[0]/2}:{}),t[1]>0?{paddingTop:t[1]/2,paddingBottom:t[1]/2}:{}),n)),r.createElement("div",f({},_,{style:n,className:S}),b)}))},e}return t=l,(n=[{key:"render",value:function(){return r.createElement(s.ConfigConsumer,null,this.renderCol)}}])&&v(t.prototype,n),l}(r.Component);t.default=w,w.propTypes={span:i.number,order:i.number,offset:i.number,push:i.number,pull:i.number,className:i.string,children:i.node,xs:_,sm:_,md:_,lg:_,xl:_,xxl:_}},33876:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Row",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Col",{enumerable:!0,get:function(){return i.default}});var r=o(n(61394)),i=o(n(52661));function o(e){return e&&e.__esModule?e:{default:e}}},61394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(n(5954)),i=l(n(19295)),o=f(n(96504)),a=n(37534),s=l(n(87188)),u=n(96955),c=f(n(29260));function l(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function f(e){if(e&&e.__esModule)return e;if(null===e||"object"!==p(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function b(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}var _=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},w=(0,u.tuple)("top","middle","bottom","stretch"),M=(0,u.tuple)("start","end","center","space-around","space-between"),S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(d,e);var t,n,o,u,l=(o=d,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(o);if(u){var n=x(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function d(){var e;return m(this,d),(e=l.apply(this,arguments)).state={screens:{}},e.renderRow=function(t){var n,o=t.getPrefixCls,a=e.props,u=a.prefixCls,c=a.type,l=a.justify,d=a.align,f=a.className,p=a.style,m=a.children,y=_(a,["prefixCls","type","justify","align","className","style","children"]),g=o("row",u),b=e.getGutter(),x=(0,i.default)((v(n={},g,!c),v(n,"".concat(g,"-").concat(c),c),v(n,"".concat(g,"-").concat(c,"-").concat(l),c&&l),v(n,"".concat(g,"-").concat(c,"-").concat(d),c&&d),n),f),w=h(h(h({},b[0]>0?{marginLeft:b[0]/-2,marginRight:b[0]/-2}:{}),b[1]>0?{marginTop:b[1]/-2,marginBottom:b[1]/-2}:{}),p),M=h({},y);return delete M.gutter,r.createElement(s.default.Provider,{value:{gutter:b}},r.createElement("div",h({},M,{className:x,style:w}),m))},e}return t=d,(n=[{key:"componentDidMount",value:function(){var e=this;this.token=c.default.subscribe((function(t){var n=e.props.gutter;("object"===p(n)||Array.isArray(n)&&("object"===p(n[0])||"object"===p(n[1])))&&e.setState({screens:t})}))}},{key:"componentWillUnmount",value:function(){c.default.unsubscribe(this.token)}},{key:"getGutter",value:function(){var e=[0,0],t=this.props.gutter,n=this.state.screens;return(Array.isArray(t)?t:[t,0]).forEach((function(t,r){if("object"===p(t))for(var i=0;i<c.responsiveArray.length;i++){var o=c.responsiveArray[i];if(n[o]&&void 0!==t[o]){e[r]=t[o];break}}else e[r]=t||0})),e}},{key:"render",value:function(){return r.createElement(a.ConfigConsumer,null,this.renderRow)}}])&&y(t.prototype,n),d}(r.Component);t.default=S,S.defaultProps={gutter:0},S.propTypes={type:o.oneOf(["flex"]),align:o.oneOf(w),justify:o.oneOf(M),className:o.string,children:o.node,gutter:o.oneOfType([o.object,o.number,o.array]),prefixCls:o.string}},94838:function(e,t,n){"use strict";t.Z=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(n(5954)),i=s(n(64242)),o=n(37534),a=s(n(90146));function s(e){return e&&e.__esModule?e:{default:e}}function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(y,e);var t,n,s,u,c=(s=y,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(s);if(u){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function y(){var e;return d(this,y),(e=c.apply(this,arguments)).saveTooltip=function(t){e.tooltip=t},e.renderPopover=function(t){var n=t.getPrefixCls,o=e.props,a=o.prefixCls,s=m(o,["prefixCls"]);delete s.title;var u=n("popover",a);return r.createElement(i.default,l({},s,{prefixCls:u,ref:e.saveTooltip,overlay:e.getOverlay(u)}))},e}return t=y,(n=[{key:"getPopupDomNode",value:function(){return this.tooltip.getPopupDomNode()}},{key:"getOverlay",value:function(e){var t=this.props,n=t.title,i=t.content;return(0,a.default)(!("overlay"in this.props),"Popover","`overlay` is removed, please use `content` instead, see: https://u.ant.design/popover-content"),r.createElement("div",null,n&&r.createElement("div",{className:"".concat(e,"-title")},n),r.createElement("div",{className:"".concat(e,"-inner-content")},i))}},{key:"render",value:function(){return r.createElement(o.ConfigConsumer,null,this.renderPopover)}}])&&f(t.prototype,n),y}(r.Component);t.Z=y,y.defaultProps={placement:"top",transitionName:"zoom-big",trigger:"hover",mouseEnterDelay:.1,mouseLeaveDelay:.1,overlayStyle:{}}},7980:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(n(5954)),a=n(81963),s=(i=n(19295))&&i.__esModule?i:{default:i},u=n(66164);function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}var l={normal:"#108ee9",exception:"#ff5500",success:"#87d068"};function d(e){var t=e.percent,n=e.successPercent,r=(0,u.validProgress)(t);if(!n)return r;var i=(0,u.validProgress)(n);return[n,(0,u.validProgress)(r-i)]}t.default=function(e){var t,n,r,i,u=e.prefixCls,c=e.width,f=e.strokeWidth,p=e.trailColor,h=e.strokeLinecap,v=e.gapPosition,m=e.gapDegree,y=e.type,g=e.children,b=c||120,x={width:b,height:b,fontSize:.15*b+6},_=f||6,w=v||"dashboard"===y&&"bottom"||"top",M=m||("dashboard"===y?75:void 0),S=(n=(t=e).progressStatus,r=t.successPercent,i=t.strokeColor||l[n],r?[l.success,i]:i),T="[object Object]"===Object.prototype.toString.call(S),E=(0,s.default)("".concat(u,"-inner"),function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},"".concat(u,"-circle-gradient"),T));return o.createElement("div",{className:E,style:x},o.createElement(a.Circle,{percent:d(e),strokeWidth:_,trailWidth:_,strokeColor:S,strokeLinecap:h,trailColor:p,prefixCls:u,gapDegree:M,gapPosition:w}),g)}},41873:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.handleGradient=t.sortGradient=void 0;var i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(n(5954)),o=n(66164);function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var i=(c=r[n],l=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(c,l)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(c,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],a=i[1],s=parseFloat(o.replace(/%/g,""));if(isNaN(s))return{};t.push({key:s,value:a})}var c,l;return(t=t.sort((function(e,t){return e.key-t.key}))).map((function(e){var t=e.key,n=e.value;return"".concat(n," ").concat(t,"%")})).join(", ")};t.sortGradient=c;var l=function(e){var t=e.from,n=void 0===t?"#1890ff":t,r=e.to,i=void 0===r?"#1890ff":r,o=e.direction,a=void 0===o?"to right":o,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["from","to","direction"]);if(0!==Object.keys(s).length){var u=c(s);return{backgroundImage:"linear-gradient(".concat(a,", ").concat(u,")")}}return{backgroundImage:"linear-gradient(".concat(a,", ").concat(n,", ").concat(i,")")}};t.handleGradient=l;t.default=function(e){var t,n=e.prefixCls,r=e.percent,a=e.successPercent,u=e.strokeWidth,c=e.size,d=e.strokeColor,f=e.strokeLinecap,p=e.children;t=d&&"string"!=typeof d?l(d):{background:d};var h=s({width:"".concat((0,o.validProgress)(r),"%"),height:u||("small"===c?6:8),borderRadius:"square"===f?0:""},t),v={width:"".concat((0,o.validProgress)(a),"%"),height:u||("small"===c?6:8),borderRadius:"square"===f?0:""},m=void 0!==a?i.createElement("div",{className:"".concat(n,"-success-bg"),style:v}):null;return i.createElement("div",null,i.createElement("div",{className:"".concat(n,"-outer")},i.createElement("div",{className:"".concat(n,"-inner")},i.createElement("div",{className:"".concat(n,"-bg"),style:h}),m)),p)}},90619:function(e,t,n){"use strict";var r;t.Z=void 0;var i=((r=n(43102))&&r.__esModule?r:{default:r}).default;t.Z=i},43102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=v(n(96504)),i=v(n(5954)),o=p(n(19295)),a=p(n(31009)),s=p(n(36897)),u=n(37534),c=n(96955),l=p(n(41873)),d=p(n(7980)),f=n(66164);function p(e){return e&&e.__esModule?e:{default:e}}function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function v(e){if(e&&e.__esModule)return e;if(null===e||"object"!==m(e)&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function w(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?M(e):t}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var T=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},E=(0,c.tuple)("line","circle","dashboard"),k=(0,c.tuple)("normal","exception","active","success"),A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(h,e);var t,n,r,c,p=(r=h,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(c){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function h(){var e;return b(this,h),(e=p.apply(this,arguments)).renderProgress=function(t){var n,r,s=t.getPrefixCls,u=M(e).props,c=u.prefixCls,f=u.className,p=u.size,h=u.type,v=u.showInfo,m=T(u,["prefixCls","className","size","type","showInfo"]),b=s("progress",c),x=e.getProgressStatus(),_=e.renderProcessInfo(b,x);"line"===h?r=i.createElement(l.default,g({},e.props,{prefixCls:b}),_):"circle"!==h&&"dashboard"!==h||(r=i.createElement(d.default,g({},e.props,{prefixCls:b,progressStatus:x}),_));var w=(0,o.default)(b,(y(n={},"".concat(b,"-").concat("dashboard"===h?"circle":h),!0),y(n,"".concat(b,"-status-").concat(x),!0),y(n,"".concat(b,"-show-info"),v),y(n,"".concat(b,"-").concat(p),p),n),f);return i.createElement("div",g({},(0,a.default)(m,["status","format","trailColor","successPercent","strokeWidth","width","gapDegree","gapPosition","strokeColor","strokeLinecap","percent"]),{className:w}),r)},e}return t=h,(n=[{key:"getPercentNumber",value:function(){var e=this.props,t=e.successPercent,n=e.percent,r=void 0===n?0:n;return parseInt(void 0!==t?t.toString():r.toString(),10)}},{key:"getProgressStatus",value:function(){var e=this.props.status;return k.indexOf(e)<0&&this.getPercentNumber()>=100?"success":e||"normal"}},{key:"renderProcessInfo",value:function(e,t){var n,r=this.props,o=r.showInfo,a=r.format,u=r.type,c=r.percent,l=r.successPercent;if(!o)return null;var d="circle"===u||"dashboard"===u?"":"-circle";return a||"exception"!==t&&"success"!==t?n=(a||function(e){return"".concat(e,"%")})((0,f.validProgress)(c),(0,f.validProgress)(l)):"exception"===t?n=i.createElement(s.default,{type:"close".concat(d),theme:"line"===u?"filled":"outlined"}):"success"===t&&(n=i.createElement(s.default,{type:"check".concat(d),theme:"line"===u?"filled":"outlined"})),i.createElement("span",{className:"".concat(e,"-text"),title:"string"==typeof n?n:void 0},n)}},{key:"render",value:function(){return i.createElement(u.ConfigConsumer,null,this.renderProgress)}}])&&x(t.prototype,n),h}(i.Component);t.default=A,A.defaultProps={type:"line",percent:0,showInfo:!0,trailColor:"#f3f3f3",size:"default",gapDegree:0,strokeLinecap:"round"},A.propTypes={status:r.oneOf(k),type:r.oneOf(E),showInfo:r.bool,percent:r.number,width:r.number,strokeWidth:r.number,strokeLinecap:r.oneOf(["round","square"]),strokeColor:r.oneOfType([r.string,r.object]),trailColor:r.string,format:r.func,gapDegree:r.number}},66164:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validProgress=function(e){return!e||e<0?0:e>100?100:e}},66177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(n(5954)),i=f(n(96504)),o=l(n(19295)),a=l(n(74326)),s=n(94286),u=l(n(95481)),c=n(37534);function l(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function f(e){if(e&&e.__esModule)return e;if(null===e||"object"!==p(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function m(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function b(e){var t=null,n=!1;return r.Children.forEach(e,(function(e){e&&e.props&&e.props.checked&&(t=e.props.value,n=!0)})),n?{value:t}:void 0}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(f,e);var t,n,i,s,l,d=(s=f,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(s);if(l){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function f(e){var t,n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=d.call(this,e)).onRadioChange=function(e){var n=t.state.value,r=e.target.value;"value"in t.props||t.setState({value:r});var i=t.props.onChange;i&&r!==n&&i(e)},t.renderGroup=function(e){var n=e.getPrefixCls,i=y(t).props,a=i.prefixCls,s=i.className,c=void 0===s?"":s,l=i.options,d=i.buttonStyle,f=n("radio",a),p="".concat(f,"-group"),h=(0,o.default)(p,"".concat(p,"-").concat(d),function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},"".concat(p,"-").concat(i.size),i.size),c),v=i.children;return l&&l.length>0&&(v=l.map((function(e){return"string"==typeof e?r.createElement(u.default,{key:e,prefixCls:f,disabled:t.props.disabled,value:e,checked:t.state.value===e},e):r.createElement(u.default,{key:"radio-group-value-options-".concat(e.value),prefixCls:f,disabled:e.disabled||t.props.disabled,value:e.value,checked:t.state.value===e.value},e.label)}))),r.createElement("div",{className:h,style:i.style,onMouseEnter:i.onMouseEnter,onMouseLeave:i.onMouseLeave,id:i.id},v)},"value"in e)n=e.value;else if("defaultValue"in e)n=e.defaultValue;else{var i=b(e.children);n=i&&i.value}return t.state={value:n},t}return t=f,i=[{key:"getDerivedStateFromProps",value:function(e){if("value"in e)return{value:e.value};var t=b(e.children);return t?{value:t.value}:null}}],(n=[{key:"getChildContext",value:function(){return{radioGroup:{onChange:this.onRadioChange,value:this.state.value,disabled:this.props.disabled,name:this.props.name}}}},{key:"shouldComponentUpdate",value:function(e,t){return!(0,a.default)(this.props,e)||!(0,a.default)(this.state,t)}},{key:"render",value:function(){return r.createElement(c.ConfigConsumer,null,this.renderGroup)}}])&&h(t.prototype,n),i&&h(t,i),f}(r.Component);x.defaultProps={buttonStyle:"outline"},x.childContextTypes={radioGroup:i.any},(0,s.polyfill)(x);var _=x;t.default=_},50698:function(e,t,n){"use strict";t.ZP=void 0;var r=a(n(95481)),i=a(n(66177)),o=a(n(41889));function a(e){return e&&e.__esModule?e:{default:e}}r.default.Button=o.default,r.default.Group=i.default;var s=r.default;t.ZP=s},95481:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(n(5954)),i=d(n(96504)),o=c(n(56663)),a=c(n(19295)),s=c(n(74326)),u=n(37534);function c(e){return e&&e.__esModule?e:{default:e}}function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function d(e){if(e&&e.__esModule)return e;if(null===e||"object"!==f(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function g(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}var _=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(d,e);var t,n,i,c,l=(i=d,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(i);if(c){var n=x(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function d(){var e;return v(this,d),(e=l.apply(this,arguments)).saveCheckbox=function(t){e.rcCheckbox=t},e.onChange=function(t){e.props.onChange&&e.props.onChange(t),e.context.radioGroup&&e.context.radioGroup.onChange&&e.context.radioGroup.onChange(t)},e.renderRadio=function(t){var n,i=t.getPrefixCls,s=b(e),u=s.props,c=s.context,l=u.prefixCls,d=u.className,f=u.children,v=u.style,m=_(u,["prefixCls","className","children","style"]),y=c.radioGroup,g=i("radio",l),x=h({},m);y&&(x.name=y.name,x.onChange=e.onChange,x.checked=u.value===y.value,x.disabled=u.disabled||y.disabled);var w=(0,a.default)(d,(p(n={},"".concat(g,"-wrapper"),!0),p(n,"".concat(g,"-wrapper-checked"),x.checked),p(n,"".concat(g,"-wrapper-disabled"),x.disabled),n));return r.createElement("label",{className:w,style:v,onMouseEnter:u.onMouseEnter,onMouseLeave:u.onMouseLeave},r.createElement(o.default,h({},x,{prefixCls:g,ref:e.saveCheckbox})),void 0!==f?r.createElement("span",null,f):null)},e}return t=d,(n=[{key:"shouldComponentUpdate",value:function(e,t,n){return!(0,s.default)(this.props,e)||!(0,s.default)(this.state,t)||!(0,s.default)(this.context.radioGroup,n.radioGroup)}},{key:"focus",value:function(){this.rcCheckbox.focus()}},{key:"blur",value:function(){this.rcCheckbox.blur()}},{key:"render",value:function(){return r.createElement(u.ConfigConsumer,null,this.renderRadio)}}])&&m(t.prototype,n),d}(r.Component);t.default=w,w.defaultProps={type:"radio"},w.contextTypes={radioGroup:i.any}},41889:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=c(n(5954)),o=c(n(96504)),a=(r=n(95481))&&r.__esModule?r:{default:r},s=n(37534);function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function v(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(c,e);var t,n,r,o,u=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(o){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function c(){var e;return f(this,c),(e=u.apply(this,arguments)).renderRadioButton=function(t){var n=t.getPrefixCls,r=e.props,o=r.prefixCls,s=y(r,["prefixCls"]),u=n("radio-button",o);return e.context.radioGroup&&(s.checked=e.props.value===e.context.radioGroup.value,s.disabled=e.props.disabled||e.context.radioGroup.disabled),i.createElement(a.default,d({prefixCls:u},s))},e}return t=c,(n=[{key:"render",value:function(){return i.createElement(s.ConfigConsumer,null,this.renderRadioButton)}}])&&p(t.prototype,n),c}(i.Component);t.default=g,g.contextTypes={radioGroup:o.any}},28384:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(33876).Row;t.default=r},85213:function(e,t,n){"use strict";t.Z=void 0;var r=f(n(5954)),i=f(n(96504)),o=l(n(19295)),a=l(n(31009)),s=l(n(39807)),u=n(37534),c=n(96955);function l(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function f(e){if(e&&e.__esModule)return e;if(null===e||"object"!==p(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function g(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var x=(0,c.tuple)("small","default","large"),_=null,w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(f,e);var t,n,i,c,l,d=(c=f,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(c);if(l){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function f(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=d.call(this,e)).debouncifyUpdateSpinning=function(e){var n=(e||t.props).delay;n&&(t.cancelExistingSpin(),t.updateSpinning=(0,s.default)(t.originalUpdateSpinning,n))},t.updateSpinning=function(){var e=t.props.spinning;t.state.spinning!==e&&t.setState({spinning:e})},t.renderSpin=function(e){var n,i=e.getPrefixCls,s=t.props,u=s.prefixCls,c=s.className,l=s.size,d=s.tip,f=s.wrapperClassName,p=s.style,m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(s,["prefixCls","className","size","tip","wrapperClassName","style"]),y=t.state.spinning,g=i("spin",u),b=(0,o.default)(g,(v(n={},"".concat(g,"-sm"),"small"===l),v(n,"".concat(g,"-lg"),"large"===l),v(n,"".concat(g,"-spinning"),y),v(n,"".concat(g,"-show-text"),!!d),n),c),x=(0,a.default)(m,["spinning","delay","indicator"]),w=r.createElement("div",h({},x,{style:p,className:b}),function(e,t){var n=t.indicator,i="".concat(e,"-dot");return null===n?null:r.isValidElement(n)?r.cloneElement(n,{className:(0,o.default)(n.props.className,i)}):r.isValidElement(_)?r.cloneElement(_,{className:(0,o.default)(_.props.className,i)}):r.createElement("span",{className:(0,o.default)(i,"".concat(e,"-dot-spin"))},r.createElement("i",{className:"".concat(e,"-dot-item")}),r.createElement("i",{className:"".concat(e,"-dot-item")}),r.createElement("i",{className:"".concat(e,"-dot-item")}),r.createElement("i",{className:"".concat(e,"-dot-item")}))}(g,t.props),d?r.createElement("div",{className:"".concat(g,"-text")},d):null);if(t.isNestedPattern()){var M=(0,o.default)("".concat(g,"-container"),v({},"".concat(g,"-blur"),y));return r.createElement("div",h({},x,{className:(0,o.default)("".concat(g,"-nested-loading"),f)}),y&&r.createElement("div",{key:"loading"},w),r.createElement("div",{className:M,key:"container"},t.props.children))}return w};var n=e.spinning,i=function(e,t){return!!e&&!!t&&!isNaN(Number(t))}(n,e.delay);return t.state={spinning:n&&!i},t.originalUpdateSpinning=t.updateSpinning,t.debouncifyUpdateSpinning(e),t}return t=f,i=[{key:"setDefaultIndicator",value:function(e){_=e}}],(n=[{key:"componentDidMount",value:function(){this.updateSpinning()}},{key:"componentDidUpdate",value:function(){this.debouncifyUpdateSpinning(),this.updateSpinning()}},{key:"componentWillUnmount",value:function(){this.cancelExistingSpin()}},{key:"cancelExistingSpin",value:function(){var e=this.updateSpinning;e&&e.cancel&&e.cancel()}},{key:"isNestedPattern",value:function(){return!(!this.props||!this.props.children)}},{key:"render",value:function(){return r.createElement(u.ConfigConsumer,null,this.renderSpin)}}])&&m(t.prototype,n),i&&m(t,i),f}(r.Component);w.defaultProps={spinning:!0,size:"default",wrapperClassName:""},w.propTypes={prefixCls:i.string,className:i.string,spinning:i.bool,size:i.oneOf(x),wrapperClassName:i.string,indicator:i.element};var M=w;t.Z=M},59756:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==d(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(n(5954)),i=s(n(74564)),o=s(n(19295)),a=s(n(36897));function s(e){return e&&e.__esModule?e:{default:e}}function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(g,e);var t,n,s,u,y=(s=g,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(s);if(u){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function g(){return f(this,g),y.apply(this,arguments)}return t=g,(n=[{key:"render",value:function(){var e,t,n=this.props,s=n.tabBarStyle,u=n.animated,f=n.renderTabBar,p=n.tabBarExtraContent,h=n.tabPosition,v=n.prefixCls,m=n.className,y=n.size,g=n.type,b="object"===d(u)?u.inkBar:u,x="left"===h||"right"===h,_=x?"up":"left",w=x?"down":"right",M=r.createElement("span",{className:"".concat(v,"-tab-prev-icon")},r.createElement(a.default,{type:_,className:"".concat(v,"-tab-prev-icon-target")})),S=r.createElement("span",{className:"".concat(v,"-tab-next-icon")},r.createElement(a.default,{type:w,className:"".concat(v,"-tab-next-icon-target")})),T=(0,o.default)("".concat(v,"-").concat(h,"-bar"),(l(e={},"".concat(v,"-").concat(y,"-bar"),!!y),l(e,"".concat(v,"-card-bar"),g&&g.indexOf("card")>=0),e),m),E=c(c({},this.props),{children:null,inkBarAnimated:b,extraContent:p,style:s,prevIcon:M,nextIcon:S,className:T});return t=f?f(E,i.default):r.createElement(i.default,E),r.cloneElement(t)}}])&&p(t.prototype,n),g}(r.Component);t.default=y,y.defaultProps={animated:!0,type:"line"}},21968:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=m(n(5954)),i=m(n(60493)),o=m(n(74426)),a=h(n(57741)),s=h(n(19295)),u=h(n(31009)),c=h(n(59756)),l=h(n(36897)),d=n(37534),f=h(n(90146)),p=n(78367);function h(e){return e&&e.__esModule?e:{default:e}}function v(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return v=function(){return e},e}function m(e){if(e&&e.__esModule)return e;if(null===e||"object"!==b(e)&&"function"!=typeof e)return{default:e};var t=v();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function M(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var T=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(E,e);var t,n,h,v,m=(h=E,v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(h);if(v){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return M(this,e)});function E(){var e;return x(this,E),(e=m.apply(this,arguments)).removeTab=function(t,n){if(n.stopPropagation(),t){var r=e.props.onEdit;r&&r(t,"remove")}},e.handleChange=function(t){var n=e.props.onChange;n&&n(t)},e.createNewTab=function(t){var n=e.props.onEdit;n&&n(t,"add")},e.renderTabs=function(t){var n,i=t.getPrefixCls,d=e.props,p=d.prefixCls,h=d.className,v=void 0===h?"":h,m=d.size,x=d.type,_=void 0===x?"line":x,w=d.tabPosition,M=d.children,S=d.animated,E=void 0===S||S,k=d.hideAdd,A=e.props.tabBarExtraContent,P="object"===b(E)?E.tabPane:E;"line"!==_&&(P="animated"in e.props&&P),(0,f.default)(!(_.indexOf("card")>=0&&("small"===m||"large"===m)),"Tabs","`type=card|editable-card` doesn't have small or large size, it's by design.");var C=i("tabs",p),O=(0,s.default)(v,(g(n={},"".concat(C,"-vertical"),"left"===w||"right"===w),g(n,"".concat(C,"-").concat(m),!!m),g(n,"".concat(C,"-card"),_.indexOf("card")>=0),g(n,"".concat(C,"-").concat(_),!0),g(n,"".concat(C,"-no-animation"),!P),n)),I=[];"editable-card"===_&&(I=[],r.Children.forEach(M,(function(t,n){if(!r.isValidElement(t))return t;var i=t.props.closable,o=(i=void 0===i||i)?r.createElement(l.default,{type:"close",className:"".concat(C,"-close-x"),onClick:function(n){return e.removeTab(t.key,n)}}):null;I.push(r.cloneElement(t,{tab:r.createElement("div",{className:i?void 0:"".concat(C,"-tab-unclosable")},t.props.tab,o),key:t.key||n}))})),k||(A=r.createElement("span",null,r.createElement(l.default,{type:"plus",className:"".concat(C,"-new-tab"),onClick:e.createNewTab}),A))),A=A?r.createElement("div",{className:"".concat(C,"-extra-content")},A):null;var R=T(e.props,[]),N=(0,s.default)("".concat(C,"-").concat(w,"-content"),_.indexOf("card")>=0&&"".concat(C,"-card-content"));return r.createElement(o.default,y({},e.props,{prefixCls:C,className:O,tabBarPosition:w,renderTabBar:function(){return r.createElement(c.default,y({},(0,u.default)(R,["className"]),{tabBarExtraContent:A}))},renderTabContent:function(){return r.createElement(a.default,{className:N,animated:P,animatedWithMargin:!0})},onChange:e.handleChange}),I.length>0?I:M)},e}return t=E,(n=[{key:"componentDidMount",value:function(){var e=" no-flex",t=i.findDOMNode(this);t&&!p.isFlexSupported&&-1===t.className.indexOf(e)&&(t.className+=e)}},{key:"render",value:function(){return r.createElement(d.ConfigConsumer,null,this.renderTabs)}}])&&_(t.prototype,n),E}(r.Component);t.default=E,E.TabPane=o.TabPane,E.defaultProps={hideAdd:!1,tabPosition:"top"}},20367:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(74458)),i=f(n(23661)),o=f(n(5026)),a=f(n(34250)),s=f(n(90183)),u=f(n(5954)),c=f(n(96504)),l=f(n(99286)),d=n(95642);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var n=e.props,r=n.styles,i=n.panels,o=n.activeKey,a=n.direction,s=e.props.getRef("root"),u=e.props.getRef("nav")||s,c=e.props.getRef("inkBar"),l=e.props.getRef("activeTab"),f=c.style,p=e.props.tabBarPosition,h=(0,d.getActiveIndex)(i,o);if(t&&(f.display="none"),l){var v=l,m=(0,d.isTransform3dSupported)(f);if((0,d.setTransform)(f,""),f.width="",f.height="",f.left="",f.top="",f.bottom="",f.right="","top"===p||"bottom"===p){var y=(0,d.getLeft)(v,u),g=v.offsetWidth;g===s.offsetWidth?g=0:r.inkBar&&void 0!==r.inkBar.width&&(g=parseFloat(r.inkBar.width,10))&&(y+=(v.offsetWidth-g)/2),"rtl"===a&&(y=(0,d.getStyle)(v,"margin-left")-y),m?(0,d.setTransform)(f,"translate3d("+y+"px,0,0)"):f.left=y+"px",f.width=g+"px"}else{var b=(0,d.getTop)(v,u,!0),x=v.offsetHeight;r.inkBar&&void 0!==r.inkBar.height&&(x=parseFloat(r.inkBar.height,10))&&(b+=(v.offsetHeight-x)/2),m?((0,d.setTransform)(f,"translate3d(0,"+b+"px,0)"),f.top="0"):f.top=b+"px",f.height=x+"px"}}f.display=-1!==h?"block":"none"}var h=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.timeout=setTimeout((function(){p(e,!0)}),0)}},{key:"componentDidUpdate",value:function(){p(this)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,i=t.styles,o=t.inkBarAnimated,a=n+"-ink-bar",s=(0,l.default)((e={},(0,r.default)(e,a,!0),(0,r.default)(e,o?a+"-animated":a+"-no-animated",!0),e));return u.default.createElement("div",{style:i.inkBar,className:s,key:"inkBar",ref:this.props.saveRef("inkBar")})}}]),t}(u.default.Component);t.default=h,h.propTypes={prefixCls:c.default.string,styles:c.default.object,inkBarAnimated:c.default.bool,saveRef:c.default.func,direction:c.default.string},h.defaultProps={prefixCls:"",inkBarAnimated:!0,styles:{},saveRef:function(){}},e.exports=t.default},2419:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(23661)),i=c(n(5026)),o=c(n(34250)),a=c(n(90183)),s=c(n(5954)),u=c(n(96504));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e,n,i,a;(0,r.default)(this,t);for(var s=arguments.length,u=Array(s),c=0;c<s;c++)u[c]=arguments[c];return n=i=(0,o.default)(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.getRef=function(e){return i[e]},i.saveRef=function(e){return function(t){t&&(i[e]=t)}},a=n,(0,o.default)(i,a)}return(0,a.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){return this.props.children(this.saveRef,this.getRef)}}]),t}(s.default.Component);t.default=l,l.propTypes={children:u.default.func},l.defaultProps={children:function(){return null}},e.exports=t.default},74564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(n(52987)),i=m(n(92696)),o=m(n(23661)),a=m(n(5026)),s=m(n(34250)),u=m(n(90183)),c=m(n(5954)),l=m(n(96504)),d=m(n(20367)),f=m(n(96864)),p=m(n(69228)),h=m(n(43411)),v=m(n(2419));function m(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=(0,i.default)(e,["children"]);return c.default.createElement(v.default,null,(function(e,i){return c.default.createElement(p.default,(0,r.default)({saveRef:e},n),c.default.createElement(h.default,(0,r.default)({saveRef:e,getRef:i},n),c.default.createElement(f.default,(0,r.default)({saveRef:e,renderTabBarNode:t},n)),c.default.createElement(d.default,(0,r.default)({saveRef:e,getRef:i},n))))}))}}]),t}(c.default.Component);t.default=y,y.propTypes={children:l.default.func},e.exports=t.default},43411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(74458)),i=h(n(23661)),o=h(n(5026)),a=h(n(34250)),s=h(n(90183)),u=h(n(5954)),c=h(n(96504)),l=h(n(99286)),d=h(n(39807)),f=h(n(67518)),p=n(95642);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var n=(0,a.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.prevTransitionEnd=function(e){if("opacity"===e.propertyName){var t=n.props.getRef("container");n.scrollToActiveTab({target:t,currentTarget:t})}},n.scrollToActiveTab=function(e){var t=n.props.getRef("activeTab"),r=n.props.getRef("navWrap");if((!e||e.target===e.currentTarget)&&t){var i=n.isNextPrevShown()&&n.lastNextPrevShown;if(n.lastNextPrevShown=n.isNextPrevShown(),i){var o=n.getScrollWH(t),a=n.getOffsetWH(r),s=n.offset,u=n.getOffsetLT(r),c=n.getOffsetLT(t);u>c?(s+=u-c,n.setOffset(s)):u+a<c+o&&(s-=c+o-(u+a),n.setOffset(s))}}},n.prev=function(e){n.props.onPrevClick(e);var t=n.props.getRef("navWrap"),r=n.getOffsetWH(t),i=n.offset;n.setOffset(i+r)},n.next=function(e){n.props.onNextClick(e);var t=n.props.getRef("navWrap"),r=n.getOffsetWH(t),i=n.offset;n.setOffset(i-r)},n.offset=0,n.state={next:!1,prev:!1},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.componentDidUpdate(),this.debouncedResize=(0,d.default)((function(){e.setNextPrev(),e.scrollToActiveTab()}),200),this.resizeObserver=new f.default(this.debouncedResize),this.resizeObserver.observe(this.props.getRef("container"))}},{key:"componentDidUpdate",value:function(e){var t=this.props;if(e&&e.tabBarPosition!==t.tabBarPosition)this.setOffset(0);else{var n=this.setNextPrev();this.isNextPrevShown(this.state)!==this.isNextPrevShown(n)?this.setState({},this.scrollToActiveTab):e&&t.activeKey===e.activeKey||this.scrollToActiveTab()}}},{key:"componentWillUnmount",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),this.debouncedResize&&this.debouncedResize.cancel&&this.debouncedResize.cancel()}},{key:"setNextPrev",value:function(){var e=this.props.getRef("nav"),t=this.props.getRef("navTabsContainer"),n=this.getScrollWH(t||e),r=this.getOffsetWH(this.props.getRef("container"))+1,i=this.getOffsetWH(this.props.getRef("navWrap")),o=this.offset,a=r-n,s=this.state,u=s.next,c=s.prev;if(a>=0)u=!1,this.setOffset(0,!1),o=0;else if(a<o)u=!0;else{u=!1;var l=i-n;this.setOffset(l,!1),o=l}return c=o<0,this.setNext(u),this.setPrev(c),{next:u,prev:c}}},{key:"getOffsetWH",value:function(e){var t=this.props.tabBarPosition,n="offsetWidth";return"left"!==t&&"right"!==t||(n="offsetHeight"),e[n]}},{key:"getScrollWH",value:function(e){var t=this.props.tabBarPosition,n="scrollWidth";return"left"!==t&&"right"!==t||(n="scrollHeight"),e[n]}},{key:"getOffsetLT",value:function(e){var t=this.props.tabBarPosition,n="left";return"left"!==t&&"right"!==t||(n="top"),e.getBoundingClientRect()[n]}},{key:"setOffset",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Math.min(0,e);if(this.offset!==n){this.offset=n;var r={},i=this.props.tabBarPosition,o=this.props.getRef("nav").style,a=(0,p.isTransform3dSupported)(o);"left"===i||"right"===i?r=a?{value:"translate3d(0,"+n+"px,0)"}:{name:"top",value:n+"px"}:a?("rtl"===this.props.direction&&(n=-n),r={value:"translate3d("+n+"px,0,0)"}):r={name:"left",value:n+"px"},a?(0,p.setTransform)(o,r.value):o[r.name]=r.value,t&&this.setNextPrev()}}},{key:"setPrev",value:function(e){this.state.prev!==e&&this.setState({prev:e})}},{key:"setNext",value:function(e){this.state.next!==e&&this.setState({next:e})}},{key:"isNextPrevShown",value:function(e){return e?e.next||e.prev:this.state.next||this.state.prev}},{key:"render",value:function(){var e,t,n,i,o=this.state,a=o.next,s=o.prev,c=this.props,d=c.prefixCls,f=c.scrollAnimated,p=c.navWrapper,h=c.prevIcon,v=c.nextIcon,m=s||a,y=u.default.createElement("span",{onClick:s?this.prev:null,unselectable:"unselectable",className:(0,l.default)((e={},(0,r.default)(e,d+"-tab-prev",1),(0,r.default)(e,d+"-tab-btn-disabled",!s),(0,r.default)(e,d+"-tab-arrow-show",m),e)),onTransitionEnd:this.prevTransitionEnd},h||u.default.createElement("span",{className:d+"-tab-prev-icon"})),g=u.default.createElement("span",{onClick:a?this.next:null,unselectable:"unselectable",className:(0,l.default)((t={},(0,r.default)(t,d+"-tab-next",1),(0,r.default)(t,d+"-tab-btn-disabled",!a),(0,r.default)(t,d+"-tab-arrow-show",m),t))},v||u.default.createElement("span",{className:d+"-tab-next-icon"})),b=d+"-nav",x=(0,l.default)((n={},(0,r.default)(n,b,!0),(0,r.default)(n,f?b+"-animated":b+"-no-animated",!0),n));return u.default.createElement("div",{className:(0,l.default)((i={},(0,r.default)(i,d+"-nav-container",1),(0,r.default)(i,d+"-nav-container-scrolling",m),i)),key:"container",ref:this.props.saveRef("container")},y,g,u.default.createElement("div",{className:d+"-nav-wrap",ref:this.props.saveRef("navWrap")},u.default.createElement("div",{className:d+"-nav-scroll"},u.default.createElement("div",{className:x,ref:this.props.saveRef("nav")},p(this.props.children)))))}}]),t}(u.default.Component);t.default=v,v.propTypes={activeKey:c.default.string,getRef:c.default.func.isRequired,saveRef:c.default.func.isRequired,tabBarPosition:c.default.oneOf(["left","right","top","bottom"]),prefixCls:c.default.string,scrollAnimated:c.default.bool,onPrevClick:c.default.func,onNextClick:c.default.func,navWrapper:c.default.func,children:c.default.node,prevIcon:c.default.node,nextIcon:c.default.node,direction:c.default.node},v.defaultProps={tabBarPosition:"left",prefixCls:"",scrollAnimated:!0,onPrevClick:function(){},onNextClick:function(){},navWrapper:function(e){return e}},e.exports=t.default},69228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=v(n(52987)),i=v(n(74458)),o=v(n(92696)),a=v(n(23661)),s=v(n(5026)),u=v(n(34250)),c=v(n(90183)),l=n(5954),d=v(l),f=v(n(96504)),p=v(n(99286)),h=n(95642);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return(0,a.default)(this,t),(0,u.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.props,t=e.prefixCls,n=e.onKeyDown,a=e.className,s=e.extraContent,u=e.style,c=e.tabBarPosition,f=e.children,v=(0,o.default)(e,["prefixCls","onKeyDown","className","extraContent","style","tabBarPosition","children"]),m=(0,p.default)(t+"-bar",(0,i.default)({},a,!!a)),y="top"===c||"bottom"===c,g=y?{float:"right"}:{},b=s&&s.props?s.props.style:{},x=f;return s&&(x=[(0,l.cloneElement)(s,{key:"extra",style:(0,r.default)({},g,b)}),(0,l.cloneElement)(f,{key:"content"})],x=y?x:x.reverse()),d.default.createElement("div",(0,r.default)({role:"tablist",className:m,tabIndex:"0",ref:this.props.saveRef("root"),onKeyDown:n,style:u},(0,h.getDataAttr)(v)),x)}}]),t}(d.default.Component);t.default=m,m.propTypes={prefixCls:f.default.string,className:f.default.string,style:f.default.object,tabBarPosition:f.default.oneOf(["left","right","top","bottom"]),children:f.default.node,extraContent:f.default.node,onKeyDown:f.default.func,saveRef:f.default.func},m.defaultProps={prefixCls:"",className:"",style:{},tabBarPosition:"top",extraContent:null,children:null,onKeyDown:function(){},saveRef:function(){}},e.exports=t.default},96864:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(52987)),i=p(n(74458)),o=p(n(23661)),a=p(n(5026)),s=p(n(34250)),u=p(n(90183)),c=p(n(5954)),l=p(n(1524)),d=p(n(96504)),f=n(95642);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.panels,o=t.activeKey,a=t.prefixCls,s=t.tabBarGutter,u=t.saveRef,d=t.tabBarPosition,p=t.renderTabBarNode,h=t.direction,v=[];return c.default.Children.forEach(n,(function(t,m){if(t){var y=t.key,g=o===y?a+"-tab-active":"";g+=" "+a+"-tab";var b={};t.props.disabled?g+=" "+a+"-tab-disabled":b={onClick:e.props.onTabClick.bind(e,y)};var x={};o===y&&(x.ref=u("activeTab"));var _=s&&m===n.length-1?0:s,w="rtl"===h?"marginLeft":"marginRight",M=(0,i.default)({},(0,f.isVertical)(d)?"marginBottom":w,_);(0,l.default)("tab"in t.props,"There must be `tab` property on children of Tabs.");var S=c.default.createElement("div",(0,r.default)({role:"tab","aria-disabled":t.props.disabled?"true":"false","aria-selected":o===y?"true":"false"},b,{className:g,key:y,style:M},x),t.props.tab);p&&(S=p(S)),v.push(S)}})),c.default.createElement("div",{ref:u("navTabsContainer")},v)}}]),t}(c.default.Component);t.default=h,h.propTypes={activeKey:d.default.string,panels:d.default.node,prefixCls:d.default.string,tabBarGutter:d.default.number,onTabClick:d.default.func,saveRef:d.default.func,renderTabBarNode:d.default.func,tabBarPosition:d.default.string,direction:d.default.string},h.defaultProps={panels:[],prefixCls:[],tabBarGutter:null,onTabClick:function(){},saveRef:function(){}},e.exports=t.default},57741:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(52987)),i=p(n(74458)),o=p(n(23661)),a=p(n(5026)),s=p(n(34250)),u=p(n(90183)),c=p(n(5954)),l=p(n(96504)),d=p(n(99286)),f=n(95642);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"getTabPanes",value:function(){var e=this.props,t=e.activeKey,n=e.children,r=[];return c.default.Children.forEach(n,(function(n){if(n){var i=n.key,o=t===i;r.push(c.default.cloneElement(n,{active:o,destroyInactiveTabPane:e.destroyInactiveTabPane,rootPrefixCls:e.prefixCls}))}})),r}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,o=t.children,a=t.activeKey,s=t.className,u=t.tabBarPosition,l=t.animated,p=t.animatedWithMargin,h=t.direction,v=t.style,m=(0,d.default)((e={},(0,i.default)(e,n+"-content",!0),(0,i.default)(e,l?n+"-content-animated":n+"-content-no-animated",!0),e),s);if(l){var y=(0,f.getActiveIndex)(o,a);if(-1!==y){var g=p?(0,f.getMarginStyle)(y,u):(0,f.getTransformPropValue)((0,f.getTransformByIndex)(y,u,h));v=(0,r.default)({},v,g)}else v=(0,r.default)({},v,{display:"none"})}return c.default.createElement("div",{className:m,style:v},this.getTabPanes())}}]),t}(c.default.Component);t.default=h,h.propTypes={animated:l.default.bool,animatedWithMargin:l.default.bool,prefixCls:l.default.string,children:l.default.node,activeKey:l.default.string,style:l.default.any,tabBarPosition:l.default.string,className:l.default.string,destroyInactiveTabPane:l.default.bool,direction:l.default.string},h.defaultProps={animated:!0},e.exports=t.default},95642:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(74458));t.toArray=a,t.getActiveIndex=function(e,t){for(var n=a(e),r=0;r<n.length;r++)if(n[r].key===t)return r;return-1},t.getActiveKey=function(e,t){return a(e)[t].key},t.setTransform=s,t.isTransform3dSupported=function(e){return("transform"in e||"webkitTransform"in e||"MozTransform"in e)&&window.atob},t.setTransition=function(e,t){e.transition=t,e.webkitTransition=t,e.MozTransition=t},t.getTransformPropValue=function(e){return{transform:e,WebkitTransform:e,MozTransform:e}},t.isVertical=u,t.getTransformByIndex=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ltr",r=u(t)?"translateY":"translateX";return u(t)||"rtl"!==n?r+"("+100*-e+"%) translateZ(0)":r+"("+100*e+"%) translateZ(0)"},t.getMarginStyle=function(e,t){var n=u(t)?"marginTop":"marginLeft";return(0,r.default)({},n,100*-e+"%")},t.getStyle=c,t.setPxStyle=function(e,t,n){t=n?"0px, "+t+"px, 0px":t+"px, 0px, 0px",s(e.style,"translate3d("+t+")")},t.getDataAttr=function(e){return Object.keys(e).reduce((function(t,n){return"aria-"!==n.substr(0,5)&&"data-"!==n.substr(0,5)&&"role"!==n||(t[n]=e[n]),t}),{})},t.getLeft=function(e,t){return d("left","offsetWidth","right",e,t)},t.getTop=function(e,t){return d("top","offsetHeight","bottom",e,t)};var i=o(n(5954));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=[];return i.default.Children.forEach(e,(function(e){e&&t.push(e)})),t}function s(e,t){e.transform=t,e.webkitTransform=t,e.mozTransform=t}function u(e){return"left"===e||"right"===e}function c(e,t){return+window.getComputedStyle(e).getPropertyValue(t).replace("px","")}function l(e,t){return+e.getPropertyValue(t).replace("px","")}function d(e,t,n,r,i){var o=c(i,"padding-"+e);if(!r||!r.parentNode)return o;var a=r.parentNode.childNodes;return Array.prototype.some.call(a,(function(i){var a=window.getComputedStyle(i);return i!==r?(o+=l(a,"margin-"+e),o+=i[t],o+=l(a,"margin-"+n),"content-box"===a.boxSizing&&(o+=l(a,"border-"+e+"-width")+l(a,"border-"+n+"-width")),!1):(o+=l(a,"margin-"+e),!0)})),o}},11011:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i,o,a=n(12101).codes,s=a.ERR_AMBIGUOUS_ARGUMENT,u=a.ERR_INVALID_ARG_TYPE,c=a.ERR_INVALID_ARG_VALUE,l=a.ERR_INVALID_RETURN_VALUE,d=a.ERR_MISSING_ARGS,f=n(82323),p=n(89615).inspect,h=n(89615).types,v=h.isPromise,m=h.isRegExp,y=Object.assign?Object.assign:n(72505).assign,g=Object.is?Object.is:n(16650);function b(){var e=n(2642);i=e.isDeepEqual,o=e.isDeepStrictEqual}new Map;var x=!1,_=e.exports=T,w={};function M(e){if(e.message instanceof Error)throw e.message;throw new f(e)}function S(e,t,n,r){if(!n){var i=!1;if(0===t)i=!0,r="No value argument passed to `assert.ok()`";else if(r instanceof Error)throw r;var o=new f({actual:n,expected:!0,message:r,operator:"==",stackStartFn:e});throw o.generatedMessage=i,o}}function T(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[T,t.length].concat(t))}_.fail=function e(t,n,r,i,o){var a,s=arguments.length;if(0===s)a="Failed";else if(1===s)r=t,t=void 0;else{if(!1===x){x=!0;var u=process.emitWarning?process.emitWarning:console.warn.bind(console);u("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}2===s&&(i="!=")}if(r instanceof Error)throw r;var c={actual:t,expected:n,operator:void 0===i?"fail":i,stackStartFn:o||e};void 0!==r&&(c.message=r);var l=new f(c);throw a&&(l.message=a,l.generatedMessage=!0),l},_.AssertionError=f,_.ok=T,_.equal=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");t!=n&&M({actual:t,expected:n,message:r,operator:"==",stackStartFn:e})},_.notEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");t==n&&M({actual:t,expected:n,message:r,operator:"!=",stackStartFn:e})},_.deepEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");void 0===i&&b(),i(t,n)||M({actual:t,expected:n,message:r,operator:"deepEqual",stackStartFn:e})},_.notDeepEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");void 0===i&&b(),i(t,n)&&M({actual:t,expected:n,message:r,operator:"notDeepEqual",stackStartFn:e})},_.deepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");void 0===i&&b(),o(t,n)||M({actual:t,expected:n,message:r,operator:"deepStrictEqual",stackStartFn:e})},_.notDeepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");void 0===i&&b(),o(t,n)&&M({actual:t,expected:n,message:r,operator:"notDeepStrictEqual",stackStartFn:e})},_.strictEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");g(t,n)||M({actual:t,expected:n,message:r,operator:"strictEqual",stackStartFn:e})},_.notStrictEqual=function e(t,n,r){if(arguments.length<2)throw new d("actual","expected");g(t,n)&&M({actual:t,expected:n,message:r,operator:"notStrictEqual",stackStartFn:e})};var E=function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.forEach((function(e){e in t&&(void 0!==r&&"string"==typeof r[e]&&m(t[e])&&t[e].test(r[e])?i[e]=r[e]:i[e]=t[e])}))};function k(e,t,n,r,i,a){if(!(n in e)||!o(e[n],t[n])){if(!r){var s=new E(e,i),u=new E(t,i,e),c=new f({actual:s,expected:u,operator:"deepStrictEqual",stackStartFn:a});throw c.actual=e,c.expected=t,c.operator=a.name,c}M({actual:e,expected:t,message:r,operator:a.name,stackStartFn:a})}}function A(e,t,n,o){if("function"!=typeof t){if(m(t))return t.test(e);if(2===arguments.length)throw new u("expected",["Function","RegExp"],t);if("object"!==r(e)||null===e){var a=new f({actual:e,expected:t,message:n,operator:"deepStrictEqual",stackStartFn:o});throw a.operator=o.name,a}var s=Object.keys(t);if(t instanceof Error)s.push("name","message");else if(0===s.length)throw new c("error",t,"may not be an empty object");return void 0===i&&b(),s.forEach((function(r){"string"==typeof e[r]&&m(t[r])&&t[r].test(e[r])||k(e,t,r,n,s,o)})),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function P(e){if("function"!=typeof e)throw new u("fn","Function",e);try{e()}catch(e){return e}return w}function C(e){return v(e)||null!==e&&"object"===r(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function O(e){return Promise.resolve().then((function(){var t;if("function"==typeof e){if(!C(t=e()))throw new l("instance of Promise","promiseFn",t)}else{if(!C(e))throw new u("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((function(){return t})).then((function(){return w})).catch((function(e){return e}))}))}function I(e,t,n,i){if("string"==typeof n){if(4===arguments.length)throw new u("error",["Object","Error","Function","RegExp"],n);if("object"===r(t)&&null!==t){if(t.message===n)throw new s("error/message",'The error message "'.concat(t.message,'" is identical to the message.'))}else if(t===n)throw new s("error/message",'The error "'.concat(t,'" is identical to the message.'));i=n,n=void 0}else if(null!=n&&"object"!==r(n)&&"function"!=typeof n)throw new u("error",["Object","Error","Function","RegExp"],n);if(t===w){var o="";n&&n.name&&(o+=" (".concat(n.name,")")),o+=i?": ".concat(i):".";var a="rejects"===e.name?"rejection":"exception";M({actual:void 0,expected:n,operator:e.name,message:"Missing expected ".concat(a).concat(o),stackStartFn:e})}if(n&&!A(t,n,i,e))throw t}function R(e,t,n,r){if(t!==w){if("string"==typeof n&&(r=n,n=void 0),!n||A(t,n)){var i=r?": ".concat(r):".",o="doesNotReject"===e.name?"rejection":"exception";M({actual:t,expected:n,operator:e.name,message:"Got unwanted ".concat(o).concat(i,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function N(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S.apply(void 0,[N,t.length].concat(t))}_.throws=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];I.apply(void 0,[e,P(t)].concat(r))},_.rejects=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return O(t).then((function(t){return I.apply(void 0,[e,t].concat(r))}))},_.doesNotThrow=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];R.apply(void 0,[e,P(t)].concat(r))},_.doesNotReject=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return O(t).then((function(t){return R.apply(void 0,[e,t].concat(r))}))},_.ifError=function e(t){if(null!=t){var n="ifError got unwanted exception: ";"object"===r(t)&&"string"==typeof t.message?0===t.message.length&&t.constructor?n+=t.constructor.name:n+=t.message:n+=p(t);var i=new f({actual:t,expected:null,operator:"ifError",message:n,stackStartFn:e}),o=t.stack;if("string"==typeof o){var a=o.split("\n");a.shift();for(var s=i.stack.split("\n"),u=0;u<a.length;u++){var c=s.indexOf(a[u]);if(-1!==c){s=s.slice(0,c);break}}i.stack="".concat(s.join("\n"),"\n").concat(a.join("\n"))}throw i}},_.strict=y(N,_,{equal:_.strictEqual,deepEqual:_.deepStrictEqual,notEqual:_.notStrictEqual,notDeepEqual:_.notDeepStrictEqual}),_.strict.strict=_.strict},82323:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return c(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)},s(e)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function c(e,t,n){return c=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&l(i,n.prototype),i},c.apply(null,arguments)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var p=n(89615).inspect,h=n(12101).codes.ERR_INVALID_ARG_TYPE;function v(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}var m="",y="",g="",b="",x={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function _(e){var t=Object.keys(e),n=Object.create(Object.getPrototypeOf(e));return t.forEach((function(t){n[t]=e[t]})),Object.defineProperty(n,"message",{value:e.message}),n}function w(e){return p(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}var M=function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),"object"!==f(e)||null===e)throw new h("options","Object",e);var r=e.message,i=e.operator,s=e.stackStartFn,u=e.actual,c=e.expected,l=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=r)n=o(this,d(t).call(this,String(r)));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&1!==process.stderr.getColorDepth()?(m="[34m",y="[32m",b="[39m",g="[31m"):(m="",y="",b="",g="")),"object"===f(u)&&null!==u&&"object"===f(c)&&null!==c&&"stack"in u&&u instanceof Error&&"stack"in c&&c instanceof Error&&(u=_(u),c=_(c)),"deepStrictEqual"===i||"strictEqual"===i)n=o(this,d(t).call(this,function(e,t,n){var r="",i="",o=0,a="",s=!1,u=w(e),c=u.split("\n"),l=w(t).split("\n"),d=0,p="";if("strictEqual"===n&&"object"===f(e)&&"object"===f(t)&&null!==e&&null!==t&&(n="strictEqualObject"),1===c.length&&1===l.length&&c[0]!==l[0]){var h=c[0].length+l[0].length;if(h<=10){if(!("object"===f(e)&&null!==e||"object"===f(t)&&null!==t||0===e&&0===t))return"".concat(x[n],"\n\n")+"".concat(c[0]," !== ").concat(l[0],"\n")}else if("strictEqualObject"!==n&&h<(process.stderr&&process.stderr.isTTY?process.stderr.columns:80)){for(;c[0][d]===l[0][d];)d++;d>2&&(p="\n  ".concat(function(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var n=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,n-e.length)}(" ",d),"^"),d=0)}}for(var _=c[c.length-1],M=l[l.length-1];_===M&&(d++<2?a="\n  ".concat(_).concat(a):r=_,c.pop(),l.pop(),0!==c.length&&0!==l.length);)_=c[c.length-1],M=l[l.length-1];var S=Math.max(c.length,l.length);if(0===S){var T=u.split("\n");if(T.length>30)for(T[26]="".concat(m,"...").concat(b);T.length>27;)T.pop();return"".concat(x.notIdentical,"\n\n").concat(T.join("\n"),"\n")}d>3&&(a="\n".concat(m,"...").concat(b).concat(a),s=!0),""!==r&&(a="\n  ".concat(r).concat(a),r="");var E=0,k=x[n]+"\n".concat(y,"+ actual").concat(b," ").concat(g,"- expected").concat(b),A=" ".concat(m,"...").concat(b," Lines skipped");for(d=0;d<S;d++){var P=d-o;if(c.length<d+1)P>1&&d>2&&(P>4?(i+="\n".concat(m,"...").concat(b),s=!0):P>3&&(i+="\n  ".concat(l[d-2]),E++),i+="\n  ".concat(l[d-1]),E++),o=d,r+="\n".concat(g,"-").concat(b," ").concat(l[d]),E++;else if(l.length<d+1)P>1&&d>2&&(P>4?(i+="\n".concat(m,"...").concat(b),s=!0):P>3&&(i+="\n  ".concat(c[d-2]),E++),i+="\n  ".concat(c[d-1]),E++),o=d,i+="\n".concat(y,"+").concat(b," ").concat(c[d]),E++;else{var C=l[d],O=c[d],I=O!==C&&(!v(O,",")||O.slice(0,-1)!==C);I&&v(C,",")&&C.slice(0,-1)===O&&(I=!1,O+=","),I?(P>1&&d>2&&(P>4?(i+="\n".concat(m,"...").concat(b),s=!0):P>3&&(i+="\n  ".concat(c[d-2]),E++),i+="\n  ".concat(c[d-1]),E++),o=d,i+="\n".concat(y,"+").concat(b," ").concat(O),r+="\n".concat(g,"-").concat(b," ").concat(C),E+=2):(i+=r,r="",1!==P&&0!==d||(i+="\n  ".concat(O),E++))}if(E>20&&d<S-2)return"".concat(k).concat(A,"\n").concat(i,"\n").concat(m,"...").concat(b).concat(r,"\n")+"".concat(m,"...").concat(b)}return"".concat(k).concat(s?A:"","\n").concat(i).concat(r).concat(a).concat(p)}(u,c,i)));else if("notDeepStrictEqual"===i||"notStrictEqual"===i){var p=x[i],M=w(u).split("\n");if("notStrictEqual"===i&&"object"===f(u)&&null!==u&&(p=x.notStrictEqualObject),M.length>30)for(M[26]="".concat(m,"...").concat(b);M.length>27;)M.pop();n=1===M.length?o(this,d(t).call(this,"".concat(p," ").concat(M[0]))):o(this,d(t).call(this,"".concat(p,"\n\n").concat(M.join("\n"),"\n")))}else{var S=w(u),T="",E=x[i];"notDeepEqual"===i||"notEqual"===i?(S="".concat(x[i],"\n\n").concat(S)).length>1024&&(S="".concat(S.slice(0,1021),"...")):(T="".concat(w(c)),S.length>512&&(S="".concat(S.slice(0,509),"...")),T.length>512&&(T="".concat(T.slice(0,509),"...")),"deepEqual"===i||"equal"===i?S="".concat(E,"\n\n").concat(S,"\n\nshould equal\n\n"):T=" ".concat(i," ").concat(T)),n=o(this,d(t).call(this,"".concat(S).concat(T)))}return Error.stackTraceLimit=l,n.generatedMessage=!r,Object.defineProperty(a(n),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),n.code="ERR_ASSERTION",n.actual=u,n.expected=c,n.operator=i,Error.captureStackTrace&&Error.captureStackTrace(a(n),s),n.stack,n.name="AssertionError",o(n)}var n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),n=t,s=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:p.custom,value:function(e,t){return p(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){r(e,t,n[t])}))}return e}({},t,{customInspect:!1,depth:0}))}}],s&&i(n.prototype,s),t}(s(Error));e.exports=M},12101:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}var a,s,u={};function c(e,t,n){n||(n=Error);var a=function(n){function a(n,o,s){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),u=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,i(a).call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,o,s))),u.code=e,u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(a,n),a}(n);u[e]=a}function l(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}c("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),c("ERR_INVALID_ARG_TYPE",(function(e,t,i){var o,s,u,c,d;if(void 0===a&&(a=n(11011)),a("string"==typeof e,"'name' must be a string"),"string"==typeof t&&(s="not ",t.substr(0,s.length)===s)?(o="must not be",t=t.replace(/^not /,"")):o="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))u="The ".concat(e," ").concat(o," ").concat(l(t,"type"));else{var f=("number"!=typeof d&&(d=0),d+".".length>(c=e).length||-1===c.indexOf(".",d)?"argument":"property");u='The "'.concat(e,'" ').concat(f," ").concat(o," ").concat(l(t,"type"))}return u+". Received type ".concat(r(i))}),TypeError),c("ERR_INVALID_ARG_VALUE",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===s&&(s=n(89615));var i=s.inspect(t);return i.length>128&&(i="".concat(i.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(r,". Received ").concat(i)}),TypeError,RangeError),c("ERR_INVALID_RETURN_VALUE",(function(e,t,n){var i;return i=n&&n.constructor&&n.constructor.name?"instance of ".concat(n.constructor.name):"type ".concat(r(n)),"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(i,".")}),TypeError),c("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];void 0===a&&(a=n(11011)),a(t.length>0,"At least one arg needs to be specified");var i="The ",o=t.length;switch(t=t.map((function(e){return'"'.concat(e,'"')})),o){case 1:i+="".concat(t[0]," argument");break;case 2:i+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:i+=t.slice(0,o-1).join(", "),i+=", and ".concat(t[o-1]," arguments")}return"".concat(i," must be specified")}),TypeError),e.exports.codes=u},2642:function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var o=void 0!==/a/g.flags,a=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},s=function(e){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t},u=Object.is?Object.is:n(16650),c=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},l=Number.isNaN?Number.isNaN:n(45450);function d(e){return e.call.bind(e)}var f=d(Object.prototype.hasOwnProperty),p=d(Object.prototype.propertyIsEnumerable),h=d(Object.prototype.toString),v=n(89615).types,m=v.isAnyArrayBuffer,y=v.isArrayBufferView,g=v.isDate,b=v.isMap,x=v.isRegExp,_=v.isSet,w=v.isNativeError,M=v.isBoxedPrimitive,S=v.isNumberObject,T=v.isStringObject,E=v.isBooleanObject,k=v.isBigIntObject,A=v.isSymbolObject,P=v.isFloat32Array,C=v.isFloat64Array;function O(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<48||n>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function I(e){return Object.keys(e).filter(O).concat(c(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}function R(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function N(e,t,n,r){if(e===t)return 0!==e||!n||u(e,t);if(n){if("object"!==i(e))return"number"==typeof e&&l(e)&&l(t);if("object"!==i(t)||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==i(e))return(null===t||"object"!==i(t))&&e==t;if(null===t||"object"!==i(t))return!1}var a,s,c,d,f=h(e);if(f!==h(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var p=I(e),v=I(t);return p.length===v.length&&L(e,t,n,r,1,p)}if("[object Object]"===f&&(!b(e)&&b(t)||!_(e)&&_(t)))return!1;if(g(e)){if(!g(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(x(e)){if(!x(t)||(c=e,d=t,!(o?c.source===d.source&&c.flags===d.flags:RegExp.prototype.toString.call(c)===RegExp.prototype.toString.call(d))))return!1}else if(w(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(y(e)){if(n||!P(e)&&!C(e)){if(!function(e,t){return e.byteLength===t.byteLength&&0===R(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e,t))return!1;var O=I(e),N=I(t);return O.length===N.length&&L(e,t,n,r,0,O)}if(_(e))return!(!_(t)||e.size!==t.size)&&L(e,t,n,r,2);if(b(e))return!(!b(t)||e.size!==t.size)&&L(e,t,n,r,3);if(m(e)){if(s=t,(a=e).byteLength!==s.byteLength||0!==R(new Uint8Array(a),new Uint8Array(s)))return!1}else if(M(e)&&!function(e,t){return S(e)?S(t)&&u(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):T(e)?T(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):E(e)?E(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):k(e)?k(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):A(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}(e,t))return!1}return L(e,t,n,r,0)}function D(e,t){return t.filter((function(t){return p(e,t)}))}function L(e,t,n,r,i,o){if(5===arguments.length){o=Object.keys(e);var a=Object.keys(t);if(o.length!==a.length)return!1}for(var s=0;s<o.length;s++)if(!f(t,o[s]))return!1;if(n&&5===arguments.length){var u=c(e);if(0!==u.length){var l=0;for(s=0;s<u.length;s++){var d=u[s];if(p(e,d)){if(!p(t,d))return!1;o.push(d),l++}else if(p(t,d))return!1}var h=c(t);if(u.length!==h.length&&D(t,h).length!==l)return!1}else{var v=c(t);if(0!==v.length&&0!==D(t,v).length)return!1}}if(0===o.length&&(0===i||1===i&&0===e.length||0===e.size))return!0;if(void 0===r)r={val1:new Map,val2:new Map,position:0};else{var m=r.val1.get(e);if(void 0!==m){var y=r.val2.get(t);if(void 0!==y)return m===y}r.position++}r.val1.set(e,r.position),r.val2.set(t,r.position);var g=G(e,t,n,o,r,i);return r.val1.delete(e),r.val2.delete(t),g}function B(e,t,n,r){for(var i=a(e),o=0;o<i.length;o++){var s=i[o];if(N(t,s,n,r))return e.delete(s),!0}return!1}function F(e){switch(i(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(l(e))return!1}return!0}function j(e,t,n){var r=F(n);return null!=r?r:t.has(r)&&!e.has(r)}function z(e,t,n,r,i){var o=F(n);if(null!=o)return o;var a=t.get(o);return!(void 0===a&&!t.has(o)||!N(r,a,!1,i))&&!e.has(o)&&N(r,a,!1,i)}function U(e,t,n,r,i,o){for(var s=a(e),u=0;u<s.length;u++){var c=s[u];if(N(n,c,i,o)&&N(r,t.get(c),i,o))return e.delete(c),!0}return!1}function G(e,t,n,o,u,c){var l=0;if(2===c){if(!function(e,t,n,r){for(var o=null,s=a(e),u=0;u<s.length;u++){var c=s[u];if("object"===i(c)&&null!==c)null===o&&(o=new Set),o.add(c);else if(!t.has(c)){if(n)return!1;if(!j(e,t,c))return!1;null===o&&(o=new Set),o.add(c)}}if(null!==o){for(var l=a(t),d=0;d<l.length;d++){var f=l[d];if("object"===i(f)&&null!==f){if(!B(o,f,n,r))return!1}else if(!n&&!e.has(f)&&!B(o,f,n,r))return!1}return 0===o.size}return!0}(e,t,n,u))return!1}else if(3===c){if(!function(e,t,n,o){for(var a=null,u=s(e),c=0;c<u.length;c++){var l=r(u[c],2),d=l[0],f=l[1];if("object"===i(d)&&null!==d)null===a&&(a=new Set),a.add(d);else{var p=t.get(d);if(void 0===p&&!t.has(d)||!N(f,p,n,o)){if(n)return!1;if(!z(e,t,d,f,o))return!1;null===a&&(a=new Set),a.add(d)}}}if(null!==a){for(var h=s(t),v=0;v<h.length;v++){var m=r(h[v],2),y=(d=m[0],m[1]);if("object"===i(d)&&null!==d){if(!U(a,e,d,y,n,o))return!1}else if(!(n||e.has(d)&&N(e.get(d),y,!1,o)||U(a,e,d,y,!1,o)))return!1}return 0===a.size}return!0}(e,t,n,u))return!1}else if(1===c)for(;l<e.length;l++){if(!f(e,l)){if(f(t,l))return!1;for(var d=Object.keys(e);l<d.length;l++){var p=d[l];if(!f(t,p)||!N(e[p],t[p],n,u))return!1}return d.length===Object.keys(t).length}if(!f(t,l)||!N(e[l],t[l],n,u))return!1}for(l=0;l<o.length;l++){var h=o[l];if(!N(e[h],t[h],n,u))return!1}return!0}e.exports={isDeepEqual:function(e,t){return N(e,t,!1)},isDeepStrictEqual:function(e,t){return N(e,t,!0)}}},57572:function(e){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},64574:function(e,t,n){"use strict";var r=n(85614),i=n(95905),o=n(13873),a=n(69757);function s(e){return e.call.bind(e)}var u="undefined"!=typeof BigInt,c="undefined"!=typeof Symbol,l=s(Object.prototype.toString),d=s(Number.prototype.valueOf),f=s(String.prototype.valueOf),p=s(Boolean.prototype.valueOf);if(u)var h=s(BigInt.prototype.valueOf);if(c)var v=s(Symbol.prototype.valueOf);function m(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function y(e){return"[object Map]"===l(e)}function g(e){return"[object Set]"===l(e)}function b(e){return"[object WeakMap]"===l(e)}function x(e){return"[object WeakSet]"===l(e)}function _(e){return"[object ArrayBuffer]"===l(e)}function w(e){return"undefined"!=typeof ArrayBuffer&&(_.working?_(e):e instanceof ArrayBuffer)}function M(e){return"[object DataView]"===l(e)}function S(e){return"undefined"!=typeof DataView&&(M.working?M(e):e instanceof DataView)}t.isArgumentsObject=r,t.isGeneratorFunction=i,t.isTypedArray=a,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):a(e)||S(e)},t.isUint8Array=function(e){return"Uint8Array"===o(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===o(e)},t.isUint16Array=function(e){return"Uint16Array"===o(e)},t.isUint32Array=function(e){return"Uint32Array"===o(e)},t.isInt8Array=function(e){return"Int8Array"===o(e)},t.isInt16Array=function(e){return"Int16Array"===o(e)},t.isInt32Array=function(e){return"Int32Array"===o(e)},t.isFloat32Array=function(e){return"Float32Array"===o(e)},t.isFloat64Array=function(e){return"Float64Array"===o(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===o(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===o(e)},y.working="undefined"!=typeof Map&&y(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(y.working?y(e):e instanceof Map)},g.working="undefined"!=typeof Set&&g(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(g.working?g(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},x.working="undefined"!=typeof WeakSet&&x(new WeakSet),t.isWeakSet=function(e){return x(e)},_.working="undefined"!=typeof ArrayBuffer&&_(new ArrayBuffer),t.isArrayBuffer=w,M.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&M(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=S;var T="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function E(e){return"[object SharedArrayBuffer]"===l(e)}function k(e){return void 0!==T&&(void 0===E.working&&(E.working=E(new T)),E.working?E(e):e instanceof T)}function A(e){return m(e,d)}function P(e){return m(e,f)}function C(e){return m(e,p)}function O(e){return u&&m(e,h)}function I(e){return c&&m(e,v)}t.isSharedArrayBuffer=k,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=A,t.isStringObject=P,t.isBooleanObject=C,t.isBigIntObject=O,t.isSymbolObject=I,t.isBoxedPrimitive=function(e){return A(e)||P(e)||C(e)||O(e)||I(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(w(e)||k(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},89615:function(e,t,n){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])m(s)||!_(s)?a+=" "+s:a+=" "+u(s);return a},t.deprecate=function(e,n){if("undefined"!=typeof process&&!0===process.noDeprecation)return e;if("undefined"==typeof process)return function(){return t.deprecate(e,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),r=!0}return e.apply(this,arguments)}};var o={},a=/^$/;if({NODE_ENV:"production",PUBLIC_URL:"https://cdn.cogniteapp.com/cdf-datastudio/v.670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SENTRY_DSN:"https://d09f6d3557114e6cbaa63b56d7ef86cc@o124058.ingest.sentry.io/1288725",REACT_APP_APP_ID:"cdf-datastudio",REACT_APP_LOCIZE_PROJECT_ID:"0774e318-387b-4e68-94cc-7b270321bbf1",REACT_APP_VERSION_NAME:"1.2.28",REACT_APP_VERSION_SHA:"670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",REACT_APP_RELEASE_ID:"cdf-datastudio-1.2.28-670ad52"}.NODE_DEBUG){var s={NODE_ENV:"production",PUBLIC_URL:"https://cdn.cogniteapp.com/cdf-datastudio/v.670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SENTRY_DSN:"https://d09f6d3557114e6cbaa63b56d7ef86cc@o124058.ingest.sentry.io/1288725",REACT_APP_APP_ID:"cdf-datastudio",REACT_APP_LOCIZE_PROJECT_ID:"0774e318-387b-4e68-94cc-7b270321bbf1",REACT_APP_VERSION_NAME:"1.2.28",REACT_APP_VERSION_SHA:"670ad5212e9e1c6ff43fd86e3fe9e45166bd7ef0",REACT_APP_RELEASE_ID:"cdf-datastudio-1.2.28-670ad52"}.NODE_DEBUG;s=s.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+s+"$","i")}function u(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),d(r,e,r.depth)}function c(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function l(e,t){return e}function d(e,n,r){if(e.customInspect&&n&&S(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return g(i)||(i=d(e,i,r)),i}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):v(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),M(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(S(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(x(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(M(n))return f(n)}var c,l="",_=!1,T=["{","}"];return h(n)&&(_=!0,T=["[","]"]),S(n)&&(l=" [Function"+(n.name?": "+n.name:"")+"]"),x(n)&&(l=" "+RegExp.prototype.toString.call(n)),w(n)&&(l=" "+Date.prototype.toUTCString.call(n)),M(n)&&(l=" "+f(n)),0!==a.length||_&&0!=n.length?r<0?x(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=_?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)P(t,String(a))?o.push(p(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(e,t,n,r,i,!0))})),o}(e,n,r,s,a):a.map((function(t){return p(e,n,r,s,t,_)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,T)):T[0]+l+T[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),P(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=m(n)?d(e,u.value,null):d(e,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),b(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function g(e){return"string"==typeof e}function b(e){return void 0===e}function x(e){return _(e)&&"[object RegExp]"===T(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===T(e)}function M(e){return _(e)&&("[object Error]"===T(e)||e instanceof Error)}function S(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!o[e])if(a.test(e)){var n=process.pid;o[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else o[e]=function(){};return o[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(64574),t.isArray=h,t.isBoolean=v,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=x,t.types.isRegExp=x,t.isObject=_,t.isDate=w,t.types.isDate=w,t.isError=M,t.types.isNativeError=M,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(57572);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),k[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",A(),t.format.apply(t,arguments))},t.inherits=n(29785),t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=C,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var r=t.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return r.apply(i,arguments)};e.apply(this,t).then((function(e){process.nextTick(o.bind(null,null,e))}),(function(e){process.nextTick(O.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}},49685:function(e,t,n){"use strict";var r=n(49749),i=n(6537),o=i(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&o(e,".prototype.")>-1?i(n):n}},6537:function(e,t,n){"use strict";var r=n(45923),i=n(49749),o=i("%Function.prototype.apply%"),a=i("%Function.prototype.call%"),s=i("%Reflect.apply%",!0)||r.call(a,o),u=i("%Object.getOwnPropertyDescriptor%",!0),c=i("%Object.defineProperty%",!0),l=i("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=s(r,a,arguments);if(u&&c){var n=u(t,"length");n.configurable&&c(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var d=function(){return s(r,o,arguments)};c?c(e.exports,"apply",{value:d}):e.exports.apply=d},1380:function(e,t){var n="undefined"!=typeof self?self:this,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,a="ArrayBuffer"in e;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function v(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var e,t,n,r=p(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=h(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=c(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[c(e)]},f.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},f.prototype.set=function(e,t){this.map[c(e)]=l(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n,r,i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),g.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function x(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var w=[301,302,303,307,308];_.redirect=function(e,t){if(-1===w.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function M(e,n){return new Promise((function(r,o){var a=new b(e,n);if(a.signal&&a.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;r(new _(i,n))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),a.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",u)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}M.polyfill=!0,e.fetch||(e.fetch=M,e.Headers=f,e.Request=b,e.Response=_),t.Headers=f,t.Request=b,t.Response=_,t.fetch=M,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},46813:function(e,t,n){"use strict";var r=n(13456),i=n(85614),o=n(16650),a=n(93271),s=n(38962),u=n(7642),c=n(1862),l=n(3601),d=n(49749),f=n(49685),p=n(68885),h=n(72755),v=n(50573),m=n(13873),y=n(54660),g=f("Date.prototype.getTime"),b=Object.getPrototypeOf,x=f("Object.prototype.toString"),_=d("%Set%",!0),w=f("Map.prototype.has",!0),M=f("Map.prototype.get",!0),S=f("Map.prototype.size",!0),T=f("Set.prototype.add",!0),E=f("Set.prototype.delete",!0),k=f("Set.prototype.has",!0),A=f("Set.prototype.size",!0);function P(e,t,n,r){for(var i,o=h(e);(i=o.next())&&!i.done;)if(N(t,i.value,n,r))return E(e,i.value),!0;return!1}function C(e){return void 0===e?null:"object"!=typeof e?"symbol"!=typeof e&&("string"!=typeof e&&"number"!=typeof e||+e==+e):void 0}function O(e,t,n,r,i,o){var a=C(n);if(null!=a)return a;var s=M(t,a),u=y({},i,{strict:!1});return!(void 0===s&&!w(t,a)||!N(r,s,u,o))&&!w(e,a)&&N(r,s,u,o)}function I(e,t,n){var r=C(n);return null!=r?r:k(t,r)&&!k(e,r)}function R(e,t,n,r,i,o){for(var a,s,u=h(e);(a=u.next())&&!a.done;)if(N(n,s=a.value,i,o)&&N(r,M(t,s),i,o))return E(e,s),!0;return!1}function N(e,t,n,d){var f=n||{};if(f.strict?o(e,t):e===t)return!0;if(l(e)!==l(t))return!1;if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return f.strict?o(e,t):e==t;var v,E=d.has(e),C=d.has(t);if(E&&C){if(d.get(e)===d.get(t))return!0}else v={};return E||d.set(e,v),C||d.set(t,v),function(e,t,n,o){var l,d;if(typeof e!=typeof t)return!1;if(null==e||null==t)return!1;if(x(e)!==x(t))return!1;if(i(e)!==i(t))return!1;if(u(e)!==u(t))return!1;var f=e instanceof Error,v=t instanceof Error;if(f!==v)return!1;if((f||v)&&(e.name!==t.name||e.message!==t.message))return!1;var E=a(e),C=a(t);if(E!==C)return!1;if((E||C)&&(e.source!==t.source||s(e)!==s(t)))return!1;var L=c(e),B=c(t);if(L!==B)return!1;if((L||B)&&g(e)!==g(t))return!1;if(n.strict&&b&&b(e)!==b(t))return!1;if(m(e)!==m(t))return!1;var F=D(e),j=D(t);if(F!==j)return!1;if(F||j){if(e.length!==t.length)return!1;for(l=0;l<e.length;l++)if(e[l]!==t[l])return!1;return!0}if(typeof e!=typeof t)return!1;var z=r(e),U=r(t);if(z.length!==U.length)return!1;for(z.sort(),U.sort(),l=z.length-1;l>=0;l--)if(z[l]!=U[l])return!1;for(l=z.length-1;l>=0;l--)if(!N(e[d=z[l]],t[d],n,o))return!1;var G=p(e),V=p(t);return G===V&&("Set"===G||"Set"===V?function(e,t,n,r){if(A(e)!==A(t))return!1;for(var i,o,a,s=h(e),u=h(t);(i=s.next())&&!i.done;)if(i.value&&"object"==typeof i.value)a||(a=new _),T(a,i.value);else if(!k(t,i.value)){if(n.strict)return!1;if(!I(e,t,i.value))return!1;a||(a=new _),T(a,i.value)}if(a){for(;(o=u.next())&&!o.done;)if(o.value&&"object"==typeof o.value){if(!P(a,o.value,n.strict,r))return!1}else if(!n.strict&&!k(e,o.value)&&!P(a,o.value,n.strict,r))return!1;return 0===A(a)}return!0}(e,t,n,o):"Map"!==G||function(e,t,n,r){if(S(e)!==S(t))return!1;for(var i,o,a,s,u,c,l=h(e),d=h(t);(i=l.next())&&!i.done;)if(s=i.value[0],u=i.value[1],s&&"object"==typeof s)a||(a=new _),T(a,s);else if(void 0===(c=M(t,s))&&!w(t,s)||!N(u,c,n,r)){if(n.strict)return!1;if(!O(e,t,s,u,n,r))return!1;a||(a=new _),T(a,s)}if(a){for(;(o=d.next())&&!o.done;)if(s=o.value[0],c=o.value[1],s&&"object"==typeof s){if(!R(a,e,s,c,n,r))return!1}else if(!(n.strict||e.has(s)&&N(M(e,s),c,n,r)||R(a,e,s,c,y({},n,{strict:!1}),r)))return!1;return 0===A(a)}return!0}(e,t,n,o))}(e,t,f,d)}function D(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0]||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))}e.exports=function(e,t,n){return N(e,t,n,v())}},7642:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},92795:function(e,t,n){"use strict";var r=n(13456),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,u=n(49249)(),c=s&&u,l=function(e,t,n,r){var i;(!(t in e)||"function"==typeof(i=r)&&"[object Function]"===o.call(i)&&r())&&(c?s(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},d=function(e,t){var n=arguments.length>2?arguments[2]:{},o=r(t);i&&(o=a.call(o,Object.getOwnPropertySymbols(t)));for(var s=0;s<o.length;s+=1)l(e,o[s],t[o[s]],n[o[s]])};d.supportsDescriptors=!!c,e.exports=d},12816:function(e){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},72505:function(e){"use strict";function t(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o=Object.keys(Object(i)),a=0,s=o.length;a<s;a++){var u=o[a],c=Object.getOwnPropertyDescriptor(i,u);void 0!==c&&c.enumerable&&(n[u]=i[u])}}return n}e.exports={assign:t,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:t})}}},20551:function(e){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString;e.exports=function(e,r,i){if("[object Function]"!==n.call(r))throw new TypeError("iterator must be a function");var o=e.length;if(o===+o)for(var a=0;a<o;a++)r.call(i,e[a],a,e);else for(var s in e)t.call(e,s)&&r.call(i,e[s],s,e)}},19627:function(e){"use strict";var t="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,r=Object.prototype.toString,i="[object Function]";e.exports=function(e){var o=this;if("function"!=typeof o||r.call(o)!==i)throw new TypeError(t+o);for(var a,s=n.call(arguments,1),u=function(){if(this instanceof a){var t=o.apply(this,s.concat(n.call(arguments)));return Object(t)===t?t:this}return o.apply(e,s.concat(n.call(arguments)))},c=Math.max(0,o.length-s.length),l=[],d=0;d<c;d++)l.push("$"+d);if(a=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(u),o.prototype){var f=function(){};f.prototype=o.prototype,a.prototype=new f,f.prototype=null}return a}},45923:function(e,t,n){"use strict";var r=n(19627);e.exports=Function.prototype.bind||r},77616:function(e){"use strict";var t=function(){return"string"==typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(e){n=null}t.functionsHaveConfigurableNames=function(){if(!t()||!n)return!1;var e=n((function(){}),"name");return!!e&&!!e.configurable};var r=Function.prototype.bind;t.boundFunctionsHaveNames=function(){return t()&&"function"==typeof r&&""!==function(){}.bind().name},e.exports=t},49749:function(e,t,n){"use strict";var r,i=SyntaxError,o=Function,a=TypeError,s=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var c=function(){throw new a},l=u?function(){try{return c}catch(e){try{return u(arguments,"callee").get}catch(e){return c}}}():c,d=n(85424)(),f=Object.getPrototypeOf||function(e){return e.__proto__},p={},h="undefined"==typeof Uint8Array?r:f(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":d?f([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?f(f([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?f((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?f((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?f(""[Symbol.iterator]()):r,"%Symbol%":d?Symbol:r,"%SyntaxError%":i,"%ThrowTypeError%":l,"%TypedArray%":h,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet},m=function e(t){var n;if("%AsyncFunction%"===t)n=s("async function () {}");else if("%GeneratorFunction%"===t)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=s("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(n=f(i.prototype))}return v[t]=n,n},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=n(45923),b=n(27845),x=g.call(Function.call,Array.prototype.concat),_=g.call(Function.apply,Array.prototype.splice),w=g.call(Function.call,String.prototype.replace),M=g.call(Function.call,String.prototype.slice),S=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,E=function(e){var t=M(e,0,1),n=M(e,-1);if("%"===t&&"%"!==n)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var r=[];return w(e,S,(function(e,t,n,i){r[r.length]=n?w(i,T,"$1"):t||e})),r},k=function(e,t){var n,r=e;if(b(y,r)&&(r="%"+(n=y[r])[0]+"%"),b(v,r)){var o=v[r];if(o===p&&(o=m(r)),void 0===o&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a('"allowMissing" argument must be a boolean');var n=E(e),r=n.length>0?n[0]:"",o=k("%"+r+"%",t),s=o.name,c=o.value,l=!1,d=o.alias;d&&(r=d[0],_(n,x([0,1],d)));for(var f=1,p=!0;f<n.length;f+=1){var h=n[f],m=M(h,0,1),y=M(h,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new i("property names with quotes must have matching quotes");if("constructor"!==h&&p||(l=!0),b(v,s="%"+(r+="."+h)+"%"))c=v[s];else if(null!=c){if(!(h in c)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&f+1>=n.length){var g=u(c,h);c=(p=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:c[h]}else p=b(c,h),c=c[h];p&&!l&&(v[s]=c)}}return c}},66796:function(e){e.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},96290:function(e){"use strict";var t="undefined"!=typeof BigInt&&BigInt;e.exports=function(){return"function"==typeof t&&"function"==typeof BigInt&&"bigint"==typeof t(42)&&"bigint"==typeof BigInt(42)}},49249:function(e,t,n){"use strict";var r=n(49749)("%Object.defineProperty%",!0),i=function(){if(r)try{return r({},"a",{value:1}),!0}catch(e){return!1}return!1};i.hasArrayLengthDefineBug=function(){if(!i())return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},85424:function(e,t,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n(42502);e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&i()}},42502:function(e){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},56573:function(e,t,n){"use strict";var r=n(42502);e.exports=function(){return r()&&!!Symbol.toStringTag}},27845:function(e,t,n){"use strict";var r=n(45923);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},29785:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},85614:function(e,t,n){"use strict";var r=n(56573)(),i=n(49685)("Object.prototype.toString"),o=function(e){return!(r&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},a=function(e){return!!o(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},s=function(){return o(arguments)}();o.isLegacyArguments=a,e.exports=s?o:a},21338:function(e,t,n){"use strict";if(n(96290)()){var r=BigInt.prototype.valueOf;e.exports=function(e){return null!=e&&"boolean"!=typeof e&&"string"!=typeof e&&"number"!=typeof e&&"symbol"!=typeof e&&"function"!=typeof e&&("bigint"==typeof e||function(e){try{return r.call(e),!0}catch(e){}return!1}(e))}}else e.exports=function(e){return!1}},33684:function(e,t,n){"use strict";var r=n(49685),i=r("Boolean.prototype.toString"),o=r("Object.prototype.toString"),a=n(56573)();e.exports=function(e){return"boolean"==typeof e||null!==e&&"object"==typeof e&&(a&&Symbol.toStringTag in e?function(e){try{return i(e),!0}catch(e){return!1}}(e):"[object Boolean]"===o(e))}},26624:function(e){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},1862:function(e,t,n){"use strict";var r=Date.prototype.getDay,i=Object.prototype.toString,o=n(56573)();e.exports=function(e){return"object"==typeof e&&null!==e&&(o?function(e){try{return r.call(e),!0}catch(e){return!1}}(e):"[object Date]"===i.call(e))}},95905:function(e,t,n){"use strict";var r,i=Object.prototype.toString,o=Function.prototype.toString,a=/^\s*(?:function)?\*/,s=n(56573)(),u=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(a.test(o.call(e)))return!0;if(!s)return"[object GeneratorFunction]"===i.call(e);if(!u)return!1;if(void 0===r){var t=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch(e){}}();r=!!t&&u(t)}return u(e)===r}},26257:function(e){"use strict";var t,n="function"==typeof Map&&Map.prototype?Map:null,r="function"==typeof Set&&Set.prototype?Set:null;n||(t=function(e){return!1});var i=n?Map.prototype.has:null,o=r?Set.prototype.has:null;t||i||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(i.call(e),o)try{o.call(e)}catch(e){return!0}return e instanceof n}catch(e){}return!1}},46788:function(e){"use strict";e.exports=function(e){return e!=e}},45450:function(e,t,n){"use strict";var r=n(6537),i=n(92795),o=n(46788),a=n(91668),s=n(11317),u=r(a(),Number);i(u,{getPolyfill:a,implementation:o,shim:s}),e.exports=u},91668:function(e,t,n){"use strict";var r=n(46788);e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:r}},11317:function(e,t,n){"use strict";var r=n(92795),i=n(91668);e.exports=function(){var e=i();return r(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}},69193:function(e,t,n){"use strict";var r=Number.prototype.toString,i=Object.prototype.toString,o=n(56573)();e.exports=function(e){return"number"==typeof e||"object"==typeof e&&(o?function(e){try{return r.call(e),!0}catch(e){return!1}}(e):"[object Number]"===i.call(e))}},93271:function(e,t,n){"use strict";var r,i,o,a,s=n(49685),u=n(56573)();if(u){r=s("Object.prototype.hasOwnProperty"),i=s("RegExp.prototype.exec"),o={};var c=function(){throw o};a={toString:c,valueOf:c},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=c)}var l=s("Object.prototype.toString"),d=Object.getOwnPropertyDescriptor;e.exports=u?function(e){if(!e||"object"!=typeof e)return!1;var t=d(e,"lastIndex");if(!t||!r(t,"value"))return!1;try{i(e,a)}catch(e){return e===o}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===l(e)}},12535:function(e){"use strict";var t,n="function"==typeof Map&&Map.prototype?Map:null,r="function"==typeof Set&&Set.prototype?Set:null;r||(t=function(e){return!1});var i=n?Map.prototype.has:null,o=r?Set.prototype.has:null;t||o||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(o.call(e),i)try{i.call(e)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},71e3:function(e,t,n){"use strict";var r=String.prototype.valueOf,i=Object.prototype.toString,o=n(56573)();e.exports=function(e){return"string"==typeof e||"object"==typeof e&&(o?function(e){try{return r.call(e),!0}catch(e){return!1}}(e):"[object String]"===i.call(e))}},48623:function(e,t,n){"use strict";var r=Object.prototype.toString;if(n(85424)()){var i=Symbol.prototype.toString,o=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==r.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&o.test(i.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},69757:function(e,t,n){"use strict";var r=n(20551),i=n(47781),o=n(49685),a=o("Object.prototype.toString"),s=n(56573)(),u="undefined"==typeof globalThis?n.g:globalThis,c=i(),l=o("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},d=o("String.prototype.slice"),f={},p=n(66853),h=Object.getPrototypeOf;s&&p&&h&&r(c,(function(e){var t=new u[e];if(Symbol.toStringTag in t){var n=h(t),r=p(n,Symbol.toStringTag);if(!r){var i=h(n);r=p(i,Symbol.toStringTag)}f[e]=r.get}})),e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!s||!(Symbol.toStringTag in e)){var t=d(a(e),8,-1);return l(c,t)>-1}return!!p&&function(e){var t=!1;return r(f,(function(n,r){if(!t)try{t=n.call(e)===r}catch(e){}})),t}(e)}},456:function(e){"use strict";var t,n="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,r="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;n||(t=function(e){return!1});var i=n?n.prototype.has:null,o=r?r.prototype.has:null;t||i||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(i.call(e,i),o)try{o.call(e,o)}catch(e){return!0}return e instanceof n}catch(e){}return!1}},77581:function(e,t,n){"use strict";var r=n(49749),i=n(49685),o=r("%WeakSet%",!0),a=i("WeakSet.prototype.has",!0);if(a){var s=i("WeakMap.prototype.has",!0);e.exports=function(e){if(!e||"object"!=typeof e)return!1;try{if(a(e,a),s)try{s(e,s)}catch(e){return!0}return e instanceof o}catch(e){}return!1}}else e.exports=function(e){return!1}},5648:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},10682:function(e){e.exports=function(e){return e.split("")}},46137:function(e,t,n){var r=n(92539),i=n(58971);e.exports=function(e,t){return e&&r(t,i(t),e)}},64347:function(e,t,n){var r=n(92539),i=n(50553);e.exports=function(e,t){return e&&r(t,i(t),e)}},82667:function(e,t,n){var r=n(24281),i=n(5648),o=n(93919),a=n(46137),s=n(64347),u=n(69738),c=n(54624),l=n(73444),d=n(72595),f=n(31621),p=n(44874),h=n(64198),v=n(15785),m=n(40744),y=n(75007),g=n(13863),b=n(78099),x=n(78117),_=n(74634),w=n(48934),M=n(58971),S=n(50553),T="[object Arguments]",E="[object Function]",k="[object Object]",A={};A[T]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A[k]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A[E]=A["[object WeakMap]"]=!1,e.exports=function e(t,n,P,C,O,I){var R,N=1&n,D=2&n,L=4&n;if(P&&(R=O?P(t,C,O,I):P(t)),void 0!==R)return R;if(!_(t))return t;var B=g(t);if(B){if(R=v(t),!N)return c(t,R)}else{var F=h(t),j=F==E||"[object GeneratorFunction]"==F;if(b(t))return u(t,N);if(F==k||F==T||j&&!O){if(R=D||j?{}:y(t),!N)return D?d(t,s(R,t)):l(t,a(R,t))}else{if(!A[F])return O?t:{};R=m(t,F,N)}}I||(I=new r);var z=I.get(t);if(z)return z;I.set(t,R),w(t)?t.forEach((function(r){R.add(e(r,n,P,r,t,I))})):x(t)&&t.forEach((function(r,i){R.set(i,e(r,n,P,i,t,I))}));var U=B?void 0:(L?D?p:f:D?S:M)(t);return i(U||t,(function(r,i){U&&(r=t[i=r]),o(R,i,e(r,n,P,i,t,I))})),R}},65706:function(e){var t=Math.max,n=Math.min;e.exports=function(e,r,i){return e>=n(r,i)&&e<t(r,i)}},38744:function(e,t,n){var r=n(64198),i=n(58852);e.exports=function(e){return i(e)&&"[object Map]"==r(e)}},77420:function(e,t,n){var r=n(96472),i=n(58852);e.exports=function(e){return i(e)&&"[object RegExp]"==r(e)}},56912:function(e,t,n){var r=n(64198),i=n(58852);e.exports=function(e){return i(e)&&"[object Set]"==r(e)}},16587:function(e){var t=Math.ceil,n=Math.max;e.exports=function(e,r,i,o){for(var a=-1,s=n(t((r-e)/(i||1)),0),u=Array(s);s--;)u[o?s:++a]=e,e+=i;return u}},56984:function(e,t,n){var r=n(76927);e.exports=function(e,t){var n;return r(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}},83810:function(e,t,n){var r=n(30462);e.exports=function(e,t){return r(t,(function(t){return[t,e[t]]}))}},12497:function(e,t,n){var r=n(16306),i=n(69462),o=n(59978),a=n(7549);e.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[a(i(t))]}},32802:function(e,t,n){var r=n(47854);e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n)}},58544:function(e,t,n){var r=n(62203);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},53339:function(e){var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},11065:function(e,t,n){var r=n(43799),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},73444:function(e,t,n){var r=n(92539),i=n(54666);e.exports=function(e,t){return r(e,i(e),t)}},72595:function(e,t,n){var r=n(92539),i=n(81219);e.exports=function(e,t){return r(e,i(e),t)}},47478:function(e,t,n){var r=n(32802),i=n(16462),o=n(42084),a=n(20414);e.exports=function(e){return function(t){t=a(t);var n=i(t)?o(t):void 0,s=n?n[0]:t.charAt(0),u=n?r(n,1).join(""):t.slice(1);return s[e]()+u}}},47446:function(e,t,n){var r=n(16587),i=n(62962),o=n(68512);e.exports=function(e){return function(t,n,a){return a&&"number"!=typeof a&&i(t,n,a)&&(n=a=void 0),t=o(t),void 0===n?(n=t,t=0):n=o(n),a=void 0===a?t<n?1:-1:o(a),r(t,n,a,e)}}},59313:function(e,t,n){var r=n(83810),i=n(64198),o=n(5293),a=n(38778);e.exports=function(e){return function(t){var n=i(t);return"[object Map]"==n?o(t):"[object Set]"==n?a(t):r(t,e(t))}}},65646:function(e,t,n){var r=n(71366);e.exports=function(e){return r(e)?void 0:e}},60166:function(e,t,n){var r=n(20259),i=n(61790),o=n(79742);e.exports=function(e){return o(i(e,void 0,r),e+"")}},44874:function(e,t,n){var r=n(79160),i=n(81219),o=n(50553);e.exports=function(e){return r(e,o,i)}},81219:function(e,t,n){var r=n(78630),i=n(50127),o=n(54666),a=n(83582),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:a;e.exports=s},16462:function(e){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},15785:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},40744:function(e,t,n){var r=n(62203),i=n(58544),o=n(53339),a=n(11065),s=n(86816);e.exports=function(e,t,n){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return o(e);case"[object Symbol]":return a(e)}}},59978:function(e,t,n){var r=n(26835),i=n(47854);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},38778:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}},42084:function(e,t,n){var r=n(10682),i=n(16462),o=n(2784);e.exports=function(e){return i(e)?o(e):r(e)}},2784:function(e){var t="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",n="\\ud83c[\\udffb-\\udfff]",r="[^\\ud800-\\udfff]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",a="(?:"+t+"|"+n+")?",s="[\\ufe0e\\ufe0f]?",u=s+a+"(?:\\u200d(?:"+[r,i,o].join("|")+")"+s+a+")*",c="(?:"+[r+t+"?",t,i,o,"[\\ud800-\\udfff]"].join("|")+")",l=RegExp(n+"(?="+n+")|"+c+u,"g");e.exports=function(e){return e.match(l)||[]}},15137:function(e,t,n){var r=n(20414),i=n(33220);e.exports=function(e){return i(r(e).toLowerCase())}},72518:function(e,t,n){var r=n(82667);e.exports=function(e){return r(e,5)}},60584:function(e,t,n){var r=n(82667);e.exports=function(e,t){return r(e,5,t="function"==typeof t?t:void 0)}},86886:function(e,t,n){var r=n(20414),i=/[\\^$.*+?()[\]{}|]/g,o=RegExp(i.source);e.exports=function(e){return(e=r(e))&&o.test(e)?e.replace(i,"\\$&"):e}},96918:function(e){e.exports=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}},1015:function(e,t,n){var r=n(65706),i=n(68512),o=n(4817);e.exports=function(e,t,n){return t=i(t),void 0===n?(n=t,t=0):n=i(n),e=o(e),r(e,t,n)}},78117:function(e,t,n){var r=n(38744),i=n(53858),o=n(25614),a=o&&o.isMap,s=a?i(a):r;e.exports=s},75895:function(e,t,n){var r=n(77420),i=n(53858),o=n(25614),a=o&&o.isRegExp,s=a?i(a):r;e.exports=s},48934:function(e,t,n){var r=n(56912),i=n(53858),o=n(25614),a=o&&o.isSet,s=a?i(a):r;e.exports=s},45568:function(e,t,n){var r=n(30462),i=n(82667),o=n(12497),a=n(16306),s=n(92539),u=n(65646),c=n(60166),l=n(44874),d=c((function(e,t){var n={};if(null==e)return n;var c=!1;t=r(t,(function(t){return t=a(t,e),c||(c=t.length>1),t})),s(e,l(e),n),c&&(n=i(n,7,u));for(var d=t.length;d--;)o(n,t[d]);return n}));e.exports=d},48543:function(e,t,n){var r=n(47446)();e.exports=r},25107:function(e,t,n){var r=n(80087),i=n(92430),o=n(56984),a=n(13863),s=n(62962);e.exports=function(e,t,n){var u=a(e)?r:o;return n&&s(e,t,n)&&(t=void 0),u(e,i(t,3))}},12325:function(e,t,n){var r=n(39807),i=n(74634);e.exports=function(e,t,n){var o=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),r(e,t,{leading:o,maxWait:t,trailing:a})}},1938:function(e,t,n){var r=n(59313)(n(58971));e.exports=r},91791:function(e,t,n){var r=n(79301);e.exports=function(e){return e&&e.length?r(e):[]}},33220:function(e,t,n){var r=n(47478)("toUpperCase");e.exports=r},37702:function(e,t,n){var r,i;!function(o,a){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}function s(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function u(e,n,r){return function(){typeof console!==t&&(s.call(this,n,r),this[e].apply(this,arguments))}}function c(e,t,n){return a(e)||u.apply(this,arguments)}function l(e,n,i){var o,a=this;n=null==n?"WARN":n;var u="loglevel";function l(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||c,a.getLevel=function(){return o},a.setLevel=function(n,i){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}(n),s.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){n=e,l()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(n,!1),function(){if(typeof window!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=l();null==d&&(d=n),a.setLevel(d,!1)}var d=new l,f={};d.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new l(e,d.getLevel(),d.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return f},d.default=d,d},void 0===(i=r.call(t,n,t,e))||(e.exports=i)}()},53342:function(e,t,n){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=r&&i&&"function"==typeof i.get?i.get:null,a=r&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=s&&u&&"function"==typeof u.get?u.get:null,l=s&&Set.prototype.forEach,d="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,h=Boolean.prototype.valueOf,v=Object.prototype.toString,m=Function.prototype.toString,y=String.prototype.match,g=String.prototype.slice,b=String.prototype.replace,x=String.prototype.toUpperCase,_=String.prototype.toLowerCase,w=RegExp.prototype.test,M=Array.prototype.concat,S=Array.prototype.join,T=Array.prototype.slice,E=Math.floor,k="function"==typeof BigInt?BigInt.prototype.valueOf:null,A=Object.getOwnPropertySymbols,P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,C="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,I=Object.prototype.propertyIsEnumerable,R=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function N(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||w.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var r=e<0?-E(-e):E(e);if(r!==e){var i=String(r),o=g.call(t,i.length+1);return b.call(i,n,"$&_")+"."+b.call(b.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,n,"$&_")}var D=n(24654).custom,L=D&&z(D)?D:null;function B(e,t,n){var r="double"===(n.quoteStyle||t)?'"':"'";return r+e+r}function F(e){return b.call(String(e),/"/g,"&quot;")}function j(e){return!("[object Array]"!==V(e)||O&&"object"==typeof e&&O in e)}function z(e){if(C)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!P)return!1;try{return P.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,r,i){var s=n||{};if(G(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(G(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=!G(s,"customInspect")||s.customInspect;if("boolean"!=typeof u&&"symbol"!==u)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(G(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(G(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=s.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return H(t,s);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var x=String(t);return v?N(t,x):x}if("bigint"==typeof t){var w=String(t)+"n";return v?N(t,w):w}var E=void 0===s.depth?5:s.depth;if(void 0===r&&(r=0),r>=E&&E>0&&"object"==typeof t)return j(t)?"[Array]":"[Object]";var A,D=function(e,t){var n;if("\t"===e.indent)n="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;n=S.call(Array(e.indent+1)," ")}return{base:n,prev:S.call(Array(t+1),n)}}(s,r);if(void 0===i)i=[];else if(W(i,t)>=0)return"[Circular]";function U(t,n,o){if(n&&(i=T.call(i)).push(n),o){var a={depth:s.depth};return G(s,"quoteStyle")&&(a.quoteStyle=s.quoteStyle),e(t,a,r+1,i)}return e(t,s,r+1,i)}if("function"==typeof t){var Z=function(e){if(e.name)return e.name;var t=y.call(m.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),Q=J(t,U);return"[Function"+(Z?": "+Z:" (anonymous)")+"]"+(Q.length>0?" { "+S.call(Q,", ")+" }":"")}if(z(t)){var $=C?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):P.call(t);return"object"!=typeof t||C?$:q($)}if((A=t)&&"object"==typeof A&&("undefined"!=typeof HTMLElement&&A instanceof HTMLElement||"string"==typeof A.nodeName&&"function"==typeof A.getAttribute)){for(var ee="<"+_.call(String(t.nodeName)),te=t.attributes||[],ne=0;ne<te.length;ne++)ee+=" "+te[ne].name+"="+B(F(te[ne].value),"double",s);return ee+=">",t.childNodes&&t.childNodes.length&&(ee+="..."),ee+"</"+_.call(String(t.nodeName))+">"}if(j(t)){if(0===t.length)return"[]";var re=J(t,U);return D&&!function(e){for(var t=0;t<e.length;t++)if(W(e[t],"\n")>=0)return!1;return!0}(re)?"["+K(re,D)+"]":"[ "+S.call(re,", ")+" ]"}if(function(e){return!("[object Error]"!==V(e)||O&&"object"==typeof e&&O in e)}(t)){var ie=J(t,U);return"cause"in t&&!I.call(t,"cause")?"{ ["+String(t)+"] "+S.call(M.call("[cause]: "+U(t.cause),ie),", ")+" }":0===ie.length?"["+String(t)+"]":"{ ["+String(t)+"] "+S.call(ie,", ")+" }"}if("object"==typeof t&&u){if(L&&"function"==typeof t[L])return t[L]();if("symbol"!==u&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{c.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var oe=[];return a.call(t,(function(e,n){oe.push(U(n,t,!0)+" => "+U(e,t))})),X("Map",o.call(t),oe,D)}if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ae=[];return l.call(t,(function(e){ae.push(U(e,t))})),X("Set",c.call(t),ae,D)}if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{f.call(e,f)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Y("WeakMap");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{f.call(e,f);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Y("WeakSet");if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{return p.call(e),!0}catch(e){}return!1}(t))return Y("WeakRef");if(function(e){return!("[object Number]"!==V(e)||O&&"object"==typeof e&&O in e)}(t))return q(U(Number(t)));if(function(e){if(!e||"object"!=typeof e||!k)return!1;try{return k.call(e),!0}catch(e){}return!1}(t))return q(U(k.call(t)));if(function(e){return!("[object Boolean]"!==V(e)||O&&"object"==typeof e&&O in e)}(t))return q(h.call(t));if(function(e){return!("[object String]"!==V(e)||O&&"object"==typeof e&&O in e)}(t))return q(U(String(t)));if(!function(e){return!("[object Date]"!==V(e)||O&&"object"==typeof e&&O in e)}(t)&&!function(e){return!("[object RegExp]"!==V(e)||O&&"object"==typeof e&&O in e)}(t)){var se=J(t,U),ue=R?R(t)===Object.prototype:t instanceof Object||t.constructor===Object,ce=t instanceof Object?"":"null prototype",le=!ue&&O&&Object(t)===t&&O in t?g.call(V(t),8,-1):ce?"Object":"",de=(ue||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(le||ce?"["+S.call(M.call([],le||[],ce||[]),": ")+"] ":"");return 0===se.length?de+"{}":D?de+"{"+K(se,D)+"}":de+"{ "+S.call(se,", ")+" }"}return String(t)};var U=Object.prototype.hasOwnProperty||function(e){return e in this};function G(e,t){return U.call(e,t)}function V(e){return v.call(e)}function W(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function H(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return H(g.call(e,0,t.maxStringLength),t)+r}return B(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Z),"single",t)}function Z(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+x.call(t.toString(16))}function q(e){return"Object("+e+")"}function Y(e){return e+" { ? }"}function X(e,t,n,r){return e+" ("+t+") {"+(r?K(n,r):S.call(n,", "))+"}"}function K(e,t){if(0===e.length)return"";var n="\n"+t.prev+t.base;return n+S.call(e,","+n)+"\n"+t.prev}function J(e,t){var n=j(e),r=[];if(n){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=G(e,i)?t(e[i],e):""}var o,a="function"==typeof A?A(e):[];if(C){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var u in e)G(e,u)&&(n&&String(Number(u))===u&&u<e.length||C&&o["$"+u]instanceof Symbol||(w.call(/[^\w$]/,u)?r.push(t(u,e)+": "+t(e[u],e)):r.push(u+": "+t(e[u],e))));if("function"==typeof A)for(var c=0;c<a.length;c++)I.call(e,a[c])&&r.push("["+t(a[c])+"]: "+t(e[a[c]],e));return r}},6429:function(e){"use strict";var t=function(e){return e!=e};e.exports=function(e,n){return 0===e&&0===n?1/e==1/n:e===n||!(!t(e)||!t(n))}},16650:function(e,t,n){"use strict";var r=n(92795),i=n(6537),o=n(6429),a=n(2194),s=n(35523),u=i(a(),Object);r(u,{getPolyfill:a,implementation:o,shim:s}),e.exports=u},2194:function(e,t,n){"use strict";var r=n(6429);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},35523:function(e,t,n){"use strict";var r=n(2194),i=n(92795);e.exports=function(){var e=r();return i(Object,{is:e},{is:function(){return Object.is!==e}}),e}},67469:function(e,t,n){"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=n(79202),s=Object.prototype.propertyIsEnumerable,u=!s.call({toString:null},"toString"),c=s.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!f["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),r=a(e),s=t&&"[object String]"===o.call(e),f=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var h=c&&n;if(s&&e.length>0&&!i.call(e,0))for(var v=0;v<e.length;++v)f.push(String(v));if(r&&e.length>0)for(var m=0;m<e.length;++m)f.push(String(m));else for(var y in e)h&&"prototype"===y||!i.call(e,y)||f.push(String(y));if(u)for(var g=function(e){if("undefined"==typeof window||!p)return d(e);try{return d(e)}catch(e){return!1}}(e),b=0;b<l.length;++b)g&&"constructor"===l[b]||!i.call(e,l[b])||f.push(l[b]);return f}}e.exports=r},13456:function(e,t,n){"use strict";var r=Array.prototype.slice,i=n(79202),o=Object.keys,a=o?function(e){return o(e)}:n(67469),s=Object.keys;a.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return i(e)?s(r.call(e)):s(e)})}else Object.keys=a;return Object.keys||a},e.exports=a},79202:function(e){"use strict";var t=Object.prototype.toString;e.exports=function(e){var n=t.call(e),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),r}},76933:function(e,t,n){"use strict";var r=n(13456),i=function(e){return null!=e},o=n(42502)(),a=n(49685),s=Object,u=a("Array.prototype.push"),c=a("Object.prototype.propertyIsEnumerable"),l=o?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(!i(e))throw new TypeError("target must be an object");var n,a,d,f,p,h,v,m=s(e);for(n=1;n<arguments.length;++n){a=s(arguments[n]),f=r(a);var y=o&&(Object.getOwnPropertySymbols||l);if(y)for(p=y(a),d=0;d<p.length;++d)v=p[d],c(a,v)&&u(f,v);for(d=0;d<f.length;++d)h=a[v=f[d]],c(a,v)&&(m[v]=h)}return m}},54660:function(e,t,n){"use strict";var r=n(92795),i=n(6537),o=n(76933),a=n(63638),s=n(4319),u=i.apply(a()),c=function(e,t){return u(Object,arguments)};r(c,{getPolyfill:a,implementation:o,shim:s}),e.exports=c},63638:function(e,t,n){"use strict";var r=n(76933);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),n={},r=0;r<t.length;++r)n[t[r]]=t[r];var i=Object.assign({},n),o="";for(var a in i)o+=a;return e!==o}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?r:Object.assign:r}},4319:function(e,t,n){"use strict";var r=n(92795),i=n(63638);e.exports=function(){var e=i();return r(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e}},10524:function(e,t,n){var r;e=n.nmd(e),function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,a=i[typeof t]&&t,s=i.object&&e&&!e.nodeType&&e,u=a&&s&&"object"==typeof n.g&&n.g;!u||u.global!==u&&u.window!==u&&u.self!==u||(o=u);var c=Math.pow(2,53)-1,l=/\bOpera/,d=Object.prototype,f=d.hasOwnProperty,p=d.toString;function h(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function v(e){return e=x(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:h(e)}function m(e,t){for(var n in e)f.call(e,n)&&t(e[n],n,e)}function y(e){return null==e?h(e):p.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=c)for(;++n<r;)t(e[n],n);else m(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function x(e){return String(e).replace(/^ +| +$/g,"")}var _=function e(t){var n=o,r=t&&"object"==typeof t&&"String"!=y(t);r&&(n=t,t=null);var i=n.navigator||{},a=i.userAgent||"";t||(t=a);var s,u,c,d,f=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),h="Object",_=r?h:"ScriptBridgingProxyObject",w=r?h:"Environment",M=r&&n.java?"JavaPackage":y(n.java),S=r?h:"RuntimeObject",T=/\bJava/.test(M)&&n.java,E=T&&y(n.environment)==w,k=T?"a":"α",A=T?"b":"β",P=n.document||{},C=n.operamini||n.opera,O=l.test(O=r&&C?C["[[Class]]"]:y(C))?O:C=null,I=t,R=[],N=null,D=t==a,L=D&&C&&"function"==typeof C.version&&C.version(),B=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)})),F=b(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)})),j=G([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),z=b({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},(function(e,n,r){return e||(n[j]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(j)]||RegExp("\\b"+g(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r})),U=b(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),v(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}));function G(e){return b(e,(function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=v(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function V(e){return b(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(B&&(B=[B]),/\bAndroid\b/.test(U)&&!j&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(j=x(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),z&&!j?j=G([z]):z&&j&&(j=j.replace(RegExp("^("+g(z)+")[-_.\\s]","i"),z+" ").replace(RegExp("^("+g(z)+")[-_.]?(\\w)","i"),z+" $2")),(s=/\bGoogle TV\b/.exec(j))&&(j=s[0]),/\bSimulator\b/i.test(t)&&(j=(j?j+" ":"")+"Simulator"),"Opera Mini"==F&&/\bOPiOS\b/.test(t)&&R.push("running in Turbo/Uncompressed mode"),"IE"==F&&/\blike iPhone OS\b/.test(t)?(z=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,j=s.product):/^iP/.test(j)?(F||(F="Safari"),U="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==F&&/^Linux\b/i.test(U)?U="Kubuntu":z&&"Google"!=z&&(/Chrome/.test(F)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(j))||/\bAndroid\b/.test(U)&&/^Chrome/.test(F)&&/\bVersion\//i.test(t)?(F="Android Browser",U=/\bAndroid\b/.test(U)?U:"Android"):"Silk"==F?(/\bMobi/i.test(t)||(U="Android",R.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&R.unshift("accelerated")):"UC Browser"==F&&/\bUCWEB\b/.test(t)?R.push("speed mode"):"PaleMoon"==F&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?R.push("identifying as Firefox "+s[1]):"Firefox"==F&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(U||(U="Firefox OS"),j||(j=s[1])):!F||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(F))?(F&&!j&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(F=null),(s=j||z||U)&&(j||z||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(U))&&(F=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(U)?U:s)+" Browser")):"Electron"==F&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&R.push("Chromium "+s),L||(L=V(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",g(F),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==B&&parseFloat(L)>3?"WebKit":/\bOpera\b/.test(F)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(B)&&"WebKit"||!B&&/\bMSIE\b/i.test(t)&&("Mac OS"==U?"Tasman":"Trident")||"WebKit"==B&&/\bPlayStation\b(?! Vita\b)/i.test(F)&&"NetFront")&&(B=[s]),"IE"==F&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(F+=" Mobile",U="Windows Phone "+(/\+$/.test(s)?s:s+".x"),R.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(F="IE Mobile",U="Windows Phone 8.x",R.unshift("desktop mode"),L||(L=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=F&&"Trident"==B&&(s=/\brv:([\d.]+)/.exec(t))&&(F&&R.push("identifying as "+F+(L?" "+L:"")),F="IE",L=s[1]),D){if("global",d=null!=(c=n)?typeof c.global:"number",/^(?:boolean|number|string|undefined)$/.test(d)||"object"==d&&!c.global)y(s=n.runtime)==_?(F="Adobe AIR",U=s.flash.system.Capabilities.os):y(s=n.phantom)==S?(F="PhantomJS",L=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof P.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(L=[L,P.documentMode],(s=+s[1]+4)!=L[1]&&(R.push("IE "+L[1]+" mode"),B&&(B[1]=""),L[1]=s),L="IE"==F?String(L[1].toFixed(1)):L[0]):"number"==typeof P.documentMode&&/^(?:Chrome|Firefox)\b/.test(F)&&(R.push("masking as "+F+" "+L),F="IE",L="11.0",B=["Trident"],U="Windows");else if(T&&(I=(s=T.lang.System).getProperty("os.arch"),U=U||s.getProperty("os.name")+" "+s.getProperty("os.version")),E){try{L=n.require("ringo/engine").version.join("."),F="RingoJS"}catch(e){(s=n.system)&&s.global.system==n.system&&(F="Narwhal",U||(U=s[0].os||null))}F||(F="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(s=n.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(R.push("Node "+s.versions.node),F="Electron",L=s.versions.electron):"string"==typeof s.versions.nw&&(R.push("Chromium "+L,"Node "+s.versions.node),F="NW.js",L=s.versions.nw)),F||(F="Node.js",I=s.arch,U=s.platform,L=(L=/[\d.]+/.exec(s.version))?L[0]:null));U=U&&v(U)}if(L&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(L)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(D&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(N=/b/i.test(s)?"beta":"alpha",L=L.replace(RegExp(s+"\\+?$"),"")+("beta"==N?A:k)+(/\d+\+?/.exec(s)||"")),"Fennec"==F||"Firefox"==F&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(U))F="Firefox Mobile";else if("Maxthon"==F&&L)L=L.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(j))"Xbox 360"==j&&(U=null),"Xbox 360"==j&&/\bIEMobile\b/.test(t)&&R.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(F)&&(!F||j||/Browser|Mobi/.test(F))||"Windows CE"!=U&&!/Mobi/i.test(t))if("IE"==F&&D)try{null===n.external&&R.unshift("platform preview")}catch(e){R.unshift("embedded")}else(/\bBlackBerry\b/.test(j)||/\bBB10\b/.test(t))&&(s=(RegExp(j.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||L)?(U=((s=[s,/BB10/.test(t)])[1]?(j=null,z="BlackBerry"):"Device Software")+" "+s[0],L=null):this!=m&&"Wii"!=j&&(D&&C||/Opera/.test(F)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==F&&/\bOS X (?:\d+\.){2,}/.test(U)||"IE"==F&&(U&&!/^Win/.test(U)&&L>5.5||/\bWindows XP\b/.test(U)&&L>8||8==L&&!/\bTrident\b/.test(t)))&&!l.test(s=e.call(m,t.replace(l,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),l.test(F)?(/\bIE\b/.test(s)&&"Mac OS"==U&&(U=null),s="identify"+s):(s="mask"+s,F=O?v(O.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(U=null),D||(L=null)),B=["Presto"],R.push(s));else F+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==F&&"+"==s[1].slice(-1)?(F="WebKit Nightly",N="alpha",L=s[1].slice(0,-1)):L!=s[1]&&L!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(L=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==B&&(B=["Blink"]),D&&(f||s[1])?(B&&(B[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=B?"27":"28")):(B&&(B[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),B&&(B[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==F&&(!L||parseInt(L)>45)?L=s:"Chrome"==F&&/\bHeadlessChrome/i.test(t)&&R.unshift("headless")),"Opera"==F&&(s=/\bzbov|zvav$/.exec(U))?(F+=" ",R.unshift("desktop mode"),"zvav"==s?(F+="Mini",L=null):F+="Mobile",U=U.replace(RegExp(" *"+s+"$"),"")):"Safari"==F&&/\bChrome\b/.exec(B&&B[1])?(R.unshift("desktop mode"),F="Chrome Mobile",L=null,/\bOS X\b/.test(U)?(z="Apple",U="iOS 4.3+"):U=null):/\bSRWare Iron\b/.test(F)&&!L&&(L=V("Chrome")),L&&0==L.indexOf(s=/[\d.]+$/.exec(U))&&t.indexOf("/"+s+"-")>-1&&(U=x(U.replace(s,""))),U&&-1!=U.indexOf(F)&&!RegExp(F+" OS").test(U)&&(U=U.replace(RegExp(" *"+g(F)+" *"),"")),B&&!/\b(?:Avant|Nook)\b/.test(F)&&(/Browser|Lunascape|Maxthon/.test(F)||"Safari"!=F&&/^iOS/.test(U)&&/\bSafari\b/.test(B[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(F)&&B[1])&&(s=B[B.length-1])&&R.push(s),R.length&&(R=["("+R.join("; ")+")"]),z&&j&&j.indexOf(z)<0&&R.push("on "+z),j&&R.push((/^on /.test(R[R.length-1])?"":"on ")+j),U&&(s=/ ([\d.+]+)$/.exec(U),u=s&&"/"==U.charAt(U.length-s[0].length-1),U={architecture:32,family:s&&!u?U.replace(s[0],""):U,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!u?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(I))&&!/\bi686\b/i.test(I)?(U&&(U.architecture=64,U.family=U.family.replace(RegExp(" *"+s),"")),F&&(/\bWOW64\b/i.test(t)||D&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&R.unshift("32-bit")):U&&/^OS X/.test(U.family)&&"Chrome"==F&&parseFloat(L)>=39&&(U.architecture=64),t||(t=null);var W={};return W.description=t,W.layout=B&&B[0],W.manufacturer=z,W.name=F,W.prerelease=N,W.product=j,W.ua=t,W.version=F&&L,W.os=U||{architecture:null,family:null,version:null,toString:function(){return"null"}},W.parse=e,W.toString=function(){return this.description||""},W.version&&R.unshift(L),W.name&&R.unshift(F),U&&F&&(U!=String(U).split(" ")[0]||U!=F.split(" ")[0]&&!j)&&R.push(j?"("+U+")":"on "+U),R.length&&(W.description=R.join(" ")),W}();o.platform=_,void 0===(r=function(){return _}.call(t,n,t,e))||(e.exports=r)}.call(this)},67029:function(e){"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,n,r,i){n=n||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(n);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var u=e.length;s>0&&u>s&&(u=s);for(var c=0;c<u;++c){var l,d,f,p,h=e[c].replace(a,"%20"),v=h.indexOf(r);v>=0?(l=h.substr(0,v),d=h.substr(v+1)):(l=h,d=""),f=decodeURIComponent(l),p=decodeURIComponent(d),t(o,f)?Array.isArray(o[f])?o[f].push(p):o[f]=[o[f],p]:o[f]=p}return o}},23430:function(e){"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,n,r,i){return n=n||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(i){var o=encodeURIComponent(t(i))+r;return Array.isArray(e[i])?e[i].map((function(e){return o+encodeURIComponent(t(e))})).join(n):o+encodeURIComponent(t(e[i]))})).join(n):i?encodeURIComponent(t(i))+r+encodeURIComponent(t(e)):""}},70969:function(e,t,n){"use strict";t.decode=t.parse=n(67029),t.encode=t.stringify=n(23430)},81963:function(e,t,n){"use strict";n.r(t),n.d(t,{Circle:function(){return z},Line:function(){return T},default:function(){return U}});var r=n(5954);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}},a(e,t,n||e)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var l=function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(f,e);var t,n,r,l,d=(r=f,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(r);if(l){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function f(){return i(this,f),d.apply(this,arguments)}return t=f,(n=[{key:"componentDidUpdate",value:function(){var e=this,t=Date.now(),n=!1;Object.keys(this.paths).forEach((function(r){var i=e.paths[r];if(i){n=!0;var o=i.style;o.transitionDuration=".3s, .3s, .3s, .06s",e.prevTimeStamp&&t-e.prevTimeStamp<100&&(o.transitionDuration="0s, 0s")}})),n&&(this.prevTimeStamp=Date.now())}},{key:"render",value:function(){return a(c(f.prototype),"render",this).call(this)}}])&&o(t.prototype,n),f}(e)},d=n(96504),f=n.n(d),p={className:"",percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,style:{},trailColor:"#D9D9D9",trailWidth:1},h=f().oneOfType([f().number,f().string]),v={className:f().string,percent:f().oneOfType([h,f().arrayOf(h)]),prefixCls:f().string,strokeColor:f().oneOfType([f().string,f().arrayOf(f().oneOfType([f().string,f().object])),f().object]),strokeLinecap:f().oneOf(["butt","round","square"]),strokeWidth:h,style:f().object,trailColor:f().string,trailWidth:h};function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function x(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_(e):t}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(s,e);var t,n,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(i);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return x(this,e)});function s(){var e;y(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return M(_(e=a.call.apply(a,[this].concat(n))),"paths",{}),e}return t=s,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.percent,o=t.prefixCls,a=t.strokeColor,s=t.strokeLinecap,u=t.strokeWidth,c=t.style,l=t.trailColor,d=t.trailWidth,f=t.transition,p=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,["className","percent","prefixCls","strokeColor","strokeLinecap","strokeWidth","style","trailColor","trailWidth","transition"]);delete p.gapPosition;var h=Array.isArray(i)?i:[i],v=Array.isArray(a)?a:[a],y=u/2,g=100-u/2,b="M ".concat("round"===s?y:0,",").concat(y,"\n           L ").concat("round"===s?g:100,",").concat(y),x="0 0 100 ".concat(u),_=0;return r.default.createElement("svg",m({className:"".concat(o,"-line ").concat(n),viewBox:x,preserveAspectRatio:"none",style:c},p),r.default.createElement("path",{className:"".concat(o,"-line-trail"),d:b,strokeLinecap:s,stroke:l,strokeWidth:d||u,fillOpacity:"0"}),h.map((function(t,n){var i={strokeDasharray:"".concat(t,"px, 100px"),strokeDashoffset:"-".concat(_,"px"),transition:f||"stroke-dashoffset 0.3s ease 0s, stroke-dasharray .3s ease 0s, stroke 0.3s linear"},a=v[n]||v[v.length-1];return _+=t,r.default.createElement("path",{key:n,className:"".concat(o,"-line-path"),d:b,strokeLinecap:s,stroke:a,strokeWidth:u,fillOpacity:"0",ref:function(t){e.paths[n]=t},style:i})})))}}])&&g(t.prototype,n),s}(r.Component);S.propTypes=v,S.defaultProps=p;var T=l(S);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(){return A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A.apply(this,arguments)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C(e,t)}function O(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?I(e):t}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=0;function L(e){return+e.replace("%","")}function B(e){return Array.isArray(e)?e:[e]}function F(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,a=50-r/2,s=0,u=-a,c=0,l=-2*a;switch(o){case"left":s=-a,u=0,c=2*a,l=0;break;case"right":s=a,u=0,c=-2*a,l=0;break;case"bottom":u=a,l=2*a}var d="M 50,50 m ".concat(s,",").concat(u,"\n   a ").concat(a,",").concat(a," 0 1 1 ").concat(c,",").concat(-l,"\n   a ").concat(a,",").concat(a," 0 1 1 ").concat(-c,",").concat(l),f=2*Math.PI*a,p={stroke:n,strokeDasharray:"".concat(t/100*(f-i),"px ").concat(f,"px"),strokeDashoffset:"-".concat(i/2+e/100*(f-i),"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s"};return{pathString:d,pathStyle:p}}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(s,e);var t,n,i,o,a=(i=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(i);if(o){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),N(I(e=a.call(this)),"paths",{}),N(I(e),"gradientId",0),e.gradientId=D,D+=1,e}return t=s,(n=[{key:"getStokeList",value:function(){var e=this,t=this.props,n=t.prefixCls,i=t.percent,o=t.strokeColor,a=t.strokeWidth,s=t.strokeLinecap,u=t.gapDegree,c=t.gapPosition,l=B(i),d=B(o),f=0;return l.map((function(t,i){var o=d[i]||d[d.length-1],l="[object Object]"===Object.prototype.toString.call(o)?"url(#".concat(n,"-gradient-").concat(e.gradientId,")"):"",p=F(f,t,o,a,u,c),h=p.pathString,v=p.pathStyle;return f+=t,r.default.createElement("path",{key:i,className:"".concat(n,"-circle-path"),d:h,stroke:l,strokeLinecap:s,strokeWidth:a,opacity:0===t?0:1,fillOpacity:"0",style:v,ref:function(t){e.paths[i]=t}})}))}},{key:"render",value:function(){var e=this.props,t=e.prefixCls,n=e.strokeWidth,i=e.trailWidth,o=e.gapDegree,a=e.gapPosition,s=e.trailColor,u=e.strokeLinecap,c=e.style,l=e.className,d=e.strokeColor,f=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor"]),p=F(0,100,s,n,o,a),h=p.pathString,v=p.pathStyle;delete f.percent;var m=B(d).find((function(e){return"[object Object]"===Object.prototype.toString.call(e)}));return r.default.createElement("svg",A({className:"".concat(t,"-circle ").concat(l),viewBox:"0 0 100 100",style:c},f),m&&r.default.createElement("defs",null,r.default.createElement("linearGradient",{id:"".concat(t,"-gradient-").concat(this.gradientId),x1:"100%",y1:"0%",x2:"0%",y2:"0%"},Object.keys(m).sort((function(e,t){return L(e)-L(t)})).map((function(e,t){return r.default.createElement("stop",{key:t,offset:e,stopColor:m[e]})})))),r.default.createElement("path",{className:"".concat(t,"-circle-trail"),d:h,stroke:s,strokeLinecap:u,strokeWidth:i||n,fillOpacity:"0",style:v}),this.getStokeList().reverse())}}])&&P(t.prototype,n),s}(r.Component);j.propTypes=k(k({},v),{},{gapPosition:f().oneOf(["top","bottom","left","right"])}),j.defaultProps=k(k({},p),{},{gapPosition:"top"});var z=l(j),U={Line:T,Circle:z}},69124:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SAFARI_SHARE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABGCAYAAABxLuKEAAABWWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGBSSSwoyGFhYGDIzSspCnJ3UoiIjFJgv8/AxcDHwMvAwWCZmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsisp7v5ZqTvdTvrvc8lb6906QxM9SiAKyW1OBlI/wHi1OSCohIGBsYUIFu5vKQAxO4AskWKgI4CsueA2OkQ9gYQOwnCPgJWExLkDGTfALIVkjMSgWYw/gCydZKQxNOR2FB7QYDbJbO4ICexUiHAmIBryQAlqRUlINo5v6CyKDM9o0TBERhKqQqeecl6OgpGBoamDAygMIeo/hwIDktGsTMIseb7DAy2+////78bIea1n4Fhozkw+HYixDQsGBgEuRkYTuwsSCxKBAsxAzFTWhoDwydgePEGMDAIb2Ng4PxTnGZsBJZn5HFiYGC99///ZzUGBvbJDAx/J/z//3vR//9/FwM132FgOJAHAEf/Z5tAjj9dAAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAEJdJREFUeAHtnFuIJGcVx09duron2YQkD+IFJIiIYCAxEQWTLNF1McGYoFEk+OZj3hREfIiCiEJAfPdRDETFhAhhwyZxszGuC4I+eHkQE28YlA2abHamZ7q6qvz9z6ma7pmdmd2tmU6buN9u1+Wr73LO//uf813qq0lW19Ybe51DkzRW80uoN6sTSxtdSQydE650jpg6qU2PmyQxspA2ni5a6NwleN0P84pLxTogAYHG0pk0LXhCJmlShyxtap43DlQAOUt+kFdLAgaVWpY4LOCk+wRWOD0EgejRhoBRaRTBwS+62C7VwZ7nmudgC96rNOmVwYwEM0JLzCqzEmCqNLcp8XWWcoZHKeKlgARLMpLWNbFEiTOLDksBRkoJHHR2E0Jjy3NAmU4tSTETgEgdEHxR3VhVYWpImuWpVfgYHrYZFwfP0kwJldEKJZvKvUpSTW0EU8wqq1EePAAusywrAKO0SVl6+jQbABR55IwXh4vLtMDi9ygaCkj5DGakMKDBuJq0sI0KhgBMnmWyHSs3JoCTW5rzHDDSNOPZAFAWCYvZUhijDreuUxTOAGcMRxKb2MAJVOcrNgCTZrJmBYCRymrAMswIp2STjXX8Df5JTmeBQdx93YNUUg/U4HAnFcwBjElh9qOnXrRHT7xgr/G8yq+wsgpGASOmNLG8GDiTnE0LlnopjHFqVBNrZBKDFTsLAA8fW7dnTp8DgtJeqcd2/0dX7NrByKaTDcDA0ECzwg8FUWDQgsMBMyYGaDFIm6f6dkXwFYBSYiarJPvx8ZftmV/9zc7ZW2ycvd2O/fxP9viJs/YqgFX50Cb4afmWBqeroU5Fr6VhUIx1VDYJMDMBrlrD/8SVYiK2Q1Lpt8vTPZud9wFMV31XkQSQc4CE/HSdyMHWaKcuFkcq3+DXeI6yzmyM7A8fH9vjp14ClIJscrxTxjNX2WPP/t0eeaa0s6SZZiPYYjYAHA+goyFQDIM0ahYocaa3t5QHSROyaIzUqF7BhRyCK8Le4OwDGHSkBkYdm22iilWzWrNu/+V0wRqvFIPcSnW52dDW8flryP3o8TP29PO/ZXCX2ZE7rrdhsmqj+pwdufV6Sh7az57/nf3kqZftNZVZwBzAqSlc1XhFrmxcuSQMjvRvFkJCPdvOm1mana96ASPFK35qsUYUTqC4j0eQnDFrk5Q8K+l+uVcTAtK0Ki3JBzYm0xhSff/Y2J48/Q9ad2Kf/dj77NMfMbtq8k+7rjljnztq9pkj77asWrNjz/3FHjm+7szZoDu3dADz6L7Vq8G6xBmq7j5YhC+HccCDTJZoHF36L/E5VsgcciP8HqEXMFGeKtcv2gMJiRad1fnqzDMGKhlUruhua4b7Gyg1Vu/z5Bk7cfoPgFXbvUc/YHcfNltBj5VmzQbVqhVc30XcPUdv9jHOiV/+3h57+oyNB4mto1WlSlFXlWtyCQ35KU61SvlONpkYhSHPLCj9hdW+cIpZiVuuvI2QQr6kQvla3S+ySTQ6ESuSghbF15SqAvNpCjuH/D94cs2eeP4FWxlO7P5P3mj3HB7ZIdIPkF+jFqkBhlYQd++RFbvv4zdYCnOeOPln+yH+SM56inmq1RXEFJ95u08JpeX8BYU3WpsugOO5gPTf5gMvZ/tBJV1yEDn8560kiCSIgOGBi6r5jZiDqmipHohLO/ncH/mdspUitfvuvMWOfDCzQ4CVMjcsAENjlZQ5Eycbkb4g/uiHCvv8vR/GK1V28tlf2OnTL7qOzg2vTzUqABD/4twenVGKC1MTiAp7Q+JJ9jPyFfIhiHeVCNnI6xMlxysgKnqkspxaMVyxpNyww+9/j/3m1y/a7bfdYLfdVNgKaSvii+HQzokqUK3BvEaAlFHEEL9QwI4jN2Yw8L126tQpu/Wmd1mKE8/ku9zZS2mB08FDRgHi+mkNhyt/hEAeuBGg4cHbuPNPiNAnwAUqVwt0AkUp3o5c6swMmWF8iqOcTktYMoA5Zl954E6jg7IBM+ms2fBsk3JoTirJDhj07MLVQRvik66gu73jlmvt8M2foNfSPEaaVmEqLgHKq0W49p5RZ+6cGw6KnoekncTx3BPteOgFjAqnP/AxioYIDLdawTSvobVp5aRhZKs5jrMI3zGVwTU2pO/2jkwrL2TWmgyGZjkKa4atoa38R/iaAb4JiPFh6uAGDhyAAHClXhDgp8wb8rywumTpwsc5lKEBoBqGudgUGRKPD1nkx7Qo5njtCElEqqpeQT5EAOhXSyFaLNGkj6aPkW/QWCKolxJ8cq05AziWpUgXvYsGYnQ2xgzBZ9pVXTInwsEKa2bUyiUyrBCnRL6EBaVitQ9mCUhaQyDLlMlFXO6yVOoV8VmeVoMpCvIRtMS5QOjFGEc7T1CvdiebYSZThCo10WMAJ5b4KFftzlgCkYhTG4TtO1QIqTOLCM4y5FciQMltHQuT/5kCeJrS+jBgskFalKdaJYNBsAG2DIYDBn3SFFMhXgNAxtjcB1DqsRq3TRqCs5Y4EhqzgXFeEMedQi9gVJCEaRiXaC6zilyMt2yKTUg46pVJx9hODcW10NEpUCI9ch0ifbWusoIhAjdh0OZLMZCQpsfGMCfYBA6+igfhXG18tB7RkykdcTxXmVid18fJmZhQeEImOfViUNDjtYtcAniP0BMYKqPFIb1P9L744KM2Tt9pk+YqhIwm1Wp+vOqQYOGV1J3XKaxiYeFQ8h/7ztfututQCotxQtWs1vmIFqDUfTcMY1+FPV/6+k9tNX+HrVUrwgBfIj+BCZMu1oUFykaYIiy6Mi9tVP3LvvuNu+xqWmJIDyZznWwwgGQ2r+UOsXCv0BMYTAJgppTdYDllcg3znWuZGI5ozTHC4wvkZJ0eCOFmI5XkG+T+GBTS1FqQIsrXXUSQKQUW+AeteTu7eMYUCaUrBpG0NFQU7PIdOb5FTJzSdVOk+7oSR9swAV33pfQxA8EoeyB2QyfN1ybuD9V17B16AQMHKFWzZxRAiUG9ilN9yR769u1WoMxIDIDWNIzPqXSWEsqls0bGTKQtV5pmnVn1yBfoChyNWCYGqRz1Qqxs2ve+9SmbkFnmqlm2zEbxV6wADIxS+inxNaa1Srlf/upJyiu9Z5uST14ua+dU6q9k6iKM5Nkt9AJGhcmXCBhYjRBABTgF9n4NJWblaz5+EYAa/2oEoaNMKvWJn8Y3KCLbx7nKPiYo6t0sbJDQ8pfAgBlMTS0+ghYVjJLb0ZuDq4VaGf2fujD1iGsTlid4PmKWjniUB7iAZVOcLRVKilQTTBc+nivZTqEXMKpCQqtPcTt39hAnoSUMgzq/4RqREDDaJo7cYxaaQvh/AQQI6qKdTkJMceit1bwIupH5qj6ooUCeMFWuZUuqi3wKMTVxvAGPM/XrkRrIg6poLyPi/GMvYFRMgMMFFXi7UZnrz73EUOtImBBAUuhOYbtEytg9IQ+F6FZlaZAWs2cvycuSv1LwGK/Qb9uY7jrOkUYAqcyoxHNvF2FrNr/rDcwOZV1ilKuPyKFooAHlZFdd8LFP3DjAJBVwbUyXaiHnpQET6nEEH13HTyYRT2aNGmlce0/LfSRZCCBdoUsDxgcukqIzdkdCBjgLjpEGfW1s90xJu2yz1Ad7Ncfbgy1479LCBwUMrbp+0ozZvWpLnJY3W1Agl3qVBYflMaZr/nkFmVfJTsQUqS7n6z6Hm8Rfj/hTfxYpdipkvsD+10tijNTq+ol54YWAwIgQvFBclzpiuueLPC8FGB9nAECjNwpo1/bADOzUsbL20kolU4vphBIFkDNoLsyW/VjcUoARX2Qama+lxIqd5kc5k8iG9zKsdoalzHXdDoibWPinRbJFZS8NmJo9L1NmxJpsijY61Qzd85R5k4YzxMXbxBkzgi269/G05F9YWJrz1YIRqrtL0aQu1nBgD/MhLUZpCuUrb6SJELAoTwSdu7g26gBPSwIGc6DrqVk80iJSykRpyiQySyautqZDYpBm2tGlC6TQunPZMqhFhqUBk7BclUMNvQVZZaJ36EqBMXZg9BbB37B6dy1E+LWedNGAdGAvBxjY0rAIruXRlOV/retO8S+WsFyBiWm2LYbofbjvnhAwwqZjCdftCLDT48DPryMwHfWllRQHiJYFOcDkTBgf+uYX9PYkXqXgnB2ILaNe5VQ5jkx7VtzBh30D09m+RPPrTv8tshIZeDgYrhaKK71ePWldf8RCTtEmUp+jn95eRejAmLvdLHBLRQ6bz7GI3lGUrcl3vds3MLuWfN6DTsxAaOYrNEVkOZMXdOeHDs3uyfb7Ln7uPJ9E1121c0ku5lJ95uWwAwL7BmZ+2D1/vUNdb6iofQPzhtL2EoS9DMwuYF0GZhdgDqRXil0Gu9TwBo0+EGA02ZvvJf9XsJgfY12qTJdNaRfE3lTA7Ich2/F5UwGzXbn93F8GZhf0LgPz/wDMQU5JenbXLAnQP3cTV+bGvAgZ+mc26rbHyWizHbYvp8y9p99M0+eimzh3SwwSRq/r2NLHdplDPltX3S6nENOSIEELZFromM3uPfq8Qy9gVBmbv2IjIKttVVXYev5We+DBv7KywlYzFp5UsbZw6HuC2PhPDPHag6fXsD7y2dTqPLlQQK9YpP4OQXqS1+VQmZ6EHV7UldUFu7Hexg6ql33nljYxCoum5ks5dmxppVDvrnyLyWbTnl9Hbx+jSiYbta1QaVG/wkcS/2ZbO1vO2EcWCmkZW02m9qEardgpqBm30yiebDnuCoqKADDt65WKwk5F65yxTCoZRslZGxk/ZPNtZTwbsi3fN0vrc2WhdYGQ9PmjF95S2jOrjzy1LCudEWIDLmtHlYRRcP25V1Ae7fhWWk7+2uQi8PG82w+evy3Xd16p3DaRFtf1kynobS/bIHlXxVdzvIbI2X5bw6oBq+01G62RaHvRm/f9gCF7bEdndzjbv/SFve+ilMQsYGuntr6VFgT+RZqgAAX9S2RmoCQzc3PaFGXrRTf/2s4cj1d+lakSpb2fvXSu3YhRmYVRdjHW7Fp0hgW/vF6V4R96kWa30A8YtZD7gHj3o4/KBYYLLZrzKnGqexc4qg4w9LoEX4A8+vMnrttukl0gXoaqEN85tmYrOChX7NTWTrcY+Tn2BDba2Egefekms/Pvq/YQoCW913FJB9FRL8XUWvrs1/+kAMauDkD7cNUWEtAFdcqGKmE+njGA63sUAKrFi/KKnA3RACjuTFHHgH2TNtM7LDlhXvAlF2HDvRgjMPSpzZBvCPwPUgBIjc/xrzxoDn0ZIn+rdG7onNxVugkFKPo8r3+Y5UVdoR+geI2qU6YSjNTOCoEj08sxb32O6O0kj70HY3p111Ko4EOi0n0Ln8SoMl6USVzZcwjrdwgtAktWHd249pKHNBcTAlwVpFq8QKIaeXYFIvURhfb06k+rqAeTv1GvpC/unOqk6UqJTFuPvRjjJhIwUForjJcbth52T4SDEi3qedz+NdAinQPlmXocBAgN4ZoJmoBHqsb2V66kuJtbOGehEG+rQt7ON+1WeW/GSKYQR8d57Dsh29jN282LOVnm881FX/BS+QQCMshkXBKVT7z+g5iX7GeAkGl59ZEvit9JnniiYy9gOrTVbq1Lbc8q0iVzM5Z/0VvGmQi6irtuI7NyXHJQj9g6dO2ImAET1wFLgOC1CSBHStJF/Z0cu9X9X2qu/I9ypznQAAAAAElFTkSuQmCC",t.MENU_ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAAAKklEQVR4Ae3TMRUAAAhCQfuX1g4+BoY7AjD9qQOwmb0OHICSlQxCUzLAAUfPrmAyBxxOAAAAAElFTkSuQmCC",t.STAR_ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAACaUlEQVR4Ae3UTYiVZRTA8d98OA3MZkY0HQoioyBsMAqK2lRMtJm+FpYFglFECJHVZIQRkeSiWrgTa4piSmiiwMHaNohEQbYIRlRyDNMItYWiU2rq6VmcxcXuXO59mbsI5vffnrN63+dY8L9zR6mtPjWujZY575yrtc0bovS6Nul2TJSO6tYWj4tstbbYI7Ld2mCVqGnIvPtQlA6VovSBebbYX6L0klFRmjVgXm0UpbP6DZgVpVHzqNOvovQ+GBOlGZ3mzSO1n1Z+bg+qqNNSK91njedttt1Xjl7xc+7JBzdpzBYbPGnYkGW6NLDehCnTTrgk6vYYaY2o2yUn7TNlwnr/0W9KNOiYbtIiv4sGfatfHT3GhcxZh/1g0pi3veAJQ2rdaq2XveNj39jrN+eEzLgec9qcQxc9pxXPuJibb9HYUy7k6Ls6NKPDlty4YJ0mDDuVCxN60dhVduT0KcOadIsjufSdJRpZbHdOHrFSCwb9lIu/uNFcVjiQU3sNalGfr3P5T7epZ5XjObFLnwq6bBNKRtTzsFCyTZeK7halywbUs8RlUbpLZa+K0rS57BelV1Q2KUrbJfSWkjzcdqqow0lRWit5yGEzRiTrROmEim4WSq4HK+wS2U7XgRuEkptU8mxeUXq96W9R06xNevCHKD2tkk/yXIyYEdnPpcgOuN+XovSRSg7lM4vstA26Si86LbLjonRQBctFbT6zXDJoh6jNUi1bLWSm3eNK99onZB7Vsq25esaobvUsstGZnHpPy34Upc9do5FrfSFK32tRn3/sN6wZDzjovF4tudNrejSrxya3a5MFC/4FvnJyixTO/oIAAAAASUVORK5CYII="},14418:function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=m(["\n  width: 30px;\n  border-radius: 5px;\n"],["\n  width: 30px;\n  border-radius: 5px;\n"]),a=m(["\n  width: 20px;\n  filter: invert(100%);\n"],["\n  width: 20px;\n  filter: invert(100%);\n"]),s=n(5954),u=p(s),c=p(n(96504)),l=p(n(10524)),d=p(n(58111)),f=n(69124);function p(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var y=d.default.img(o),g=d.default.img(a),b=function(e){function t(){var e,n,i;h(this,t);for(var o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];return n=i=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),i.handleAddBookmark=function(){var e=i.props,t=e.title,n=e.href,r=e.onAddBookmark;window.external&&window.external.AddFavourite&&window.external.AddFavourite(n,t),r()},i.renderDesktop=function(){var e=i.props,t=e.className,n=e.linkClassName,o=e.title,a=e.href,s=function(e){return u.default.createElement("a",r({className:n,onClick:i.handleAddBookmark},e),"Add this page to your bookmarks")},c="Ctrl";l.default.os.family&&"OS X"===l.default.os.family&&(c="Command (⌘)");var d=null;return l.default.name&&l.default.name.includes("Firefox")&&(d=s({href:a,rel:"sidebar",title:o})),window.external&&window.external.AddFavourite&&(d=s()),u.default.createElement("div",{className:t},d||u.default.createElement("span",null,"Press ",u.default.createElement("strong",null,c," + D")," to add this page to your bookmarks."))},i.renderMobile=function(e){var t=i.props.className,n=e;return l.default.name&&l.default.manufacturer&&l.default.name.includes("Safari")&&l.default.manufacturer.includes("Apple")?n=u.default.createElement("div",null,"Press ",u.default.createElement(y,{src:f.SAFARI_SHARE})," then ",u.default.createElement("strong",null,"Add to Home Screen")," to add this page to your home screen."):l.default.name&&(l.default.name.includes("Chrome")||l.default.name.includes("Firefox"))&&(n=u.default.createElement("div",null,"Press ",u.default.createElement(g,{src:f.MENU_ICON})," then ",u.default.createElement(g,{src:f.STAR_ICON})," to add this page to your bookmarks.")),u.default.createElement("div",{className:t},n)},i.renderTablet=function(e){var t=i.props.className,n=e;return l.default.name&&(l.default.name.includes("Chrome")||l.default.name.includes("Firefox"))&&(n=u.default.createElement("div",null,"Press ",u.default.createElement(g,{src:f.STAR_ICON})," next to the address bar to add this page to your bookmarks.")),u.default.createElement("div",{className:t},n)},v(i,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"render",value:function(){var e=u.default.createElement("div",null,"Remember to add this page to your bookmarks!");return/Mobile/i.test(navigator.userAgent)?this.renderMobile(e):/Android/i.test(navigator.userAgent)?this.renderTablet(e):this.renderDesktop()}}]),t}(s.Component);b.propTypes={className:c.default.string,linkClassName:c.default.string,title:c.default.string,href:c.default.string,onAddBookmark:c.default.func},b.defaultProps={className:"",linkClassName:"",title:"",href:"#",onAddBookmark:function(){}},t.ZP=b},8793:function(e,t,n){"use strict";var r=n(98583),i=n(5954);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a="function"==typeof Symbol&&Symbol.for,s=a?Symbol.for("react.portal"):60106,u=a?Symbol.for("react.fragment"):60107,c=a?Symbol.for("react.strict_mode"):60108,l=a?Symbol.for("react.profiler"):60114,d=a?Symbol.for("react.provider"):60109,f=a?Symbol.for("react.context"):60110,p=a?Symbol.for("react.concurrent_mode"):60111,h=a?Symbol.for("react.forward_ref"):60112,v=a?Symbol.for("react.suspense"):60113,m=a?Symbol.for("react.suspense_list"):60120,y=a?Symbol.for("react.memo"):60115,g=a?Symbol.for("react.lazy"):60116,b=a?Symbol.for("react.block"):60121,x=a?Symbol.for("react.fundamental"):60117,_=a?Symbol.for("react.scope"):60119;function w(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case u:return"Fragment";case s:return"Portal";case l:return"Profiler";case c:return"StrictMode";case v:return"Suspense";case m:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case f:return"Context.Consumer";case d:return"Context.Provider";case h:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case y:return w(e.type);case b:return w(e.render);case g:if(e=1===e._status?e._result:null)return w(e)}return null}var M=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;M.hasOwnProperty("ReactCurrentDispatcher")||(M.ReactCurrentDispatcher={current:null}),M.hasOwnProperty("ReactCurrentBatchConfig")||(M.ReactCurrentBatchConfig={suspense:null});var S={};function T(e,t){for(var n=0|e._threadCount;n<=t;n++)e[n]=e._currentValue2,e._threadCount=n+1}for(var E=new Uint16Array(16),k=0;15>k;k++)E[k]=k+1;E[15]=0;var A=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,P=Object.prototype.hasOwnProperty,C={},O={};function I(e){return!!P.call(O,e)||!P.call(C,e)&&(A.test(e)?O[e]=!0:(C[e]=!0,!1))}function R(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){N[e]=new R(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];N[t]=new R(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){N[e]=new R(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){N[e]=new R(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){N[e]=new R(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){N[e]=new R(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){N[e]=new R(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){N[e]=new R(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){N[e]=new R(e,5,!1,e.toLowerCase(),null,!1)}));var D=/[\-:]([a-z])/g;function L(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(D,L);N[t]=new R(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(D,L);N[t]=new R(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(D,L);N[t]=new R(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){N[e]=new R(e,1,!1,e.toLowerCase(),null,!1)})),N.xlinkHref=new R("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){N[e]=new R(e,1,!1,e.toLowerCase(),null,!0)}));var B=/["'&<>]/;function F(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=B.exec(e);if(t){var n,r="",i=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==n&&(r+=e.substring(i,n)),i=n+1,r+=t}e=i!==n?r+e.substring(i,n):r}return e}function j(e,t){var n,r=N.hasOwnProperty(e)?N[e]:null;return(n="style"!==e)&&(n=null!==r?0===r.type:2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])),n||function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e;default:return!1}}(e,t,n))return!0;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(e,t,r)?"":null!==r?(e=r.attributeName,3===(n=r.type)||4===n&&!0===t?e+'=""':(r.sanitizeURL&&(t=""+t),e+'="'+F(t)+'"')):I(e)?e+'="'+F(t)+'"':""}var z="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},U=null,G=null,V=null,W=!1,H=!1,Z=null,q=0;function Y(){if(null===U)throw Error(o(321));return U}function X(){if(0<q)throw Error(o(312));return{memoizedState:null,queue:null,next:null}}function K(){return null===V?null===G?(W=!1,G=V=X()):(W=!0,V=G):null===V.next?(W=!1,V=V.next=X()):(W=!0,V=V.next),V}function J(e,t,n,r){for(;H;)H=!1,q+=1,V=null,n=e(t,r);return G=U=null,q=0,V=Z=null,n}function Q(e,t){return"function"==typeof t?t(e):t}function $(e,t,n){if(U=Y(),V=K(),W){var r=V.queue;if(t=r.dispatch,null!==Z&&void 0!==(n=Z.get(r))){Z.delete(r),r=V.memoizedState;do{r=e(r,n.action),n=n.next}while(null!==n);return V.memoizedState=r,[r,t]}return[V.memoizedState,t]}return e=e===Q?"function"==typeof t?t():t:void 0!==n?n(t):t,V.memoizedState=e,e=(e=V.queue={last:null,dispatch:null}).dispatch=ee.bind(null,U,e),[V.memoizedState,e]}function ee(e,t,n){if(!(25>q))throw Error(o(301));if(e===U)if(H=!0,e={action:n,next:null},null===Z&&(Z=new Map),void 0===(n=Z.get(t)))Z.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function te(){}var ne=0,re={readContext:function(e){var t=ne;return T(e,t),e[t]},useContext:function(e){Y();var t=ne;return T(e,t),e[t]},useMemo:function(e,t){if(U=Y(),t=void 0===t?null:t,null!==(V=K())){var n=V.memoizedState;if(null!==n&&null!==t){e:{var r=n[1];if(null===r)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!z(t[i],r[i])){r=!1;break e}r=!0}}if(r)return n[0]}}return e=e(),V.memoizedState=[e,t],e},useReducer:$,useRef:function(e){U=Y();var t=(V=K()).memoizedState;return null===t?(e={current:e},V.memoizedState=e):t},useState:function(e){return $(Q,e)},useLayoutEffect:function(){},useCallback:function(e){return e},useImperativeHandle:te,useEffect:te,useDebugValue:te,useResponder:function(e,t){return{props:t,responder:e}},useDeferredValue:function(e){return Y(),e},useTransition:function(){return Y(),[function(e){e()},!1]}},ie="http://www.w3.org/1999/xhtml";function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var ae={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},se=r({menuitem:!0},ae),ue={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ce=["Webkit","ms","Moz","O"];Object.keys(ue).forEach((function(e){ce.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ue[t]=ue[e]}))}));var le=/([A-Z])/g,de=/^ms-/,fe=i.Children.toArray,pe=M.ReactCurrentDispatcher,he={listing:!0,pre:!0,textarea:!0},ve=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,me={},ye={},ge=Object.prototype.hasOwnProperty,be={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function xe(e,t){if(void 0===e)throw Error(o(152,w(t)||"Component"))}var _e=function(){function e(e,t){i.isValidElement(e)?e.type!==u?e=[e]:(e=e.props.children,e=i.isValidElement(e)?[e]:fe(e)):e=fe(e),e={type:null,domNamespace:ie,children:e,childIndex:0,context:S,footer:""};var n=E[0];if(0===n){var r=E,a=2*(n=r.length);if(!(65536>=a))throw Error(o(304));var s=new Uint16Array(a);for(s.set(r),(E=s)[0]=n+1,r=n;r<a-1;r++)E[r]=r+1;E[a-1]=0}else E[0]=E[n];this.threadID=n,this.stack=[e],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=t,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[]}var t=e.prototype;return t.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var e=this.threadID;E[e]=E[0],E[0]=e}},t.pushProvider=function(e){var t=++this.contextIndex,n=e.type._context,r=this.threadID;T(n,r);var i=n[r];this.contextStack[t]=n,this.contextValueStack[t]=i,n[r]=e.props.value},t.popProvider=function(){var e=this.contextIndex,t=this.contextStack[e],n=this.contextValueStack[e];this.contextStack[e]=null,this.contextValueStack[e]=null,this.contextIndex--,t[this.threadID]=n},t.clearProviders=function(){for(var e=this.contextIndex;0<=e;e--)this.contextStack[e][this.threadID]=this.contextValueStack[e]},t.read=function(e){if(this.exhausted)return null;var t=ne;ne=this.threadID;var n=pe.current;pe.current=re;try{for(var r=[""],i=!1;r[0].length<e;){if(0===this.stack.length){this.exhausted=!0;var a=this.threadID;E[a]=E[0],E[0]=a;break}var s=this.stack[this.stack.length-1];if(i||s.childIndex>=s.children.length){var u=s.footer;if(""!==u&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===s.type)this.currentSelectValue=null;else if(null!=s.type&&null!=s.type.type&&s.type.type.$$typeof===d)this.popProvider(s.type);else if(s.type===v){this.suspenseDepth--;var c=r.pop();if(i){i=!1;var l=s.fallbackFrame;if(!l)throw Error(o(303));this.stack.push(l),r[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}r[this.suspenseDepth]+=c}r[this.suspenseDepth]+=u}else{var f=s.children[s.childIndex++],p="";try{p+=this.render(f,s.context,s.domNamespace)}catch(e){if(null!=e&&"function"==typeof e.then)throw Error(o(294));throw e}r.length<=this.suspenseDepth&&r.push(""),r[this.suspenseDepth]+=p}}return r[0]}finally{pe.current=n,ne=t}},t.render=function(e,t,n){if("string"==typeof e||"number"==typeof e)return""==(n=""+e)?"":this.makeStaticMarkup?F(n):this.previousWasTextNode?"\x3c!-- --\x3e"+F(n):(this.previousWasTextNode=!0,F(n));if(e=(t=function(e,t,n){function a(i,a){var s=a.prototype&&a.prototype.isReactComponent,u=function(e,t,n,r){if(r&&"object"==typeof(r=e.contextType)&&null!==r)return T(r,n),r[n];if(e=e.contextTypes){for(var i in n={},e)n[i]=t[i];t=n}else t=S;return t}(a,t,n,s),c=[],l=!1,d={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===c)return null},enqueueReplaceState:function(e,t){l=!0,c=[t]},enqueueSetState:function(e,t){if(null===c)return null;c.push(t)}};if(s){if(s=new a(i.props,u,d),"function"==typeof a.getDerivedStateFromProps){var f=a.getDerivedStateFromProps.call(null,i.props,s.state);null!=f&&(s.state=r({},s.state,f))}}else if(U={},s=a(i.props,u,d),null==(s=J(a,i.props,s,u))||null==s.render)return void xe(e=s,a);if(s.props=i.props,s.context=u,s.updater=d,void 0===(d=s.state)&&(s.state=d=null),"function"==typeof s.UNSAFE_componentWillMount||"function"==typeof s.componentWillMount)if("function"==typeof s.componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.UNSAFE_componentWillMount(),c.length){d=c;var p=l;if(c=null,l=!1,p&&1===d.length)s.state=d[0];else{f=p?d[0]:s.state;var h=!0;for(p=p?1:0;p<d.length;p++){var v=d[p];null!=(v="function"==typeof v?v.call(s,f,i.props,u):v)&&(h?(h=!1,f=r({},f,v)):r(f,v))}s.state=f}}else c=null;if(xe(e=s.render(),a),"function"==typeof s.getChildContext&&"object"==typeof(i=a.childContextTypes)){var m=s.getChildContext();for(var y in m)if(!(y in i))throw Error(o(108,w(a)||"Unknown",y))}m&&(t=r({},t,m))}for(;i.isValidElement(e);){var s=e,u=s.type;if("function"!=typeof u)break;a(s,u)}return{child:e,context:t}}(e,t,this.threadID)).child,t=t.context,null===e||!1===e)return"";if(!i.isValidElement(e)){if(null!=e&&null!=e.$$typeof){if((n=e.$$typeof)===s)throw Error(o(257));throw Error(o(258,n.toString()))}return e=fe(e),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}var a=e.type;if("string"==typeof a)return this.renderDOM(e,t,n);switch(a){case c:case p:case l:case m:case u:return e=fe(e.props.children),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case v:throw Error(o(294))}if("object"==typeof a&&null!==a)switch(a.$$typeof){case h:U={};var b=a.render(e.props,e.ref);return b=J(a.render,e.props,b,e.ref),b=fe(b),this.stack.push({type:null,domNamespace:n,children:b,childIndex:0,context:t,footer:""}),"";case y:return e=[i.createElement(a.type,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case d:return n={type:e,domNamespace:n,children:a=fe(e.props.children),childIndex:0,context:t,footer:""},this.pushProvider(e),this.stack.push(n),"";case f:a=e.type,b=e.props;var M=this.threadID;return T(a,M),a=fe(b.children(a[M])),this.stack.push({type:e,domNamespace:n,children:a,childIndex:0,context:t,footer:""}),"";case x:throw Error(o(338));case g:switch(function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(a=e.type),a._status){case 1:return e=[i.createElement(a._result,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case 2:throw a._result;default:throw Error(o(295))}case _:throw Error(o(343))}throw Error(o(130,null==a?a:typeof a,""))},t.renderDOM=function(e,t,n){var a=e.type.toLowerCase();if(n===ie&&oe(a),!me.hasOwnProperty(a)){if(!ve.test(a))throw Error(o(65,a));me[a]=!0}var s=e.props;if("input"===a)s=r({type:void 0},s,{defaultChecked:void 0,defaultValue:void 0,value:null!=s.value?s.value:s.defaultValue,checked:null!=s.checked?s.checked:s.defaultChecked});else if("textarea"===a){var u=s.value;if(null==u){u=s.defaultValue;var c=s.children;if(null!=c){if(null!=u)throw Error(o(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(o(93));c=c[0]}u=""+c}null==u&&(u="")}s=r({},s,{value:void 0,children:""+u})}else if("select"===a)this.currentSelectValue=null!=s.value?s.value:s.defaultValue,s=r({},s,{value:void 0});else if("option"===a){c=this.currentSelectValue;var l=function(e){if(null==e)return e;var t="";return i.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(s.children);if(null!=c){var d=null!=s.value?s.value+"":l;if(u=!1,Array.isArray(c)){for(var f=0;f<c.length;f++)if(""+c[f]===d){u=!0;break}}else u=""+c===d;s=r({selected:void 0,children:void 0},s,{selected:u,children:l})}}if(u=s){if(se[a]&&(null!=u.children||null!=u.dangerouslySetInnerHTML))throw Error(o(137,a,""));if(null!=u.dangerouslySetInnerHTML){if(null!=u.children)throw Error(o(60));if("object"!=typeof u.dangerouslySetInnerHTML||!("__html"in u.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=u.style&&"object"!=typeof u.style)throw Error(o(62,""))}for(x in u=s,c=this.makeStaticMarkup,l=1===this.stack.length,d="<"+e.type,u)if(ge.call(u,x)){var p=u[x];if(null!=p){if("style"===x){f=void 0;var h="",v="";for(f in p)if(p.hasOwnProperty(f)){var m=0===f.indexOf("--"),y=p[f];if(null!=y){if(m)var g=f;else if(g=f,ye.hasOwnProperty(g))g=ye[g];else{var b=g.replace(le,"-$1").toLowerCase().replace(de,"-ms-");g=ye[g]=b}h+=v+g+":",v=f,h+=m=null==y||"boolean"==typeof y||""===y?"":m||"number"!=typeof y||0===y||ue.hasOwnProperty(v)&&ue[v]?(""+y).trim():y+"px",v=";"}}p=h||null}f=null;e:if(m=a,y=u,-1===m.indexOf("-"))m="string"==typeof y.is;else switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":m=!1;break e;default:m=!0}m?be.hasOwnProperty(x)||(f=I(f=x)&&null!=p?f+'="'+F(p)+'"':""):f=j(x,p),f&&(d+=" "+f)}}c||l&&(d+=' data-reactroot=""');var x=d;u="",ae.hasOwnProperty(a)?x+="/>":(x+=">",u="</"+e.type+">");e:{if(null!=(c=s.dangerouslySetInnerHTML)){if(null!=c.__html){c=c.__html;break e}}else if("string"==typeof(c=s.children)||"number"==typeof c){c=F(c);break e}c=null}return null!=c?(s=[],he.hasOwnProperty(a)&&"\n"===c.charAt(0)&&(x+="\n"),x+=c):s=fe(s.children),e=e.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?oe(e):"http://www.w3.org/2000/svg"===n&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:a,children:s,childIndex:0,context:t,footer:u}),this.previousWasTextNode=!1,x},e}(),we={renderToString:function(e){e=new _e(e,!1);try{return e.read(1/0)}finally{e.destroy()}},renderToStaticMarkup:function(e){e=new _e(e,!0);try{return e.read(1/0)}finally{e.destroy()}},renderToNodeStream:function(){throw Error(o(207))},renderToStaticNodeStream:function(){throw Error(o(208))},version:"16.14.0"};e.exports=we.default||we},5086:function(e,t,n){"use strict";e.exports=n(8793)},13062:function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(2))&&r.__esModule?r:{default:r};t.default=i.default,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function i(e){return e&&e.__esModule?e:{default:e}}t.default=c;var o=n(3),a=i(n(4)),s=n(14),u=i(n(15));function c(e){var t=e.activeClassName,n=void 0===t?"":t,i=e.activeIndex,a=void 0===i?-1:i,c=e.activeStyle,l=e.autoEscape,d=e.caseSensitive,f=void 0!==d&&d,p=e.className,h=e.findChunks,v=e.highlightClassName,m=void 0===v?"":v,y=e.highlightStyle,g=void 0===y?{}:y,b=e.highlightTag,x=void 0===b?"mark":b,_=e.sanitize,w=e.searchWords,M=e.textToHighlight,S=e.unhighlightClassName,T=void 0===S?"":S,E=e.unhighlightStyle,k=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightClassName","unhighlightStyle"]),A=(0,o.findAll)({autoEscape:l,caseSensitive:f,findChunks:h,sanitize:_,searchWords:w,textToHighlight:M}),P=x,C=-1,O="",I=void 0,R=(0,u.default)((function(e){var t={};for(var n in e)t[n.toLowerCase()]=e[n];return t}));return(0,s.createElement)("span",r({className:p},k,{children:A.map((function(e,t){var r=M.substr(e.start,e.end-e.start);if(e.highlight){C++;var i;i="object"==typeof m?f?m[r]:(m=R(m))[r.toLowerCase()]:m;var o=C===+a;O=i+" "+(o?n:""),I=!0===o&&null!=c?Object.assign({},g,c):g;var u={children:r,className:O,key:t,style:I};return"string"!=typeof P&&(u.highlightIndex=C),(0,s.createElement)(P,u)}return(0,s.createElement)("span",{children:r,className:T,key:t,style:E})}))}))}c.propTypes={activeClassName:a.default.string,activeIndex:a.default.number,activeStyle:a.default.object,autoEscape:a.default.bool,className:a.default.string,findChunks:a.default.func,highlightClassName:a.default.oneOfType([a.default.object,a.default.string]),highlightStyle:a.default.object,highlightTag:a.default.oneOfType([a.default.node,a.default.func,a.default.string]),sanitize:a.default.func,searchWords:a.default.arrayOf(a.default.oneOfType([a.default.string,a.default.instanceOf(RegExp)])).isRequired,textToHighlight:a.default.string.isRequired,unhighlightClassName:a.default.string,unhighlightStyle:a.default.object},e.exports=t.default},function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);Object.defineProperty(t,"combineChunks",{enumerable:!0,get:function(){return r.combineChunks}}),Object.defineProperty(t,"fillInChunks",{enumerable:!0,get:function(){return r.fillInChunks}}),Object.defineProperty(t,"findAll",{enumerable:!0,get:function(){return r.findAll}}),Object.defineProperty(t,"findChunks",{enumerable:!0,get:function(){return r.findChunks}})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAll=function(e){var t=e.autoEscape,o=e.caseSensitive,a=void 0!==o&&o,s=e.findChunks,u=void 0===s?r:s,c=e.sanitize,l=e.searchWords,d=e.textToHighlight;return i({chunksToHighlight:n({chunks:u({autoEscape:t,caseSensitive:a,sanitize:c,searchWords:l,textToHighlight:d})}),totalLength:d?d.length:0})};var n=t.combineChunks=function(e){var t=e.chunks;return t.sort((function(e,t){return e.start-t.start})).reduce((function(e,t){if(0===e.length)return[t];var n=e.pop();if(t.start<=n.end){var r=Math.max(n.end,t.end);e.push({start:n.start,end:r})}else e.push(n,t);return e}),[])},r=function(e){var t=e.autoEscape,n=e.caseSensitive,r=e.sanitize,i=void 0===r?o:r,a=e.searchWords,s=e.textToHighlight;return s=i(s),a.filter((function(e){return e})).reduce((function(e,r){r=i(r),t&&(r=r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"));for(var o=new RegExp(r,n?"g":"gi"),a=void 0;a=o.exec(s);){var u=a.index,c=o.lastIndex;c>u&&e.push({start:u,end:c}),a.index==o.lastIndex&&o.lastIndex++}return e}),[])};t.findChunks=r;var i=t.fillInChunks=function(e){var t=e.chunksToHighlight,n=e.totalLength,r=[],i=function(e,t,n){t-e>0&&r.push({start:e,end:t,highlight:n})};if(0===t.length)i(0,n,!1);else{var o=0;t.forEach((function(e){i(o,e.start,!1),i(e.start,e.end,!0),o=e.end})),i(o,n,!1)}return r};function o(e){return e}}])},function(e,t,n){(function(t){if("production"!==t.env.NODE_ENV){var r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=n(6)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}),!0)}else e.exports=n(13)()}).call(t,n(5))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){(function(t){"use strict";var r=n(7),i=n(8),o=n(9),a=n(10),s=n(11),u=n(12);e.exports=function(e,n){var c="function"==typeof Symbol&&Symbol.iterator,l="<<anonymous>>",d={array:h("array"),bool:h("boolean"),func:h("function"),number:h("number"),object:h("object"),string:h("string"),symbol:h("symbol"),any:p(r.thatReturnsNull),arrayOf:function(e){return p((function(t,n,r,i,o){if("function"!=typeof e)return new f("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var a=t[n];if(!Array.isArray(a))return new f("Invalid "+i+" `"+o+"` of type `"+m(a)+"` supplied to `"+r+"`, expected an array.");for(var u=0;u<a.length;u++){var c=e(a,u,r,i,o+"["+u+"]",s);if(c instanceof Error)return c}return null}))},element:p((function(t,n,r,i,o){var a=t[n];return e(a)?null:new f("Invalid "+i+" `"+o+"` of type `"+m(a)+"` supplied to `"+r+"`, expected a single ReactElement.")})),instanceOf:function(e){return p((function(t,n,r,i,o){if(!(t[n]instanceof e)){var a=e.name||l;return new f("Invalid "+i+" `"+o+"` of type `"+((s=t[n]).constructor&&s.constructor.name?s.constructor.name:l)+"` supplied to `"+r+"`, expected instance of `"+a+"`.")}var s;return null}))},node:p((function(e,t,n,r,i){return v(e[t])?null:new f("Invalid "+r+" `"+i+"` supplied to `"+n+"`, expected a ReactNode.")})),objectOf:function(e){return p((function(t,n,r,i,o){if("function"!=typeof e)return new f("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var a=t[n],u=m(a);if("object"!==u)return new f("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected an object.");for(var c in a)if(a.hasOwnProperty(c)){var l=e(a,c,r,i,o+"."+c,s);if(l instanceof Error)return l}return null}))},oneOf:function(e){return Array.isArray(e)?p((function(t,n,r,i,o){for(var a=t[n],s=0;s<e.length;s++)if(u=a,c=e[s],u===c?0!==u||1/u==1/c:u!=u&&c!=c)return null;var u,c;return new f("Invalid "+i+" `"+o+"` of value `"+a+"` supplied to `"+r+"`, expected one of "+JSON.stringify(e)+".")})):("production"!==t.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOf, expected an instance of array."),r.thatReturnsNull)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==t.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),r.thatReturnsNull;for(var n=0;n<e.length;n++){var i=e[n];if("function"!=typeof i)return o(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",g(i),n),r.thatReturnsNull}return p((function(t,n,r,i,o){for(var a=0;a<e.length;a++)if(null==(0,e[a])(t,n,r,i,o,s))return null;return new f("Invalid "+i+" `"+o+"` supplied to `"+r+"`.")}))},shape:function(e){return p((function(t,n,r,i,o){var a=t[n],u=m(a);if("object"!==u)return new f("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected `object`.");for(var c in e){var l=e[c];if(l){var d=l(a,c,r,i,o+"."+c,s);if(d)return d}}return null}))},exact:function(e){return p((function(t,n,r,i,o){var u=t[n],c=m(u);if("object"!==c)return new f("Invalid "+i+" `"+o+"` of type `"+c+"` supplied to `"+r+"`, expected `object`.");var l=a({},t[n],e);for(var d in l){var p=e[d];if(!p)return new f("Invalid "+i+" `"+o+"` key `"+d+"` supplied to `"+r+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var h=p(u,d,r,i,o+"."+d,s);if(h)return h}return null}))}};function f(e){this.message=e,this.stack=""}function p(e){if("production"!==t.env.NODE_ENV)var r={},a=0;function u(u,c,d,p,h,v,m){if(p=p||l,v=v||d,m!==s)if(n)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==t.env.NODE_ENV&&"undefined"!=typeof console){var y=p+":"+d;!r[y]&&a<3&&(o(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",v,p),r[y]=!0,a++)}return null==c[d]?u?null===c[d]?new f("The "+h+" `"+v+"` is marked as required in `"+p+"`, but its value is `null`."):new f("The "+h+" `"+v+"` is marked as required in `"+p+"`, but its value is `undefined`."):null:e(c,d,p,h,v)}var c=u.bind(null,!1);return c.isRequired=u.bind(null,!0),c}function h(e){return p((function(t,n,r,i,o,a){var s=t[n];return m(s)!==e?new f("Invalid "+i+" `"+o+"` of type `"+y(s)+"` supplied to `"+r+"`, expected `"+e+"`."):null}))}function v(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(v);if(null===t||e(t))return!0;var n=function(e){var t=e&&(c&&e[c]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!n)return!1;var r,i=n.call(t);if(n!==t.entries){for(;!(r=i.next()).done;)if(!v(r.value))return!1}else for(;!(r=i.next()).done;){var o=r.value;if(o&&!v(o[1]))return!1}return!0;default:return!1}}function m(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol}(t,e)?"symbol":t}function y(e){if(null==e)return""+e;var t=m(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function g(e){var t=y(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return f.prototype=Error.prototype,d.checkPropTypes=u,d.PropTypes=d,d}}).call(t,n(5))},function(e,t){"use strict";function n(e){return function(){return e}}var r=function(){};r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},function(e,t,n){(function(t){"use strict";var n=function(e){};"production"!==t.env.NODE_ENV&&(n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=function(e,t,r,i,o,a,s,u){if(n(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[r,i,o,a,s,u],d=0;(c=new Error(t.replace(/%s/g,(function(){return l[d++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}}).call(t,n(5))},function(e,t,n){(function(t){"use strict";var r=n(7);if("production"!==t.env.NODE_ENV){var i=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o="Warning: "+e.replace(/%s/g,(function(){return n[i++]}));"undefined"!=typeof console&&console.error(o);try{throw new Error(o)}catch(e){}};r=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];i.apply(void 0,[t].concat(r))}}}e.exports=r}).call(t,n(5))},function(e,t){"use strict";var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var a,s,u=o(e),c=1;c<arguments.length;c++){for(var l in a=Object(arguments[c]))r.call(a,l)&&(u[l]=a[l]);if(n){s=n(a);for(var d=0;d<s.length;d++)i.call(a,s[d])&&(u[s[d]]=a[s[d]])}}return u}},function(e,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){(function(t){"use strict";if("production"!==t.env.NODE_ENV)var r=n(8),i=n(9),o=n(11),a={};e.exports=function(e,n,s,u,c){if("production"!==t.env.NODE_ENV)for(var l in e)if(e.hasOwnProperty(l)){var d;try{r("function"==typeof e[l],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",u||"React class",s,l,typeof e[l]),d=e[l](n,l,u,s,null,o)}catch(e){d=e}if(i(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",u||"React class",s,l,typeof d),d instanceof Error&&!(d.message in a)){a[d.message]=!0;var f=c?c():"";i(!1,"Failed %s type: %s%s",s,d.message,null!=f?f:"")}}}}).call(t,n(5))},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(11);e.exports=function(){function e(e,t,n,r,a,s){s!==o&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=r,n.PropTypes=n,n}},function(e,t){e.exports=n(5954)},function(e,t){"use strict";var n=function(e,t){return e===t};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=void 0,i=[],o=void 0,a=!1,s=function(e,n){return t(e,i[n])},u=function(){for(var t=arguments.length,n=Array(t),u=0;u<t;u++)n[u]=arguments[u];return a&&r===this&&n.length===i.length&&n.every(s)?o:(a=!0,r=this,i=n,o=e.apply(this,n))};return u}}])},35027:function(e,t,n){var r=n(75895),i=n(86886),o=n(36095),a=n(20259);e.exports=function(e,t,n){return Array.isArray(e)||(e=[e]),a(e.map((function(e){return o(e)?function(e,t,n){var a=0,s=0;if(""===e)return e;if(!e||!o(e))throw new TypeError("First argument to react-string-replace#replaceString must be a string");var u=t;r(u)||(u=new RegExp("("+i(u)+")","gi"));for(var c=e.split(u),l=1,d=c.length;l<d;l+=2)s=c[l].length,a+=c[l-1].length,c[l]=n(c[l],l,a),a+=s;return c}(e,t,n):e})))}},42030:function(e,t,n){"use strict";var r=n(77616).functionsHaveConfigurableNames(),i=Object,o=TypeError;e.exports=function(){if(null!=this&&this!==i(this))throw new o("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e},r&&Object.defineProperty&&Object.defineProperty(e.exports,"name",{value:"get flags"})},38962:function(e,t,n){"use strict";var r=n(92795),i=n(6537),o=n(42030),a=n(88988),s=n(17137),u=i(a());r(u,{getPolyfill:a,implementation:o,shim:s}),e.exports=u},88988:function(e,t,n){"use strict";var r=n(42030),i=n(92795).supportsDescriptors,o=Object.getOwnPropertyDescriptor;e.exports=function(){if(i&&"gim"===/a/gim.flags){var e=o(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),"dy"===t)return e.get}}return r}},17137:function(e,t,n){"use strict";var r=n(92795).supportsDescriptors,i=n(88988),o=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,u=Object.getPrototypeOf,c=/a/;e.exports=function(){if(!r||!u)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=i(),t=u(c),n=o(t,"flags");return n&&n.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},35400:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.interval=t.iif=t.generate=t.fromEventPattern=t.fromEvent=t.from=t.forkJoin=t.empty=t.defer=t.connectable=t.concat=t.combineLatest=t.bindNodeCallback=t.bindCallback=t.UnsubscriptionError=t.TimeoutError=t.SequenceError=t.ObjectUnsubscribedError=t.NotFoundError=t.EmptyError=t.ArgumentOutOfRangeError=t.firstValueFrom=t.lastValueFrom=t.isObservable=t.identity=t.noop=t.pipe=t.NotificationKind=t.Notification=t.Subscriber=t.Subscription=t.Scheduler=t.VirtualAction=t.VirtualTimeScheduler=t.animationFrameScheduler=t.animationFrame=t.queueScheduler=t.queue=t.asyncScheduler=t.async=t.asapScheduler=t.asap=t.AsyncSubject=t.ReplaySubject=t.BehaviorSubject=t.Subject=t.animationFrames=t.observable=t.ConnectableObservable=t.Observable=void 0,t.filter=t.expand=t.exhaustMap=t.exhaustAll=t.exhaust=t.every=t.endWith=t.elementAt=t.distinctUntilKeyChanged=t.distinctUntilChanged=t.distinct=t.dematerialize=t.delayWhen=t.delay=t.defaultIfEmpty=t.debounceTime=t.debounce=t.count=t.connect=t.concatWith=t.concatMapTo=t.concatMap=t.concatAll=t.combineLatestWith=t.combineLatestAll=t.combineAll=t.catchError=t.bufferWhen=t.bufferToggle=t.bufferTime=t.bufferCount=t.buffer=t.auditTime=t.audit=t.config=t.NEVER=t.EMPTY=t.scheduled=t.zip=t.using=t.timer=t.throwError=t.range=t.race=t.partition=t.pairs=t.onErrorResumeNext=t.of=t.never=t.merge=void 0,t.switchMapTo=t.switchMap=t.switchAll=t.subscribeOn=t.startWith=t.skipWhile=t.skipUntil=t.skipLast=t.skip=t.single=t.shareReplay=t.share=t.sequenceEqual=t.scan=t.sampleTime=t.sample=t.refCount=t.retryWhen=t.retry=t.repeatWhen=t.repeat=t.reduce=t.raceWith=t.publishReplay=t.publishLast=t.publishBehavior=t.publish=t.pluck=t.pairwise=t.observeOn=t.multicast=t.min=t.mergeWith=t.mergeScan=t.mergeMapTo=t.mergeMap=t.flatMap=t.mergeAll=t.max=t.materialize=t.mapTo=t.map=t.last=t.isEmpty=t.ignoreElements=t.groupBy=t.first=t.findIndex=t.find=t.finalize=void 0,t.zipWith=t.zipAll=t.withLatestFrom=t.windowWhen=t.windowToggle=t.windowTime=t.windowCount=t.window=t.toArray=t.timestamp=t.timeoutWith=t.timeout=t.timeInterval=t.throwIfEmpty=t.throttleTime=t.throttle=t.tap=t.takeWhile=t.takeUntil=t.takeLast=t.take=t.switchScan=void 0;var o=n(29299);Object.defineProperty(t,"Observable",{enumerable:!0,get:function(){return o.Observable}});var a=n(11107);Object.defineProperty(t,"ConnectableObservable",{enumerable:!0,get:function(){return a.ConnectableObservable}});var s=n(69981);Object.defineProperty(t,"observable",{enumerable:!0,get:function(){return s.observable}});var u=n(84813);Object.defineProperty(t,"animationFrames",{enumerable:!0,get:function(){return u.animationFrames}});var c=n(15094);Object.defineProperty(t,"Subject",{enumerable:!0,get:function(){return c.Subject}});var l=n(99800);Object.defineProperty(t,"BehaviorSubject",{enumerable:!0,get:function(){return l.BehaviorSubject}});var d=n(58113);Object.defineProperty(t,"ReplaySubject",{enumerable:!0,get:function(){return d.ReplaySubject}});var f=n(33867);Object.defineProperty(t,"AsyncSubject",{enumerable:!0,get:function(){return f.AsyncSubject}});var p=n(80721);Object.defineProperty(t,"asap",{enumerable:!0,get:function(){return p.asap}}),Object.defineProperty(t,"asapScheduler",{enumerable:!0,get:function(){return p.asapScheduler}});var h=n(71805);Object.defineProperty(t,"async",{enumerable:!0,get:function(){return h.async}}),Object.defineProperty(t,"asyncScheduler",{enumerable:!0,get:function(){return h.asyncScheduler}});var v=n(84532);Object.defineProperty(t,"queue",{enumerable:!0,get:function(){return v.queue}}),Object.defineProperty(t,"queueScheduler",{enumerable:!0,get:function(){return v.queueScheduler}});var m=n(92165);Object.defineProperty(t,"animationFrame",{enumerable:!0,get:function(){return m.animationFrame}}),Object.defineProperty(t,"animationFrameScheduler",{enumerable:!0,get:function(){return m.animationFrameScheduler}});var y=n(27950);Object.defineProperty(t,"VirtualTimeScheduler",{enumerable:!0,get:function(){return y.VirtualTimeScheduler}}),Object.defineProperty(t,"VirtualAction",{enumerable:!0,get:function(){return y.VirtualAction}});var g=n(27619);Object.defineProperty(t,"Scheduler",{enumerable:!0,get:function(){return g.Scheduler}});var b=n(50979);Object.defineProperty(t,"Subscription",{enumerable:!0,get:function(){return b.Subscription}});var x=n(64767);Object.defineProperty(t,"Subscriber",{enumerable:!0,get:function(){return x.Subscriber}});var _=n(2930);Object.defineProperty(t,"Notification",{enumerable:!0,get:function(){return _.Notification}}),Object.defineProperty(t,"NotificationKind",{enumerable:!0,get:function(){return _.NotificationKind}});var w=n(49200);Object.defineProperty(t,"pipe",{enumerable:!0,get:function(){return w.pipe}});var M=n(83197);Object.defineProperty(t,"noop",{enumerable:!0,get:function(){return M.noop}});var S=n(18055);Object.defineProperty(t,"identity",{enumerable:!0,get:function(){return S.identity}});var T=n(20530);Object.defineProperty(t,"isObservable",{enumerable:!0,get:function(){return T.isObservable}});var E=n(96588);Object.defineProperty(t,"lastValueFrom",{enumerable:!0,get:function(){return E.lastValueFrom}});var k=n(78510);Object.defineProperty(t,"firstValueFrom",{enumerable:!0,get:function(){return k.firstValueFrom}});var A=n(2886);Object.defineProperty(t,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return A.ArgumentOutOfRangeError}});var P=n(75261);Object.defineProperty(t,"EmptyError",{enumerable:!0,get:function(){return P.EmptyError}});var C=n(66275);Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return C.NotFoundError}});var O=n(53971);Object.defineProperty(t,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return O.ObjectUnsubscribedError}});var I=n(11590);Object.defineProperty(t,"SequenceError",{enumerable:!0,get:function(){return I.SequenceError}});var R=n(73687);Object.defineProperty(t,"TimeoutError",{enumerable:!0,get:function(){return R.TimeoutError}});var N=n(17750);Object.defineProperty(t,"UnsubscriptionError",{enumerable:!0,get:function(){return N.UnsubscriptionError}});var D=n(91506);Object.defineProperty(t,"bindCallback",{enumerable:!0,get:function(){return D.bindCallback}});var L=n(732);Object.defineProperty(t,"bindNodeCallback",{enumerable:!0,get:function(){return L.bindNodeCallback}});var B=n(80680);Object.defineProperty(t,"combineLatest",{enumerable:!0,get:function(){return B.combineLatest}});var F=n(6628);Object.defineProperty(t,"concat",{enumerable:!0,get:function(){return F.concat}});var j=n(6649);Object.defineProperty(t,"connectable",{enumerable:!0,get:function(){return j.connectable}});var z=n(7906);Object.defineProperty(t,"defer",{enumerable:!0,get:function(){return z.defer}});var U=n(2577);Object.defineProperty(t,"empty",{enumerable:!0,get:function(){return U.empty}});var G=n(7354);Object.defineProperty(t,"forkJoin",{enumerable:!0,get:function(){return G.forkJoin}});var V=n(14773);Object.defineProperty(t,"from",{enumerable:!0,get:function(){return V.from}});var W=n(1969);Object.defineProperty(t,"fromEvent",{enumerable:!0,get:function(){return W.fromEvent}});var H=n(4971);Object.defineProperty(t,"fromEventPattern",{enumerable:!0,get:function(){return H.fromEventPattern}});var Z=n(67154);Object.defineProperty(t,"generate",{enumerable:!0,get:function(){return Z.generate}});var q=n(51991);Object.defineProperty(t,"iif",{enumerable:!0,get:function(){return q.iif}});var Y=n(63363);Object.defineProperty(t,"interval",{enumerable:!0,get:function(){return Y.interval}});var X=n(93062);Object.defineProperty(t,"merge",{enumerable:!0,get:function(){return X.merge}});var K=n(49510);Object.defineProperty(t,"never",{enumerable:!0,get:function(){return K.never}});var J=n(63674);Object.defineProperty(t,"of",{enumerable:!0,get:function(){return J.of}});var Q=n(41131);Object.defineProperty(t,"onErrorResumeNext",{enumerable:!0,get:function(){return Q.onErrorResumeNext}});var $=n(86120);Object.defineProperty(t,"pairs",{enumerable:!0,get:function(){return $.pairs}});var ee=n(88111);Object.defineProperty(t,"partition",{enumerable:!0,get:function(){return ee.partition}});var te=n(43118);Object.defineProperty(t,"race",{enumerable:!0,get:function(){return te.race}});var ne=n(22057);Object.defineProperty(t,"range",{enumerable:!0,get:function(){return ne.range}});var re=n(49378);Object.defineProperty(t,"throwError",{enumerable:!0,get:function(){return re.throwError}});var ie=n(85708);Object.defineProperty(t,"timer",{enumerable:!0,get:function(){return ie.timer}});var oe=n(79666);Object.defineProperty(t,"using",{enumerable:!0,get:function(){return oe.using}});var ae=n(73758);Object.defineProperty(t,"zip",{enumerable:!0,get:function(){return ae.zip}});var se=n(91758);Object.defineProperty(t,"scheduled",{enumerable:!0,get:function(){return se.scheduled}});var ue=n(2577);Object.defineProperty(t,"EMPTY",{enumerable:!0,get:function(){return ue.EMPTY}});var ce=n(49510);Object.defineProperty(t,"NEVER",{enumerable:!0,get:function(){return ce.NEVER}}),i(n(39970),t);var le=n(24508);Object.defineProperty(t,"config",{enumerable:!0,get:function(){return le.config}});var de=n(53179);Object.defineProperty(t,"audit",{enumerable:!0,get:function(){return de.audit}});var fe=n(90086);Object.defineProperty(t,"auditTime",{enumerable:!0,get:function(){return fe.auditTime}});var pe=n(62934);Object.defineProperty(t,"buffer",{enumerable:!0,get:function(){return pe.buffer}});var he=n(39777);Object.defineProperty(t,"bufferCount",{enumerable:!0,get:function(){return he.bufferCount}});var ve=n(40871);Object.defineProperty(t,"bufferTime",{enumerable:!0,get:function(){return ve.bufferTime}});var me=n(95484);Object.defineProperty(t,"bufferToggle",{enumerable:!0,get:function(){return me.bufferToggle}});var ye=n(37806);Object.defineProperty(t,"bufferWhen",{enumerable:!0,get:function(){return ye.bufferWhen}});var ge=n(39557);Object.defineProperty(t,"catchError",{enumerable:!0,get:function(){return ge.catchError}});var be=n(19889);Object.defineProperty(t,"combineAll",{enumerable:!0,get:function(){return be.combineAll}});var xe=n(53082);Object.defineProperty(t,"combineLatestAll",{enumerable:!0,get:function(){return xe.combineLatestAll}});var _e=n(41115);Object.defineProperty(t,"combineLatestWith",{enumerable:!0,get:function(){return _e.combineLatestWith}});var we=n(79966);Object.defineProperty(t,"concatAll",{enumerable:!0,get:function(){return we.concatAll}});var Me=n(95458);Object.defineProperty(t,"concatMap",{enumerable:!0,get:function(){return Me.concatMap}});var Se=n(81576);Object.defineProperty(t,"concatMapTo",{enumerable:!0,get:function(){return Se.concatMapTo}});var Te=n(2787);Object.defineProperty(t,"concatWith",{enumerable:!0,get:function(){return Te.concatWith}});var Ee=n(18710);Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return Ee.connect}});var ke=n(53612);Object.defineProperty(t,"count",{enumerable:!0,get:function(){return ke.count}});var Ae=n(29646);Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return Ae.debounce}});var Pe=n(58785);Object.defineProperty(t,"debounceTime",{enumerable:!0,get:function(){return Pe.debounceTime}});var Ce=n(15660);Object.defineProperty(t,"defaultIfEmpty",{enumerable:!0,get:function(){return Ce.defaultIfEmpty}});var Oe=n(10410);Object.defineProperty(t,"delay",{enumerable:!0,get:function(){return Oe.delay}});var Ie=n(89086);Object.defineProperty(t,"delayWhen",{enumerable:!0,get:function(){return Ie.delayWhen}});var Re=n(48925);Object.defineProperty(t,"dematerialize",{enumerable:!0,get:function(){return Re.dematerialize}});var Ne=n(6897);Object.defineProperty(t,"distinct",{enumerable:!0,get:function(){return Ne.distinct}});var De=n(62951);Object.defineProperty(t,"distinctUntilChanged",{enumerable:!0,get:function(){return De.distinctUntilChanged}});var Le=n(51628);Object.defineProperty(t,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Le.distinctUntilKeyChanged}});var Be=n(68359);Object.defineProperty(t,"elementAt",{enumerable:!0,get:function(){return Be.elementAt}});var Fe=n(21423);Object.defineProperty(t,"endWith",{enumerable:!0,get:function(){return Fe.endWith}});var je=n(98543);Object.defineProperty(t,"every",{enumerable:!0,get:function(){return je.every}});var ze=n(86630);Object.defineProperty(t,"exhaust",{enumerable:!0,get:function(){return ze.exhaust}});var Ue=n(50828);Object.defineProperty(t,"exhaustAll",{enumerable:!0,get:function(){return Ue.exhaustAll}});var Ge=n(76759);Object.defineProperty(t,"exhaustMap",{enumerable:!0,get:function(){return Ge.exhaustMap}});var Ve=n(45973);Object.defineProperty(t,"expand",{enumerable:!0,get:function(){return Ve.expand}});var We=n(22884);Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return We.filter}});var He=n(90225);Object.defineProperty(t,"finalize",{enumerable:!0,get:function(){return He.finalize}});var Ze=n(62017);Object.defineProperty(t,"find",{enumerable:!0,get:function(){return Ze.find}});var qe=n(44501);Object.defineProperty(t,"findIndex",{enumerable:!0,get:function(){return qe.findIndex}});var Ye=n(44872);Object.defineProperty(t,"first",{enumerable:!0,get:function(){return Ye.first}});var Xe=n(71372);Object.defineProperty(t,"groupBy",{enumerable:!0,get:function(){return Xe.groupBy}});var Ke=n(51268);Object.defineProperty(t,"ignoreElements",{enumerable:!0,get:function(){return Ke.ignoreElements}});var Je=n(3423);Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return Je.isEmpty}});var Qe=n(41836);Object.defineProperty(t,"last",{enumerable:!0,get:function(){return Qe.last}});var $e=n(46065);Object.defineProperty(t,"map",{enumerable:!0,get:function(){return $e.map}});var et=n(65250);Object.defineProperty(t,"mapTo",{enumerable:!0,get:function(){return et.mapTo}});var tt=n(32906);Object.defineProperty(t,"materialize",{enumerable:!0,get:function(){return tt.materialize}});var nt=n(43326);Object.defineProperty(t,"max",{enumerable:!0,get:function(){return nt.max}});var rt=n(79057);Object.defineProperty(t,"mergeAll",{enumerable:!0,get:function(){return rt.mergeAll}});var it=n(26795);Object.defineProperty(t,"flatMap",{enumerable:!0,get:function(){return it.flatMap}});var ot=n(10987);Object.defineProperty(t,"mergeMap",{enumerable:!0,get:function(){return ot.mergeMap}});var at=n(75315);Object.defineProperty(t,"mergeMapTo",{enumerable:!0,get:function(){return at.mergeMapTo}});var st=n(76230);Object.defineProperty(t,"mergeScan",{enumerable:!0,get:function(){return st.mergeScan}});var ut=n(79524);Object.defineProperty(t,"mergeWith",{enumerable:!0,get:function(){return ut.mergeWith}});var ct=n(14610);Object.defineProperty(t,"min",{enumerable:!0,get:function(){return ct.min}});var lt=n(59163);Object.defineProperty(t,"multicast",{enumerable:!0,get:function(){return lt.multicast}});var dt=n(7587);Object.defineProperty(t,"observeOn",{enumerable:!0,get:function(){return dt.observeOn}});var ft=n(17778);Object.defineProperty(t,"pairwise",{enumerable:!0,get:function(){return ft.pairwise}});var pt=n(20271);Object.defineProperty(t,"pluck",{enumerable:!0,get:function(){return pt.pluck}});var ht=n(69859);Object.defineProperty(t,"publish",{enumerable:!0,get:function(){return ht.publish}});var vt=n(15535);Object.defineProperty(t,"publishBehavior",{enumerable:!0,get:function(){return vt.publishBehavior}});var mt=n(847);Object.defineProperty(t,"publishLast",{enumerable:!0,get:function(){return mt.publishLast}});var yt=n(84763);Object.defineProperty(t,"publishReplay",{enumerable:!0,get:function(){return yt.publishReplay}});var gt=n(76711);Object.defineProperty(t,"raceWith",{enumerable:!0,get:function(){return gt.raceWith}});var bt=n(59439);Object.defineProperty(t,"reduce",{enumerable:!0,get:function(){return bt.reduce}});var xt=n(25180);Object.defineProperty(t,"repeat",{enumerable:!0,get:function(){return xt.repeat}});var _t=n(38586);Object.defineProperty(t,"repeatWhen",{enumerable:!0,get:function(){return _t.repeatWhen}});var wt=n(12736);Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return wt.retry}});var Mt=n(40146);Object.defineProperty(t,"retryWhen",{enumerable:!0,get:function(){return Mt.retryWhen}});var St=n(91766);Object.defineProperty(t,"refCount",{enumerable:!0,get:function(){return St.refCount}});var Tt=n(61637);Object.defineProperty(t,"sample",{enumerable:!0,get:function(){return Tt.sample}});var Et=n(71114);Object.defineProperty(t,"sampleTime",{enumerable:!0,get:function(){return Et.sampleTime}});var kt=n(36189);Object.defineProperty(t,"scan",{enumerable:!0,get:function(){return kt.scan}});var At=n(11918);Object.defineProperty(t,"sequenceEqual",{enumerable:!0,get:function(){return At.sequenceEqual}});var Pt=n(65720);Object.defineProperty(t,"share",{enumerable:!0,get:function(){return Pt.share}});var Ct=n(3532);Object.defineProperty(t,"shareReplay",{enumerable:!0,get:function(){return Ct.shareReplay}});var Ot=n(72293);Object.defineProperty(t,"single",{enumerable:!0,get:function(){return Ot.single}});var It=n(46810);Object.defineProperty(t,"skip",{enumerable:!0,get:function(){return It.skip}});var Rt=n(49755);Object.defineProperty(t,"skipLast",{enumerable:!0,get:function(){return Rt.skipLast}});var Nt=n(55571);Object.defineProperty(t,"skipUntil",{enumerable:!0,get:function(){return Nt.skipUntil}});var Dt=n(15470);Object.defineProperty(t,"skipWhile",{enumerable:!0,get:function(){return Dt.skipWhile}});var Lt=n(84747);Object.defineProperty(t,"startWith",{enumerable:!0,get:function(){return Lt.startWith}});var Bt=n(14596);Object.defineProperty(t,"subscribeOn",{enumerable:!0,get:function(){return Bt.subscribeOn}});var Ft=n(35224);Object.defineProperty(t,"switchAll",{enumerable:!0,get:function(){return Ft.switchAll}});var jt=n(44317);Object.defineProperty(t,"switchMap",{enumerable:!0,get:function(){return jt.switchMap}});var zt=n(55334);Object.defineProperty(t,"switchMapTo",{enumerable:!0,get:function(){return zt.switchMapTo}});var Ut=n(51174);Object.defineProperty(t,"switchScan",{enumerable:!0,get:function(){return Ut.switchScan}});var Gt=n(45088);Object.defineProperty(t,"take",{enumerable:!0,get:function(){return Gt.take}});var Vt=n(33619);Object.defineProperty(t,"takeLast",{enumerable:!0,get:function(){return Vt.takeLast}});var Wt=n(58849);Object.defineProperty(t,"takeUntil",{enumerable:!0,get:function(){return Wt.takeUntil}});var Ht=n(50152);Object.defineProperty(t,"takeWhile",{enumerable:!0,get:function(){return Ht.takeWhile}});var Zt=n(69774);Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return Zt.tap}});var qt=n(23466);Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return qt.throttle}});var Yt=n(12083);Object.defineProperty(t,"throttleTime",{enumerable:!0,get:function(){return Yt.throttleTime}});var Xt=n(15066);Object.defineProperty(t,"throwIfEmpty",{enumerable:!0,get:function(){return Xt.throwIfEmpty}});var Kt=n(10493);Object.defineProperty(t,"timeInterval",{enumerable:!0,get:function(){return Kt.timeInterval}});var Jt=n(73687);Object.defineProperty(t,"timeout",{enumerable:!0,get:function(){return Jt.timeout}});var Qt=n(18711);Object.defineProperty(t,"timeoutWith",{enumerable:!0,get:function(){return Qt.timeoutWith}});var $t=n(47716);Object.defineProperty(t,"timestamp",{enumerable:!0,get:function(){return $t.timestamp}});var en=n(24090);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return en.toArray}});var tn=n(74080);Object.defineProperty(t,"window",{enumerable:!0,get:function(){return tn.window}});var nn=n(16298);Object.defineProperty(t,"windowCount",{enumerable:!0,get:function(){return nn.windowCount}});var rn=n(34418);Object.defineProperty(t,"windowTime",{enumerable:!0,get:function(){return rn.windowTime}});var on=n(85489);Object.defineProperty(t,"windowToggle",{enumerable:!0,get:function(){return on.windowToggle}});var an=n(86003);Object.defineProperty(t,"windowWhen",{enumerable:!0,get:function(){return an.windowWhen}});var sn=n(39167);Object.defineProperty(t,"withLatestFrom",{enumerable:!0,get:function(){return sn.withLatestFrom}});var un=n(64325);Object.defineProperty(t,"zipAll",{enumerable:!0,get:function(){return un.zipAll}});var cn=n(26397);Object.defineProperty(t,"zipWith",{enumerable:!0,get:function(){return cn.zipWith}})},33867:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncSubject=void 0;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}return i(t,e),t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t._hasValue,i=t._value,o=t.thrownError,a=t.isStopped,s=t._isComplete;n?e.error(o):(a||s)&&(r&&e.next(i),e.complete())},t.prototype.next=function(e){this.isStopped||(this._value=e,this._hasValue=!0)},t.prototype.complete=function(){var t=this,n=t._hasValue,r=t._value;t._isComplete||(this._isComplete=!0,n&&e.prototype.next.call(this,r),e.prototype.complete.call(this))},t}(n(15094).Subject);t.AsyncSubject=o},99800:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BehaviorSubject=void 0;var o=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return i(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(n(15094).Subject);t.BehaviorSubject=o},2930:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observeNotification=t.Notification=t.NotificationKind=void 0;var r,i=n(2577),o=n(63674),a=n(49378),s=n(3749);(r=t.NotificationKind||(t.NotificationKind={})).NEXT="N",r.ERROR="E",r.COMPLETE="C";var u=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){return c(this,e)},e.prototype.do=function(e,t,n){var r=this,i=r.kind,o=r.value,a=r.error;return"N"===i?null==e?void 0:e(o):"E"===i?null==t?void 0:t(a):null==n?void 0:n()},e.prototype.accept=function(e,t,n){var r;return s.isFunction(null===(r=e)||void 0===r?void 0:r.next)?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e=this,t=e.kind,n=e.value,r=e.error,s="N"===t?o.of(n):"E"===t?a.throwError((function(){return r})):"C"===t?i.EMPTY:0;if(!s)throw new TypeError("Unexpected notification kind "+t);return s},e.createNext=function(t){return new e("N",t)},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e}();function c(e,t){var n,r,i,o=e,a=o.kind,s=o.value,u=o.error;if("string"!=typeof a)throw new TypeError('Invalid notification, missing "kind"');"N"===a?null===(n=t.next)||void 0===n||n.call(t,s):"E"===a?null===(r=t.error)||void 0===r||r.call(t,u):null===(i=t.complete)||void 0===i||i.call(t)}t.Notification=u,t.observeNotification=c},3135:function(e,t){"use strict";function n(e,t,n){return{kind:e,value:t,error:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.createNotification=t.nextNotification=t.errorNotification=t.COMPLETE_NOTIFICATION=void 0,t.COMPLETE_NOTIFICATION=n("C",void 0,void 0),t.errorNotification=function(e){return n("E",void 0,e)},t.nextNotification=function(e){return n("N",e,void 0)},t.createNotification=n},29299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var r=n(64767),i=n(50979),o=n(69981),a=n(49200),s=n(24508),u=n(3749),c=n(70936),l=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o,a=this,s=(o=e)&&o instanceof r.Subscriber||function(e){return e&&u.isFunction(e.next)&&u.isFunction(e.error)&&u.isFunction(e.complete)}(o)&&i.isSubscription(o)?e:new r.SafeSubscriber(e,t,n);return c.errorContext((function(){var e=a,t=e.operator,n=e.source;s.add(t?t.call(s,n):n?a._subscribe(s):a._trySubscribe(s))})),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=d(t))((function(t,i){var o=new r.SafeSubscriber({next:function(t){try{e(t)}catch(e){i(e),o.unsubscribe()}},error:i,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[o.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function d(e){var t;return null!==(t=null!=e?e:s.config.Promise)&&void 0!==t?t:Promise}t.Observable=l},58113:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ReplaySubject=void 0;var o=n(15094),a=n(4614),s=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=a.dateTimestampProvider);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return i(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,a=n._timestampProvider,s=n._windowTime;r||(i.push(t),!o&&i.push(a.now()+s)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var a=n.now(),s=0,u=1;u<r.length&&r[u]<=a;u+=2)s=u;s&&r.splice(0,s+1)}},t}(o.Subject);t.ReplaySubject=s},27619:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scheduler=void 0;var r=n(4614),i=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=r.dateTimestampProvider.now,e}();t.Scheduler=i},15094:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.AnonymousSubject=t.Subject=void 0;var a=n(29299),s=n(50979),u=n(53971),c=n(86908),l=n(70936),d=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return i(t,e),t.prototype.lift=function(e){var t=new f(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new u.ObjectUnsubscribedError},t.prototype.next=function(e){var t=this;l.errorContext((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=o(t.currentObservers),a=i.next();!a.done;a=i.next())a.value.next(e)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;l.errorContext((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;l.errorContext((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?s.EMPTY_SUBSCRIPTION:(this.currentObservers=null,o.push(e),new s.Subscription((function(){t.currentObservers=null,c.arrRemove(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new a.Observable;return e.source=this,e},t.create=function(e,t){return new f(e,t)},t}(a.Observable);t.Subject=d;var f=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return i(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:s.EMPTY_SUBSCRIPTION},t}(d);t.AnonymousSubject=f},64767:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_OBSERVER=t.SafeSubscriber=t.Subscriber=void 0;var o=n(3749),a=n(50979),s=n(24508),u=n(4387),c=n(83197),l=n(3135),d=n(4117),f=n(70936),p=function(e){function n(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,a.isSubscription(n)&&n.add(r)):r.destination=t.EMPTY_OBSERVER,r}return i(n,e),n.create=function(e,t,n){return new y(e,t,n)},n.prototype.next=function(e){this.isStopped?b(l.nextNotification(e),this):this._next(e)},n.prototype.error=function(e){this.isStopped?b(l.errorNotification(e),this):(this.isStopped=!0,this._error(e))},n.prototype.complete=function(){this.isStopped?b(l.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},n.prototype._next=function(e){this.destination.next(e)},n.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},n.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},n}(a.Subscription);t.Subscriber=p;var h=Function.prototype.bind;function v(e,t){return h.call(e,t)}var m=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){g(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){g(e)}else g(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){g(e)}},e}(),y=function(e){function t(t,n,r){var i,a,u=e.call(this)||this;return o.isFunction(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&s.config.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},i={next:t.next&&v(t.next,a),error:t.error&&v(t.error,a),complete:t.complete&&v(t.complete,a)}):i=t,u.destination=new m(i),u}return i(t,e),t}(p);function g(e){s.config.useDeprecatedSynchronousErrorHandling?f.captureError(e):u.reportUnhandledError(e)}function b(e,t){var n=s.config.onStoppedNotification;n&&d.timeoutProvider.setTimeout((function(){return n(e,t)}))}t.SafeSubscriber=y,t.EMPTY_OBSERVER={closed:!0,next:c.noop,error:function(e){throw e},complete:c.noop}},50979:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.isSubscription=t.EMPTY_SUBSCRIPTION=t.Subscription=void 0;var a=n(3749),s=n(17750),u=n(86908),c=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,u,c;if(!this.closed){this.closed=!0;var d=this._parentage;if(d)if(this._parentage=null,Array.isArray(d))try{for(var f=r(d),p=f.next();!p.done;p=f.next())p.value.remove(this)}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=f.return)&&t.call(f)}finally{if(e)throw e.error}}else d.remove(this);var h=this.initialTeardown;if(a.isFunction(h))try{h()}catch(e){c=e instanceof s.UnsubscriptionError?e.errors:[e]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var m=r(v),y=m.next();!y.done;y=m.next()){var g=y.value;try{l(g)}catch(e){c=null!=c?c:[],e instanceof s.UnsubscriptionError?c=o(o([],i(c)),i(e.errors)):c.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(u=m.return)&&u.call(m)}finally{if(n)throw n.error}}}if(c)throw new s.UnsubscriptionError(c)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&u.arrRemove(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&u.arrRemove(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function l(e){a.isFunction(e)?e():e.unsubscribe()}t.Subscription=c,t.EMPTY_SUBSCRIPTION=c.EMPTY,t.isSubscription=function(e){return e instanceof c||e&&"closed"in e&&a.isFunction(e.remove)&&a.isFunction(e.add)&&a.isFunction(e.unsubscribe)}},24508:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0,t.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},78510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firstValueFrom=void 0;var r=n(75261),i=n(64767);t.firstValueFrom=function(e,t){var n="object"==typeof t;return new Promise((function(o,a){var s=new i.SafeSubscriber({next:function(e){o(e),s.unsubscribe()},error:a,complete:function(){n?o(t.defaultValue):a(new r.EmptyError)}});e.subscribe(s)}))}},96588:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lastValueFrom=void 0;var r=n(75261);t.lastValueFrom=function(e,t){var n="object"==typeof t;return new Promise((function(i,o){var a,s=!1;e.subscribe({next:function(e){a=e,s=!0},error:o,complete:function(){s?i(a):n?i(t.defaultValue):o(new r.EmptyError)}})}))}},11107:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectableObservable=void 0;var o=n(29299),a=n(50979),s=n(91766),u=n(23086),c=n(55031),l=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._subject=null,r._refCount=0,r._connection=null,c.hasLift(t)&&(r.lift=t.lift),r}return i(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype._teardown=function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()},t.prototype.connect=function(){var e=this,t=this._connection;if(!t){t=this._connection=new a.Subscription;var n=this.getSubject();t.add(this.source.subscribe(u.createOperatorSubscriber(n,void 0,(function(){e._teardown(),n.complete()}),(function(t){e._teardown(),n.error(t)}),(function(){return e._teardown()})))),t.closed&&(this._connection=null,t=a.Subscription.EMPTY)}return t},t.prototype.refCount=function(){return s.refCount()(this)},t}(o.Observable);t.ConnectableObservable=l},91506:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindCallback=void 0;var r=n(86568);t.bindCallback=function(e,t,n){return r.bindCallbackInternals(!1,e,t,n)}},86568:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.bindCallbackInternals=void 0;var o=n(45767),a=n(29299),s=n(14596),u=n(74718),c=n(7587),l=n(33867);t.bindCallbackInternals=function e(t,n,d,f){if(d){if(!o.isScheduler(d))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e(t,n,f).apply(this,r).pipe(u.mapOneOrManyArgs(d))};f=d}return f?function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e(t,n).apply(this,r).pipe(s.subscribeOn(f),c.observeOn(f))}:function(){for(var e=this,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var u=new l.AsyncSubject,c=!0;return new a.Observable((function(a){var s=u.subscribe(a);if(c){c=!1;var l=!1,d=!1;n.apply(e,i(i([],r(o)),[function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t){var r=e.shift();if(null!=r)return void u.error(r)}u.next(1<e.length?e:e[0]),d=!0,l&&u.complete()}])),d&&u.complete(),l=!0}return s}))}}},732:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindNodeCallback=void 0;var r=n(86568);t.bindNodeCallback=function(e,t,n){return r.bindCallbackInternals(!0,e,t,n)}},80680:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatestInit=t.combineLatest=void 0;var r=n(29299),i=n(21224),o=n(14773),a=n(18055),s=n(74718),u=n(3194),c=n(76991),l=n(23086),d=n(45007);function f(e,t,n){return void 0===n&&(n=a.identity),function(r){p(t,(function(){for(var i=e.length,a=new Array(i),s=i,u=i,c=function(i){p(t,(function(){var c=o.from(e[i],t),d=!1;c.subscribe(l.createOperatorSubscriber(r,(function(e){a[i]=e,d||(d=!0,u--),u||r.next(n(a.slice()))}),(function(){--s||r.complete()})))}),r)},d=0;d<i;d++)c(d)}),r)}}function p(e,t,n){e?d.executeSchedule(n,e,t):t()}t.combineLatest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=u.popScheduler(e),l=u.popResultSelector(e),d=i.argsArgArrayOrObject(e),p=d.args,h=d.keys;if(0===p.length)return o.from([],n);var v=new r.Observable(f(p,n,h?function(e){return c.createObject(h,e)}:a.identity));return l?v.pipe(s.mapOneOrManyArgs(l)):v},t.combineLatestInit=f},6628:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=void 0;var r=n(79966),i=n(3194),o=n(14773);t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.concatAll()(o.from(e,i.popScheduler(e)))}},6649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connectable=void 0;var r=n(15094),i=n(29299),o=n(7906),a={connector:function(){return new r.Subject},resetOnDisconnect:!0};t.connectable=function(e,t){void 0===t&&(t=a);var n=null,r=t.connector,s=t.resetOnDisconnect,u=void 0===s||s,c=r(),l=new i.Observable((function(e){return c.subscribe(e)}));return l.connect=function(){return n&&!n.closed||(n=o.defer((function(){return e})).subscribe(c),u&&n.add((function(){return c=r()}))),n},l}},7906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defer=void 0;var r=n(29299),i=n(88928);t.defer=function(e){return new r.Observable((function(t){i.innerFrom(e()).subscribe(t)}))}},84813:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationFrames=void 0;var r=n(29299),i=n(50979),o=n(47318),a=n(85160);function s(e){var t=a.animationFrameProvider.schedule;return new r.Observable((function(n){var r=new i.Subscription,a=e||o.performanceTimestampProvider,s=a.now();return r.add(t((function i(o){var u=a.now();n.next({timestamp:e?u:o,elapsed:u-s}),n.closed||r.add(t(i))}))),r}))}t.animationFrames=function(e){return e?s(e):u};var u=s()},2577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.empty=t.EMPTY=void 0;var r=n(29299);t.EMPTY=new r.Observable((function(e){return e.complete()})),t.empty=function(e){return e?function(e){return new r.Observable((function(t){return e.schedule((function(){return t.complete()}))}))}(e):t.EMPTY}},7354:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkJoin=void 0;var r=n(29299),i=n(21224),o=n(88928),a=n(3194),s=n(23086),u=n(74718),c=n(76991);t.forkJoin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=a.popResultSelector(e),l=i.argsArgArrayOrObject(e),d=l.args,f=l.keys,p=new r.Observable((function(e){var t=d.length;if(t)for(var n=new Array(t),r=t,i=t,a=function(t){var a=!1;o.innerFrom(d[t]).subscribe(s.createOperatorSubscriber(e,(function(e){a||(a=!0,i--),n[t]=e}),(function(){return r--}),void 0,(function(){r&&a||(i||e.next(f?c.createObject(f,n):n),e.complete())})))},u=0;u<t;u++)a(u);else e.complete()}));return n?p.pipe(u.mapOneOrManyArgs(n)):p}},14773:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.from=void 0;var r=n(91758),i=n(88928);t.from=function(e,t){return t?r.scheduled(e,t):i.innerFrom(e)}},1969:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.fromEvent=void 0;var i=n(88928),o=n(29299),a=n(10987),s=n(67815),u=n(3749),c=n(74718),l=["addListener","removeListener"],d=["addEventListener","removeEventListener"],f=["on","off"];function p(e,t){return function(n){return function(r){return e[n](t,r)}}}t.fromEvent=function e(t,n,h,v){if(u.isFunction(h)&&(v=h,h=void 0),v)return e(t,n,h).pipe(c.mapOneOrManyArgs(v));var m=r(function(e){return u.isFunction(e.addEventListener)&&u.isFunction(e.removeEventListener)}(t)?d.map((function(e){return function(r){return t[e](n,r,h)}})):function(e){return u.isFunction(e.addListener)&&u.isFunction(e.removeListener)}(t)?l.map(p(t,n)):function(e){return u.isFunction(e.on)&&u.isFunction(e.off)}(t)?f.map(p(t,n)):[],2),y=m[0],g=m[1];if(!y&&s.isArrayLike(t))return a.mergeMap((function(t){return e(t,n,h)}))(i.innerFrom(t));if(!y)throw new TypeError("Invalid event target");return new o.Observable((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return y(t),function(){return g(t)}}))}},4971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromEventPattern=void 0;var r=n(29299),i=n(3749),o=n(74718);t.fromEventPattern=function e(t,n,a){return a?e(t,n).pipe(o.mapOneOrManyArgs(a)):new r.Observable((function(e){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1===t.length?t[0]:t)},o=t(r);return i.isFunction(n)?function(){return n(r,o)}:void 0}))}},3134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromSubscribable=void 0;var r=n(29299);t.fromSubscribable=function(e){return new r.Observable((function(t){return e.subscribe(t)}))}},67154:function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generate=void 0;var i=n(18055),o=n(45767),a=n(7906),s=n(15394);t.generate=function(e,t,n,u,c){var l,d,f,p;function h(){var e;return r(this,(function(r){switch(r.label){case 0:e=p,r.label=1;case 1:return t&&!t(e)?[3,4]:[4,f(e)];case 2:r.sent(),r.label=3;case 3:return e=n(e),[3,1];case 4:return[2]}}))}return 1===arguments.length?(p=(l=e).initialState,t=l.condition,n=l.iterate,d=l.resultSelector,f=void 0===d?i.identity:d,c=l.scheduler):(p=e,!u||o.isScheduler(u)?(f=i.identity,c=u):f=u),a.defer(c?function(){return s.scheduleIterable(h(),c)}:h)}},51991:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iif=void 0;var r=n(7906);t.iif=function(e,t,n){return r.defer((function(){return e()?t:n}))}},88928:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof a?a(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.fromReadableStreamLike=t.fromAsyncIterable=t.fromIterable=t.fromPromise=t.fromArrayLike=t.fromInteropObservable=t.innerFrom=void 0;var s=n(67815),u=n(3242),c=n(29299),l=n(87891),d=n(64016),f=n(42821),p=n(89401),h=n(88920),v=n(3749),m=n(4387),y=n(69981);function g(e){return new c.Observable((function(t){var n=e[y.observable]();if(v.isFunction(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}function b(e){return new c.Observable((function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()}))}function x(e){return new c.Observable((function(t){e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,m.reportUnhandledError)}))}function _(e){return new c.Observable((function(t){var n,r;try{for(var i=a(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()}))}function w(e){return new c.Observable((function(t){(function(e,t){var n,a,s,u;return r(this,void 0,void 0,(function(){var r,c;return i(this,(function(i){switch(i.label){case 0:i.trys.push([0,5,6,11]),n=o(e),i.label=1;case 1:return[4,n.next()];case 2:if((a=i.sent()).done)return[3,4];if(r=a.value,t.next(r),t.closed)return[2];i.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=i.sent(),s={error:c},[3,11];case 6:return i.trys.push([6,,9,10]),a&&!a.done&&(u=n.return)?[4,u.call(n)]:[3,8];case 7:i.sent(),i.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function M(e){return w(h.readableStreamLikeToAsyncGenerator(e))}t.innerFrom=function(e){if(e instanceof c.Observable)return e;if(null!=e){if(l.isInteropObservable(e))return g(e);if(s.isArrayLike(e))return b(e);if(u.isPromise(e))return x(e);if(d.isAsyncIterable(e))return w(e);if(p.isIterable(e))return _(e);if(h.isReadableStreamLike(e))return M(e)}throw f.createInvalidObservableTypeError(e)},t.fromInteropObservable=g,t.fromArrayLike=b,t.fromPromise=x,t.fromIterable=_,t.fromAsyncIterable=w,t.fromReadableStreamLike=M},63363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interval=void 0;var r=n(71805),i=n(85708);t.interval=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=r.asyncScheduler),e<0&&(e=0),i.timer(e,e,t)}},93062:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.merge=void 0;var r=n(79057),i=n(88928),o=n(2577),a=n(3194),s=n(14773);t.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=a.popScheduler(e),u=a.popNumber(e,1/0),c=e;return c.length?1===c.length?i.innerFrom(c[0]):r.mergeAll(u)(s.from(c,n)):o.EMPTY}},49510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.never=t.NEVER=void 0;var r=n(29299),i=n(83197);t.NEVER=new r.Observable(i.noop),t.never=function(){return t.NEVER}},63674:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.of=void 0;var r=n(3194),i=n(14773);t.of=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.popScheduler(e);return i.from(e,n)}},41131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onErrorResumeNext=void 0;var r=n(2577),i=n(67962),o=n(44285);t.onErrorResumeNext=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.onErrorResumeNext(o.argsOrArgArray(e))(r.EMPTY)}},86120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pairs=void 0;var r=n(14773);t.pairs=function(e,t){return r.from(Object.entries(e),t)}},88111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.partition=void 0;var r=n(16090),i=n(22884),o=n(88928);t.partition=function(e,t,n){return[i.filter(t,n)(o.innerFrom(e)),i.filter(r.not(t,n))(o.innerFrom(e))]}},43118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.raceInit=t.race=void 0;var r=n(29299),i=n(88928),o=n(44285),a=n(23086);function s(e){return function(t){for(var n=[],r=function(r){n.push(i.innerFrom(e[r]).subscribe(a.createOperatorSubscriber(t,(function(e){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}t.next(e)}))))},o=0;n&&!t.closed&&o<e.length;o++)r(o)}}t.race=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===(e=o.argsOrArgArray(e)).length?i.innerFrom(e[0]):new r.Observable(s(e))},t.raceInit=s},22057:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.range=void 0;var r=n(29299),i=n(2577);t.range=function(e,t,n){if(null==t&&(t=e,e=0),t<=0)return i.EMPTY;var o=t+e;return new r.Observable(n?function(t){var r=e;return n.schedule((function(){r<o?(t.next(r++),this.schedule()):t.complete()}))}:function(t){for(var n=e;n<o&&!t.closed;)t.next(n++);t.complete()})}},49378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwError=void 0;var r=n(29299),i=n(3749);t.throwError=function(e,t){var n=i.isFunction(e)?e:function(){return e},o=function(e){return e.error(n())};return new r.Observable(t?function(e){return t.schedule(o,0,e)}:o)}},85708:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timer=void 0;var r=n(29299),i=n(71805),o=n(45767),a=n(13785);t.timer=function(e,t,n){void 0===e&&(e=0),void 0===n&&(n=i.async);var s=-1;return null!=t&&(o.isScheduler(t)?n=t:s=t),new r.Observable((function(t){var r=a.isValidDate(e)?+e-n.now():e;r<0&&(r=0);var i=0;return n.schedule((function(){t.closed||(t.next(i++),0<=s?this.schedule(void 0,s):t.complete())}),r)}))}},79666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.using=void 0;var r=n(29299),i=n(88928),o=n(2577);t.using=function(e,t){return new r.Observable((function(n){var r=e(),a=t(r);return(a?i.innerFrom(a):o.EMPTY).subscribe(n),function(){r&&r.unsubscribe()}}))}},73758:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.zip=void 0;var o=n(29299),a=n(88928),s=n(44285),u=n(2577),c=n(23086),l=n(3194);t.zip=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=l.popResultSelector(e),d=s.argsOrArgArray(e);return d.length?new o.Observable((function(e){var t=d.map((function(){return[]})),o=d.map((function(){return!1}));e.add((function(){t=o=null}));for(var s=function(s){a.innerFrom(d[s]).subscribe(c.createOperatorSubscriber(e,(function(a){if(t[s].push(a),t.every((function(e){return e.length}))){var u=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,i([],r(u))):u),t.some((function(e,t){return!e.length&&o[t]}))&&e.complete()}}),(function(){o[s]=!0,!t[s].length&&e.complete()})))},u=0;!e.closed&&u<d.length;u++)s(u);return function(){t=o=null}})):u.EMPTY}},23086:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorSubscriber=t.createOperatorSubscriber=void 0;var o=n(64767);t.createOperatorSubscriber=function(e,t,n,r,i){return new a(e,t,n,r,i)};var a=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=a,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return i(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(o.Subscriber);t.OperatorSubscriber=a},53179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.audit=void 0;var r=n(55031),i=n(88928),o=n(23086);t.audit=function(e){return r.operate((function(t,n){var r=!1,a=null,s=null,u=!1,c=function(){if(null==s||s.unsubscribe(),s=null,r){r=!1;var e=a;a=null,n.next(e)}u&&n.complete()},l=function(){s=null,u&&n.complete()};t.subscribe(o.createOperatorSubscriber(n,(function(t){r=!0,a=t,s||i.innerFrom(e(t)).subscribe(s=o.createOperatorSubscriber(n,c,l))}),(function(){u=!0,(!r||!s||s.closed)&&n.complete()})))}))}},90086:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.auditTime=void 0;var r=n(71805),i=n(53179),o=n(85708);t.auditTime=function(e,t){return void 0===t&&(t=r.asyncScheduler),i.audit((function(){return o.timer(e,t)}))}},62934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buffer=void 0;var r=n(55031),i=n(83197),o=n(23086);t.buffer=function(e){return r.operate((function(t,n){var r=[];return t.subscribe(o.createOperatorSubscriber(n,(function(e){return r.push(e)}),(function(){n.next(r),n.complete()}))),e.subscribe(o.createOperatorSubscriber(n,(function(){var e=r;r=[],n.next(e)}),i.noop)),function(){r=null}}))}},39777:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferCount=void 0;var i=n(55031),o=n(23086),a=n(86908);t.bufferCount=function(e,t){return void 0===t&&(t=null),t=null!=t?t:e,i.operate((function(n,i){var s=[],u=0;n.subscribe(o.createOperatorSubscriber(i,(function(n){var o,c,l,d,f=null;u++%t==0&&s.push([]);try{for(var p=r(s),h=p.next();!h.done;h=p.next())(y=h.value).push(n),e<=y.length&&(f=null!=f?f:[]).push(y)}catch(e){o={error:e}}finally{try{h&&!h.done&&(c=p.return)&&c.call(p)}finally{if(o)throw o.error}}if(f)try{for(var v=r(f),m=v.next();!m.done;m=v.next()){var y=m.value;a.arrRemove(s,y),i.next(y)}}catch(e){l={error:e}}finally{try{m&&!m.done&&(d=v.return)&&d.call(v)}finally{if(l)throw l.error}}}),(function(){var e,t;try{for(var n=r(s),o=n.next();!o.done;o=n.next()){var a=o.value;i.next(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}i.complete()}),void 0,(function(){s=null})))}))}},40871:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferTime=void 0;var i=n(50979),o=n(55031),a=n(23086),s=n(86908),u=n(71805),c=n(3194),l=n(45007);t.bufferTime=function(e){for(var t,n,d=[],f=1;f<arguments.length;f++)d[f-1]=arguments[f];var p=null!==(t=c.popScheduler(d))&&void 0!==t?t:u.asyncScheduler,h=null!==(n=d[0])&&void 0!==n?n:null,v=d[1]||1/0;return o.operate((function(t,n){var o=[],u=!1,c=function(e){var t=e.buffer;e.subs.unsubscribe(),s.arrRemove(o,e),n.next(t),u&&d()},d=function(){if(o){var t=new i.Subscription;n.add(t);var r={buffer:[],subs:t};o.push(r),l.executeSchedule(t,p,(function(){return c(r)}),e)}};null!==h&&h>=0?l.executeSchedule(n,p,d,h,!0):u=!0,d();var f=a.createOperatorSubscriber(n,(function(e){var t,n,i=o.slice();try{for(var a=r(i),s=a.next();!s.done;s=a.next()){var u=s.value,l=u.buffer;l.push(e),v<=l.length&&c(u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}),(function(){for(;null==o?void 0:o.length;)n.next(o.shift().buffer);null==f||f.unsubscribe(),n.complete(),n.unsubscribe()}),void 0,(function(){return o=null}));t.subscribe(f)}))}},95484:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferToggle=void 0;var i=n(50979),o=n(55031),a=n(88928),s=n(23086),u=n(83197),c=n(86908);t.bufferToggle=function(e,t){return o.operate((function(n,o){var l=[];a.innerFrom(e).subscribe(s.createOperatorSubscriber(o,(function(e){var n=[];l.push(n);var r=new i.Subscription;r.add(a.innerFrom(t(e)).subscribe(s.createOperatorSubscriber(o,(function(){c.arrRemove(l,n),o.next(n),r.unsubscribe()}),u.noop)))}),u.noop)),n.subscribe(s.createOperatorSubscriber(o,(function(e){var t,n;try{for(var i=r(l),o=i.next();!o.done;o=i.next())o.value.push(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}),(function(){for(;l.length>0;)o.next(l.shift());o.complete()})))}))}},37806:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bufferWhen=void 0;var r=n(55031),i=n(83197),o=n(23086),a=n(88928);t.bufferWhen=function(e){return r.operate((function(t,n){var r=null,s=null;!function t(){null==s||s.unsubscribe();var u=r;r=[],u&&n.next(u),a.innerFrom(e()).subscribe(s=o.createOperatorSubscriber(n,t,i.noop))}(),t.subscribe(o.createOperatorSubscriber(n,(function(e){return null==r?void 0:r.push(e)}),(function(){r&&n.next(r),n.complete()}),void 0,(function(){return r=s=null})))}))}},39557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.catchError=void 0;var r=n(88928),i=n(23086),o=n(55031);t.catchError=function e(t){return o.operate((function(n,o){var a,s=null,u=!1;s=n.subscribe(i.createOperatorSubscriber(o,void 0,void 0,(function(i){a=r.innerFrom(t(i,e(t)(n))),s?(s.unsubscribe(),s=null,a.subscribe(o)):u=!0}))),u&&(s.unsubscribe(),s=null,a.subscribe(o))}))}},19889:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineAll=void 0;var r=n(53082);t.combineAll=r.combineLatestAll},960:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatest=void 0;var o=n(80680),a=n(55031),s=n(44285),u=n(74718),c=n(49200),l=n(3194);t.combineLatest=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var d=l.popResultSelector(t);return d?c.pipe(e.apply(void 0,i([],r(t))),u.mapOneOrManyArgs(d)):a.operate((function(e,n){o.combineLatestInit(i([e],r(s.argsOrArgArray(t))))(n)}))}},53082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatestAll=void 0;var r=n(80680),i=n(79283);t.combineLatestAll=function(e){return i.joinAllInternals(r.combineLatest,e)}},41115:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatestWith=void 0;var o=n(960);t.combineLatestWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.combineLatest.apply(void 0,i([],r(e)))}},45317:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.concat=void 0;var o=n(55031),a=n(79966),s=n(3194),u=n(14773);t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s.popScheduler(e);return o.operate((function(t,o){a.concatAll()(u.from(i([t],r(e)),n)).subscribe(o)}))}},79966:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatAll=void 0;var r=n(79057);t.concatAll=function(){return r.mergeAll(1)}},95458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatMap=void 0;var r=n(10987),i=n(3749);t.concatMap=function(e,t){return i.isFunction(t)?r.mergeMap(e,t,1):r.mergeMap(e,1)}},81576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatMapTo=void 0;var r=n(95458),i=n(3749);t.concatMapTo=function(e,t){return i.isFunction(t)?r.concatMap((function(){return e}),t):r.concatMap((function(){return e}))}},2787:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.concatWith=void 0;var o=n(45317);t.concatWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.concat.apply(void 0,i([],r(e)))}},18710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0;var r=n(15094),i=n(14773),o=n(55031),a=n(3134),s={connector:function(){return new r.Subject}};t.connect=function(e,t){void 0===t&&(t=s);var n=t.connector;return o.operate((function(t,r){var o=n();i.from(e(a.fromSubscribable(o))).subscribe(r),r.add(t.subscribe(o))}))}},53612:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.count=void 0;var r=n(59439);t.count=function(e){return r.reduce((function(t,n,r){return!e||e(n,r)?t+1:t}),0)}},29646:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=void 0;var r=n(55031),i=n(83197),o=n(23086),a=n(88928);t.debounce=function(e){return r.operate((function(t,n){var r=!1,s=null,u=null,c=function(){if(null==u||u.unsubscribe(),u=null,r){r=!1;var e=s;s=null,n.next(e)}};t.subscribe(o.createOperatorSubscriber(n,(function(t){null==u||u.unsubscribe(),r=!0,s=t,u=o.createOperatorSubscriber(n,c,i.noop),a.innerFrom(e(t)).subscribe(u)}),(function(){c(),n.complete()}),void 0,(function(){s=u=null})))}))}},58785:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounceTime=void 0;var r=n(71805),i=n(55031),o=n(23086);t.debounceTime=function(e,t){return void 0===t&&(t=r.asyncScheduler),i.operate((function(n,r){var i=null,a=null,s=null,u=function(){if(i){i.unsubscribe(),i=null;var e=a;a=null,r.next(e)}};function c(){var n=s+e,o=t.now();if(o<n)return i=this.schedule(void 0,n-o),void r.add(i);u()}n.subscribe(o.createOperatorSubscriber(r,(function(n){a=n,s=t.now(),i||(i=t.schedule(c,e),r.add(i))}),(function(){u(),r.complete()}),void 0,(function(){a=i=null})))}))}},15660:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIfEmpty=void 0;var r=n(55031),i=n(23086);t.defaultIfEmpty=function(e){return r.operate((function(t,n){var r=!1;t.subscribe(i.createOperatorSubscriber(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}},10410:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0;var r=n(71805),i=n(89086),o=n(85708);t.delay=function(e,t){void 0===t&&(t=r.asyncScheduler);var n=o.timer(e,t);return i.delayWhen((function(){return n}))}},89086:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayWhen=void 0;var r=n(6628),i=n(45088),o=n(51268),a=n(65250),s=n(10987);t.delayWhen=function e(t,n){return n?function(a){return r.concat(n.pipe(i.take(1),o.ignoreElements()),a.pipe(e(t)))}:s.mergeMap((function(e,n){return t(e,n).pipe(i.take(1),a.mapTo(e))}))}},48925:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dematerialize=void 0;var r=n(2930),i=n(55031),o=n(23086);t.dematerialize=function(){return i.operate((function(e,t){e.subscribe(o.createOperatorSubscriber(t,(function(e){return r.observeNotification(e,t)})))}))}},6897:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinct=void 0;var r=n(55031),i=n(23086),o=n(83197);t.distinct=function(e,t){return r.operate((function(n,r){var a=new Set;n.subscribe(i.createOperatorSubscriber(r,(function(t){var n=e?e(t):t;a.has(n)||(a.add(n),r.next(t))}))),null==t||t.subscribe(i.createOperatorSubscriber(r,(function(){return a.clear()}),o.noop))}))}},62951:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinctUntilChanged=void 0;var r=n(18055),i=n(55031),o=n(23086);function a(e,t){return e===t}t.distinctUntilChanged=function(e,t){return void 0===t&&(t=r.identity),e=null!=e?e:a,i.operate((function(n,r){var i,a=!0;n.subscribe(o.createOperatorSubscriber(r,(function(n){var o=t(n);!a&&e(i,o)||(a=!1,i=o,r.next(n))})))}))}},51628:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinctUntilKeyChanged=void 0;var r=n(62951);t.distinctUntilKeyChanged=function(e,t){return r.distinctUntilChanged((function(n,r){return t?t(n[e],r[e]):n[e]===r[e]}))}},68359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementAt=void 0;var r=n(2886),i=n(22884),o=n(15066),a=n(15660),s=n(45088);t.elementAt=function(e,t){if(e<0)throw new r.ArgumentOutOfRangeError;var n=arguments.length>=2;return function(u){return u.pipe(i.filter((function(t,n){return n===e})),s.take(1),n?a.defaultIfEmpty(t):o.throwIfEmpty((function(){return new r.ArgumentOutOfRangeError})))}}},21423:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.endWith=void 0;var o=n(6628),a=n(63674);t.endWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return o.concat(t,a.of.apply(void 0,i([],r(e))))}}},98543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.every=void 0;var r=n(55031),i=n(23086);t.every=function(e,t){return r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(i){e.call(t,i,o++,n)||(r.next(!1),r.complete())}),(function(){r.next(!0),r.complete()})))}))}},86630:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exhaust=void 0;var r=n(50828);t.exhaust=r.exhaustAll},50828:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exhaustAll=void 0;var r=n(55031),i=n(88928),o=n(23086);t.exhaustAll=function(){return r.operate((function(e,t){var n=!1,r=null;e.subscribe(o.createOperatorSubscriber(t,(function(e){r||(r=i.innerFrom(e).subscribe(o.createOperatorSubscriber(t,void 0,(function(){r=null,n&&t.complete()}))))}),(function(){n=!0,!r&&t.complete()})))}))}},76759:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exhaustMap=void 0;var r=n(46065),i=n(88928),o=n(55031),a=n(23086);t.exhaustMap=function e(t,n){return n?function(o){return o.pipe(e((function(e,o){return i.innerFrom(t(e,o)).pipe(r.map((function(t,r){return n(e,t,o,r)})))})))}:o.operate((function(e,n){var r=0,o=null,s=!1;e.subscribe(a.createOperatorSubscriber(n,(function(e){o||(o=a.createOperatorSubscriber(n,void 0,(function(){o=null,s&&n.complete()})),i.innerFrom(t(e,r++)).subscribe(o))}),(function(){s=!0,!o&&n.complete()})))}))}},45973:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expand=void 0;var r=n(55031),i=n(18757);t.expand=function(e,t,n){return void 0===t&&(t=1/0),t=(t||0)<1?1/0:t,r.operate((function(r,o){return i.mergeInternals(r,o,e,t,void 0,!0,n)}))}},22884:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filter=void 0;var r=n(55031),i=n(23086);t.filter=function(e,t){return r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(n){return e.call(t,n,o++)&&r.next(n)})))}))}},90225:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.finalize=void 0;var r=n(55031);t.finalize=function(e){return r.operate((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}},62017:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFind=t.find=void 0;var r=n(55031),i=n(23086);function o(e,t,n){var r="index"===n;return function(n,o){var a=0;n.subscribe(i.createOperatorSubscriber(o,(function(i){var s=a++;e.call(t,i,s,n)&&(o.next(r?s:i),o.complete())}),(function(){o.next(r?-1:void 0),o.complete()})))}}t.find=function(e,t){return r.operate(o(e,t,"value"))},t.createFind=o},44501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIndex=void 0;var r=n(55031),i=n(62017);t.findIndex=function(e,t){return r.operate(i.createFind(e,t,"index"))}},44872:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.first=void 0;var r=n(75261),i=n(22884),o=n(45088),a=n(15660),s=n(15066),u=n(18055);t.first=function(e,t){var n=arguments.length>=2;return function(c){return c.pipe(e?i.filter((function(t,n){return e(t,n,c)})):u.identity,o.take(1),n?a.defaultIfEmpty(t):s.throwIfEmpty((function(){return new r.EmptyError})))}}},26795:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flatMap=void 0;var r=n(10987);t.flatMap=r.mergeMap},71372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.groupBy=void 0;var r=n(29299),i=n(88928),o=n(15094),a=n(55031),s=n(23086);t.groupBy=function(e,t,n,u){return a.operate((function(a,c){var l;t&&"function"!=typeof t?(n=t.duration,l=t.element,u=t.connector):l=t;var d=new Map,f=function(e){d.forEach(e),e(c)},p=function(e){return f((function(t){return t.error(e)}))},h=0,v=!1,m=new s.OperatorSubscriber(c,(function(t){try{var a=e(t),f=d.get(a);if(!f){d.set(a,f=u?u():new o.Subject);var y=(b=a,x=f,(_=new r.Observable((function(e){h++;var t=x.subscribe(e);return function(){t.unsubscribe(),0==--h&&v&&m.unsubscribe()}}))).key=b,_);if(c.next(y),n){var g=s.createOperatorSubscriber(f,(function(){f.complete(),null==g||g.unsubscribe()}),void 0,void 0,(function(){return d.delete(a)}));m.add(i.innerFrom(n(y)).subscribe(g))}}f.next(l?l(t):t)}catch(e){p(e)}var b,x,_}),(function(){return f((function(e){return e.complete()}))}),p,(function(){return d.clear()}),(function(){return v=!0,0===h}));a.subscribe(m)}))}},51268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ignoreElements=void 0;var r=n(55031),i=n(23086),o=n(83197);t.ignoreElements=function(){return r.operate((function(e,t){e.subscribe(i.createOperatorSubscriber(t,o.noop))}))}},3423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=void 0;var r=n(55031),i=n(23086);t.isEmpty=function(){return r.operate((function(e,t){e.subscribe(i.createOperatorSubscriber(t,(function(){t.next(!1),t.complete()}),(function(){t.next(!0),t.complete()})))}))}},79283:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinAllInternals=void 0;var r=n(18055),i=n(74718),o=n(49200),a=n(10987),s=n(24090);t.joinAllInternals=function(e,t){return o.pipe(s.toArray(),a.mergeMap((function(t){return e(t)})),t?i.mapOneOrManyArgs(t):r.identity)}},41836:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.last=void 0;var r=n(75261),i=n(22884),o=n(33619),a=n(15066),s=n(15660),u=n(18055);t.last=function(e,t){var n=arguments.length>=2;return function(c){return c.pipe(e?i.filter((function(t,n){return e(t,n,c)})):u.identity,o.takeLast(1),n?s.defaultIfEmpty(t):a.throwIfEmpty((function(){return new r.EmptyError})))}}},46065:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.map=void 0;var r=n(55031),i=n(23086);t.map=function(e,t){return r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(n){r.next(e.call(t,n,o++))})))}))}},65250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapTo=void 0;var r=n(46065);t.mapTo=function(e){return r.map((function(){return e}))}},32906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.materialize=void 0;var r=n(2930),i=n(55031),o=n(23086);t.materialize=function(){return i.operate((function(e,t){e.subscribe(o.createOperatorSubscriber(t,(function(e){t.next(r.Notification.createNext(e))}),(function(){t.next(r.Notification.createComplete()),t.complete()}),(function(e){t.next(r.Notification.createError(e)),t.complete()})))}))}},43326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.max=void 0;var r=n(59439),i=n(3749);t.max=function(e){return r.reduce(i.isFunction(e)?function(t,n){return e(t,n)>0?t:n}:function(e,t){return e>t?e:t})}},18414:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.merge=void 0;var o=n(55031),a=n(44285),s=n(79057),u=n(3194),c=n(14773);t.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=u.popScheduler(e),l=u.popNumber(e,1/0);return e=a.argsOrArgArray(e),o.operate((function(t,o){s.mergeAll(l)(c.from(i([t],r(e)),n)).subscribe(o)}))}},79057:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeAll=void 0;var r=n(10987),i=n(18055);t.mergeAll=function(e){return void 0===e&&(e=1/0),r.mergeMap(i.identity,e)}},18757:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeInternals=void 0;var r=n(88928),i=n(45007),o=n(23086);t.mergeInternals=function(e,t,n,a,s,u,c,l){var d=[],f=0,p=0,h=!1,v=function(){!h||d.length||f||t.complete()},m=function(e){return f<a?y(e):d.push(e)},y=function e(l){u&&t.next(l),f++;var h=!1;r.innerFrom(n(l,p++)).subscribe(o.createOperatorSubscriber(t,(function(e){null==s||s(e),u?m(e):t.next(e)}),(function(){h=!0}),void 0,(function(){if(h)try{f--;for(var n=function(){var n=d.shift();c?i.executeSchedule(t,c,(function(){return e(n)})):e(n)};d.length&&f<a;)n();v()}catch(e){t.error(e)}})))};return e.subscribe(o.createOperatorSubscriber(t,m,(function(){h=!0,v()}))),function(){null==l||l()}}},10987:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeMap=void 0;var r=n(46065),i=n(88928),o=n(55031),a=n(18757),s=n(3749);t.mergeMap=function e(t,n,u){return void 0===u&&(u=1/0),s.isFunction(n)?e((function(e,o){return r.map((function(t,r){return n(e,t,o,r)}))(i.innerFrom(t(e,o)))}),u):("number"==typeof n&&(u=n),o.operate((function(e,n){return a.mergeInternals(e,n,t,u)})))}},75315:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeMapTo=void 0;var r=n(10987),i=n(3749);t.mergeMapTo=function(e,t,n){return void 0===n&&(n=1/0),i.isFunction(t)?r.mergeMap((function(){return e}),t,n):("number"==typeof t&&(n=t),r.mergeMap((function(){return e}),n))}},76230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeScan=void 0;var r=n(55031),i=n(18757);t.mergeScan=function(e,t,n){return void 0===n&&(n=1/0),r.operate((function(r,o){var a=t;return i.mergeInternals(r,o,(function(t,n){return e(a,t,n)}),n,(function(e){a=e}),!1,void 0,(function(){return a=null}))}))}},79524:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.mergeWith=void 0;var o=n(18414);t.mergeWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.merge.apply(void 0,i([],r(e)))}},14610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.min=void 0;var r=n(59439),i=n(3749);t.min=function(e){return r.reduce(i.isFunction(e)?function(t,n){return e(t,n)<0?t:n}:function(e,t){return e<t?e:t})}},59163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multicast=void 0;var r=n(11107),i=n(3749),o=n(18710);t.multicast=function(e,t){var n=i.isFunction(e)?e:function(){return e};return i.isFunction(t)?o.connect(t,{connector:n}):function(e){return new r.ConnectableObservable(e,n)}}},7587:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observeOn=void 0;var r=n(45007),i=n(55031),o=n(23086);t.observeOn=function(e,t){return void 0===t&&(t=0),i.operate((function(n,i){n.subscribe(o.createOperatorSubscriber(i,(function(n){return r.executeSchedule(i,e,(function(){return i.next(n)}),t)}),(function(){return r.executeSchedule(i,e,(function(){return i.complete()}),t)}),(function(n){return r.executeSchedule(i,e,(function(){return i.error(n)}),t)})))}))}},67962:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.onErrorResumeNext=void 0;var o=n(55031),a=n(88928),s=n(44285),u=n(23086),c=n(83197);t.onErrorResumeNext=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s.argsOrArgArray(e);return o.operate((function(e,t){var o=i([e],r(n));!function e(){if(!t.closed)if(o.length>0){var n=void 0;try{n=a.innerFrom(o.shift())}catch(t){return void e()}var r=u.createOperatorSubscriber(t,void 0,c.noop,c.noop);n.subscribe(r),r.add(e)}else t.complete()}()}))}},17778:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pairwise=void 0;var r=n(55031),i=n(23086);t.pairwise=function(){return r.operate((function(e,t){var n,r=!1;e.subscribe(i.createOperatorSubscriber(t,(function(e){var i=n;n=e,r&&t.next([i,e]),r=!0})))}))}},58629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.partition=void 0;var r=n(16090),i=n(22884);t.partition=function(e,t){return function(n){return[i.filter(e,t)(n),i.filter(r.not(e,t))(n)]}}},20271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pluck=void 0;var r=n(46065);t.pluck=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(0===n)throw new Error("list of properties cannot be empty.");return r.map((function(t){for(var r=t,i=0;i<n;i++){var o=null==r?void 0:r[e[i]];if(void 0===o)return;r=o}return r}))}},69859:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publish=void 0;var r=n(15094),i=n(59163),o=n(18710);t.publish=function(e){return e?function(t){return o.connect(e)(t)}:function(e){return i.multicast(new r.Subject)(e)}}},15535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishBehavior=void 0;var r=n(99800),i=n(11107);t.publishBehavior=function(e){return function(t){var n=new r.BehaviorSubject(e);return new i.ConnectableObservable(t,(function(){return n}))}}},847:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishLast=void 0;var r=n(33867),i=n(11107);t.publishLast=function(){return function(e){var t=new r.AsyncSubject;return new i.ConnectableObservable(e,(function(){return t}))}}},84763:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishReplay=void 0;var r=n(58113),i=n(59163),o=n(3749);t.publishReplay=function(e,t,n,a){n&&!o.isFunction(n)&&(a=n);var s=o.isFunction(n)?n:void 0;return function(n){return i.multicast(new r.ReplaySubject(e,t,a),s)(n)}}},67189:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.race=void 0;var o=n(44285),a=n(76711);t.race=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.raceWith.apply(void 0,i([],r(o.argsOrArgArray(e))))}},76711:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.raceWith=void 0;var o=n(43118),a=n(55031),s=n(18055);t.raceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length?a.operate((function(t,n){o.raceInit(i([t],r(e)))(n)})):s.identity}},59439:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=void 0;var r=n(13364),i=n(55031);t.reduce=function(e,t){return i.operate(r.scanInternals(e,t,arguments.length>=2,!1,!0))}},91766:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refCount=void 0;var r=n(55031),i=n(23086);t.refCount=function(){return r.operate((function(e,t){var n=null;e._refCount++;var r=i.createOperatorSubscriber(t,void 0,void 0,void 0,(function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,!r||i&&r!==i||r.unsubscribe(),t.unsubscribe()}}));e.subscribe(r),r.closed||(n=e.connect())}))}},25180:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.repeat=void 0;var r=n(2577),i=n(55031),o=n(23086),a=n(88928),s=n(85708);t.repeat=function(e){var t,n,u=1/0;return null!=e&&("object"==typeof e?(t=e.count,u=void 0===t?1/0:t,n=e.delay):u=e),u<=0?function(){return r.EMPTY}:i.operate((function(e,t){var r,i=0,c=function(){if(null==r||r.unsubscribe(),r=null,null!=n){var e="number"==typeof n?s.timer(n):a.innerFrom(n(i)),u=o.createOperatorSubscriber(t,(function(){u.unsubscribe(),l()}));e.subscribe(u)}else l()},l=function(){var n=!1;r=e.subscribe(o.createOperatorSubscriber(t,void 0,(function(){++i<u?r?c():n=!0:t.complete()}))),n&&c()};l()}))}},38586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.repeatWhen=void 0;var r=n(15094),i=n(55031),o=n(23086);t.repeatWhen=function(e){return i.operate((function(t,n){var i,a,s=!1,u=!1,c=!1,l=function(){return c&&u&&(n.complete(),!0)},d=function(){return a||(a=new r.Subject,e(a).subscribe(o.createOperatorSubscriber(n,(function(){i?f():s=!0}),(function(){u=!0,l()})))),a},f=function e(){c=!1,i=t.subscribe(o.createOperatorSubscriber(n,void 0,(function(){c=!0,!l()&&d().next()}))),s&&(i.unsubscribe(),i=null,s=!1,e())};f()}))}},12736:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retry=void 0;var r=n(55031),i=n(23086),o=n(18055),a=n(85708),s=n(88928);t.retry=function(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,u=void 0===n?1/0:n,c=t.delay,l=t.resetOnSuccess,d=void 0!==l&&l;return u<=0?o.identity:r.operate((function(e,t){var n,r=0;!function o(){var l=!1;n=e.subscribe(i.createOperatorSubscriber(t,(function(e){d&&(r=0),t.next(e)}),void 0,(function(e){if(r++<u){var d=function(){n?(n.unsubscribe(),n=null,o()):l=!0};if(null!=c){var f="number"==typeof c?a.timer(c):s.innerFrom(c(e,r)),p=i.createOperatorSubscriber(t,(function(){p.unsubscribe(),d()}),(function(){t.complete()}));f.subscribe(p)}else d()}else t.error(e)}))),l&&(n.unsubscribe(),n=null,o())}()}))}},40146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retryWhen=void 0;var r=n(15094),i=n(55031),o=n(23086);t.retryWhen=function(e){return i.operate((function(t,n){var i,a,s=!1;!function u(){i=t.subscribe(o.createOperatorSubscriber(n,void 0,void 0,(function(t){a||(a=new r.Subject,e(a).subscribe(o.createOperatorSubscriber(n,(function(){return i?u():s=!0})))),a&&a.next(t)}))),s&&(i.unsubscribe(),i=null,s=!1,u())}()}))}},61637:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sample=void 0;var r=n(55031),i=n(83197),o=n(23086);t.sample=function(e){return r.operate((function(t,n){var r=!1,a=null;t.subscribe(o.createOperatorSubscriber(n,(function(e){r=!0,a=e}))),e.subscribe(o.createOperatorSubscriber(n,(function(){if(r){r=!1;var e=a;a=null,n.next(e)}}),i.noop))}))}},71114:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sampleTime=void 0;var r=n(71805),i=n(61637),o=n(63363);t.sampleTime=function(e,t){return void 0===t&&(t=r.asyncScheduler),i.sample(o.interval(e,t))}},36189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scan=void 0;var r=n(55031),i=n(13364);t.scan=function(e,t){return r.operate(i.scanInternals(e,t,arguments.length>=2,!0))}},13364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanInternals=void 0;var r=n(23086);t.scanInternals=function(e,t,n,i,o){return function(a,s){var u=n,c=t,l=0;a.subscribe(r.createOperatorSubscriber(s,(function(t){var n=l++;c=u?e(c,t,n):(u=!0,t),i&&s.next(c)}),o&&function(){u&&s.next(c),s.complete()}))}}},11918:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sequenceEqual=void 0;var r=n(55031),i=n(23086);t.sequenceEqual=function(e,t){return void 0===t&&(t=function(e,t){return e===t}),r.operate((function(n,r){var o={buffer:[],complete:!1},a={buffer:[],complete:!1},s=function(e){r.next(e),r.complete()},u=function(e,n){var o=i.createOperatorSubscriber(r,(function(r){var i=n.buffer,o=n.complete;0===i.length?o?s(!1):e.buffer.push(r):!t(r,i.shift())&&s(!1)}),(function(){e.complete=!0;var t=n.complete,r=n.buffer;t&&s(0===r.length),null==o||o.unsubscribe()}));return o};n.subscribe(u(o,a)),e.subscribe(u(a,o))}))}},65720:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.share=void 0;var o=n(14773),a=n(45088),s=n(15094),u=n(64767),c=n(55031);function l(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return!0===t?(e(),null):!1===t?null:t.apply(void 0,i([],r(n))).pipe(a.take(1)).subscribe((function(){return e()}))}t.share=function(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new s.Subject}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,d=void 0===a||a,f=e.resetOnRefCountZero,p=void 0===f||f;return function(e){var t=null,r=null,a=null,s=0,f=!1,h=!1,v=function(){null==r||r.unsubscribe(),r=null},m=function(){v(),t=a=null,f=h=!1},y=function(){var e=t;m(),null==e||e.unsubscribe()};return c.operate((function(e,c){s++,h||f||v();var g=a=null!=a?a:n();c.add((function(){0!=--s||h||f||(r=l(y,p))})),g.subscribe(c),t||(t=new u.SafeSubscriber({next:function(e){return g.next(e)},error:function(e){h=!0,v(),r=l(m,i,e),g.error(e)},complete:function(){f=!0,v(),r=l(m,d),g.complete()}}),o.from(e).subscribe(t))}))(e)}}},3532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shareReplay=void 0;var r=n(58113),i=n(65720);t.shareReplay=function(e,t,n){var o,a,s,u,c=!1;return e&&"object"==typeof e?(o=e.bufferSize,u=void 0===o?1/0:o,a=e.windowTime,t=void 0===a?1/0:a,c=void 0!==(s=e.refCount)&&s,n=e.scheduler):u=null!=e?e:1/0,i.share({connector:function(){return new r.ReplaySubject(u,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}},72293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=void 0;var r=n(75261),i=n(11590),o=n(66275),a=n(55031),s=n(23086);t.single=function(e){return a.operate((function(t,n){var a,u=!1,c=!1,l=0;t.subscribe(s.createOperatorSubscriber(n,(function(r){c=!0,e&&!e(r,l++,t)||(u&&n.error(new i.SequenceError("Too many matching values")),u=!0,a=r)}),(function(){u?(n.next(a),n.complete()):n.error(c?new o.NotFoundError("No matching values"):new r.EmptyError)})))}))}},46810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skip=void 0;var r=n(22884);t.skip=function(e){return r.filter((function(t,n){return e<=n}))}},49755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipLast=void 0;var r=n(18055),i=n(55031),o=n(23086);t.skipLast=function(e){return e<=0?r.identity:i.operate((function(t,n){var r=new Array(e),i=0;return t.subscribe(o.createOperatorSubscriber(n,(function(t){var o=i++;if(o<e)r[o]=t;else{var a=o%e,s=r[a];r[a]=t,n.next(s)}}))),function(){r=null}}))}},55571:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipUntil=void 0;var r=n(55031),i=n(23086),o=n(88928),a=n(83197);t.skipUntil=function(e){return r.operate((function(t,n){var r=!1,s=i.createOperatorSubscriber(n,(function(){null==s||s.unsubscribe(),r=!0}),a.noop);o.innerFrom(e).subscribe(s),t.subscribe(i.createOperatorSubscriber(n,(function(e){return r&&n.next(e)})))}))}},15470:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipWhile=void 0;var r=n(55031),i=n(23086);t.skipWhile=function(e){return r.operate((function(t,n){var r=!1,o=0;t.subscribe(i.createOperatorSubscriber(n,(function(t){return(r||(r=!e(t,o++)))&&n.next(t)})))}))}},84747:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startWith=void 0;var r=n(6628),i=n(3194),o=n(55031);t.startWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.popScheduler(e);return o.operate((function(t,i){(n?r.concat(e,t,n):r.concat(e,t)).subscribe(i)}))}},14596:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeOn=void 0;var r=n(55031);t.subscribeOn=function(e,t){return void 0===t&&(t=0),r.operate((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}},35224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchAll=void 0;var r=n(44317),i=n(18055);t.switchAll=function(){return r.switchMap(i.identity)}},44317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchMap=void 0;var r=n(88928),i=n(55031),o=n(23086);t.switchMap=function(e,t){return i.operate((function(n,i){var a=null,s=0,u=!1,c=function(){return u&&!a&&i.complete()};n.subscribe(o.createOperatorSubscriber(i,(function(n){null==a||a.unsubscribe();var u=0,l=s++;r.innerFrom(e(n,l)).subscribe(a=o.createOperatorSubscriber(i,(function(e){return i.next(t?t(n,e,l,u++):e)}),(function(){a=null,c()})))}),(function(){u=!0,c()})))}))}},55334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchMapTo=void 0;var r=n(44317),i=n(3749);t.switchMapTo=function(e,t){return i.isFunction(t)?r.switchMap((function(){return e}),t):r.switchMap((function(){return e}))}},51174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchScan=void 0;var r=n(44317),i=n(55031);t.switchScan=function(e,t){return i.operate((function(n,i){var o=t;return r.switchMap((function(t,n){return e(o,t,n)}),(function(e,t){return o=t,t}))(n).subscribe(i),function(){o=null}}))}},45088:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.take=void 0;var r=n(2577),i=n(55031),o=n(23086);t.take=function(e){return e<=0?function(){return r.EMPTY}:i.operate((function(t,n){var r=0;t.subscribe(o.createOperatorSubscriber(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}},33619:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.takeLast=void 0;var i=n(2577),o=n(55031),a=n(23086);t.takeLast=function(e){return e<=0?function(){return i.EMPTY}:o.operate((function(t,n){var i=[];t.subscribe(a.createOperatorSubscriber(n,(function(t){i.push(t),e<i.length&&i.shift()}),(function(){var e,t;try{for(var o=r(i),a=o.next();!a.done;a=o.next()){var s=a.value;n.next(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}n.complete()}),void 0,(function(){i=null})))}))}},58849:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.takeUntil=void 0;var r=n(55031),i=n(23086),o=n(88928),a=n(83197);t.takeUntil=function(e){return r.operate((function(t,n){o.innerFrom(e).subscribe(i.createOperatorSubscriber(n,(function(){return n.complete()}),a.noop)),!n.closed&&t.subscribe(n)}))}},50152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.takeWhile=void 0;var r=n(55031),i=n(23086);t.takeWhile=function(e,t){return void 0===t&&(t=!1),r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(n){var i=e(n,o++);(i||t)&&r.next(n),!i&&r.complete()})))}))}},69774:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tap=void 0;var r=n(3749),i=n(55031),o=n(23086),a=n(18055);t.tap=function(e,t,n){var s=r.isFunction(e)||t||n?{next:e,error:t,complete:n}:e;return s?i.operate((function(e,t){var n;null===(n=s.subscribe)||void 0===n||n.call(s);var r=!0;e.subscribe(o.createOperatorSubscriber(t,(function(e){var n;null===(n=s.next)||void 0===n||n.call(s,e),t.next(e)}),(function(){var e;r=!1,null===(e=s.complete)||void 0===e||e.call(s),t.complete()}),(function(e){var n;r=!1,null===(n=s.error)||void 0===n||n.call(s,e),t.error(e)}),(function(){var e,t;r&&(null===(e=s.unsubscribe)||void 0===e||e.call(s)),null===(t=s.finalize)||void 0===t||t.call(s)})))})):a.identity}},23466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.defaultThrottleConfig=void 0;var r=n(55031),i=n(23086),o=n(88928);t.defaultThrottleConfig={leading:!0,trailing:!1},t.throttle=function(e,n){return void 0===n&&(n=t.defaultThrottleConfig),r.operate((function(t,r){var a=n.leading,s=n.trailing,u=!1,c=null,l=null,d=!1,f=function(){null==l||l.unsubscribe(),l=null,s&&(v(),d&&r.complete())},p=function(){l=null,d&&r.complete()},h=function(t){return l=o.innerFrom(e(t)).subscribe(i.createOperatorSubscriber(r,f,p))},v=function(){if(u){u=!1;var e=c;c=null,r.next(e),!d&&h(e)}};t.subscribe(i.createOperatorSubscriber(r,(function(e){u=!0,c=e,(!l||l.closed)&&(a?v():h(e))}),(function(){d=!0,(!(s&&u&&l)||l.closed)&&r.complete()})))}))}},12083:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttleTime=void 0;var r=n(71805),i=n(23466),o=n(85708);t.throttleTime=function(e,t,n){void 0===t&&(t=r.asyncScheduler),void 0===n&&(n=i.defaultThrottleConfig);var a=o.timer(e,t);return i.throttle((function(){return a}),n)}},15066:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfEmpty=void 0;var r=n(75261),i=n(55031),o=n(23086);function a(){return new r.EmptyError}t.throwIfEmpty=function(e){return void 0===e&&(e=a),i.operate((function(t,n){var r=!1;t.subscribe(o.createOperatorSubscriber(n,(function(e){r=!0,n.next(e)}),(function(){return r?n.complete():n.error(e())})))}))}},10493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeInterval=t.timeInterval=void 0;var r=n(71805),i=n(55031),o=n(23086);t.timeInterval=function(e){return void 0===e&&(e=r.asyncScheduler),i.operate((function(t,n){var r=e.now();t.subscribe(o.createOperatorSubscriber(n,(function(t){var i=e.now(),o=i-r;r=i,n.next(new a(t,o))})))}))};var a=function(e,t){this.value=e,this.interval=t};t.TimeInterval=a},73687:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeout=t.TimeoutError=void 0;var r=n(71805),i=n(13785),o=n(55031),a=n(88928),s=n(16796),u=n(23086),c=n(45007);function l(e){throw new t.TimeoutError(e)}t.TimeoutError=s.createErrorClass((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}})),t.timeout=function(e,t){var n=i.isValidDate(e)?{first:e}:"number"==typeof e?{each:e}:e,s=n.first,d=n.each,f=n.with,p=void 0===f?l:f,h=n.scheduler,v=void 0===h?null!=t?t:r.asyncScheduler:h,m=n.meta,y=void 0===m?null:m;if(null==s&&null==d)throw new TypeError("No timeout provided.");return o.operate((function(e,t){var n,r,i=null,o=0,l=function(e){r=c.executeSchedule(t,v,(function(){try{n.unsubscribe(),a.innerFrom(p({meta:y,lastValue:i,seen:o})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(u.createOperatorSubscriber(t,(function(e){null==r||r.unsubscribe(),o++,t.next(i=e),d>0&&l(d)}),void 0,void 0,(function(){(null==r?void 0:r.closed)||null==r||r.unsubscribe(),i=null}))),!o&&l(null!=s?"number"==typeof s?s:+s-v.now():d)}))}},18711:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeoutWith=void 0;var r=n(71805),i=n(13785),o=n(73687);t.timeoutWith=function(e,t,n){var a,s,u;if(n=null!=n?n:r.async,i.isValidDate(e)?a=e:"number"==typeof e&&(s=e),!t)throw new TypeError("No observable provided to switch to");if(u=function(){return t},null==a&&null==s)throw new TypeError("No timeout provided.");return o.timeout({first:a,each:s,scheduler:n,with:u})}},47716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timestamp=void 0;var r=n(4614),i=n(46065);t.timestamp=function(e){return void 0===e&&(e=r.dateTimestampProvider),i.map((function(t){return{value:t,timestamp:e.now()}}))}},24090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=void 0;var r=n(59439),i=n(55031),o=function(e,t){return e.push(t),e};t.toArray=function(){return i.operate((function(e,t){r.reduce(o,[])(e).subscribe(t)}))}},74080:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.window=void 0;var r=n(15094),i=n(55031),o=n(23086),a=n(83197);t.window=function(e){return i.operate((function(t,n){var i=new r.Subject;n.next(i.asObservable());var s=function(e){i.error(e),n.error(e)};return t.subscribe(o.createOperatorSubscriber(n,(function(e){return null==i?void 0:i.next(e)}),(function(){i.complete(),n.complete()}),s)),e.subscribe(o.createOperatorSubscriber(n,(function(){i.complete(),n.next(i=new r.Subject)}),a.noop,s)),function(){null==i||i.unsubscribe(),i=null}}))}},16298:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.windowCount=void 0;var i=n(15094),o=n(55031),a=n(23086);t.windowCount=function(e,t){void 0===t&&(t=0);var n=t>0?t:e;return o.operate((function(t,o){var s=[new i.Subject],u=0;o.next(s[0].asObservable()),t.subscribe(a.createOperatorSubscriber(o,(function(t){var a,c;try{for(var l=r(s),d=l.next();!d.done;d=l.next())d.value.next(t)}catch(e){a={error:e}}finally{try{d&&!d.done&&(c=l.return)&&c.call(l)}finally{if(a)throw a.error}}var f=u-e+1;if(f>=0&&f%n==0&&s.shift().complete(),++u%n==0){var p=new i.Subject;s.push(p),o.next(p.asObservable())}}),(function(){for(;s.length>0;)s.shift().complete();o.complete()}),(function(e){for(;s.length>0;)s.shift().error(e);o.error(e)}),(function(){s=null})))}))}},34418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowTime=void 0;var r=n(15094),i=n(71805),o=n(50979),a=n(55031),s=n(23086),u=n(86908),c=n(3194),l=n(45007);t.windowTime=function(e){for(var t,n,d=[],f=1;f<arguments.length;f++)d[f-1]=arguments[f];var p=null!==(t=c.popScheduler(d))&&void 0!==t?t:i.asyncScheduler,h=null!==(n=d[0])&&void 0!==n?n:null,v=d[1]||1/0;return a.operate((function(t,n){var i=[],a=!1,c=function(e){var t=e.window,n=e.subs;t.complete(),n.unsubscribe(),u.arrRemove(i,e),a&&d()},d=function(){if(i){var t=new o.Subscription;n.add(t);var a=new r.Subject,s={window:a,subs:t,seen:0};i.push(s),n.next(a.asObservable()),l.executeSchedule(t,p,(function(){return c(s)}),e)}};null!==h&&h>=0?l.executeSchedule(n,p,d,h,!0):a=!0,d();var f=function(e){return i.slice().forEach(e)},m=function(e){f((function(t){var n=t.window;return e(n)})),e(n),n.unsubscribe()};return t.subscribe(s.createOperatorSubscriber(n,(function(e){f((function(t){t.window.next(e),v<=++t.seen&&c(t)}))}),(function(){return m((function(e){return e.complete()}))}),(function(e){return m((function(t){return t.error(e)}))}))),function(){i=null}}))}},85489:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.windowToggle=void 0;var i=n(15094),o=n(50979),a=n(55031),s=n(88928),u=n(23086),c=n(83197),l=n(86908);t.windowToggle=function(e,t){return a.operate((function(n,a){var d=[],f=function(e){for(;0<d.length;)d.shift().error(e);a.error(e)};s.innerFrom(e).subscribe(u.createOperatorSubscriber(a,(function(e){var n=new i.Subject;d.push(n);var r,p=new o.Subscription;try{r=s.innerFrom(t(e))}catch(e){return void f(e)}a.next(n.asObservable()),p.add(r.subscribe(u.createOperatorSubscriber(a,(function(){l.arrRemove(d,n),n.complete(),p.unsubscribe()}),c.noop,f)))}),c.noop)),n.subscribe(u.createOperatorSubscriber(a,(function(e){var t,n,i=d.slice();try{for(var o=r(i),a=o.next();!a.done;a=o.next())a.value.next(e)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}),(function(){for(;0<d.length;)d.shift().complete();a.complete()}),f,(function(){for(;0<d.length;)d.shift().unsubscribe()})))}))}},86003:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowWhen=void 0;var r=n(15094),i=n(55031),o=n(23086),a=n(88928);t.windowWhen=function(e){return i.operate((function(t,n){var i,s,u=function(e){i.error(e),n.error(e)};!function t(){var c;null==s||s.unsubscribe(),null==i||i.complete(),i=new r.Subject,n.next(i.asObservable());try{c=a.innerFrom(e())}catch(e){return void u(e)}c.subscribe(s=o.createOperatorSubscriber(n,t,t,u))}(),t.subscribe(o.createOperatorSubscriber(n,(function(e){return i.next(e)}),(function(){i.complete(),n.complete()}),u,(function(){null==s||s.unsubscribe(),i=null})))}))}},39167:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.withLatestFrom=void 0;var o=n(55031),a=n(23086),s=n(88928),u=n(18055),c=n(83197),l=n(3194);t.withLatestFrom=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=l.popResultSelector(e);return o.operate((function(t,o){for(var l=e.length,d=new Array(l),f=e.map((function(){return!1})),p=!1,h=function(t){s.innerFrom(e[t]).subscribe(a.createOperatorSubscriber(o,(function(e){d[t]=e,p||f[t]||(f[t]=!0,(p=f.every(u.identity))&&(f=null))}),c.noop))},v=0;v<l;v++)h(v);t.subscribe(a.createOperatorSubscriber(o,(function(e){if(p){var t=i([e],r(d));o.next(n?n.apply(void 0,i([],r(t))):t)}})))}))}},40949:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.zip=void 0;var o=n(73758),a=n(55031);t.zip=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.operate((function(t,n){o.zip.apply(void 0,i([t],r(e))).subscribe(n)}))}},64325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipAll=void 0;var r=n(73758),i=n(79283);t.zipAll=function(e){return i.joinAllInternals(r.zip,e)}},26397:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.zipWith=void 0;var o=n(40949);t.zipWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.zip.apply(void 0,i([],r(e)))}},39107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleArray=void 0;var r=n(29299);t.scheduleArray=function(e,t){return new r.Observable((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}},75286:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleAsyncIterable=void 0;var r=n(29299),i=n(45007);t.scheduleAsyncIterable=function(e,t){if(!e)throw new Error("Iterable cannot be null");return new r.Observable((function(n){i.executeSchedule(n,t,(function(){var r=e[Symbol.asyncIterator]();i.executeSchedule(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}},15394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleIterable=void 0;var r=n(29299),i=n(7098),o=n(3749),a=n(45007);t.scheduleIterable=function(e,t){return new r.Observable((function(n){var r;return a.executeSchedule(n,t,(function(){r=e[i.iterator](),a.executeSchedule(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return o.isFunction(null==r?void 0:r.return)&&r.return()}}))}},56789:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleObservable=void 0;var r=n(88928),i=n(7587),o=n(14596);t.scheduleObservable=function(e,t){return r.innerFrom(e).pipe(o.subscribeOn(t),i.observeOn(t))}},56185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schedulePromise=void 0;var r=n(88928),i=n(7587),o=n(14596);t.schedulePromise=function(e,t){return r.innerFrom(e).pipe(o.subscribeOn(t),i.observeOn(t))}},79049:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleReadableStreamLike=void 0;var r=n(75286),i=n(88920);t.scheduleReadableStreamLike=function(e,t){return r.scheduleAsyncIterable(i.readableStreamLikeToAsyncGenerator(e),t)}},91758:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduled=void 0;var r=n(56789),i=n(56185),o=n(39107),a=n(15394),s=n(75286),u=n(87891),c=n(3242),l=n(67815),d=n(89401),f=n(64016),p=n(42821),h=n(88920),v=n(79049);t.scheduled=function(e,t){if(null!=e){if(u.isInteropObservable(e))return r.scheduleObservable(e,t);if(l.isArrayLike(e))return o.scheduleArray(e,t);if(c.isPromise(e))return i.schedulePromise(e,t);if(f.isAsyncIterable(e))return s.scheduleAsyncIterable(e,t);if(d.isIterable(e))return a.scheduleIterable(e,t);if(h.isReadableStreamLike(e))return v.scheduleReadableStreamLike(e,t)}throw p.createInvalidObservableTypeError(e)}},5184:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0;var o=function(e){function t(t,n){return e.call(this)||this}return i(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(50979).Subscription);t.Action=o},36267:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationFrameAction=void 0;var o=n(11209),a=n(85160),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return i(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=a.animationFrameProvider.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);t.actions.some((function(e){return e.id===n}))||(a.animationFrameProvider.cancelAnimationFrame(n),t._scheduled=void 0)},t}(o.AsyncAction);t.AnimationFrameAction=s},35892:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationFrameScheduler=void 0;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(n(60878).AsyncScheduler);t.AnimationFrameScheduler=o},31754:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsapAction=void 0;var o=n(11209),a=n(44462),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return i(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=a.immediateProvider.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);t.actions.some((function(e){return e.id===n}))||(a.immediateProvider.clearImmediate(n),t._scheduled=void 0)},t}(o.AsyncAction);t.AsapAction=s},62439:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsapScheduler=void 0;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(n(60878).AsyncScheduler);t.AsapScheduler=o},11209:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncAction=void 0;var o=n(5184),a=n(96926),s=n(86908),u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return i(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),a.intervalProvider.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;a.intervalProvider.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,s.arrRemove(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(o.Action);t.AsyncAction=u},60878:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncScheduler=void 0;var o=n(27619),a=function(e){function t(t,n){void 0===n&&(n=o.Scheduler.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r._scheduled=void 0,r}return i(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(o.Scheduler);t.AsyncScheduler=a},45758:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.QueueAction=void 0;var o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return i(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(n(11209).AsyncAction);t.QueueAction=o},23797:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.QueueScheduler=void 0;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(n(60878).AsyncScheduler);t.QueueScheduler=o},27950:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VirtualAction=t.VirtualTimeScheduler=void 0;var o=n(11209),a=n(50979),s=function(e){function t(t,n){void 0===t&&(t=u),void 0===n&&(n=1/0);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return i(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(n(60878).AsyncScheduler);t.VirtualTimeScheduler=s;var u=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return i(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),Number.isFinite(r)){if(!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)}return a.Subscription.EMPTY},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var i=e.actions;return i.push(this),i.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,n){void 0===n&&(n=0)},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(o.AsyncAction);t.VirtualAction=u},92165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationFrame=t.animationFrameScheduler=void 0;var r=n(36267),i=n(35892);t.animationFrameScheduler=new i.AnimationFrameScheduler(r.AnimationFrameAction),t.animationFrame=t.animationFrameScheduler},85160:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.animationFrameProvider=void 0;var o=n(50979);t.animationFrameProvider={schedule:function(e){var n=requestAnimationFrame,r=cancelAnimationFrame,i=t.animationFrameProvider.delegate;i&&(n=i.requestAnimationFrame,r=i.cancelAnimationFrame);var a=n((function(t){r=void 0,e(t)}));return new o.Subscription((function(){return null==r?void 0:r(a)}))},requestAnimationFrame:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=t.animationFrameProvider.delegate;return((null==o?void 0:o.requestAnimationFrame)||requestAnimationFrame).apply(void 0,i([],r(e)))})),cancelAnimationFrame:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=t.animationFrameProvider.delegate;return((null==o?void 0:o.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,i([],r(e)))})),delegate:void 0}},80721:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asap=t.asapScheduler=void 0;var r=n(31754),i=n(62439);t.asapScheduler=new i.AsapScheduler(r.AsapAction),t.asap=t.asapScheduler},71805:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.async=t.asyncScheduler=void 0;var r=n(11209),i=n(60878);t.asyncScheduler=new i.AsyncScheduler(r.AsyncAction),t.async=t.asyncScheduler},4614:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dateTimestampProvider=void 0,t.dateTimestampProvider={now:function(){return(t.dateTimestampProvider.delegate||Date).now()},delegate:void 0}},44462:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.immediateProvider=void 0;var o=n(91613),a=o.Immediate.setImmediate,s=o.Immediate.clearImmediate;t.immediateProvider={setImmediate:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=t.immediateProvider.delegate;return((null==o?void 0:o.setImmediate)||a).apply(void 0,i([],r(e)))},clearImmediate:function(e){var n=t.immediateProvider.delegate;return((null==n?void 0:n.clearImmediate)||s)(e)},delegate:void 0}},96926:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.intervalProvider=void 0,t.intervalProvider={setInterval:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s=t.intervalProvider.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,r([e,i],n(o))):setInterval.apply(void 0,r([e,i],n(o)))})),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var n=t.intervalProvider.delegate;return((null==n?void 0:n.clearInterval)||clearInterval)(e)})),delegate:void 0}},47318:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performanceTimestampProvider=void 0,t.performanceTimestampProvider={now:function(){return(t.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}},84532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queue=t.queueScheduler=void 0;var r=n(45758),i=n(23797);t.queueScheduler=new i.QueueScheduler(r.QueueAction),t.queue=t.queueScheduler},4117:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.timeoutProvider=void 0,t.timeoutProvider={setTimeout:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s=t.timeoutProvider.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,r([e,i],n(o))):setTimeout.apply(void 0,r([e,i],n(o)))})),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var n=t.timeoutProvider.delegate;return((null==n?void 0:n.clearTimeout)||clearTimeout)(e)})),delegate:void 0}},7098:function(e,t){"use strict";function n(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}Object.defineProperty(t,"__esModule",{value:!0}),t.iterator=t.getSymbolIterator=void 0,t.getSymbolIterator=n,t.iterator=n()},69981:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observable=void 0,t.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"},39970:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2886:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentOutOfRangeError=void 0;var r=n(16796);t.ArgumentOutOfRangeError=r.createErrorClass((function(e){return function(){e(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}))},75261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyError=void 0;var r=n(16796);t.EmptyError=r.createErrorClass((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}))},91613:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestTools=t.Immediate=void 0;var n,r=1,i={};function o(e){return e in i&&(delete i[e],!0)}t.Immediate={setImmediate:function(e){var t=r++;return i[t]=!0,n||(n=Promise.resolve()),n.then((function(){return o(t)&&e()})),t},clearImmediate:function(e){o(e)}},t.TestTools={pending:function(){return Object.keys(i).length}}},66275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=void 0;var r=n(16796);t.NotFoundError=r.createErrorClass((function(e){return function(t){e(this),this.name="NotFoundError",this.message=t}}))},53971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectUnsubscribedError=void 0;var r=n(16796);t.ObjectUnsubscribedError=r.createErrorClass((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}))},11590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SequenceError=void 0;var r=n(16796);t.SequenceError=r.createErrorClass((function(e){return function(t){e(this),this.name="SequenceError",this.message=t}}))},17750:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnsubscriptionError=void 0;var r=n(16796);t.UnsubscriptionError=r.createErrorClass((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}))},3194:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.popNumber=t.popScheduler=t.popResultSelector=void 0;var r=n(3749),i=n(45767);function o(e){return e[e.length-1]}t.popResultSelector=function(e){return r.isFunction(o(e))?e.pop():void 0},t.popScheduler=function(e){return i.isScheduler(o(e))?e.pop():void 0},t.popNumber=function(e,t){return"number"==typeof o(e)?e.pop():t}},21224:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argsArgArrayOrObject=void 0;var n=Array.isArray,r=Object.getPrototypeOf,i=Object.prototype,o=Object.keys;t.argsArgArrayOrObject=function(e){if(1===e.length){var t=e[0];if(n(t))return{args:t,keys:null};if((s=t)&&"object"==typeof s&&r(s)===i){var a=o(t);return{args:a.map((function(e){return t[e]})),keys:a}}}var s;return{args:e,keys:null}}},44285:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argsOrArgArray=void 0;var n=Array.isArray;t.argsOrArgArray=function(e){return 1===e.length&&n(e[0])?e[0]:e}},86908:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrRemove=void 0,t.arrRemove=function(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}},16796:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createErrorClass=void 0,t.createErrorClass=function(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}},76991:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObject=void 0,t.createObject=function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}},70936:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.captureError=t.errorContext=void 0;var r=n(24508),i=null;t.errorContext=function(e){if(r.config.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var n=i,o=n.errorThrown,a=n.error;if(i=null,o)throw a}}else e()},t.captureError=function(e){r.config.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},45007:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.executeSchedule=void 0,t.executeSchedule=function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}},18055:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identity=void 0,t.identity=function(e){return e}},67815:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayLike=void 0,t.isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},64016:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=void 0;var r=n(3749);t.isAsyncIterable=function(e){return Symbol.asyncIterator&&r.isFunction(null==e?void 0:e[Symbol.asyncIterator])}},13785:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidDate=void 0,t.isValidDate=function(e){return e instanceof Date&&!isNaN(e)}},3749:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=void 0,t.isFunction=function(e){return"function"==typeof e}},87891:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInteropObservable=void 0;var r=n(69981),i=n(3749);t.isInteropObservable=function(e){return i.isFunction(e[r.observable])}},89401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIterable=void 0;var r=n(7098),i=n(3749);t.isIterable=function(e){return i.isFunction(null==e?void 0:e[r.iterator])}},20530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObservable=void 0;var r=n(29299),i=n(3749);t.isObservable=function(e){return!!e&&(e instanceof r.Observable||i.isFunction(e.lift)&&i.isFunction(e.subscribe))}},3242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0;var r=n(3749);t.isPromise=function(e){return r.isFunction(null==e?void 0:e.then)}},88920:function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__await||function(e){return this instanceof i?(this.v=e,this):new i(e)},o=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),a=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||u(e,t)}))})}function u(e,t){try{(n=o[e](t)).value instanceof i?Promise.resolve(n.value.v).then(c,l):d(a[0][2],n)}catch(e){d(a[0][3],e)}var n}function c(e){u("next",e)}function l(e){u("throw",e)}function d(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.isReadableStreamLike=t.readableStreamLikeToAsyncGenerator=void 0;var a=n(3749);t.readableStreamLikeToAsyncGenerator=function(e){return o(this,arguments,(function(){var t,n,o;return r(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,i(t.read())];case 3:return n=r.sent(),o=n.value,n.done?[4,i(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,i(o)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))},t.isReadableStreamLike=function(e){return a.isFunction(null==e?void 0:e.getReader)}},45767:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isScheduler=void 0;var r=n(3749);t.isScheduler=function(e){return e&&r.isFunction(e.schedule)}},55031:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operate=t.hasLift=void 0;var r=n(3749);function i(e){return r.isFunction(null==e?void 0:e.lift)}t.hasLift=i,t.operate=function(e){return function(t){if(i(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},74718:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.mapOneOrManyArgs=void 0;var o=n(46065),a=Array.isArray;t.mapOneOrManyArgs=function(e){return o.map((function(t){return function(e,t){return a(t)?e.apply(void 0,i([],r(t))):e(t)}(e,t)}))}},83197:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=void 0,t.noop=function(){}},16090:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=void 0,t.not=function(e,t){return function(n,r){return!e.call(t,n,r)}}},49200:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pipeFromArray=t.pipe=void 0;var r=n(18055);function i(e){return 0===e.length?r.identity:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(e)},t.pipeFromArray=i},4387:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportUnhandledError=void 0;var r=n(24508),i=n(4117);t.reportUnhandledError=function(e){i.timeoutProvider.setTimeout((function(){var t=r.config.onUnhandledError;if(!t)throw e;t(e)}))}},42821:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInvalidObservableTypeError=void 0,t.createInvalidObservableTypeError=function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}},60552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeAll=t.merge=t.max=t.materialize=t.mapTo=t.map=t.last=t.isEmpty=t.ignoreElements=t.groupBy=t.first=t.findIndex=t.find=t.finalize=t.filter=t.expand=t.exhaustMap=t.exhaustAll=t.exhaust=t.every=t.endWith=t.elementAt=t.distinctUntilKeyChanged=t.distinctUntilChanged=t.distinct=t.dematerialize=t.delayWhen=t.delay=t.defaultIfEmpty=t.debounceTime=t.debounce=t.count=t.connect=t.concatWith=t.concatMapTo=t.concatMap=t.concatAll=t.concat=t.combineLatestWith=t.combineLatest=t.combineLatestAll=t.combineAll=t.catchError=t.bufferWhen=t.bufferToggle=t.bufferTime=t.bufferCount=t.buffer=t.auditTime=t.audit=void 0,t.timeInterval=t.throwIfEmpty=t.throttleTime=t.throttle=t.tap=t.takeWhile=t.takeUntil=t.takeLast=t.take=t.switchScan=t.switchMapTo=t.switchMap=t.switchAll=t.subscribeOn=t.startWith=t.skipWhile=t.skipUntil=t.skipLast=t.skip=t.single=t.shareReplay=t.share=t.sequenceEqual=t.scan=t.sampleTime=t.sample=t.refCount=t.retryWhen=t.retry=t.repeatWhen=t.repeat=t.reduce=t.raceWith=t.race=t.publishReplay=t.publishLast=t.publishBehavior=t.publish=t.pluck=t.partition=t.pairwise=t.onErrorResumeNext=t.observeOn=t.multicast=t.min=t.mergeWith=t.mergeScan=t.mergeMapTo=t.mergeMap=t.flatMap=void 0,t.zipWith=t.zipAll=t.zip=t.withLatestFrom=t.windowWhen=t.windowToggle=t.windowTime=t.windowCount=t.window=t.toArray=t.timestamp=t.timeoutWith=t.timeout=void 0;var r=n(53179);Object.defineProperty(t,"audit",{enumerable:!0,get:function(){return r.audit}});var i=n(90086);Object.defineProperty(t,"auditTime",{enumerable:!0,get:function(){return i.auditTime}});var o=n(62934);Object.defineProperty(t,"buffer",{enumerable:!0,get:function(){return o.buffer}});var a=n(39777);Object.defineProperty(t,"bufferCount",{enumerable:!0,get:function(){return a.bufferCount}});var s=n(40871);Object.defineProperty(t,"bufferTime",{enumerable:!0,get:function(){return s.bufferTime}});var u=n(95484);Object.defineProperty(t,"bufferToggle",{enumerable:!0,get:function(){return u.bufferToggle}});var c=n(37806);Object.defineProperty(t,"bufferWhen",{enumerable:!0,get:function(){return c.bufferWhen}});var l=n(39557);Object.defineProperty(t,"catchError",{enumerable:!0,get:function(){return l.catchError}});var d=n(19889);Object.defineProperty(t,"combineAll",{enumerable:!0,get:function(){return d.combineAll}});var f=n(53082);Object.defineProperty(t,"combineLatestAll",{enumerable:!0,get:function(){return f.combineLatestAll}});var p=n(960);Object.defineProperty(t,"combineLatest",{enumerable:!0,get:function(){return p.combineLatest}});var h=n(41115);Object.defineProperty(t,"combineLatestWith",{enumerable:!0,get:function(){return h.combineLatestWith}});var v=n(45317);Object.defineProperty(t,"concat",{enumerable:!0,get:function(){return v.concat}});var m=n(79966);Object.defineProperty(t,"concatAll",{enumerable:!0,get:function(){return m.concatAll}});var y=n(95458);Object.defineProperty(t,"concatMap",{enumerable:!0,get:function(){return y.concatMap}});var g=n(81576);Object.defineProperty(t,"concatMapTo",{enumerable:!0,get:function(){return g.concatMapTo}});var b=n(2787);Object.defineProperty(t,"concatWith",{enumerable:!0,get:function(){return b.concatWith}});var x=n(18710);Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return x.connect}});var _=n(53612);Object.defineProperty(t,"count",{enumerable:!0,get:function(){return _.count}});var w=n(29646);Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return w.debounce}});var M=n(58785);Object.defineProperty(t,"debounceTime",{enumerable:!0,get:function(){return M.debounceTime}});var S=n(15660);Object.defineProperty(t,"defaultIfEmpty",{enumerable:!0,get:function(){return S.defaultIfEmpty}});var T=n(10410);Object.defineProperty(t,"delay",{enumerable:!0,get:function(){return T.delay}});var E=n(89086);Object.defineProperty(t,"delayWhen",{enumerable:!0,get:function(){return E.delayWhen}});var k=n(48925);Object.defineProperty(t,"dematerialize",{enumerable:!0,get:function(){return k.dematerialize}});var A=n(6897);Object.defineProperty(t,"distinct",{enumerable:!0,get:function(){return A.distinct}});var P=n(62951);Object.defineProperty(t,"distinctUntilChanged",{enumerable:!0,get:function(){return P.distinctUntilChanged}});var C=n(51628);Object.defineProperty(t,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return C.distinctUntilKeyChanged}});var O=n(68359);Object.defineProperty(t,"elementAt",{enumerable:!0,get:function(){return O.elementAt}});var I=n(21423);Object.defineProperty(t,"endWith",{enumerable:!0,get:function(){return I.endWith}});var R=n(98543);Object.defineProperty(t,"every",{enumerable:!0,get:function(){return R.every}});var N=n(86630);Object.defineProperty(t,"exhaust",{enumerable:!0,get:function(){return N.exhaust}});var D=n(50828);Object.defineProperty(t,"exhaustAll",{enumerable:!0,get:function(){return D.exhaustAll}});var L=n(76759);Object.defineProperty(t,"exhaustMap",{enumerable:!0,get:function(){return L.exhaustMap}});var B=n(45973);Object.defineProperty(t,"expand",{enumerable:!0,get:function(){return B.expand}});var F=n(22884);Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return F.filter}});var j=n(90225);Object.defineProperty(t,"finalize",{enumerable:!0,get:function(){return j.finalize}});var z=n(62017);Object.defineProperty(t,"find",{enumerable:!0,get:function(){return z.find}});var U=n(44501);Object.defineProperty(t,"findIndex",{enumerable:!0,get:function(){return U.findIndex}});var G=n(44872);Object.defineProperty(t,"first",{enumerable:!0,get:function(){return G.first}});var V=n(71372);Object.defineProperty(t,"groupBy",{enumerable:!0,get:function(){return V.groupBy}});var W=n(51268);Object.defineProperty(t,"ignoreElements",{enumerable:!0,get:function(){return W.ignoreElements}});var H=n(3423);Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return H.isEmpty}});var Z=n(41836);Object.defineProperty(t,"last",{enumerable:!0,get:function(){return Z.last}});var q=n(46065);Object.defineProperty(t,"map",{enumerable:!0,get:function(){return q.map}});var Y=n(65250);Object.defineProperty(t,"mapTo",{enumerable:!0,get:function(){return Y.mapTo}});var X=n(32906);Object.defineProperty(t,"materialize",{enumerable:!0,get:function(){return X.materialize}});var K=n(43326);Object.defineProperty(t,"max",{enumerable:!0,get:function(){return K.max}});var J=n(18414);Object.defineProperty(t,"merge",{enumerable:!0,get:function(){return J.merge}});var Q=n(79057);Object.defineProperty(t,"mergeAll",{enumerable:!0,get:function(){return Q.mergeAll}});var $=n(26795);Object.defineProperty(t,"flatMap",{enumerable:!0,get:function(){return $.flatMap}});var ee=n(10987);Object.defineProperty(t,"mergeMap",{enumerable:!0,get:function(){return ee.mergeMap}});var te=n(75315);Object.defineProperty(t,"mergeMapTo",{enumerable:!0,get:function(){return te.mergeMapTo}});var ne=n(76230);Object.defineProperty(t,"mergeScan",{enumerable:!0,get:function(){return ne.mergeScan}});var re=n(79524);Object.defineProperty(t,"mergeWith",{enumerable:!0,get:function(){return re.mergeWith}});var ie=n(14610);Object.defineProperty(t,"min",{enumerable:!0,get:function(){return ie.min}});var oe=n(59163);Object.defineProperty(t,"multicast",{enumerable:!0,get:function(){return oe.multicast}});var ae=n(7587);Object.defineProperty(t,"observeOn",{enumerable:!0,get:function(){return ae.observeOn}});var se=n(67962);Object.defineProperty(t,"onErrorResumeNext",{enumerable:!0,get:function(){return se.onErrorResumeNext}});var ue=n(17778);Object.defineProperty(t,"pairwise",{enumerable:!0,get:function(){return ue.pairwise}});var ce=n(58629);Object.defineProperty(t,"partition",{enumerable:!0,get:function(){return ce.partition}});var le=n(20271);Object.defineProperty(t,"pluck",{enumerable:!0,get:function(){return le.pluck}});var de=n(69859);Object.defineProperty(t,"publish",{enumerable:!0,get:function(){return de.publish}});var fe=n(15535);Object.defineProperty(t,"publishBehavior",{enumerable:!0,get:function(){return fe.publishBehavior}});var pe=n(847);Object.defineProperty(t,"publishLast",{enumerable:!0,get:function(){return pe.publishLast}});var he=n(84763);Object.defineProperty(t,"publishReplay",{enumerable:!0,get:function(){return he.publishReplay}});var ve=n(67189);Object.defineProperty(t,"race",{enumerable:!0,get:function(){return ve.race}});var me=n(76711);Object.defineProperty(t,"raceWith",{enumerable:!0,get:function(){return me.raceWith}});var ye=n(59439);Object.defineProperty(t,"reduce",{enumerable:!0,get:function(){return ye.reduce}});var ge=n(25180);Object.defineProperty(t,"repeat",{enumerable:!0,get:function(){return ge.repeat}});var be=n(38586);Object.defineProperty(t,"repeatWhen",{enumerable:!0,get:function(){return be.repeatWhen}});var xe=n(12736);Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return xe.retry}});var _e=n(40146);Object.defineProperty(t,"retryWhen",{enumerable:!0,get:function(){return _e.retryWhen}});var we=n(91766);Object.defineProperty(t,"refCount",{enumerable:!0,get:function(){return we.refCount}});var Me=n(61637);Object.defineProperty(t,"sample",{enumerable:!0,get:function(){return Me.sample}});var Se=n(71114);Object.defineProperty(t,"sampleTime",{enumerable:!0,get:function(){return Se.sampleTime}});var Te=n(36189);Object.defineProperty(t,"scan",{enumerable:!0,get:function(){return Te.scan}});var Ee=n(11918);Object.defineProperty(t,"sequenceEqual",{enumerable:!0,get:function(){return Ee.sequenceEqual}});var ke=n(65720);Object.defineProperty(t,"share",{enumerable:!0,get:function(){return ke.share}});var Ae=n(3532);Object.defineProperty(t,"shareReplay",{enumerable:!0,get:function(){return Ae.shareReplay}});var Pe=n(72293);Object.defineProperty(t,"single",{enumerable:!0,get:function(){return Pe.single}});var Ce=n(46810);Object.defineProperty(t,"skip",{enumerable:!0,get:function(){return Ce.skip}});var Oe=n(49755);Object.defineProperty(t,"skipLast",{enumerable:!0,get:function(){return Oe.skipLast}});var Ie=n(55571);Object.defineProperty(t,"skipUntil",{enumerable:!0,get:function(){return Ie.skipUntil}});var Re=n(15470);Object.defineProperty(t,"skipWhile",{enumerable:!0,get:function(){return Re.skipWhile}});var Ne=n(84747);Object.defineProperty(t,"startWith",{enumerable:!0,get:function(){return Ne.startWith}});var De=n(14596);Object.defineProperty(t,"subscribeOn",{enumerable:!0,get:function(){return De.subscribeOn}});var Le=n(35224);Object.defineProperty(t,"switchAll",{enumerable:!0,get:function(){return Le.switchAll}});var Be=n(44317);Object.defineProperty(t,"switchMap",{enumerable:!0,get:function(){return Be.switchMap}});var Fe=n(55334);Object.defineProperty(t,"switchMapTo",{enumerable:!0,get:function(){return Fe.switchMapTo}});var je=n(51174);Object.defineProperty(t,"switchScan",{enumerable:!0,get:function(){return je.switchScan}});var ze=n(45088);Object.defineProperty(t,"take",{enumerable:!0,get:function(){return ze.take}});var Ue=n(33619);Object.defineProperty(t,"takeLast",{enumerable:!0,get:function(){return Ue.takeLast}});var Ge=n(58849);Object.defineProperty(t,"takeUntil",{enumerable:!0,get:function(){return Ge.takeUntil}});var Ve=n(50152);Object.defineProperty(t,"takeWhile",{enumerable:!0,get:function(){return Ve.takeWhile}});var We=n(69774);Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return We.tap}});var He=n(23466);Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return He.throttle}});var Ze=n(12083);Object.defineProperty(t,"throttleTime",{enumerable:!0,get:function(){return Ze.throttleTime}});var qe=n(15066);Object.defineProperty(t,"throwIfEmpty",{enumerable:!0,get:function(){return qe.throwIfEmpty}});var Ye=n(10493);Object.defineProperty(t,"timeInterval",{enumerable:!0,get:function(){return Ye.timeInterval}});var Xe=n(73687);Object.defineProperty(t,"timeout",{enumerable:!0,get:function(){return Xe.timeout}});var Ke=n(18711);Object.defineProperty(t,"timeoutWith",{enumerable:!0,get:function(){return Ke.timeoutWith}});var Je=n(47716);Object.defineProperty(t,"timestamp",{enumerable:!0,get:function(){return Je.timestamp}});var Qe=n(24090);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return Qe.toArray}});var $e=n(74080);Object.defineProperty(t,"window",{enumerable:!0,get:function(){return $e.window}});var et=n(16298);Object.defineProperty(t,"windowCount",{enumerable:!0,get:function(){return et.windowCount}});var tt=n(34418);Object.defineProperty(t,"windowTime",{enumerable:!0,get:function(){return tt.windowTime}});var nt=n(85489);Object.defineProperty(t,"windowToggle",{enumerable:!0,get:function(){return nt.windowToggle}});var rt=n(86003);Object.defineProperty(t,"windowWhen",{enumerable:!0,get:function(){return rt.windowWhen}});var it=n(39167);Object.defineProperty(t,"withLatestFrom",{enumerable:!0,get:function(){return it.withLatestFrom}});var ot=n(40949);Object.defineProperty(t,"zip",{enumerable:!0,get:function(){return ot.zip}});var at=n(64325);Object.defineProperty(t,"zipAll",{enumerable:!0,get:function(){return at.zipAll}});var st=n(26397);Object.defineProperty(t,"zipWith",{enumerable:!0,get:function(){return st.zipWith}})},50573:function(e,t,n){"use strict";var r=n(49749),i=n(49685),o=n(53342),a=r("%TypeError%"),s=r("%WeakMap%",!0),u=r("%Map%",!0),c=i("WeakMap.prototype.get",!0),l=i("WeakMap.prototype.set",!0),d=i("WeakMap.prototype.has",!0),f=i("Map.prototype.get",!0),p=i("Map.prototype.set",!0),h=i("Map.prototype.has",!0),v=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n};e.exports=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new a("Side channel does not contain "+o(e))},get:function(r){if(s&&r&&("object"==typeof r||"function"==typeof r)){if(e)return c(e,r)}else if(u){if(t)return f(t,r)}else if(n)return function(e,t){var n=v(e,t);return n&&n.value}(n,r)},has:function(r){if(s&&r&&("object"==typeof r||"function"==typeof r)){if(e)return d(e,r)}else if(u){if(t)return h(t,r)}else if(n)return function(e,t){return!!v(e,t)}(n,r);return!1},set:function(r,i){s&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new s),l(e,r,i)):u?(t||(t=new u),p(t,r,i)):(n||(n={key:{},next:null}),function(e,t,n){var r=v(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,i))}};return r}},98974:function(e){"use strict";e.exports={eudist:function(e,t){for(var n=e.length,r=0,i=0;i<n;i++){var o=(e[i]||0)-(t[i]||0);r+=o*o}return r},mandist:function(e,t){for(var n=e.length,r=0,i=0,o=0;o<n;o++)r+=(i=(e[o]||0)-(t[o]||0))>=0?i:-i;return r},dist:function(e,t,n){var r=Math.abs(e-t);return n?r:r*r}}},2286:function(e,t,n){"use strict";var r=n(98974),i=r.eudist,o=r.dist;e.exports={kmrand:function(e,t){for(var n={},r=[],i=t<<2,o=e.length,a=e[0].length>0;r.length<t&&i-- >0;){var s=e[Math.floor(Math.random()*o)],u=a?s.join("_"):"".concat(s);n[u]||(n[u]=!0,r.push(s))}if(r.length<t)throw new Error("Error initializating clusters");return r},kmpp:function(e,t,n){var r=n||(e[0].length?i:o),a=[],s=e.length,u=e[0].length>0,c=e[Math.floor(Math.random()*s)];for(u?c.join("_"):"".concat(c),a.push(c);a.length<t;){for(var l=[],d=a.length,f=0,p=[],h=0;h<s;h++){for(var v=1/0,m=0;m<d;m++){var y=r(e[h],a[m]);y<=v&&(v=y)}l[h]=v}for(var g=0;g<s;g++)f+=l[g];for(var b=0;b<s;b++)p[b]={i:b,v:e[b],pr:l[b]/f,cs:0};p.sort((function(e,t){return e.pr-t.pr})),p[0].cs=p[0].pr;for(var x=1;x<s;x++)p[x].cs=p[x-1].cs+p[x].pr;for(var _=Math.random(),w=0;w<s-1&&p[w++].cs<_;);a.push(p[w-1].v)}return a}}},18187:function(e,t,n){"use strict";var r=n(98974),i=n(2286),o=r.eudist,a=(r.mandist,r.dist,i.kmrand),s=i.kmpp;function u(e,t,n){n=n||[];for(var r=0;r<e;r++)n[r]=t;return n}function c(e,t){for(var n=Array.isArray(e),r=this.centroids,i=r.length,a=1/0,s=0,u=0;u<i;u++){var c=t?t(e,r[u]):n?o(e,r[u]):Math.abs(e-r[u]);c<=a&&(a=c,s=u)}return{idx:s,centroid:r[s]}}e.exports=function(e,t,n,r,i){var l=[],d=[],f=[],p=[],h=!1,v=r||1e4,m=e.length,y=e[0].length,g=y>0,b=[];if(n)l="kmrand"==n?a(e,t):"kmpp"==n?s(e,t,i):n;else for(var x={},_=0;l.length<t;){var w=Math.floor(Math.random()*m);x[w]||(x[w]=!0,l[_++]=e[w])}do{u(t,0,b);for(var M=0;M<m;M++){for(var S=1/0,T=0,E=0;E<t;E++)(p=i?i(e[M],l[E]):g?o(e[M],l[E]):Math.abs(e[M]-l[E]))<=S&&(S=p,T=E);f[M]=T,b[T]++}var k=[];if(d=[],g)for(var A=0;A<t;A++)k[A]=u(y,0,k[A]),d[A]=l[A];else for(var P=0;P<t;P++)k[P]=0,d[P]=l[P];if(g){for(var C=0;C<t;C++)l[C]=[];for(var O=0;O<m;O++)for(var I=k[f[O]],R=e[O],N=0;N<y;N++)I[N]+=R[N];h=!0;for(var D=0;D<t;D++){for(var L=l[D],B=k[D],F=d[D],j=b[D],z=0;z<y;z++)L[z]=B[z]/j||0;if(h)for(var U=0;U<y;U++)if(F[U]!=L[U]){h=!1;break}}}else{for(var G=0;G<m;G++)k[f[G]]+=e[G];for(var V=0;V<t;V++)l[V]=k[V]/b[V]||0;h=!0;for(var W=0;W<t;W++)if(d[W]!=l[W]){h=!1;break}}h=h||--v<=0}while(!h);return{it:(r||1e4)-v,k:t,idxs:f,centroids:l,test:c}}},28130:function(e,t,n){var r;e=n.nmd(e),function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof n.g&&n.g;o.global!==o&&o.window!==o&&o.self;var a,s=2147483647,u=36,c=/^xn--/,l=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,h=String.fromCharCode;function v(e){throw RangeError(f[e])}function m(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function y(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+m((e=e.replace(d,".")).split("."),t).join(".")}function g(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function b(e){return m(e,(function(e){var t="";return e>65535&&(t+=h((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+h(e)})).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function _(e,t,n){var r=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;r+=u)e=p(e/35);return p(r+36*e/(e+38))}function w(e){var t,n,r,i,o,a,c,l,d,f,h,m=[],y=e.length,g=0,x=128,w=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&v("not-basic"),m.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<y;){for(o=g,a=1,c=u;i>=y&&v("invalid-input"),((l=(h=e.charCodeAt(i++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:u)>=u||l>p((s-g)/a))&&v("overflow"),g+=l*a,!(l<(d=c<=w?1:c>=w+26?26:c-w));c+=u)a>p(s/(f=u-d))&&v("overflow"),a*=f;w=_(g-o,t=m.length+1,0==o),p(g/t)>s-x&&v("overflow"),x+=p(g/t),g%=t,m.splice(g++,0,x)}return b(m)}function M(e){var t,n,r,i,o,a,c,l,d,f,m,y,b,w,M,S=[];for(y=(e=g(e)).length,t=128,n=0,o=72,a=0;a<y;++a)(m=e[a])<128&&S.push(h(m));for(r=i=S.length,i&&S.push("-");r<y;){for(c=s,a=0;a<y;++a)(m=e[a])>=t&&m<c&&(c=m);for(c-t>p((s-n)/(b=r+1))&&v("overflow"),n+=(c-t)*b,t=c,a=0;a<y;++a)if((m=e[a])<t&&++n>s&&v("overflow"),m==t){for(l=n,d=u;!(l<(f=d<=o?1:d>=o+26?26:d-o));d+=u)M=l-f,w=u-f,S.push(h(x(f+M%w,0))),l=p(M/w);S.push(h(x(l,0))),o=_(n,b,r==i),n=0,++r}++n,++t}return S.join("")}a={version:"1.3.2",ucs2:{decode:g,encode:b},decode:w,encode:M,toASCII:function(e){return y(e,(function(e){return l.test(e)?"xn--"+M(e):e}))},toUnicode:function(e){return y(e,(function(e){return c.test(e)?w(e.slice(4).toLowerCase()):e}))}},void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},5796:function(e,t,n){"use strict";var r=n(28130),i=n(82849);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){return i.isString(e)&&(e=b(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(70969);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(s);if(b=b.trim(),!n&&1===e.split("#").length){var x=u.exec(b);if(x)return this.path=b,this.href=b,this.pathname=x[1],x[2]?(this.search=x[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var _=a.exec(b);if(_){var w=(_=_[0]).toLowerCase();this.protocol=w,b=b.substr(_.length)}if(n||_||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var M="//"===b.substr(0,2);!M||_&&m[_]||(b=b.substr(2),this.slashes=!0)}if(!m[_]&&(M||_&&!y[_])){for(var S,T,E=-1,k=0;k<f.length;k++)-1!==(A=b.indexOf(f[k]))&&(-1===E||A<E)&&(E=A);for(-1!==(T=-1===E?b.lastIndexOf("@"):b.lastIndexOf("@",E))&&(S=b.slice(0,T),b=b.slice(T+1),this.auth=decodeURIComponent(S)),E=-1,k=0;k<d.length;k++){var A;-1!==(A=b.indexOf(d[k]))&&(-1===E||A<E)&&(E=A)}-1===E&&(E=b.length),this.host=b.slice(0,E),b=b.slice(E),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var C=this.hostname.split(/\./),O=(k=0,C.length);k<O;k++){var I=C[k];if(I&&!I.match(p)){for(var R="",N=0,D=I.length;N<D;N++)I.charCodeAt(N)>127?R+="x":R+=I[N];if(!R.match(p)){var L=C.slice(0,k),B=C.slice(k+1),F=I.match(h);F&&(L.push(F[1]),B.unshift(F[2])),B.length&&(b="/"+B.join(".")+b),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var j=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+j,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!v[w])for(k=0,O=l.length;k<O;k++){var U=l[k];if(-1!==b.indexOf(U)){var G=encodeURIComponent(U);G===U&&(G=escape(U)),b=b.split(U).join(G)}}var V=b.indexOf("#");-1!==V&&(this.hash=b.substr(V),b=b.slice(0,V));var W=b.indexOf("?");if(-1!==W?(this.search=b.substr(W),this.query=b.substr(W+1),t&&(this.query=g.parse(this.query)),b=b.slice(0,W)):t&&(this.search="",this.query={}),b&&(this.pathname=b),y[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var H=this.search||"";this.path=j+H}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=g.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||y[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),a=0;a<r.length;a++){var s=r[a];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=e[l])}return y[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!y[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var p=d[f];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||m[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var v=n.pathname||"",g=n.search||"";n.path=v+g}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),x=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=x||b||n.host&&e.pathname,w=_,M=n.pathname&&n.pathname.split("/")||[],S=(h=e.pathname&&e.pathname.split("/")||[],n.protocol&&!y[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===M[0]?M[0]=n.host:M.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),_=_&&(""===h[0]||""===M[0])),x)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,M=h;else if(h.length)M||(M=[]),M.pop(),M=M.concat(h),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search))return S&&(n.hostname=n.host=M.shift(),(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift())),n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!M.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=M.slice(-1)[0],E=(n.host||e.host||M.length>1)&&("."===T||".."===T)||""===T,k=0,A=M.length;A>=0;A--)"."===(T=M[A])?M.splice(A,1):".."===T?(M.splice(A,1),k++):k&&(M.splice(A,1),k--);if(!_&&!w)for(;k--;k)M.unshift("..");!_||""===M[0]||M[0]&&"/"===M[0].charAt(0)||M.unshift(""),E&&"/"!==M.join("/").substr(-1)&&M.push("");var P,C=""===M[0]||M[0]&&"/"===M[0].charAt(0);return S&&(n.hostname=n.host=C?"":M.length?M.shift():"",(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift())),(_=_||n.host&&M.length)&&!C&&M.unshift(""),M.length?n.pathname=M.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},82849:function(e){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},91036:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(5954);function i(e,t,n){var i=this;void 0===n&&(n={leading:!1,trailing:!0});var o=(0,r.useRef)(void 0),a=(0,r.useRef)(0),s=(0,r.useRef)(void 0),u=(0,r.useRef)([]),c=(0,r.useRef)(null),l=(0,r.useRef)(null),d=(0,r.useRef)(e),f=(0,r.useRef)(!0);d.current=e;var p=!t&&0!==t&&"undefined"!=typeof window&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");t=Number(t)||0;var h=!!n.leading,v=!("trailing"in n)||!!n.trailing,m="maxWait"in n,y=m?Math.max(Number(n.maxWait)||0,t):void 0,g=(0,r.useCallback)((function(e){var t=u.current,n=c.current;return u.current=c.current=void 0,a.current=e,l.current=d.current.apply(n,t),l.current}),[]),b=(0,r.useCallback)((function(e,t){return p?(window.cancelAnimationFrame(s.current),window.requestAnimationFrame(e)):setTimeout(e,t)}),[p]),x=(0,r.useCallback)((function(e){if(p)return window.cancelAnimationFrame(e);clearTimeout(e)}),[p]),_=(0,r.useCallback)((function(e){var n=e-o.current,r=e-a.current,i=t-n;return m?Math.min(i,y-r):i}),[y,m,t]),w=(0,r.useCallback)((function(e){if(!f.current)return!1;var n=e-o.current,r=e-a.current;return void 0===o.current||n>=t||n<0||m&&r>=y}),[y,m,t]),M=(0,r.useCallback)((function(e){return s.current=void 0,v&&u.current?g(e):(u.current=c.current=void 0,l.current)}),[g,v]),S=(0,r.useCallback)((function(){var e=Date.now();if(w(e))return M(e);s.current=b(S,_(e))}),[_,w,b,M]),T=(0,r.useCallback)((function(e){return a.current=e,s.current=b(S,t),h?g(e):l.current}),[g,b,h,S,t]),E=(0,r.useCallback)((function(){void 0!==s.current&&x(s.current),a.current=0,u.current=o.current=c.current=s.current=void 0}),[x]),k=(0,r.useCallback)((function(){return void 0===s.current?l.current:M(Date.now())}),[M]);(0,r.useEffect)((function(){return f.current=!0,function(){f.current=!1}}),[]);var A=(0,r.useCallback)((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Date.now(),a=w(r);if(u.current=e,c.current=i,o.current=r,a){if(void 0===s.current&&f.current)return T(o.current);if(m)return s.current=b(S,t),g(o.current)}return void 0===s.current&&(s.current=b(S,t)),l.current}),[g,T,m,w,b,S,t]);return[A,E,k]}},3601:function(e,t,n){"use strict";var r=n(71e3),i=n(69193),o=n(33684),a=n(48623),s=n(21338);e.exports=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e?null:r(e)?"String":i(e)?"Number":o(e)?"Boolean":a(e)?"Symbol":s(e)?"BigInt":void 0}},13873:function(e,t,n){"use strict";var r=n(20551),i=n(47781),o=n(49685),a=o("Object.prototype.toString"),s=n(56573)(),u="undefined"==typeof globalThis?n.g:globalThis,c=i(),l=o("String.prototype.slice"),d={},f=n(66853),p=Object.getPrototypeOf;s&&f&&p&&r(c,(function(e){if("function"==typeof u[e]){var t=new u[e];if(Symbol.toStringTag in t){var n=p(t),r=f(n,Symbol.toStringTag);if(!r){var i=p(n);r=f(i,Symbol.toStringTag)}d[e]=r.get}}}));var h=n(69757);e.exports=function(e){return!!h(e)&&(s&&Symbol.toStringTag in e?function(e){var t=!1;return r(d,(function(n,r){if(!t)try{var i=n.call(e);i===r&&(t=i)}catch(e){}})),t}(e):l(a(e),8,-1))}},47781:function(e,t,n){"use strict";var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],i="undefined"==typeof globalThis?n.g:globalThis;e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof i[r[t]]&&(e[e.length]=r[t]);return e}},66853:function(e,t,n){"use strict";var r=n(49749)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},72755:function(e,t,n){"use strict";var r=n(85614);if(n(85424)()||n(42502)()){var i=Symbol.iterator;e.exports=function(e){return null!=e&&void 0!==e[i]?e[i]():r(e)?Array.prototype[i].call(e):void 0}}else{var o=n(12816),a=n(71e3),s=n(49749),u=s("%Map%",!0),c=s("%Set%",!0),l=n(49685),d=l("Array.prototype.push"),f=l("String.prototype.charCodeAt"),p=l("String.prototype.slice"),h=function(e){var t=0;return{next:function(){var n,r=t>=e.length;return r||(n=e[t],t+=1),{done:r,value:n}}}},v=function(e,t){if(o(e)||r(e))return h(e);if(a(e)){var n=0;return{next:function(){var t=function(e,t){if(t+1>=e.length)return t+1;var n=f(e,t);if(n<55296||n>56319)return t+1;var r=f(e,t+1);return r<56320||r>57343?t+1:t+2}(e,n),r=p(e,n,t);return n=t,{done:t>e.length,value:r}}}}return t&&void 0!==e["_es6-shim iterator_"]?e["_es6-shim iterator_"]():void 0};if(u||c){var m=n(26257),y=n(12535),g=l("Map.prototype.forEach",!0),b=l("Set.prototype.forEach",!0);if("undefined"==typeof process||!process.versions||!process.versions.node)var x=l("Map.prototype.iterator",!0),_=l("Set.prototype.iterator",!0),w=function(e){var t=!1;return{next:function(){try{return{done:t,value:t?void 0:e.next()}}catch(e){return t=!0,{done:!0,value:void 0}}}}};var M=l("Map.prototype.@@iterator",!0)||l("Map.prototype._es6-shim iterator_",!0),S=l("Set.prototype.@@iterator",!0)||l("Set.prototype._es6-shim iterator_",!0);e.exports=function(e){return function(e){if(m(e)){if(x)return w(x(e));if(M)return M(e);if(g){var t=[];return g(e,(function(e,n){d(t,[n,e])})),h(t)}}if(y(e)){if(_)return w(_(e));if(S)return S(e);if(b){var n=[];return b(e,(function(e){d(n,e)})),h(n)}}}(e)||v(e)}}else e.exports=function(e){if(null!=e)return v(e,!0)}}},68885:function(e,t,n){"use strict";var r=n(26257),i=n(12535),o=n(456),a=n(77581);e.exports=function(e){if(e&&"object"==typeof e){if(r(e))return"Map";if(i(e))return"Set";if(o(e))return"WeakMap";if(a(e))return"WeakSet"}return!1}},37762:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(40181);function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}},20867:function(e,t,n){"use strict";n.r(t),n.d(t,{createEndpoint:function(){return d},expose:function(){return m},proxy:function(){return S},proxyMarker:function(){return l},releaseProxy:function(){return f},transfer:function(){return M},transferHandlers:function(){return v},windowEndpoint:function(){return T},wrap:function(){return g}});var r=n(37762),i=n(29439),o=n(4942),a=n(89611),s=n(78814);function u(e,t,n){return u=(0,s.Z)()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&(0,a.Z)(i,n.prototype),i},u.apply(null,arguments)}var c=n(93433),l=Symbol("Comlink.proxy"),d=Symbol("Comlink.endpoint"),f=Symbol("Comlink.releaseProxy"),p=Symbol("Comlink.thrown"),h=function(e){return"object"==typeof e&&null!==e||"function"==typeof e},v=new Map([["proxy",{canHandle:function(e){return h(e)&&e[l]},serialize:function(e){var t=new MessageChannel,n=t.port1,r=t.port2;return m(e,n),[r,[r]]},deserialize:function(e){return e.start(),g(e)}}],["throw",{canHandle:function(e){return h(e)&&p in e},serialize:function(e){var t=e.value;return[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]]},deserialize:function(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;t.addEventListener("message",(function n(r){if(r&&r.data){var a,s=Object.assign({path:[]},r.data),l=s.id,d=s.type,f=s.path,h=(r.data.argumentList||[]).map(k);try{var v=f.slice(0,-1).reduce((function(e,t){return e[t]}),e),g=f.reduce((function(e,t){return e[t]}),e);switch(d){case"GET":a=g;break;case"SET":v[f.slice(-1)[0]]=k(r.data.value),a=!0;break;case"APPLY":a=g.apply(v,h);break;case"CONSTRUCT":var b;a=S(u(g,(0,c.Z)(h)));break;case"ENDPOINT":var x=new MessageChannel,_=x.port1,w=x.port2;m(e,w),a=M(_,[_]);break;case"RELEASE":a=void 0;break;default:return}}catch(b){a=(0,o.Z)({value:b},p,0)}Promise.resolve(a).catch((function(e){return(0,o.Z)({value:e},p,0)})).then((function(e){var r=E(e),o=(0,i.Z)(r,2),a=o[0],s=o[1];t.postMessage(Object.assign(Object.assign({},a),{id:l}),s),"RELEASE"===d&&(t.removeEventListener("message",n),y(t))}))}})),t.start&&t.start()}function y(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function g(e,t){return x(e,[],t)}function b(e){if(e)throw new Error("Proxy has been released and is not useable")}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=!1,o=new Proxy(n,{get:function(n,i){if(b(r),i===f)return function(){return A(e,{type:"RELEASE",path:t.map((function(e){return e.toString()}))}).then((function(){y(e),r=!0}))};if("then"===i){if(0===t.length)return{then:function(){return o}};var a=A(e,{type:"GET",path:t.map((function(e){return e.toString()}))}).then(k);return a.then.bind(a)}return x(e,[].concat((0,c.Z)(t),[i]))},set:function(n,o,a){b(r);var s=E(a),u=(0,i.Z)(s,2),l=u[0],d=u[1];return A(e,{type:"SET",path:[].concat((0,c.Z)(t),[o]).map((function(e){return e.toString()})),value:l},d).then(k)},apply:function(n,o,a){b(r);var s=t[t.length-1];if(s===d)return A(e,{type:"ENDPOINT"}).then(k);if("bind"===s)return x(e,t.slice(0,-1));var u=_(a),c=(0,i.Z)(u,2),l=c[0],f=c[1];return A(e,{type:"APPLY",path:t.map((function(e){return e.toString()})),argumentList:l},f).then(k)},construct:function(n,o){b(r);var a=_(o),s=(0,i.Z)(a,2),u=s[0],c=s[1];return A(e,{type:"CONSTRUCT",path:t.map((function(e){return e.toString()})),argumentList:u},c).then(k)}});return o}function _(e){var t,n=e.map(E);return[n.map((function(e){return e[0]})),(t=n.map((function(e){return e[1]})),Array.prototype.concat.apply([],t))]}var w=new WeakMap;function M(e,t){return w.set(e,t),e}function S(e){return Object.assign(e,(0,o.Z)({},l,!0))}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return{postMessage:function(t,r){return e.postMessage(t,n,r)},addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function E(e){var t,n=(0,r.Z)(v);try{for(n.s();!(t=n.n()).done;){var o=(0,i.Z)(t.value,2),a=o[0],s=o[1];if(s.canHandle(e)){var u=s.serialize(e),c=(0,i.Z)(u,2);return[{type:"HANDLER",name:a,value:c[0]},c[1]]}}}catch(e){n.e(e)}finally{n.f()}return[{type:"RAW",value:e},w.get(e)||[]]}function k(e){switch(e.type){case"HANDLER":return v.get(e.name).deserialize(e.value);case"RAW":return e.value}}function A(e,t,n){return new Promise((function(r){var i=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}}}]);
//# sourceMappingURL=498.057881bc.chunk.js.map