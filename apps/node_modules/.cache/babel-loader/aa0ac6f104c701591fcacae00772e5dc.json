{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useInfiniteQuery } from '@tanstack/react-query';\nimport { useSDK } from '@cognite/sdk-provider';\nimport { annotationsKey } from '../keys';\n/**\n * ## Example\n * ```typescript\n * const { data, fetchNextPage, hasNextPage } = useAnnotations({\n *   annotatedResourceType: 'file',\n *   annotatedResourceIds: [{ id: 522578475963356 }],\n * });\n * ```\n */\nexport const useAnnotations = (filter, limit = 25, options) => {\n  _s();\n  const sdk = useSDK();\n  return useInfiniteQuery(annotationsKey(`${filter.annotatedResourceType}-${filter.annotatedResourceIds}`), ({\n    pageParam\n  }) => sdk.post(`api/playground/projects/${sdk.project}/annotations/list`, {\n    data: {\n      cursor: pageParam,\n      limit,\n      filter\n    }\n  }).then(({\n    data\n  }) => {\n    return {\n      ...data,\n      items: data?.items\n    };\n  }), {\n    ...options,\n    getNextPageParam: lastPage => lastPage.nextCursor\n  });\n};\n_s(useAnnotations, \"d6A0fwr4GOP6j8hbc2RI8uLwBLI=\", false, function () {\n  return [useSDK, useInfiniteQuery];\n});","map":{"version":3,"names":["useInfiniteQuery","useSDK","annotationsKey","useAnnotations","filter","limit","options","sdk","annotatedResourceType","annotatedResourceIds","pageParam","post","project","data","cursor","then","items","getNextPageParam","lastPage","nextCursor"],"sources":["/Volumes/csvol/fusion/libs/shared/cdf-sdk-react-query-hooks/src/hooks/annotation.ts"],"sourcesContent":["import {\n  UseInfiniteQueryOptions,\n  useInfiniteQuery,\n} from '@tanstack/react-query';\n\nimport { IdEither } from '@cognite/sdk';\nimport { useSDK } from '@cognite/sdk-provider';\n\nimport { annotationsKey } from '../keys';\n\nexport type AnnotatedResourceType = 'file';\nexport type LinkedResourceType = 'file' | 'asset';\nexport type AnnotationStatus = 'suggested' | 'approved' | 'rejected';\nexport type AnnotationType =\n  | 'diagrams.AssetLink'\n  | 'diagrams.FileLink'\n  | 'diagrams.UnhandledTextObject'\n  | 'diagrams.UnhandledSymbolObject'\n  | 'diagrams.PipeSymbol'\n  | 'diagrams.Line'\n  | 'diagrams.Junction';\n\nexport type AnnotationBoundingBox = {\n  confidence: number | null;\n  xMax: number | null;\n  xMin: number | null;\n  yMax: number | null;\n  yMin: number | null;\n};\n\nexport type AnnotationPoint = {\n  confidence: number | null;\n  x: number | null;\n  y: number | null;\n};\n\nexport type AnnotationPolyLine = {\n  vertices: AnnotationPoint[] | null;\n};\n\nexport type AssetLinkDiagram = {\n  annotationType: 'diagrams.AssetLink';\n  data: {\n    assetRef: {\n      id: number | null;\n      externalId: string | null;\n    };\n    pageNumber: number | null;\n    symbol: string | null;\n    symbolRegion: AnnotationBoundingBox | null;\n    text: string | null;\n    textRegion: AnnotationBoundingBox;\n  };\n};\n\nexport type FileLinkDiagram = {\n  annotationType: 'diagrams.FileLink';\n  data: {\n    fileRef: {\n      id: number | null;\n      externalId: string | null;\n    };\n    pageNumber: number | null;\n    symbol: string | null;\n    symbolRegion: AnnotationBoundingBox | null;\n    text: string | null;\n    textRegion: AnnotationBoundingBox;\n  };\n};\n\nexport type UnhandledTextObjectDiagram = {\n  annotationType: 'diagrams.UnhandledTextObject';\n  data: {\n    pageNumber: number | null;\n    text: string;\n    textRegion: AnnotationBoundingBox;\n  };\n};\n\nexport type UnhandledSymbolObjectDiagram = {\n  annotationType: 'diagrams.UnhandledSymbolObject';\n  data: {\n    pageNumber: number | null;\n    symbol: string;\n    symbolRegion: AnnotationBoundingBox;\n  };\n};\n\nexport type PipeSymbolDiagram = {\n  annotationType: 'diagrams.PipeSymbol';\n  data: {\n    pageNumber: number | null;\n    polyline: AnnotationPolyLine;\n  };\n};\n\nexport type LineDiagram = {\n  annotationType: 'diagrams.Line';\n  data: {\n    pageNumber: number | null;\n    polyline: AnnotationPolyLine;\n  };\n};\n\nexport type JunctionDiagram = {\n  annotationType: 'diagrams.Junction';\n  data: {\n    pageNumber: number | null;\n    position: AnnotationPoint;\n  };\n};\n\nexport type AnnotationModel = {\n  id: number;\n  createdTime: Date;\n  lastUpdatedTime: Date;\n  annotatedResourceType: AnnotatedResourceType;\n  annotatedResourceId?: number;\n  annotatedResourceExternalId?: string;\n  creatingApp: string;\n  creatingAppVersion: string;\n  creatingUser: string | null;\n  linkedResourceType?: LinkedResourceType;\n  linkedResourceId?: number;\n  linkedResourceExternalId?: string;\n  status: AnnotationStatus;\n} & (\n  | AssetLinkDiagram\n  | FileLinkDiagram\n  | UnhandledTextObjectDiagram\n  | UnhandledSymbolObjectDiagram\n  | PipeSymbolDiagram\n  | LineDiagram\n  | JunctionDiagram\n);\n\nexport interface AnnotationFilterProps {\n  annotatedResourceType: AnnotatedResourceType;\n  annotatedResourceIds: IdEither[];\n  annotationType?: AnnotationType;\n  creatingApp?: string;\n  creatingUser?: string | null;\n  linkedResourceType?: LinkedResourceType;\n  linkedResourceIds?: IdEither[];\n  status?: AnnotationStatus;\n}\n\nexport type AnnotationsData = { items: AnnotationModel[]; nextCursor?: string };\n\n/**\n * ## Example\n * ```typescript\n * const { data, fetchNextPage, hasNextPage } = useAnnotations({\n *   annotatedResourceType: 'file',\n *   annotatedResourceIds: [{ id: 522578475963356 }],\n * });\n * ```\n */\nexport const useAnnotations = (\n  filter: AnnotationFilterProps,\n  limit: number = 25,\n  options?: UseInfiniteQueryOptions<AnnotationsData>\n) => {\n  const sdk = useSDK();\n\n  return useInfiniteQuery<AnnotationsData>(\n    annotationsKey(\n      `${filter.annotatedResourceType}-${filter.annotatedResourceIds}`\n    ),\n    ({ pageParam }) =>\n      sdk\n        .post<AnnotationsData>(\n          `api/playground/projects/${sdk.project}/annotations/list`,\n          {\n            data: {\n              cursor: pageParam,\n              limit,\n              filter,\n            },\n          }\n        )\n        .then(({ data }) => {\n          return {\n            ...data,\n            items: data?.items,\n          };\n        }),\n    {\n      ...options,\n      getNextPageParam: (lastPage) => lastPage.nextCursor,\n    }\n  );\n};\n"],"mappings":";AAAA,SAEEA,gBAAgB,QACX,uBAAuB;AAG9B,SAASC,MAAM,QAAQ,uBAAuB;AAE9C,SAASC,cAAc,QAAQ,SAAS;AA6IxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,cAAc,GAAG,CAC5BC,MAA6B,EAC7BC,KAAa,GAAG,EAAE,EAClBC,OAAkD,KAC/C;EAAA;EACH,MAAMC,GAAG,GAAGN,MAAM,EAAE;EAEpB,OAAOD,gBAAgB,CACrBE,cAAc,CACX,GAAEE,MAAM,CAACI,qBAAsB,IAAGJ,MAAM,CAACK,oBAAqB,EAAC,CACjE,EACD,CAAC;IAAEC;EAAU,CAAC,KACZH,GAAG,CACAI,IAAI,CACF,2BAA0BJ,GAAG,CAACK,OAAQ,mBAAkB,EACzD;IACEC,IAAI,EAAE;MACJC,MAAM,EAAEJ,SAAS;MACjBL,KAAK;MACLD;IACF;EACF,CAAC,CACF,CACAW,IAAI,CAAC,CAAC;IAAEF;EAAK,CAAC,KAAK;IAClB,OAAO;MACL,GAAGA,IAAI;MACPG,KAAK,EAAEH,IAAI,EAAEG;IACf,CAAC;EACH,CAAC,CAAC,EACN;IACE,GAAGV,OAAO;IACVW,gBAAgB,EAAGC,QAAQ,IAAKA,QAAQ,CAACC;EAC3C,CAAC,CACF;AACH,CAAC;AAAC,GAlCWhB,cAAc;EAAA,QAKbF,MAAM,EAEXD,gBAAgB;AAAA"},"metadata":{},"sourceType":"module"}