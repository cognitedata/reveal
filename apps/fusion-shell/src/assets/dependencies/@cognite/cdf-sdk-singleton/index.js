System.register([],(function(e,t){return{execute:function(){e((()=>{var e={8149:(e,t,r)=>{"use strict";function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}r.r(t),r.d(t,{Auth0Client:()=>te,AuthenticationError:()=>u,CacheKey:()=>C,GenericError:()=>d,InMemoryCache:()=>x,LocalStorageCache:()=>z,MfaRequiredError:()=>m,MissingRefreshTokenError:()=>f,PopupCancelledError:()=>p,PopupTimeoutError:()=>h,TimeoutError:()=>l,User:()=>ie,createAuth0Client:()=>X});var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e,t){return e(t={exports:{}},t.exports),t.exports}var a=s((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,r){var n=e.locked.get(t);void 0===n?void 0===r?e.locked.set(t,[]):e.locked.set(t,[r]):void 0!==r&&(n.unshift(r),e.locked.set(t,n))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(r,n){e.isLocked(t)?e.addToLocked(t,r):(e.addToLocked(t),r())}))},this.unlock=function(t){var r=e.locked.get(t);if(void 0!==r&&0!==r.length){var n=r.pop();e.locked.set(t,r),void 0!==n&&setTimeout(n,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return r.getInstance()}}));i(a);var c=i(s((function(e,t){var r=o&&o.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=o&&o.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i="browser-tabs-lock-key";function s(e){return new Promise((function(t){return setTimeout(t,e)}))}function c(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}var g=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+c(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,o){return void 0===o&&(o=5e3),r(this,void 0,void 0,(function(){var r,a,g,y,v,_;return n(this,(function(n){switch(n.label){case 0:r=Date.now()+c(4),a=Date.now()+o,g=i+"-"+t,y=window.localStorage,n.label=1;case 1:return Date.now()<a?[4,s(30)]:[3,8];case 2:return n.sent(),null!==y.getItem(g)?[3,5]:(v=this.id+"-"+t+"-"+r,[4,s(Math.floor(25*Math.random()))]);case 3:return n.sent(),y.setItem(g,JSON.stringify({id:this.id,iat:r,timeoutKey:v,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,s(30)];case 4:return n.sent(),null!==(_=y.getItem(g))&&(_=JSON.parse(_)).id===this.id&&_.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(g,r),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(a)];case 6:n.sent(),n.label=7;case 7:return r=Date.now()+c(4),[3,1];case 8:return[2,!1]}}))}))},e.prototype.refreshLockWhileAcquired=function(e,t){return r(this,void 0,void 0,(function(){var o=this;return n(this,(function(i){return setTimeout((function(){return r(o,void 0,void 0,(function(){var r,o;return n(this,(function(n){switch(n.label){case 0:return[4,a.default().lock(t)];case 1:return n.sent(),this.acquiredIatSet.has(t)?(r=window.localStorage,null===(o=r.getItem(e))?(a.default().unlock(t),[2]):((o=JSON.parse(o)).timeRefreshed=Date.now(),r.setItem(e,JSON.stringify(o)),a.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(a.default().unlock(t),[2])}}))}))}),1e3),[2]}))}))},e.prototype.waitForSomethingToChange=function(t){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){var n=!1,o=Date.now(),i=!1;function s(){if(i||(window.removeEventListener("storage",s),e.removeFromWaiting(s),clearTimeout(a),i=!0),!n){n=!0;var t=50-(Date.now()-o);t>0?setTimeout(r,t):r()}}window.addEventListener("storage",s),e.addToWaiting(s);var a=setTimeout(s,Math.max(0,t-Date.now()))}))];case 1:return r.sent(),[2]}}))}))},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter((function(e){return e!==t})))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach((function(e){return e()}))},e.prototype.releaseLock=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.releaseLock__private__=function(t){return r(this,void 0,void 0,(function(){var r,o,s;return n(this,(function(n){switch(n.label){case 0:return r=window.localStorage,o=i+"-"+t,null===(s=r.getItem(o))?[2]:(s=JSON.parse(s)).id!==this.id?[3,2]:[4,a.default().lock(s.iat)];case 1:n.sent(),this.acquiredIatSet.delete(s.iat),r.removeItem(o),a.default().unlock(s.iat),e.notifyWaiters(),n.label=2;case 2:return[2]}}))}))},e.lockCorrector=function(){for(var t=Date.now()-5e3,r=window.localStorage,n=Object.keys(r),o=!1,s=0;s<n.length;s++){var a=n[s];if(a.includes(i)){var c=r.getItem(a);null!==c&&(void 0===(c=JSON.parse(c)).timeRefreshed&&c.timeAcquired<t||void 0!==c.timeRefreshed&&c.timeRefreshed<t)&&(r.removeItem(a),o=!0)}}o&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=g})));const g={timeoutInSeconds:60},y={name:"auth0-spa-js",version:"2.0.4"},v=()=>Date.now();class d extends Error{constructor(e,t){super(t),this.error=e,this.error_description=t,Object.setPrototypeOf(this,d.prototype)}static fromPayload({error:e,error_description:t}){return new d(e,t)}}class u extends d{constructor(e,t,r,n=null){super(e,t),this.state=r,this.appState=n,Object.setPrototypeOf(this,u.prototype)}}class l extends d{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,l.prototype)}}class h extends l{constructor(e){super(),this.popup=e,Object.setPrototypeOf(this,h.prototype)}}class p extends d{constructor(e){super("cancelled","Popup closed"),this.popup=e,Object.setPrototypeOf(this,p.prototype)}}class m extends d{constructor(e,t,r){super(e,t),this.mfa_token=r,Object.setPrototypeOf(this,m.prototype)}}class f extends d{constructor(e,t){super("missing_refresh_token",`Missing Refresh Token (audience: '${_(e,["default"])}', scope: '${_(t)}')`),this.audience=e,this.scope=t,Object.setPrototypeOf(this,f.prototype)}}function _(e,t=[]){return e&&!t.includes(e)?e:""}const w=()=>window.crypto,b=()=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.";let t="";return Array.from(w().getRandomValues(new Uint8Array(43))).forEach((r=>t+=e[r%e.length])),t},E=e=>btoa(e),S=e=>{var{clientId:t}=e,r=n(e,["clientId"]);return new URLSearchParams((e=>Object.keys(e).filter((t=>void 0!==e[t])).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{}))(Object.assign({client_id:t},r))).toString()},T=e=>(e=>decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))(e.replace(/_/g,"/").replace(/-/g,"+")),I=async(e,t)=>{const r=await fetch(e,t);return{ok:r.ok,json:await r.json()}},k=async(e,t,r,n,o,i,s=1e4)=>o?(async(e,t,r,n,o,i,s)=>{return a={auth:{audience:t,scope:r},timeout:o,fetchUrl:e,fetchOptions:n,useFormData:s},c=i,new Promise((function(e,t){const r=new MessageChannel;r.port1.onmessage=function(n){n.data.error?t(new Error(n.data.error)):e(n.data),r.port1.close()},c.postMessage(a,[r.port2])}));var a,c})(e,t,r,n,s,o,i):(async(e,t,r)=>{const n=new AbortController;let o;return t.signal=n.signal,Promise.race([I(e,t),new Promise(((e,t)=>{o=setTimeout((()=>{n.abort(),t(new Error("Timeout when executing 'fetch'"))}),r)}))]).finally((()=>{clearTimeout(o)}))})(e,n,s);async function A(e,t){var{baseUrl:r,timeout:o,audience:i,scope:s,auth0Client:a,useFormData:c}=e,g=n(e,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);const v=c?S(g):JSON.stringify(g);return await async function(e,t,r,o,i,s,a){let c,g=null;for(let E=0;E<3;E++)try{c=await k(e,r,o,i,s,a,t),g=null;break}catch(n){g=n}if(g)throw g;const y=c.json,{error:v,error_description:_}=y,w=n(y,["error","error_description"]),{ok:b}=c;if(!b){const t=_||`HTTP error. Unable to fetch ${e}`;if("mfa_required"===v)throw new m(v,t,w.mfa_token);if("missing_refresh_token"===v)throw new f(r,o);throw new d(v||"request_error",t)}return w}(`${r}/oauth/token`,o,i||"default",s,{method:"POST",body:v,headers:{"Content-Type":c?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(a||y))}},t,c)}const R=(...e)=>{return(t=e.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(t))).join(" ");var t};class C{constructor(e,t="@@auth0spajs@@",r){this.prefix=t,this.suffix=r,this.clientId=e.clientId,this.scope=e.scope,this.audience=e.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(e){const[t,r,n,o]=e.split("::");return new C({clientId:r,scope:o,audience:n},t)}static fromCacheEntry(e){const{scope:t,audience:r,client_id:n}=e;return new C({scope:t,audience:r,clientId:n})}}class z{set(e,t){localStorage.setItem(e,JSON.stringify(t))}get(e){const t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return}}remove(e){localStorage.removeItem(e)}allKeys(){return Object.keys(window.localStorage).filter((e=>e.startsWith("@@auth0spajs@@")))}}class x{constructor(){this.enclosedCache=function(){let e={};return{set(t,r){e[t]=r},get(t){const r=e[t];if(r)return r},remove(t){delete e[t]},allKeys:()=>Object.keys(e)}}()}}class P{constructor(e,t,r){this.cache=e,this.keyManifest=t,this.nowProvider=r||v}async setIdToken(e,t,r){var n;const o=this.getIdTokenCacheKey(e);await this.cache.set(o,{id_token:t,decodedToken:r}),await(null===(n=this.keyManifest)||void 0===n?void 0:n.add(o))}async getIdToken(e){const t=await this.cache.get(this.getIdTokenCacheKey(e.clientId));if(!t&&e.scope&&e.audience){const t=await this.get(e);if(!t)return;if(!t.id_token||!t.decodedToken)return;return{id_token:t.id_token,decodedToken:t.decodedToken}}if(t)return{id_token:t.id_token,decodedToken:t.decodedToken}}async get(e,t=0){var r;let n=await this.cache.get(e.toKey());if(!n){const t=await this.getCacheKeys();if(!t)return;const r=this.matchExistingCacheKey(e,t);r&&(n=await this.cache.get(r))}if(!n)return;const o=await this.nowProvider(),i=Math.floor(o/1e3);return n.expiresAt-t<i?n.body.refresh_token?(n.body={refresh_token:n.body.refresh_token},await this.cache.set(e.toKey(),n),n.body):(await this.cache.remove(e.toKey()),void(await(null===(r=this.keyManifest)||void 0===r?void 0:r.remove(e.toKey())))):n.body}async set(e){var t;const r=new C({clientId:e.client_id,scope:e.scope,audience:e.audience}),n=await this.wrapCacheEntry(e);await this.cache.set(r.toKey(),n),await(null===(t=this.keyManifest)||void 0===t?void 0:t.add(r.toKey()))}async clear(e){var t;const r=await this.getCacheKeys();r&&(await r.filter((t=>!e||t.includes(e))).reduce((async(e,t)=>{await e,await this.cache.remove(t)}),Promise.resolve()),await(null===(t=this.keyManifest)||void 0===t?void 0:t.clear()))}async wrapCacheEntry(e){const t=await this.nowProvider();return{body:e,expiresAt:Math.floor(t/1e3)+e.expires_in}}async getCacheKeys(){var e;return this.keyManifest?null===(e=await this.keyManifest.get())||void 0===e?void 0:e.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(e){return new C({clientId:e},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(e,t){return t.filter((t=>{var r;const n=C.fromKey(t),o=new Set(n.scope&&n.scope.split(" ")),i=(null===(r=e.scope)||void 0===r?void 0:r.split(" "))||[],s=n.scope&&i.reduce(((e,t)=>e&&o.has(t)),!0);return"@@auth0spajs@@"===n.prefix&&n.clientId===e.clientId&&n.audience===e.audience&&s}))[0]}}class Z{constructor(e,t){this.storage=e,this.clientId=t,this.storageKey=`a0.spajs.txs.${this.clientId}`,this.transaction=this.storage.get(this.storageKey)}create(e){this.transaction=e,this.storage.save(this.storageKey,e,{daysUntilExpire:1})}get(){return this.transaction}remove(){delete this.transaction,this.storage.remove(this.storageKey)}}const O=e=>"number"==typeof e,N=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"];var U=s((function(e,t){var r=o&&o.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e,t){if(!t)return"";var r="; "+e;return!0===t?r:r+"="+t}function i(e,t,r){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return n("Expires",e.expires?e.expires.toUTCString():"")+n("Domain",e.domain)+n("Path",e.path)+n("Secure",e.secure)+n("SameSite",e.sameSite)}(r)}function s(e){for(var t={},r=e?e.split("; "):[],n=/(%[\dA-F]{2})+/gi,o=0;o<r.length;o++){var i=r[o].split("="),s=i.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{t[i[0].replace(n,decodeURIComponent)]=s.replace(n,decodeURIComponent)}catch(e){}}return t}function a(){return s(document.cookie)}function c(e,t,n){document.cookie=i(e,t,r({path:"/"},n))}t.__esModule=!0,t.encode=i,t.parse=s,t.getAll=a,t.get=function(e){return a()[e]},t.set=c,t.remove=function(e,t){c(e,"",r(r({},t),{expires:-1}))}}));i(U),U.encode,U.parse,U.getAll;var M=U.get,q=U.set,H=U.remove;const L={get(e){const t=M(e);if(void 0!==t)return JSON.parse(t)},save(e,t,r){let n={};"https:"===window.location.protocol&&(n={secure:!0,sameSite:"none"}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),(null==r?void 0:r.cookieDomain)&&(n.domain=r.cookieDomain),q(e,JSON.stringify(t),n)},remove(e,t){let r={};(null==t?void 0:t.cookieDomain)&&(r.domain=t.cookieDomain),H(e,r)}},D={get:e=>L.get(e)||L.get(`_legacy_${e}`),save(e,t,r){let n={};"https:"===window.location.protocol&&(n={secure:!0}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),(null==r?void 0:r.cookieDomain)&&(n.domain=r.cookieDomain),q(`_legacy_${e}`,JSON.stringify(t),n),L.save(e,t,r)},remove(e,t){let r={};(null==t?void 0:t.cookieDomain)&&(r.domain=t.cookieDomain),H(e,r),L.remove(e,t),L.remove(`_legacy_${e}`,t)}},K={get(e){if("undefined"==typeof sessionStorage)return;const t=sessionStorage.getItem(e);return null!=t?JSON.parse(t):void 0},save(e,t){sessionStorage.setItem(e,JSON.stringify(t))},remove(e){sessionStorage.removeItem(e)}};var F,j=("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9Y29uc3Qgcz1lPT57dmFye2NsaWVudElkOnR9PWUscj1mdW5jdGlvbihlLHQpe3ZhciByPXt9O2Zvcih2YXIgcyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHMpJiZ0LmluZGV4T2Yocyk8MCYmKHJbc109ZVtzXSk7aWYobnVsbCE9ZSYmImZ1bmN0aW9uIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKHM9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPHMubGVuZ3RoO28rKyl0LmluZGV4T2Yoc1tvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsc1tvXSkmJihyW3Nbb11dPWVbc1tvXV0pfXJldHVybiByfShlLFsiY2xpZW50SWQiXSk7cmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMoKGU9Pk9iamVjdC5rZXlzKGUpLmZpbHRlcigodD0+dm9pZCAwIT09ZVt0XSkpLnJlZHVjZSgoKHQscik9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3JdOmVbcl19KSkse30pKShPYmplY3QuYXNzaWduKHtjbGllbnRfaWQ6dH0scikpKS50b1N0cmluZygpfTtsZXQgbz17fTtjb25zdCBuPShlLHQpPT5gJHtlfXwke3R9YDthZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoYXN5bmMoe2RhdGE6e3RpbWVvdXQ6ZSxhdXRoOnIsZmV0Y2hVcmw6aSxmZXRjaE9wdGlvbnM6Yyx1c2VGb3JtRGF0YTphfSxwb3J0czpbZl19KT0+e2xldCBwO2NvbnN0e2F1ZGllbmNlOmwsc2NvcGU6dX09cnx8e307dHJ5e2NvbnN0IHI9YT8oZT0+e2NvbnN0IHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyhlKSxyPXt9O3JldHVybiB0LmZvckVhY2goKChlLHQpPT57clt0XT1lfSkpLHJ9KShjLmJvZHkpOkpTT04ucGFyc2UoYy5ib2R5KTtpZighci5yZWZyZXNoX3Rva2VuJiYicmVmcmVzaF90b2tlbiI9PT1yLmdyYW50X3R5cGUpe2NvbnN0IGU9KChlLHQpPT5vW24oZSx0KV0pKGwsdSk7aWYoIWUpdGhyb3cgbmV3IHQobCx1KTtjLmJvZHk9YT9zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpOkpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpfWxldCBkLGc7ImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGQ9bmV3IEFib3J0Q29udHJvbGxlcixjLnNpZ25hbD1kLnNpZ25hbCk7dHJ5e2c9YXdhaXQgUHJvbWlzZS5yYWNlKFsoaD1lLG5ldyBQcm9taXNlKChlPT5zZXRUaW1lb3V0KGUsaCkpKSksZmV0Y2goaSxPYmplY3QuYXNzaWduKHt9LGMpKV0pfWNhdGNoKGUpe3JldHVybiB2b2lkIGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfWlmKCFnKXJldHVybiBkJiZkLmFib3J0KCksdm9pZCBmLnBvc3RNZXNzYWdlKHtlcnJvcjoiVGltZW91dCB3aGVuIGV4ZWN1dGluZyAnZmV0Y2gnIn0pO3A9YXdhaXQgZy5qc29uKCkscC5yZWZyZXNoX3Rva2VuPygoKGUsdCxyKT0+e29bbih0LHIpXT1lfSkocC5yZWZyZXNoX3Rva2VuLGwsdSksZGVsZXRlIHAucmVmcmVzaF90b2tlbik6KChlLHQpPT57ZGVsZXRlIG9bbihlLHQpXX0pKGwsdSksZi5wb3N0TWVzc2FnZSh7b2s6Zy5vayxqc29uOnB9KX1jYXRjaChlKXtmLnBvc3RNZXNzYWdlKHtvazohMSxqc29uOntlcnJvcjplLmVycm9yLGVycm9yX2Rlc2NyaXB0aW9uOmUubWVzc2FnZX19KX12YXIgaH0pKX0oKTsKCg==",null,!1,function(e){return F=F||function(e,t,r){var n=void 0===t?null:t,o=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),o=0,i=r.length;o<i;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(e,void 0!==r&&r),i=o.indexOf("\n",10)+1,s=o.substring(i)+(n?"//# sourceMappingURL="+n:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9Y29uc3Qgcz1lPT57dmFye2NsaWVudElkOnR9PWUscj1mdW5jdGlvbihlLHQpe3ZhciByPXt9O2Zvcih2YXIgcyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHMpJiZ0LmluZGV4T2Yocyk8MCYmKHJbc109ZVtzXSk7aWYobnVsbCE9ZSYmImZ1bmN0aW9uIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKHM9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPHMubGVuZ3RoO28rKyl0LmluZGV4T2Yoc1tvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsc1tvXSkmJihyW3Nbb11dPWVbc1tvXV0pfXJldHVybiByfShlLFsiY2xpZW50SWQiXSk7cmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMoKGU9Pk9iamVjdC5rZXlzKGUpLmZpbHRlcigodD0+dm9pZCAwIT09ZVt0XSkpLnJlZHVjZSgoKHQscik9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3JdOmVbcl19KSkse30pKShPYmplY3QuYXNzaWduKHtjbGllbnRfaWQ6dH0scikpKS50b1N0cmluZygpfTtsZXQgbz17fTtjb25zdCBuPShlLHQpPT5gJHtlfXwke3R9YDthZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoYXN5bmMoe2RhdGE6e3RpbWVvdXQ6ZSxhdXRoOnIsZmV0Y2hVcmw6aSxmZXRjaE9wdGlvbnM6Yyx1c2VGb3JtRGF0YTphfSxwb3J0czpbZl19KT0+e2xldCBwO2NvbnN0e2F1ZGllbmNlOmwsc2NvcGU6dX09cnx8e307dHJ5e2NvbnN0IHI9YT8oZT0+e2NvbnN0IHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyhlKSxyPXt9O3JldHVybiB0LmZvckVhY2goKChlLHQpPT57clt0XT1lfSkpLHJ9KShjLmJvZHkpOkpTT04ucGFyc2UoYy5ib2R5KTtpZighci5yZWZyZXNoX3Rva2VuJiYicmVmcmVzaF90b2tlbiI9PT1yLmdyYW50X3R5cGUpe2NvbnN0IGU9KChlLHQpPT5vW24oZSx0KV0pKGwsdSk7aWYoIWUpdGhyb3cgbmV3IHQobCx1KTtjLmJvZHk9YT9zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpOkpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpfWxldCBkLGc7ImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGQ9bmV3IEFib3J0Q29udHJvbGxlcixjLnNpZ25hbD1kLnNpZ25hbCk7dHJ5e2c9YXdhaXQgUHJvbWlzZS5yYWNlKFsoaD1lLG5ldyBQcm9taXNlKChlPT5zZXRUaW1lb3V0KGUsaCkpKSksZmV0Y2goaSxPYmplY3QuYXNzaWduKHt9LGMpKV0pfWNhdGNoKGUpe3JldHVybiB2b2lkIGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfWlmKCFnKXJldHVybiBkJiZkLmFib3J0KCksdm9pZCBmLnBvc3RNZXNzYWdlKHtlcnJvcjoiVGltZW91dCB3aGVuIGV4ZWN1dGluZyAnZmV0Y2gnIn0pO3A9YXdhaXQgZy5qc29uKCkscC5yZWZyZXNoX3Rva2VuPygoKGUsdCxyKT0+e29bbih0LHIpXT1lfSkocC5yZWZyZXNoX3Rva2VuLGwsdSksZGVsZXRlIHAucmVmcmVzaF90b2tlbik6KChlLHQpPT57ZGVsZXRlIG9bbihlLHQpXX0pKGwsdSksZi5wb3N0TWVzc2FnZSh7b2s6Zy5vayxqc29uOnB9KX1jYXRjaChlKXtmLnBvc3RNZXNzYWdlKHtvazohMSxqc29uOntlcnJvcjplLmVycm9yLGVycm9yX2Rlc2NyaXB0aW9uOmUubWVzc2FnZX19KX12YXIgaH0pKX0oKTsKCg==",null,false),new Worker(F,e)});const G={};class B{constructor(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(e){var t;const r=new Set((null===(t=await this.cache.get(this.manifestKey))||void 0===t?void 0:t.keys)||[]);r.add(e),await this.cache.set(this.manifestKey,{keys:[...r]})}async remove(e){const t=await this.cache.get(this.manifestKey);if(t){const r=new Set(t.keys);return r.delete(e),r.size>0?await this.cache.set(this.manifestKey,{keys:[...r]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(e){return`@@auth0spajs@@::${e}`}}const W={memory:()=>(new x).enclosedCache,localstorage:()=>new z},Y=e=>W[e],V=e=>{const{openUrl:t,onRedirect:r}=e,o=n(e,["openUrl","onRedirect"]);return Object.assign(Object.assign({},o),{openUrl:!1===t||t?t:r})},J=new c;class te{constructor(e){let t,r;if(this.userCache=(new x).enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await J.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),e),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),e.authorizationParams)}),"undefined"!=typeof window&&(()=>{if(!w())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===w().subtle)throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")})(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)r=e.cache;else{if(t=e.cacheLocation||"memory",!Y(t))throw new Error(`Invalid cache location "${t}"`);r=Y(t)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===e.legacySameSiteCookie?L:D,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=(e=>`auth0.${this.options.clientId}.is.authenticated`)(),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;const n=e.useCookiesForTransactions?this.cookieStorage:K;var o;this.scope=R("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new Z(n,this.options.clientId),this.nowProvider=this.options.nowProvider||v,this.cacheManager=new P(r,r.allKeys?void 0:new B(r,this.options.clientId),this.nowProvider),this.domainUrl=(o=this.options.domain,/^https?:\/\//.test(o)?o:`https://${o}`),this.tokenIssuer=((e,t)=>e?e.startsWith("https://")?e:`https://${e}/`:`${t}/`)(this.options.issuer,this.domainUrl),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&"memory"===t&&(this.worker=new j)}_url(e){const t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||y)));return`${this.domainUrl}${e}&auth0Client=${t}`}_authorizeUrl(e){return this._url(`/authorize?${S(e)}`)}async _verifyIdToken(e,t,r){const n=await this.nowProvider();return(e=>{if(!e.id_token)throw new Error("ID token is required but missing");const t=(e=>{const t=e.split("."),[r,n,o]=t;if(3!==t.length||!r||!n||!o)throw new Error("ID token could not be decoded");const i=JSON.parse(T(n)),s={__raw:e},a={};return Object.keys(i).forEach((e=>{s[e]=i[e],N.includes(e)||(a[e]=i[e])})),{encoded:{header:r,payload:n,signature:o},header:JSON.parse(T(r)),claims:s,user:a}})(e.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw new Error(`Issuer (iss) claim mismatch in the ID token; expected "${e.iss}", found "${t.claims.iss}"`);if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error(`Signature algorithm of "${t.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but was not one of "${t.claims.aud.join(", ")}"`);if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw new Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${e.aud}", found "${t.claims.azp}"`)}}else if(t.claims.aud!==e.aud)throw new Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but found "${t.claims.aud}"`);if(e.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw new Error(`Nonce (nonce) claim mismatch in the ID token; expected "${e.nonce}", found "${t.claims.nonce}"`)}if(e.max_age&&!O(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(null==t.claims.exp||!O(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!O(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const r=e.leeway||60,n=new Date(e.now||Date.now()),o=new Date(0);if(o.setUTCSeconds(t.claims.exp+r),n>o)throw new Error(`Expiration Time (exp) claim error in the ID token; current time (${n}) is after expiration time (${o})`);if(null!=t.claims.nbf&&O(t.claims.nbf)){const e=new Date(0);if(e.setUTCSeconds(t.claims.nbf-r),n<e)throw new Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${n}) is before ${e}`)}if(null!=t.claims.auth_time&&O(t.claims.auth_time)){const o=new Date(0);if(o.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+r),n>o)throw new Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${n}) is after last auth at ${o}`)}if(e.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw new Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${e.organizationId}", found "${t.claims.org_id}"`)}return t})({iss:this.tokenIssuer,aud:this.options.clientId,id_token:e,nonce:t,organizationId:r,leeway:this.options.leeway,max_age:(o=this.options.authorizationParams.max_age,"string"!=typeof o?o:parseInt(o,10)||void 0),now:n});var o}_processOrgIdHint(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(e,t,r){const n=E(b()),o=E(b()),i=b(),s=(e=>{const t=new Uint8Array(e);return(e=>{const t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,(e=>t[e]))})(window.btoa(String.fromCharCode(...Array.from(t))))})(await(async e=>{const t=w().subtle.digest({name:"SHA-256"},(new TextEncoder).encode(e));return await t})(i)),a=((e,t,r,n,o,i,s,a)=>Object.assign(Object.assign(Object.assign({client_id:e.clientId},e.authorizationParams),r),{scope:R(t,r.scope),response_type:"code",response_mode:a||"query",state:n,nonce:o,redirect_uri:s||e.authorizationParams.redirect_uri,code_challenge:i,code_challenge_method:"S256"}))(this.options,this.scope,e,n,o,s,e.redirect_uri||this.options.authorizationParams.redirect_uri||r,null==t?void 0:t.response_mode),c=this._authorizeUrl(a);return{nonce:o,code_verifier:i,scope:a.scope,audience:a.audience||"default",redirect_uri:a.redirect_uri,state:n,url:c}}async loginWithPopup(e,t){var r;if(e=e||{},!(t=t||{}).popup&&(t.popup=(e=>{const t=window.screenX+(window.innerWidth-400)/2,r=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup",`left=${t},top=${r},width=400,height=600,resizable,scrollbars=yes,status=1`)})(),!t.popup))throw new Error("Unable to open a popup for loginWithPopup - window.open returned `null`");const n=await this._prepareAuthorizeUrl(e.authorizationParams||{},{response_mode:"web_message"},window.location.origin);t.popup.location.href=n.url;const o=await(e=>new Promise(((t,r)=>{let n;const o=setInterval((()=>{e.popup&&e.popup.closed&&(clearInterval(o),clearTimeout(i),window.removeEventListener("message",n,!1),r(new p(e.popup)))}),1e3),i=setTimeout((()=>{clearInterval(o),r(new h(e.popup)),window.removeEventListener("message",n,!1)}),1e3*(e.timeoutInSeconds||60));n=function(s){if(s.data&&"authorization_response"===s.data.type){if(clearTimeout(i),clearInterval(o),window.removeEventListener("message",n,!1),e.popup.close(),s.data.response.error)return r(d.fromPayload(s.data.response));t(s.data.response)}},window.addEventListener("message",n)})))(Object.assign(Object.assign({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}));if(n.state!==o.state)throw new Error("Invalid state");const i=(null===(r=e.authorizationParams)||void 0===r?void 0:r.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:n.audience,scope:n.scope,code_verifier:n.code_verifier,grant_type:"authorization_code",code:o.code,redirect_uri:n.redirect_uri},{nonceIn:n.nonce,organizationId:i})}async getUser(){var e;const t=await this._getIdTokenFromCache();return null===(e=null==t?void 0:t.decodedToken)||void 0===e?void 0:e.user}async getIdTokenClaims(){var e;const t=await this._getIdTokenFromCache();return null===(e=null==t?void 0:t.decodedToken)||void 0===e?void 0:e.claims}async loginWithRedirect(e={}){var t;const r=V(e),{openUrl:o,fragment:i,appState:s}=r,a=n(r,["openUrl","fragment","appState"]),c=(null===(t=a.authorizationParams)||void 0===t?void 0:t.organization)||this.options.authorizationParams.organization,g=await this._prepareAuthorizeUrl(a.authorizationParams||{}),{url:y}=g,v=n(g,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},v),{appState:s}),c&&{organizationId:c}));const _=i?`${y}#${i}`:y;o?await o(_):window.location.assign(_)}async handleRedirectCallback(e=window.location.href){const t=e.split("?").slice(1);if(0===t.length)throw new Error("There are no query params available for parsing.");const{state:r,code:n,error:o,error_description:i}=(e=>{e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));const t=new URLSearchParams(e);return{state:t.get("state"),code:t.get("code")||void 0,error:t.get("error")||void 0,error_description:t.get("error_description")||void 0}})(t.join("")),s=this.transactionManager.get();if(!s)throw new Error("Invalid state");if(this.transactionManager.remove(),o)throw new u(o,i||o,r,s.appState);if(!s.code_verifier||s.state&&s.state!==r)throw new Error("Invalid state");const a=s.organizationId,c=s.nonce,g=s.redirect_uri;return await this._requestToken(Object.assign({audience:s.audience,scope:s.scope,code_verifier:s.code_verifier,grant_type:"authorization_code",code:n},g?{redirect_uri:g}:{}),{nonceIn:c,organizationId:a}),{appState:s.appState}}async checkSession(e){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(e)}catch(e){}}async getTokenSilently(e={}){var t;const r=Object.assign(Object.assign({cacheMode:"on"},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:R(this.scope,null===(t=e.authorizationParams)||void 0===t?void 0:t.scope)})}),n=await((e,t)=>{let r=G[t];return r||(r=e().finally((()=>{delete G[t],r=null})),G[t]=r),r})((()=>this._getTokenSilently(r)),`${this.options.clientId}::${r.authorizationParams.audience}::${r.authorizationParams.scope}`);return e.detailedResponse?n:null==n?void 0:n.access_token}async _getTokenSilently(e){const{cacheMode:t}=e,r=n(e,["cacheMode"]);if("off"!==t){const e=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(e)return e}if("cache-only"!==t){if(!(await(async(e,t=3)=>{for(let r=0;r<t;r++)if(await e())return!0;return!1})((()=>J.acquireLock("auth0.lock.getTokenSilently",5e3)),10)))throw new l;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),"off"!==t){const e=await this._getEntryFromCache({scope:r.authorizationParams.scope,audience:r.authorizationParams.audience||"default",clientId:this.options.clientId});if(e)return e}const e=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(r):await this._getTokenFromIFrame(r),{id_token:n,access_token:o,oauthTokenScope:i,expires_in:s}=e;return Object.assign(Object.assign({id_token:n,access_token:o},i?{scope:i}:null),{expires_in:s})}finally{await J.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(e={},t={}){var r;const n=Object.assign(Object.assign({},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:R(this.scope,null===(r=e.authorizationParams)||void 0===r?void 0:r.scope)})});return t=Object.assign(Object.assign({},g),t),await this.loginWithPopup(n,t),(await this.cacheManager.get(new C({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!(await this.getUser())}_buildLogoutUrl(e){null!==e.clientId?e.clientId=e.clientId||this.options.clientId:delete e.clientId;const t=e.logoutParams||{},{federated:r}=t,o=n(t,["federated"]),i=r?"&federated":"";return this._url(`/v2/logout?${S(Object.assign({clientId:e.clientId},o))}`)+i}async logout(e={}){const t=V(e),{openUrl:r}=t,o=n(t,["openUrl"]);null===e.clientId?await this.cacheManager.clear():await this.cacheManager.clear(e.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");const i=this._buildLogoutUrl(o);r?await r(i):!1!==r&&window.location.assign(i)}async _getTokenFromIFrame(e){const t=Object.assign(Object.assign({},e.authorizationParams),{prompt:"none"}),r=this.cookieStorage.get(this.orgHintCookieName);r&&!t.organization&&(t.organization=r);const{url:n,state:o,nonce:i,code_verifier:s,redirect_uri:a,scope:c,audience:g}=await this._prepareAuthorizeUrl(t,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new d("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const t=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,r=await((e,t,r=60)=>new Promise(((n,o)=>{const i=window.document.createElement("iframe");i.setAttribute("width","0"),i.setAttribute("height","0"),i.style.display="none";const s=()=>{window.document.body.contains(i)&&(window.document.body.removeChild(i),window.removeEventListener("message",a,!1))};let a;const c=setTimeout((()=>{o(new l),s()}),1e3*r);a=function(e){if(e.origin!=t)return;if(!e.data||"authorization_response"!==e.data.type)return;const r=e.source;r&&r.close(),e.data.response.error?o(d.fromPayload(e.data.response)):n(e.data.response),clearTimeout(c),window.removeEventListener("message",a,!1),setTimeout(s,2e3)},window.addEventListener("message",a,!1),window.document.body.appendChild(i),i.setAttribute("src",e)})))(n,this.domainUrl,t);if(o!==r.state)throw new Error("Invalid state");const y=await this._requestToken(Object.assign(Object.assign({},e.authorizationParams),{code_verifier:s,code:r.code,grant_type:"authorization_code",redirect_uri:a,timeout:e.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:i});return Object.assign(Object.assign({},y),{scope:c,oauthTokenScope:y.scope,audience:g})}catch(e){throw"login_required"===e.error&&this.logout({openUrl:!1}),e}}async _getTokenUsingRefreshToken(e){const t=await this.cacheManager.get(new C({scope:e.authorizationParams.scope,audience:e.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(t&&t.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw new f(e.authorizationParams.audience||"default",e.authorizationParams.scope)}const r=e.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,n="number"==typeof e.timeoutInSeconds?1e3*e.timeoutInSeconds:null;try{const o=await this._requestToken(Object.assign(Object.assign(Object.assign({},e.authorizationParams),{grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:r}),n&&{timeout:n}));return Object.assign(Object.assign({},o),{scope:e.authorizationParams.scope,oauthTokenScope:o.scope,audience:e.authorizationParams.audience||"default"})}catch(t){if((t.message.indexOf("Missing Refresh Token")>-1||t.message&&t.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw t}}async _saveEntryInCache(e){const{id_token:t,decodedToken:r}=e,o=n(e,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:t,decodedToken:r}),await this.cacheManager.setIdToken(this.options.clientId,e.id_token,e.decodedToken),await this.cacheManager.set(o)}async _getIdTokenFromCache(){const e=this.options.authorizationParams.audience||"default",t=await this.cacheManager.getIdToken(new C({clientId:this.options.clientId,audience:e,scope:this.scope})),r=this.userCache.get("@@user@@");return t&&t.id_token===(null==r?void 0:r.id_token)?r:(this.userCache.set("@@user@@",t),t)}async _getEntryFromCache({scope:e,audience:t,clientId:r}){const n=await this.cacheManager.get(new C({scope:e,audience:t,clientId:r}),60);if(n&&n.access_token){const{access_token:e,oauthTokenScope:t,expires_in:r}=n,o=await this._getIdTokenFromCache();return o&&Object.assign(Object.assign({id_token:o.id_token,access_token:e},t?{scope:t}:null),{expires_in:r})}}async _requestToken(e,t){const{nonceIn:r,organizationId:n}=t||{},o=await A(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},e),this.worker),i=await this._verifyIdToken(o.id_token,r,n);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},o),{decodedToken:i,scope:e.scope,audience:e.audience||"default"}),o.scope?{oauthTokenScope:o.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgIdHint(i.claims.org_id),Object.assign(Object.assign({},o),{decodedToken:i})}}class ie{}async function X(e){const t=new te(e);return await t.checkSession(),t}},8297:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AccountEntity:()=>Re,ApiId:()=>Je,AuthError:()=>ye,AuthErrorMessage:()=>me,AuthenticationHeaderParser:()=>dn,AuthenticationScheme:()=>$,AzureCloudInstance:()=>Et,BrowserAuthError:()=>et,BrowserAuthErrorMessage:()=>$e,BrowserCacheLocation:()=>Ge,BrowserConfigurationAuthError:()=>ft,BrowserConfigurationAuthErrorMessage:()=>pt,BrowserUtils:()=>ar,CacheLookupPolicy:()=>ct,ClientAuthError:()=>_e,ClientAuthErrorMessage:()=>ve,ClientConfigurationError:()=>Ce,ClientConfigurationErrorMessage:()=>Ee,DEFAULT_IFRAME_TIMEOUT_MS:()=>Tr,EventMessageUtils:()=>un,EventType:()=>Zt,InteractionRequiredAuthError:()=>Ft,InteractionRequiredAuthErrorMessage:()=>Kt,InteractionStatus:()=>Ze,InteractionType:()=>Xe,LogLevel:()=>wt,Logger:()=>Ct,NavigationClient:()=>Sr,OIDC_DEFAULT_SCOPES:()=>U,PerformanceEvents:()=>dt,ProtocolMode:()=>Vt,PublicClientApplication:()=>an,ServerError:()=>Nt,SignedHttpRequest:()=>ln,StringUtils:()=>Se,UrlString:()=>yt,WrapperSKU:()=>it,internals:()=>n,stubbedPublicClientApplication:()=>cn,version:()=>or});var n={};r.r(n),r.d(n,{BrowserCacheManager:()=>_t,BrowserConstants:()=>tt,BrowserPerformanceClient:()=>$r,BrowserPerformanceMeasurement:()=>Qr,CryptoOps:()=>Xr,EventHandler:()=>Pr,NativeAuthError:()=>gr,NativeInteractionClient:()=>_r,NativeMessageHandler:()=>wr,PopupClient:()=>Er,RedirectClient:()=>br,RedirectHandler:()=>dr,SilentCacheClient:()=>vr,SilentIframeClient:()=>Ar,SilentRefreshClient:()=>Rr,StandardInteractionClient:()=>ur,TemporaryCacheKeys:()=>ze});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function i(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function g(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}var _=function(e,t){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},_(e,t)};function w(e,t){function r(){this.constructor=e}_(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var b=function(){return b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},b.apply(this,arguments)};function E(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function S(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function T(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}var I,k,A,R,O,N={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},U=[N.OPENID_SCOPE,N.PROFILE_SCOPE,N.OFFLINE_ACCESS_SCOPE],M=T(U,[N.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(I||(I={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(k||(k={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(A||(A={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(R||(R={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(O||(O={}));var q,H={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(q||(q={}));var L,D,K,F,j,G,W={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(L||(L={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(D||(D={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(K||(K={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(F||(F={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(j||(j={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(G||(G={}));var Y,V="appmetadata",J="1",X="authority-metadata",Q=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(Y||(Y={}));var $,ee={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}($||($={}));var re,ne,oe,se,ae,ce,ue=60,le=3600,de="throttling",he="retry-after, h429",pe="invalid_grant",fe="client_mismatch";!function(e){e.username="username",e.password="password"}(re||(re={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(ne||(ne={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(oe||(oe={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(se||(se={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(ae||(ae={})),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(ce||(ce={}));var ge,me={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},ye=function(e){function t(r,n,o){var i=this,s=n?r+": "+n:r;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||N.EMPTY_STRING,i.errorMessage=n||N.EMPTY_STRING,i.subError=o||N.EMPTY_STRING,i.name="AuthError",i}return w(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(me.unexpectedError.code,me.unexpectedError.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(me.postRequestFailed.code,me.postRequestFailed.desc+": "+e)},t}(Error),ve={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},_e=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return w(t,e),t.createClientInfoDecodingError=function(e){return new t(ve.clientInfoDecodingError.code,ve.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(ve.clientInfoEmptyError.code,""+ve.clientInfoEmptyError.desc)},t.createTokenParsingError=function(e){return new t(ve.tokenParsingError.code,ve.tokenParsingError.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(ve.nullOrEmptyToken.code,ve.nullOrEmptyToken.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(ve.endpointResolutionError.code,ve.endpointResolutionError.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(ve.networkError.code,ve.networkError.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(ve.unableToGetOpenidConfigError.code,ve.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(ve.hashNotDeserialized.code,ve.hashNotDeserialized.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(ve.invalidStateError.code,ve.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(ve.stateMismatchError.code,ve.stateMismatchError.desc)},t.createStateNotFoundError=function(e){return new t(ve.stateNotFoundError.code,ve.stateNotFoundError.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(ve.nonceMismatchError.code,ve.nonceMismatchError.desc)},t.createAuthTimeNotFoundError=function(){return new t(ve.authTimeNotFoundError.code,ve.authTimeNotFoundError.desc)},t.createMaxAgeTranspiredError=function(){return new t(ve.maxAgeTranspiredError.code,ve.maxAgeTranspiredError.desc)},t.createNonceNotFoundError=function(e){return new t(ve.nonceNotFoundError.code,ve.nonceNotFoundError.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(ve.multipleMatchingTokens.code,ve.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(ve.multipleMatchingAccounts.code,ve.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(ve.multipleMatchingAppMetadata.code,ve.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(ve.tokenRequestCannotBeMade.code,ve.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(ve.appendEmptyScopeError.code,ve.appendEmptyScopeError.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(ve.removeEmptyScopeError.code,ve.removeEmptyScopeError.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(ve.appendScopeSetError.code,ve.appendScopeSetError.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(ve.emptyInputScopeSetError.code,""+ve.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(ve.DeviceCodePollingCancelled.code,""+ve.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(ve.DeviceCodeExpired.code,""+ve.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(ve.DeviceCodeUnknownError.code,""+ve.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(ve.NoAccountInSilentRequest.code,""+ve.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(ve.invalidCacheRecord.code,ve.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(ve.invalidCacheEnvironment.code,ve.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(ve.noAccountFound.code,ve.noAccountFound.desc)},t.createCachePluginError=function(){return new t(ve.CachePluginError.code,""+ve.CachePluginError.desc)},t.createNoCryptoObjectError=function(e){return new t(ve.noCryptoObj.code,""+ve.noCryptoObj.desc+e)},t.createInvalidCacheTypeError=function(){return new t(ve.invalidCacheType.code,""+ve.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(ve.unexpectedAccountType.code,""+ve.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(ve.unexpectedCredentialType.code,""+ve.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(ve.invalidAssertion.code,""+ve.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(ve.invalidClientCredential.code,""+ve.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(ve.tokenRefreshRequired.code,ve.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(ve.userTimeoutReached.code,ve.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(ve.tokenClaimsRequired.code,ve.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(ve.noAuthorizationCodeFromServer.code,ve.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(ve.bindingKeyNotRemovedError.code,ve.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(ve.logoutNotSupported.code,ve.logoutNotSupported.desc)},t.createKeyIdMissingError=function(){return new t(ve.keyIdMissing.code,ve.keyIdMissing.desc)},t.createNoNetworkConnectivityError=function(){return new t(ve.noNetworkConnectivity.code,ve.noNetworkConnectivity.desc)},t.createUserCanceledError=function(){return new t(ve.userCanceledError.code,ve.userCanceledError.desc)},t}(ye),we=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case j.ID_TOKEN:return G.ID_TOKEN;case j.ACCESS_TOKEN:case j.ACCESS_TOKEN_WITH_AUTH_SCHEME:return G.ACCESS_TOKEN;case j.REFRESH_TOKEN:return G.REFRESH_TOKEN;default:throw _e.createUnexpectedCredentialTypeError()}},e.generateCredentialCacheKey=function(e,t,r,n,o,i,s,a,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,s),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(a)].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===j.REFRESH_TOKEN&&n||t,r||N.EMPTY_STRING].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||N.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||N.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==$.BEARER.toLowerCase()?e.toLowerCase():N.EMPTY_STRING},e}(),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.createIdTokenEntity=function(e,r,n,o,i){var s=new t;return s.credentialType=j.ID_TOKEN,s.homeAccountId=e,s.environment=r,s.clientId=o,s.secret=n,s.realm=i,s},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===j.ID_TOKEN)},t}(we),Ee={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},Ce=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return w(t,e),t.createRedirectUriEmptyError=function(){return new t(Ee.redirectUriNotSet.code,Ee.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Ee.postLogoutUriNotSet.code,Ee.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(e){return new t(Ee.claimsRequestParsingError.code,Ee.claimsRequestParsingError.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Ee.authorityUriInsecure.code,Ee.authorityUriInsecure.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(Ee.urlParseError.code,Ee.urlParseError.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Ee.urlEmptyError.code,Ee.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(Ee.emptyScopesError.code,""+Ee.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(e){return new t(Ee.clientIdSingleScopeError.code,Ee.clientIdSingleScopeError.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(Ee.invalidPrompt.code,Ee.invalidPrompt.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Ee.invalidClaimsRequest.code,Ee.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(Ee.logoutRequestEmptyError.code,Ee.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(Ee.tokenRequestEmptyError.code,Ee.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(Ee.invalidCodeChallengeMethod.code,Ee.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(Ee.invalidCodeChallengeParams.code,Ee.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Ee.invalidCloudDiscoveryMetadata.code,Ee.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(Ee.invalidAuthorityMetadata.code,Ee.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(Ee.untrustedAuthority.code,Ee.untrustedAuthority.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(Ee.invalidAzureCloudInstance.code,Ee.invalidAzureCloudInstance.desc)},t.createMissingSshJwkError=function(){return new t(Ee.missingSshJwk.code,Ee.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(Ee.missingSshKid.code,Ee.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(Ee.missingNonceAuthenticationHeader.code,Ee.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(Ee.invalidAuthenticationHeader.code,Ee.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+r)},t}(_e),Se=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw _e.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw _e.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(n){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(t){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),Te=function(){function e(e){var t=this,r=e?Se.trimArrayEntries(T(e)):[],n=r?Se.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||N.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){var r=new e(t);return r.containsOnlyOIDCScopes()?r.removeScope(N.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Ce.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!Se.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return M.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){Se.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(r){throw _e.createAppendScopeSetError(r)}},e.prototype.removeScope=function(e){if(Se.isEmpty(e))throw _e.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;M.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw _e.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw _e.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):N.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function Ie(e,t){if(Se.isEmpty(e))throw _e.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(n){throw _e.createClientInfoDecodingError(n.message)}}function ke(e){if(Se.isEmpty(e))throw _e.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(F.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?N.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(ge||(ge={}));var Ae,Re=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case K.ADFS_ACCOUNT_TYPE:return G.ADFS;case K.MSAV1_ACCOUNT_TYPE:return G.MSA;case K.MSSTS_ACCOUNT_TYPE:return G.MSSTS;case K.GENERIC_ACCOUNT_TYPE:return G.GENERIC;default:throw _e.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||N.EMPTY_STRING,e.tenantId||N.EMPTY_STRING].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,s,a,c){var g,y,v,_,w,b,E=new e;E.authorityType=K.MSSTS_ACCOUNT_TYPE,E.clientInfo=t,E.homeAccountId=r,E.nativeAccountId=c;var S=a||o&&o.getPreferredCache();if(!S)throw _e.createInvalidCacheEnvironmentError();if(E.environment=S,E.realm=(null===(g=null==n?void 0:n.claims)||void 0===g?void 0:g.tid)||N.EMPTY_STRING,n){E.idTokenClaims=n.claims,E.localAccountId=(null===(y=null==n?void 0:n.claims)||void 0===y?void 0:y.oid)||(null===(v=null==n?void 0:n.claims)||void 0===v?void 0:v.sub)||N.EMPTY_STRING;var T=null===(_=null==n?void 0:n.claims)||void 0===_?void 0:_.preferred_username,I=(null===(w=null==n?void 0:n.claims)||void 0===w?void 0:w.emails)?n.claims.emails[0]:null;E.username=T||I||N.EMPTY_STRING,E.name=null===(b=null==n?void 0:n.claims)||void 0===b?void 0:b.name}return E.cloudGraphHostName=i,E.msGraphHost=s,E},e.createGenericAccount=function(t,r,n,o,i,s){var a,c,g,y,v=new e;v.authorityType=n&&n.authorityType===ge.Adfs?K.ADFS_ACCOUNT_TYPE:K.GENERIC_ACCOUNT_TYPE,v.homeAccountId=t,v.realm=N.EMPTY_STRING;var _=s||n&&n.getPreferredCache();if(!_)throw _e.createInvalidCacheEnvironmentError();return r&&(v.localAccountId=(null===(a=null==r?void 0:r.claims)||void 0===a?void 0:a.oid)||(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.sub)||N.EMPTY_STRING,v.username=(null===(g=null==r?void 0:r.claims)||void 0===g?void 0:g.upn)||N.EMPTY_STRING,v.name=(null===(y=null==r?void 0:r.claims)||void 0===y?void 0:y.name)||N.EMPTY_STRING,v.idTokenClaims=null==r?void 0:r.claims),v.environment=_,v.cloudGraphHostName=o,v.msGraphHost=i,v},e.generateHomeAccountId=function(e,t,r,n,o){var i,s=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:N.EMPTY_STRING;if(t===ge.Adfs||t===ge.Dsts)return s;if(e)try{var a=Ie(e,n);if(!Se.isEmpty(a.uid)&&!Se.isEmpty(a.utid))return""+a.uid+F.CLIENT_INFO_SEPARATOR+a.utid}catch(c){}return r.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),Pe=function(){function e(t,r){if(Se.isEmpty(t))throw _e.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=Se.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(i){throw _e.createTokenParsingError(i)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw _e.createMaxAgeTranspiredError()},e}(),Oe="@azure/msal-common",Ne="12.1.0",Ue=function(){function e(e,t,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(Oe,Ne)}return e.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var r=t.reduce((function(t,r){var n=e.getAccount(r);return n?(t.push(n),t):t}),[]);return r.length<1?[]:r.map((function(t){return e.getAccountInfoFromEntity(t)}))},e.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},e.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),r=this.getIdToken(t);return r&&(t.idToken=r.secret,t.idTokenClaims=new Pe(r.secret,this.cryptoImpl).claims),t},e.prototype.saveCacheRecord=function(e){return E(this,void 0,void 0,(function(){return S(this,(function(t){switch(t.label){case 0:if(!e)throw _e.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return E(this,void 0,void 0,(function(){var t,r,n,o,i=this;return S(this,(function(s){switch(s.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=Te.fromString(e.target),o=[],r.accessToken.forEach((function(e){if(i.accessTokenKeyMatchesFilter(e,t,!1)){var r=i.getAccessTokenCredential(e);if(r&&i.credentialMatchesFilter(r,t))Te.fromString(r.target).intersectingScopeSets(n)&&o.push(i.removeAccessToken(e))}})),[4,Promise.all(o)];case 1:return s.sent(),this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){var t=this,r=this.getAccountKeys(),n=[];return r.forEach((function(r){if(t.isAccountKey(r,e.homeAccountId,e.realm)){var o=t.getAccount(r);o&&(e.homeAccountId&&!t.matchHomeAccountId(o,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(o,e.localAccountId)||e.username&&!t.matchUsername(o,e.username)||e.environment&&!t.matchEnvironment(o,e.environment)||e.realm&&!t.matchRealm(o,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(o,e.nativeAccountId)||n.push(o))}})),n},e.prototype.isAccountKey=function(e,t,r){return!(e.split(F.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))},e.prototype.isCredentialKey=function(e){if(e.split(F.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(j.ID_TOKEN.toLowerCase())&&-1===t.indexOf(j.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(j.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(j.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(j.REFRESH_TOKEN.toLowerCase())>-1){var r=""+j.REFRESH_TOKEN+F.CACHE_KEY_SEPARATOR+this.clientId+F.CACHE_KEY_SEPARATOR,n=""+j.REFRESH_TOKEN+F.CACHE_KEY_SEPARATOR+J+F.CACHE_KEY_SEPARATOR;if(-1===t.indexOf(r.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0},e.prototype.credentialMatchesFilter=function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===j.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===$.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return E(this,void 0,void 0,(function(){var e,t,r=this;return S(this,(function(n){switch(n.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.removeAccount=function(e){return E(this,void 0,void 0,(function(){var t;return S(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw _e.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return r.sent(),this.removeItem(e),[2]}}))}))},e.prototype.removeAccountContext=function(e){return E(this,void 0,void 0,(function(){var t,r,n,o=this;return S(this,(function(i){switch(i.label){case 0:return t=this.getTokenKeys(),r=e.generateAccountId(),n=[],t.idToken.forEach((function(e){0===e.indexOf(r)&&o.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(r)&&n.push(o.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(r)&&o.removeRefreshToken(e)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},e.prototype.removeAccessToken=function(e){return E(this,void 0,void 0,(function(){var t,r;return S(this,(function(n){switch(n.label){case 0:if(!(t=this.getAccessTokenCredential(e)))return[2];if(t.credentialType.toLowerCase()!==j.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==$.POP)return[3,4];if(!(r=t.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),_e.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},e.prototype.readCacheRecord=function(e,t,r){var n=this.getTokenKeys(),o=this.readAccountFromCache(e),i=this.getIdToken(e,n),s=this.getAccessToken(e,t,n),a=this.getRefreshToken(e,!1,n),c=this.readAppMetadataFromCache(r);return o&&i&&(o.idTokenClaims=new Pe(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:s,refreshToken:a,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=Re.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.getIdToken=function(e,t){this.commonLogger.trace("CacheManager - getIdToken called");var r={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:j.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(r,t),o=n.length;if(o<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(o>1)throw _e.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0]},e.prototype.getIdTokensByFilter=function(e,t){var r=this,n=t&&t.idToken||this.getTokenKeys().idToken,o=[];return n.forEach((function(t){if(r.idTokenKeyMatchesFilter(t,b({clientId:r.clientId},e))){var n=r.getIdTokenCredential(t);n&&r.credentialMatchesFilter(n,e)&&o.push(n)}})),o},e.prototype.idTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.removeIdToken=function(e){this.removeItem(e)},e.prototype.removeRefreshToken=function(e){this.removeItem(e)},e.prototype.getAccessToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getAccessToken called");var o=Te.createSearchScopes(t.scopes),i=t.authenticationScheme||$.BEARER,s=i&&i.toLowerCase()!==$.BEARER.toLowerCase()?j.ACCESS_TOKEN_WITH_AUTH_SCHEME:j.ACCESS_TOKEN,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:e.tenantId,target:o,tokenType:i,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=r&&r.accessToken||this.getTokenKeys().accessToken,g=[];c.forEach((function(e){if(n.accessTokenKeyMatchesFilter(e,a,!0)){var t=n.getAccessTokenCredential(e);t&&n.credentialMatchesFilter(t,a)&&g.push(t)}}));var y=g.length;if(y<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(y>1)throw _e.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),g[0]},e.prototype.accessTokenKeyMatchesFilter=function(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var o=t.target.asArray(),i=0;i<o.length;i++){if(r&&!n.includes(o[i].toLowerCase()))return!1;if(!r&&n.includes(o[i].toLowerCase()))return!0}return!0},e.prototype.getAccessTokensByFilter=function(e){var t=this,r=this.getTokenKeys(),n=[];return r.accessToken.forEach((function(r){if(t.accessTokenKeyMatchesFilter(r,e,!0)){var o=t.getAccessTokenCredential(r);o&&t.credentialMatchesFilter(o,e)&&n.push(o)}})),n},e.prototype.getRefreshToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var o=t?J:void 0,i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:j.REFRESH_TOKEN,clientId:this.clientId,familyId:o},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,a=[];return s.forEach((function(e){if(n.refreshTokenKeyMatchesFilter(e,i)){var t=n.getRefreshTokenCredential(e);t&&n.credentialMatchesFilter(t,i)&&a.push(t)}})),a.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),a[0])},e.prototype.refreshTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))},e.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((function(e){return r[e]})),o=n.length;if(o<1)return null;if(o>1)throw _e.createMultipleMatchingAppMetadataInCacheError();return n[0]},e.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==J)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchLocalAccountId=function(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)},e.prototype.matchUsername=function(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){return!(e.credentialType!==j.ACCESS_TOKEN&&e.credentialType!==j.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Te.fromString(e.target).containsScopeSet(t)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(V)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(X)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return X+"-"+this.clientId+"-"+e},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.prototype.setAccount=function(){throw ye.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ye.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ye.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ye.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ye.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ye.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ye.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ye.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ye.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ye.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ye.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ye.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ye.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ye.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ye.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw ye.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw ye.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",ye.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw ye.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(Ue),xe=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,s,a,c,g,y,v,_,w,b,E){var S,T,I=new t;I.homeAccountId=e,I.credentialType=j.ACCESS_TOKEN,I.secret=n;var k=xe.nowSeconds();if(I.cachedAt=k.toString(),I.expiresOn=a.toString(),I.extendedExpiresOn=c.toString(),y&&(I.refreshOn=y.toString()),I.environment=r,I.clientId=o,I.realm=i,I.target=s,I.userAssertionHash=_,I.tokenType=Se.isEmpty(v)?$.BEARER:v,b&&(I.requestedClaims=b,I.requestedClaimsHash=E),(null===(S=I.tokenType)||void 0===S?void 0:S.toLowerCase())!==$.BEARER.toLowerCase())switch(I.credentialType=j.ACCESS_TOKEN_WITH_AUTH_SCHEME,I.tokenType){case $.POP:var A=Pe.extractTokenClaims(n,g);if(!(null===(T=null==A?void 0:A.cnf)||void 0===T?void 0:T.kid))throw _e.createTokenClaimsRequiredError();I.keyId=A.cnf.kid;break;case $.SSH:I.keyId=w}return I},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===j.ACCESS_TOKEN||e.credentialType===j.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(we),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,s){var a=new t;return a.clientId=o,a.credentialType=j.REFRESH_TOKEN,a.environment=r,a.homeAccountId=e,a.secret=n,a.userAssertionHash=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===j.REFRESH_TOKEN)},t}(we),Le=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[V,e,t].join(F.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(V)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),De=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(ee.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),Ke=function(){function e(){this.expiresAt=xe.nowSeconds()+Q}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=xe.nowSeconds()+Q},e.prototype.isExpired=function(){return this.expiresAt<=xe.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(X)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}(),Fe=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(de));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),je=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return Se.isEmpty(r)?o:""+o+N.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw _e.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw _e.createNoCryptoObjectError("parseRequestState");if(Se.isEmpty(t))throw _e.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(N.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(N.RESOURCE_DELIM):N.EMPTY_STRING,i=e.base64Decode(n),s=JSON.parse(i);return{userRequestState:Se.isEmpty(o)?N.EMPTY_STRING:o,libraryState:s}}catch(a){throw _e.createInvalidStateError(t,a)}},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Ae||(Ae={}));var Be,Ge,We,ze,Ye,Ve,Je,Xe,Ze,Qe={createNewGuid:function(){throw ye.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ye.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ye.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",ye.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",ye.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",ye.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",ye.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",ye.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Crypto interface - hashString() has not been implemented",ye.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},$e={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},et=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return i(t,e),t.createPkceNotGeneratedError=function(e){return new t($e.pkceNotGenerated.code,$e.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t($e.cryptoDoesNotExist.code,$e.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t($e.httpMethodNotImplementedError.code,$e.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t($e.emptyNavigateUriError.code,$e.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t($e.hashEmptyError.code,$e.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t($e.hashDoesNotContainStateError.code,$e.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t($e.hashDoesNotContainKnownPropertiesError.code,$e.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t($e.unableToParseStateError.code,$e.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t($e.stateInteractionTypeMismatchError.code,$e.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t($e.interactionInProgress.code,$e.interactionInProgress.desc)},t.createPopupWindowError=function(e){var r=$e.popupWindowError.desc;return r=Se.isEmpty(e)?r:r+" Details: "+e,new t($e.popupWindowError.code,r)},t.createEmptyWindowCreatedError=function(){return new t($e.emptyWindowError.code,$e.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t($e.userCancelledError.code,$e.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t($e.monitorPopupTimeoutError.code,$e.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t($e.monitorIframeTimeoutError.code,$e.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t($e.redirectInIframeError.code,$e.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t($e.blockTokenRequestsInHiddenIframeError.code,$e.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t($e.blockAcquireTokenInPopupsError.code,$e.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t($e.iframeClosedPrematurelyError.code,$e.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t($e.silentLogoutUnsupportedError.code,$e.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t($e.noAccountError.code,$e.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t($e.silentPromptValueError.code,$e.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t($e.unableToParseTokenRequestCacheError.code,$e.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t($e.noTokenRequestCacheError.code,$e.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t($e.authRequestNotSet.code,$e.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t($e.noCachedAuthorityError.code,$e.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t($e.invalidCacheType.code,""+$e.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t($e.notInBrowserEnvironment.code,$e.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t($e.databaseNotOpen.code,$e.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t($e.noNetworkConnectivity.code,$e.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(e,r){return new t($e.postRequestFailed.code,$e.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t($e.getRequestFailed.code,$e.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t($e.failedToParseNetworkResponse.code,$e.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t($e.unableToLoadTokenError.code,$e.unableToLoadTokenError.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t($e.signingKeyNotFoundInStorage.code,$e.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t($e.authCodeRequired.code,$e.authCodeRequired.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t($e.authCodeOrNativeAccountRequired.code,$e.authCodeOrNativeAccountRequired.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t($e.spaCodeAndNativeAccountPresent.code,$e.spaCodeAndNativeAccountPresent.desc)},t.createDatabaseUnavailableError=function(){return new t($e.databaseUnavailable.code,$e.databaseUnavailable.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t($e.unableToAcquireTokenFromNativePlatform.code,$e.unableToAcquireTokenFromNativePlatform.desc)},t.createNativeHandshakeTimeoutError=function(){return new t($e.nativeHandshakeTimeout.code,$e.nativeHandshakeTimeout.desc)},t.createNativeExtensionNotInstalledError=function(){return new t($e.nativeExtensionNotInstalled.code,$e.nativeExtensionNotInstalled.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t($e.nativeConnectionNotEstablished.code,$e.nativeConnectionNotEstablished.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t($e.nativeBrokerCalledBeforeInitialize.code,$e.nativeBrokerCalledBeforeInitialize.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t($e.nativePromptNotSupported.code,$e.nativePromptNotSupported.desc)},t}(ye),tt={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},rt="53ee284d-920a-4b59-9d30-a60315b26836",nt="ppnbnpeolgkicgegkbkbjmhlideopiji",ot="MATS";!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(Be||(Be={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(Ge||(Ge={})),function(e){e.GET="GET",e.POST="POST"}(We||(We={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(ze||(ze={})),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(Ye||(Ye={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(Ve||(Ve={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(Je||(Je={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Xe||(Xe={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Ze||(Ze={}));var it,st={scopes:U},at="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(it||(it={}));var ct,ut="msal.db",lt=ut+".keys";!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(ct||(ct={}));var dt,ht,pt={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},ft=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return i(t,e),t.createRedirectUriEmptyError=function(){return new t(pt.redirectUriNotSet.code,pt.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(pt.postLogoutUriNotSet.code,pt.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(pt.storageNotSupportedError.code,pt.storageNotSupportedError.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(pt.noRedirectCallbacksSet.code,pt.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(pt.stubPcaInstanceCalled.code,pt.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(pt.inMemRedirectUnavailable.code,pt.inMemRedirectUnavailable.desc)},t.createEntropyNotProvided=function(){return new t(pt.entropyNotProvided.code,pt.entropyNotProvided.desc)},t}(ye),gt=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==Ge.LocalStorage&&e!==Ge.SessionStorage)throw ft.createStorageNotSupportedError(e);if(!!!window[e])throw ft.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),mt=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),yt=function(){function e(t){if(this._urlString=t,Se.isEmpty(this._urlString))throw Ce.createUrlEmptyError();Se.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return Se.endsWith(t,"?")?t=t.slice(0,-1):Se.endsWith(t,"?/")&&(t=t.slice(0,-2)),Se.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw Ce.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw Ce.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Ce.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return Se.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==A.COMMON&&n[0]!==A.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ce.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!Se.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Ce.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===N.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):N.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):N.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(Se.isEmpty(t))return{};var r=e.parseHash(t),n=Se.queryStringToObject(Se.isEmpty(r)?t:r);if(!n)throw _e.createHashNotDeserializedError(JSON.stringify(n));return n},e.getDeserializedQueryString=function(t){if(Se.isEmpty(t))return{};var r=e.parseQueryString(t),n=Se.queryStringToObject(Se.isEmpty(r)?t:r);if(!n)throw _e.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(Se.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),vt=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(Se.isEmpty(t))return null;try{return je.parseRequestState(e,t).libraryState.meta}catch(r){throw _e.createInvalidStateError(t,r)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new yt(e);return yt.getDeserializedHash(t.getHash())},e}(),_t=function(e){function t(t,r,n,o){var i=e.call(this,t,n,o)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new mt,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),r.cacheMigrationEnabled&&(i.migrateCacheEntries(),i.createKeyMaps()),i}return i(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case Ge.LocalStorage:case Ge.SessionStorage:try{return new gt(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=Ge.MemoryStorage,new mt},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case Ge.LocalStorage:case Ge.SessionStorage:try{return new gt(Ge.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case Ge.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=N.CACHE_PREFIX+"."+k.ID_TOKEN,r=N.CACHE_PREFIX+"."+k.CLIENT_INFO,n=N.CACHE_PREFIX+"."+k.ERROR,o=N.CACHE_PREFIX+"."+k.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[k.ID_TOKEN,k.CLIENT_INFO,k.ERROR,k.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.createKeyMaps=function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(Ye.ACCOUNT_KEYS),r=this.getItem(Ye.TOKEN_KEYS+"."+this.clientId);t&&r?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var r;if(e.isCredentialKey(t)&&(r=e.getItem(t))){var n=e.validateAndParseJson(r);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case j.ID_TOKEN:if(be.isIdTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map");var o=Ue.toObject(new be,n),i=e.updateCredentialCacheKey(t,o);return void e.addTokenKey(i,j.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case j.ACCESS_TOKEN:case j.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(qe.isAccessTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map");var s=Ue.toObject(new qe,n);i=e.updateCredentialCacheKey(t,s);return void e.addTokenKey(i,j.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case j.REFRESH_TOKEN:if(He.isRefreshTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map");var a=Ue.toObject(new He,n);i=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(i,j.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}if(e.isAccountKey(t)&&(r=e.getItem(t))){var c=e.validateAndParseJson(r);c&&Re.isAccountEntity(c)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}}))},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(r){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var r=this.validateAndParseJson(t);return r&&Re.isAccountEntity(r)?Ue.toObject(new Re,r):(this.removeAccountKeyFromMap(e),null)},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},t.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(Ye.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},t.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(Ye.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},t.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(Ye.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},t.prototype.removeAccount=function(t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return e.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]}))}))},t.prototype.removeIdToken=function(t){e.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,j.ID_TOKEN)},t.prototype.removeAccessToken=function(t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return e.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,j.ACCESS_TOKEN),[2]}))}))},t.prototype.removeRefreshToken=function(t){e.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,j.REFRESH_TOKEN)},t.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(Ye.TOKEN_KEYS+"."+this.clientId);if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},t.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var r=this.getTokenKeys();switch(t){case j.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case j.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case j.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),_e.createUnexpectedCredentialTypeError()}this.setItem(Ye.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var r=this.getTokenKeys();switch(t){case j.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case j.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map");var o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case j.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map");var i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),_e.createUnexpectedCredentialTypeError()}this.setItem(Ye.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,j.ID_TOKEN),null;var r=this.validateAndParseJson(t);return r&&be.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Ue.toObject(new be,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,j.ID_TOKEN),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,j.ID_TOKEN)},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,j.ACCESS_TOKEN),null;var r=this.validateAndParseJson(t);return r&&qe.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Ue.toObject(new qe,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,j.ACCESS_TOKEN),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,j.ACCESS_TOKEN)},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,j.REFRESH_TOKEN),null;var r=this.validateAndParseJson(t);return r&&He.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Ue.toObject(new He,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,j.REFRESH_TOKEN),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,j.REFRESH_TOKEN)},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Le.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Ue.toObject(new Le,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&De.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Ue.toObject(new De,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Ke.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Ue.toObject(new Ke,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(Ve.WRAPPER_SKU,e),this.internalStorage.setItem(Ve.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Ve.WRAPPER_SKU)||N.EMPTY_STRING,this.internalStorage.getItem(Ve.WRAPPER_VER)||N.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(k.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var r=this.generateCacheKey(k.ACTIVE_ACCOUNT),n=this.getItem(r);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var o=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o),o):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(k.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(k.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var n=r.idTokenClaims&&r.idTokenClaims.sid;return t===n}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw _e.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Fe.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Ue.toObject(new Fe,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===Ge.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return v(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return c(this,void 0,void 0,(function(){var e=this;return g(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(N.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return N.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=N.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,N.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Se.startsWith(e,N.CACHE_PREFIX)||Se.startsWith(e,k.ADAL_ID_TOKEN)?e:N.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=je.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ze.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=je.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ze.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=je.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ze.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,r,!1),o){var c={credential:o.homeAccountId,type:Ae.HOME_ACCOUNT_ID};this.setTemporaryCache(ze.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!Se.isEmpty(n)){c={credential:n,type:Ae.UPN};this.setTemporaryCache(ze.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),Se.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(ze.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(ze.ORIGIN_URI)),this.removeItem(this.generateCacheKey(ze.URL_HASH)),this.removeItem(this.generateCacheKey(ze.CORRELATION_ID)),this.removeItem(this.generateCacheKey(ze.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(ze.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||N.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(ze.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=vt.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(ze.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(ze.REQUEST_PARAMS,!0);if(!r)throw et.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw et.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(ze.REQUEST_PARAMS)),Se.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw et.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(ze.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=N.CACHE_PREFIX+"."+ze.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=N.CACHE_PREFIX+"."+ze.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw et.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(k.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(k.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(k.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(k.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new Pe(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(ze.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(ze.REDIRECT_CONTEXT,e,!0)},t}(Ue);!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake"}(dt||(dt={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(ht||(ht={}));var wt,bt=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(wt||(wt={}));var Et,Ct=function(){function e(t,r,n){this.level=wt.Info;var o=t||e.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||function(){},this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level="number"==typeof o.logLevel?o.logLevel:wt.Info,this.correlationId=o.correlationId||N.EMPTY_STRING,this.packageName=r||N.EMPTY_STRING,this.packageVersion=n||N.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:wt.Info}},e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Se.isEmpty(t.correlationId)?Se.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+wt[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:wt.Error,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:wt.Error,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:wt.Warning,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:wt.Warning,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:wt.Info,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:wt.Info,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:wt.Verbose,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:wt.Verbose,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:wt.Trace,containsPii:!1,correlationId:t||N.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:wt.Trace,containsPii:!0,correlationId:t||N.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}();!function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(Et||(Et={}));var St={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Tt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:wt.Info,correlationId:N.EMPTY_STRING},It={sendGetRequestAsync:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",ye.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return E(this,void 0,void 0,(function(){return S(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",ye.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},kt={sku:N.SKU,version:Ne,cpu:N.EMPTY_STRING,os:N.EMPTY_STRING},At={clientSecret:N.EMPTY_STRING,clientAssertion:void 0},Rt={azureCloudInstance:Et.None,tenant:""+N.DEFAULT_COMMON_TENANT},Pt={application:{appName:"",appVersion:""}};var Ot,Nt=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return w(t,e),t}(ye),Ut=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return de+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o);throw new Nt((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||N.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[I.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(I.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||ue),r+le))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i)},e}(),Mt=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return E(this,void 0,void 0,(function(){var n,o;return S(this,(function(i){switch(i.label){case 0:Ut.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof ye?o:_e.createNetworkError(t,o);case 4:return Ut.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),xt=function(){function e(){}return e.validateRedirectUri=function(e){if(Se.isEmpty(e))throw Ce.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in H)t.push(H[r]);if(t.indexOf(e)<0)throw Ce.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(t){throw Ce.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(Se.isEmpty(e)||Se.isEmpty(t))throw Ce.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([W.PLAIN,W.S256].indexOf(e)<0)throw Ce.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),qt=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(R.RESPONSE_TYPE,encodeURIComponent(N.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(R.RESPONSE_TYPE,encodeURIComponent(N.TOKEN_RESPONSE_TYPE+" "+N.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(R.RESPONSE_MODE,encodeURIComponent(e||L.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(R.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?T(e||[],U):e||[],n=new Te(r);this.parameters.set(R.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(R.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){xt.validateRedirectUri(e),this.parameters.set(R.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){xt.validateRedirectUri(e),this.parameters.set(R.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(R.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(q.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(q.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(I.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(I.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(q.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);xt.validateClaims(r),this.parameters.set(R.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(R.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(R.X_CLIENT_SKU,e.sku),this.parameters.set(R.X_CLIENT_VER,e.version),e.os&&this.parameters.set(R.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(R.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(R.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(R.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){xt.validatePrompt(e),this.parameters.set(""+R.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){Se.isEmpty(e)||this.parameters.set(R.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(R.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(xt.validateCodeChallengeParams(e,t),!e||!t)throw Ce.createInvalidCodeChallengeParamsError();this.parameters.set(R.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(R.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(R.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(R.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(R.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(R.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(R.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){Se.isEmpty(e)||this.parameters.set(R.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){Se.isEmpty(e)||this.parameters.set(R.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(R.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(R.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(R.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,r=xt.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(n){throw Ce.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(O.ACCESS_TOKEN)||(r[O.ACCESS_TOKEN]={}),r[O.ACCESS_TOKEN][O.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(re.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(re.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){Se.isEmpty(e)||(this.parameters.set(R.TOKEN_TYPE,$.POP),this.parameters.set(R.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){Se.isEmpty(e)||(this.parameters.set(R.TOKEN_TYPE,$.SSH),this.parameters.set(R.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(R.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(R.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(R.X_MS_LIB_CAPABILITY,he)},e.prototype.addLogoutHint=function(e){this.parameters.set(R.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),Ht=function(){function e(e,t){var r,n,o,i,s,a,c,g,y,v,_,w,E,S,T;this.config=(o=(r=e).authOptions,i=r.systemOptions,s=r.loggerOptions,a=r.storageInterface,c=r.networkInterface,g=r.cryptoInterface,y=r.clientCredentials,v=r.libraryInfo,_=r.telemetry,w=r.serverTelemetryManager,E=r.persistencePlugin,S=r.serializableCache,T=b(b({},Tt),s),{authOptions:(n=o,b({clientCapabilities:[],azureCloudOptions:Rt,skipAuthorityMetadataCache:!1},n)),systemOptions:b(b({},St),i),loggerOptions:T,storageInterface:a||new Me(o.clientId,Qe,new Ct(T)),networkInterface:c||It,cryptoInterface:g||Qe,clientCredentials:y||At,libraryInfo:b(b({},kt),v),telemetry:b(b({},Pt),_),serverTelemetryManager:w||null,persistencePlugin:E||null,serializableCache:S||null}),this.logger=new Ct(this.config.loggerOptions,Oe,Ne),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Mt(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[I.CONTENT_TYPE]=N.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Ae.HOME_ACCOUNT_ID:try{var r=ke(e.credential);t[I.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Ae.UPN:t[I.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return E(this,void 0,void 0,(function(){var o;return S(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw _e.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new qt;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),Lt=["interaction_required","consent_required","login_required"],Dt=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Kt={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},Ft=function(e){function t(r,n,o,i,s,a,c){var g=e.call(this,r,n,o)||this;return Object.setPrototypeOf(g,t.prototype),g.timestamp=i||N.EMPTY_STRING,g.traceId=s||N.EMPTY_STRING,g.correlationId=a||N.EMPTY_STRING,g.claims=c||N.EMPTY_STRING,g.name="InteractionRequiredAuthError",g}return w(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&Lt.indexOf(e)>-1,o=!!r&&Dt.indexOf(r)>-1,i=!!t&&Lt.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t(Kt.noTokensFoundError.code,Kt.noTokensFoundError.desc)},t.createNativeAccountUnavailableError=function(){return new t(Kt.native_account_unavailable.code,Kt.native_account_unavailable.desc)},t}(ye),jt=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null};!function(e){e.SW="sw",e.UHW="uhw"}(Ot||(Ot={}));var Bt=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,r;return E(this,void 0,void 0,(function(){var n,o,i;return S(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.PopTokenGenerateCnf,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=s.sent(),o=this.cryptoUtils.base64Encode(JSON.stringify(n)),i={kid:n.kid,reqCnfString:o},[4,this.cryptoUtils.hashString(o)];case 2:return[2,(i.reqCnfHash=s.sent(),i)]}}))}))},e.prototype.generateKid=function(e){var t;return E(this,void 0,void 0,(function(){return S(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:Ot.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return E(this,void 0,void 0,(function(){return S(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return E(this,void 0,void 0,(function(){var o,i,s,a,c,g;return S(this,(function(y){switch(y.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,s=r.shrClaims,a=r.shrNonce,c=i?new yt(i):void 0,g=null==c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(b({at:e,ts:xe.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==g?void 0:g.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null==g?void 0:g.AbsolutePath,q:(null==g?void 0:g.QueryString)?[[],g.QueryString]:void 0,client_claims:s||void 0},n),t,r.correlationId)];case 1:return[2,y.sent()]}}))}))},e}(),Gt=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),Wt=function(){function e(e,t,r,n,o,i,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=s}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?_e.createStateNotFoundError("Cached State"):_e.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw _e.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Ft.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ft(e.error||N.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||N.EMPTY_STRING,e.trace_id||N.EMPTY_STRING,e.correlation_id||N.EMPTY_STRING,e.claims||N.EMPTY_STRING);throw new Nt(e.error||N.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Ie(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Ft.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ft(e.error,e.error_description,e.suberror,e.timestamp||N.EMPTY_STRING,e.trace_id||N.EMPTY_STRING,e.correlation_id||N.EMPTY_STRING,e.claims||N.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Nt(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,s,a,c,g){var y;return E(this,void 0,void 0,(function(){var v,_,w,b,E,T;return S(this,(function(S){switch(S.label){case 0:if(null===(y=this.performanceClient)||void 0===y||y.addQueueMeasurement(dt.HandleServerTokenResponse,t.correlation_id),t.id_token){if(v=new Pe(t.id_token||N.EMPTY_STRING,this.cryptoObj),i&&!Se.isEmpty(i.nonce)&&v.claims.nonce!==i.nonce)throw _e.createNonceMismatchError();if(o.maxAge||0===o.maxAge){if(!(_=v.claims.auth_time))throw _e.createAuthTimeNotFoundError();Pe.checkMaxAge(_,o.maxAge)}}this.homeAccountIdentifier=Re.generateHomeAccountId(t.client_info||N.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,v),i&&i.state&&(w=je.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||o.sshKid||void 0,b=this.generateCacheRecord(t,r,n,o,v,s,i),S.label=1;case 1:return S.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),E=new Gt(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(E)]):[3,3];case 2:S.sent(),S.label=3;case 3:return!a||c||!b.account||(T=b.account.generateAccountKey(),this.cacheStorage.getAccount(T))?[4,this.cacheStorage.saveCacheRecord(b)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,b,!1,o,v,w,void 0,g)]);case 4:return S.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&E?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(E)]):[3,7];case 6:S.sent(),S.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,b,!1,o,v,w,t,g)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,s){var a,c,g=t.getPreferredCache();if(Se.isEmpty(g))throw _e.createInvalidCacheEnvironmentError();!Se.isEmpty(e.id_token)&&o&&(a=be.createIdTokenEntity(this.homeAccountIdentifier,g,e.id_token||N.EMPTY_STRING,this.clientId,o.claims.tid||N.EMPTY_STRING),c=this.generateAccountEntity(e,o,t,s));var y=null;if(!Se.isEmpty(e.access_token)){var v=e.scope?Te.fromString(e.scope):new Te(n.scopes||[]),_=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,w=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,b=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,E=r+_,S=E+w,T=b&&b>0?r+b:void 0;y=qe.createAccessTokenEntity(this.homeAccountIdentifier,g,e.access_token||N.EMPTY_STRING,this.clientId,o?o.claims.tid||N.EMPTY_STRING:t.tenant,v.printScopes(),E,S,this.cryptoObj,T,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var I=null;Se.isEmpty(e.refresh_token)||(I=He.createRefreshTokenEntity(this.homeAccountIdentifier,g,e.refresh_token||N.EMPTY_STRING,this.clientId,e.foci,i));var k=null;return Se.isEmpty(e.foci)||(k=Le.createAppMetadataEntity(this.clientId,g,e.foci)),new jt(c,a,y,I,k)},e.prototype.generateAccountEntity=function(e,t,r,n){var o=r.authorityType,i=n?n.cloud_graph_host_name:N.EMPTY_STRING,s=n?n.msgraph_host:N.EMPTY_STRING;if(o===ge.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Re.createGenericAccount(this.homeAccountIdentifier,t,r,i,s);if(Se.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw _e.createClientInfoEmptyError();return e.client_info?Re.createAccount(e.client_info,this.homeAccountIdentifier,t,r,i,s):Re.createGenericAccount(this.homeAccountIdentifier,t,r,i,s)},e.generateAuthenticationResult=function(e,t,r,n,o,i,s,a,c){var g,y,v;return E(this,void 0,void 0,(function(){var _,w,b,E,T,I,k,A,R,O,U;return S(this,(function(S){switch(S.label){case 0:if(_=N.EMPTY_STRING,w=[],b=null,T=N.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==$.POP)return[3,2];if(I=new Bt(e),k=r.accessToken,A=k.secret,!(R=k.keyId))throw _e.createKeyIdMissingError();return[4,I.signPopToken(A,R,o)];case 1:return _=S.sent(),[3,3];case 2:_=r.accessToken.secret,S.label=3;case 3:w=Te.fromString(r.accessToken.target).asArray(),b=new Date(1e3*Number(r.accessToken.expiresOn)),E=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),S.label=4;case 4:return r.appMetadata&&(T=r.appMetadata.familyId===J?J:N.EMPTY_STRING),O=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||N.EMPTY_STRING,U=(null==i?void 0:i.claims.tid)||N.EMPTY_STRING,(null==a?void 0:a.spa_accountid)&&r.account&&(r.account.nativeAccountId=null==a?void 0:a.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:O,tenantId:U,scopes:w,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:N.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:_,fromCache:n,expiresOn:b,correlationId:o.correlationId,requestId:c||N.EMPTY_STRING,extExpiresOn:E,familyId:T,tokenType:(null===(g=r.accessToken)||void 0===g?void 0:g.tokenType)||N.EMPTY_STRING,state:s?s.userRequestState:N.EMPTY_STRING,cloudGraphHostName:(null===(y=r.account)||void 0===y?void 0:y.cloudGraphHostName)||N.EMPTY_STRING,msGraphHost:(null===(v=r.account)||void 0===v?void 0:v.msGraphHost)||N.EMPTY_STRING,code:null==a?void 0:a.spa_code,fromNativeBroker:!1}]}}))}))},e}(),zt=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.includeRedirectUri=!0,n}return w(t,e),t.prototype.getAuthCodeUrl=function(e){var t,r;return E(this,void 0,void 0,(function(){var n;return S(this,(function(o){switch(o.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.GetAuthCodeUrl,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return n=o.sent(),[2,yt.appendQueryString(this.authority.authorizationEndpoint,n)]}}))}))},t.prototype.acquireToken=function(e,t){var r,n,o,i,s,a;return E(this,void 0,void 0,(function(){var c,g,y,v,_,w,b=this;return S(this,(function(E){switch(E.label){case 0:if(!e||!e.code)throw _e.createTokenRequestCannotBeMadeError();return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.AuthClientAcquireToken,e.correlationId),c=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),g=xe.nowSeconds(),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return y=E.sent(),v=null===(i=y.headers)||void 0===i?void 0:i[I.X_MS_REQUEST_ID],(_=null===(s=y.headers)||void 0===s?void 0:s[I.X_MS_HTTP_VERSION])&&(null==c||c.addStaticFields({httpVerAuthority:_})),(w=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(y.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(dt.HandleServerTokenResponse,e.correlationId),[2,w.handleServerTokenResponse(y.body,this.authority,g,e,t,void 0,void 0,void 0,v).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw b.logger.verbose("Error in fetching token in ACC",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new yt(e),o=yt.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw _e.createNoAuthCodeInServerResponseError();return b(b({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw Ce.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return yt.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){var r,n;return E(this,void 0,void 0,(function(){var o,i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.AuthClientExecuteTokenRequest,t.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.AuthClientCreateTokenRequestBody,t.correlationId),o=this.createTokenQueryParameters(t),i=yt.appendQueryString(e.tokenEndpoint,o),[4,this.createTokenRequestBody(t)];case 1:if(s=v.sent(),a=void 0,t.clientInfo)try{c=Ie(t.clientInfo,this.cryptoUtils),a={credential:""+c.uid+F.CLIENT_INFO_SEPARATOR+c.utid,type:Ae.HOME_ACCOUNT_ID}}catch(_){this.logger.verbose("Could not parse client info for CCS Header: "+_)}return g=this.createTokenRequestHeaders(a||t.ccsCredential),y={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(i,s,g,y)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r;return E(this,void 0,void 0,(function(){var n,o,i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthClientCreateTokenRequestBody,e.correlationId),(n=new qt).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):xt.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,n.addClientAssertion(o.assertion),n.addClientAssertionType(o.assertionType)),n.addGrantType(D.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme!==$.POP?[3,2]:(i=new Bt(this.cryptoUtils,this.performanceClient),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.PopTokenGenerateCnf,e.correlationId),[4,i.generateCnf(e)]);case 1:return s=v.sent(),n.addPopToken(s.reqCnfString),[3,3];case 2:if(e.authenticationScheme===$.SSH){if(!e.sshJwk)throw Ce.createMissingSshJwkError();n.addSshJwk(e.sshJwk)}v.label=3;case 3:if(a=e.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(a),(!Se.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),c=void 0,e.clientInfo)try{g=Ie(e.clientInfo,this.cryptoUtils),c={credential:""+g.uid+F.CLIENT_INFO_SEPARATOR+g.utid,type:Ae.HOME_ACCOUNT_ID}}catch(_){this.logger.verbose("Could not parse client info for CCS Header: "+_)}else c=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case Ae.HOME_ACCOUNT_ID:try{g=ke(c.credential),n.addCcsOid(g)}catch(_){this.logger.verbose("Could not parse home account ID for CCS Header: "+_)}break;case Ae.UPN:n.addCcsUpn(c.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[R.RETURN_SPA_CODE]||n.addExtraQueryParameters(((y={})[R.RETURN_SPA_CODE]="1",y)),[2,n.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return E(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return S(this,(function(g){switch(g.label){case 0:if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthClientCreateQueryString,e.correlationId),(r=new qt).addClientId(this.config.authOptions.clientId),n=T(e.scopes||[],e.extraScopesToConsent||[]),r.addScopes(n),r.addRedirectUri(e.redirectUri),o=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(o),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==H.SELECT_ACCOUNT)if(e.sid&&e.prompt===H.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){if(i=this.extractAccountSid(e.account),s=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(s);try{a=ke(e.account.homeAccountId),r.addCcsOid(a)}catch(y){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===H.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(i);try{a=ke(e.account.homeAccountId),r.addCcsOid(a)}catch(y){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{a=ke(e.account.homeAccountId),r.addCcsOid(a)}catch(y){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(!Se.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(r.addNativeBroker(),e.authenticationScheme!==$.POP?[3,2]:[4,new Bt(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:c=g.sent(),r.addPopToken(c.reqCnfHash),g.label=2;case 2:return[2,r.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new qt;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},t.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},t}(Ht);function Yt(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}var Vt,Jt={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},Xt={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};!function(e){e.AAD="AAD",e.OIDC="OIDC"}(Vt||(Vt={}));var Zt,Qt,$t=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,o,i,s;return E(this,void 0,void 0,(function(){var a,c,g,y,v;return S(this,(function(_){switch(_.label){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(dt.RegionDiscoveryDetectRegion,this.correlationId),a=t)return[3,8];c=e.IMDS_OPTIONS,_.label=1;case 1:return _.trys.push([1,6,,7]),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(N.IMDS_VERSION,c)];case 2:return(g=_.sent()).status===ne.httpSuccess&&(a=g.body,r.region_source=oe.IMDS),g.status!==ne.httpBadRequest?[3,5]:(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(dt.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(c)]);case 3:return(y=_.sent())?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(dt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(y,c)]):(r.region_source=oe.FAILED_AUTO_DETECTION,[2,null]);case 4:(v=_.sent()).status===ne.httpSuccess&&(a=v.body,r.region_source=oe.IMDS),_.label=5;case 5:return[3,7];case 6:return _.sent(),r.region_source=oe.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=oe.ENVIRONMENT_VARIABLE,_.label=9;case 9:return a||(r.region_source=oe.FAILED_AUTO_DETECTION),[2,a||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return E(this,void 0,void 0,(function(){return S(this,(function(n){return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(N.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,N.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return E(this,void 0,void 0,(function(){var r;return S(this,(function(n){switch(n.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(N.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===ne.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),er=function(){function e(e,t,r,n,o,i,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=i,this.correlationId=s,this.regionDiscovery=new $t(t,this.performanceClient,this.correlationId)}return Object.defineProperty(e.prototype,"authorityType",{get:function(){if(this.canonicalAuthorityUrlComponents.HostNameAndPort.endsWith(N.CIAM_AUTH_URL))return ge.Ciam;var e=this.canonicalAuthorityUrlComponents.PathSegments;if(e.length)switch(e[0].toLowerCase()){case N.ADFS:return ge.Adfs;case N.DSTS:return ge.Dsts}return ge.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new yt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw _e.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(e)}throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new yt(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===ge.Adfs||this.authorityType===ge.Dsts||this.protocolMode===Vt.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e,t,r;return E(this,void 0,void 0,(function(){var n,o,i,s;return S(this,(function(a){switch(a.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(dt.AuthorityResolveEndpointsAsync,this.correlationId),(n=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(n=new Ke).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(dt.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(n)];case 1:return o=a.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(n)];case 2:return i=a.sent(),o!==Y.CACHE&&i!==Y.CACHE&&(n.resetExpiresAt(),n.updateCanonicalAuthority(this.canonicalAuthority)),s=this.cacheManager.generateAuthorityMetadataCacheKey(n.preferred_cache),this.cacheManager.setAuthorityMetadata(s,n),this.metadata=n,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,r,n,o,i,s;return E(this,void 0,void 0,(function(){var a,c;return S(this,(function(g){switch(g.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthorityUpdateEndpointMetadata,this.correlationId),(a=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(a,!1),[2,Y.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Y.CACHE]:(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(a=g.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(a)]):[3,3]:[3,4];case 2:a=g.sent(),g.label=3;case 3:return e.updateEndpointMetadata(a,!0),[2,Y.NETWORK];case 4:return!(c=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(dt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(c)]):[3,6];case 5:c=g.sent(),g.label=6;case 6:return e.updateEndpointMetadata(c,!1),[2,Y.HARDCODED_VALUES];case 7:throw _e.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new yt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Ce.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return E(this,void 0,void 0,(function(){var t,r;return S(this,(function(n){switch(n.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(dt.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,Yt((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in Jt?Jt[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var r,n,o,i,s,a,c;return E(this,void 0,void 0,(function(){var g,y;return S(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata)];case 1:return g=v.sent(),y=(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)===N.AZURE_REGION_AUTO_DISCOVER_FLAG?g:null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion,(null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.azureRegion)===N.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=g?se.AUTO_DETECTION_REQUESTED_SUCCESSFUL:se.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=g?(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.azureRegion)===g?se.CONFIGURED_MATCHES_DETECTED:se.CONFIGURED_NOT_DETECTED:se.CONFIGURED_NO_AUTO_DETECTION,y?(this.regionDiscoveryMetadata.region_used=y,[2,e.replaceWithRegionalInformation(t,y)]):[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t,r;return E(this,void 0,void 0,(function(){var n,o,i;return S(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||N.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||N.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||N.NOT_APPLICABLE)),(n=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(n,!1),[2,Y.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),o=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found metadata in the cache."),[2,Y.CACHE]):(o&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(n=s.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(n,!0),[2,Y.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(i=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(i,!1),[2,Y.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Ce.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===ge.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(n){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ce.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return E(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g;return S(this,(function(y){switch(y.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+N.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},o=null,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(i=y.sent(),s=void 0,a=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(i.body))s=i.body,a=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+i.status),(s=i.body).error===N.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=e.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return(c=y.sent())instanceof ye?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+c.errorCode+"\nError Description: "+c.errorMessage):(g=c,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+g.name+"\nError Description: "+g.message)),[2,null];case 4:return o||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),o=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,o]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in Xt?Xt[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return yt.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==Et.None){var n=t.tenant?t.tenant:N.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw _e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return N.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new yt(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+N.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=yt.constructAuthorityUriFromObject(b(b({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?s+"?"+r:s},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,N.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e.transformCIAMAuthority=function(e){var t=e,r=new yt(e).getUrlComponents();0===r.PathSegments.length&&r.HostNameAndPort.endsWith(N.CIAM_AUTH_URL)&&(t=""+t+r.HostNameAndPort.split(".")[0]+N.AAD_TENANT_DOMAIN_SUFFIX);return t},e}(),tr=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o,i,s,a){return E(this,void 0,void 0,(function(){var c,g,y;return S(this,(function(v){switch(v.label){case 0:null==s||s.addQueueMeasurement(dt.AuthorityFactoryCreateDiscoveredInstance,a),c=er.transformCIAMAuthority(t),g=e.createInstance(c,r,n,o,i,s,a),v.label=1;case 1:return v.trys.push([1,3,,4]),null==s||s.setPreQueueTime(dt.AuthorityResolveEndpointsAsync,a),[4,g.resolveEndpointsAsync()];case 2:return v.sent(),[2,g];case 3:throw y=v.sent(),_e.createEndpointDiscoveryIncompleteError(y);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,o,i,s){if(Se.isEmpty(e))throw Ce.createUrlEmptyError();return new er(e,t,r,n,o,i,s)},e}(),rr=function(){function e(e,t){this.cacheOutcome=ae.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||N.EMPTY_STRING,this.wrapperVer=e.wrapperVer||N.EMPTY_STRING,this.telemetryCacheKey=ee.CACHE_KEY+F.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+ee.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(ee.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(ee.VALUE_SEPARATOR);return[ee.SCHEMA_VERSION,r,t].join(ee.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(ee.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(ee.VALUE_SEPARATOR),i=t.errors.length,s=[i,r<i?ee.OVERFLOW_TRUE:ee.OVERFLOW_FALSE].join(ee.VALUE_SEPARATOR);return[ee.SCHEMA_VERSION,t.cacheHits,n,o,s].join(ee.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=ee.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),Se.isEmpty(e.subError)?Se.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(ee.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new De;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new De;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||N.EMPTY_STRING,s=e.failedRequests[2*t+1]||N.EMPTY_STRING,a=e.errors[t]||N.EMPTY_STRING;if(!((n+=i.toString().length+s.toString().length+a.length+3)<ee.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||N.EMPTY_STRING),e.push(this.regionSource||N.EMPTY_STRING),e.push(this.regionOutcome||N.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),nr="@azure/msal-browser",or="2.35.0",ir=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o;return g(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:We.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?et.createGetRequestFailedError(n,e):et.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),et.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i;return g(this,(function(s){switch(s.label){case 0:r=t&&t.body||N.EMPTY_STRING,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:We.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=s.sent(),[3,4];case 3:throw o=s.sent(),window.navigator.onLine?et.createPostRequestFailedError(o,e):et.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=s.sent(),i.status=n.status,i)];case 6:throw s.sent(),et.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),sr=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.sendRequestAsync(e,We.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.sendRequestAsync(e,We.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),n.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===We.POST?i(et.createPostRequestFailedError("Failed with status "+s.status,e)):i(et.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),a={headers:n.getHeaderDict(s),body:r,status:s.status};o(a)}catch(c){i(et.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===We.POST?i(et.createPostRequestFailedError("Failed with status "+s.status,e)):i(et.createGetRequestFailedError("Failed with status "+s.status,e)):i(et.createNoNetworkConnectivityError())},t===We.POST&&r&&r.body)s.send(r.body);else{if(t!==We.GET)throw et.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),ar=function(){function e(){}return e.clearHash=function(e){e.location.hash=N.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,N.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):N.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(tt.POPUP_NAME_PREFIX+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new yt(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new ir:new sr},e.blockReloadInHiddenIframes=function(){if(yt.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw et.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===Xe.Redirect&&n&&!r)throw et.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw et.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw et.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw et.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),cr=function(){function e(e,t,r,n,o,i,s,a,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=a,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=n.clone(tt.MSAL_SKU,or,this.correlationId),this.performanceClient=s}return e.prototype.clearCacheOnLogout=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];Re.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Re.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o;return g(this,(function(i){switch(i.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=v(e&&e.scopes||[]),(n=s(s({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(n.authenticationScheme===$.SSH){if(!e.sshJwk)throw Ce.createMissingSshJwkError();if(!e.sshKid)throw Ce.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}else n.authenticationScheme=$.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||Se.isEmpty(e.claims)?[3,2]:(o=n,[4,this.browserCrypto.hashString(e.claims)]);case 1:o.requestedClaimsHash=i.sent(),i.label=2;case 2:return[2,n]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||ar.getCurrentUri();return yt.getAbsoluteUrl(t,ar.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new rr(r,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,tr.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,tr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}}))}))},e}(),ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=s(s({},e),{redirectUri:e.redirectUri,code:N.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=N.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=s({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=yt.getAbsoluteUrl(e.postLogoutRedirectUri,ar.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=yt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ar.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=yt.getAbsoluteUrl(ar.getCurrentUri(),ar.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return c(this,void 0,void 0,(function(){var n;return g(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new zt(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o;return g(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=i.sent(),o=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:tt.MSAL_SKU,version:or,cpu:N.EMPTY_STRING,os:N.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw et.createHashDoesNotContainStateError();var n=vt.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw et.createUnableToParseStateError();if(n.interactionType!==t)throw et.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return c(this,void 0,void 0,(function(){var n,o,i,s;return g(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,s=er.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(dt.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,tr.createDiscoveredInstance(s,this.config.system.networkClient,this.browserStorage,o,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,a.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i,a,c,y;return g(this,(function(g){switch(g.label){case 0:return this.performanceClient.addQueueMeasurement(dt.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=je.setRequestState(this.browserCrypto,e&&e.state||N.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(dt.InitializeBaseRequest,this.correlationId),a=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=s.apply(void 0,[s.apply(void 0,a.concat([g.sent()])),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:L.FRAGMENT}]),(c=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+c.homeAccountId,this.correlationId),i.account=c),Se.isEmpty(i.loginHint)&&!c&&(y=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=y),[2,i]}}))}))},t}(cr),lr=function(){function e(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i,s;return g(this,(function(a){if(this.performanceClient.addQueueMeasurement(dt.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),Se.isEmpty(e))throw et.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw _e.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,i)}catch(c){throw c instanceof Nt&&c.subError===$e.userCancelledError.code?et.createUserCancelledError():c}return this.performanceClient.setPreQueueTime(dt.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(s,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,o){return void 0===o&&(o=!0),c(this,void 0,void 0,(function(){var i,s,a,c,y,v;return g(this,(function(g){switch(g.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw _e.createStateNotFoundError("Cached State");return a=this.browserStorage.generateNonceKey(s),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(dt.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];case 1:g.sent(),g.label=2;case 2:return o&&(e.nonce=c||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(y=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=y),this.performanceClient.setPreQueueTime(dt.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return v=g.sent(),this.browserStorage.cleanRequestByState(t),[2,v]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o;return g(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(dt.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,tr.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(ze.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),dr=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r,n,o,s)||this;return a.browserCrypto=i,a}return i(t,e),t.prototype.initiateAuthRequest=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(n.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),Se.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ze.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(ze.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:Je.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return n.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),et.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i,s,a,c,y,v;return g(this,(function(g){switch(g.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),Se.isEmpty(e))throw et.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw _e.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,i)}catch(_){throw _ instanceof Nt&&_.subError===$e.userCancelledError.code?et.createUserCancelledError():_}return a=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,n)]:[3,2];case 1:g.sent(),g.label=2;case 2:return s.nonce=c||void 0,s.state=i,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(y=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=y),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return v=g.sent(),this.browserStorage.cleanRequestByState(t),[2,v]}}))}))},t}(lr);!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Zt||(Zt={})),function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(Qt||(Qt={}));var hr={code:"ContentError"},pr={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},fr={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},gr=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=o,i}return i(t,e),t.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==Qt.PERSISTENT_ERROR&&this.ext.status!==Qt.DISABLED)||this.errorCode===hr.code},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case Qt.ACCOUNT_UNAVAILABLE:return Ft.createNativeAccountUnavailableError();case Qt.USER_INTERACTION_REQUIRED:return new Ft(e,r);case Qt.USER_CANCEL:return et.createUserCancelledError();case Qt.NO_NETWORK:return et.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(pr.code,pr.desc)},t.createTokensNotFoundInCacheError=function(){return new t(fr.code,fr.desc)},t}(ye),mr=function(e){function t(t,r){return e.call(this,t,r)||this}return w(t,e),t.prototype.acquireToken=function(e){var t,r,n,o,i,s,a;return E(this,void 0,void 0,(function(){var c,g,y,v,_,w,b=this;return S(this,(function(E){switch(E.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RefreshTokenClientAcquireToken,e.correlationId),c=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),g=xe.nowSeconds(),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return y=E.sent(),v=null===(o=y.headers)||void 0===o?void 0:o[I.X_MS_HTTP_VERSION],null==c||c.addStaticFields({refreshTokenSize:(null===(i=y.body.refresh_token)||void 0===i?void 0:i.length)||0}),v&&(null==c||c.addStaticFields({httpVerToken:v})),_=null===(s=y.headers)||void 0===s?void 0:s[I.X_MS_REQUEST_ID],(w=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(y.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(dt.HandleServerTokenResponse,e.correlationId),[2,w.handleServerTokenResponse(y.body,this.authority,g,e,void 0,void 0,!0,e.forceCache,_).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw b.logger.verbose("Error in fetching refresh token",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,r,n,o;return E(this,void 0,void 0,(function(){var i,s;return S(this,(function(a){if(!e)throw Ce.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw _e.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(c){if(i=c instanceof Ft&&c.errorCode===Kt.noTokensFoundError.code,s=c instanceof Nt&&c.errorCode===pe&&c.subError===fe,i||s)return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw c}return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var r,n,o;return E(this,void 0,void 0,(function(){var i,s,a;return S(this,(function(c){if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(dt.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),!(s=this.cacheManager.getRefreshToken(e.account,t)))throw null==i||i.discardMeasurement(),Ft.createNoTokensFoundError();return null==i||i.endMeasurement({success:!0}),a=b(b({},e),{refreshToken:s.secret,authenticationScheme:e.authenticationScheme||$.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Ae.HOME_ACCOUNT_ID}}),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(a)]}))}))},t.prototype.executeTokenRequest=function(e,t){var r,n,o;return E(this,void 0,void 0,(function(){var i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(dt.RefreshTokenClientExecuteTokenRequest,e.correlationId),i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(dt.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(dt.RefreshTokenClientCreateTokenRequestBody,e.correlationId),s=this.createTokenQueryParameters(e),a=yt.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(e)];case 1:return c=v.sent(),g=this.createTokenRequestHeaders(e.ccsCredential),y={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(a,c,g,y).then((function(e){return null==i||i.endMeasurement({success:!0}),e})).catch((function(e){throw null==i||i.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r,n;return E(this,void 0,void 0,(function(){var o,i,s,a,c,g,y;return S(this,(function(v){switch(v.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dt.RefreshTokenClientCreateTokenRequestBody,e.correlationId),o=e.correlationId,i=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.BaseClientCreateTokenRequestHeaders,o),(s=new qt).addClientId(this.config.authOptions.clientId),s.addScopes(e.scopes),s.addGrantType(D.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&s.addServerTelemetry(this.serverTelemetryManager),s.addCorrelationId(o),s.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(a=this.config.clientCredentials.clientAssertion,s.addClientAssertion(a.assertion),s.addClientAssertionType(a.assertionType)),e.authenticationScheme!==$.POP?[3,2]:(c=new Bt(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(dt.PopTokenGenerateCnf,e.correlationId),[4,c.generateCnf(e)]);case 1:return g=v.sent(),s.addPopToken(g.reqCnfString),[3,3];case 2:if(e.authenticationScheme===$.SSH){if(!e.sshJwk)throw null==i||i.endMeasurement({success:!1}),Ce.createMissingSshJwkError();s.addSshJwk(e.sshJwk)}v.label=3;case 3:if((!Se.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Ae.HOME_ACCOUNT_ID:try{y=ke(e.ccsCredential.credential),s.addCcsOid(y)}catch(_){this.logger.verbose("Could not parse home account ID for CCS Header: "+_)}break;case Ae.UPN:s.addCcsUpn(e.ccsCredential.credential)}return null==i||i.endMeasurement({success:!0}),[2,s.createQueryString()]}}))}))},t}(Ht),yr=function(e){function t(t,r){return e.call(this,t,r)||this}return w(t,e),t.prototype.acquireToken=function(e){return E(this,void 0,void 0,(function(){var t;return S(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof _e&&t.errorCode===ve.tokenRefreshRequired.code)return[2,new mr(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return E(this,void 0,void 0,(function(){var i,s;return S(this,(function(a){switch(a.label){case 0:if(!e)throw Ce.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(ae.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),_e.createRefreshRequiredError();if(!e.account)throw _e.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(s=this.cacheManager.readCacheRecord(e.account,e,i)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(ae.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),_e.createRefreshRequiredError();if(xe.wasClockTurnedBack(s.accessToken.cachedAt)||xe.isTokenExpired(s.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(ae.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),_e.createRefreshRequiredError();if(s.accessToken.refreshOn&&xe.isTokenExpired(s.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(ae.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),_e.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(s,e)];case 1:return[2,a.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return E(this,void 0,void 0,(function(){var r,n;return S(this,(function(o){switch(o.label){case 0:if(e.idToken&&(r=new Pe(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null==r?void 0:r.claims.auth_time))throw _e.createAuthTimeNotFoundError();Pe.checkMaxAge(n,t.maxAge)}return[4,Wt.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}}))}))},t}(Ht),vr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i;return g(this,(function(s){switch(s.label){case 0:return t=this.performanceClient.startMeasurement(dt.SilentCacheClientAcquireToken,e.correlationId),r=this.initializeServerTelemetryManager(Je.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,e.authority,e.azureCloudOptions)];case 1:n=s.sent(),this.logger.verbose("Silent auth client created"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,n.acquireCachedToken(e)];case 3:return o=s.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,o];case 4:throw(i=s.sent())instanceof et&&i.errorCode===$e.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:i instanceof ye&&i.errorCode||void 0,subErrorCode:i instanceof ye&&i.subError||void 0,success:!1}),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return c(this,void 0,void 0,(function(){var n;return g(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new yr(n,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(dt.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(dt.InitializeBaseRequest,this.correlationId),r=[s({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,s.apply(void 0,[s.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(ur),_r=function(e){function t(t,r,n,o,i,s,a,c,g,y,v,_){var w=e.call(this,t,r,n,o,i,s,c,g,_)||this;return w.apiId=a,w.accountId=y,w.nativeMessageHandler=g,w.nativeStorageManager=v,w.silentCacheClient=new vr(t,w.nativeStorageManager,n,o,i,s,c,g,_),w}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s,a;return g(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(dt.NativeInteractionClientAcquireToken,e.correlationId),r=xe.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return o=c.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,o];case 4:return c.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:Be.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return s=c.sent(),a=this.validateNativeResponse(s),[2,this.handleNativeResponse(a,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Te.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return c(this,void 0,void 0,(function(){var r,n;return g(this,(function(o){switch(o.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),_e.createNoAccountFoundError();if(!(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw _e.createNoAccountFoundError();o.label=1;case 1:return o.trys.push([1,3,,4]),n=this.createSilentCacheRequest(t,r),[4,this.silentCacheClient.acquireToken(n)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s;return g(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=a.sent(),r={method:Be.GetToken,request:t},a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return n=a.sent(),this.validateNativeResponse(n),[3,5];case 4:if((o=a.sent())instanceof gr&&o.isFatal())throw o;return[3,5];case 5:return this.browserStorage.setTemporaryCache(ze.NATIVE_REQUEST,JSON.stringify(t),!0),i={apiId:Je.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(s,i)];case 6:return a.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return c(this,void 0,void 0,(function(){var e,t,r,n,o,i,s,c;return g(this,(function(g){switch(g.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,r=a(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ze.NATIVE_REQUEST)),n={method:Be.GetToken,request:r},o=xe.nowSeconds(),g.label=1;case 1:return g.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return i=g.sent(),this.validateNativeResponse(i),s=this.handleNativeResponse(i,r,o),this.browserStorage.setInteractionInProgress(!1),[2,s];case 3:throw c=g.sent(),this.browserStorage.setInteractionInProgress(!1),c;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o,i,s,a,c;return g(this,(function(g){switch(g.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw gr.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return n=g.sent(),o=n.getPreferredCache(),i=this.createIdTokenObj(e),s=this.createHomeAccountIdentifier(e,i),a=this.createAccountEntity(e,s,i,o),[4,this.generateAuthenticationResult(e,t,i,a,n.canonicalAuthority,r)];case 2:return c=g.sent(),this.cacheAccount(a),this.cacheNativeTokens(e,t,s,i,c.accessToken,c.tenantId,r),[2,c]}}))}))},t.prototype.createIdTokenObj=function(e){return new Pe(e.id_token||N.EMPTY_STRING,this.browserCrypto)},t.prototype.createHomeAccountIdentifier=function(e,t){return Re.generateHomeAccountId(e.client_info||N.EMPTY_STRING,ge.Default,this.logger,this.browserCrypto,t)},t.prototype.createAccountEntity=function(e,t,r,n){return Re.createAccount(e.client_info,t,r,void 0,void 0,void 0,n,e.account.id)},t.prototype.generateScopes=function(e,t){return e.scope?Te.fromString(e.scope):Te.fromString(t.scope)},t.prototype.generatePopAccessToken=function(e,t){return c(this,void 0,void 0,(function(){var r,n;return g(this,(function(o){switch(o.label){case 0:if(t.tokenType!==$.POP)return[3,2];if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,e.shr];if(r=new Bt(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw _e.createKeyIdMissingError();return[4,r.signPopToken(e.access_token,t.keyId,n)];case 1:return[2,o.sent()];case 2:return[2,e.access_token]}}))}))},t.prototype.generateAuthenticationResult=function(e,t,r,n,o,i){return c(this,void 0,void 0,(function(){var s,a,c,y,v,_,w;return g(this,(function(g){switch(g.label){case 0:return s=this.addTelemetryFromNativeResponse(e),a=e.scope?Te.fromString(e.scope):Te.fromString(t.scope),c=e.account.properties||{},y=c.UID||r.claims.oid||r.claims.sub||N.EMPTY_STRING,v=c.TenantId||r.claims.tid||N.EMPTY_STRING,[4,this.generatePopAccessToken(e,t)];case 1:return _=g.sent(),w=t.tokenType===$.POP?$.POP:$.BEARER,[2,{authority:o,uniqueId:y,tenantId:v,scopes:a.asArray(),account:n.getAccountInfo(),idToken:e.id_token,idTokenClaims:r.claims,accessToken:_,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:w,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}]}}))}))},t.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},t.prototype.cacheNativeTokens=function(e,t,r,n,o,i,s){var a=be.createIdTokenEntity(r,t.authority,e.id_token||N.EMPTY_STRING,t.clientId,n.claims.tid||N.EMPTY_STRING);this.nativeStorageManager.setIdTokenCredential(a);var c=s+(t.tokenType===$.POP?N.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),g=this.generateScopes(e,t),y=qe.createAccessTokenEntity(r,t.authority,o,t.clientId,i,g.printScopes(),c,0,this.browserCrypto);this.nativeStorageManager.setAccessTokenCredential(y)},t.prototype.addTelemetryFromNativeResponse=function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw gr.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,c,y,v,_,w=this;return g(this,(function(g){switch(g.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,(r=new yt(t)).validateAsUri(),n=e.scopes,o=a(e,["scopes"]),(i=new Te(n||[])).appendScopes(U),c=function(){switch(w.apiId){case Je.ssoSilent:case Je.acquireTokenSilent_silentFlow:return w.logger.trace("initializeNativeRequest: silent request sets prompt to none"),H.NONE}if(e.prompt)switch(e.prompt){case H.NONE:case H.CONSENT:case H.LOGIN:return w.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw w.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),et.createNativePromptParameterNotSupportedError()}else w.logger.trace("initializeNativeRequest: prompt was not provided")},y=s(s({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:c(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:s(s(s({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:ot}),extendedExpiryToken:!1}),e.authenticationScheme!==$.POP?[3,2]:(v={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new Bt(this.browserCrypto).generateCnf(v)]);case 1:_=g.sent(),y.reqCnf=_.reqCnfHash,y.keyId=_.kid,g.label=2;case 2:return[2,y]}}))}))},t}(cr),wr=function(){function e(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(dt.NativeMessageHandlerHandshake)}return e.prototype.sendMessage=function(e){return c(this,void 0,void 0,(function(){var t,r=this;return g(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:rt,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},e.createProvider=function(t,r,n){return c(this,void 0,void 0,(function(){var o,i;return g(this,(function(s){switch(s.label){case 0:t.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),[4,(o=new e(t,r,n,nt)).sendHandshakeRequest()];case 2:return s.sent(),[2,o];case 3:return s.sent(),[4,(i=new e(t,r,n)).sendHandshakeRequest()];case 4:return s.sent(),[2,i];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return c(this,void 0,void 0,(function(){var e,t=this;return g(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:rt,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Be.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(et.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===rt&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Be.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),r.reject(et.createNativeExtensionNotInstalledError()))}}},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var o=t.body.method;if(o===Be.Response){if(!r)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(i)),"Success"!==i.status)r.reject(gr.createError(i.code,i.description,i.ext));else{if(!i.result)throw ye.createUnexpectedError("Event does not contain result.");i.result.code&&i.result.description?r.reject(gr.createError(i.result.code,i.result.description,i.result.ext)):r.resolve(i.result)}this.resolvers.delete(t.responseId)}else if(o===Be.HandshakeResponse){if(!n)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(s){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+s.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(s):n&&n.reject(s)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case $.BEARER:case $.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),br=function(e){function t(t,r,n,o,i,s,a,c,g,y){var v=e.call(this,t,r,n,o,i,s,a,g,y)||this;return v.nativeStorage=c,v}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,y,v,_=this;return g(this,(function(g){switch(g.label){case 0:return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Xe.Redirect)];case 1:t=g.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||N.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(Je.acquireTokenRedirect),n=function(e){e.persisted&&(_.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),_.browserStorage.cleanRequestByState(t.state))},g.label=2;case 2:return g.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return o=g.sent(),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return i=g.sent(),this.logger.verbose("Auth code client created"),a=new dr(i,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient),[4,i.getAuthCodeUrl(s(s({},t),{nativeBroker:wr.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return c=g.sent(),y=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+y),window.addEventListener("pageshow",n),[4,a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:y,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,g.sent()];case 7:throw(v=g.sent())instanceof ye&&v.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),r.cacheFailedRequest(v),this.browserStorage.cleanRequestByState(t.state),v;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,y,v,_,w;return g(this,(function(g){switch(g.label){case 0:t=this.initializeServerTelemetryManager(Je.handleRedirectPromise),g.label=1;case 1:if(g.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Xe.Redirect),[2,null];n=void 0;try{o=yt.getDeserializedHash(r),n=this.validateAndExtractStateFromHash(o,Xe.Redirect),this.logger.verbose("State extracted from hash")}catch(b){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+b),this.browserStorage.cleanRequestByInteractionType(Xe.Redirect),[2,null]}return i=this.browserStorage.getTemporaryCache(ze.ORIGIN_URI,!0)||N.EMPTY_STRING,s=yt.removeHashFromUrl(i),a=yt.removeHashFromUrl(window.location.href),s===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return c=g.sent(),i.indexOf("#")>-1&&ar.replaceHash(i),[2,c];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return ar.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(ze.URL_HASH,r,!0),y={apiId:Je.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},v=!0,i&&"null"!==i?[3,6]:(_=ar.getHomepage(),this.browserStorage.setTemporaryCache(ze.ORIGIN_URI,_,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(_,y)]));case 5:return v=g.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+i),[4,this.navigationClient.navigateInternal(i,y)];case 7:v=g.sent(),g.label=8;case 8:if(!v)return[2,this.handleHash(r,n,t)];g.label=9;case 9:return[2,null];case 10:throw(w=g.sent())instanceof ye&&w.setCorrelationId(this.correlationId),t.cacheFailedRequest(w),this.browserStorage.cleanRequestByInteractionType(Xe.Redirect),w;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),yt.hashContainsKnownProperties(e))return ar.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(ze.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ze.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,r){return c(this,void 0,void 0,(function(){var n,o,i,a,c,y,v=this;return g(this,(function(g){switch(g.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(o=yt.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw et.createNativeConnectionNotEstablishedError();return i=new _r(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,o.accountId,this.browserStorage,n.correlationId),a=je.parseRequestState(this.browserCrypto,t).userRequestState,[2,i.acquireToken(s(s({},n),{state:a,prompt:void 0})).finally((function(){v.browserStorage.cleanRequestByState(t)}))]}if(!(c=this.browserStorage.getCachedAuthority(t)))throw et.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(r,c)];case 1:return y=g.sent(),this.logger.verbose("Auth code client created"),Ut.removeThrottle(this.browserStorage,this.config.auth.clientId,n),[4,new dr(y,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,y.authority,this.networkClient)];case 2:return[2,g.sent()]}}))}))},t.prototype.logout=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s;return g(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Je.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(Zt.LOGOUT_START,Xe.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),n={apiId:Je.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(Zt.LOGOUT_SUCCESS,Xe.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return a.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,n)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(s=a.sent())instanceof ye&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.eventHandler.emitEvent(Zt.LOGOUT_FAILURE,Xe.Redirect,null,s),this.eventHandler.emitEvent(Zt.LOGOUT_END,Xe.Redirect),s;case 11:return this.eventHandler.emitEvent(Zt.LOGOUT_END,Xe.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return yt.getAbsoluteUrl(t,ar.getCurrentUri())},t}(ur),Er=function(e){function t(t,r,n,o,i,s,a,c,g,y){var v=e.call(this,t,r,n,o,i,s,a,g,y)||this;return v.unloadWindow=v.unloadWindow.bind(v),v.nativeStorage=c,v}return i(t,e),t.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||U,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}catch(o){return Promise.reject(o)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var s=this.openSizedPopup("about:blank",r,i);return this.logoutPopupAsync(t,r,i,n,s,o)}catch(a){return Promise.reject(a)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i,a,c,y,v,_,w,b,E,S,T,I,k,A,R,O=this;return g(this,(function(g){switch(g.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(Je.acquireTokenPopup),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Xe.Popup)];case 1:i=g.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||N.EMPTY_STRING,i.account||null),g.label=2;case 2:return g.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return a=g.sent(),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(o,i.authority,i.azureCloudOptions)];case 4:return c=g.sent(),this.logger.verbose("Auth code client created"),y=wr.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),v=void 0,y&&(v=this.performanceClient.startMeasurement(dt.FetchAccountIdWithNativeBroker,e.correlationId)),[4,c.getAuthCodeUrl(s(s({},i),{nativeBroker:y}))];case 5:return _=g.sent(),w=new lr(c,this.browserStorage,a,this.logger,this.performanceClient),b={popup:n,popupName:t,popupWindowAttributes:r},E=this.initiateAuthRequest(_,b),this.eventHandler.emitEvent(Zt.POPUP_OPENED,Xe.Popup,{popupWindow:E},null),[4,this.monitorPopupForHash(E)];case 6:if(S=g.sent(),T=yt.getDeserializedHash(S),I=this.validateAndExtractStateFromHash(T,Xe.Popup,i.correlationId),Ut.removeThrottle(this.browserStorage,this.config.auth.clientId,a),T.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),v&&v.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw et.createNativeConnectionNotEstablishedError();return k=new _r(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,T.accountId,this.nativeStorage,i.correlationId),A=je.parseRequestState(this.browserCrypto,I).userRequestState,[2,k.acquireToken(s(s({},i),{state:A,prompt:void 0})).finally((function(){O.browserStorage.cleanRequestByState(I)}))]}return[4,w.handleCodeResponseFromHash(S,I,c.authority,this.networkClient)];case 7:return[2,g.sent()];case 8:throw R=g.sent(),n&&n.close(),R instanceof ye&&R.setCorrelationId(this.correlationId),o.cacheFailedRequest(R),this.browserStorage.cleanRequestByState(i.state),R;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,o,i){return c(this,void 0,void 0,(function(){var s,a,c,y,v,_,w;return g(this,(function(g){switch(g.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Zt.LOGOUT_START,Xe.Popup,e),s=this.initializeServerTelemetryManager(Je.logoutPopup),g.label=1;case 1:return g.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return g.sent(),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(s,n)];case 3:return a=g.sent(),this.logger.verbose("Auth code client created"),c=a.getLogoutUri(e),this.eventHandler.emitEvent(Zt.LOGOUT_SUCCESS,Xe.Popup,e),y=this.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:o}),this.eventHandler.emitEvent(Zt.POPUP_OPENED,Xe.Popup,{popupWindow:y},null),[4,this.waitForLogoutPopup(y)];case 4:return g.sent(),i?(v={apiId:Je.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},_=yt.getAbsoluteUrl(i,ar.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+_),this.navigationClient.navigateInternal(_,v)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw w=g.sent(),o&&o.close(),w instanceof ye&&w.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Zt.LOGOUT_FAILURE,Xe.Popup,null,w),this.eventHandler.emitEvent(Zt.LOGOUT_END,Xe.Popup),s.cacheFailedRequest(w),w;case 6:return this.eventHandler.emitEvent(Zt.LOGOUT_END,Xe.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(Se.isEmpty(e))throw this.logger.error("Navigate url is empty"),et.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var o=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,i=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var s=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(s),void n(et.createUserCancelledError());var a=N.EMPTY_STRING,c=N.EMPTY_STRING;try{a=e.location.href,c=e.location.hash}catch(g){}Se.isEmpty(a)||"about:blank"===a||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i++,c?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(s),t.cleanPopup(e),yt.hashContainsKnownProperties(c)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(c)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+c),n(et.createHashDoesNotContainKnownPropertiesError()))):i>o&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(s),n(et.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var o=N.EMPTY_STRING;try{o=e.location.href}catch(i){}Se.isEmpty(o)||"about:blank"===o||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw et.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),et.createPopupWindowError(n.toString())}},t.prototype.openSizedPopup=function(e,t,r){var n,o,i,s,a=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,g=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,y=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,v=null===(n=r.popupSize)||void 0===n?void 0:n.width,_=null===(o=r.popupSize)||void 0===o?void 0:o.height,w=null===(i=r.popupPosition)||void 0===i?void 0:i.top,b=null===(s=r.popupPosition)||void 0===s?void 0:s.left;return(!v||v<0||v>g)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),v=tt.POPUP_WIDTH),(!_||_<0||_>y)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),_=tt.POPUP_HEIGHT),(!w||w<0||w>y)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),w=Math.max(0,y/2-tt.POPUP_HEIGHT/2+c)),(!b||b<0||b>g)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),b=Math.max(0,g/2-tt.POPUP_WIDTH/2+a)),window.open(e,t,"width="+v+", height="+_+", top="+w+", left="+b+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(Xe.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return tt.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return tt.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},t}(ur),Cr={sendGetRequestAsync:function(){return Promise.reject(ye.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ye.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},Sr=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),Tr=6e3;var Ir,kr=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r,n,o,s)||this;return a.navigateFrameWait=i.navigateFrameWait,a.pollIntervalMilliseconds=i.pollIntervalMilliseconds,a}return i(t,e),t.prototype.initiateAuthRequest=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),Se.isEmpty(e))throw this.logger.info("Navigate url is empty"),et.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(dt.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(dt.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,o){t<Tr&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Tr+"ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(s),void o(et.createMonitorIframeTimeoutError());var t=N.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:N.EMPTY_STRING}catch(g){}if(!Se.isEmpty(t)){var c=a?a.location.hash:N.EMPTY_STRING;return yt.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(s),void n(c)):void 0}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(dt.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(lr),Ar=function(e){function t(t,r,n,o,i,s,a,c,g,y,v){var _=e.call(this,t,r,n,o,i,s,c,y,v)||this;return _.apiId=a,_.nativeStorage=g,_}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i;return g(this,(function(a){switch(a.label){case 0:if(this.performanceClient.addQueueMeasurement(dt.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(dt.SilentIframeClientAcquireToken,e.correlationId),Se.isEmpty(e.loginHint)&&Se.isEmpty(e.sid)&&(!e.account||Se.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==H.NONE&&e.prompt!==H.NO_SESSION)throw t.endMeasurement({success:!1}),et.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(s(s({},e),{prompt:e.prompt||H.NONE}),Xe.Silent)];case 1:r=a.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||N.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(dt.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(o,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,a.sent()];case 5:throw(i=a.sent())instanceof ye&&i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:i instanceof ye&&i.errorCode||void 0,subErrorCode:i instanceof ye&&i.subError||void 0,success:!1}),i;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i,a,c,y,v,_,w=this;return g(this,(function(g){switch(g.label){case 0:return this.performanceClient.addQueueMeasurement(dt.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=g.sent(),this.performanceClient.setPreQueueTime(dt.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(s(s({},t),{nativeBroker:wr.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return n=g.sent(),o=new kr(e,this.browserStorage,r,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(dt.SilentHandlerInitiateAuthRequest,t.correlationId),[4,o.initiateAuthRequest(n)];case 3:return i=g.sent(),this.performanceClient.setPreQueueTime(dt.SilentHandlerMonitorIframeForHash,t.correlationId),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 4:if(a=g.sent(),c=yt.getDeserializedHash(a),y=this.validateAndExtractStateFromHash(c,Xe.Silent,r.correlationId),c.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw et.createNativeConnectionNotEstablishedError();return v=new _r(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,c.accountId,this.browserStorage,this.correlationId),_=je.parseRequestState(this.browserCrypto,y).userRequestState,[2,v.acquireToken(s(s({},t),{state:_,prompt:t.prompt||H.NONE})).finally((function(){w.browserStorage.cleanRequestByState(y)}))]}return this.performanceClient.setPreQueueTime(dt.HandleCodeResponseFromHash,t.correlationId),[2,o.handleCodeResponseFromHash(a,y,e.authority,this.networkClient)]}}))}))},t}(ur),Rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return g(this,(function(c){switch(c.label){case 0:return this.performanceClient.addQueueMeasurement(dt.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(dt.InitializeBaseRequest,e.correlationId),r=[s({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=s.apply(void 0,r.concat([c.sent()])),n=this.performanceClient.startMeasurement(dt.SilentRefreshClientAcquireToken,t.correlationId),o=this.initializeServerTelemetryManager(Je.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(o,t.authority,t.azureCloudOptions)];case 2:return i=c.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(dt.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,i.acquireTokenByRefreshToken(t).then((function(e){return n.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof ye&&e.setCorrelationId(a.correlationId),o.cacheFailedRequest(e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return c(this,void 0,void 0,(function(){var n;return g(this,(function(o){switch(o.label){case 0:return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new mr(n,this.performanceClient)]}}))}))},t}(ur),Pr=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!Re.isAccountEntity(r))return;var n=Ue.toObject(new Re,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Zt.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Zt.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),Or={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},Nr={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Ur=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,t.prototype),o}return w(t,e),t.createMissingKidError=function(){return new t(Or.code,Or.desc)},t.createMissingAlgError=function(){return new t(Nr.code,Nr.desc)},t}(ye),Mr=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw Ur.createMissingKidError();if(!t.alg)throw Ur.createMissingAlgError();var r=new e({typ:t.typ||ce.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)},e}(),xr=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),qr=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,xr.decimalToHex(e[0])+xr.decimalToHex(e[1])+xr.decimalToHex(e[2])+xr.decimalToHex(e[3])+"-"+xr.decimalToHex(e[4])+xr.decimalToHex(e[5])+"-"+xr.decimalToHex(e[6])+xr.decimalToHex(e[7])+"-"+xr.decimalToHex(e[8])+xr.decimalToHex(e[9])+"-"+xr.decimalToHex(e[10])+xr.decimalToHex(e[11])+xr.decimalToHex(e[12])+xr.decimalToHex(e[13])+xr.decimalToHex(e[14])+xr.decimalToHex(e[15])}catch(s){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o=N.EMPTY_STRING,i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Hr=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t=N.EMPTY_STRING,r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),Lr=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,N.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,N.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Hr.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=N.EMPTY_STRING,n=void 0,o=e.length,i=0,s=0;s<o;s++)n=s%3,i|=e[s]<<(16>>>n&24),2!==n&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Dr=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Hr.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,N.EMPTY_STRING),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),s=void 0,a=void 0,c=0,g=0,y=0;y<n;y++)if(a=3&y,c|=this.b64ToUint6(r.charCodeAt(y))<<18-6*a,3===a||n-y==1){for(s=0;s<3&&g<o;s++,g++)i[g]=c>>>(16>>>s&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Kr=function(){function e(e){this.base64Encode=new Lr,this.cryptoObj=e}return e.prototype.generateCodes=function(){return c(this,void 0,void 0,(function(){var e,t;return g(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(t){throw et.createPkceNotGeneratedError(t)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),et.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),Fr=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,window.crypto.subtle.exportKey(at,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return c(this,void 0,void 0,(function(){return g(this,(function(o){return[2,window.crypto.subtle.importKey(at,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),jr=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(v(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,window.msrCrypto.subtle.exportKey(at,e)]}))}))},e.prototype.importKey=function(e,t,r,n){return c(this,void 0,void 0,(function(){return g(this,(function(o){return[2,window.msrCrypto.subtle.importKey(at,e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),Br=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.exportKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(at,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Hr.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,N.EMPTY_STRING).replace(/\n/g,N.EMPTY_STRING).replace(/\t/g,N.EMPTY_STRING).split(" ").join(N.EMPTY_STRING).replace("\0",N.EMPTY_STRING);try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return c(this,void 0,void 0,(function(){var o,i;return g(this,(function(s){return o=Hr.getSortedObjectString(e),i=Hr.stringToArrayBuffer(o),[2,new Promise((function(e,o){var s=window.msCrypto.subtle.importKey(at,i,t,r,n);s.addEventListener("complete",(function(t){e(t.target.result)})),s.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(e,t,r);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.digest=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Gr="SHA-256",Wr=new Uint8Array([1,0,1]),zr=function(){function e(e,t){var r,n;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Fr;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Br;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),et.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new jr}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),ft.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Gr,modulusLength:2048,publicExponent:Wr}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=Hr.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Gr},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return c(this,void 0,void 0,(function(){return g(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),Yr=function(){function e(){this.dbName=ut,this.version=1,this.tableName=lt,this.dbOpen=!1}return e.prototype.open=function(){return c(this,void 0,void 0,(function(){var e=this;return g(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(et.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return c(this,void 0,void 0,(function(){var t=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(et.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return c(this,void 0,void 0,(function(){var r=this;return g(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!r.db)return o(et.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(){r.closeConnection(),n()})),i.addEventListener("error",(function(e){r.closeConnection(),o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return c(this,void 0,void 0,(function(){var t=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(et.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){t.closeConnection(),r()})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return c(this,void 0,void 0,(function(){var e=this;return g(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(et.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){var n=r;e.closeConnection(),t(n.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return c(this,void 0,void 0,(function(){var t=this;return g(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(et.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(1===n.target.result)})),o.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(ut);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Vr=function(){function e(e,t){this.inMemoryCache=new mt,this.indexedDBCache=new Yr,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof et&&e.errorCode===$e.databaseUnavailable.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return c(this,void 0,void 0,(function(){var e,t;return g(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return c(this,void 0,void 0,(function(){var e,t;return g(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(Ir||(Ir={}));var Jr=function(){function e(e){this.logger=e,this.asymmetricKeys=new Vr(this.logger,Ir.asymmetricKeys),this.symmetricKeys=new Vr(this.logger,Ir.symmetricKeys)}return e.prototype.clear=function(){return c(this,void 0,void 0,(function(){var e;return g(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),Xr=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new zr(this.logger,r),this.b64Encode=new Lr,this.b64Decode=new Dr,this.guidGenerator=new qr(this.browserCrypto),this.pkceGenerator=new Kr(this.browserCrypto),this.cache=new Jr(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return c(this,void 0,void 0,(function(){var n,o,i,s,a,c,y,v;return g(this,(function(g){switch(g.label){case 0:return n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(dt.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return o=g.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=g.sent(),s={e:i.e,kty:i.kty,n:i.n},a=Hr.getSortedObjectString(s),[4,this.hashString(a)];case 3:return c=g.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return y=g.sent(),[4,this.browserCrypto.importJwk(y,!1,["sign"])];case 5:return v=g.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:v,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return g.sent(),n&&n.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.removeTokenBindingKey=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return c(this,void 0,void 0,(function(){var o,i,s,a,c,y,v,_,w,b,E,S,T;return g(this,(function(g){switch(g.label){case 0:return o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(dt.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(i=g.sent()))throw et.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return s=g.sent(),a=Hr.getSortedObjectString(s),c=this.b64Encode.urlEncode(JSON.stringify({kid:t})),y=Mr.getShrHeaderString({kid:c,alg:s.alg}),v=this.b64Encode.urlEncode(y),e.cnf={jwk:JSON.parse(a)},_=this.b64Encode.urlEncode(JSON.stringify(e)),w=v+"."+_,b=Hr.stringToArrayBuffer(w),[4,this.browserCrypto.sign(i.privateKey,b)];case 3:return E=g.sent(),S=this.b64Encode.urlEncodeArr(new Uint8Array(E)),T=w+"."+S,o&&o.endMeasurement({success:!0}),[2,T]}}))}))},e.prototype.hashString=function(e){return c(this,void 0,void 0,(function(){var t,r;return g(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}(),Zr=function(){function e(e,t,r,n,o,i){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return bt},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r,n){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var o={eventName:e,queueTime:r,manuallyCompleted:n},i=this.queueMeasurements.get(t);if(i)i.push(o),this.queueMeasurements.set(t,i);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var s=[o];this.queueMeasurements.set(t,s)}this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r,n,o=this,i=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",i),this.logger.trace("PerformanceClient: Performance measurement started for "+e,i);var s=this.startPerformanceMeasuremeant(e,i);s.startMeasurement();var a={eventId:this.generateId(),status:ht.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:i,appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appVersion};return this.cacheEventByCorrelationId(a),{endMeasurement:function(e){return o.endMeasurement(b(b({},a),e),s)},discardMeasurement:function(){return o.discardMeasurements(a.correlationId)},addStaticFields:function(e){return o.addStaticFields(e,a.correlationId)},increment:function(e){return o.increment(e,a.correlationId)},measurement:s,event:a}},e.prototype.endMeasurement=function(e,t){var r,n,o=this,i=this.eventsByCorrelationId.get(e.correlationId);if(!i)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var s=e.eventId===i.eventId,a={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};s?(a=this.getQueueInfo(e.correlationId),this.discardCache(i.correlationId)):null===(r=i.incompleteSubMeasurements)||void 0===r||r.delete(e.eventId),null==t||t.endMeasurement();var c=null==t?void 0:t.flushMeasurement();if(!c)return this.logger.trace("PerformanceClient: Performance measurement not taken",i.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+c+" ms",e.correlationId),!s)return i[e.name+"DurationMs"]=Math.floor(c),b({},i);var g=b(b({},i),e),y=0;return null===(n=g.incompleteSubMeasurements)||void 0===n||n.forEach((function(t){o.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,g.correlationId),y++})),g.incompleteSubMeasurements=void 0,g=b(b({},g),{durationMs:Math.round(c),queuedTimeMs:a.totalQueueTime,queuedCount:a.totalQueueCount,queuedManuallyCompletedCount:a.manuallyCompletedCount,status:ht.Completed,incompleteSubsCount:y}),this.truncateIntegralFields(g,this.getIntFields()),this.emitEvents([g],e.correlationId),g},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,b(b({},r),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var r=this.eventsByCorrelationId.get(t);if(r)for(var n in e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,b({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var r=0,n=0,o=0;return null==t||t.forEach((function(e){r+=e.queueTime,n++,o+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:o}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,o){r.logger.trace("PerformanceClient: Emitting event to callback "+o,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),Qr=function(){function e(t,r){this.correlationId=r,this.measureName=e.makeMeasureName(t,r),this.startMark=e.makeStartMark(t,r),this.endMark=e.makeEndMark(t,r)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,r){if(e.supportsBrowserPerformance())try{r.forEach((function(r){var n=e.makeMeasureName(r.name,t);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(e.makeStartMark(n,t)),window.performance.clearMarks(e.makeEndMark(n,t)))}))}catch(n){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(n){}return null},e}(),$r=function(e){function t(t,r,n,o,i,s,a){var c=e.call(this,t,r,n,o,i,s)||this;return c.browserCrypto=new zr(c.logger,a),c.guidGenerator=new qr(c.browserCrypto),c}return i(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new Qr(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),r=t&&t.eventId===e.event.eventId,n=[];r&&(null==t?void 0:t.incompleteSubMeasurements)&&t.incompleteSubMeasurements.forEach((function(e){n.push(s({},e))})),n.length>0&&Qr.flushMeasurements(e.event.correlationId,n)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,o=this.getPageVisibility(),i=e.prototype.startMeasurement.call(this,t,r);return s(s({},i),{endMeasurement:function(e){var t=i.endMeasurement(s({startPageVisibility:o,endPageVisibility:n.getPageVisibility()},e));return n.deleteIncompleteSubMeasurements(i),t},discardMeasurement:function(){i.discardMeasurement(),n.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+r.name+" found",t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r,n,o){if(this.supportsBrowserPerformanceNow())if(r){var i=e.prototype.getPreQueueTime.call(this,t,r);if(i){var s=window.performance.now(),a=n||e.prototype.calculateQueuedTime.call(this,i,s);return e.prototype.addQueueMeasurement.call(this,t,r,a,o)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(Zr),en=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new en},t.prototype.startPerformanceMeasurement=function(){return new en},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(Zr),rn=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw et.createUnableToLoadTokenError("Please ensure server response includes id token.");var n,o,i=new Pe(t.id_token,this.cryptoObj);if(e.account){var s=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new jt(s,this.loadIdToken(i,s.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,s.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,s.homeAccountId,e.account.environment))}else{if(!e.authority)throw et.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var a=er.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(o=new er(a,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");s=this.loadAccount(i,o.hostnameAndPort,r.clientInfo,o.authorityType);n=new jt(s,this.loadIdToken(i,s.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,s.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,s.homeAccountId,o.hostnameAndPort))}else{if(!t.client_info)throw et.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");s=this.loadAccount(i,o.hostnameAndPort,t.client_info,o.authorityType);n=new jt(s,this.loadIdToken(i,s.homeAccountId,o.hostnameAndPort,o.tenant),this.loadAccessToken(e,t,s.homeAccountId,o.hostnameAndPort,o.tenant,r),this.loadRefreshToken(e,t,s.homeAccountId,o.hostnameAndPort))}}return this.generateAuthenticationResult(e,i,n,o)},e.prototype.loadAccount=function(e,t,r,n,o){var i;if(o?i=o:void 0!==n&&r&&(i=Re.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!i)throw et.createUnableToLoadTokenError("Unexpected missing homeAccountId");var s=r?Re.createAccount(r,i,e,void 0,void 0,void 0,t):Re.createGenericAccount(i,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(s),s;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){var o=be.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(o),o;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw et.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw et.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new Te(e.scopes).printScopes(),a=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn,g=qe.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,s,a,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(g),g;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var o=He.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(o),o;throw et.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var o,i,s,a,c=N.EMPTY_STRING,g=[],y=null;(null==r?void 0:r.accessToken)&&(c=r.accessToken.secret,g=Te.fromString(r.accessToken.target).asArray(),y=new Date(1e3*Number(r.accessToken.expiresOn)),a=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));var v=(null==t?void 0:t.claims.oid)||(null==t?void 0:t.claims.sub)||N.EMPTY_STRING,_=(null==t?void 0:t.claims.tid)||N.EMPTY_STRING;return{authority:n?n.canonicalAuthority:N.EMPTY_STRING,uniqueId:v,tenantId:_,scopes:g,account:(null==r?void 0:r.account)?r.account.getAccountInfo():null,idToken:t?t.rawToken:N.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:c,fromCache:!0,expiresOn:y,correlationId:e.correlationId||N.EMPTY_STRING,requestId:N.EMPTY_STRING,extExpiresOn:a,familyId:N.EMPTY_STRING,tokenType:(null===(o=null==r?void 0:r.accessToken)||void 0===o?void 0:o.tokenType)||N.EMPTY_STRING,state:N.EMPTY_STRING,cloudGraphHostName:(null===(i=null==r?void 0:r.account)||void 0===i?void 0:i.cloudGraphHostName)||N.EMPTY_STRING,msGraphHost:(null===(s=null==r?void 0:r.account)||void 0===s?void 0:s.msGraphHost)||N.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),nn=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return i(t,e),t}(zt),on=function(e){function t(t,r,n,o,i,s,a,c,g,y){var v=e.call(this,t,r,n,o,i,s,c,g,y)||this;return v.apiId=a,v}return i(t,e),t.prototype.acquireToken=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a;return g(this,(function(c){switch(c.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw et.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(dt.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Xe.Silent)];case 1:t=c.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||N.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),c.label=2;case 2:return c.trys.push([2,4,,5]),n=s(s({},t),{code:e.code}),this.performanceClient.setPreQueueTime(dt.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(r,t.authority)];case 3:return o=c.sent(),i=new nn(o),this.logger.verbose("Auth code client created"),[2,new kr(i,this.browserStorage,n,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(a=c.sent())instanceof ye&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(t.state),a;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(et.createSilentLogoutUnsupportedError())},t}(ur),sn=function(){function e(e){var t,r,n;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,o=e.system,i=e.telemetry,a={clientId:N.EMPTY_STRING,authority:""+N.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:N.EMPTY_STRING,authorityMetadata:N.EMPTY_STRING,redirectUri:N.EMPTY_STRING,postLogoutRedirectUri:N.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Vt.AAD,azureCloudOptions:{azureCloudInstance:Et.None,tenant:N.EMPTY_STRING},skipAuthorityMetadataCache:!1},c={cacheLocation:Ge.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==Ge.LocalStorage)},g={loggerCallback:function(){},logLevel:wt.Info,piiLoggingEnabled:!1},y=s(s({},St),{loggerOptions:g,networkClient:t?ar.getBrowserNetworkClient():Cr,navigationClient:new Sr,loadFrameTimeout:0,windowHashTimeout:(null==o?void 0:o.loadFrameTimeout)||6e4,iframeHashTimeout:(null==o?void 0:o.loadFrameTimeout)||Tr,navigateFrameWait:t&&ar.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==o?void 0:o.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:tt.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),v=s(s({},o),{loggerOptions:(null==o?void 0:o.loggerOptions)||g}),_={application:{appName:N.EMPTY_STRING,appVersion:N.EMPTY_STRING}};return{auth:s(s({},a),r),cache:s(s({},c),n),system:s(s({},y),v),telemetry:s(s({},_),i)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new Ct(this.config.system.loggerOptions,nr,or),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new $r(this.config.auth.clientId,this.config.auth.authority,this.logger,nr,or,this.config.telemetry.application,this.config.system.cryptoOptions):new tn(this.config.auth.clientId,this.config.auth.authority,this.logger,nr,or,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Xr(this.logger,this.performanceClient,this.config.system.cryptoOptions):Qe,this.eventHandler=new Pr(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new _t(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(t=this.config.auth.clientId,r=this.logger,n={cacheLocation:Ge.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1},new _t(t,n,Qe,r));var o={cacheLocation:Ge.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1};this.nativeInternalStorage=new _t(this.config.auth.clientId,o,this.browserCrypto,this.logger),this.tokenCache=new rn(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return c(this,void 0,void 0,(function(){var e,t,r,n;return g(this,(function(o){switch(o.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(dt.InitializeClientApplication),this.eventHandler.emitEvent(Zt.INITIALIZE_START),!e)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),r=this,[4,wr.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return r.nativeExtensionProvider=o.sent(),[3,4];case 3:return n=o.sent(),this.logger.verbose(n),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(Zt.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,y=this;return g(this,(function(g){return this.logger.verbose("handleRedirectPromise called"),ar.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||N.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(Zt.HANDLE_REDIRECT_START,Xe.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getCachedNativeRequest(),i=void 0,o&&wr.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new _r(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,o.accountId,this.nativeInternalStorage,o.correlationId),i=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),a=this.browserStorage.getTemporaryCache(ze.CORRELATION_ID,!0)||N.EMPTY_STRING,c=this.createRedirectClient(a),i=c.handleRedirectPromise(e)),n=i.then((function(e){e&&(t.length<y.getAllAccounts().length?(y.eventHandler.emitEvent(Zt.LOGIN_SUCCESS,Xe.Redirect,e),y.logger.verbose("handleRedirectResponse returned result, login success")):(y.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_SUCCESS,Xe.Redirect,e),y.logger.verbose("handleRedirectResponse returned result, acquire token success")));return y.eventHandler.emitEvent(Zt.HANDLE_REDIRECT_END,Xe.Redirect),e})).catch((function(e){throw t.length>0?y.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_FAILURE,Xe.Redirect,null,e):y.eventHandler.emitEvent(Zt.LOGIN_FAILURE,Xe.Redirect,null,e),y.eventHandler.emitEvent(Zt.HANDLE_REDIRECT_END,Xe.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,s=this;return g(this,(function(a){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(Xe.Redirect),(r=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_START,Xe.Redirect,e):this.eventHandler.emitEvent(Zt.LOGIN_START,Xe.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(o=new _r(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),n=o.acquireTokenRedirect(e).catch((function(t){if(t instanceof gr&&t.isFatal())return s.nativeExtensionProvider=void 0,s.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof Ft)return s.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),s.createRedirectClient(e.correlationId).acquireToken(e);throw s.browserStorage.setInteractionInProgress(!1),t}))):(i=this.createRedirectClient(e.correlationId),n=i.acquireToken(e)),[2,n.catch((function(e){throw r?s.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_FAILURE,Xe.Redirect,null,e):s.eventHandler.emitEvent(Zt.LOGIN_FAILURE,Xe.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(dt.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(Xe.Popup)}catch(s){return Promise.reject(s)}var o,i=this.getAllAccounts();(i.length>0?this.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_START,Xe.Popup,e):this.eventHandler.emitEvent(Zt.LOGIN_START,Xe.Popup,e),this.canUseNative(e))?o=this.acquireTokenNative(e,Je.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),n.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(r){if(r instanceof gr&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(r instanceof Ft)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):o=this.createPopupClient(e.correlationId).acquireToken(e);return o.then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(Zt.LOGIN_SUCCESS,Xe.Popup,e):t.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_SUCCESS,Xe.Popup,e),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return i.length>0?t.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_FAILURE,Xe.Popup,null,e):t.eventHandler.emitEvent(Zt.LOGIN_FAILURE,Xe.Popup,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return c(this,void 0,void 0,(function(){var r,n,o,i,a=this;return g(this,(function(c){return r=this.getRequestCorrelationId(e),n=s(s({},e),{prompt:e.prompt,correlationId:r}),this.preflightBrowserEnvironmentCheck(Xe.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(dt.SsoSilent,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(Zt.SSO_SILENT_START,Xe.Silent,n),this.canUseNative(n)?o=this.acquireTokenNative(n,Je.ssoSilent).catch((function(e){if(e instanceof gr&&e.isFatal())return a.nativeExtensionProvider=void 0,a.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):(i=this.createSilentIframeClient(n.correlationId),o=i.acquireToken(n)),[2,o.then((function(e){var t,r;return a.eventHandler.emitEvent(Zt.SSO_SILENT_SUCCESS,Xe.Silent,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(r=a.ssoSilentMeasurement)||void 0===r||r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw a.eventHandler.emitEvent(Zt.SSO_SILENT_FAILURE,Xe.Silent,null,e),null===(t=a.ssoSilentMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",a.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i=this;return g(this,(function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Xe.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_BY_CODE_START,Xe.Silent,e),r=this.performanceClient.startMeasurement(dt.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw et.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return n=e.code,(o=this.hybridAuthCodeResponses.get(n))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(s(s({},e),{correlationId:t})).then((function(e){return i.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Xe.Silent,e),i.hybridAuthCodeResponses.delete(n),r.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw i.hybridAuthCodeResponses.delete(n),i.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_BY_CODE_FAILURE,Xe.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(n,o)),[2,o];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,Je.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof gr&&e.isFatal()&&(i.nativeExtensionProvider=void 0),e}))];throw et.createUnableToAcquireTokenFromNativePlatformError()}throw et.createAuthCodeOrNativeAccountIdRequiredError()}catch(c){throw this.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_BY_CODE_FAILURE,Xe.Silent,null,c),r.endMeasurement({errorCode:c instanceof ye&&c.errorCode||void 0,subErrorCode:c instanceof ye&&c.subError||void 0,success:!1}),c}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return c(this,void 0,void 0,(function(){var r=this;return g(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(dt.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){switch(this.performanceClient.addQueueMeasurement(dt.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case ct.Default:case ct.AccessToken:case ct.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw _e.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return c(this,void 0,void 0,(function(){var r;return g(this,(function(n){switch(this.performanceClient.addQueueMeasurement(dt.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case ct.Default:case ct.AccessTokenAndRefreshToken:case ct.RefreshToken:case ct.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(dt.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw _e.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return this.performanceClient.addQueueMeasurement(dt.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(dt.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(s({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Xe.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(Xe.Popup),this.createPopupClient(t).logout(e)}catch(r){return Promise.reject(r)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),ar.blockNonBrowserEnvironment(this.isBrowserEnvironment),ar.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),ar.blockReloadInHiddenIframes(),ar.blockAcquireTokenInPopups(),ar.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===Xe.Redirect&&this.config.cache.cacheLocation===Ge.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw ft.createInMemoryRedirectUnavailableError();e!==Xe.Redirect&&e!==Xe.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),ar.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw et.createNativeConnectionNotEstablishedError();return[2,new _r(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!wr.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case H.NONE:case H.CONSENT:case H.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},e.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new Er(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new br(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new Ar(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new vr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new Rr(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Je.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():N.EMPTY_STRING},e}(),an=function(e){function t(t){var r=e.call(this,t)||this;return r.astsAsyncMeasurement=void 0,r.activeSilentTokenRequests=new Map,r.trackPageVisibility=r.trackPageVisibility.bind(r),r}return i(t,e),t.prototype.loginRedirect=function(e){return c(this,void 0,void 0,(function(){var t;return g(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(s({correlationId:t},e||st))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(s({correlationId:t},e||st))},t.prototype.acquireTokenSilent=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,y=this;return g(this,(function(g){if(t=this.getRequestCorrelationId(e),(r=this.performanceClient.startMeasurement(dt.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Xe.Silent),this.logger.verbose("acquireTokenSilent called",t),!(n=e.account||this.getActiveAccount()))throw et.createNoAccountError();return o={clientId:this.config.auth.clientId,authority:e.authority||N.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},i=JSON.stringify(o),void 0===(a=this.activeSilentTokenRequests.get(i))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(dt.AcquireTokenSilentAsync,t),c=this.acquireTokenSilentAsync(s(s({},e),{correlationId:t}),n).then((function(t){return y.activeSilentTokenRequests.delete(i),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t})).catch((function(e){throw y.activeSilentTokenRequests.delete(i),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(i,c),[2,c]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discardMeasurement(),[2,a])}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var r;return c(this,void 0,void 0,(function(){var n,o,i,a,y,v=this;return g(this,(function(_){switch(_.label){case 0:return this.performanceClient.addQueueMeasurement(dt.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_START,Xe.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(dt.AcquireTokenSilentAsync,e.correlationId),null===(r=this.astsAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),wr.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),o=s(s({},e),{account:t}),n=this.acquireTokenNative(o,Je.acquireTokenSilent_silentFlow).catch((function(t){return c(v,void 0,void 0,(function(){return g(this,(function(r){if(t instanceof gr&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),i=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(dt.InitializeSilentRequest,e.correlationId),[4,i.initializeSilentRequest(e,t)];case 2:a=_.sent(),y=s(s({},e),{cacheLookupPolicy:e.cacheLookupPolicy||ct.Default}),this.performanceClient.setPreQueueTime(dt.AcquireTokenFromCache,a.correlationId),n=this.acquireTokenFromCache(i,a,y).catch((function(t){if(y.cacheLookupPolicy===ct.AccessToken)throw t;return ar.blockReloadInHiddenIframes(),v.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_NETWORK_START,Xe.Silent,a),v.performanceClient.setPreQueueTime(dt.AcquireTokenByRefreshToken,a.correlationId),v.acquireTokenByRefreshToken(a,y).catch((function(t){var r=t instanceof Nt,n=t instanceof Ft,o=t.errorCode===tt.INVALID_GRANT_ERROR;if((!r||!o||n||y.cacheLookupPolicy===ct.AccessTokenAndRefreshToken||y.cacheLookupPolicy===ct.RefreshToken)&&y.cacheLookupPolicy!==ct.Skip)throw t;return v.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),v.performanceClient.setPreQueueTime(dt.AcquireTokenBySilentIframe,a.correlationId),v.acquireTokenBySilentIframe(a)}))})),_.label=3;case 3:return[2,n.then((function(e){var t;return v.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_SUCCESS,Xe.Silent,e),null===(t=v.astsAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw v.eventHandler.emitEvent(Zt.ACQUIRE_TOKEN_FAILURE,Xe.Silent,null,e),null===(t=v.astsAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",v.trackPageVisibility)}))]}}))}))},t}(sn),cn={initialize:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenPopup:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenRedirect:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenSilent:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},acquireTokenByCode:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},loginPopup:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},loginRedirect:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},logout:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},logoutRedirect:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},logoutPopup:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},ssoSilent:function(){return Promise.reject(ft.createStubPcaInstanceCalledError())},addEventCallback:function(){return null},removeEventCallback:function(){},addPerformanceCallback:function(){return""},removePerformanceCallback:function(){return!1},enableAccountStorageEvents:function(){},disableAccountStorageEvents:function(){},getTokenCache:function(){throw ft.createStubPcaInstanceCalledError()},getLogger:function(){throw ft.createStubPcaInstanceCalledError()},setLogger:function(){},setActiveAccount:function(){},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){},setNavigationClient:function(){},getConfiguration:function(){throw ft.createStubPcaInstanceCalledError()}},un=function(){function e(){}return e.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case Zt.LOGIN_START:return Ze.Login;case Zt.SSO_SILENT_START:return Ze.SsoSilent;case Zt.ACQUIRE_TOKEN_START:if(e.interactionType===Xe.Redirect||e.interactionType===Xe.Popup)return Ze.AcquireToken;break;case Zt.HANDLE_REDIRECT_START:return Ze.HandleRedirect;case Zt.LOGOUT_START:return Ze.Logout;case Zt.SSO_SILENT_SUCCESS:case Zt.SSO_SILENT_FAILURE:if(t&&t!==Ze.SsoSilent)break;return Ze.None;case Zt.LOGOUT_END:if(t&&t!==Ze.Logout)break;return Ze.None;case Zt.HANDLE_REDIRECT_END:if(t&&t!==Ze.HandleRedirect)break;return Ze.None;case Zt.LOGIN_SUCCESS:case Zt.LOGIN_FAILURE:case Zt.ACQUIRE_TOKEN_SUCCESS:case Zt.ACQUIRE_TOKEN_FAILURE:if(e.interactionType===Xe.Redirect||e.interactionType===Xe.Popup){if(t&&t!==Ze.Login&&t!==Ze.AcquireToken)break;return Ze.None}}return null},e}(),ln=function(){function e(e,t){var r=t&&t.loggerOptions||{};this.logger=new Ct(r,nr,or),this.cryptoOps=new Xr(this.logger),this.popTokenGenerator=new Bt(this.cryptoOps),this.shrParameters=e}return e.prototype.generatePublicKeyThumbprint=function(){return c(this,void 0,void 0,(function(){return g(this,(function(e){switch(e.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return[2,e.sent().kid]}}))}))},e.prototype.signRequest=function(e,t,r){return c(this,void 0,void 0,(function(){return g(this,(function(n){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)]}))}))},e.prototype.removeKeys=function(e){return c(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}}))}))},e}(),dn=function(){function e(e){this.headers=e}return e.prototype.getShrNonce=function(){var e=this.headers[I.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw Ce.createInvalidAuthenticationHeaderError(I.AuthenticationInfo,"nextnonce challenge is missing.")}var r=this.headers[I.WWWAuthenticate];if(r){var n=this.parseChallenges(r);if(n.nonce)return n.nonce;throw Ce.createInvalidAuthenticationHeaderError(I.WWWAuthenticate,"nonce challenge is missing.")}throw Ce.createMissingNonceAuthenticationHeadersError()},e.prototype.parseChallenges=function(e){var t=e.indexOf(" "),r=e.substr(t+1).split(","),n={};return r.forEach((function(e){var t=e.split("="),r=t[0],o=t[1];n[r]=unescape(o.replace(/['"]+/g,N.EMPTY_STRING))})),n},e}()},6986:(e,t,r)=>{"use strict";var n,o=Object.create,i=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,c=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,y=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of a(t))g.call(e,o)||o===r||i(e,o,{get:()=>t[o],enumerable:!(n=s(t,o))||n.enumerable});return e},v=(e,t,r)=>(r=null!=e?o(c(e)):{},y(!t&&e&&e.__esModule?r:i(r,"default",{value:e,enumerable:!0}),e)),_={};((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})(_,{AccessTokenEvents:()=>j,CheckSessionIFrame:()=>G,ErrorResponse:()=>K,ErrorTimeout:()=>F,InMemoryWebStorage:()=>W,Log:()=>R,Logger:()=>O,MetadataService:()=>V,OidcClient:()=>ae,OidcClientSettingsStore:()=>X,SessionMonitor:()=>ce,SigninResponse:()=>oe,SigninState:()=>ne,SignoutResponse:()=>se,State:()=>re,User:()=>ue,UserManager:()=>be,UserManagerSettingsStore:()=>ye,Version:()=>Ee,WebStorageStateStore:()=>J}),e.exports=(n=_,y(i({},"__esModule",{value:!0}),n));var w,b,E,S=v(r(3724)),T=v(r(287)),I=v(r(4676)),k=v(r(7154)),A={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},R=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(R||{});(E=R||(R={})).reset=function(){w=3,b=A},E.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");w=e},E.setLogger=function(e){b=e};var O=class{constructor(e){this._name=e}debug(...e){w>=4&&b.debug(O._format(this._name,this._method),...e)}info(...e){w>=3&&b.info(O._format(this._name,this._method),...e)}warn(...e){w>=2&&b.warn(O._format(this._name,this._method),...e)}error(...e){w>=1&&b.error(O._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const r=new O(`${e}.${t}`);return r.debug("begin"),r}static _format(e,t){const r=`[${e}]`;return t?`${r} ${t}:`:r}static debug(e,...t){w>=4&&b.debug(O._format(e),...t)}static info(e,...t){w>=3&&b.info(O._format(e),...t)}static warn(e,...t){w>=2&&b.warn(O._format(e),...t)}static error(e,...t){w>=1&&b.error(O._format(e),...t)}};R.reset();var N=class{static _randomWord(){return S.default.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^N._randomWord()&15>>+e/4).toString(16))).replace(/-/g,"")}static generateCodeVerifier(){return N.generateUUIDv4()+N.generateUUIDv4()+N.generateUUIDv4()}static generateCodeChallenge(e){try{const t=(0,T.default)(e);return I.default.stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw O.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const r=k.default.parse([e,t].join(":"));return I.default.stringify(r)}},U=class{constructor(e){this._name=e,this._logger=new O(`Event('${this._name}')`),this._callbacks=[]}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}raise(...e){this._logger.debug("raise:",...e);for(const t of this._callbacks)t(...e)}},M=v(r(612)),q=class{static decode(e){try{return(0,M.default)(e)}catch(t){throw O.error("JwtUtils.decode",t),t}}},H=class{static center({...e}){var t;return null==e.width&&(e.width=null!=(t=[800,720,600,480].find((e=>e<=window.outerWidth/1.618)))?t:360),null!=e.left||(e.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-e.width)/2))),null!=e.height&&(null!=e.top||(e.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-e.height)/2)))),e}static serialize(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${e}=${"boolean"!=typeof t?t:t?"yes":"no"}`)).join(",")}},L=class extends U{constructor(){super(...arguments),this._logger=new O(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-L.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=L.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const r=L.getEpochTime()+e;if(this.expiration===r&&this._timerHandle)return void t.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),t.debug("using duration",e),this._expiration=r;const n=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*n)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},D=class{static readParams(e,t="query"){if(!e)throw new TypeError("Invalid URL");const r=new URL(e,window.location.origin)["fragment"===t?"hash":"search"];return new URLSearchParams(r.slice(1))}},K=class extends Error{constructor(e,t){var r,n,o;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw O.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(r=e.error_description)?r:null,this.error_uri=null!=(n=e.error_uri)?n:null,this.state=e.userState,this.session_state=null!=(o=e.session_state)?o:null}},F=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},j=class{constructor(e){this._logger=new O("AccessTokenEvents"),this._expiringTimer=new L("Access token expiring"),this._expiredTimer=new L("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){let e=r-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;t.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}},G=class{constructor(e,t,r,n,o){this._callback=e,this._client_id=t,this._intervalInSeconds=n,this._stopOnError=o,this._logger=new O("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const i=new URL(r);this._frame_origin=i.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=i.href}load(){return new Promise((e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)}))}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},W=class{constructor(){this._logger=new O("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create(`getItem('${e}')`),this._data[e]}setItem(e,t){this._logger.create(`setItem('${e}')`),this._data[e]=t}removeItem(e){this._logger.create(`removeItem('${e}')`),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},Y=class{constructor(e=[],t=null){this._jwtHandler=t,this._logger=new O("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e,t={}){const{timeoutInSeconds:r,...n}=t;if(!r)return await fetch(e,n);const o=new AbortController,i=setTimeout((()=>o.abort()),1e3*r);try{return await fetch(e,{...t,signal:o.signal})}catch(s){if(s instanceof DOMException&&"AbortError"===s.name)throw new F("Network timed out");throw s}finally{clearTimeout(i)}}async getJson(e,{token:t,credentials:r}={}){const n=this._logger.create("getJson"),o={Accept:this._contentTypes.join(", ")};let i;t&&(n.debug("token passed, setting Authorization header"),o.Authorization="Bearer "+t);try{n.debug("url:",e),i=await this.fetchWithTimeout(e,{method:"GET",headers:o,credentials:r})}catch(c){throw n.error("Network Error"),c}n.debug("HTTP response received, status",i.status);const s=i.headers.get("Content-Type");if(s&&!this._contentTypes.find((e=>s.startsWith(e)))&&n.throw(new Error(`Invalid response Content-Type: ${null!=s?s:"undefined"}, from URL: ${e}`)),i.ok&&this._jwtHandler&&(null==s?void 0:s.startsWith("application/jwt")))return await this._jwtHandler(await i.text());let a;try{a=await i.json()}catch(c){if(n.error("Error parsing JSON response",c),i.ok)throw c;throw new Error(`${i.statusText} (${i.status})`)}if(!i.ok){if(n.error("Error from server:",a),a.error)throw new K(a);throw new Error(`${i.statusText} (${i.status}): ${JSON.stringify(a)}`)}return a}async postForm(e,{body:t,basicAuth:r,timeoutInSeconds:n,initCredentials:o}){const i=this._logger.create("postForm"),s={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};let a;void 0!==r&&(s.Authorization="Basic "+r);try{i.debug("url:",e),a=await this.fetchWithTimeout(e,{method:"POST",headers:s,body:t,timeoutInSeconds:n,credentials:o})}catch(v){throw i.error("Network error"),v}i.debug("HTTP response received, status",a.status);const c=a.headers.get("Content-Type");if(c&&!this._contentTypes.find((e=>c.startsWith(e))))throw new Error(`Invalid response Content-Type: ${null!=c?c:"undefined"}, from URL: ${e}`);const g=await a.text();let y={};if(g)try{y=JSON.parse(g)}catch(v){if(i.error("Error parsing JSON response",v),a.ok)throw v;throw new Error(`${a.statusText} (${a.status})`)}if(!a.ok){if(i.error("Error from server:",y),y.error)throw new K(y,t);throw new Error(`${a.statusText} (${a.status}): ${JSON.stringify(y)}`)}return y}},V=class{constructor(e){this._settings=e,this._logger=new O("MetadataService"),this._jsonService=new Y(["application/jwk-set+json"]),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,t),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(e=!0){return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(e=!0){return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(e=!0){return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e,t=!1){const r=this._logger.create(`_getMetadataProperty('${e}')`),n=await this.getMetadata();if(r.debug("resolved"),void 0===n[e]){if(!0===t)return void r.warn("Metadata does not contain optional property");r.throw(new Error("Metadata does not contain property "+e))}return n[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const r=await this._jsonService.getJson(t);if(e.debug("got key set",r),!Array.isArray(r.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}},J=class{constructor({prefix:e="oidc.",store:t=localStorage}={}){this._logger=new O("WebStorageStateStore"),this._store=t,this._prefix=e}async set(e,t){this._logger.create(`set('${e}')`),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create(`get('${e}')`),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create(`remove('${e}')`),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let r=0;r<e;r++){const e=await this._store.key(r);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}},X=class{constructor({authority:e,metadataUrl:t,metadata:r,signingKeys:n,metadataSeed:o,client_id:i,client_secret:s,response_type:a="code",scope:c="openid",redirect_uri:g,post_logout_redirect_uri:y,client_authentication:v="client_secret_post",prompt:_,display:w,max_age:b,ui_locales:E,acr_values:S,resource:T,response_mode:I="query",filterProtocolClaims:k=!0,loadUserInfo:A=!1,staleStateAgeInSeconds:R=900,clockSkewInSeconds:O=300,userInfoJwtIssuer:N="OP",mergeClaims:U=!1,disablePKCE:M=!1,stateStore:q,refreshTokenCredentials:H,revokeTokenAdditionalContentTypes:L,fetchRequestCredentials:D,refreshTokenAllowedScope:K,extraQueryParams:F={},extraTokenParams:j={}}){if(this.authority=e,t?this.metadataUrl=t:(this.metadataUrl=e,e&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=o,this.signingKeys=n,this.client_id=i,this.client_secret=s,this.response_type=a,this.scope=c,this.redirect_uri=g,this.post_logout_redirect_uri=y,this.client_authentication=v,this.prompt=_,this.display=w,this.max_age=b,this.ui_locales=E,this.acr_values=S,this.resource=T,this.response_mode=I,this.filterProtocolClaims=null==k||k,this.loadUserInfo=!!A,this.staleStateAgeInSeconds=R,this.clockSkewInSeconds=O,this.userInfoJwtIssuer=N,this.mergeClaims=!!U,this.disablePKCE=!!M,this.revokeTokenAdditionalContentTypes=L,D&&H&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=D||(H||"same-origin"),q)this.stateStore=q;else{const e="undefined"!=typeof window?window.localStorage:new W;this.stateStore=new J({store:e})}this.refreshTokenAllowedScope=K,this.extraQueryParams=F,this.extraTokenParams=j}},Q=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new O("TokenClient"),this._jsonService=new Y(this._settings.revokeTokenAdditionalContentTypes)}async exchangeCode({grant_type:e="authorization_code",redirect_uri:t=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,...o}){const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),t||i.throw(new Error("A redirect_uri is required")),o.code||i.throw(new Error("A code is required"));const s=new URLSearchParams({grant_type:e,redirect_uri:t});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;a=N.generateBasicAuth(r,n);break;case"client_secret_post":s.append("client_id",r),n&&s.append("client_secret",n)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeCredentials({grant_type:e="password",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...o}){const i=this._logger.create("exchangeCredentials");t||i.throw(new Error("A client_id is required"));const s=new URLSearchParams({grant_type:e,scope:n});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=N.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeRefreshToken({grant_type:e="refresh_token",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,...o}){const i=this._logger.create("exchangeRefreshToken");t||i.throw(new Error("A client_id is required")),o.refresh_token||i.throw(new Error("A refresh_token is required"));const s=new URLSearchParams({grant_type:e});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=N.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async revoke(e){var t;const r=this._logger.create("revoke");e.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${null!=(t=e.token_type_hint)?t:"default token type"}`);const o=new URLSearchParams;for(const[i,s]of Object.entries(e))null!=s&&o.set(i,s);o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:o}),r.debug("got response")}},$=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],ee=["sub","iss","aud","exp","iat"],re=class{constructor(e){this.id=e.id||N.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=L.getEpochTime(),this.request_type=e.request_type}toStorageString(){return new O("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})}static fromStorageString(e){return O.createStatic("State","fromStorageString"),new re(JSON.parse(e))}static async clearStaleState(e,t){const r=O.createStatic("State","clearStaleState"),n=L.getEpochTime()-t,o=await e.getAllKeys();r.debug("got keys",o);for(let s=0;s<o.length;s++){const t=o[s],a=await e.get(t);let c=!1;if(a)try{const e=re.fromStorageString(a);r.debug("got item from key:",t,e.created),e.created<=n&&(c=!0)}catch(i){r.error("Error parsing state for key:",t,i),c=!0}else r.debug("no item in storage for key:",t),c=!0;c&&(r.debug("removed item for key:",t),e.remove(t))}}},ne=class extends re{constructor(e){super(e),!0===e.code_verifier?this.code_verifier=N.generateCodeVerifier():e.code_verifier&&(this.code_verifier=e.code_verifier),this.code_verifier&&(this.code_challenge=N.generateCodeChallenge(this.code_verifier)),this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}toStorageString(){return new O("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){O.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return new ne(t)}},oe=class{constructor(e){this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-L.getEpochTime()}set expires_in(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+L.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},se=class{constructor(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}},ae=class{constructor(e){this._logger=new O("OidcClient"),this.settings=new X(e),this.metadataService=new V(this.settings),this._validator=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new O("ResponseValidator"),this._userInfoService=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new O("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const r=q.decode(e);return t.debug("JWT decoding successful"),r}catch(r){throw t.error("Error parsing JWT response"),r}},this._jsonService=new Y(void 0,this._getClaimsFromJwt)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:e,credentials:this._settings.fetchRequestCredentials});return t.debug("got claims",n),n}}(this._settings,this._metadataService),this._tokenClient=new Q(this._settings,this._metadataService)}async validateSigninResponse(e,t){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const r=this._logger.create("validateCredentialsResponse");e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,t,e.isOpenId),r.debug("claims processed")}async validateRefreshResponse(e,t){const r=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),r.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const n=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,n),r.debug("claims processed")}validateSignoutResponse(e,t){const r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new K(e)}_processSigninState(e,t){const r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new K(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}async _processClaims(e,t=!1,r=!0){const n=this._logger.create("_processClaims");if(e.profile=this._filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void n.debug("not loading user info");n.debug("loading user info");const o=await this._userInfoService.getClaims(e.access_token);n.debug("user info claims received from user info endpoint"),r&&o.sub!==e.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._mergeClaims(e.profile,this._filterProtocolClaims(o)),n.debug("user info claims received, updated profile:",e.profile)}_mergeClaims(e,t){const r={...e};for(const[n,o]of Object.entries(t))for(const e of Array.isArray(o)?o:[o]){const t=r[n];t?Array.isArray(t)?t.includes(e)||t.push(e):r[n]!==e&&("object"==typeof e&&this._settings.mergeClaims?r[n]=this._mergeClaims(t,e):r[n]=[t,e]):r[n]=e}return r}_filterProtocolClaims(e){const t={...e};if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:$;for(const r of e)ee.includes(r)||delete t[r]}return t}async _processCode(e,t){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,...t.extraTokenParams});Object.assign(e,n)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const o=q.decode(null!=(r=e.id_token)?r:"");if(o.sub||n.throw(new Error("ID Token is missing a subject claim")),t){const e=q.decode(t);e.sub!==o.sub&&n.throw(new Error("sub in id_token does not match current sub")),e.auth_time&&e.auth_time!==o.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),e.azp&&e.azp!==o.azp&&n.throw(new Error("azp in id_token does not match original azp")),!e.azp&&o.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=o}}(this.settings,this.metadataService),this._tokenClient=new Q(this.settings,this.metadataService)}async createSigninRequest({state:e,request:t,request_uri:r,request_type:n,id_token_hint:o,login_hint:i,skipUserInfo:s,nonce:a,response_type:c=this.settings.response_type,scope:g=this.settings.scope,redirect_uri:y=this.settings.redirect_uri,prompt:v=this.settings.prompt,display:_=this.settings.display,max_age:w=this.settings.max_age,ui_locales:b=this.settings.ui_locales,acr_values:E=this.settings.acr_values,resource:S=this.settings.resource,response_mode:T=this.settings.response_mode,extraQueryParams:I=this.settings.extraQueryParams,extraTokenParams:k=this.settings.extraTokenParams}){const A=this._logger.create("createSigninRequest");if("code"!==c)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const R=await this.metadataService.getAuthorizationEndpoint();A.debug("Received authorization endpoint",R);const N=new class{constructor({url:e,authority:t,client_id:r,redirect_uri:n,response_type:o,scope:i,state_data:s,response_mode:a,request_type:c,client_secret:g,nonce:y,resource:v,skipUserInfo:_,extraQueryParams:w,extraTokenParams:b,disablePKCE:E,...S}){if(this._logger=new O("SigninRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!o)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!i)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!t)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new ne({data:s,request_type:c,code_verifier:!E,client_id:r,authority:t,redirect_uri:n,response_mode:a,client_secret:g,scope:i,extraTokenParams:b,skipUserInfo:_});const T=new URL(e);T.searchParams.append("client_id",r),T.searchParams.append("redirect_uri",n),T.searchParams.append("response_type",o),T.searchParams.append("scope",i),y&&T.searchParams.append("nonce",y),T.searchParams.append("state",this.state.id),this.state.code_challenge&&(T.searchParams.append("code_challenge",this.state.code_challenge),T.searchParams.append("code_challenge_method","S256")),v&&(Array.isArray(v)?v:[v]).forEach((e=>T.searchParams.append("resource",e)));for(const[I,k]of Object.entries({response_mode:a,...S,...w}))null!=k&&T.searchParams.append(I,k.toString());this.url=T.href}}({url:R,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:y,response_type:c,scope:g,state_data:e,prompt:v,display:_,max_age:w,ui_locales:b,id_token_hint:o,login_hint:i,acr_values:E,resource:S,request:t,request_uri:r,extraQueryParams:I,extraTokenParams:k,request_type:n,response_mode:T,client_secret:this.settings.client_secret,skipUserInfo:s,nonce:a,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const U=N.state;return await this.settings.stateStore.set(U.id,U.toStorageString()),N}async readSigninResponseState(e,t=!1){const r=this._logger.create("readSigninResponseState"),n=new oe(D.readParams(e,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:ne.fromStorageString(o),response:n}}async processSigninResponse(e){const t=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(e,!0);return t.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r=!1,extraTokenParams:n={}}){const o=await this._tokenClient.exchangeCredentials({username:e,password:t,...n}),i=new oe(new URLSearchParams);return Object.assign(i,o),await this._validator.validateCredentialsResponse(i,r),i}async useRefreshToken({state:e,timeoutInSeconds:t}){var r;const n=this._logger.create("useRefreshToken");let o;if(void 0===this.settings.refreshTokenAllowedScope)o=e.scope;else{const t=this.settings.refreshTokenAllowedScope.split(" ");o=((null==(r=e.scope)?void 0:r.split(" "))||[]).filter((e=>t.includes(e))).join(" ")}const i=await this._tokenClient.exchangeRefreshToken({refresh_token:e.refresh_token,scope:o,timeoutInSeconds:t}),s=new oe(new URLSearchParams);return Object.assign(s,i),n.debug("validating response",s),await this._validator.validateRefreshResponse(s,{...e,scope:o}),s}async createSignoutRequest({state:e,id_token_hint:t,request_type:r,post_logout_redirect_uri:n=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}={}){const i=this._logger.create("createSignoutRequest"),s=await this.metadataService.getEndSessionEndpoint();if(!s)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",s);const a=new class{constructor({url:e,state_data:t,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:o,request_type:i}){if(this._logger=new O("SignoutRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");const s=new URL(e);r&&s.searchParams.append("id_token_hint",r),n&&(s.searchParams.append("post_logout_redirect_uri",n),t&&(this.state=new re({data:t,request_type:i}),s.searchParams.append("state",this.state.id)));for(const[a,c]of Object.entries({...o}))null!=c&&s.searchParams.append(a,c.toString());this.url=s.href}}({url:s,id_token_hint:t,post_logout_redirect_uri:n,state_data:e,extraQueryParams:o,request_type:r});await this.clearStaleState();const c=a.state;return c&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(c.id,c.toStorageString())),a}async readSignoutResponseState(e,t=!1){const r=this._logger.create("readSignoutResponseState"),n=new se(D.readParams(e,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new K(n);return{state:void 0,response:n}}const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:re.fromStorageString(o),response:n}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(e,!0);return r?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):t.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),re.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}},ce=class{constructor(e){this._userManager=e,this._logger=new O("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const r=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,r.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,r.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){r.debug("initializing check session iframe");const n=this._userManager.settings.client_id,o=this._userManager.settings.checkSessionIntervalInSeconds,i=this._userManager.settings.stopCheckSessionOnError,s=new G(this._callback,n,e,o,i);await s.load(),this._checkSessionIFrame=s,s.start(t)}else r.warn("no check session iframe found in the metadata")}catch(n){r.error("Error from getCheckSessionIframe:",n instanceof Error?n.message:n)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval((async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}catch(r){e.error("error from querySessionStatus",r instanceof Error?r.message:r)}}),1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let r=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(r=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",t.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),r?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((e=>{this._logger.error(e)}))}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}}},ue=class{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-L.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+L.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new O("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return O.createStatic("User","fromStorageString"),new ue(JSON.parse(e))}},le="oidc-client",de=class{constructor(){this._abort=new U("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:r,keepOpen:n}=await new Promise(((r,n)=>{const o=o=>{var i;const s=o.data,a=null!=(i=e.scriptOrigin)?i:window.location.origin;if(o.origin===a&&(null==s?void 0:s.source)===le){try{const r=D.readParams(s.url,e.response_mode).get("state");if(r||t.warn("no state found in response url"),o.source!==this._window&&r!==e.state)return}catch(c){this._dispose(),n(new Error("Invalid response from window"))}r(s)}};window.addEventListener("message",o,!1),this._disposeHandlers.add((()=>window.removeEventListener("message",o,!1))),this._disposeHandlers.add(this._abort.addHandler((e=>{this._dispose(),n(e)})))}));return t.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t,r=!1,n=window.location.origin){e.postMessage({source:le,url:t,keepOpen:r},n)}},he={location:!1,toolbar:!1,height:640},pe="_blank",fe=60,ge=2,me=10,ye=class extends X{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:r=e.post_logout_redirect_uri,popupWindowFeatures:n=he,popupWindowTarget:o=pe,redirectMethod:i="assign",redirectTarget:s="self",iframeNotifyParentOrigin:a=e.iframeNotifyParentOrigin,iframeScriptOrigin:c=e.iframeScriptOrigin,silent_redirect_uri:g=e.redirect_uri,silentRequestTimeoutInSeconds:y=me,automaticSilentRenew:v=!0,validateSubOnSilentRenew:_=!0,includeIdTokenInSilentRenew:w=!1,monitorSession:b=!1,monitorAnonymousSession:E=!1,checkSessionIntervalInSeconds:S=ge,query_status_response_type:T="code",stopCheckSessionOnError:I=!0,revokeTokenTypes:k=["access_token","refresh_token"],revokeTokensOnSignout:A=!1,includeIdTokenInSilentSignout:R=!1,accessTokenExpiringNotificationTimeInSeconds:O=fe,userStore:N}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=o,this.redirectMethod=i,this.redirectTarget=s,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=c,this.silent_redirect_uri=g,this.silentRequestTimeoutInSeconds=y,this.automaticSilentRenew=v,this.validateSubOnSilentRenew=_,this.includeIdTokenInSilentRenew=w,this.monitorSession=b,this.monitorAnonymousSession=E,this.checkSessionIntervalInSeconds=S,this.stopCheckSessionOnError=I,this.query_status_response_type=T,this.revokeTokenTypes=k,this.revokeTokensOnSignout=A,this.includeIdTokenInSilentSignout=R,this.accessTokenExpiringNotificationTimeInSeconds=O,N)this.userStore=N;else{const e="undefined"!=typeof window?window.sessionStorage:new W;this.userStore=new J({store:e})}}},ve=class extends de{constructor({silentRequestTimeoutInSeconds:e=me}){super(),this._logger=new O("IFrameWindow"),this._timeoutInSeconds=e,this._frame=ve.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout((()=>this._abort.raise(new F("IFrame timed out without a response"))),1e3*this._timeoutInSeconds);return this._disposeHandlers.add((()=>clearTimeout(t))),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(e=>{var t;const r=e.target;null==(t=r.parentNode)||t.removeChild(r),this._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},_e=class extends de{constructor({popupWindowTarget:e=pe,popupWindowFeatures:t={}}){super(),this._logger=new O("PopupWindow");const r=H.center({...he,...t});this._window=window.open(void 0,e,H.serialize(r))}async navigate(e){var t;null==(t=this._window)||t.focus();const r=setInterval((()=>{this._window&&!this._window.closed||this._abort.raise(new Error("Popup closed by user"))}),500);return this._disposeHandlers.add((()=>clearInterval(r))),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,t)}},we=class extends j{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new O("UserManagerEvents"),this._userLoaded=new U("User loaded"),this._userUnloaded=new U("User unloaded"),this._silentRenewError=new U("Silent renew error"),this._userSignedIn=new U("User signed in"),this._userSignedOut=new U("User signed out"),this._userSessionChanged=new U("User session changed")}load(e,t=!0){super.load(e),t&&this._userLoaded.raise(e)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}_raiseSilentRenewError(e){this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},be=class{constructor(e){this._logger=new O("UserManager"),this.settings=new ye(e),this._client=new ae(e),this._redirectNavigator=new class{constructor(e){this._settings=e,this._logger=new O("RedirectNavigator")}async prepare({redirectMethod:e=this._settings.redirectMethod,redirectTarget:t=this._settings.redirectTarget}){var r;this._logger.create("prepare");let n=window.self;"top"===t&&(n=null!=(r=window.top)?r:window.self);const o=n.location[e].bind(n.location);let i;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise(((e,t)=>{i=t}));return o(e.url),await t},close:()=>{this._logger.create("close"),null==i||i(new Error("Redirect aborted")),n.stop()}}}}(this.settings),this._popupNavigator=new class{constructor(e){this._settings=e,this._logger=new O("PopupNavigator")}async prepare({popupWindowFeatures:e=this._settings.popupWindowFeatures,popupWindowTarget:t=this._settings.popupWindowTarget}){return new _e({popupWindowFeatures:e,popupWindowTarget:t})}async callback(e,t=!1){this._logger.create("callback"),_e.notifyOpener(e,t)}}(this.settings),this._iframeNavigator=new class{constructor(e){this._settings=e,this._logger=new O("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:e=this._settings.silentRequestTimeoutInSeconds}){return new ve({silentRequestTimeoutInSeconds:e})}async callback(e){this._logger.create("callback"),ve.notifyParent(e,this._settings.iframeNotifyParentOrigin)}}(this.settings),this._events=new we(this.settings),this._silentRenewService=new class{constructor(e){this._userManager=e,this._logger=new O("SilentRenewService"),this._isStarted=!1,this._retryTimer=new L("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof F)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new ce(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),this._events.load(t,!1),t):(e.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),this._events.unload()}async signinRedirect(e={}){this._logger.create("signinRedirect");const{redirectMethod:t,...r}=e,n=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(e=window.location.href){const t=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(e);return r.profile&&r.profile.sub?t.info("success, signed in subject",r.profile.sub):t.info("no subject"),r}async signinResourceOwnerCredentials({username:e,password:t,skipUserInfo:r=!1}){const n=this._logger.create("signinResourceOwnerCredential"),o=await this._client.processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});n.debug("got signin response");const i=await this._buildUser(o);return i.profile&&i.profile.sub?n.info("success, signed in subject",i.profile.sub):n.info("no subject"),i}async signinPopup(e={}){const t=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_redirect_uri;i||t.throw(new Error("No popup_redirect_uri configured"));const s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),a=await this._signin({request_type:"si:p",redirect_uri:i,display:"popup",...o},s);return a&&(a.profile&&a.profile.sub?t.info("success, signed in subject",a.profile.sub):t.info("no subject")),a}async signinPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async signinSilent(e={}){var t;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,...o}=e;let i=await this._loadUser();if(null==i?void 0:i.refresh_token){r.debug("using refresh token");const e=new class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}}(i);return await this._useRefreshToken(e)}const s=this.settings.silent_redirect_uri;let a;s||r.throw(new Error("No silent_redirect_uri configured")),i&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",i.profile.sub),a=i.profile.sub);const c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return i=await this._signin({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,...o},c,a),i&&((null==(t=i.profile)?void 0:t.sub)?r.info("success, signed in subject",i.profile.sub):r.info("no subject")),i}async _useRefreshToken(e){const t=await this._client.useRefreshToken({state:e,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new ue({...e,...t});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(e=window.location.href){const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(e=window.location.href){const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":return await this.signinPopupCallback(e);case"si:s":return await this.signinSilentCallback(e);default:throw new Error("invalid response_type in state")}}async signoutCallback(e=window.location.href,t=!1){const{state:r}=await this._client.readSignoutResponseState(e);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(e);break;case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(e={}){const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=e,o=this.settings.silent_redirect_uri;o||t.throw(new Error("No silent_redirect_uri configured"));const i=await this._loadUser(),s=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),a=await this._signinStart({request_type:"si:s",redirect_uri:o,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},s);try{const e=await this._client.processSigninResponse(a.url);return t.debug("got signin response"),e.session_state&&e.profile.sub?(t.info("success for subject",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid}):(t.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof K)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:c.session_state}}throw c}}async _signin(e,t,r){const n=await this._signinStart(e,t);return await this._signinEnd(n.url,r)}async _signinStart(e,t){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(e);return r.debug("got signin request"),await t.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(n){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),n}}async _signinEnd(e,t){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(e);r.debug("got signin response");return await this._buildUser(n,t)}async _buildUser(e,t){const r=this._logger.create("_buildUser"),n=new ue(e);if(t){if(t!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new K({...e,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(e={}){const t=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=e,o=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},o),t.info("success")}async signoutRedirectCallback(e=window.location.href){const t=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(e);return t.info("success"),r}async signoutPopup(e={}){const t=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_post_logout_redirect_uri,s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:i,state:null==i?void 0:{},...o},s),t.info("success")}async signoutPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async _signout(e,t){const r=await this._signoutStart(e,t);return await this._signoutEnd(r.url)}async _signoutStart(e={},t){var r;const n=this._logger.create("_signoutStart");try{const o=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(o);const i=e.id_token_hint||o&&o.id_token;i&&(n.debug("setting id_token_hint in signout request"),e.id_token_hint=i),await this.removeUser(),n.debug("user removed, creating signout request");const s=await this._client.createSignoutRequest(e);return n.debug("got signout request"),await t.navigate({url:s.url,state:null==(r=s.state)?void 0:r.id})}catch(o){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),o}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(e);return t.debug("got signout response"),r}async signoutSilent(e={}){var t;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...o}=e,i=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,s=this.settings.popup_post_logout_redirect_uri,a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:s,id_token_hint:i,...o},a),r.info("success")}async signoutSilentCallback(e=window.location.href){const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e,t=this.settings.revokeTokenTypes){const r=this._logger.create("_revokeInternal");if(!e)return;const n=t.filter((t=>"string"==typeof e[t]));if(n.length){for(const t of n)await this._client.revokeToken(e[t],t),r.info(`${t} revoked successfully`),"access_token"!==t&&(e[t]=null);await this.storeUser(e),r.debug("user stored"),this._events.load(e)}else r.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),ue.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const r=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}},Ee="2.2.2"},1026:(e,t,r)=>{"use strict";t.eQ=void 0;var n=r(7770);var o=r(4798);var i=r(152);Object.defineProperty(t,"eQ",{enumerable:!0,get:function(){return i.generateRedirectUri}});var s=r(1903)},7770:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useAuth=t.AuthContext=t.initialAuthContext=void 0;const n=r(2735),o=()=>{throw new Error("You forgot to wrap your component in <AuthProvider>.")};t.initialAuthContext={idpInternalId:"",organization:"",cluster:"",project:"",getUser:o,getToken:o,logout:o,idpType:""},t.AuthContext=(0,n.createContext)(t.initialAuthContext);t.useAuth=()=>{const e=(0,n.useContext)(t.AuthContext);return void 0===e&&o(),e}},4798:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthProvider=void 0;const n=r(4512),o=r(2735),i=r(1903),s=r(7770),a=r(7569);t.AuthProvider=({children:e,loader:t})=>{const[r,c]=(0,o.useState)(null),g=(0,i.useLoginHints)(),{organization:y,cluster:v,project:_,idpInternalId:w}=g,b=(0,o.useCallback)((async()=>{if(y){const e=await(0,i.getDlc)(y),t=(0,i.getIdp)(e.idps,w);t&&c(t)}}),[w,y]);(0,o.useEffect)((()=>{b()}),[b]),(0,o.useEffect)((()=>{(0,i.readLoginHints)()||(0,i.persistLoginHints)(g)}),[g]);const E=(0,o.useMemo)((()=>{if(r)return new i.OidcService(r,y,v||r?.clusters?.[0])}),[y,v,r]),S=(0,o.useMemo)((()=>r&&E?{getToken:async()=>E.acquireTokenSilent(v),getUser:E.getUser,logout:E.logout}:{getToken:()=>Promise.resolve(""),getUser:()=>Promise.resolve({}),logout:()=>Promise.resolve(void 0)}),[v,r,E]),T=(0,o.useMemo)((()=>({idpInternalId:w||"",organization:y||"",cluster:v||"",project:_||"",idpType:r?.type||"",...S})),[S,v,r?.type,w,y,_]);return(0,n.jsx)(s.AuthContext.Provider,{value:T,children:(0,n.jsx)(a.AuthenticatedView,{loader:t,children:e})})}},7569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticatedView=void 0;const n=r(4512),o=r(2735),i=r(7770),s=r(152),a=r(1903);t.AuthenticatedView=({children:e,loader:t})=>{const r=(0,a.useLoginHints)(),{organization:c,idpInternalId:g,cluster:y,project:v}=r,[_,w]=(0,o.useState)(null),[b,E]=(0,o.useState)(!1),[S,T]=(0,o.useState)(!0),{getToken:I}=(0,i.useAuth)(),k=(0,o.useCallback)((()=>{(0,a.clearUrlLoginHints)(),(0,a.clearLoginHints)(),window.location.href=(0,s.generateRedirectUri)()}),[]),A=(0,o.useCallback)((async()=>{T(!0);try{const e=await(0,a.getDlc)(c||""),t=(0,a.getIdp)(e.idps,g);t&&w(t)}finally{T(!1)}}),[g,c]),R=(0,o.useCallback)((async()=>{T(!0);try{await I()&&E(!0)}catch(e){k()}finally{T(!1)}}),[I,k]);return(0,o.useEffect)((()=>{A()}),[A]),(0,o.useEffect)((()=>{_&&!b&&R()}),[_,R,b]),(0,o.useEffect)((()=>{_||g||S||b||k()}),[k,_,g,b,S]),c&&g&&y&&v||k(),S||!b?(0,n.jsx)(n.Fragment,{children:t||null}):(0,n.jsx)(n.Fragment,{children:e})}},4752:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AadService=void 0;const n=r(1110),o=r(676),i=r(9739),s=r(3797),a=r(152),c=r(250),g=e=>0===Object.keys(e).length,y="@cognite/auth-react/aad-stored-account",v=e=>{localStorage.setItem(y,JSON.stringify(e))};t.AadService=class AadService{client;authority;redirectUri=`${window.location.origin}/signin`;storedAccount=(()=>{const e=localStorage.getItem(y);return e?JSON.parse(e):null})();constructor(e,t){this.client=(0,o.getPca)(e,t,this.redirectUri),this.authority=t,this.client.initialize()}handlePromiseSilent=async(e,t)=>{let r=e?.account;const o={scopes:["User.Read"]};if(this.storedAccount&&(o.account=this.storedAccount),t&&o.scopes?.push(...(0,n.getAadScopes)(t)),!r){r=(await this.client.ssoSilent(o)).account}const i={redirectUri:this.redirectUri,authority:this.authority,scopes:[]};if(t){const e=(0,n.getAadScopes)(t);i.scopes.push(...e)}return r&&(i.account=r,this.client.setActiveAccount(r),this.storedAccount=r,v(r)),await this.client.acquireTokenSilent(i)};handlePromiseRedirect=async e=>{const t=this.client.getActiveAccount(),r={prompt:"select_account",authority:this.authority,redirectUri:this.redirectUri,scopes:[]};if(e){const t=(0,n.getAadScopes)(e);r.scopes.push(...t)}return t&&(r.account=t,this.client.setActiveAccount(t),this.storedAccount=t,v(t)),await this.client.acquireTokenRedirect(r)};handlePromiseRedirectNoPrompt=async e=>{const t={prompt:"none",scopes:[]};if(e){const r=(0,n.getAadScopes)(e);t.scopes.push(...r)}return await this.client.loginRedirect(t)};acquireTokenSilent=async e=>{const t=(await this.client.handleRedirectPromise().then((t=>this.handlePromiseSilent(t,e))).catch((()=>this.handlePromiseRedirectNoPrompt())))?.accessToken;if(!t)throw new i.TokenInvalidError;return t};acquireTokenSilentOrRedirect=async e=>{const t=(await this.client.handleRedirectPromise().then((t=>this.handlePromiseSilent(t,e))).catch((()=>this.handlePromiseRedirect(e))))?.accessToken;if(!t)throw new i.TokenInvalidError;return t};getUser=async()=>{let e=this.client.getActiveAccount();if(!e){if(e=(await this.client.ssoSilent({scopes:["User.Read"]})).account,!e)throw new s.UserNotFoundError}const t={scopes:["User.Read"]};let r;if(e&&(t.account=e),e?.idTokenClaims&&!g(e?.idTokenClaims)&&(r=e?.idTokenClaims),!r){r=(await this.client.acquireTokenSilent(t))?.idTokenClaims}if(!r||g(r))throw new s.UserNotFoundError;return{id:r?.oid||r?.sub,name:r?.name,email:r?.email||r?.preferred_username,preferred_username:r?.preferred_username}};redirectToConsent=async e=>{this.client.loginRedirect({scopes:["User.Read",...(0,n.getAadScopes)(e)],prompt:"consent"})};logout=async(e=!1)=>{const t=this.client.getActiveAccount()||this.storedAccount,r={account:t,postLogoutRedirectUri:(0,a.generateRedirectUri)(),onRedirectNavigate:()=>!1},n=t?.idTokenClaims?.login_hint;n&&(r.logoutHint=n),e&&(r.onRedirectNavigate=()=>!0),this.client.setActiveAccount(null),(0,c.clearLoginHints)(),this.client.logoutRedirect(r)}}},1110:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAadScopes=void 0;t.getAadScopes=e=>e?[`https://${e}/IDENTITY`,`https://${e}/user_impersonation`]:[]},676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPca=void 0;const n=r(8297);t.getPca=(e,t,r)=>{const o=new n.PublicClientApplication({auth:{clientId:e,authority:t,redirectUri:r},cache:{cacheLocation:"memoryStorage",storeAuthStateInCookie:!0}});return!o.getActiveAccount()&&o.getAllAccounts().length>0&&o.setActiveAccount(o.getAllAccounts()[0]),o.enableAccountStorageEvents(),o.addEventCallback((e=>{if(e.eventType===n.EventType.LOGIN_SUCCESS||e.eventType===n.EventType.SSO_SILENT_SUCCESS||e.eventType===n.EventType.ACQUIRE_TOKEN_SUCCESS||e.eventType===n.EventType.ACQUIRE_TOKEN_BY_CODE_SUCCESS){const{account:t}=e.payload;t&&o.setActiveAccount(t)}})),o}},8450:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPca=t.getAadScopes=t.AadService=void 0;var n=r(4752);Object.defineProperty(t,"AadService",{enumerable:!0,get:function(){return n.AadService}});var o=r(1110);Object.defineProperty(t,"getAadScopes",{enumerable:!0,get:function(){return o.getAadScopes}});var i=r(676);Object.defineProperty(t,"getPca",{enumerable:!0,get:function(){return i.getPca}})},5947:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Auth0Service=void 0;const n=r(8149),o=r(9739),i=r(3797),s=r(250),a=r(152);t.Auth0Service=class Auth0Service{clientId;authority;audience;redirectUri=window.location.href;constructor(e,t,r){this.clientId=e,this.authority=t,r&&(this.audience=r)}getClient=async()=>{const e={domain:this.authority,clientId:this.clientId,authorizationParams:{audience:this.audience,redirect_uri:this.redirectUri}};return await(0,n.createAuth0Client)(e)};acquireTokenSilent=async()=>{const e=await this.getClient(),t=await e.getTokenSilently();if(!t)throw new o.TokenInvalidError;return t};acquireTokenSilentOrRedirect=async e=>{const t=await this.getClient();let r="";try{r=await t.getTokenSilently()}catch(n){console.error(n)}try{r||await t.loginWithRedirect()}catch{throw new o.TokenInvalidError}return r};getUser=async()=>{const e=await this.getClient();await e.getTokenSilently({detailedResponse:!0,authorizationParams:{scope:"openid profile email user_metadata",audience:this.audience}});const t=await e.getIdTokenClaims();if(!t)throw new i.UserNotFoundError;return{id:t?.sub,name:t?.name,preferred_username:t?.nickname,email:t?.email}};logout=async()=>{const e=await this.getClient();(0,s.clearLoginHints)(),await e.logout({logoutParams:{returnTo:(0,a.generateRedirectUri)()}})}}},1667:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Auth0Service=void 0;var n=r(5947);Object.defineProperty(t,"Auth0Service",{enumerable:!0,get:function(){return n.Auth0Service}})},7066:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CogniteIdpService=void 0;const n=r(6986),o=r(9739),i=r(152),s=r(250);let a;t.CogniteIdpService=class CogniteIdpService{client;redirectUri=`${window.location.origin}/signin`;userManagerSettings;prefix;constructor(e,t,r){this.prefix=`oidc:state:${t}`,this.userManagerSettings={authority:t,client_id:e,redirect_uri:this.redirectUri,scope:"openid profile email offline",extraQueryParams:{audience:"https://cognitedata.com",...r&&{organization_hint:r}},userStore:new n.WebStorageStateStore({store:new n.InMemoryWebStorage,prefix:this.prefix})},this.client=new n.UserManager(this.userManagerSettings)}getTokenPromise=async()=>{if(a)return a;return a=(async()=>{try{let e=await this.client.getUser();e?.expired&&(e=await this.client.signinSilent());let t=e?.access_token;return t||(e=await this.client.signinRedirectCallback(),t=e?.access_token),t}catch(e){throw new o.TokenInvalidError}finally{this.client.clearStaleState()}})(),a.then((()=>{a=void 0})).catch((e=>{e instanceof o.TokenInvalidError&&this.client.signinRedirect()})),a};acquireTokenSilent=async()=>this.getTokenPromise();acquireTokenSilentOrRedirect=async()=>this.getTokenPromise();getUser=async()=>{const e=await this.client.getUser();return{id:e?.profile?.sub,email:e?.profile?.email,name:e?.profile?.name,picture:e?.profile?.picture}};logout=async()=>{(0,s.clearLoginHints)(),this.client.signoutRedirect({post_logout_redirect_uri:(0,i.generateRedirectUri)()})}}},3238:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CogniteIdpService=void 0;var n=r(7066);Object.defineProperty(t,"CogniteIdpService",{enumerable:!0,get:function(){return n.CogniteIdpService}})},5139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdpNotFoundError=void 0;class IdpNotFoundError extends Error{idpInternalId;constructor(e){super(`Idp with internalId (${e}) not found`),this.idpInternalId=e,Object.setPrototypeOf(this,IdpNotFoundError.prototype)}}t.IdpNotFoundError=IdpNotFoundError},9449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDlc=void 0;const n=r(6760);t.getDlc=async e=>{const t=await fetch(`https://app-login-configuration-lookup.cognite.ai/${encodeURIComponent((0,n.getDlcApp)())}/${encodeURIComponent(e)}`);if(!t.ok){const e=await t.json();return Promise.reject({...e,status:t.status})}return await t.json()}},6760:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDlcApp=void 0;t.getDlcApp=()=>{const e=["apps.cognite.com","apps-staging.cognite.com","apps-preview.cognite.com"];return t=window.location.origin,e.find((e=>t.includes(e)))?"fusion":"fusion-dev";var t}},8388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIdp=void 0,t.getIdp=function(e,t){return e.find((e=>e.internalId===t))}},9720:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdpNotFoundError=t.getIdp=t.getDlc=void 0;var n=r(9449);Object.defineProperty(t,"getDlc",{enumerable:!0,get:function(){return n.getDlc}});var o=r(8388);Object.defineProperty(t,"getIdp",{enumerable:!0,get:function(){return o.getIdp}});var i=r(5139);Object.defineProperty(t,"IdpNotFoundError",{enumerable:!0,get:function(){return i.IdpNotFoundError}})},1903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAadError=t.AadError=t.OidcService=t.useLoginHints=t.readLoginHints=t.persistLoginHints=t.clearUrlLoginHints=t.getUrlLoginHints=t.clearLoginHints=t.loginHintKeys=t.SAuthService=t.KeycloakService=t.getIdp=t.getDlc=t.Auth0Service=t.getPca=t.getAadScopes=t.AadService=void 0;var n=r(8450);Object.defineProperty(t,"AadService",{enumerable:!0,get:function(){return n.AadService}}),Object.defineProperty(t,"getAadScopes",{enumerable:!0,get:function(){return n.getAadScopes}}),Object.defineProperty(t,"getPca",{enumerable:!0,get:function(){return n.getPca}});var o=r(1667);Object.defineProperty(t,"Auth0Service",{enumerable:!0,get:function(){return o.Auth0Service}});var i=r(9720);Object.defineProperty(t,"getDlc",{enumerable:!0,get:function(){return i.getDlc}}),Object.defineProperty(t,"getIdp",{enumerable:!0,get:function(){return i.getIdp}});var s=r(326);Object.defineProperty(t,"KeycloakService",{enumerable:!0,get:function(){return s.KeycloakService}});var a=r(5307);Object.defineProperty(t,"SAuthService",{enumerable:!0,get:function(){return a.SAuthService}});var c=r(250);Object.defineProperty(t,"loginHintKeys",{enumerable:!0,get:function(){return c.loginHintKeys}}),Object.defineProperty(t,"clearLoginHints",{enumerable:!0,get:function(){return c.clearLoginHints}}),Object.defineProperty(t,"getUrlLoginHints",{enumerable:!0,get:function(){return c.getUrlLoginHints}}),Object.defineProperty(t,"clearUrlLoginHints",{enumerable:!0,get:function(){return c.clearUrlLoginHints}}),Object.defineProperty(t,"persistLoginHints",{enumerable:!0,get:function(){return c.persistLoginHints}}),Object.defineProperty(t,"readLoginHints",{enumerable:!0,get:function(){return c.readLoginHints}}),Object.defineProperty(t,"useLoginHints",{enumerable:!0,get:function(){return c.useLoginHints}});var g=r(9739);Object.defineProperty(t,"OidcService",{enumerable:!0,get:function(){return g.OidcService}}),Object.defineProperty(t,"AadError",{enumerable:!0,get:function(){return g.AadError}}),Object.defineProperty(t,"isAadError",{enumerable:!0,get:function(){return g.isAadError}})},4681:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeycloakService=void 0;const n=r(6986),o=r(9739),i=r(152),s=r(250);let a;t.KeycloakService=class KeycloakService{client;redirectUri=window.location.href;userManagerSettings;prefix;constructor(e,t,r,o){this.prefix=`oidc:state:${t}/realms/${r}`,this.userManagerSettings={authority:`${t}/realms/${r}`,client_id:e,redirect_uri:this.redirectUri,scope:`openid profile https://${o} user_impersonation IDENTITY`,automaticSilentRenew:!1,userStore:new n.WebStorageStateStore({store:new n.InMemoryWebStorage,prefix:this.prefix})},this.client=new n.UserManager(this.userManagerSettings)}changeCluster=e=>{this.userManagerSettings.scope=`openid profile https://${e} user_impersonation IDENTITY`,this.client=new n.UserManager(this.userManagerSettings)};getTokenPromise=async()=>{if(a)return a;return a=(async()=>{try{let e=await this.client.getUser();e?.expired&&(e=await this.client.signinSilent());let t=e?.access_token;return t||(e=await this.client.signinRedirectCallback(),t=e?.access_token),t}catch(e){throw new o.TokenInvalidError}finally{this.client.clearStaleState()}})(),a.then((()=>{a=void 0})).catch((e=>{e instanceof o.TokenInvalidError&&this.client.signinRedirect()})),a};acquireTokenSilent=async()=>this.getTokenPromise();acquireTokenSilentOrRedirect=async e=>(e&&this.changeCluster(e),this.getTokenPromise());getUser=async()=>{const e=await this.client.getUser();return{id:e?.profile?.sid,preferred_username:e?.profile?.preferred_username,email:e?.profile?.email,name:e?.profile?.name}};logout=async()=>{(0,s.clearLoginHints)(),this.client.signoutRedirect({post_logout_redirect_uri:(0,i.generateRedirectUri)()})}}},326:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeycloakService=void 0;var n=r(4681);Object.defineProperty(t,"KeycloakService",{enumerable:!0,get:function(){return n.KeycloakService}})},8762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearLoginHints=void 0;const n=r(2537);t.clearLoginHints=()=>{window.localStorage.removeItem(n.LOGIN_HINTS_LS_KEY)}},4602:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearUrlLoginHints=void 0;t.clearUrlLoginHints=()=>{const e=new URLSearchParams(window.location.search);e.delete("project"),e.delete("cluster"),e.delete("idpInternalId"),e.delete("organization"),window.location.search=e.toString()}},7046:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlLoginHints=void 0;t.getUrlLoginHints=()=>{const e=new URLSearchParams(window.location.search),t=e.get("project"),r=e.get("cluster"),n=e.get("idpInternalId"),o=e.get("organization"),i={};return o&&(i.organization=o),t&&(i.project=t),r&&(i.cluster=r),n&&(i.idpInternalId=n),i}},250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLoginHints=t.readLoginHints=t.persistLoginHints=t.loginHintKeys=t.clearUrlLoginHints=t.getUrlLoginHints=t.clearLoginHints=void 0;var n=r(8762);Object.defineProperty(t,"clearLoginHints",{enumerable:!0,get:function(){return n.clearLoginHints}});var o=r(7046);Object.defineProperty(t,"getUrlLoginHints",{enumerable:!0,get:function(){return o.getUrlLoginHints}});var i=r(4602);Object.defineProperty(t,"clearUrlLoginHints",{enumerable:!0,get:function(){return i.clearUrlLoginHints}});var s=r(3995);Object.defineProperty(t,"loginHintKeys",{enumerable:!0,get:function(){return s.loginHintKeys}});var a=r(2198);Object.defineProperty(t,"persistLoginHints",{enumerable:!0,get:function(){return a.persistLoginHints}});var c=r(2182);Object.defineProperty(t,"readLoginHints",{enumerable:!0,get:function(){return c.readLoginHints}});var g=r(7962);Object.defineProperty(t,"useLoginHints",{enumerable:!0,get:function(){return g.useLoginHints}})},3995:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loginHintKeys=void 0,t.loginHintKeys={organization:"organization",project:"project",cluster:"cluster",idpInternalId:"idpInternalId"}},2537:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOGIN_HINTS_LS_KEY=void 0,t.LOGIN_HINTS_LS_KEY="@cognite/auth-react/login-hints"},2198:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.persistLoginHints=void 0;const n=r(2537),o=r(2182);t.persistLoginHints=e=>{const t={...(0,o.readLoginHints)()};Object.entries(e).forEach((([e,r])=>{r&&(t[e]=r)})),window.localStorage.setItem(n.LOGIN_HINTS_LS_KEY,JSON.stringify(t))}},2182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readLoginHints=void 0;const n=r(2537);t.readLoginHints=()=>{try{const e=JSON.parse(window.localStorage.getItem(n.LOGIN_HINTS_LS_KEY)||"{}");if(Object.entries(e).length>0)return e}catch(e){return}}},7962:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLoginHints=void 0;const n=r(7046),o=r(2182),i=(e,t={})=>{Object.entries(t).forEach((([t,r])=>{const n=t;!e[n]&&r&&(e[n]=r)}))};t.useLoginHints=()=>{const e=(0,n.getUrlLoginHints)(),t=(0,o.readLoginHints)(),r={};return i(r,t),i(r,e),r}},1262:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AadError=void 0;class AadError extends Error{errorCode;errorMessage;constructor(e,t){super(),this.errorCode=e,this.errorMessage=t,this.name="AadError"}}t.AadError=AadError},8602:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcService=void 0;const n=r(612),o=r(8450),i=r(1667),s=r(326),a=r(5307),c=r(3238);t.OidcService=class OidcService{idp;service;constructor(e,t,r){switch(this.idp=e,"KEYCLOAK"===e?.type&&""===e?.realm&&(e.type="S_AUTH"),e?.type){case"AZURE_AD":this.service=new o.AadService(e?.appConfiguration.clientId,e.authority);break;case"AUTH0":{const t=e;this.service=new i.Auth0Service(t?.appConfiguration.clientId,t?.authority,t?.appConfiguration.audience);break}case"KEYCLOAK":{const t=e;this.service=new s.KeycloakService(t?.appConfiguration?.clientId,t?.authority,t?.realm,r||t?.clusters[0]);break}case"S_AUTH":{const t=e;this.service=new a.SAuthService(t?.appConfiguration.clientId,t?.authority,t?.appConfiguration.audience);break}case"COGNITE_IDP":{const r=e;this.service=new c.CogniteIdpService(r?.appConfiguration?.clientId,r?.authority,t);break}default:this.service=null}}acquireTokenSilent=async(e=this.idp.clusters[0])=>{let t;if(this.service&&(t=await(this.service?.acquireTokenSilent(e))),!t)throw new n.InvalidTokenError;return t};acquireTokenSilentOrRedirect=async e=>{let t;if(this.service&&(t=await(this.service?.acquireTokenSilentOrRedirect(e))),!t)throw new n.InvalidTokenError;return t};getUser=()=>this.service?this.service?.getUser():Promise.resolve({});logout=(e=!1)=>this.service?this.service.logout(e):Promise.resolve(void 0);redirectToConsent=e=>{const t=this.service;return t?t.redirectToConsent(e):Promise.resolve(void 0)}}},7940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenInvalidError=void 0;class TokenInvalidError extends Error{constructor(){super(),this.message="Access token not found"}}t.TokenInvalidError=TokenInvalidError},3797:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserNotFoundError=void 0;class UserNotFoundError extends Error{constructor(){super(),this.message="User not found"}}t.UserNotFoundError=UserNotFoundError},9739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAadError=t.AadError=t.TokenInvalidError=t.OidcService=void 0;var n=r(8602);Object.defineProperty(t,"OidcService",{enumerable:!0,get:function(){return n.OidcService}});var o=r(7940);Object.defineProperty(t,"TokenInvalidError",{enumerable:!0,get:function(){return o.TokenInvalidError}});var i=r(1262);Object.defineProperty(t,"AadError",{enumerable:!0,get:function(){return i.AadError}});var s=r(8240);Object.defineProperty(t,"isAadError",{enumerable:!0,get:function(){return s.isAadError}})},8240:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAadError=void 0;t.isAadError=e=>void 0!==e?.errorCode&&void 0!==e?.errorMessage},6883:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SAuthService=void 0;const n=r(6986),o=r(9739),i=r(152),s=r(250);let a;t.SAuthService=class SAuthService{client;redirectUri=`${window.location.origin}/signin`;userManagerSettings;prefix;constructor(e,t,r){this.prefix=`oidc:state:${t}`,this.userManagerSettings={authority:t,client_id:e,redirect_uri:this.redirectUri,scope:r,automaticSilentRenew:!1,userStore:new n.WebStorageStateStore({store:new n.InMemoryWebStorage,prefix:this.prefix})},this.client=new n.UserManager(this.userManagerSettings)}getTokenPromise=async()=>{if(a)return a;return a=(async()=>{try{let e=await this.client.getUser();e?.expired&&(e=await this.client.signinSilent());let t=e?.access_token;return t||(e=await this.client.signinRedirectCallback(),t=e?.access_token),t}catch(e){throw new o.TokenInvalidError}finally{this.client.clearStaleState()}})(),a.then((()=>{a=void 0})).catch((e=>{e instanceof o.TokenInvalidError&&this.client.signinRedirect()})),a};acquireTokenSilent=async()=>this.getTokenPromise();acquireTokenSilentOrRedirect=async e=>this.getTokenPromise();getUser=async()=>{const e=await this.client.getUser();return{id:e?.profile?.sid,preferred_username:e?.profile?.preferred_username,email:e?.profile?.email,name:e?.profile?.name}};logout=async()=>{(0,s.clearLoginHints)(),this.client.signoutRedirect({post_logout_redirect_uri:(0,i.generateRedirectUri)()})}}},5307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SAuthService=void 0;var n=r(6883);Object.defineProperty(t,"SAuthService",{enumerable:!0,get:function(){return n.SAuthService}})},152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRedirectUri=void 0;const n=r(1903),o=["apps.cognite.com","apps-staging.cognite.com","apps-test.cognite.com","apps-preview.cognite.com"];t.generateRedirectUri=()=>{let e=new URL("https://apps.cognite.com/signin");const t=o.findIndex((e=>window.location.hostname===e));o.includes(window.location.hostname)&&(e=new URL(`https://${[o[t]]}/signin`)),(0,n.clearUrlLoginHints)();const r=window.location.href;return e.searchParams.set("redirectUri",r),e.href}},9675:(e,t,r)=>{"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(8906)),i=n(r(5973)),s=n(r(7236)),a=n(r(8998)),c=n(r(3382)),g=n(r(4461)),y=n(r(3839)),v=r(1662),_=r(9456),w=n(_),b=r(511),E=n(r(6291)),S=n(r(1273)),T=n(r(3581)),I="cognitedata.com",k="https://api."+I,A="Authorization",R="api-key",O="x-cdp-app",N="x-cdp-sdk",U="x-request-id",M=Object.freeze({__proto__:null,DEFAULT_CLUSTER:"api",DEFAULT_DOMAIN:I,BASE_URL:k,AUTHORIZATION_HEADER:A,API_KEY_HEADER:R,X_CDF_APP_HEADER:O,X_CDF_SDK_HEADER:N,X_REQUEST_ID:U,LOCAL_STORAGE_PREFIX:"@cognite/sdk:"}),q=function(){var e=this;this.add=function(t){e.data.unshift(t)},this.remove=function(){e.data.pop()},this.first=function(){return e.data[0]},this.last=function(){return e.data[e.data.length-1]},this.size=function(){return e.data.length},this.data=[]};var H=Object.freeze({__proto__:null,topologicalSort:function(e){var t=new q,r=[],n=function(e){var t=new Map;return e.forEach((function(e){t.set(e,[])})),e.forEach((function(e){var r=e.parentNode;r&&t.get(r).push(e)})),t}(e);for(e.forEach((function(e){e.parentNode||t.add(e)}));0!==t.size();){var o=t.last();t.remove(),r.push(o);var i=n.get(o);i&&i.forEach(t.add)}if(r.length!==e.length)throw Error("Impossible to topological sort nodes");return r}}),L=function(e,t){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},L(e,t)};function D(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}L(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var K=function(){return K=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},K.apply(this,arguments)};function F(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function j(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function G(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function W(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(G(arguments[t]));return e}function Y(e){var t,r=e,n=0;function o(e){return n<e.items.length?{value:e.items[n++],done:!1}:e.next?(n=0,(r=e.next()).then(o)):{value:void 0,done:!0}}function i(){return F(this,void 0,void 0,(function(){return j(this,(function(e){switch(e.label){case 0:return[4,r];case 1:return[2,o(e.sent())]}}))}))}var s=function(e){return function(t){return F(this,void 0,void 0,(function(){function r(){return F(this,void 0,void 0,(function(){var n,o;return j(this,(function(i){switch(i.label){case 0:return[4,e()];case 1:return(n=i.sent()).done?[2]:(o=n.value,[4,t(o)]);case 2:return!1===i.sent()?[2]:[4,r()];case 3:return i.sent(),[2]}}))}))}return j(this,(function(e){switch(e.label){case 0:return[4,r()];case 1:return e.sent(),[2]}}))}))}}(i),a=function(e){return function(t){return F(this,void 0,void 0,(function(){var r,n,o=this;return j(this,(function(i){switch(i.label){case 0:return-1===(r=t&&t.limit||25)&&(r=1/0),n=[],[4,e((function(e){return F(o,void 0,void 0,(function(){return j(this,(function(t){return n.push(e),n.length>=r?[2,!1]:[2]}))}))}))];case 1:return i.sent(),[2,n]}}))}))}}(s),c=((t={autoPagingEach:s,autoPagingToArray:a,next:i,return:function(){return{}}})[Symbol.asyncIterator]=function(){return c},t);return c}void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.for("asyncIterator"));var V=function(e){function t(r,n,o,i){void 0===i&&(i={});var s=this,a=r+" | code: "+n;o&&(a+=" | X-Request-ID: "+o);var c=i.missing,g=i.duplicated,y=i.extra;return(c||g)&&(a+="\n"+JSON.stringify(i,null,2)),s=e.call(this,a)||this,Object.setPrototypeOf(s,t.prototype),s.errorMessage=r,s.status=n,s.requestId=o,s.missing=c,s.duplicated=g,s.extra=y,Error.captureStackTrace?Error.captureStackTrace(s,s.constructor):s.stack=new Error(a).stack,s}return D(t,e),t.prototype.toJSON=function(){var e={status:this.status,message:this.errorMessage};return this.requestId&&(e.requestId=this.requestId),this.missing&&(e.missing=this.missing),this.duplicated&&(e.duplicated=this.duplicated),this.extra&&(e.extra=this.extra),e},t}(Error);function J(e){return e.map((function(e){if(e instanceof V)return e;var t=e.message;return{name:e.name,message:t,stack:e.stack}}))}var X=function(e){function t(r){var n,o,i=r.succeded,s=r.responses,a=r.failed,c=r.errors,g=e.call(this,"The API Failed to process some items\n"+JSON.stringify({succeded:i,responses:s,failed:a,errors:J(c)},null,2))||this;g.missing=[],g.duplicated=[],g.statuses=[],g.requestIds=[],g.responses=[],Object.setPrototypeOf(g,t.prototype),g.responses=s.map((function(e){return e.data})),g.errors=c,g.succeded=i.reduce((function(e,t){return e.concat(t)}),[]),g.failed=a.reduce((function(e,t){return e.concat(t)}),[]),g.status=c[0].status,g.requestId=c[0].requestId;try{for(var y=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(c),v=y.next();!v.done;v=y.next()){var _=v.value;_ instanceof V&&(_.missing&&(g.missing=g.missing.concat(_.missing)),_.duplicated&&(g.duplicated=g.duplicated.concat(_.duplicated)),_.requestId&&g.requestIds.push(_.requestId),g.statuses.push(_.status))}}catch(w){n={error:w}}finally{try{v&&!v.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}return Error.captureStackTrace?Error.captureStackTrace(g,g.constructor):g.stack=new Error(g.message).stack,g}return D(t,e),t}(Error);function Q(e){return e||k}var $=function(e){return void 0===e&&(e="v1"),"/api/"+e};function ee(e){return"Bearer "+e}function re(){return"undefined"!=typeof window&&void 0!==window.document}function ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=window.location.href;e.forEach((function(e){r=oe(r,e)})),window.history.replaceState(null,"",r)}function oe(e,t){return e.replace(new RegExp("[?#&]"+t+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?#&])"+t+"=[^&]*&"),"$1")}function se(e){return(s(e)||i(e))&&!a(e)&&!(e instanceof ArrayBuffer)&&!(e instanceof Date)}function ae(e){return new Promise((function(t){setTimeout(t,e)}))}function ce(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,s,a;return j(this,(function(c){switch(c.label){case 0:return r=[],n=[],o=[],i=[],s=e.map(t),a=s.map((function(t,r){return new Promise((function(n){t.then((function(t){n({succeded:e[r],response:t})})).catch((function(t){n({failed:e[r],error:t})}))}))})),[4,Promise.all(a)];case 1:if(c.sent().forEach((function(e){r.push.apply(r,W(e.failed?[e.failed]:[])),n.push.apply(n,W(e.succeded?[e.succeded]:[])),o.push.apply(o,W(e.response?[e.response]:[])),i.push.apply(i,W(e.error?[e.error]:[]))})),r.length)throw{succeded:n,responses:o,failed:r,errors:i};return[2,o]}}))}))}function ue(e,t,r){return F(this,void 0,void 0,(function(){var n;return j(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),r?[4,le(e,t)]:[3,2];case 1:case 3:return[2,o.sent()];case 2:return[4,ce(e,t)];case 4:return[3,6];case 5:throw n=o.sent(),new X(n);case 6:return[2]}}))}))}function le(e,t){return F(this,void 0,void 0,(function(){var r=this;return j(this,(function(n){return[2,e.reduce((function(n,o,i){return F(r,void 0,void 0,(function(){var r,s,a;return j(this,(function(c){switch(c.label){case 0:return[4,n];case 1:r=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),a=(s=r).concat,[4,t(o)];case 3:return[2,a.apply(s,[c.sent()])];case 4:throw{errors:[c.sent()],failed:e.slice(i),succeded:e.slice(0,i),responses:r};case 5:return[2]}}))}))}),Promise.resolve(new Array))]}))}))}function de(e,t){return t?t(e):e}function he(){return re()&&"https:"===location.protocol.toLowerCase()}var pe,fe=function(){function e(e,t){var r=this;this.path=e,this.datePropNames=t,this.isDatePropName=function(e){return"string"==typeof e&&-1!=r.datePropNames.indexOf(e)},this.isPath=function(e){return"string"==typeof e&&-1!=r.path.indexOf(e)}}return e.prototype.parseToDates=function(e){var t=this;return c(e,(function(e,r,n){return t.isDatePropName(r)?new Date(e):void 0===r||t.isPath(r)||n instanceof Array?void 0:e}))},e.parseFromDates=function(e){return c(e,(function(e){if(e instanceof Date)return e.getTime()}))},e}(),ge=function(){function e(e,t,r){var n=this;this.resourcePath=e,this.httpClient=t,this.map=r,this.get=this.requestWrapper(this.httpClient.get.bind(this.httpClient)),this.post=this.requestWrapper(this.httpClient.post.bind(this.httpClient)),this.put=this.requestWrapper(this.httpClient.put.bind(this.httpClient)),this.callListEndpointWithGet=function(e){return F(n,void 0,void 0,(function(){return j(this,(function(t){switch(t.label){case 0:return[4,this.get(this.listGetUrl,{params:e})];case 1:return[2,t.sent()]}}))}))},this.callListEndpointWithPost=function(e){return F(n,void 0,void 0,(function(){return j(this,(function(t){switch(t.label){case 0:return[4,this.post(this.listPostUrl,{data:e||{}})];case 1:return[2,t.sent()]}}))}))},this.dateParser=new(fe.bind.apply(fe,W([void 0],this.getDateProps())))}return Object.defineProperty(e.prototype,"listGetUrl",{get:function(){return this.url("")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listPostUrl",{get:function(){return this.url("list")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"byIdsUrl",{get:function(){return this.url("byids")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateUrl",{get:function(){return this.url("update")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"searchUrl",{get:function(){return this.url("search")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deleteUrl",{get:function(){return this.url("delete")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aggregateUrl",{get:function(){return this.url("aggregate")},enumerable:!1,configurable:!0}),e.chunk=function(e,t){return 0===e.length?[[]]:o(e,t)},e.prototype.getMetadataMap=function(){return this.map},e.prototype.getDateProps=function(){return[[],[]]},e.prototype.pickDateProps=function(e,t){return[e,t]},e.prototype.url=function(e){return void 0===e&&(e=""),this.resourcePath+"/"+e},e.prototype.requestWrapper=function(e){var t=this;return function(r,n){return F(t,void 0,void 0,(function(){var t;return j(this,(function(o){switch(o.label){case 0:return void 0!==n&&(n=K(K({},n),{params:fe.parseFromDates(n.params),data:fe.parseFromDates(n.data)})),[4,e(r,n)];case 1:return t=o.sent(),[2,K(K({},t),{data:this.dateParser.parseToDates(t.data)})]}}))}))}},e.prototype.createEndpoint=function(e,t,r,n){return void 0===t&&(t=this.url()),F(this,void 0,void 0,(function(){var o=this;return j(this,(function(i){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return o.callCreateEndpoint(e,t)}),r,n)]}))}))},e.prototype.cursorBasedEndpoint=function(e,t){var r=this,n=e(t).then((function(n){return r.addNextPageFunction(e.bind(r),n.data,t)})),o=Y(n);return Object.assign(n,o)},e.prototype.listEndpoint=function(e,t){return this.cursorBasedEndpoint(e,t)},e.prototype.retrieveEndpoint=function(e,t,r){return F(this,void 0,void 0,(function(){var n=this;return j(this,(function(o){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return n.callRetrieveEndpoint(e,r,t)}))]}))}))},e.prototype.updateEndpoint=function(e,t){return F(this,void 0,void 0,(function(){var r=this;return j(this,(function(n){return[2,this.callEndpointWithMergeAndTransform(e,(function(e){return r.callUpdateEndpoint(e,t)}))]}))}))},e.prototype.searchEndpoint=function(e,t,r){return F(this,void 0,void 0,(function(){var n=this;return j(this,(function(o){return[2,this.callEndpointWithTransform(e,(function(e){return n.callSearchEndpoint(e,t,r)}))]}))}))},e.prototype.deleteEndpoint=function(e,t,r){return F(this,void 0,void 0,(function(){var n;return j(this,(function(o){switch(o.label){case 0:return[4,this.callDeleteEndpoint(e,t,r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn({},n[0])]}}))}))},e.prototype.aggregateEndpoint=function(e,t){return F(this,void 0,void 0,(function(){var r;return j(this,(function(n){switch(n.label){case 0:return[4,this.callAggregateEndpoint(e,t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},e.prototype.callRetrieveEndpoint=function(e,t,r){return void 0===t&&(t=this.byIdsUrl),F(this,void 0,void 0,(function(){return j(this,(function(n){return[2,this.postInParallelWithAutomaticChunking({params:r,path:t,items:e})]}))}))},e.prototype.callUpdateEndpoint=function(e,t){return void 0===t&&(t=this.updateUrl),F(this,void 0,void 0,(function(){return j(this,(function(r){return[2,this.postInParallelWithAutomaticChunking({path:t,items:e})]}))}))},e.prototype.callSearchEndpoint=function(e,t,r){return void 0===t&&(t=this.searchUrl),F(this,void 0,void 0,(function(){return j(this,(function(n){return[2,this.post(t,{data:e,params:r})]}))}))},e.prototype.callDeleteEndpoint=function(e,t,r){return void 0===r&&(r=this.deleteUrl),this.postInParallelWithAutomaticChunking({path:r,items:e,params:t})},e.prototype.callAggregateEndpoint=function(e,t){return void 0===t&&(t=this.aggregateUrl),F(this,void 0,void 0,(function(){return j(this,(function(r){return[2,this.post(t,{data:e})]}))}))},e.prototype.addToMapAndReturn=function(e,t){return this.map.addAndReturn(e,t)},e.prototype.callEndpointWithMergeAndTransform=function(e,t,r,n){return F(this,void 0,void 0,(function(){var o,i,s,a;return j(this,(function(c){switch(c.label){case 0:return o=de(e,r),[4,t.bind(this)(o)];case 1:return i=c.sent(),s=this.mergeItemsFromItemsResponse(i),a=de(s,n),[2,this.addToMapAndReturn(a,i[0])]}}))}))},e.prototype.callEndpointWithTransform=function(e,t){return F(this,void 0,void 0,(function(){var r;return j(this,(function(n){switch(n.label){case 0:return[4,t.bind(this)(e)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},e.prototype.mergeItemsFromItemsResponse=function(e){return e.map((function(e){return e.data.items})).reduce((function(e,t){return W(e,t)}),[])},e.prototype.addNextPageFunction=function(e,t,r){var n=this;void 0===r&&(r={});var o=t.nextCursor,i=o?function(){return e(K(K({},r),{cursor:o})).then((function(t){return n.addNextPageFunction(e,t.data,r)}))}:void 0;return K(K({},t),{next:i})},e.prototype.postInParallelWithAutomaticChunking=function(t){var r=this,n=t.path,o=t.items,i=t.params,s=t.queryParams,a=t.chunkSize,c=void 0===a?1e3:a;return ue(e.chunk(o,c),(function(e){return r.post(n,{data:K(K({},i),{items:e}),params:s})}),!1)},e.prototype.callCreateEndpoint=function(e,t){return F(this,void 0,void 0,(function(){return j(this,(function(r){return[2,this.postInSequenceWithAutomaticChunking(t,e)]}))}))},e.prototype.postInSequenceWithAutomaticChunking=function(t,r,n){var o=this;return ue(e.chunk(r,1e3),(function(e){return o.post(t,{data:{items:e},params:n})}),!0)},e}(),me=function(e){function t(r,n,o){var i=e.call(this,"Request failed | status code: "+r)||this;return i.status=r,i.data=n,i.headers=o,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace?Error.captureStackTrace(i,i.constructor):i.stack=new Error(i.message).stack,i}return D(t,e),t}(Error),ye=function(){function e(e){var t=this;this.baseUrl=e,this.defaultHeaders={},this.setCluster=function(e){t.baseUrl="https://"+e+"."+I}}return e.validateStatusCode=function(e){return e>=200&&e<300},e.throwCustomErrorResponse=function(e){throw new me(e.status,e.data,e.headers)},e.jsonResponseHandler=function(e){return e.json()},e.textResponseHandler=function(e){return e.text()},e.arrayBufferResponseHandler=function(e){return e.blob().then((function(e){return new _.Response(e).arrayBuffer()}))},e.getResponseHandler=function(t){switch(t){case ve.ArrayBuffer:return e.arrayBufferResponseHandler;case ve.Text:return e.textResponseHandler;default:return e.jsonResponseHandler}},e.convertFetchHeaders=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e.transformRequestBody=function(e){return se(e)?JSON.stringify(e,null,2):e},e.resolveUrl=function(e,t){return e.replace(/\/$/,"")+(("/"===t[0]?"":"/")+t).replace(/\/+$/,"")},e.prototype.setDefaultHeader=function(e,t){return this.defaultHeaders[e]=t,this},e.prototype.getDefaultHeaders=function(){return K({},this.defaultHeaders)},e.prototype.setBaseUrl=function(e){this.baseUrl=e},e.prototype.getBaseUrl=function(){return this.baseUrl},e.prototype.get=function(e,r){return void 0===r&&(r={}),this.request(K(K({},r),{path:e,method:t.HttpMethod.Get}))},e.prototype.post=function(e,r){return void 0===r&&(r={}),this.request(K(K({},r),{path:e,method:t.HttpMethod.Post}))},e.prototype.put=function(e,r){return void 0===r&&(r={}),this.request(K(K({},r),{path:e,method:t.HttpMethod.Put}))},e.prototype.delete=function(e,r){return void 0===r&&(r={}),this.request(K(K({},r),{path:e,method:t.HttpMethod.Delete}))},e.prototype.patch=function(e,r){return void 0===r&&(r={}),this.request(K(K({},r),{path:e,method:t.HttpMethod.Patch}))},e.prototype.preRequest=function(e){return F(this,void 0,void 0,(function(){var t;return j(this,(function(r){return t=this.populateDefaultHeaders(e.headers),[2,K(K({},e),{headers:t})]}))}))},e.prototype.postRequest=function(t,r,n){return F(this,void 0,void 0,(function(){return j(this,(function(r){return e.validateStatusCode(t.status)||e.throwCustomErrorResponse(t),[2,t]}))}))},e.prototype.populateDefaultHeaders=function(e){return void 0===e&&(e={}),K(K({},this.defaultHeaders),e)},e.prototype.rawRequest=function(t){return F(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g,y;return j(this,(function(v){switch(v.label){case 0:return r=this.constructUrl(t.path,t.params),n=function(e,t,r){void 0===e&&(e={});var n=function(e){var t=[];for(var r in e)t.push(r.toLowerCase());return t}(e),o=t.toLowerCase();n.includes(o)||(e[t]=r);return e}(t.headers,"Accept","application/json"),se(o=t.data)&&(o=e.transformRequestBody(o),n["Content-Type"]="application/json"),[4,w(r,{body:o,method:t.method,headers:n})];case 1:return i=v.sent(),s=e.getResponseHandler(t.responseType),a=i.clone(),[4,Promise.all([s(i).catch((function(){})),a.text()])];case 2:return c=G.apply(void 0,[v.sent(),2]),g=c[0],y=c[1],[2,{headers:e.convertFetchHeaders(i.headers),status:i.status,data:g||y}]}}))}))},e.prototype.request=function(e){return F(this,void 0,void 0,(function(){var t,r;return j(this,(function(n){switch(n.label){case 0:return[4,this.preRequest(e)];case 1:return t=n.sent(),[4,this.rawRequest(t)];case 2:return r=n.sent(),[2,this.postRequest(r,e,t)]}}))}))},e.prototype.constructUrl=function(t,r){void 0===r&&(r={});var n=t;return Object.keys(r).length>0&&(n+="?"+b.stringify(r)),null!==n.match(/^https?:\/\//i)?n:e.resolveUrl(this.baseUrl,n)},e}();(pe=t.HttpMethod||(t.HttpMethod={})).Get="GET",pe.Post="POST",pe.Put="PUT",pe.Delete="DELETE",pe.Patch="PATCH";var ve={Json:"json",ArrayBuffer:"arraybuffer",Text:"text"},_e=function(e){return void 0===e&&(e=5),function(t,r,n){if(n>=e)return!1;if(429===r.status)return!0;return!(-1===["GET","HEAD","OPTIONS","DELETE","PUT"].indexOf(t.method.toUpperCase()))&&we(r.status)}};function we(e){return E(e,100,200)||E(e,429,430)||E(e,500,600)}var be=function(e){function t(t,r){var n=e.call(this,t)||this;return n.retryValidator=r,n}return D(t,e),t.calculateRetryDelayInMs=function(e){return 250+(Math.pow(2,e)-1)/2*1e3},t.prototype.get=function(t,r){return void 0===r&&(r={}),e.prototype.get.call(this,t,r)},t.prototype.post=function(t,r){return void 0===r&&(r={}),e.prototype.post.call(this,t,r)},t.prototype.put=function(t,r){return void 0===r&&(r={}),e.prototype.put.call(this,t,r)},t.prototype.delete=function(t,r){return void 0===r&&(r={}),e.prototype.delete.call(this,t,r)},t.prototype.patch=function(t,r){return void 0===r&&(r={}),e.prototype.patch.call(this,t,r)},t.prototype.preRequest=function(t){return F(this,void 0,void 0,(function(){return j(this,(function(r){return[2,e.prototype.preRequest.call(this,t)]}))}))},t.prototype.postRequest=function(t,r,n){return F(this,void 0,void 0,(function(){return j(this,(function(o){return[2,e.prototype.postRequest.call(this,t,r,n)]}))}))},t.prototype.rawRequest=function(r){return F(this,void 0,void 0,(function(){var n,o,i;return j(this,(function(s){switch(s.label){case 0:n=0,s.label=1;case 1:return[4,e.prototype.rawRequest.call(this,r)];case 2:return o=s.sent(),i=y(r.retryValidator)?r.retryValidator:this.retryValidator,n<5&&!1!==r.retryValidator&&i(r,o,n)?[4,ae(t.calculateRetryDelayInMs(n))]:[2,o];case 3:return s.sent(),n++,[3,1];case 4:return[2]}}))}))},t.prototype.request=function(t){return F(this,void 0,void 0,(function(){return j(this,(function(r){return[2,e.prototype.request.call(this,t)]}))}))},t}(ye),Ee=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.oneTimeHeaders={},n.setBearerToken=function(e){n.setDefaultHeader(A,ee(e))},n.response401Handler=function(e,t,r,n){return n()},n}return D(t,e),t.serializeQueryParameters=function(e){return void 0===e&&(e={}),Object.keys(e).reduce((function(t,r){var n=e[r];return t[r]=se(n)?JSON.stringify(n):n,t}),{})},t.isSameOrigin=function(e,t){var r=v.parse(e),n=r.protocol,o=r.host,i=v.parse(v.resolve(e,t)),s=i.protocol,a=i.host;return n===s&&o===a},t.filterHeaders=function(e,r){return r.reduce((function(e,r){return t.filterHeader(e,r)}),e)},t.filterHeader=function(e,t){var r=K({},e);return delete r[t],r},t.prototype.addOneTimeHeader=function(e,t){return this.oneTimeHeaders[e]=t,this},t.prototype.set401ResponseHandler=function(e){this.response401Handler=e},t.prototype.preRequest=function(e){return F(this,void 0,void 0,(function(){var r,n,o,i;return j(this,(function(s){return r=this.populateDefaultHeaders(e.headers),n=e.withCredentials?r:this.preventTokenLeakage(r,e.path),o=e.data,i=t.serializeQueryParameters(e.params),[2,K(K({},e),{data:o,headers:n,params:i})]}))}))},t.prototype.request=function(t){return F(this,void 0,void 0,(function(){return j(this,(function(r){return t.headers=this.enrichWithOneTimeHeaders(t.headers),[2,e.prototype.request.call(this,t)]}))}))},t.prototype.postRequest=function(t,r,n){return F(this,void 0,void 0,(function(){var o,i=this;return j(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.prototype.postRequest.call(this,t,r,n)];case 1:return[2,s.sent()];case 2:if(401===(o=s.sent()).status&&!this.isLoginOrLogoutApi(r.path)&&!this.isTokenInspect(r.path))return[2,new Promise((function(e,t){i.response401Handler(o,n,(function(){return e(i.request(r))}),(function(){return t(o)}))}))];throw function(e){var t,r,n,o,i,s;try{t=e.status,r=e.data.error.duplicated,o=e.data.error.message,i=e.data.error.missing,n=e.data.error.extra,s=function(e,t){var r=t.toLowerCase();for(var n in e)if(n.toLowerCase()==r)return e[n]}(e.headers||{},U)}catch(a){throw e}throw new V(o,t,s,{duplicated:r,extra:n,missing:i})}(o);case 3:return[2]}}))}))},t.prototype.enrichWithOneTimeHeaders=function(e){var t=this.oneTimeHeaders;return this.oneTimeHeaders={},K(K({},e),t)},t.prototype.preventTokenLeakage=function(e,r){return t.isSameOrigin(this.baseUrl,r)?e:t.filterHeaders(e,[A,R,O,N])},t.prototype.isLoginOrLogoutApi=function(e){var t=e.toLowerCase();return-1!==t.indexOf("/logout/url")||-1!==t.indexOf("/login/status")},t.prototype.isTokenInspect=function(e){return-1!==e.toLowerCase().indexOf("/token/inspect")},t}(be),Ce=function(e){function t(t){var r=e.call(this,t||"Not able to login")||this;return Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=new Error(r.message).stack,r}return D(t,e),t}(Error),Se="cognite-js-sdk-auth-popup",Te="access_token",Ie="id_token",ke="error",Ae="error_description",Re=["appId","project"],Pe=[{method:"api",field:"apiKey"},{method:"client_credentials",field:"authority"},{method:"client_credentials",field:"client_id"},{method:"client_credentials",field:"client_secret"},{method:"client_credentials",field:"scope"},{method:"client_credentials",field:"grant_type"},{method:"device",field:"authority"},{method:"device",field:"client_id"},{method:"device",field:"scope"},{method:"implicit",field:"authority"},{method:"implicit",field:"client_id"},{method:"implicit",field:"scope"},{method:"pkce",field:"authority"},{method:"pkce",field:"client_id"},{method:"pkce",field:"scope"}];function Oe(){return window.name===Se}function Ne(e,t){return F(this,void 0,void 0,(function(){var r;return j(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e("/logout/url",{params:t})];case 1:return[2,n.sent().data.data.url];case 2:if(401===(r=n.sent()).status)return[2,null];throw r;case 3:return[2]}}))}))}function Ue(e){var t=b.parse(e),r=t[Te],n=t[Ie],o=t[ke],i=t[Ae];if(void 0!==o)throw Error(o+": "+i);return g(r)&&g(n)?{accessToken:r,idToken:n}:null}function Me(e){return new Promise((function(t,r){var n=function(e,t){return window.open(e,t,"height=500,width=400,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes")}(qe(e),Se);if(null!==n){var o=function(e){e.source===n&&(e.data&&!e.data.error?(window.removeEventListener("message",o),t(e.data)):r(new Ce))};window.addEventListener("message",o,!1)}else r(new Ce("Failed to create login popup window"))}))}function xe(e,t,r,n){return void 0===r&&(r="silentLoginIframe"),void 0===n&&(n="hash"),F(this,void 0,void 0,(function(){return j(this,(function(o){return[2,new Promise((function(o,i){var s=function(e,t){var r=document.createElement("iframe");return r.name=t,r.style.width="0",r.style.height="0",r.style.border="0",r.style.border="none",r.style.visibility="hidden",r.setAttribute("id",t),r.setAttribute("aria-hidden","true"),r.src=e,r}(e,r);s.onload=function(){try{var e=t(s.contentWindow.location[n]);if(null===e)throw Error("Failed to login silently");o(e)}catch(r){i(r)}finally{document.body.removeChild(s)}},document.body.appendChild(s)}))]}))}))}function qe(e){var t=e.project,r=e.baseUrl,n=e.redirectUrl,o={project:t,redirectUrl:n,errorRedirectUrl:e.errorRedirectUrl||n};return r+"/login/redirect?"+b.stringify(o)}var He="POPUP";function Le(e,t){return F(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return j(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),[4,e("/login/status",{headers:t})];case 1:return r=g.sent(),n=r.data.data,o=n.loggedIn,i=n.user,s=n.project,a=n.projectId,o?[2,{user:i,project:s,projectId:a}]:[2,null];case 2:if(401===(c=g.sent()).status)return[2,null];throw c;case 3:return[2]}}))}))}var De=function(){function e(e){var t=e.project,r=e.baseUrl;if(!g(t))throw Error("options.project is required and must be of type string");this.baseUrl=r||Q(r),this.httpClient=new Ee(this.baseUrl,_e()),this.project=t}return e.prototype.login=function(e){var t=this,r=e.onAuthenticate,n=r===He?Fe:y(r)?r:Ke;return new Promise((function(e,r){var o={skip:function(){e(null)},redirect:function(e){(function(e){return new Promise((function(){var t=qe(e);window.location.assign(t)}))})(K({baseUrl:t.baseUrl,project:t.project},e)).catch(r)},popup:function(n){return F(t,void 0,void 0,(function(){var t,o,i;return j(this,(function(s){switch(s.label){case 0:t=K({baseUrl:this.baseUrl,project:this.project},n),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Me(t)];case 2:return(o=s.sent())?(this.setTokens(o),e(o)):r(new Ce),[3,4];case 3:return i=s.sent(),r(i),[3,4];case 4:return[2]}}))}))}};n(o)}))},e.prototype.getCDFToken=function(){return F(this,void 0,void 0,(function(){var e,t,r;return j(this,(function(n){switch(n.label){case 0:return this.authTokens?(e=this.authTokens,t=e.accessToken,r=e.idToken,[4,je(this.httpClient,this.project,{accessToken:t,idToken:r})]):[3,2];case 1:if(n.sent())return[2,{accessToken:t,idToken:r}];n.label=2;case 2:return[2,null]}}))}))},e.prototype.handleLoginRedirect=function(){return F(this,void 0,void 0,(function(){var e,t;return j(this,(function(r){switch(r.label){case 0:return he()||re()&&"localhost"===location.hostname?(e=function(){try{var e=Ue(window.location.search);return ne(Te,Ie),e}catch(t){throw ne(ke,Ae),t}}(),(t=null!==e)?[4,je(this.httpClient,this.project,e)]:[3,2]):[2,null];case 1:t=r.sent(),r.label=2;case 2:return t?(ne(Te,Ie),this.setTokens(e),[2,e]):[2,null]}}))}))},e.prototype.setTokens=function(e){var t=e.accessToken,r=e.idToken;this.authTokens={accessToken:t,idToken:r}},e}();function Ke(e){e.redirect({redirectUrl:window.location.href})}function Fe(e){e.popup({redirectUrl:window.location.href})}function je(e,t,r){return F(this,void 0,void 0,(function(){var n;return j(this,(function(o){switch(o.label){case 0:return[4,Be(e,r.accessToken)];case 1:return[2,null!==(n=o.sent())&&(i=n.project,s=t,i.toLowerCase()===s.toLowerCase())]}var i,s}))}))}function Be(e,t){var r;return Le(e.get.bind(e),((r={})[A]=ee(t),r))}var Ge=function(e){function t(t,r){var n=e.call(this,"",t,r)||this;return n.status=function(){return Le(n.get,{})},n}return D(t,e),t}(ge),We=function(e){function t(t,r){var n=e.call(this,"",t,r)||this;return n.getUrl=function(e){return void 0===e&&(e={}),Ne(n.get,e)},n}return D(t,e),t}(ge),ze=function(){function e(){this.map=new WeakMap}return e.prototype.addAndReturn=function(e,t){return this.map.set(e,{status:t.status,headers:t.headers}),e},e.prototype.get=function(e){return this.map.get(e)},e}(),Ye=function(){function e(e,t,r){var n=this;this.httpClient=e,this.credentials=t,this.authProvider=r,this.tokenCredentials={},this.authenticate=function(){return F(n,void 0,void 0,(function(){var e,t,r,n,o;return j(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),this.credentials?"api"===this.credentials.method?(e=this.credentials.apiKey,this.httpClient.setDefaultHeader(R,e),[2,e]):(this.tokenCredentials.refresh_token&&(this.tokenCredentials.access_token=""),this.credentials.authContext?[3,2]:(t=this,[4,this.authProvider.load(this.credentials.method,this.credentials).login(this.isRefreshToken())])):[2];case 1:return t.tokenCredentials=i.sent(),[3,4];case 2:return r=this,[4,this.authProvider.load(this.credentials.method,this.credentials.authContext).login(this.isRefreshToken())];case 3:r.tokenCredentials=i.sent(),i.label=4;case 4:return n=void 0,void 0!==this.tokenCredentials.access_token&&""!==this.tokenCredentials.access_token&&(n=this.tokenCredentials.access_token,this.httpClient.setDefaultHeader(A,ee(n))),[2,n];case 5:return o=i.sent(),console.error("An error ocurred while attempting to authenticate",o),[2];case 6:return[2]}}))}))},this.process()}return e.prototype.process=function(){var e;if(this.credentials&&(this.authProvider&&y(this.authProvider.requires)?this.authProvider.requires(this.credentials):function(e){if(!i(e))throw Error("options.credentials is required");if(!e.method)throw Error("options.credentials.method is required and must be of type string with one of this values: api, client_credentials, device, implicit, pkce");for(var t=0;t<Pe.length;t++){var r=Pe[t];if(e.method&&e.method===r.method&&!e[r.field])throw Error("options.credentials."+r.field+" is required and must be of type string")}}(this.credentials),"api"!==(null===(e=this.credentials)||void 0===e?void 0:e.method)&&!this.authProvider))throw Error("options.authentication.authProvider is required and must be a class that implements a static load method and can call a login method.");if(this.authProvider&&!y(this.authProvider.load))throw Error("The authProvider needs to have a load method.");if(this.authProvider&&!y(this.authProvider.load().login))throw Error("The authProvider load method needs to be able to call call a login method.");if(void 0!==this.authProvider&&this.credentials){if(!(this.credentials.authContext||this.authProvider.load(!0,!0).method||this.authProvider.load(!0,!0).settings))throw Error("Please, use the recommended authProvider: @cognite/auth-wrapper");if(this.credentials.authContext&&!this.authProvider.load(!0,!0).method&&!this.authProvider.load(!0,!0).authContext)throw Error("Please, use the recommended authProvider: @cognite/react-auth-wrapper")}},e.prototype.isRefreshToken=function(){var e,t;return("device"===(null===(e=this.credentials)||void 0===e?void 0:e.method)||"pkce"===(null===(t=this.credentials)||void 0===t?void 0:t.method))&&this.tokenCredentials.refresh_token},e.prototype.isApiKeyMode=function(){var e;return"api"===(null===(e=this.credentials)||void 0===e?void 0:e.method)},e}();var Ve=function(){function e(e,t){var r,n=this;if(void 0===t&&(t="v1"),this.authenticate=function(){return F(n,void 0,void 0,(function(){var e,t;return j(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.authenticateGetToken()];case 1:return void 0!==(e=r.sent())?[2,e]:[4,null===(t=this.credentialsAuth)||void 0===t?void 0:t.authenticate()];case 2:return[2,e=r.sent()];case 3:return r.sent(),[2];case 4:return[2]}}))}))},this.authenticateGetToken=function(){return F(n,void 0,void 0,(function(){var e,t;return j(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.tokenPromise&&!this.isTokenPromiseFulfilled||(this.isTokenPromiseFulfilled=!1,this.tokenPromise=this.getToken()),[4,this.tokenPromise];case 1:return e=r.sent(),this.isTokenPromiseFulfilled=!0,void 0===e||this.noAuthMode?[2,e]:this.apiKeyMode?(this.httpClient.setDefaultHeader(R,e),[2,e]):(t=ee(e),this.httpClient.setDefaultHeader(A,t),[2,e]);case 2:return r.sent(),[2];case 3:return[2]}}))}))},this.getMetadata=function(e){return n.metadataMap.get(e)},this.get=function(e,t){return n.httpClient.get(e,t)},this.put=function(e,t){return n.httpClient.put(e,t)},this.post=function(e,t){return n.httpClient.post(e,t)},this.delete=function(e,t){return n.httpClient.delete(e,t)},this.patch=function(e,t){return n.httpClient.patch(e,t)},this.apiFactory=function(e,t){return new e(n.projectUrl+"/"+t,n.httpClient,n.metadataMap)},function(e){if(!i(e))throw Error("`CogniteClient` is missing parameter `options`");for(var t=0;t<Re.length;t++){var r=Re[t];if(!g(e[r]))throw Error("options."+r+" is required and must be of type string")}}(e),e&&!(null===(r=e.authentication)||void 0===r?void 0:r.credentials)&&!e.getToken&&!e.noAuthMode)throw Error("options.authentication.credentials is required or options.getToken is request and must be of type () => Promise<string>");var o=e.baseUrl;if(this.http=this.initializeCDFHttpClient(o,e),e.authentication){var s=e.authentication,a=s.credentials,c=s.provider;this.credentialsAuth=new Ye(this.httpClient,a,c)}!re()||he()||e.noAuthMode||console.warn("You should use SSL (https) when you login with OAuth since CDF only allows redirecting back to an HTTPS site"),this.metadata=new ze,this.loginApi=new Ge(this.httpClient,this.metadataMap),this.logoutApi=new We(this.httpClient,this.metadataMap),this.apiVersion=t,this.project=e.project,this.apiKeyMode=!!e.apiKeyMode,this.noAuthMode=!!e.noAuthMode,this.getToken=function(){return F(n,void 0,void 0,(function(){return j(this,(function(t){return[2,e.getToken?e.getToken():void 0]}))}))},this.initAPIs()}return Object.defineProperty(e.prototype,"login",{get:function(){return this.loginApi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logout",{get:function(){return this.logoutApi},enumerable:!1,configurable:!0}),e.prototype.initializeCDFHttpClient=function(e,t){var r=this,n=new Ee(Q(e),this.getRetryValidator());return n.setDefaultHeader(O,t.appId).setDefaultHeader(N,"CogniteJavaScriptSDK:"+this.version),n.set401ResponseHandler((function(e,t,n,o){return F(r,void 0,void 0,(function(){var e,r,i,s;return j(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),e=this.retrieveTokenValueFromHeader(t.headers),[4,this.tokenPromise];case 1:return(r=a.sent())===e?[3,2]:(s=r,[3,4]);case 2:return[4,this.authenticate()];case 3:s=a.sent(),a.label=4;case 4:return(i=s)&&i!==e?n():o(),[3,6];case 5:return a.sent(),o(),[3,6];case 6:return[2]}}))}))})),n},e.prototype.retrieveTokenValueFromHeader=function(e){var t;return void 0!==(t=this.apiKeyMode?null==e?void 0:e[R]:null==e?void 0:e[A])?t.replace("Bearer ",""):t},e.prototype.getBaseUrl=function(){return this.httpClient.getBaseUrl()},e.prototype.getDefaultRequestHeaders=function(){return K({},this.httpClient.getDefaultHeaders())},e.prototype.initAPIs=function(){},e.prototype.getRetryValidator=function(){return _e()},Object.defineProperty(e.prototype,"version",{get:function(){return"4.8.2-core"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectUrl",{get:function(){return function(e,t){return void 0===t&&(t="v1"),$(t)+"/projects/"+encodeURIComponent(e)}(this.project,this.apiVersion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadataMap",{get:function(){return this.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this.http},enumerable:!1,configurable:!0}),e}(),Je="TEST_PROJECT",Xe="user@example.com",Ze={data:{loggedIn:!0,user:Xe,project:Je,projectId:123}},Qe="https://example.com";function $e(e){return void 0===e&&(e=k),new Ve({appId:"JS SDK integration tests",project:"",apiKeyMode:!0,getToken:function(){return Promise.resolve({COGNITE_PROJECT:""}.COGNITE_CREDENTIALS)},baseUrl:e})}var et=function(e,t){return e-t};var tt=Object.freeze({__proto__:null,apiKey:"TEST_KEY",project:Je,projectId:123,user:Xe,loggedInResponse:Ze,notLoggedInResponse:{data:{loggedIn:!1,user:"",project:""}},mockBaseUrl:Qe,authTokens:{accessToken:"abc",idToken:"def"},setupClient:$e,setupLoggedInClient:function(){return jest.setTimeout(6e4),$e()},setupMockableClient:function(){return $e(Qe)},retryInSeconds:function(e,t,r,n){return void 0===t&&(t=3),void 0===r&&(r=404),void 0===n&&(n=300),F(this,void 0,void 0,(function(){var o,i;return j(this,(function(s){switch(s.label){case 0:o=Date.now(),s.label=1;case 1:if(!(Date.now()-o<1e3*n))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,e()];case 3:return[2,s.sent()];case 4:if(i=s.sent(),Number(i.status)!==r)throw i;return[4,ae(1e3*t)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:throw new Error("Time limit has been exceeded")}}))}))},runTestWithRetryWhenFailing:function(e){return F(this,void 0,void 0,(function(){var t,r,n,o,i,s;return j(this,(function(a){switch(a.label){case 0:jest.setTimeout(18e4),t=15,r=2,n=500,o=0,a.label=1;case 1:return a.trys.push([1,3,,5]),[4,e()];case 2:return a.sent(),[2];case 3:return s=a.sent(),i=s,[4,ae(n)];case 4:return a.sent(),n*=r,o++,[3,5];case 5:if(o<t)return[3,1];a.label=6;case 6:throw i}}))}))},simpleCompare:et,getSortedPropInArray:function(e,t){return e.map((function(e){return e[t]})).sort(et)},string2arrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,o=e.length;n<o;n++)r[n]=e.charCodeAt(n);return t},randomInt:function(){return Math.floor(1e10*Math.random())}}),rt={clientId:"client_id",scope:"scope",redirectUri:"redirect_uri",responseMode:"response_mode",responseType:"response_type",resource:"resource"},nt="access_token",ot="id_token",it="expires_in",st=function(){function e(e){var t=e.authority,r=e.requestParams;this.token=null,this.authority=t,this.queryParams=this.getADFSQueryParams(r),this.sessionKey=t+"_"+r.clientId+"_"+r.resource}return e.prototype.login=function(){return F(this,void 0,void 0,(function(){var e,t=this;return j(this,(function(r){switch(r.label){case 0:return[4,this.acquireTokenSilently()];case 1:return e=r.sent(),[2,new Promise((function(r){e&&r(e.accessToken);var n=t.authority+"?"+t.getADFSQueryParamString(t.queryParams);window.location.href=n}))]}}))}))},e.prototype.handleLoginRedirect=function(){try{var e=window.location.hash;if(!e)return null;var t=at(e);return ne(nt,ot,it,"scope","token_type"),this.setToken(t),t}catch(r){console.error(r)}return null},e.prototype.getCDFToken=function(){return F(this,void 0,void 0,(function(){var e;return j(this,(function(t){switch(t.label){case 0:return[4,this.acquireTokenSilently()];case 1:return[2,(e=t.sent())?e.accessToken:this.token?this.token.accessToken:null]}}))}))},e.prototype.getIdToken=function(){return F(this,void 0,void 0,(function(){var e;return j(this,(function(t){switch(t.label){case 0:return[4,this.acquireTokenSilently()];case 1:return[2,(e=t.sent())?e.idToken:this.token?this.token.idToken:null]}}))}))},e.prototype.acquireTokenSilently=function(){return F(this,void 0,void 0,(function(){var e,t;return j(this,(function(r){switch(r.label){case 0:if(e=this.getToken())return[2,e];t=this.authority+"?prompt=none&"+this.getADFSQueryParamString(this.queryParams),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,xe(t,at,"adfsSilentLoginIframe")];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),T(),[3,4];case 4:return e&&this.setToken(e),[2,e]}}))}))},e.prototype.getADFSQueryParams=function(e){var t=e.resource,r={clientId:e.clientId,scope:"user_impersonation IDENTITY",responseMode:"fragment",responseType:"id_token token",resource:t,redirectUri:window.location.href};return Object.entries(r).reduce((function(e,t){var r=G(t,2),n=r[0],o=r[1];return e[rt[n]]=o,e}),{})},e.prototype.getADFSQueryParamString=function(e){return Object.entries(e).reduce((function(e,t){var r=G(t,2),n=r[0],o=r[1];return e+(e.length>1?"&":"")+n+"="+o}),"")},e.prototype.setToken=function(e){this.token=e,e?sessionStorage.setItem(this.sessionKey,JSON.stringify(e)):sessionStorage.removeItem(this.sessionKey)},e.prototype.getToken=function(){var e=sessionStorage.getItem(this.sessionKey);if(!e)return null;try{var t=JSON.parse(e);if(t.expiresIn<=Date.now())throw new Error("token expired "+t.expiresIn);return t}catch(r){return console.error(r),sessionStorage.removeItem(this.sessionKey),null}},e}();function at(e){var t=b.parse(e),r=t[nt],n=t[ot],o=t[it];return g(r)&&g(n)?{accessToken:r,idToken:n,expiresIn:Date.now()+1e3*Number(o)}:null}var ct=function(e){var t=this;this.sortFunction=e,this.originalIndexMap=new Map,this.sort=function(e){return t.originalIndexMap=new Map,t.originalArray=e,e.forEach((function(e,r){t.originalIndexMap.set(e,r)})),t.sortedArray=t.sortFunction(e),t.sortedArray},this.unsort=function(e){if(!t.originalArray||!t.sortedArray)throw Error("Impossible to unsort. Call sort(...) first.");if(e.length!==t.originalArray.length)throw Error("Impossible to unsort. Input array has a different length from original.");var r=[];return t.sortedArray.forEach((function(n,o){var i=t.originalIndexMap.get(n);r[i]=e[o]})),r}};t.ADFS=st,t.BaseCogniteClient=Ve,t.BaseResourceAPI=ge,t.BasicHttpClient=ye,t.CDFHttpClient=Ee,t.CogniteAuthentication=De,t.CogniteError=V,t.CogniteLoginError=Ce,t.CogniteMultiError=X,t.Constants=M,t.DateParser=fe,t.GraphUtils=H,t.HttpError=me,t.HttpResponseType=ve,t.MetadataMap=ze,t.POPUP=He,t.REDIRECT="REDIRECT",t.RetryableHttpClient=be,t.RevertableArraySorter=ct,t.TestUtils=tt,t.accessApi=function(e){if(void 0===e)throw Error("API not found");return e},t.apiUrl=$,t.createRetryValidator=function(e,t){void 0===t&&(t=5);var r=_e(t);return function(n,o,i){if(i>=t)return!1;if(!we(o.status))return!1;if(r(n,o,i))return!0;var s=e[n.method]||[];return!!function(e,t){return S(t,(function(t){return function(e,t){return-1!==e.toUpperCase().indexOf(t.toUpperCase())}(e,t)}))}(n.path,s)}},t.createUniversalRetryValidator=_e,t.getIdInfo=Le,t.getLogoutUrl=Ne,t.isLoginPopupWindow=Oe,t.loginPopupHandler=function(){if(Oe())try{var e=Ue(window.location.search);window.opener.postMessage(e)}catch(t){window.opener.postMessage({error:t.message})}finally{window.close()}},t.promiseAllAtOnce=ce,t.promiseAllWithData=ue,t.promiseEachInSequence=le,t.sleepPromise=ae},511:(e,t,r)=>{"use strict";var n=r(2889),o=r(4516),i=r(1133);function s(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"==typeof e?a(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function c(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function g(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return function(e,r,n){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=o({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),o=t.shift(),s=t.length>0?t.join("="):void 0;s=void 0===s?null:i(s),r(i(o),s,n)})),Object.keys(n).sort().reduce((function(e,t){var r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=a(r):e[t]=r,e}),Object.create(null))):n}t.extract=c,t.parse=g,t.stringify=function(e,t){!1===(t=o({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var r=function(e){switch(e.arrayFormat){case"index":return function(t,r,n){return null===r?[s(t,e),"[",n,"]"].join(""):[s(t,e),"[",s(n,e),"]=",s(r,e)].join("")};case"bracket":return function(t,r){return null===r?s(t,e):[s(t,e),"[]=",s(r,e)].join("")};default:return function(t,r){return null===r?s(t,e):[s(t,e),"=",s(r,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(n){var o=e[n];if(void 0===o)return"";if(null===o)return s(n,t);if(Array.isArray(o)){var i=[];return o.slice().forEach((function(e){void 0!==e&&i.push(r(n,e,i.length))})),i.join("&")}return s(n,t)+"="+s(o,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:g(c(e),t)}}},2889:e=>{"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},1054:(e,t,r)=>{"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var o=r(9675),i=n(r(5161)),s=n(r(6334)),a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},a(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var g=function(){return g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)};function y(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function v(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(t){i(t)}}function a(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function _(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function w(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.list=function(r,n,o){var i=t.encodeUrl(r,n);return e.prototype.listEndpoint.call(t,(function(e){return t.get(i,{params:e})}),o)},t.filter=function(r,n,o){var i=t.encodeUrl(r,n)+"/list";return e.prototype.listEndpoint.call(t,(function(e){return t.post(i,{data:e})}),o)},t.create=function(r,n,o){var i=t.encodeUrl(r,n);return e.prototype.createEndpoint.call(t,o,i)},t.delete=function(r,n,o){var i=t.encodeUrl(r,n)+"/delete";return e.prototype.deleteEndpoint.call(t,o,void 0,i)},t}return c(t,e),t.prototype.encodeUrl=function(e,t){return this.url(e+"/revisions/"+t+"/mappings")},t}(o.BaseResourceAPI),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url(""+e),[4,this.get(t,{responseType:o.HttpResponseType.ArrayBuffer})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}return c(t,e),t}(o.BaseResourceAPI),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithGet,r)},t.retrieve=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url(""+e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(r,n,o){var i=t.url(r+"/revisions/"+n+"/nodes/byids");return e.prototype.retrieveEndpoint.call(t,o,{},i)},t}return c(t,e),t.prototype.list=function(t,r,n){var o=this,i=this.url(t+"/revisions/"+r+"/nodes");return e.prototype.listEndpoint.call(this,(function(e){return o.get(i,{params:e})}),n)},t.prototype.filter=function(t,r,n){var o=this,i=this.url(t+"/revisions/"+r+"/nodes/list");return e.prototype.listEndpoint.call(this,(function(e){return o.post(i,{data:e})}),n)},t.prototype.listAncestors=function(t,r,n,o){var i=this,s=this.url(t+"/revisions/"+r+"/nodes/"+n+"/ancestors");return e.prototype.listEndpoint.call(this,(function(e){return i.get(s,{params:e})}),o)},t}(o.BaseResourceAPI),k=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.create=function(t,r){return e.prototype.createEndpoint.call(o,r,o.url(t+"/revisions"))},o.list=function(t,r){var n=o.url(t+"/revisions");return e.prototype.listEndpoint.call(o,(function(e){return o.get(n,{params:e})}),r)},o.retrieve=function(e,t){return v(o,void 0,void 0,(function(){var r,n;return _(this,(function(o){switch(o.label){case 0:return r=this.url(e+"/revisions/"+t),[4,this.get(r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},o.update=function(t,r){var n=o.url(t+"/revisions/update");return e.prototype.updateEndpoint.call(o,r,n)},o.delete=function(t,r){var n=o.url(t+"/revisions/delete");return e.prototype.deleteEndpoint.call(o,r,void 0,n)},o.updateThumbnail=function(e,t,r){return v(o,void 0,void 0,(function(){var n,o;return _(this,(function(i){switch(i.label){case 0:return n=this.url(e+"/revisions/"+t+"/thumbnail"),[4,this.post(n,{data:{fileId:r}})];case 1:return o=i.sent(),[2,this.addToMapAndReturn({},o)]}}))}))},o.list3DNodes=function(e,t,r){return o.nodes3DApi.list(e,t,r)},o.filter3DNodes=function(e,t,r){return o.nodes3DApi.filter(e,t,r)},o.retrieve3DNodes=function(e,t,r){return o.nodes3DApi.retrieve(e,t,r)},o.list3DNodeAncestors=function(e,t,r,n){return o.nodes3DApi.listAncestors(e,t,r,n)},o.nodes3DApi=new I(t,r,n),o}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.list=function(t,r,n){var o=this,i=this.encodeUrl(t,r);return e.prototype.listEndpoint.call(this,(function(e){return o.get(i,{params:e})}),n)},t.prototype.listAncestors=function(t,r,n,o){var i=this,s=this.encodeUrl(t,r)+"/"+n+"/ancestors";return e.prototype.listEndpoint.call(this,(function(e){return i.get(s,{params:e})}),o)},t.prototype.encodeUrl=function(e,t){return this.url("models/"+e+"/revisions/"+t+"/nodes")},t}(o.BaseResourceAPI),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t.prototype.retrieve=function(e,t){return v(this,void 0,void 0,(function(){var r,n;return _(this,(function(o){switch(o.label){case 0:return r=this.url("models/"+e+"/revisions/"+t),[4,this.get(r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}(o.BaseResourceAPI),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.list=function(t,r,n){var o=this,i=this.url("models/"+t+"/revisions/"+r+"/sectors");return e.prototype.listEndpoint.call(this,(function(e){return o.get(i,{params:e})}),n)},t}(o.BaseResourceAPI),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t.prototype.retrieve=function(e,t){return v(this,void 0,void 0,(function(){var r,n;return _(this,(function(o){switch(o.label){case 0:return r=this.url("models/"+e+"/revisions/"+t),[4,this.get(r)];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}(o.BaseResourceAPI),U=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;o.retrieveRevealRevision3D=function(e,t){return o.revealRevisions3DAPI.retrieve(e,t)},o.listRevealNodes3D=function(e,t,r){return o.revealNodes3DAPI.list(e,t,r)},o.listRevealNode3DAncestors=function(e,t,r,n){return o.revealNodes3DAPI.listAncestors(e,t,r,n)},o.listRevealSectors3D=function(e,t,r){return o.revealSectors3DAPI.list(e,t,r)},o.retrieveUnrealRevision3D=function(e,t){return o.unrealRevisions3DAPI.retrieve(e,t)};var i=t+"/reveal",s=t+"/unreal";return o.revealRevisions3DAPI=new R(i,r,n),o.revealNodes3DAPI=new A(i,r,n),o.revealSectors3DAPI=new O(i,r,n),o.unrealRevisions3DAPI=new N(s,r,n),o}return c(t,e),t}(o.BaseResourceAPI),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.get(t,{params:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI);function q(e){var t=function(e){var t=new Map,r=e.map((function(e){return{data:e}}));return r.forEach((function(e){var r=e.data.externalId;r&&t.set(r,e)})),r.forEach((function(e){var r=e.data.parentExternalId;r&&t.has(r)&&(e.parentNode=t.get(r))})),r}(e);return o.GraphUtils.topologicalSort(t).map((function(e){return e.data}))}var H,L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){var n=new o.RevertableArraySorter(q),i=n.sort,s=n.unsort;return e.prototype.createEndpoint.call(t,r,void 0,i,s)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.aggregate=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.retrieve=function(r,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(t,r,n)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.search=function(r){return e.prototype.searchEndpoint.call(t,r)},t.delete=function(r,n){void 0===n&&(n={});var o=g(g({},n),{ignoreUnknownIds:!0});return e.prototype.deleteEndpoint.call(t,r,o)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.insert=function(e){return t.insertEndpoint(e)},t.retrieve=function(e){return t.retrieveDatapointsEndpoint(e)},t.retrieveLatest=function(e,r){return void 0===r&&(r={}),t.retrieveLatestEndpoint(e,r)},t.delete=function(e){return t.deleteDatapointsEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","datapoints"],["timestamp"])},t.prototype.insertEndpoint=function(e){return v(this,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.postInParallelWithAutomaticChunking({path:t,items:e})];case 1:return r.sent(),[2,{}]}}))}))},t.prototype.retrieveDatapointsEndpoint=function(e){return v(this,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.listPostUrl,[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.prototype.retrieveLatestEndpoint=function(e,t){return v(this,void 0,void 0,(function(){var r,n;return _(this,(function(o){switch(o.label){case 0:return r=this.url("latest"),[4,this.post(r,{data:g({items:e},t)})];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data.items,n)]}}))}))},t.prototype.deleteDatapointsEndpoint=function(e){return v(this,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.postInParallelWithAutomaticChunking({chunkSize:1e4,items:e,path:this.deleteUrl})];case 1:return t.sent(),[2,{}]}}))}))},t}(o.BaseResourceAPI),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.aggregate=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.retrieve=function(r){return e.prototype.retrieveEndpoint.call(t,r)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.documentAsPdf=function(e){return t.pdfPreviewEndpoint(e)},t.documentAsImage=function(e,r){return t.imagePreviewEndpoint(e,r)},t.pdfTemporaryLink=function(e){return t.pdfTemporaryLinkEndpoint(e)},t.pdfBuildPreviewURI=function(e){return""+t.url()+e.toString()+"/preview/pdf"},t.imageBuildPreviewURI=function(e,r){return void 0===r&&(r=1),""+t.url()+e.toString()+"/preview/image/pages/"+r.toString()},t.pdfBuildTemporaryLinkURI=function(e){return""+t.url()+e.toString()+"/preview/pdf/temporarylink"},t}return c(t,e),t.prototype.pdfPreviewEndpoint=function(e){return v(this,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return t=this.pdfBuildPreviewURI(e),[4,this.get(t,{responseType:o.HttpResponseType.ArrayBuffer,headers:{Accept:"application/pdf"}})];case 1:return[2,r.sent().data]}}))}))},t.prototype.imagePreviewEndpoint=function(e,t){return void 0===t&&(t=1),v(this,void 0,void 0,(function(){var r;return _(this,(function(n){switch(n.label){case 0:return r=this.imageBuildPreviewURI(e,t),[4,this.get(r,{responseType:o.HttpResponseType.ArrayBuffer,headers:{Accept:"image/png"}})];case 1:return[2,n.sent().data]}}))}))},t.prototype.pdfTemporaryLinkEndpoint=function(e){return v(this,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return t=this.pdfBuildTemporaryLinkURI(e),[4,this.get(t)];case 1:return[2,r.sent().data]}}))}))},t}(o.BaseResourceAPI),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=function(e){return t.aggregate(g(g({},e),{aggregate:"count"})).then((function(e){return e[0].count}))},t.uniqueValues=function(e){return t.aggregate(g(g({},e),{aggregate:"uniqueValues"}))},t.allUniqueValues=function(e){return t.cursorBasedEndpoint(t.callAggregateCursorEndpointWithPost,g(g({},e),{aggregate:"allUniqueValues"}))},t.callAggregateCursorEndpointWithPost=function(e){return v(t,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.post(this.url(),{data:e})];case 1:return[2,t.sent()]}}))}))},t}return c(t,e),t.prototype.aggregate=function(e){return v(this,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return[4,this.post(this.url(),{data:e})];case 1:return t=r.sent(),[2,this.addToMapAndReturn(t.data.items,t)]}}))}))},t}(o.BaseResourceAPI),G=function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,b(t))||this;n.search=function(e){return n.searchDocuments(e)},n.list=function(e){return n.listEndpoint(n.callListEndpointWithPost,e)},n.content=function(e){return n.documentContent(e)};var o=w(t,3),i=o[0],s=o[1],a=o[2];return n.previewAPI=new F(i,s,a),n.aggregateAPI=new j(i+"/aggregate",s,a),n}return c(t,e),Object.defineProperty(t.prototype,"preview",{get:function(){return this.previewAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"aggregate",{get:function(){return this.aggregateAPI},enumerable:!1,configurable:!0}),t.prototype.searchDocuments=function(e){return v(this,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return[4,this.post(this.searchUrl,{data:e})];case 1:return t=r.sent(),[2,this.addToMapAndReturn(t.data,t)]}}))}))},t.prototype.documentContent=function(e){return v(this,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.get(this.url(e+"/content"),{headers:{accept:"text/plain"}})];case 1:return[2,t.sent().data]}}))}))},t}(o.BaseResourceAPI),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.retrieve=function(r){return e.prototype.retrieveEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.delete=function(r){return v(t,void 0,void 0,(function(){return _(this,(function(t){return[2,e.prototype.deleteEndpoint.call(this,r)]}))}))},t.predict=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url("predict"),[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.predictResult=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url("jobs/"+e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.refit=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url("refit"),[4,this.post(t,{data:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","startTime","statusTime"])},t}(o.BaseResourceAPI),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.uniqueValues=function(r){return e.prototype.aggregateEndpoint.call(t,g(g({},r),{aggregate:"uniqueValues"}))},t}return c(t,e),t}(o.BaseResourceAPI),V=function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,b(t))||this;return n.create=function(t){return e.prototype.createEndpoint.call(n,t)},n.list=function(t){var r=t||{},o=r.sort,i=void 0===o?{}:o,s=y(r,["sort"]),a=g({sort:n.convertSortObjectToArray(i)},s);return e.prototype.listEndpoint.call(n,n.callListEndpointWithPost,a)},n.retrieve=function(t,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(n,t,r)},n.update=function(t){return e.prototype.updateEndpoint.call(n,t)},n.search=function(t){return e.prototype.searchEndpoint.call(n,t)},n.delete=function(t){return e.prototype.deleteEndpoint.call(n,t)},n.aggregateAPI=new(Y.bind.apply(Y,b([void 0],t))),n}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},Object.defineProperty(t.prototype,"aggregate",{get:function(){return this.aggregateAPI},enumerable:!1,configurable:!0}),t.prototype.convertSortObjectToArray=function(e){return Object.entries(e).map((function(e){var t=w(e,2);return t[0]+":"+t[1]}))},t}(o.BaseResourceAPI),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upload=function(e,r,n,o){return void 0===n&&(n=!1),void 0===o&&(o=!1),t.uploadEndpoint(e,r,n,o)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.aggregate=function(r){return e.prototype.aggregateEndpoint.call(t,r)},t.retrieve=function(r,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(t,r,n)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r)},t.search=function(r){return e.prototype.searchEndpoint.call(t,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t.getDownloadUrls=function(e){return t.getDownloadUrlsEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime","sourceCreatedTime","sourceModifiedTime","uploadedTime"])},t.prototype.uploadEndpoint=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),v(this,void 0,void 0,(function(){var o,i,s,a,c;return _(this,(function(g){switch(g.label){case 0:if(!(null!=t)&&n)throw Error("Don't set waitUntilAcknowledged to true when you are not uploading a file");return o={overwrite:r},i=this.url(),[4,this.post(i,{params:o,data:e})];case 1:return s=g.sent(),a=s.data,null==t?[3,3]:[4,this.uploadFile(a.uploadUrl,t,e.mimeType)];case 2:g.sent(),g.label=3;case 3:return n?[4,this.waitUntilFileIsUploaded(a.id)]:[3,5];case 4:return c=g.sent(),[2,this.addToMapAndReturn(c,s)];case 5:return[2,this.addToMapAndReturn(a,s)]}}))}))},t.prototype.uploadFile=function(e,t,r){var n={"Content-Type":r||"application/octet-stream"};return this.put(e,{headers:n,data:t})},t.prototype.waitUntilFileIsUploaded=function(e){return v(this,void 0,void 0,(function(){var t,r,n,i,s;return _(this,(function(a){switch(a.label){case 0:t=10,r=500,n=0,a.label=1;case 1:return[4,this.retrieve([{id:e}])];case 2:return i=w.apply(void 0,[a.sent(),1]),(s=i[0]).uploaded?[2,s]:(n++,[4,o.sleepPromise(r)]);case 3:a.sent(),a.label=4;case 4:if(n<t)return[3,1];a.label=5;case 5:throw Error("File never marked as 'uploaded'")}}))}))},t.prototype.getDownloadUrlsEndpoint=function(e){return v(this,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url("downloadlink"),[4,this.post(t,{data:{items:e}})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t}(o.BaseResourceAPI),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.url(),[4,this.get(t,{params:e})];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t.listServiceAccounts=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.encodeServiceAccountUrl(e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data.items,r)]}}))}))},t.addServiceAccounts=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return _(this,(function(o){switch(o.label){case 0:return t=this.encodeServiceAccountUrl(e),[4,this.post(t,{data:{items:r}})];case 1:return n=o.sent(),[2,this.addToMapAndReturn({},n)]}}))}))},t.removeServiceAccounts=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return _(this,(function(o){switch(o.label){case 0:return t=this.encodeServiceAccountUrl(e)+"/remove",[4,this.post(t,{data:{items:r}})];case 1:return n=o.sent(),[2,this.addToMapAndReturn({},n)]}}))}))},t.encodeServiceAccountUrl=function(e){return t.url(e+"/serviceaccounts")},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["deletedTime"])},t}(o.BaseResourceAPI),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime"])},t}(o.BaseResourceAPI),$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retrieve=function(e){return v(t,void 0,void 0,(function(){var t,r;return _(this,(function(n){switch(n.label){case 0:return t=this.encodeUrl(e),[4,this.get(t)];case 1:return r=n.sent(),[2,this.addToMapAndReturn(r.data,r)]}}))}))},t.update=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return _(this,(function(o){switch(o.label){case 0:return t=this.encodeUrl(e),[4,this.put(t,{data:r})];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t.updateProject=function(e,r){return v(t,void 0,void 0,(function(){var t,n;return _(this,(function(o){switch(o.label){case 0:return t=this.encodeUrl(e)+"/update",[4,this.post(t,{data:r})];case 1:return n=o.sent(),[2,this.addToMapAndReturn(n.data,n)]}}))}))},t}return c(t,e),t.prototype.encodeUrl=function(e){return this.url("projects/"+encodeURIComponent(e))},t}(o.BaseResourceAPI),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["lastUpdatedTime"])},t.prototype.insert=function(e,t,r,n){return void 0===n&&(n=!1),v(this,void 0,void 0,(function(){var o;return _(this,(function(i){switch(i.label){case 0:return o=this.encodeUrl(e,t)+"/rows",[4,this.postInParallelWithAutomaticChunking({path:o,items:r,chunkSize:5e3,queryParams:{ensureParent:n}})];case 1:return i.sent(),[2,{}]}}))}))},t.prototype.list=function(t,r,n){var o=this;void 0===n&&(n={});var i=n.onlyRowKeys,s=n.columns,a=y(n,["onlyRowKeys","columns"]);i&&(a.columns=","),s&&(a.columns=s.join(","));var c=this.encodeUrl(t,r)+"/rows";return e.prototype.listEndpoint.call(this,(function(e){return v(o,void 0,void 0,(function(){return _(this,(function(t){return[2,this.get(c,{params:e})]}))}))}),a)},t.prototype.retrieve=function(e,t,r){return v(this,void 0,void 0,(function(){var n,o;return _(this,(function(i){switch(i.label){case 0:return n=this.encodeUrl(e,t)+"/rows/"+encodeURIComponent(r),[4,this.get(n)];case 1:return o=i.sent(),[2,this.addToMapAndReturn(o.data,o)]}}))}))},t.prototype.delete=function(e,t,r){return v(this,void 0,void 0,(function(){var n;return _(this,(function(o){switch(o.label){case 0:return n=this.encodeUrl(e,t)+"/rows/delete",[4,this.postInParallelWithAutomaticChunking({path:n,items:r})];case 1:return o.sent(),[2,{}]}}))}))},t.prototype.encodeUrl=function(e,t){return this.url(encodeURIComponent(e)+"/tables/"+encodeURIComponent(t))},t}(o.BaseResourceAPI),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.create=function(e,t,r){return void 0===r&&(r=!1),v(this,void 0,void 0,(function(){var n,o;return _(this,(function(i){switch(i.label){case 0:return n=this.encodeUrl(e)+"/tables",[4,this.postInParallelWithAutomaticChunking({queryParams:{ensureParent:r},items:t,path:n})];case 1:return o=i.sent(),[2,this.mergeItemsFromItemsResponse(o)]}}))}))},t.prototype.list=function(t,r){var n=this,o=this.encodeUrl(t)+"/tables";return e.prototype.listEndpoint.call(this,(function(e){return v(n,void 0,void 0,(function(){return _(this,(function(t){return[2,this.get(o,{params:e})]}))}))}),r)},t.prototype.delete=function(e,t){var r=this.encodeUrl(e)+"/tables/delete";return this.deleteEndpoint(t,{},r)},t.prototype.encodeUrl=function(e){return this.url(""+encodeURIComponent(e))},t}(o.BaseResourceAPI),ne=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.createDatabases=function(t){return e.prototype.createEndpoint.call(o,t)},o.listDatabases=function(t){return e.prototype.listEndpoint.call(o,o.callListEndpointWithGet,t)},o.deleteDatabases=function(t,r){return e.prototype.deleteEndpoint.call(o,t,r)},o.createTables=function(e,t,r){return void 0===r&&(r=!1),o.rawTablesApi.create(e,t,r)},o.listTables=function(e,t){return o.rawTablesApi.list(e,t)},o.deleteTables=function(e,t){return o.rawTablesApi.delete(e,t)},o.insertRows=function(e,t,r,n){return void 0===n&&(n=!1),o.rawRowsApi.insert(e,t,r,n)},o.listRows=function(e,t,r){return o.rawRowsApi.list(e,t,r)},o.retrieveRow=function(e,t,r){return o.rawRowsApi.retrieve(e,t,r)},o.deleteRows=function(e,t,r){return o.rawRowsApi.delete(e,t,r)},o.rawTablesApi=new re(t,r,n),o.rawRowsApi=new ee(t,r,n),o}return c(t,e),t}(o.BaseResourceAPI),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.retrieve=function(r,n){return void 0===n&&(n={}),e.prototype.retrieveEndpoint.call(t,r,n)},t.delete=function(r,n){return void 0===n&&(n={}),e.prototype.deleteEndpoint.call(t,r,n)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithGet,r)},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t}(o.BaseResourceAPI),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.insert=function(e){return v(this,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.postInParallelWithAutomaticChunking({path:this.url(),items:e,chunkSize:1e4})];case 1:return t.sent(),[2,{}]}}))}))},t.prototype.retrieve=function(t){var r=this;return e.prototype.listEndpoint.call(this,(function(e){return r.post(r.listPostUrl,{data:e}).then(r.transformRetrieveResponse)}),t)},t.prototype.delete=function(e){return this.deleteEndpoint(e)},t.prototype.transformRetrieveResponse=function(e){var t=e.data,r=t.rows,n=t.nextCursor,o=t.columns,i=r.map((function(e){var t=e.rowNumber,r=e.values;return{columns:o,rowNumber:t,values:r}}));return g(g({},e),{data:{items:i,nextCursor:n}})},t}(o.BaseResourceAPI),ce=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.create=function(t){return e.prototype.createEndpoint.call(o,t)},o.list=function(t){return e.prototype.listEndpoint.call(o,o.callListEndpointWithPost,t)},o.aggregate=function(t){return e.prototype.aggregateEndpoint.call(o,t)},o.retrieve=function(t,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(o,t,r)},o.update=function(t){return e.prototype.updateEndpoint.call(o,t)},o.search=function(t){return e.prototype.searchEndpoint.call(o,t)},o.delete=function(t){return e.prototype.deleteEndpoint.call(o,t)},o.insertRows=function(e){return o.sequenceRowsAPI.insert(e)},o.retrieveRows=function(e){return o.sequenceRowsAPI.retrieve(e)},o.deleteRows=function(e){return o.sequenceRowsAPI.delete(e)},o.sequenceRowsAPI=new ae(o.url()+"data",r,n),o}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","columns"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.list=function(){return v(t,void 0,void 0,(function(){var e,t;return _(this,(function(r){switch(r.label){case 0:return e=this.url(),[4,this.get(e)];case 1:return t=r.sent(),[2,this.addToMapAndReturn(t.data.items,t)]}}))}))},t.delete=function(r){return e.prototype.deleteEndpoint.call(t,r)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["deletedTime"])},t}(o.BaseResourceAPI),le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.compute=function(e){return v(t,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return t=this.url(),[4,this.post(t,{data:e})];case 1:return[2,r.sent().data]}}))}))},t}return c(t,e),t}(o.BaseResourceAPI),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(e){return t.listEndpoint(t.callListEndpointWithGet,e)},t.delete=function(e){return t.deleteEndpoint(e)},t}return c(t,e),t}(o.BaseResourceAPI),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e,r){return t.createEndpoint(r,t.url(e+"/features"))},t.retrieve=function(e,r,n){return t.callEndpointWithMergeAndTransform(r,(function(r){return t.postInParallelWithAutomaticChunking({path:t.url(e+"/features/byids"),items:r,params:n})}))},t.update=function(e,r){return t.updateEndpoint(r,t.url(e+"/features/update"))},t.delete=function(e,r){return t.deleteEndpoint(r,{},t.url(e+"/features/delete"))},t.search=function(e,r){return void 0===r&&(r={}),t.searchEndpoint(r,t.url(e+"/features/search"))},t.searchStream=function(e,r){return void 0===r&&(r={}),t.callSearchEndpoint(r,t.url(e+"/features/search-streaming")).then((function(e){return e.data}))},t.aggregate=function(e,r){return t.aggregateEndpoint(r,t.url(e+"/features/aggregate"))},t.list=function(e,r){void 0===r&&(r={});var n=t.url(e+"/features/list");return t.listEndpoint((function(e){return v(t,void 0,void 0,(function(){return _(this,(function(t){return[2,this.post(n,{data:e})]}))}))}),r)},t}return c(t,e),t}(o.BaseResourceAPI),pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(){return t.listEndpoint(t.callListEndpointWithPost)},t.delete=function(e,r){return void 0===r&&(r={}),t.deleteEndpoint(e,r)},t.update=function(e){return t.updateEndpoint(e)},t}return c(t,e),t}(o.BaseResourceAPI),fe=function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.apply(this,b(t))||this,o=w(t,3),i=o[1],s=o[2];return n.computeAPI=new le(n.url("compute"),i,s),n.crsAPI=new de(n.url("crs"),i,s),n.featureTypeAPI=new pe(n.url("featuretypes"),i,s),n.featureAPI=new he(n.url("featuretypes"),i,s),n}return c(t,e),Object.defineProperty(t.prototype,"compute",{get:function(){return this.computeAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"crs",{get:function(){return this.crsAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"feature",{get:function(){return this.featureAPI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"featureType",{get:function(){return this.featureTypeAPI},enumerable:!1,configurable:!0}),t}(o.BaseResourceAPI),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.suggest=function(e){return t.createEndpoint(e,t.suggestUrl)},t.retrieve=function(e){return t.retrieveEndpoint(e)},t.list=function(e){return t.listEndpoint(t.callListEndpointWithPost,e)},t.delete=function(e){return t.deleteEndpoint(e)},t.update=function(e){return t.updateEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},Object.defineProperty(t.prototype,"suggestUrl",{get:function(){return this.url("suggest")},enumerable:!1,configurable:!0}),t}(o.BaseResourceAPI),me=["Completed","Failed"],ye=["IndustrialObjectDetection","PersonalProtectiveEquipmentDetection"],ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.extract=function(e,r,n){return v(t,void 0,void 0,(function(){var t,o,i,s;return _(this,(function(a){switch(a.label){case 0:return t=this.url("extract"),o={},(i=e.filter((function(e){return ye.includes(e)}))).length>0&&(console.warn("Features '"+i+"' are in beta and are still in development"),o=g(g({},o),{"cdf-version":"beta"})),[4,this.post(t,{data:{features:e,items:r,parameters:n},headers:o})];case 1:return s=a.sent(),[2,this.addToMapAndReturn(s.data,s)]}}))}))},t.getExtractJob=function(e,r,n,o){return void 0===r&&(r=!0),void 0===n&&(n=1e3),void 0===o&&(o=600),v(t,void 0,void 0,(function(){var t,i,s,a=this;return _(this,(function(c){return t=this.url("extract/"+e),i=function(){return v(a,void 0,void 0,(function(){var e;return _(this,(function(r){switch(r.label){case 0:return[4,this.get(t)];case 1:return e=r.sent(),[2,this.addToMapAndReturn(e.data,e)]}}))}))},s=function(e){return me.includes(e.status)},[2,r?this.waitForJobToCompleteAndReturn(i,s,n,o):i()]}))}))},t}return c(t,e),t.prototype.waitForJobToCompleteAndReturn=function(e,t,r,n){return v(this,void 0,void 0,(function(){var i,s;return _(this,(function(a){switch(a.label){case 0:i=0,a.label=1;case 1:return[4,e()];case 2:return s=a.sent(),t(s)?[2,s]:[4,o.sleepPromise(r)];case 3:a.sent(),i++,a.label=4;case 4:if(i<n)return[3,1];a.label=5;case 5:throw new Error("Timed out while waiting for vision job to complete.")}}))}))},t}(o.BaseResourceAPI),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.runQuery=function(e){var r=e.query,n=e.variables,o=e.operationName;return v(t,void 0,void 0,(function(){return _(this,(function(e){switch(e.label){case 0:return[4,this.post(this.url(),{data:{query:r,variables:n,operationName:o}})];case 1:return[2,e.sent().data]}}))}))},t}return c(t,e),t}(o.BaseResourceAPI),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upsert=function(e){return t.post(t.url("upsert"),{data:e}).then((function(e){return e.data}))},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.delete=function(e){return t.post(t.url("delete"),{data:{version:e}})},t}return c(t,e),t}(o.BaseResourceAPI),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,r)},t.upsert=function(r){return e.prototype.createEndpoint.call(t,r,t.url("upsert"))},t.retrieve=function(r,n){return e.prototype.retrieveEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t.list=function(r){return e.prototype.listEndpoint.call(t,t.callListEndpointWithPost,r)},t.delete=function(r,n){return e.prototype.deleteEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t}return c(t,e),t}(o.BaseResourceAPI);(H=t.Br||(t.Br={})).Patch="Patch",H.Update="Update",H.Force="Force";var Ee,Ce=function(e){this.type="constant",this.value=e},Se=function(e,t,r,n){this.type="raw",this.dbName=e,this.tableName=t,this.rowKey=r,this.columnName=n},Te=function(e,t,r,n,o,i,s){this.type="syntheticTimeSeries",this.expression=e,this.name=t,this.metadata=r,this.description=n,this.isStep=o,this.isString=i,this.unit=s},Ie=function(e,t){this.type="view",this.externalId=e,this.input=t},ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(r){return e.prototype.createEndpoint.call(t,Ae.encodeTemplateInstances(r)).then(Ae.decodeTemplateInstances)},t.upsert=function(r){return e.prototype.createEndpoint.call(t,Ae.encodeTemplateInstances(r),t.url("upsert")).then(Ae.decodeTemplateInstances)},t.update=function(r){return e.prototype.updateEndpoint.call(t,r.map(Ae.encodePatch)).then(Ae.decodeTemplateInstances)},t.retrieve=function(r,n){return e.prototype.retrieveEndpoint.call(t,r,n||{ignoreUnknownIds:!1}).then(Ae.decodeTemplateInstances)},t.list=function(r){return e.prototype.listEndpoint.call(t,(function(e){return v(t,void 0,void 0,(function(){var t;return _(this,(function(r){switch(r.label){case 0:return[4,this.callListEndpointWithPost(e)];case 1:return t=r.sent(),[2,g(g({},t),{data:g(g({},t.data),{items:Ae.decodeTemplateInstances(t.data.items)})})]}}))}))}),r)},t.delete=function(r,n){return e.prototype.deleteEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t}return c(t,e),t}(o.BaseResourceAPI),Ae=function(){function e(){}return e.encodeTemplateInstances=function(t){return t.map((function(t){return g(g({},t),{fieldResolvers:e.encodeFieldResolvers(t.fieldResolvers)})}))},e.encodePatch=function(t){return g(g({},t),{update:{fieldResolvers:{add:"add"in t.update.fieldResolvers?e.encodeFieldResolvers(t.update.fieldResolvers.add):void 0,remove:"remove"in t.update.fieldResolvers?t.update.fieldResolvers.remove:void 0,set:"set"in t.update.fieldResolvers?e.encodeFieldResolvers(t.update.fieldResolvers.set):void 0}}})},e.encodeFieldResolvers=function(e){var t=this,r=s(e).map((function(e){var r=w(e,2),n=r[0],o=r[1];return void 0===o||t.isFieldResolver(o)?[n,o]:[n,new Ce(o)]}));return i(r)},e.decodeTemplateInstances=function(t){return t.map((function(t){return g(g({},t),{fieldResolvers:e.decodeFieldResolvers(t.fieldResolvers)})}))},e.decodeFieldResolvers=function(t){var r=s(t).map((function(t){var r=w(t,2),n=r[0],o=r[1];return[n,e.decodeFieldResolver(o)]}));return i(r)},e.decodeFieldResolver=function(e){switch(e.type){case"constant":return e.value;case"raw":return new Se(e.dbName,e.tableName,e.rowKey,e.columnName);case"syntheticTimeSeries":return new Te(e.expression,e.name,e.metadata,e.description,e.isStep,e.isString,e.unit);case"view":return new Ie(e.externalId,e.input);default:throw new Error("Unknown field resolver type")}},e.isFieldResolver=function(e){return"constant"===e.type||"raw"===e.type||"syntheticTimeSeries"===e.type||"view"===e.type},e}(),Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.create=function(e){return t.createEndpoint(e)},t.upsert=function(e){return t.createEndpoint(e,t.url("upsert"))},t.list=function(e){return t.listEndpoint(t.callListEndpointWithPost,e)},t.resolve=function(e){return t.listEndpoint((function(e){return v(t,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.post(this.url("resolve"),{data:e||{}})];case 1:return[2,t.sent()]}}))}))}),e)},t.delete=function(r,n){return e.prototype.deleteEndpoint.call(t,r,n||{ignoreUnknownIds:!1})},t}return c(t,e),t}(o.BaseResourceAPI),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.query=function(e){return t.querySyntheticEndpoint(e)},t}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items","datapoints"],["timestamp"])},t.prototype.querySyntheticEndpoint=function(e){return v(this,void 0,void 0,(function(){var t,r=this;return _(this,(function(n){return t=this.url("query"),[2,this.callEndpointWithMergeAndTransform(e,(function(e){return r.postInParallelWithAutomaticChunking({path:t,items:e,chunkSize:10})}))]}))}))},t}(o.BaseResourceAPI),Oe=function(e){function t(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.apply(this,b([t],r))||this;return o.create=function(t){return e.prototype.createEndpoint.call(o,t)},o.list=function(t){return e.prototype.listEndpoint.call(o,o.callListEndpointWithPost,t)},o.aggregate=function(t){return e.prototype.aggregateEndpoint.call(o,t)},o.retrieve=function(t,r){return void 0===r&&(r={}),e.prototype.retrieveEndpoint.call(o,t,r)},o.update=function(t){return e.prototype.updateEndpoint.call(o,t)},o.search=function(t){return e.prototype.searchEndpoint.call(o,t)},o.delete=function(t){return e.prototype.deleteEndpoint.call(o,t)},o.syntheticQuery=function(e){return o.syntheticTimeseriesApi.query(e)},o.syntheticTimeseriesApi=new(Pe.bind.apply(Pe,b([void 0,o.url("synthetic")],r))),o}return c(t,e),t.prototype.getDateProps=function(){return this.pickDateProps(["items"],["createdTime","lastUpdatedTime"])},t}(o.BaseResourceAPI),Ne=((Ee={})[o.HttpMethod.Post]=["/assets/list","/assets/byids","/assets/search","/events/list","/events/byids","/events/search","/files/list","/files/byids","/files/search","/files/initupload","/files/downloadlink","/timeseries/byids","/timeseries/search","/timeseries/data","/timeseries/data/list","/timeseries/data/latest","/timeseries/data/delete","/timeseries/synthetic/query"],Ee),Ue=o.createRetryValidator(Ne),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),Object.defineProperty(t.prototype,"assets",{get:function(){return o.accessApi(this.assetsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeseries",{get:function(){return o.accessApi(this.timeSeriesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datapoints",{get:function(){return o.accessApi(this.dataPointsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sequences",{get:function(){return o.accessApi(this.sequencesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return o.accessApi(this.eventsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return o.accessApi(this.filesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labels",{get:function(){return o.accessApi(this.labelsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return o.accessApi(this.rawApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projects",{get:function(){return o.accessApi(this.projectsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return o.accessApi(this.groupsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"securityCategories",{get:function(){return o.accessApi(this.securityCategoriesApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceAccounts",{get:function(){return o.accessApi(this.serviceAccountsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"models3D",{get:function(){return o.accessApi(this.models3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"revisions3D",{get:function(){return o.accessApi(this.revisions3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"files3D",{get:function(){return o.accessApi(this.files3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasets",{get:function(){return o.accessApi(this.datasetsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"assetMappings3D",{get:function(){return o.accessApi(this.assetMappings3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewer3D",{get:function(){return o.accessApi(this.viewer3DApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiKeys",{get:function(){return o.accessApi(this.apiKeysApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relationships",{get:function(){return o.accessApi(this.relationshipsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityMatching",{get:function(){return o.accessApi(this.entityMatchingApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"geospatial",{get:function(){return o.accessApi(this.geospatialApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"documents",{get:function(){return o.accessApi(this.documentsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"annotations",{get:function(){return o.accessApi(this.annotationsApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vision",{get:function(){return o.accessApi(this.visionApi)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"templates",{get:function(){var e=this;return{groups:o.accessApi(this.apiFactory(be,"templategroups")),group:function(r){var n="templategroups/"+t.urlEncodeExternalId(r)+"/versions";return{versions:o.accessApi(e.apiFactory(we,n)),version:function(t){var r=n+"/"+t,i=e.apiFactory(_e,r+"/graphql");return{instances:o.accessApi(e.apiFactory(ke,r+"/instances")),runQuery:function(t){return v(e,void 0,void 0,(function(){return _(this,(function(e){return[2,i.runQuery(t)]}))}))},views:o.accessApi(e.apiFactory(Re,r+"/views"))}}}}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return"7.19.1"},enumerable:!1,configurable:!0}),t.prototype.getRetryValidator=function(){return Ue},t.prototype.initAPIs=function(){var e="3d/models";this.httpClient.setDefaultHeader("cdf-version","V20210406"),this.assetsApi=this.apiFactory(L,"assets"),this.timeSeriesApi=this.apiFactory(Oe,"timeseries"),this.dataPointsApi=this.apiFactory(D,"timeseries/data"),this.sequencesApi=this.apiFactory(ce,"sequences"),this.eventsApi=this.apiFactory(V,"events"),this.filesApi=this.apiFactory(J,"files"),this.labelsApi=this.apiFactory(Q,"labels"),this.datasetsApi=this.apiFactory(K,"datasets"),this.rawApi=this.apiFactory(ne,"raw/dbs"),this.groupsApi=this.apiFactory(X,"groups"),this.securityCategoriesApi=this.apiFactory(se,"securitycategories"),this.serviceAccountsApi=this.apiFactory(ue,"serviceaccounts"),this.apiKeysApi=this.apiFactory(M,"apikeys"),this.models3DApi=this.apiFactory(T,e),this.relationshipsApi=this.apiFactory(oe,"relationships"),this.entityMatchingApi=this.apiFactory(W,"context/entitymatching"),this.revisions3DApi=this.apiFactory(k,e),this.files3DApi=this.apiFactory(S,"3d/files"),this.assetMappings3DApi=this.apiFactory(E,e),this.viewer3DApi=this.apiFactory(U,"3d"),this.projectsApi=new $(o.apiUrl(),this.httpClient,this.metadataMap),this.geospatialApi=this.apiFactory(fe,"geospatial"),this.documentsApi=this.apiFactory(G,"documents"),this.annotationsApi=this.apiFactory(ge,"annotations"),this.visionApi=this.apiFactory(ve,"context/vision")},t.urlEncodeExternalId=function(e){return encodeURIComponent(e)},t}(o.BaseCogniteClient);Object.defineProperty(t,"tU",{enumerable:!0,get:function(){return o.CogniteAuthentication}}),Object.defineProperty(t,"RQ",{enumerable:!0,get:function(){return o.REDIRECT}}),t.c6=Me},9456:function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function g(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function y(e){return"string"!=typeof e&&(e=String(e)),e}function v(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function _(e){this.map={},e instanceof _?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function w(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function b(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function E(e){var t=new FileReader,r=b(t);return t.readAsArrayBuffer(e),r}function S(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=S(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=S(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=w(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?w(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(E)}),this.text=function(){var e,t,r,n=w(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=b(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(A)}),this.json=function(){return this.text().then(JSON.parse)},this}_.prototype.append=function(e,t){e=g(e),t=y(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},_.prototype.delete=function(e){delete this.map[g(e)]},_.prototype.get=function(e){return e=g(e),this.has(e)?this.map[e]:null},_.prototype.has=function(e){return this.map.hasOwnProperty(g(e))},_.prototype.set=function(e,t){this.map[g(e)]=y(t)},_.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},_.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),v(e)},_.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),v(e)},_.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),v(e)},n&&(_.prototype[Symbol.iterator]=_.prototype.entries);var I=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(e,t){var r,n,o=(t=t||{}).body;if(e instanceof k){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new _(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new _(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),I.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function A(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function R(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new _(t.headers),this.url=t.url||"",this._initBody(e)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})},T.call(k.prototype),T.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},R.error=function(){var e=new R(null,{status:0,statusText:""});return e.type="error",e};var O=[301,302,303,307,308];R.redirect=function(e,t){if(-1===O.indexOf(t))throw new RangeError("Invalid status code");return new R(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(U){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function N(e,r){return new Promise((function(n,i){var s=new k(e,r);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new _,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;n(new R(o,r))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}N.polyfill=!0,e.fetch||(e.fetch=N,e.Headers=_,e.Request=k,e.Response=R),t.Headers=_,t.Request=k,t.Response=R,t.fetch=N,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},3724:function(e,t,r){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!=typeof global&&global.crypto&&(n=global.crypto),!n)try{n=r(8056)}catch(S){}var o=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(S){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(S){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},g=a.WordArray=c.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||v).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var s=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=s<<24-(n+i)%4*8}else for(var a=0;a<o;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(o());return new g.init(t,e)}}),y=s.enc={},v=y.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new g.init(r,t/2)}},_=y.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new g.init(r,t)}},w=y.Utf8={stringify:function(e){try{return decodeURIComponent(escape(_.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return _.parse(unescape(encodeURIComponent(e)))}},b=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=w.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,o=n.words,i=n.sigBytes,s=this.blockSize,a=i/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,y=e.min(4*c,i);if(c){for(var v=0;v<c;v+=s)this._doProcessBlock(o,v);r=o.splice(0,c),n.sigBytes-=y}return new g.init(r,y)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),E=(a.Hasher=b.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new E.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math),n)},4676:function(e,t,r){var n;e.exports=(n=r(3724),function(){var e=n,t=e.lib.WordArray;function r(e,r,n){for(var o=[],i=0,s=0;s<r;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return t.create(o,i)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var o=[],i=0;i<r;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<r;a++)o.push(n.charAt(s>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return r(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)},7154:function(e,t,r){var n;e.exports=(n=r(3724),n.enc.Utf8)},287:function(e,t,r){var n;e.exports=(n=r(3724),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,o=0;o<64;)t(n)&&(o<8&&(a[o]=r(e.pow(n,.5))),c[o]=r(e.pow(n,1/3)),o++),n++}();var g=[],y=s.SHA256=i.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],s=r[3],a=r[4],y=r[5],v=r[6],_=r[7],w=0;w<64;w++){if(w<16)g[w]=0|e[t+w];else{var b=g[w-15],E=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,S=g[w-2],T=(S<<15|S>>>17)^(S<<13|S>>>19)^S>>>10;g[w]=E+g[w-7]+T+g[w-16]}var I=n&o^n&i^o&i,k=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),A=_+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&y^~a&v)+c[w]+g[w];_=v,v=y,y=a,a=s+A|0,s=i,i=o,o=n,n=A+(k+I)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+y|0,r[6]=r[6]+v|0,r[7]=r[7]+_|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return r[o>>>5]|=128<<24-o%32,r[14+(o+64>>>9<<4)]=e.floor(n/4294967296),r[15+(o+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(y),t.HmacSHA256=i._createHmacHelper(y)}(Math),n.SHA256)},1133:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp("("+t+")|([^%]+?)","gi"),n=new RegExp("("+t+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(i){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function i(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(r)||[],n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var r={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},o=n.exec(e);o;){try{r[o[0]]=decodeURIComponent(o[0])}catch(t){var s=i(o[0]);s!==o[0]&&(r[o[0]]=s)}o=n.exec(e)}r["%C2"]="\ufffd";for(var a=Object.keys(r),c=0;c<a.length;c++){var g=a[c];e=e.replace(new RegExp(g,"g"),r[g])}return e}(e)}}},6068:e=>{"use strict";e.exports=function(e,t){for(var r={},n=Object.keys(e),o=Array.isArray(t),i=0;i<n.length;i++){var s=n[i],a=e[s];(o?-1!==t.indexOf(s):t(s,a,e))&&(r[s]=a)}return r}},8998:e=>{e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},612:(e,t,r)=>{"use strict";function n(e){this.message=e}r.r(t),r.d(t,{InvalidTokenError:()=>s,default:()=>a}),n.prototype=new Error,n.prototype.name="InvalidCharacterError";var o="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,i=0,s=0,a="";o=t.charAt(s++);~o&&(r=i%4?64*r+o:o,i++%4)?a+=String.fromCharCode(255&r>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return a};function i(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(o(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return o(t)}}function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidTokenError";const a=function(e,t){if("string"!=typeof e)throw new s("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(i(e.split(".")[r]))}catch(e){throw new s("Invalid token specified: "+e.message)}}},5549:(e,t,r)=>{var n=r(4457)(r(441),"DataView");e.exports=n},4613:(e,t,r)=>{var n=r(8145),o=r(9096),i=r(5239),s=r(8228),a=r(5920);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},131:(e,t,r)=>{var n=r(7168),o=r(6582),i=r(3867),s=r(9557),a=r(2726);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},4438:(e,t,r)=>{var n=r(4457)(r(441),"Map");e.exports=n},278:(e,t,r)=>{var n=r(7076),o=r(2530),i=r(4858),s=r(6265),a=r(9909);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},385:(e,t,r)=>{var n=r(4457)(r(441),"Promise");e.exports=n},9902:(e,t,r)=>{var n=r(4457)(r(441),"Set");e.exports=n},1124:(e,t,r)=>{var n=r(278),o=r(6718),i=r(6996);function s(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}s.prototype.add=s.prototype.push=o,s.prototype.has=i,e.exports=s},4281:(e,t,r)=>{var n=r(131),o=r(560),i=r(8282),s=r(6638),a=r(4270),c=r(3229);function g(e){var t=this.__data__=new n(e);this.size=t.size}g.prototype.clear=o,g.prototype.delete=i,g.prototype.get=s,g.prototype.has=a,g.prototype.set=c,e.exports=g},4690:(e,t,r)=>{var n=r(441).Symbol;e.exports=n},5982:(e,t,r)=>{var n=r(441).Uint8Array;e.exports=n},8965:(e,t,r)=>{var n=r(4457)(r(441),"WeakMap");e.exports=n},6758:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},9037:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[o++]=s)}return i}},6222:(e,t,r)=>{var n=r(5092),o=r(6981),i=r(7236),s=r(8752),a=r(4363),c=r(4812),g=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),y=!r&&o(e),v=!r&&!y&&s(e),_=!r&&!y&&!v&&c(e),w=r||y||v||_,b=w?n(e.length,String):[],E=b.length;for(var S in e)!t&&!g.call(e,S)||w&&("length"==S||v&&("offset"==S||"parent"==S)||_&&("buffer"==S||"byteLength"==S||"byteOffset"==S)||a(S,E))||b.push(S);return b}},6460:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},3848:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},4793:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},7596:(e,t,r)=>{var n=r(999),o=r(6530),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var s=e[t];i.call(e,t)&&o(s,r)&&(void 0!==r||t in e)||n(e,t,r)}},3833:(e,t,r)=>{var n=r(6530);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},5615:(e,t,r)=>{var n=r(6051),o=r(2635);e.exports=function(e,t){return e&&n(t,o(t),e)}},9751:(e,t,r)=>{var n=r(6051),o=r(5850);e.exports=function(e,t){return e&&n(t,o(t),e)}},999:(e,t,r)=>{var n=r(9346);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},2327:(e,t,r)=>{var n=r(4281),o=r(6758),i=r(7596),s=r(5615),a=r(9751),c=r(8172),g=r(6438),y=r(3746),v=r(3989),_=r(7499),w=r(5559),b=r(6686),E=r(6019),S=r(7621),T=r(3905),I=r(7236),k=r(8752),A=r(9656),R=r(5973),O=r(6925),N=r(2635),U=r(5850),M="[object Arguments]",q="[object Function]",H="[object Object]",L={};L[M]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object DataView]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L[H]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L["[object Error]"]=L[q]=L["[object WeakMap]"]=!1,e.exports=function e(t,r,D,K,F,j){var G,W=1&r,Y=2&r,V=4&r;if(D&&(G=F?D(t,K,F,j):D(t)),void 0!==G)return G;if(!R(t))return t;var J=I(t);if(J){if(G=E(t),!W)return g(t,G)}else{var X=b(t),Q=X==q||"[object GeneratorFunction]"==X;if(k(t))return c(t,W);if(X==H||X==M||Q&&!F){if(G=Y||Q?{}:T(t),!W)return Y?v(t,a(G,t)):y(t,s(G,t))}else{if(!L[X])return F?t:{};G=S(t,X,W)}}j||(j=new n);var $=j.get(t);if($)return $;j.set(t,G),O(t)?t.forEach((function(n){G.add(e(n,r,D,n,t,j))})):A(t)&&t.forEach((function(n,o){G.set(o,e(n,r,D,o,t,j))}));var ee=J?void 0:(V?Y?w:_:Y?U:N)(t);return o(ee||t,(function(n,o){ee&&(n=t[o=n]),i(G,o,e(n,r,D,o,t,j))})),G}},7372:(e,t,r)=>{var n=r(5973),o=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(o)return o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},6671:(e,t,r)=>{var n=r(5897),o=r(4741)(n);e.exports=o},641:(e,t,r)=>{var n=r(2630)();e.exports=n},5897:(e,t,r)=>{var n=r(641),o=r(2635);e.exports=function(e,t){return e&&n(e,t,o)}},166:(e,t,r)=>{var n=r(8422),o=r(8780);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[o(t[r++])];return r&&r==i?e:void 0}},9329:(e,t,r)=>{var n=r(3848),o=r(7236);e.exports=function(e,t,r){var i=t(e);return o(e)?i:n(i,r(e))}},4318:(e,t,r)=>{var n=r(4690),o=r(7077),i=r(1954),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},7:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},956:e=>{var t=Math.max,r=Math.min;e.exports=function(e,n,o){return e>=r(n,o)&&e<t(n,o)}},8520:(e,t,r)=>{var n=r(4318),o=r(3387);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},1071:(e,t,r)=>{var n=r(7229),o=r(3387);e.exports=function e(t,r,i,s,a){return t===r||(null==t||null==r||!o(t)&&!o(r)?t!=t&&r!=r:n(t,r,i,s,e,a))}},7229:(e,t,r)=>{var n=r(4281),o=r(2503),i=r(6001),s=r(8784),a=r(6686),c=r(7236),g=r(8752),y=r(4812),v="[object Arguments]",_="[object Array]",w="[object Object]",b=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,E,S,T){var I=c(e),k=c(t),A=I?_:a(e),R=k?_:a(t),O=(A=A==v?w:A)==w,N=(R=R==v?w:R)==w,U=A==R;if(U&&g(e)){if(!g(t))return!1;I=!0,O=!1}if(U&&!O)return T||(T=new n),I||y(e)?o(e,t,r,E,S,T):i(e,t,A,r,E,S,T);if(!(1&r)){var M=O&&b.call(e,"__wrapped__"),q=N&&b.call(t,"__wrapped__");if(M||q){var H=M?e.value():e,L=q?t.value():t;return T||(T=new n),S(H,L,r,E,T)}}return!!U&&(T||(T=new n),s(e,t,r,E,S,T))}},4368:(e,t,r)=>{var n=r(6686),o=r(3387);e.exports=function(e){return o(e)&&"[object Map]"==n(e)}},9157:(e,t,r)=>{var n=r(4281),o=r(1071);e.exports=function(e,t,r,i){var s=r.length,a=s,c=!i;if(null==e)return!a;for(e=Object(e);s--;){var g=r[s];if(c&&g[2]?g[1]!==e[g[0]]:!(g[0]in e))return!1}for(;++s<a;){var y=(g=r[s])[0],v=e[y],_=g[1];if(c&&g[2]){if(void 0===v&&!(y in e))return!1}else{var w=new n;if(i)var b=i(v,_,y,e,t,w);if(!(void 0===b?o(_,v,3,i,w):b))return!1}}return!0}},2987:(e,t,r)=>{var n=r(3839),o=r(7275),i=r(5973),s=r(6822),a=/^\[object .+?Constructor\]$/,c=Function.prototype,g=Object.prototype,y=c.toString,v=g.hasOwnProperty,_=RegExp("^"+y.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?_:a).test(s(e))}},4642:(e,t,r)=>{var n=r(6686),o=r(3387);e.exports=function(e){return o(e)&&"[object Set]"==n(e)}},3749:(e,t,r)=>{var n=r(4318),o=r(9216),i=r(3387),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!s[n(e)]}},8904:(e,t,r)=>{var n=r(8418),o=r(4555),i=r(5362),s=r(7236),a=r(1651);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?o(e[0],e[1]):n(e):a(e)}},8803:(e,t,r)=>{var n=r(5003),o=r(1466),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},2578:(e,t,r)=>{var n=r(5973),o=r(5003),i=r(4904),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=o(e),r=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&r.push(a);return r}},8418:(e,t,r)=>{var n=r(9157),o=r(9182),i=r(7375);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},4555:(e,t,r)=>{var n=r(1071),o=r(3795),i=r(3646),s=r(3266),a=r(1457),c=r(7375),g=r(8780);e.exports=function(e,t){return s(e)&&a(t)?c(g(e),t):function(r){var s=o(r,e);return void 0===s&&s===t?i(r,e):n(t,s,3)}}},1712:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},4815:(e,t,r)=>{var n=r(166);e.exports=function(e){return function(t){return n(t,e)}}},4293:e=>{e.exports=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}},7802:(e,t,r)=>{var n=r(6671);e.exports=function(e,t){var r;return n(e,(function(e,n,o){return!(r=t(e,n,o))})),!!r}},5092:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},94:(e,t,r)=>{var n=r(6460);e.exports=function(e,t){return n(t,(function(t){return[t,e[t]]}))}},454:(e,t,r)=>{var n=r(4690),o=r(6460),i=r(7236),s=r(2945),a=n?n.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(s(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r}},3349:(e,t,r)=>{var n=r(5720),o=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(o,""):e}},6535:e=>{e.exports=function(e){return function(t){return e(t)}}},555:e=>{e.exports=function(e,t){return e.has(t)}},8422:(e,t,r)=>{var n=r(7236),o=r(3266),i=r(3879),s=r(1119);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:i(s(e))}},3632:(e,t,r)=>{var n=r(5982);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},8172:(e,t,r)=>{e=r.nmd(e);var n=r(441),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o?n.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}},9841:(e,t,r)=>{var n=r(3632);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},2769:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},9130:(e,t,r)=>{var n=r(4690),o=n?n.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},2215:(e,t,r)=>{var n=r(3632);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},6438:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},6051:(e,t,r)=>{var n=r(7596),o=r(999);e.exports=function(e,t,r,i){var s=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var g=t[a],y=i?i(r[g],e[g],g,r,e):void 0;void 0===y&&(y=e[g]),s?o(r,g,y):n(r,g,y)}return r}},3746:(e,t,r)=>{var n=r(6051),o=r(5904);e.exports=function(e,t){return n(e,o(e),t)}},3989:(e,t,r)=>{var n=r(6051),o=r(2511);e.exports=function(e,t){return n(e,o(e),t)}},8507:(e,t,r)=>{var n=r(441)["__core-js_shared__"];e.exports=n},4741:(e,t,r)=>{var n=r(1580);e.exports=function(e,t){return function(r,o){if(null==r)return r;if(!n(r))return e(r,o);for(var i=r.length,s=t?i:-1,a=Object(r);(t?s--:++s<i)&&!1!==o(a[s],s,a););return r}}},2630:e=>{e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),s=n(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===r(i[c],c,i))break}return t}}},3348:(e,t,r)=>{var n=r(94),o=r(6686),i=r(2876),s=r(7639);e.exports=function(e){return function(t){var r=o(t);return"[object Map]"==r?i(t):"[object Set]"==r?s(t):n(t,e(t))}}},9346:(e,t,r)=>{var n=r(4457),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=o},2503:(e,t,r)=>{var n=r(1124),o=r(4793),i=r(555);e.exports=function(e,t,r,s,a,c){var g=1&r,y=e.length,v=t.length;if(y!=v&&!(g&&v>y))return!1;var _=c.get(e),w=c.get(t);if(_&&w)return _==t&&w==e;var b=-1,E=!0,S=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++b<y;){var T=e[b],I=t[b];if(s)var k=g?s(I,T,b,t,e,c):s(T,I,b,e,t,c);if(void 0!==k){if(k)continue;E=!1;break}if(S){if(!o(t,(function(e,t){if(!i(S,t)&&(T===e||a(T,e,r,s,c)))return S.push(t)}))){E=!1;break}}else if(T!==I&&!a(T,I,r,s,c)){E=!1;break}}return c.delete(e),c.delete(t),E}},6001:(e,t,r)=>{var n=r(4690),o=r(5982),i=r(6530),s=r(2503),a=r(2876),c=r(6350),g=n?n.prototype:void 0,y=g?g.valueOf:void 0;e.exports=function(e,t,r,n,g,v,_){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!v(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var w=a;case"[object Set]":var b=1&n;if(w||(w=c),e.size!=t.size&&!b)return!1;var E=_.get(e);if(E)return E==t;n|=2,_.set(e,t);var S=s(w(e),w(t),n,g,v,_);return _.delete(e),S;case"[object Symbol]":if(y)return y.call(e)==y.call(t)}return!1}},8784:(e,t,r)=>{var n=r(7499),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,s,a){var c=1&r,g=n(e),y=g.length;if(y!=n(t).length&&!c)return!1;for(var v=y;v--;){var _=g[v];if(!(c?_ in t:o.call(t,_)))return!1}var w=a.get(e),b=a.get(t);if(w&&b)return w==t&&b==e;var E=!0;a.set(e,t),a.set(t,e);for(var S=c;++v<y;){var T=e[_=g[v]],I=t[_];if(i)var k=c?i(I,T,_,t,e,a):i(T,I,_,e,t,a);if(!(void 0===k?T===I||s(T,I,r,i,a):k)){E=!1;break}S||(S="constructor"==_)}if(E&&!S){var A=e.constructor,R=t.constructor;A==R||!("constructor"in e)||!("constructor"in t)||"function"==typeof A&&A instanceof A&&"function"==typeof R&&R instanceof R||(E=!1)}return a.delete(e),a.delete(t),E}},4414:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},7499:(e,t,r)=>{var n=r(9329),o=r(5904),i=r(2635);e.exports=function(e){return n(e,i,o)}},5559:(e,t,r)=>{var n=r(9329),o=r(2511),i=r(5850);e.exports=function(e){return n(e,i,o)}},2907:(e,t,r)=>{var n=r(7620);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},9182:(e,t,r)=>{var n=r(1457),o=r(2635);e.exports=function(e){for(var t=o(e),r=t.length;r--;){var i=t[r],s=e[i];t[r]=[i,s,n(s)]}return t}},4457:(e,t,r)=>{var n=r(2987),o=r(9741);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},1407:(e,t,r)=>{var n=r(3717)(Object.getPrototypeOf,Object);e.exports=n},7077:(e,t,r)=>{var n=r(4690),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(c){}var o=s.call(e);return n&&(t?e[a]=r:delete e[a]),o}},5904:(e,t,r)=>{var n=r(9037),o=r(7471),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),n(s(e),(function(t){return i.call(e,t)})))}:o;e.exports=a},2511:(e,t,r)=>{var n=r(3848),o=r(1407),i=r(5904),s=r(7471),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,i(e)),e=o(e);return t}:s;e.exports=a},6686:(e,t,r)=>{var n=r(5549),o=r(4438),i=r(385),s=r(9902),a=r(8965),c=r(4318),g=r(6822),y="[object Map]",v="[object Promise]",_="[object Set]",w="[object WeakMap]",b="[object DataView]",E=g(n),S=g(o),T=g(i),I=g(s),k=g(a),A=c;(n&&A(new n(new ArrayBuffer(1)))!=b||o&&A(new o)!=y||i&&A(i.resolve())!=v||s&&A(new s)!=_||a&&A(new a)!=w)&&(A=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?g(r):"";if(n)switch(n){case E:return b;case S:return y;case T:return v;case I:return _;case k:return w}return t}),e.exports=A},9741:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},7383:(e,t,r)=>{var n=r(8422),o=r(6981),i=r(7236),s=r(4363),a=r(9216),c=r(8780);e.exports=function(e,t,r){for(var g=-1,y=(t=n(t,e)).length,v=!1;++g<y;){var _=c(t[g]);if(!(v=null!=e&&r(e,_)))break;e=e[_]}return v||++g!=y?v:!!(y=null==e?0:e.length)&&a(y)&&s(_,y)&&(i(e)||o(e))}},8145:(e,t,r)=>{var n=r(5148);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},9096:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},5239:(e,t,r)=>{var n=r(5148),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},8228:(e,t,r)=>{var n=r(5148),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},5920:(e,t,r)=>{var n=r(5148);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},6019:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},7621:(e,t,r)=>{var n=r(3632),o=r(9841),i=r(2769),s=r(9130),a=r(2215);e.exports=function(e,t,r){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return o(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,r);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return i(e);case"[object Symbol]":return s(e)}}},3905:(e,t,r)=>{var n=r(7372),o=r(1407),i=r(5003);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(o(e))}},4363:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=r??9007199254740991)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},3108:(e,t,r)=>{var n=r(6530),o=r(1580),i=r(4363),s=r(5973);e.exports=function(e,t,r){if(!s(r))return!1;var a=typeof t;return!!("number"==a?o(r)&&i(t,r.length):"string"==a&&t in r)&&n(r[t],e)}},3266:(e,t,r)=>{var n=r(7236),o=r(2945),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||(s.test(e)||!i.test(e)||null!=t&&e in Object(t))}},7620:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},7275:(e,t,r)=>{var n,o=r(8507),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},5003:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},1457:(e,t,r)=>{var n=r(5973);e.exports=function(e){return e==e&&!n(e)}},7168:e=>{e.exports=function(){this.__data__=[],this.size=0}},6582:(e,t,r)=>{var n=r(3833),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},3867:(e,t,r)=>{var n=r(3833);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},9557:(e,t,r)=>{var n=r(3833);e.exports=function(e){return n(this.__data__,e)>-1}},2726:(e,t,r)=>{var n=r(3833);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},7076:(e,t,r)=>{var n=r(4613),o=r(131),i=r(4438);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},2530:(e,t,r)=>{var n=r(2907);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},4858:(e,t,r)=>{var n=r(2907);e.exports=function(e){return n(this,e).get(e)}},6265:(e,t,r)=>{var n=r(2907);e.exports=function(e){return n(this,e).has(e)}},9909:(e,t,r)=>{var n=r(2907);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},2876:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},7375:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},7085:(e,t,r)=>{var n=r(427);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},5148:(e,t,r)=>{var n=r(4457)(Object,"create");e.exports=n},1466:(e,t,r)=>{var n=r(3717)(Object.keys,Object);e.exports=n},4904:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},1782:(e,t,r)=>{e=r.nmd(e);var n=r(4414),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o&&n.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=a},1954:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},3717:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},441:(e,t,r)=>{var n=r(4414),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},6718:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6996:e=>{e.exports=function(e){return this.__data__.has(e)}},6350:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},7639:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}},560:(e,t,r)=>{var n=r(131);e.exports=function(){this.__data__=new n,this.size=0}},8282:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},6638:e=>{e.exports=function(e){return this.__data__.get(e)}},4270:e=>{e.exports=function(e){return this.__data__.has(e)}},3229:(e,t,r)=>{var n=r(131),o=r(4438),i=r(278);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var s=r.__data__;if(!o||s.length<199)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(s)}return r.set(e,t),this.size=r.size,this}},3879:(e,t,r)=>{var n=r(7085),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,r,n,o){t.push(n?o.replace(i,"$1"):r||e)})),t}));e.exports=s},8780:(e,t,r)=>{var n=r(2945);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},6822:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(r){}try{return e+""}catch(r){}}return""}},5720:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},8906:(e,t,r)=>{var n=r(4293),o=r(3108),i=r(5225),s=Math.ceil,a=Math.max;e.exports=function(e,t,r){t=(r?o(e,t,r):void 0===t)?1:a(i(t),0);var c=null==e?0:e.length;if(!c||t<1)return[];for(var g=0,y=0,v=Array(s(c/t));g<c;)v[y++]=n(e,g,g+=t);return v}},3382:(e,t,r)=>{var n=r(2327);e.exports=function(e,t){return n(e,5,t="function"==typeof t?t:void 0)}},6530:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},5161:e=>{e.exports=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var o=e[t];n[o[0]]=o[1]}return n}},3795:(e,t,r)=>{var n=r(166);e.exports=function(e,t,r){var o=null==e?void 0:n(e,t);return void 0===o?r:o}},3646:(e,t,r)=>{var n=r(7),o=r(7383);e.exports=function(e,t){return null!=e&&o(e,t,n)}},5362:e=>{e.exports=function(e){return e}},6291:(e,t,r)=>{var n=r(956),o=r(992),i=r(8746);e.exports=function(e,t,r){return t=o(t),void 0===r?(r=t,t=0):r=o(r),e=i(e),n(e,t,r)}},6981:(e,t,r)=>{var n=r(8520),o=r(3387),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},7236:e=>{var t=Array.isArray;e.exports=t},1580:(e,t,r)=>{var n=r(3839),o=r(9216);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},8752:(e,t,r)=>{e=r.nmd(e);var n=r(441),o=r(7149),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,a=s&&s.exports===i?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;e.exports=c},3839:(e,t,r)=>{var n=r(4318),o=r(5973);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},9216:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},9656:(e,t,r)=>{var n=r(4368),o=r(6535),i=r(1782),s=i&&i.isMap,a=s?o(s):n;e.exports=a},5973:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3387:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},6925:(e,t,r)=>{var n=r(4642),o=r(6535),i=r(1782),s=i&&i.isSet,a=s?o(s):n;e.exports=a},4461:(e,t,r)=>{var n=r(4318),o=r(7236),i=r(3387);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==n(e)}},2945:(e,t,r)=>{var n=r(4318),o=r(3387);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},4812:(e,t,r)=>{var n=r(3749),o=r(6535),i=r(1782),s=i&&i.isTypedArray,a=s?o(s):n;e.exports=a},2635:(e,t,r)=>{var n=r(6222),o=r(8803),i=r(1580);e.exports=function(e){return i(e)?n(e):o(e)}},5850:(e,t,r)=>{var n=r(6222),o=r(2578),i=r(1580);e.exports=function(e){return i(e)?n(e,!0):o(e)}},427:(e,t,r)=>{var n=r(278);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=e.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(o.Cache||n),r}o.Cache=n,e.exports=o},3581:e=>{e.exports=function(){}},1651:(e,t,r)=>{var n=r(1712),o=r(4815),i=r(3266),s=r(8780);e.exports=function(e){return i(e)?n(s(e)):o(e)}},1273:(e,t,r)=>{var n=r(4793),o=r(8904),i=r(7802),s=r(7236),a=r(3108);e.exports=function(e,t,r){var c=s(e)?n:i;return r&&a(e,t,r)&&(t=void 0),c(e,o(t,3))}},7471:e=>{e.exports=function(){return[]}},7149:e=>{e.exports=function(){return!1}},992:(e,t,r)=>{var n=r(8746),o=1/0;e.exports=function(e){return e?(e=n(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},5225:(e,t,r)=>{var n=r(992);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},8746:(e,t,r)=>{var n=r(3349),o=r(5973),i=r(2945),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,g=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?g(e.slice(2),r?2:8):s.test(e)?NaN:+e}},6334:(e,t,r)=>{var n=r(3348)(r(2635));e.exports=n},1119:(e,t,r)=>{var n=r(454);e.exports=function(e){return null==e?"":n(e)}},4516:e=>{"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}()?Object.assign:function(e,i){for(var s,a,c=o(e),g=1;g<arguments.length;g++){for(var y in s=Object(arguments[g]))r.call(s,y)&&(c[y]=s[y]);if(t){a=t(s);for(var v=0;v<a.length;v++)n.call(s,a[v])&&(c[a[v]]=s[a[v]])}}return c}},2124:(e,t,r)=>{"use strict";const n=r(4111),o=r(1133),i=r(4867),s=r(6068),a=Symbol("encodeFragmentIdentifier");function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function g(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function y(e,t){return t.decode?o(e):e}function v(e){return Array.isArray(e)?e.sort():"object"==typeof e?v(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function _(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function w(e){const t=(e=_(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function b(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function E(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const o="string"==typeof r&&r.includes(e.arrayFormatSeparator),i="string"==typeof r&&!o&&y(r,e).includes(e.arrayFormatSeparator);r=i?y(r,e):r;const s=o||i?r.split(e.arrayFormatSeparator).map((t=>y(t,e))):null===r?r:y(r,e);n[t]=s};case"bracket-separator":return(t,r,n)=>{const o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!o)return void(n[t]=r?y(r,e):r);const i=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>y(t,e)));void 0!==n[t]?n[t]=[].concat(n[t],i):n[t]=i};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const o of e.split("&")){if(""===o)continue;let[e,s]=i(t.decode?o.replace(/\+/g," "):o,"=");s=void 0===s?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:y(s,t),r(y(e,t),s,n)}for(const o of Object.keys(n)){const e=n[o];if("object"==typeof e&&null!==e)for(const r of Object.keys(e))e[r]=b(e[r],t);else n[o]=b(e,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=v(r):e[t]=r,e}),Object.create(null))}t.extract=w,t.parse=E,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const o=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[g(t,e),"[",o,"]"].join("")]:[...r,[g(t,e),"[",g(o,e),"]=",g(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[g(t,e),"[]"].join("")]:[...r,[g(t,e),"[]=",g(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[g(t,e),":list="].join("")]:[...r,[g(t,e),":list=",g(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?n:(o=null===o?"":o,0===n.length?[[g(r,e),t,g(o,e)].join("")]:[[n,g(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,g(t,e)]:[...r,[g(t,e),"=",g(n,e)].join("")]}}(t),o={};for(const s of Object.keys(e))r(s)||(o[s]=e[s]);const i=Object.keys(o);return!1!==t.sort&&i.sort(t.sort),i.map((r=>{const o=e[r];return void 0===o?"":null===o?g(r,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?g(r,t)+"[]":o.reduce(n(r),[]).join("&"):g(r,t)+"="+g(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=i(e,"#");return Object.assign({url:r.split("?")[0]||"",query:E(w(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:y(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0,[a]:!0},r);const n=_(e.url).split("?")[0]||"",o=t.extract(e.url),i=t.parse(o,{sort:!1}),s=Object.assign(i,e.query);let c=t.stringify(s,r);c&&(c=`?${c}`);let y=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(y=`#${r[a]?g(e.fragmentIdentifier,r):e.fragmentIdentifier}`),`${n}${c}${y}`},t.pick=(e,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[a]:!1},n);const{url:o,query:i,fragmentIdentifier:c}=t.parseUrl(e,n);return t.stringifyUrl({url:o,query:s(i,r),fragmentIdentifier:c},n)},t.exclude=(e,r,n)=>{const o=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return t.pick(e,o,n)}},3456:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,r,n,o){r=r||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(r);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var g=0;g<c;++g){var y,v,_,w,b=e[g].replace(s,"%20"),E=b.indexOf(n);E>=0?(y=b.substr(0,E),v=b.substr(E+1)):(y=b,v=""),_=decodeURIComponent(y),w=decodeURIComponent(v),t(i,_)?Array.isArray(i[_])?i[_].push(w):i[_]=[i[_],w]:i[_]=w}return i}},4514:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,r,n,o){return r=r||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(o){var i=encodeURIComponent(t(o))+n;return Array.isArray(e[o])?e[o].map((function(e){return i+encodeURIComponent(t(e))})).join(r):i+encodeURIComponent(t(e[o]))})).join(r):o?encodeURIComponent(t(o))+n+encodeURIComponent(t(e)):""}},7526:(e,t,r)=>{"use strict";t.decode=t.parse=r(3456),t.encode=t.stringify=r(4514)},6094:(e,t,r)=>{"use strict";var n=r(2735),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function g(e,t,r){var n,i={},g=null,y=null;for(n in void 0!==r&&(g=""+r),void 0!==t.key&&(g=""+t.key),void 0!==t.ref&&(y=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:g,ref:y,props:i,_owner:a.current}}t.Fragment=i,t.jsx=g,t.jsxs=g},8447:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),w=Symbol.iterator;var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function T(e,t,r){this.props=e,this.context=t,this.refs=S,this.updater=r||b}function I(){}function k(e,t,r){this.props=e,this.context=t,this.refs=S,this.updater=r||b}T.prototype.isReactComponent={},T.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},T.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},I.prototype=T.prototype;var A=k.prototype=new I;A.constructor=k,E(A,T.prototype),A.isPureReactComponent=!0;var R=Array.isArray,O=Object.prototype.hasOwnProperty,N={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function M(e,t,n){var o,i={},s=null,a=null;if(null!=t)for(o in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)O.call(t,o)&&!U.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var g=Array(c),y=0;y<c;y++)g[y]=arguments[y+2];i.children=g}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:r,type:e,key:s,ref:a,props:i,_owner:N.current}}function q(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var H=/\/+/g;function L(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function D(e,t,o,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return s=s(c=e),e=""===i?"."+L(c,0):i,R(s)?(o="",null!=e&&(o=e.replace(H,"$&/")+"/"),D(s,t,o,"",(function(e){return e}))):null!=s&&(q(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,o+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(H,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",R(e))for(var g=0;g<e.length;g++){var y=i+L(a=e[g],g);c+=D(a,t,o,y,s)}else if(y=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=w&&e[w]||e["@@iterator"])?e:null}(e),"function"==typeof y)for(e=y.call(e),g=0;!(a=e.next()).done;)c+=D(a=a.value,t,o,y=i+L(a,g++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function K(e,t,r){if(null==e)return e;var n=[],o=0;return D(e,n,"","",(function(e){return t.call(r,e,o++)})),n}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var j={current:null},G={transition:null},W={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:G,ReactCurrentOwner:N};t.Children={map:K,forEach:function(e,t,r){K(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return K(e,(function(){t++})),t},toArray:function(e){return K(e,(function(e){return e}))||[]},only:function(e){if(!q(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=T,t.Fragment=o,t.Profiler=s,t.PureComponent=k,t.StrictMode=i,t.Suspense=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=E({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=N.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(g in t)O.call(t,g)&&!U.hasOwnProperty(g)&&(o[g]=void 0===t[g]&&void 0!==c?c[g]:t[g])}var g=arguments.length-2;if(1===g)o.children=n;else if(1<g){c=Array(g);for(var y=0;y<g;y++)c[y]=arguments[y+2];o.children=c}return{$$typeof:r,type:e.type,key:i,ref:s,props:o,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=M,t.createFactory=function(e){var t=M.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:g,render:e}},t.isValidElement=q,t.lazy=function(e){return{$$typeof:_,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=G.transition;G.transition={};try{e()}finally{G.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return j.current.useCallback(e,t)},t.useContext=function(e){return j.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return j.current.useDeferredValue(e)},t.useEffect=function(e,t){return j.current.useEffect(e,t)},t.useId=function(){return j.current.useId()},t.useImperativeHandle=function(e,t,r){return j.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return j.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return j.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return j.current.useMemo(e,t)},t.useReducer=function(e,t,r){return j.current.useReducer(e,t,r)},t.useRef=function(e){return j.current.useRef(e)},t.useState=function(e){return j.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return j.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return j.current.useTransition()},t.version="18.2.0"},2735:(e,t,r)=>{"use strict";e.exports=r(8447)},4512:(e,t,r)=>{"use strict";e.exports=r(6094)},4867:e=>{"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},4111:e=>{"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},7968:(e,t,r)=>{const n=r(1577).R;t.s=function(e){if(e||(e=1),!r.y.meta||!r.y.meta.url)throw console.error("__system_context__",r.y),Error("systemjs-webpack-interop was provided an unknown SystemJS context. Expected context.meta.url, but none was provided");r.p=n(r.y.meta.url,e)}},1577:(e,t,r)=>{function n(e,t){var r=document.createElement("a");r.href=e;for(var n="/"===r.pathname[0]?r.pathname:"/"+r.pathname,o=0,i=n.length;o!==t&&i>=0;){"/"===n[--i]&&o++}if(o!==t)throw Error("systemjs-webpack-interop: rootDirectoryLevel ("+t+") is greater than the number of directories ("+o+") in the URL path "+e);var s=n.slice(0,i+1);return r.protocol+"//"+r.host+s}t.m=function(e,t){if(t||(t=1),"string"!=typeof e||0===e.trim().length)throw Error("systemjs-webpack-interop: setPublicPath(systemjsModuleName) must be called with a non-empty string 'systemjsModuleName'");if("number"!=typeof t||t<=0||isNaN(t)||!o(t))throw Error("systemjs-webpack-interop: setPublicPath(systemjsModuleName, rootDirectoryLevel) must be called with a positive integer 'rootDirectoryLevel'");var i;try{if(!(i=window.System.resolve(e)))throw Error()}catch(s){throw Error("systemjs-webpack-interop: There is no such module '"+e+"' in the SystemJS registry. Did you misspell the name of your module?")}r.p=n(i,t)},t.R=n;var o=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},7333:function(e,t,r){var n;e=r.nmd(e),function(o){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof global&&global;i.global!==i&&i.window!==i&&i.self;var s,a=2147483647,c=36,g=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=Math.floor,b=String.fromCharCode;function E(e){throw RangeError(_[e])}function S(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function T(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+S((e=e.replace(v,".")).split("."),t).join(".")}function I(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function k(e){return S(e,(function(e){var t="";return e>65535&&(t+=b((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=b(e)})).join("")}function A(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,r){var n=0;for(e=r?w(e/700):e>>1,e+=w(e/t);e>455;n+=c)e=w(e/35);return w(n+36*e/(e+38))}function O(e){var t,r,n,o,i,s,g,y,v,_,b,S=[],T=e.length,I=0,A=128,O=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&E("not-basic"),S.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<T;){for(i=I,s=1,g=c;o>=T&&E("invalid-input"),((y=(b=e.charCodeAt(o++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:c)>=c||y>w((a-I)/s))&&E("overflow"),I+=y*s,!(y<(v=g<=O?1:g>=O+26?26:g-O));g+=c)s>w(a/(_=c-v))&&E("overflow"),s*=_;O=R(I-i,t=S.length+1,0==i),w(I/t)>a-A&&E("overflow"),A+=w(I/t),I%=t,S.splice(I++,0,A)}return k(S)}function N(e){var t,r,n,o,i,s,g,y,v,_,S,T,k,O,N,U=[];for(T=(e=I(e)).length,t=128,r=0,i=72,s=0;s<T;++s)(S=e[s])<128&&U.push(b(S));for(n=o=U.length,o&&U.push("-");n<T;){for(g=a,s=0;s<T;++s)(S=e[s])>=t&&S<g&&(g=S);for(g-t>w((a-r)/(k=n+1))&&E("overflow"),r+=(g-t)*k,t=g,s=0;s<T;++s)if((S=e[s])<t&&++r>a&&E("overflow"),S==t){for(y=r,v=c;!(y<(_=v<=i?1:v>=i+26?26:v-i));v+=c)N=y-_,O=c-_,U.push(b(A(_+N%O,0))),y=w(N/O);U.push(b(A(y,0))),i=R(r,k,n==o),r=0,++n}++r,++t}return U.join("")}s={version:"1.3.2",ucs2:{decode:I,encode:k},decode:O,encode:N,toASCII:function(e){return T(e,(function(e){return y.test(e)?"xn--"+N(e):e}))},toUnicode:function(e){return T(e,(function(e){return g.test(e)?O(e.slice(4).toLowerCase()):e}))}},void 0===(n=(function(){return s}).call(t,r,t,e))||(e.exports=n)}()},1662:(e,t,r)=>{"use strict";var n=r(7333),o=r(9597);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=k,t.resolve=function(e,t){return k(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?k(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=k(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,g=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),y=["'"].concat(g),v=["%","/","?",";","#"].concat(y),_=["/","?","#"],w=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,E={javascript:!0,"javascript:":!0},S={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},I=r(7526);function k(e,t,r){if(e&&o.isObject(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",g=e.split(a);g[0]=g[0].replace(/\\/g,"/");var k=e=g.join(a);if(k=k.trim(),!r&&1===e.split("#").length){var A=c.exec(k);if(A)return this.path=k,this.href=k,this.pathname=A[1],A[2]?(this.search=A[2],this.query=t?I.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var R=s.exec(k);if(R){var O=(R=R[0]).toLowerCase();this.protocol=O,k=k.substr(R.length)}if(r||R||k.match(/^\/\/[^@\/]+@[^@\/]+/)){var N="//"===k.substr(0,2);!N||R&&S[R]||(k=k.substr(2),this.slashes=!0)}if(!S[R]&&(N||R&&!T[R])){for(var U,M,q=-1,H=0;H<_.length;H++){-1!==(L=k.indexOf(_[H]))&&(-1===q||L<q)&&(q=L)}-1!==(M=-1===q?k.lastIndexOf("@"):k.lastIndexOf("@",q))&&(U=k.slice(0,M),k=k.slice(M+1),this.auth=decodeURIComponent(U)),q=-1;for(H=0;H<v.length;H++){var L;-1!==(L=k.indexOf(v[H]))&&(-1===q||L<q)&&(q=L)}-1===q&&(q=k.length),this.host=k.slice(0,q),k=k.slice(q),this.parseHost(),this.hostname=this.hostname||"";var D="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!D)for(var K=this.hostname.split(/\./),F=(H=0,K.length);H<F;H++){var j=K[H];if(j&&!j.match(w)){for(var G="",W=0,Y=j.length;W<Y;W++)j.charCodeAt(W)>127?G+="x":G+=j[W];if(!G.match(w)){var V=K.slice(0,H),J=K.slice(H+1),X=j.match(b);X&&(V.push(X[1]),J.unshift(X[2])),J.length&&(k="/"+J.join(".")+k),this.hostname=V.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),D||(this.hostname=n.toASCII(this.hostname));var Q=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+Q,this.href+=this.host,D&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==k[0]&&(k="/"+k))}if(!E[O])for(H=0,F=y.length;H<F;H++){var ee=y[H];if(-1!==k.indexOf(ee)){var re=encodeURIComponent(ee);re===ee&&(re=escape(ee)),k=k.split(ee).join(re)}}var ne=k.indexOf("#");-1!==ne&&(this.hash=k.substr(ne),k=k.slice(0,ne));var oe=k.indexOf("?");if(-1!==oe?(this.search=k.substr(oe),this.query=k.substr(oe+1),t&&(this.query=I.parse(this.query)),k=k.slice(0,oe)):t&&(this.search="",this.query={}),k&&(this.pathname=k),T[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Q=this.pathname||"";var se=this.search||"";this.path=Q+se}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(s=I.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||T[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(k(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(o.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),s=0;s<n.length;s++){var a=n[s];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),g=0;g<c.length;g++){var y=c[g];"protocol"!==y&&(r[y]=e[y])}return T[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!T[e.protocol]){for(var v=Object.keys(e),_=0;_<v.length;_++){var w=v[_];r[w]=e[w]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||S[e.protocol])r.pathname=e.pathname;else{for(var b=(e.pathname||"").split("/");b.length&&!(e.host=b.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==b[0]&&b.unshift(""),b.length<2&&b.unshift(""),r.pathname=b.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var E=r.pathname||"",I=r.search||"";r.path=E+I}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var k=r.pathname&&"/"===r.pathname.charAt(0),A=e.host||e.pathname&&"/"===e.pathname.charAt(0),R=A||k||r.host&&e.pathname,O=R,N=r.pathname&&r.pathname.split("/")||[],U=(b=e.pathname&&e.pathname.split("/")||[],r.protocol&&!T[r.protocol]);if(U&&(r.hostname="",r.port=null,r.host&&(""===N[0]?N[0]=r.host:N.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===b[0]?b[0]=e.host:b.unshift(e.host)),e.host=null),R=R&&(""===b[0]||""===N[0])),A)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,N=b;else if(b.length)N||(N=[]),N.pop(),N=N.concat(b),r.search=e.search,r.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(U)r.hostname=r.host=N.shift(),(D=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=D.shift(),r.host=r.hostname=D.shift());return r.search=e.search,r.query=e.query,o.isNull(r.pathname)&&o.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!N.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var M=N.slice(-1)[0],q=(r.host||e.host||N.length>1)&&("."===M||".."===M)||""===M,H=0,L=N.length;L>=0;L--)"."===(M=N[L])?N.splice(L,1):".."===M?(N.splice(L,1),H++):H&&(N.splice(L,1),H--);if(!R&&!O)for(;H--;H)N.unshift("..");!R||""===N[0]||N[0]&&"/"===N[0].charAt(0)||N.unshift(""),q&&"/"!==N.join("/").substr(-1)&&N.push("");var D,K=""===N[0]||N[0]&&"/"===N[0].charAt(0);U&&(r.hostname=r.host=K?"":N.length?N.shift():"",(D=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=D.shift(),r.host=r.hostname=D.shift()));return(R=R||r.host&&N.length)&&!K&&N.unshift(""),N.length?r.pathname=N.join("/"):(r.pathname=null,r.path=null),o.isNull(r.pathname)&&o.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},9597:e=>{"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},8056:()=>{}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.y=t,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="";var o={};return(0,n(7968).s)(1),(()=>{"use strict";n.r(o),n.d(o,{createSdkClient:()=>_f,default:()=>Af,getFlow:()=>Tf,getIDP:()=>zo,getSDK:()=>Ef,getToken:()=>If,getUserInformation:()=>Sf,isUsingUnifiedSignin:()=>Do,loginAndAuthIfNeeded:()=>Pf,logout:()=>kf,unifiedSignInAppName:()=>Lo});function e(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(ni){i(ni)}}function a(e){try{c(n.throw(e))}catch(ni){i(ni)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}Object.create;Object.create;var t=n(1026),r=n(1903),i=n(1054);const s="@cognite/fusion/selected-idp-details",a=["COGNITE_AUTH","AZURE_AD","ADFS2016","AUTH0","AAD_B2C","KEYCLOAK","COGNITE_IDP"],c=()=>{var e;try{const t=null!==(e=localStorage.getItem(s))&&void 0!==e?e:"",r=JSON.parse(t);if("string"!=typeof(null==r?void 0:r.internalId))throw new Error("Idp internalId is invalid");if(!a.includes(null==r?void 0:r.type))throw new Error("Idp type is invalid");return r}catch(t){return}};var g=function(e,t){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},g(e,t)};function y(e,t){function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var v=function(){return v=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},v.apply(this,arguments)};function _(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(ni){i(ni)}}function a(e){try{c(n.throw(e))}catch(ni){i(ni)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function w(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(ni){i=[6,ni],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function E(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}var S=function(e,t){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},S(e,t)};function T(e,t){function r(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var I=function(){return I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},I.apply(this,arguments)};function k(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(ni){i(ni)}}function a(e){try{c(n.throw(e))}catch(ni){i(ni)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function A(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(ni){i=[6,ni],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function R(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}var O,N,U,M,q,H={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token"},L=[H.OPENID_SCOPE,H.PROFILE_SCOPE,H.OFFLINE_ACCESS_SCOPE],D=R(L,[H.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info"}(O||(O={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"}(N||(N={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(U||(U={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(M||(M={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(q||(q={}));var K,F={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(K||(K={}));var j,G,W,Y,V,J,X,Q={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(j||(j={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(G||(G={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(W||(W={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(Y||(Y={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(V||(V={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(J||(J={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(X||(X={}));var $,ee="appmetadata",re="1",ne="authority-metadata",oe=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}($||($={}));var se,ae={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(se||(se={}));var ce,ue,le,de,he,pe,fe=60,ge=3600,me="throttling",ye="retry-after, h429",ve="invalid_grant",_e="client_mismatch";!function(e){e.username="username",e.password="password"}(ce||(ce={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(ue||(ue={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(le||(le={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(de||(de={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(he||(he={})),function(e){e.Jwt="JWT",e.Jwk="JWK"}(pe||(pe={}));var we,be,Ee,Ce,Se,Te,Ie,ke="invalid_grant",Ae=483,Re=600,Pe="msal",Oe=50,Ne="msal.js.browser";!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(we||(we={})),function(e){e.GET="GET",e.POST="POST"}(be||(be={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId"}(Ee||(Ee={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(Ce||(Ce={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(Se||(Se={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Te||(Te={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Ie||(Ie={}));var Ue,Me={scopes:L},xe="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(Ue||(Ue={}));var qe,He="msal.db",Le=He+".keys",De=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),Ke=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,De.decimalToHex(e[0])+De.decimalToHex(e[1])+De.decimalToHex(e[2])+De.decimalToHex(e[3])+"-"+De.decimalToHex(e[4])+De.decimalToHex(e[5])+"-"+De.decimalToHex(e[6])+De.decimalToHex(e[7])+"-"+De.decimalToHex(e[8])+De.decimalToHex(e[9])+"-"+De.decimalToHex(e[10])+De.decimalToHex(e[11])+De.decimalToHex(e[12])+De.decimalToHex(e[13])+De.decimalToHex(e[14])+De.decimalToHex(e[15])}catch(s){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Fe=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e}(),je=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Fe.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,s=0;s<o;s++)n=s%3,i|=e[s]<<(16>>>n&24),2!==n&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Be=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Fe.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),s=void 0,a=void 0,c=0,g=0,y=0;y<n;y++)if(a=3&y,c|=this.b64ToUint6(r.charCodeAt(y))<<18-6*a,3===a||n-y==1){for(s=0;s<3&&g<o;s++,g++)i[g]=c>>>(16>>>s&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Ge={code:"unexpected_error",desc:"Unexpected error in authentication."},We=function(e){function t(r,n,o){var i=this,s=n?r+": "+n:r;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||H.EMPTY_STRING,i.errorMessage=n||H.EMPTY_STRING,i.subError=o||H.EMPTY_STRING,i.name="AuthError",i}return T(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(Ge.code,Ge.desc+": "+e)},t}(Error),ze={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},Ye={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},Ve={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},Je={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},Xe={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},Ze={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},Qe={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},$e={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},et={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},tt={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},rt={code:"state_not_found",desc:"State not found"},nt={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},ot={code:"nonce_not_found",desc:"nonce not found"},it={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},st={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},at={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},ct={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},ut={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},lt={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},dt={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},ht={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},pt={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},ft={code:"device_code_expired",desc:"Device code is expired."},gt={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},mt={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},yt={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},vt={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},_t={code:"no_account_found",desc:"No account found in cache for given key."},wt={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},bt={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},Et={code:"invalid_cache_type",desc:"Invalid cache type"},Ct={code:"unexpected_account_type",desc:"Unexpected account type."},St={code:"unexpected_credential_type",desc:"Unexpected credential type."},Tt={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},It={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},kt={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},At={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},Rt={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},Pt={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},Ot={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},Nt={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},Ut={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},Mt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return T(t,e),t.createClientInfoDecodingError=function(e){return new t(ze.code,ze.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(Ye.code,""+Ye.desc)},t.createTokenParsingError=function(e){return new t(Ve.code,Ve.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(Je.code,Je.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(Xe.code,Xe.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(Ze.code,Ze.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(Qe.code,Qe.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t($e.code,$e.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(et.code,et.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(tt.code,tt.desc)},t.createStateNotFoundError=function(e){return new t(rt.code,rt.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(nt.code,nt.desc)},t.createNonceNotFoundError=function(e){return new t(ot.code,ot.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(it.code,it.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(st.code,st.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(at.code,at.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(ct.code,ct.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(ut.code,ut.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(lt.code,lt.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(dt.code,dt.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(ht.code,""+ht.desc)},t.createDeviceCodeCancelledError=function(){return new t(pt.code,""+pt.desc)},t.createDeviceCodeExpiredError=function(){return new t(ft.code,""+ft.desc)},t.createDeviceCodeUnknownError=function(){return new t(gt.code,""+gt.desc)},t.createNoAccountInSilentRequestError=function(){return new t(mt.code,""+mt.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(yt.code,yt.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(vt.code,vt.desc)},t.createNoAccountFoundError=function(){return new t(_t.code,_t.desc)},t.createCachePluginError=function(){return new t(wt.code,""+wt.desc)},t.createNoCryptoObjectError=function(e){return new t(bt.code,""+bt.desc+e)},t.createInvalidCacheTypeError=function(){return new t(Et.code,""+Et.desc)},t.createUnexpectedAccountTypeError=function(){return new t(Ct.code,""+Ct.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(St.code,""+St.desc)},t.createInvalidAssertionError=function(){return new t(Tt.code,""+Tt.desc)},t.createInvalidCredentialError=function(){return new t(It.code,""+It.desc)},t.createRefreshRequiredError=function(){return new t(kt.code,kt.desc)},t.createUserTimeoutReachedError=function(){return new t(At.code,At.desc)},t.createTokenClaimsRequiredError=function(){return new t(Rt.code,Rt.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(Pt.code,Pt.desc)},t.createBindingKeyNotRemovedError=function(){return new t(Ot.code,Ot.desc)},t.createLogoutNotSupportedError=function(){return new t(Nt.code,Nt.desc)},t.createKeyIdMissingError=function(){return new t(Ut.code,Ut.desc)},t}(We),xt=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw Mt.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw Mt.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(ni){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(ni){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),qt={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},Ht={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Lt={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},Dt={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},Kt={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash."},Ft={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},jt={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash."},Bt={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},Gt={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},Wt={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},zt={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Yt={code:"empty_window_error",desc:"window.open returned null or undefined window object."},Vt={code:"user_cancelled",desc:"User cancelled the flow."},Jt={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Xt={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Zt={code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},Qt={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},$t={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},er={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},tr={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},rr={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},nr={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},or={code:"no_token_request_cache_error",desc:"No token request found in cache."},ir={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},sr={code:"no_cached_authority_error",desc:"No cached authority found."},ar={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},cr={code:"invalid_cache_type",desc:"Invalid cache type"},ur={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},lr={code:"database_not_open",desc:"Database is not open!"},dr={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},hr={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},pr={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},fr={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},gr={code:"unable_to_load_token",desc:"Error loading token to cache."},mr={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},yr={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},vr={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},_r=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return y(t,e),t.createPkceNotGeneratedError=function(e){return new t(qt.code,qt.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Ht.code,Ht.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Lt.code,Lt.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Dt.code,Dt.desc)},t.createEmptyHashError=function(e){return new t(Kt.code,Kt.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(Ft.code,Ft.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(jt.code,jt.desc)},t.createUnableToParseStateError=function(){return new t(Bt.code,Bt.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(Gt.code,Gt.desc)},t.createInteractionInProgressError=function(){return new t(Wt.code,Wt.desc)},t.createPopupWindowError=function(e){var r=zt.desc;return r=xt.isEmpty(e)?r:r+" Details: "+e,new t(zt.code,r)},t.createEmptyWindowCreatedError=function(){return new t(Yt.code,Yt.desc)},t.createUserCancelledError=function(){return new t(Vt.code,Vt.desc)},t.createMonitorPopupTimeoutError=function(){return new t(Jt.code,Jt.desc)},t.createMonitorIframeTimeoutError=function(){return new t(Xt.code,Xt.desc)},t.createRedirectInIframeError=function(e){return new t(Zt.code,Zt.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(Qt.code,Qt.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t($t.code,$t.desc)},t.createIframeClosedPrematurelyError=function(){return new t(er.code,er.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(tr.code,tr.desc)},t.createNoAccountError=function(){return new t(rr.code,rr.desc)},t.createSilentPromptValueError=function(e){return new t(nr.code,nr.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(ir.code,ir.desc)},t.createNoTokenRequestCacheError=function(){return new t(or.code,or.desc)},t.createAuthRequestNotSetError=function(){return new t(ar.code,ar.desc)},t.createNoCachedAuthorityError=function(){return new t(sr.code,sr.desc)},t.createInvalidCacheTypeError=function(){return new t(cr.code,""+cr.desc)},t.createNonBrowserEnvironmentError=function(){return new t(ur.code,ur.desc)},t.createDatabaseNotOpenError=function(){return new t(lr.code,lr.desc)},t.createNoNetworkConnectivityError=function(){return new t(dr.code,dr.desc)},t.createPostRequestFailedError=function(e,r){return new t(hr.code,hr.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(pr.code,pr.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(fr.code,fr.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(gr.code,gr.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(mr.code,mr.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(yr.code,yr.desc)},t.createDatabaseUnavailableError=function(){return new t(vr.code,vr.desc)},t}(We),wr=function(){function e(e){this.base64Encode=new je,this.cryptoObj=e}return e.prototype.generateCodes=function(){return _(this,void 0,void 0,(function(){var e,t;return w(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(ni){throw _r.createPkceNotGeneratedError(ni)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return _(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),_r.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),br="SHA-256",Er=new Uint8Array([1,0,1]),Cr=function(){function e(e){if(this.logger=e,!this.hasCryptoAPI())throw _r.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:br,modulusLength:2048,publicExponent:Er}}return e.prototype.sha256Digest=function(e){return _(this,void 0,void 0,(function(){var t;return w(this,(function(r){return t=Fe.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(br,t):this.getSubtleCryptoDigest(br,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw _r.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return _(this,void 0,void 0,(function(){return w(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(xe,e)]}))}))},e.prototype.importJwk=function(t,r,n){return _(this,void 0,void 0,(function(){var o,i;return w(this,(function(s){return o=e.getJwkString(t),i=Fe.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,r,n):window.crypto.subtle.importKey(xe,t,this._keygenAlgorithmOptions,r,n)]}))}))},e.prototype.sign=function(e,t){return _(this,void 0,void 0,(function(){return w(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return _(this,void 0,void 0,(function(){return w(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return _(this,void 0,void 0,(function(){return w(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return _(this,void 0,void 0,(function(){var r=this;return w(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(xe,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Fe.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,r){return _(this,void 0,void 0,(function(){var n=this;return w(this,(function(o){return[2,new Promise((function(o,i){var s=window.msCrypto.subtle.importKey(xe,e,n._keygenAlgorithmOptions,t,r);s.addEventListener("complete",(function(e){o(e.target.result)})),s.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return _(this,void 0,void 0,(function(){var r=this;return w(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),Sr=function(){function e(){this.dbName=He,this.version=1,this.tableName=Le,this.dbOpen=!1}return e.prototype.open=function(){return _(this,void 0,void 0,(function(){var e=this;return w(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(_r.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.validateDbIsOpen=function(){return _(this,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return _(this,void 0,void 0,(function(){var t=this;return w(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(_r.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return _(this,void 0,void 0,(function(){var r=this;return w(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!r.db)return o(_r.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(){return n()})),i.addEventListener("error",(function(e){return o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return _(this,void 0,void 0,(function(){var t=this;return w(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(_r.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){return r()})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return _(this,void 0,void 0,(function(){var e=this;return w(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(_r.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(e){t(e.target.result)})),n.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e.prototype.containsKey=function(e){return _(this,void 0,void 0,(function(){var t=this;return w(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(_r.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){r(1===e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return _(this,void 0,void 0,(function(){return w(this,(function(e){return[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(He);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Tr=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),Ir=function(){function e(e){this.inMemoryCache=new Tr,this.indexedDBCache=new Sr,this.logger=e}return e.prototype.handleDatabaseAccessError=function(e){e instanceof _r&&e.errorCode===vr.code&&this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return _(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return _(this,void 0,void 0,(function(){var r;return w(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return _(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return _(this,void 0,void 0,(function(){var e,t;return w(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return _(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clear=function(){return _(this,void 0,void 0,(function(){var e;return w(this,(function(t){switch(t.label){case 0:this.inMemoryCache.clear(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.handleDatabaseAccessError(e),[3,4];case 4:return[2]}}))}))},e}(),kr=function(){function e(e){this.logger=e,this.browserCrypto=new Cr(this.logger),this.b64Encode=new je,this.b64Decode=new Be,this.guidGenerator=new Ke(this.browserCrypto),this.pkceGenerator=new wr(this.browserCrypto),this.cache={asymmetricKeys:new Ir(this.logger),symmetricKeys:new Ir(this.logger)}}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return _(this,void 0,void 0,(function(){return w(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){return _(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return w(this,(function(g){switch(g.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=g.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=g.sent(),o={e:n.e,kty:n.kty,n:n.n},i=Cr.getJwkString(o),[4,this.hashString(i)];case 3:return s=g.sent(),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return a=g.sent(),[4,this.browserCrypto.importJwk(a,!1,["sign"])];case 5:return c=g.sent(),[4,this.cache.asymmetricKeys.setItem(s,{privateKey:c,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return g.sent(),[2,s]}}))}))},e.prototype.removeTokenBindingKey=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return _(this,void 0,void 0,(function(){var e,t,r;return w(this,(function(n){switch(n.label){case 0:return e=Object.keys(this.cache),(t=this.cache[e[0]])?[4,t.deleteDatabase()]:[3,2];case 1:return r=n.sent(),[3,3];case 2:r=!1,n.label=3;case 3:return[2,r]}}))}))},e.prototype.signJwt=function(e,t){return _(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g,y,v;return w(this,(function(_){switch(_.label){case 0:return[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(r=_.sent()))throw _r.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=_.sent(),o=Cr.getJwkString(n),i={alg:n.alg,type:xe},s=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(o)},a=this.b64Encode.urlEncode(JSON.stringify(e)),c=s+"."+a,g=Fe.stringToArrayBuffer(c),[4,this.browserCrypto.sign(r.privateKey,g)];case 3:return y=_.sent(),v=this.b64Encode.urlEncodeArr(new Uint8Array(y)),[2,c+"."+v]}}))}))},e.prototype.hashString=function(e){return _(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(qe||(qe={}));var Ar,Rr=function(){function e(e,t,r){this.level=qe.Info;this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:qe.Info,this.correlationId=e.correlationId||H.EMPTY_STRING,this.packageName=t||H.EMPTY_STRING,this.packageVersion=r||H.EMPTY_STRING}return e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(xt.isEmpty(t.correlationId)?xt.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+qe[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:qe.Error,containsPii:!1,correlationId:t||H.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:qe.Error,containsPii:!0,correlationId:t||H.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:qe.Warning,containsPii:!1,correlationId:t||H.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:qe.Warning,containsPii:!0,correlationId:t||H.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:qe.Info,containsPii:!1,correlationId:t||H.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:qe.Info,containsPii:!0,correlationId:t||H.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:qe.Verbose,containsPii:!1,correlationId:t||H.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:qe.Verbose,containsPii:!0,correlationId:t||H.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:qe.Trace,containsPii:!1,correlationId:t||H.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:qe.Trace,containsPii:!0,correlationId:t||H.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),Pr={createNewGuid:function(){throw We.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw We.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw We.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",We.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",We.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",We.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",We.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",We.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Crypto interface - hashString() has not been implemented",We.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},Or=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return T(t,e),t}(We),Nr=["interaction_required","consent_required","login_required"],Ur=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Mr={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},xr=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return T(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&Nr.indexOf(e)>-1,o=!!r&&Ur.indexOf(r)>-1,i=!!t&&Nr.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t(Mr.code,Mr.desc)},t}(We);function qr(e,t){if(xt.isEmpty(e))throw Mt.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(ni){throw Mt.createClientInfoDecodingError(ni)}}function Hr(e){if(xt.isEmpty(e))throw Mt.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(Y.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?H.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(Ar||(Ar={}));var Lr,Dr=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Y.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case W.ADFS_ACCOUNT_TYPE:return X.ADFS;case W.MSAV1_ACCOUNT_TYPE:return X.MSA;case W.MSSTS_ACCOUNT_TYPE:return X.MSSTS;case W.GENERIC_ACCOUNT_TYPE:return X.GENERIC;default:throw Mt.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||H.EMPTY_STRING,e.tenantId||H.EMPTY_STRING].join(Y.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,s,a,c,g){var y,v,_,w,b,E,S=new e;S.authorityType=W.MSSTS_ACCOUNT_TYPE,S.clientInfo=t,S.homeAccountId=r,S.nativeAccountId=g;var T=c||o&&o.getPreferredCache();if(!T)throw Mt.createInvalidCacheEnvironmentError();return S.environment=T,S.realm=(null===(y=null==n?void 0:n.claims)||void 0===y?void 0:y.tid)||H.EMPTY_STRING,S.oboAssertion=i,n&&(S.idTokenClaims=n.claims,S.localAccountId=(null===(v=null==n?void 0:n.claims)||void 0===v?void 0:v.oid)||(null===(_=null==n?void 0:n.claims)||void 0===_?void 0:_.sub)||H.EMPTY_STRING,S.username=(null===(w=null==n?void 0:n.claims)||void 0===w?void 0:w.preferred_username)||((null===(b=null==n?void 0:n.claims)||void 0===b?void 0:b.emails)?n.claims.emails[0]:H.EMPTY_STRING),S.name=null===(E=null==n?void 0:n.claims)||void 0===E?void 0:E.name),S.cloudGraphHostName=s,S.msGraphHost=a,S},e.createGenericAccount=function(t,r,n,o,i,s,a){var c,g,y,v,_=new e;_.authorityType=n&&n.authorityType===Ar.Adfs?W.ADFS_ACCOUNT_TYPE:W.GENERIC_ACCOUNT_TYPE,_.homeAccountId=t,_.realm=H.EMPTY_STRING,_.oboAssertion=o;var w=a||n&&n.getPreferredCache();if(!w)throw Mt.createInvalidCacheEnvironmentError();return r&&(_.localAccountId=(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.oid)||(null===(g=null==r?void 0:r.claims)||void 0===g?void 0:g.sub)||H.EMPTY_STRING,_.username=(null===(y=null==r?void 0:r.claims)||void 0===y?void 0:y.upn)||H.EMPTY_STRING,_.name=(null===(v=null==r?void 0:r.claims)||void 0===v?void 0:v.name)||H.EMPTY_STRING,_.idTokenClaims=null==r?void 0:r.claims),_.environment=w,_.cloudGraphHostName=i,_.msGraphHost=s,_},e.generateHomeAccountId=function(e,t,r,n,o){var i,s=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:H.EMPTY_STRING;if(t===Ar.Adfs)return s;if(e)try{var a=qr(e,n);if(!xt.isEmpty(a.uid)&&!xt.isEmpty(a.utid))return""+a.uid+Y.CLIENT_INFO_SEPARATOR+a.utid}catch(ni){}return r.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),Kr=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case V.ID_TOKEN:return X.ID_TOKEN;case V.ACCESS_TOKEN:case V.ACCESS_TOKEN_WITH_AUTH_SCHEME:return X.ACCESS_TOKEN;case V.REFRESH_TOKEN:return X.REFRESH_TOKEN;default:throw Mt.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(V.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(V.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?V.ACCESS_TOKEN_WITH_AUTH_SCHEME:V.ACCESS_TOKEN:-1!==e.indexOf(V.ID_TOKEN.toLowerCase())?V.ID_TOKEN:-1!==e.indexOf(V.REFRESH_TOKEN.toLowerCase())?V.REFRESH_TOKEN:H.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,r,n,o,i,s,a,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,s),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(a)].join(Y.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Y.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===V.REFRESH_TOKEN&&n||t,r||H.EMPTY_STRING].join(Y.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||H.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||H.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==se.BEARER.toLowerCase()?e.toLowerCase():H.EMPTY_STRING},e}(),Fr={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},jr={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Br={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Gr={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Wr={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},zr={code:"empty_url_error",desc:"URL was empty or null."},Yr={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},Vr={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},Jr={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},Xr={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},Zr={code:"token_request_empty",desc:"Token request was empty and not found in cache."},Qr={code:"logout_request_empty",desc:"The logout request was null or undefined."},$r={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},en={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},tn={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},rn={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},nn={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},on={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},sn={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},an={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},cn={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},un={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},ln=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return T(t,e),t.createRedirectUriEmptyError=function(){return new t(Fr.code,Fr.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(jr.code,jr.desc)},t.createClaimsRequestParsingError=function(e){return new t(Br.code,Br.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Gr.code,Gr.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(Wr.code,Wr.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(zr.code,zr.desc)},t.createEmptyScopesArrayError=function(){return new t(Yr.code,""+Yr.desc)},t.createClientIdSingleScopeError=function(e){return new t(Vr.code,Vr.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(Jr.code,Jr.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Xr.code,Xr.desc)},t.createEmptyLogoutRequestError=function(){return new t(Qr.code,Qr.desc)},t.createEmptyTokenRequestError=function(){return new t(Zr.code,Zr.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t($r.code,$r.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(en.code,en.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(tn.code,tn.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(rn.code,rn.desc)},t.createUntrustedAuthorityError=function(){return new t(nn.code,nn.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(on.code,on.desc)},t.createMissingSshJwkError=function(){return new t(sn.code,sn.desc)},t.createMissingSshKidError=function(){return new t(an.code,an.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(cn.code,cn.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(un.code,un.desc+". Invalid header: "+e+". Details: "+r)},t}(Mt),dn=function(){function e(e){var t=this,r=e?xt.trimArrayEntries(R(e)):[],n=r?xt.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||H.EMPTY_STRING).split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw ln.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!xt.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return D.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){xt.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(ni){throw Mt.createAppendScopeSetError(ni)}},e.prototype.removeScope=function(e){if(xt.isEmpty(e))throw Mt.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;D.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw Mt.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw Mt.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):H.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}(),hn=function(){function e(t,r){if(xt.isEmpty(t))throw Mt.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=xt.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(i){throw Mt.createTokenParsingError(i)}},e}(),pn=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new Dr,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idTokenClaims=new hn(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){return k(this,void 0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:if(!e)throw Mt.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return k(this,void 0,void 0,(function(){var t,r,n,o,i=this;return A(this,(function(s){switch(s.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),r=dn.fromString(e.target),(n=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]})))?(o=[],n.forEach((function(e){dn.fromString(e.target).intersectingScopeSets(r)&&o.push(i.removeCredential(e))})),[4,Promise.all(o)]):[3,2];case 1:s.sent(),s.label=2;case 2:return this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:H.EMPTY_STRING,e?e.environment:H.EMPTY_STRING,e?e.realm:H.EMPTY_STRING)},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var s=n.getAccount(o);s&&(e&&!n.matchHomeAccountId(s,e)||t&&!n.matchEnvironment(s,t)||r&&!n.matchRealm(s,r)||(i[o]=s))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType,e.keyId,e.requestedClaimsHash)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i,s,a,c,g,y){var v=this,_=this.getKeys(),w={idTokens:{},accessTokens:{},refreshTokens:{}};return _.forEach((function(_){var b=Kr.getCredentialType(_);if(b!==H.NOT_DEFINED){var E=v.getSpecificCredential(_,b);if(E&&(!a||v.matchOboAssertion(E,a))&&(!e||v.matchHomeAccountId(E,e))&&(!t||v.matchEnvironment(E,t))&&(!i||v.matchRealm(E,i))&&(!r||v.matchCredentialType(E,r))&&(!n||v.matchClientId(E,n))&&(!o||v.matchFamilyId(E,o))&&(!s||v.matchTarget(E,s))&&(!y&&!E.requestedClaimsHash||E.requestedClaimsHash===y)){if(r===V.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(c&&!v.matchTokenType(E,c))return;if(c===se.SSH&&g&&!v.matchKeyId(E,g))return}var S=v.updateCredentialCacheKey(_,E);switch(b){case V.ID_TOKEN:w.idTokens[S]=E;break;case V.ACCESS_TOKEN:case V.ACCESS_TOKEN_WITH_AUTH_SCHEME:w.accessTokens[S]=E;break;case V.REFRESH_TOKEN:w.refreshTokens[S]=E}}}})),w},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return k(this,void 0,void 0,(function(){var e,t,r=this;return A(this,(function(n){switch(n.label){case 0:return e=this.getKeys(),t=[],e.forEach((function(e){r.getAccount(e)&&t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2,!0]}}))}))},e.prototype.removeAccount=function(e){return k(this,void 0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw Mt.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,J.ACCOUNT)]}}))}))},e.prototype.removeAccountContext=function(e){return k(this,void 0,void 0,(function(){var t,r,n,o=this;return A(this,(function(i){switch(i.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),n=[],t.forEach((function(e){var t=Kr.getCredentialType(e);if(t!==H.NOT_DEFINED){var i=o.getSpecificCredential(e,t);i&&r===i.generateAccountId()&&n.push(o.removeCredential(i))}})),[4,Promise.all(n)];case 1:return i.sent(),[2,!0]}}))}))},e.prototype.removeCredential=function(e){return k(this,void 0,void 0,(function(){var t,r;return A(this,(function(n){switch(n.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==V.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==se.POP)return[3,4];if(!(r=e.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),Mt.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,J.CREDENTIAL)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,J.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n){var o=this.readAccountFromCache(e),i=this.readIdTokenFromCache(t,e),s=this.readAccessTokenFromCache(t,e,r),a=this.readRefreshTokenFromCache(t,e,!1),c=this.readAppMetadataFromCache(n,t);return o&&i&&(o.idTokenClaims=new hn(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:s,refreshToken:a,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=Dr.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:V.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),i=o.length;if(i<1)return null;if(i>1)throw Mt.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.readAccessTokenFromCache=function(e,t,r){var n=new dn(r.scopes||[]),o=r.authenticationScheme||se.BEARER,i=o&&o.toLowerCase()!==se.BEARER.toLowerCase()?V.ACCESS_TOKEN_WITH_AUTH_SCHEME:V.ACCESS_TOKEN,s={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:i,clientId:e,realm:t.tenantId,target:n.printScopesLowerCase(),tokenType:o,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},a=this.getCredentialsFilteredBy(s),c=Object.keys(a.accessTokens).map((function(e){return a.accessTokens[e]})),g=c.length;if(g<1)return null;if(g>1)throw Mt.createMultipleMatchingTokensInCacheError();return c[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?re:void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:V.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),s=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return s.length<1?null:s[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw Mt.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==re)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==V.ACCESS_TOKEN&&e.credentialType!==V.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=dn.fromString(e.target),n=dn.fromString(t);return n.containsOnlyOIDCScopes()?n.removeScope(H.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),r.containsScopeSet(n)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(ee)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(ne)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return ne+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case V.ID_TOKEN:return this.getIdTokenCredential(e);case V.ACCESS_TOKEN:case V.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case V.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.setAccount=function(){throw We.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw We.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw We.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw We.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw We.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw We.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw We.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw We.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw We.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw We.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw We.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw We.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw We.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw We.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw We.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw We.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw We.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw We.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw We.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw We.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",We.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw We.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(pn),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.createIdTokenEntity=function(e,r,n,o,i,s){var a=new t;return a.credentialType=V.ID_TOKEN,a.homeAccountId=e,a.environment=r,a.clientId=o,a.secret=n,a.realm=i,a.oboAssertion=s,a},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===V.ID_TOKEN)},t}(Kr),mn=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,s,a,c,g,y,v,_,w,b,E){var S,T,I=new t;I.homeAccountId=e,I.credentialType=V.ACCESS_TOKEN,I.secret=n;var k=mn.nowSeconds();if(I.cachedAt=k.toString(),I.expiresOn=a.toString(),I.extendedExpiresOn=c.toString(),y&&(I.refreshOn=y.toString()),I.environment=r,I.clientId=o,I.realm=i,I.target=s,I.oboAssertion=_,I.tokenType=xt.isEmpty(v)?se.BEARER:v,b&&(I.requestedClaims=b,I.requestedClaimsHash=E),(null===(S=I.tokenType)||void 0===S?void 0:S.toLowerCase())!==se.BEARER.toLowerCase())switch(I.credentialType=V.ACCESS_TOKEN_WITH_AUTH_SCHEME,I.tokenType){case se.POP:var A=hn.extractTokenClaims(n,g);if(!(null===(T=null==A?void 0:A.cnf)||void 0===T?void 0:T.kid))throw Mt.createTokenClaimsRequiredError();I.keyId=A.cnf.kid;break;case se.SSH:I.keyId=w}return I},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===V.ACCESS_TOKEN||e.credentialType===V.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(Kr),vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,s){var a=new t;return a.clientId=o,a.credentialType=V.REFRESH_TOKEN,a.environment=r,a.homeAccountId=e,a.secret=n,a.oboAssertion=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===V.REFRESH_TOKEN)},t}(Kr),_n=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[ee,e,t].join(Y.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(ee)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),wn=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(ae.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),bn=function(){function e(){this.expiresAt=mn.nowSeconds()+oe}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=mn.nowSeconds()+oe},e.prototype.isExpired=function(){return this.expiresAt<=mn.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(ne)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt"))},e}(),En=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(me));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),Cn=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return xt.isEmpty(r)?o:""+o+H.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw Mt.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw Mt.createNoCryptoObjectError("parseRequestState");if(xt.isEmpty(t))throw Mt.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(H.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(H.RESOURCE_DELIM):H.EMPTY_STRING,i=e.base64Decode(n),s=JSON.parse(i);return{userRequestState:xt.isEmpty(o)?H.EMPTY_STRING:o,libraryState:s}}catch(ni){throw Mt.createInvalidStateError(t,ni)}},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Lr||(Lr={}));var Sn,Tn,In={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},kn={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},An={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},Rn={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Pn={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},On={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},Nn=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return y(t,e),t.createRedirectUriEmptyError=function(){return new t(In.code,In.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(kn.code,kn.desc)},t.createStorageNotSupportedError=function(e){return new t(An.code,An.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Rn.code,Rn.desc)},t.createStubPcaInstanceCalledError=function(){return new t(Pn.code,Pn.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(On.code,On.desc)},t}(We),Un=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==we.LocalStorage&&e!==we.SessionStorage)throw Nn.createStorageNotSupportedError(e);if(!!!window[e])throw Nn.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),Mn=function(){function e(t){if(this._urlString=t,xt.isEmpty(this._urlString))throw ln.createUrlEmptyError();xt.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return xt.endsWith(t,"?")?t=t.slice(0,-1):xt.endsWith(t,"?/")&&(t=t.slice(0,-2)),xt.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(ni){throw ln.createUrlParseError(ni)}if(!e.HostNameAndPort||!e.PathSegments)throw ln.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ln.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return xt.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==U.COMMON&&n[0]!==U.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ln.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!xt.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw ln.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===H.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):H.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(xt.isEmpty(t))return{};var r=e.parseHash(t),n=xt.queryStringToObject(xt.isEmpty(r)?t:r);if(!n)throw Mt.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(xt.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}(),xn=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(xt.isEmpty(t))return null;try{return Cn.parseRequestState(e,t).libraryState.meta}catch(ni){throw Mt.createInvalidStateError(t,ni)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Mn(e);return Mn.getDeserializedHash(t.getHash())},e}(),qn=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new Tr,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return y(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case we.LocalStorage:case we.SessionStorage:try{return new Un(e)}catch(ni){this.logger.verbose(ni);break}}return this.cacheConfig.cacheLocation=we.MemoryStorage,new Tr},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case we.LocalStorage:case we.SessionStorage:try{return new Un(we.SessionStorage)}catch(ni){return this.logger.verbose(ni),this.internalStorage}case we.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=H.CACHE_PREFIX+"."+N.ID_TOKEN,r=H.CACHE_PREFIX+"."+N.CLIENT_INFO,n=H.CACHE_PREFIX+"."+N.ERROR,o=H.CACHE_PREFIX+"."+N.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[N.ID_TOKEN,N.CLIENT_INFO,N.ERROR,N.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(r){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&Dr.isAccountEntity(r)?pn.toObject(new Dr,r):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&gn.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),pn.toObject(new gn,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&yn.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),pn.toObject(new yn,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&vn.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),pn.toObject(new vn,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&_n.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),pn.toObject(new _n,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&wn.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),pn.toObject(new wn,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&bn.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),pn.toObject(new bn,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(Ce.WRAPPER_SKU,e),this.internalStorage.setItem(Ce.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Ce.WRAPPER_SKU)||"",this.internalStorage.getItem(Ce.WRAPPER_VER)||""]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(N.ACTIVE_ACCOUNT),t=this.browserStorage.getItem(e);return t&&this.getAccountInfoByFilter({localAccountId:t})[0]||null},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(N.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t))},t.prototype.getAccountInfoByFilter=function(e){return this.getAllAccounts().filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&En.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),pn.toObject(new En,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===we.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return E(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return _(this,void 0,void 0,(function(){var e=this;return w(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(H.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=H.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):xt.startsWith(e,H.CACHE_PREFIX)||xt.startsWith(e,N.ADAL_ID_TOKEN)?e:H.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=Cn.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Ee.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=Cn.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Ee.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=Cn.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Ee.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,r,!1),o){var c={credential:o.homeAccountId,type:Lr.HOME_ACCOUNT_ID};this.setTemporaryCache(Ee.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!xt.isEmpty(n)){c={credential:n,type:Lr.UPN};this.setTemporaryCache(Ee.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),xt.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(Ee.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Ee.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Ee.URL_HASH)),this.removeItem(this.generateCacheKey(Ee.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Ee.CCS_CREDENTIAL)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(Ee.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=xn.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(Ee.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(Ee.REQUEST_PARAMS,!0);if(!r)throw _r.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw _r.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Ee.REQUEST_PARAMS)),xt.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw _r.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=H.CACHE_PREFIX+"."+Ee.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=H.CACHE_PREFIX+"."+Ee.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw _r.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(N.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(N.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(N.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(N.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new hn(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t}(pn);!function(e){e.AAD="AAD",e.OIDC="OIDC"}(Sn||(Sn={})),function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(Tn||(Tn={}));var Hn="6.4.0",Ln={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1,proxyUrl:H.EMPTY_STRING},Dn={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:qe.Info,correlationId:H.EMPTY_STRING},Kn={sendGetRequestAsync:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",We.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return k(this,void 0,void 0,(function(){return A(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",We.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Fn={sku:H.SKU,version:Hn,cpu:H.EMPTY_STRING,os:H.EMPTY_STRING},jn={clientSecret:H.EMPTY_STRING,clientAssertion:void 0},Bn={azureCloudInstance:Tn.None,tenant:""+H.DEFAULT_COMMON_TENANT},Gn={application:{appName:"",appVersion:""}};var Wn={sendGetRequestAsync:function(){return Promise.reject(We.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(We.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},zn=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return _(this,void 0,void 0,(function(){var r,n,o;return w(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:be.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?_r.createGetRequestFailedError(n,e):_r.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),_r.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return _(this,void 0,void 0,(function(){var r,n,o,i;return w(this,(function(s){switch(s.label){case 0:r=t&&t.body||"",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:be.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=s.sent(),[3,4];case 3:throw o=s.sent(),window.navigator.onLine?_r.createPostRequestFailedError(o,e):_r.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=s.sent(),i.status=n.status,i)];case 6:throw s.sent(),_r.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),Yn=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return _(this,void 0,void 0,(function(){return w(this,(function(r){return[2,this.sendRequestAsync(e,be.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return _(this,void 0,void 0,(function(){return w(this,(function(r){return[2,this.sendRequestAsync(e,be.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),n.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===be.POST?i(_r.createPostRequestFailedError("Failed with status "+s.status,e)):i(_r.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),a={headers:n.getHeaderDict(s),body:r,status:s.status};o(a)}catch(ni){i(_r.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===be.POST?i(_r.createPostRequestFailedError("Failed with status "+s.status,e)):i(_r.createGetRequestFailedError("Failed with status "+s.status,e)):i(_r.createNoNetworkConnectivityError())},t===be.POST&&r&&r.body)s.send(r.body);else{if(t!==be.GET)throw _r.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),Vn=function(){function e(){}return e.clearHash=function(e){e.location.hash=H.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,H.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(Pe+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new Mn(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new zn:new Yn},e.blockReloadInHiddenIframes=function(){if(Mn.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw _r.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===Te.Redirect&&n&&!r)throw _r.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw _r.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw _r.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),Jn=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),Xn=6e3;var Zn,Qn="2.22.0";!function(e){e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Zn||(Zn={}));var $n,eo=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!Dr.isAccountEntity(r))return;var n=pn.toObject(new Dr,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Zn.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Zn.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),to=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return me+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o,J.THROTTLING);throw new Or((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||H.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[O.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(O.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||fe),r+ge))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);return e.removeItem(i,J.THROTTLING)},e}(),ro=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return k(this,void 0,void 0,(function(){var n,o;return A(this,(function(i){switch(i.label){case 0:to.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof We?o:Mt.createNetworkError(t,o);case 4:return to.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),no=function(){function e(e){this.config=function(e){var t,r=e.authOptions,n=e.systemOptions,o=e.loggerOptions,i=e.storageInterface,s=e.networkInterface,a=e.cryptoInterface,c=e.clientCredentials,g=e.libraryInfo,y=e.telemetry,v=e.serverTelemetryManager,_=e.persistencePlugin,w=e.serializableCache,b=I(I({},Dn),o);return{authOptions:(t=r,I({clientCapabilities:[],azureCloudOptions:Bn},t)),systemOptions:I(I({},Ln),n),loggerOptions:b,storageInterface:i||new fn(r.clientId,Pr),networkInterface:s||Kn,cryptoInterface:a||Pr,clientCredentials:c||jn,libraryInfo:I(I({},Fn),g),telemetry:I(I({},Gn),y),serverTelemetryManager:v||null,persistencePlugin:_||null,serializableCache:w||null}}(e),this.logger=new Rr(this.config.loggerOptions,"@azure/msal-common",Hn),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new ro(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[O.CONTENT_TYPE]=H.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Lr.HOME_ACCOUNT_ID:try{var r=Hr(e.credential);t[O.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(ni){this.logger.verbose("Could not parse home account ID for CCS Header: "+ni)}break;case Lr.UPN:t[O.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return k(this,void 0,void 0,(function(){var o;return A(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw Mt.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),oo=function(){function e(){}return e.validateRedirectUri=function(e){if(xt.isEmpty(e))throw ln.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in F)t.push(F[r]);if(t.indexOf(e)<0)throw ln.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(ni){throw ln.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(xt.isEmpty(e)||xt.isEmpty(t))throw ln.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([Q.PLAIN,Q.S256].indexOf(e)<0)throw ln.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),io=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(M.RESPONSE_TYPE,encodeURIComponent(H.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(M.RESPONSE_TYPE,encodeURIComponent(H.TOKEN_RESPONSE_TYPE+" "+H.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(M.RESPONSE_MODE,encodeURIComponent(e||j.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(M.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?R(e||[],L):e||[],n=new dn(r);this.parameters.set(M.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(M.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){oo.validateRedirectUri(e),this.parameters.set(M.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){oo.validateRedirectUri(e),this.parameters.set(M.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(M.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(K.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(K.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(O.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(O.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(K.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);oo.validateClaims(r),this.parameters.set(M.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(M.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(M.X_CLIENT_SKU,e.sku),this.parameters.set(M.X_CLIENT_VER,e.version),e.os&&this.parameters.set(M.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(M.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(M.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(M.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){oo.validatePrompt(e),this.parameters.set(""+M.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){xt.isEmpty(e)||this.parameters.set(M.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(M.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(oo.validateCodeChallengeParams(e,t),!e||!t)throw ln.createInvalidCodeChallengeParamsError();this.parameters.set(M.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(M.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(M.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(M.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(M.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(M.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(M.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(M.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(M.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(M.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(M.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(M.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;oo.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(ni){throw ln.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(q.ACCESS_TOKEN)||(r[q.ACCESS_TOKEN]={}),r[q.ACCESS_TOKEN][q.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(ce.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(ce.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){xt.isEmpty(e)||(this.parameters.set(M.TOKEN_TYPE,se.POP),this.parameters.set(M.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){xt.isEmpty(e)||(this.parameters.set(M.TOKEN_TYPE,se.SSH),this.parameters.set(M.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(M.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(M.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(M.X_MS_LIB_CAPABILITY,ye)},e.prototype.addLogoutHint=function(e){this.parameters.set(M.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),so=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null};!function(e){e.SW="sw",e.UHW="uhw"}($n||($n={}));var ao=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return k(this,void 0,void 0,(function(){var t,r,n;return A(this,(function(o){switch(o.label){case 0:return[4,this.generateKid(e)];case 1:return t=o.sent(),r=this.cryptoUtils.base64Encode(JSON.stringify(t)),n={kid:t.kid,reqCnfString:r},[4,this.cryptoUtils.hashString(r)];case 2:return[2,(n.reqCnfHash=o.sent(),n)]}}))}))},e.prototype.generateKid=function(e){return k(this,void 0,void 0,(function(){return A(this,(function(t){switch(t.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:t.sent(),xms_ksl:$n.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return k(this,void 0,void 0,(function(){return A(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return k(this,void 0,void 0,(function(){var o,i,s,a,c,g;return A(this,(function(y){switch(y.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,s=r.shrClaims,a=r.shrNonce,c=i?new Mn(i):void 0,g=null==c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(I({at:e,ts:mn.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==g?void 0:g.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null==g?void 0:g.AbsolutePath,q:(null==g?void 0:g.QueryString)?[[],g.QueryString]:void 0,client_claims:s||void 0},n),t,r.correlationId)];case 1:return[2,y.sent()]}}))}))},e}(),co=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),uo=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?Mt.createStateNotFoundError("Cached State"):Mt.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw Mt.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(xr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new xr(e.error||H.EMPTY_STRING,e.error_description,e.suberror);throw new Or(e.error||H.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&qr(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(xr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new xr(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Or(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,s,a){return k(this,void 0,void 0,(function(){var c,g,y,v,_;return A(this,(function(w){switch(w.label){case 0:if(t.id_token&&(c=new hn(t.id_token||H.EMPTY_STRING,this.cryptoObj),i&&!xt.isEmpty(i.nonce)&&c.claims.nonce!==i.nonce))throw Mt.createNonceMismatchError();this.homeAccountIdentifier=Dr.generateHomeAccountId(t.client_info||H.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(g=Cn.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||o.sshKid||void 0,y=this.generateCacheRecord(t,r,n,o,c,s,i),w.label=1;case 1:return w.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),v=new co(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(v)]):[3,3];case 2:w.sent(),w.label=3;case 3:return!a||!y.account||(_=y.account.generateAccountKey(),this.cacheStorage.getAccount(_))?[4,this.cacheStorage.saveCacheRecord(y)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,y,!1,o,c,g)]);case 4:return w.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&v?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(v)]):[3,7];case 6:w.sent(),w.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,y,!1,o,c,g,t.spa_code)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,s){var a,c,g=t.getPreferredCache();if(xt.isEmpty(g))throw Mt.createInvalidCacheEnvironmentError();!xt.isEmpty(e.id_token)&&o&&(a=gn.createIdTokenEntity(this.homeAccountIdentifier,g,e.id_token||H.EMPTY_STRING,this.clientId,o.claims.tid||H.EMPTY_STRING,i),c=this.generateAccountEntity(e,o,t,i,s));var y=null;if(!xt.isEmpty(e.access_token)){var v=e.scope?dn.fromString(e.scope):new dn(n.scopes||[]),_=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,w=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,b=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,E=r+_,S=E+w,T=b&&b>0?r+b:void 0;y=yn.createAccessTokenEntity(this.homeAccountIdentifier,g,e.access_token||H.EMPTY_STRING,this.clientId,o?o.claims.tid||H.EMPTY_STRING:t.tenant,v.printScopes(),E,S,this.cryptoObj,T,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}var I=null;xt.isEmpty(e.refresh_token)||(I=vn.createRefreshTokenEntity(this.homeAccountIdentifier,g,e.refresh_token||H.EMPTY_STRING,this.clientId,e.foci,i));var k=null;return xt.isEmpty(e.foci)||(k=_n.createAppMetadataEntity(this.clientId,g,e.foci)),new so(c,a,y,I,k)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,s=o?o.cloud_graph_host_name:H.EMPTY_STRING,a=o?o.msgraph_host:H.EMPTY_STRING;if(i===Ar.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Dr.createGenericAccount(this.homeAccountIdentifier,t,r,n,s,a);if(xt.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw Mt.createClientInfoEmptyError();return e.client_info?Dr.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,s,a):Dr.createGenericAccount(this.homeAccountIdentifier,t,r,n,s,a)},e.generateAuthenticationResult=function(e,t,r,n,o,i,s,a){var c,g,y;return k(this,void 0,void 0,(function(){var v,_,w,b,E,S,T,I,k,R,O;return A(this,(function(A){switch(A.label){case 0:if(v=H.EMPTY_STRING,_=[],w=null,E=H.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==se.POP)return[3,2];if(S=new ao(e),T=r.accessToken,I=T.secret,!(k=T.keyId))throw Mt.createKeyIdMissingError();return[4,S.signPopToken(I,k,o)];case 1:return v=A.sent(),[3,3];case 2:v=r.accessToken.secret,A.label=3;case 3:_=dn.fromString(r.accessToken.target).asArray(),w=new Date(1e3*Number(r.accessToken.expiresOn)),b=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),A.label=4;case 4:return r.appMetadata&&(E=r.appMetadata.familyId===re?re:H.EMPTY_STRING),R=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||H.EMPTY_STRING,O=(null==i?void 0:i.claims.tid)||H.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:R,tenantId:O,scopes:_,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:H.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:v,fromCache:n,expiresOn:w,correlationId:o.correlationId,extExpiresOn:b,familyId:E,tokenType:(null===(c=r.accessToken)||void 0===c?void 0:c.tokenType)||H.EMPTY_STRING,state:s?s.userRequestState:H.EMPTY_STRING,cloudGraphHostName:(null===(g=r.account)||void 0===g?void 0:g.cloudGraphHostName)||H.EMPTY_STRING,msGraphHost:(null===(y=r.account)||void 0===y?void 0:y.msGraphHost)||H.EMPTY_STRING,code:a,fromNativeBroker:!1}]}}))}))},e}(),lo=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!0,r}return T(t,e),t.prototype.getAuthCodeUrl=function(e){return k(this,void 0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:return[4,this.createAuthCodeUrlQueryString(e)];case 1:return t=r.sent(),[2,Mn.appendQueryString(this.authority.authorizationEndpoint,t)]}}))}))},t.prototype.acquireToken=function(e,t){return k(this,void 0,void 0,(function(){var r,n,o;return A(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||xt.isEmpty(e.code))throw Mt.createTokenRequestCannotBeMadeError();return r=mn.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new uo(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),[4,o.handleServerTokenResponse(n.body,this.authority,r,e,t)];case 2:return[2,i.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new uo(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new Mn(e),o=Mn.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw Mt.createNoAuthCodeInServerResponseError();return I(I({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw ln.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return Mn.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){return k(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return A(this,(function(g){switch(g.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.createTokenRequestBody(t)];case 1:if(n=g.sent(),o=this.createTokenQueryParameters(t),i=void 0,t.clientInfo)try{s=qr(t.clientInfo,this.cryptoUtils),i={credential:""+s.uid+Y.CLIENT_INFO_SEPARATOR+s.utid,type:Lr.HOME_ACCOUNT_ID}}catch(ni){this.logger.verbose("Could not parse client info for CCS Header: "+ni)}return a=this.createTokenRequestHeaders(i||t.ccsCredential),c=xt.isEmpty(o)?e.tokenEndpoint:e.tokenEndpoint+"?"+o,[2,this.executePostToTokenEndpoint(c,n,a,r)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new io;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return k(this,void 0,void 0,(function(){var t,r,n,o,i,s,a;return A(this,(function(c){switch(c.label){case 0:return(t=new io).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):oo.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),(r=e.clientAssertion||this.config.clientCredentials.clientAssertion)&&(t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(G.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==se.POP?[3,2]:[4,new ao(this.cryptoUtils).generateCnf(e)];case 1:return n=c.sent(),t.addPopToken(n.reqCnfString),[3,3];case 2:if(e.authenticationScheme===se.SSH){if(!e.sshJwk)throw ln.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}c.label=3;case 3:if(o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!xt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),i=void 0,e.clientInfo)try{s=qr(e.clientInfo,this.cryptoUtils),i={credential:""+s.uid+Y.CLIENT_INFO_SEPARATOR+s.utid,type:Lr.HOME_ACCOUNT_ID}}catch(ni){this.logger.verbose("Could not parse client info for CCS Header: "+ni)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Lr.HOME_ACCOUNT_ID:try{s=Hr(i.credential),t.addCcsOid(s)}catch(ni){this.logger.verbose("Could not parse home account ID for CCS Header: "+ni)}break;case Lr.UPN:t.addCcsUpn(i.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[M.RETURN_SPA_CODE]||t.addExtraQueryParameters(((a={})[M.RETURN_SPA_CODE]="1",a)),[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){return k(this,void 0,void 0,(function(){var t,r,n,o,i,s;return A(this,(function(a){switch(a.label){case 0:if((t=new io).addClientId(this.config.authOptions.clientId),r=R(e.scopes||[],e.extraScopesToConsent||[]),t.addScopes(r),t.addRedirectUri(e.redirectUri),n=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==F.SELECT_ACCOUNT)if(e.sid&&e.prompt===F.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){if((o=this.extractAccountSid(e.account))&&e.prompt===F.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{i=Hr(e.account.homeAccountId),t.addCcsOid(i)}catch(ni){this.logger.verbose("Could not parse home account ID for CCS Header: "+ni)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{i=Hr(e.account.homeAccountId),t.addCcsOid(i)}catch(ni){this.logger.verbose("Could not parse home account ID for CCS Header: "+ni)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!xt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(t.addNativeBroker(),e.authenticationScheme!==se.POP?[3,2]:[4,new ao(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:s=a.sent(),t.addPopToken(s.reqCnfHash),a.label=2;case 2:return[2,t.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new io;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(no);function ho(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")}var po=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(t,r,n){return k(this,void 0,void 0,(function(){var o,i,s,a,c;return A(this,(function(g){switch(g.label){case 0:if(o=t)return[3,8];i=e.IMDS_OPTIONS,n&&(i.proxyUrl=n),g.label=1;case 1:return g.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(H.IMDS_VERSION,i)];case 2:return(s=g.sent()).status===ue.httpSuccess&&(o=s.body,r.region_source=le.IMDS),s.status!==ue.httpBadRequest?[3,5]:[4,this.getCurrentVersion(i)];case 3:return(a=g.sent())?[4,this.getRegionFromIMDS(a,i)]:(r.region_source=le.FAILED_AUTO_DETECTION,[2,null]);case 4:(c=g.sent()).status===ue.httpSuccess&&(o=c.body,r.region_source=le.IMDS),g.label=5;case 5:return[3,7];case 6:return g.sent(),r.region_source=le.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=le.ENVIRONMENT_VARIABLE,g.label=9;case 9:return o||(r.region_source=le.FAILED_AUTO_DETECTION),[2,o||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){return k(this,void 0,void 0,(function(){return A(this,(function(r){return[2,this.networkInterface.sendGetRequestAsync(H.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,H.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){return k(this,void 0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(H.IMDS_ENDPOINT+"?format=json",e)];case 1:return(t=r.sent()).status===ue.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),fo=function(){function e(e,t,r,n,o){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscovery=new po(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=o||H.EMPTY_STRING}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===H.ADFS?Ar.Adfs:Ar.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Mn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw Mt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw Mt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw Mt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Mt.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw Mt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw Mt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new Mn(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Ar.Adfs||this.protocolMode===Sn.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return k(this,void 0,void 0,(function(){var e,t,r,n;return A(this,(function(o){switch(o.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new bn).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=o.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=o.sent(),t!==$.CACHE&&r!==$.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(t){var r;return k(this,void 0,void 0,(function(){var n,o,i;return A(this,(function(s){switch(s.label){case 0:return(n=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(n,!1),[2,$.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,$.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(n=s.sent())?(null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)]:[3,3]:[3,4];case 2:o=s.sent(),i=this.authorityOptions.azureRegionConfiguration.azureRegion===H.AZURE_REGION_AUTO_DISCOVER_FLAG?o:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===H.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=o?de.AUTO_DETECTION_REQUESTED_SUCCESSFUL:de.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=o?this.authorityOptions.azureRegionConfiguration.azureRegion===o?de.CONFIGURED_MATCHES_DETECTED:de.CONFIGURED_NOT_DETECTED:de.CONFIGURED_NO_AUTO_DETECTION,i&&(this.regionDiscoveryMetadata.region_used=i,n=e.replaceWithRegionalInformation(n,i)),s.label=3;case 3:return t.updateEndpointMetadata(n,!0),[2,$.NETWORK];case 4:throw Mt.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new Mn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(ni){throw ln.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return k(this,void 0,void 0,(function(){var e,t;return A(this,(function(r){switch(r.label){case 0:e={},this.proxyUrl&&(e.proxyUrl=this.proxyUrl),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,e)];case 2:return[2,ho((t=r.sent()).body)?t.body:null];case 3:return r.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return k(this,void 0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,$.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,$.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,$.NETWORK];throw ln.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(ni){throw ln.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return k(this,void 0,void 0,(function(){var t,r,n,o,i;return A(this,(function(s){switch(s.label){case 0:t=""+H.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",r={},this.proxyUrl&&(r.proxyUrl=this.proxyUrl),n=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t,r)];case 2:return o=s.sent(),i=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(o.body)?o.body.metadata:[],0===i.length?[2,null]:(n=e.getCloudDiscoveryMetadataFromNetworkResponse(i,this.hostnameAndPort),[3,4]);case 3:return s.sent(),[2,null];case 4:return n||(n=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,n]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return Mn.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==Tn.None){var n=t.tenant?t.tenant:H.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw Mt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return H.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new Mn(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+H.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=Mn.constructAuthorityUriFromObject(I(I({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?s+"?"+r:s},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,"allowestsrnonmsi=true"),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e}(),go=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o,i){return k(this,void 0,void 0,(function(){var s,a;return A(this,(function(c){switch(c.label){case 0:s=e.createInstance(t,r,n,o,i),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,s.resolveEndpointsAsync()];case 2:return c.sent(),[2,s];case 3:throw a=c.sent(),Mt.createEndpointDiscoveryIncompleteError(a);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,o){if(xt.isEmpty(e))throw ln.createUrlEmptyError();return new fo(e,t,r,n,o)},e}(),mo=function(){function e(e,t){this.cacheOutcome=he.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||H.EMPTY_STRING,this.wrapperVer=e.wrapperVer||H.EMPTY_STRING,this.telemetryCacheKey=ae.CACHE_KEY+Y.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+ae.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(ae.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(ae.VALUE_SEPARATOR);return[ae.SCHEMA_VERSION,r,t].join(ae.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(ae.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(ae.VALUE_SEPARATOR),i=t.errors.length,s=[i,r<i?ae.OVERFLOW_TRUE:ae.OVERFLOW_FALSE].join(ae.VALUE_SEPARATOR);return[ae.SCHEMA_VERSION,t.cacheHits,n,o,s].join(ae.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=ae.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),xt.isEmpty(e.subError)?xt.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(ae.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new wn;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new wn;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||H.EMPTY_STRING,s=e.failedRequests[2*t+1]||H.EMPTY_STRING,a=e.errors[t]||H.EMPTY_STRING;if(!((n+=i.toString().length+s.toString().length+a.length+3)<ae.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||H.EMPTY_STRING),e.push(this.regionSource||H.EMPTY_STRING),e.push(this.regionOutcome||H.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),yo=function(){function e(e,t,r,n,o,i){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.correlationId=i||this.browserCrypto.createNewGuid(),this.logger=n.clone(Ne,Qn,this.correlationId)}return e.prototype.clearCacheOnLogout=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];Dr.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Dr.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),this.logger.verbose("No account provided in logout request, clearing all cache items."),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){return _(this,void 0,void 0,(function(){var t,r,n;return w(this,(function(o){switch(o.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=E(e&&e.scopes||[]),e.authenticationScheme){if(e.authenticationScheme===se.SSH){if(!e.sshJwk)throw ln.createMissingSshJwkError();if(!e.sshKid)throw ln.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request')}else e.authenticationScheme=se.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||xt.isEmpty(e.claims)?[3,2]:(n=e,[4,this.browserCrypto.hashString(e.claims)]);case 1:n.requestedClaimsHash=o.sent(),o.label=2;case 2:return[2,v(v({},e),{correlationId:this.correlationId,authority:t,scopes:r})]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||Vn.getCurrentUri();return Mn.getAbsoluteUrl(t,Vn.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new mo(r,this.browserStorage)},e}(),vo=function(e){function t(t,r,n,o,i,s,a){var c=e.call(this,t,r,n,o,i,a)||this;return c.navigationClient=s,c}return y(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return _(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=v(v({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=H.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=v({correlationId:this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Mn.getAbsoluteUrl(e.postLogoutRedirectUri,Vn.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Mn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Vn.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Mn.getAbsoluteUrl(Vn.getCurrentUri(),Vn.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return _(this,void 0,void 0,(function(){var n;return w(this,(function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new lo(n)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return _(this,void 0,void 0,(function(){var n;return w(this,(function(o){switch(o.label){case 0:return this.logger.verbose("getClientConfiguration called"),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=o.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Ne,version:Qn,cpu:"",os:""}}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var n=Mn.getDeserializedHash(e);if(!n.state)throw _r.createHashDoesNotContainStateError();var o=xn.extractBrowserRequestState(this.browserCrypto,n.state);if(!o)throw _r.createUnableToParseStateError();if(o.interactionType!==t)throw _r.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),n.state},t.prototype.getDiscoveredAuthority=function(e,t){return _(this,void 0,void 0,(function(){var r,n,o;return w(this,(function(i){switch(i.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},n=e||this.config.auth.authority,o=fo.generateAuthority(n,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority"),[4,go.createDiscoveredInstance(o,this.config.system.networkClient,this.browserStorage,r)];case 1:return[2,i.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return _(this,void 0,void 0,(function(){var r,n,o,i,s,a,c;return w(this,(function(g){switch(g.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called"),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=Cn.setRequestState(this.browserCrypto,e&&e.state||H.EMPTY_STRING,n),s=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=v.apply(void 0,[v.apply(void 0,s.concat([g.sent()])),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:j.FRAGMENT}]),(a=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+a),i.account=a),xt.isEmpty(i.loginHint)&&!a&&(c=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=c),[2,i]}}))}))},t}(yo),_o=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,r){try{var n=void 0;if(r.popup?(n=r.popup,this.logger.verbosePii("Navigating popup window to: "+t),n.location.assign(t)):void 0===r.popup&&(this.logger.verbosePii("Opening popup window to: "+t),n=e.openSizedPopup(t,r.popupName,r.popupWindowAttributes,this.logger)),!n)throw _r.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(ni){throw this.logger.error("error opening popup "+ni.message),this.browserStorage.setInteractionInProgress(!1),_r.createPopupWindowError(ni.toString())}},e.openSizedPopup=function(e,t,r,n){var o,i,s,a,c=window.screenLeft?window.screenLeft:window.screenX,g=window.screenTop?window.screenTop:window.screenY,y=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,v=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,_=null===(o=r.popupSize)||void 0===o?void 0:o.width,w=null===(i=r.popupSize)||void 0===i?void 0:i.height,b=null===(s=r.popupPosition)||void 0===s?void 0:s.top,E=null===(a=r.popupPosition)||void 0===a?void 0:a.left;return(!_||_<0||_>y)&&(n.verbose("Default popup window width used. Window width not configured or invalid."),_=Ae),(!w||w<0||w>v)&&(n.verbose("Default popup window height used. Window height not configured or invalid."),w=Re),(!b||b<0||b>v)&&(n.verbose("Default popup window top position used. Window top not configured or invalid."),b=Math.max(0,v/2-Re/2+g)),(!E||E<0||E>y)&&(n.verbose("Default popup window left position used. Window left not configured or invalid."),E=Math.max(0,y/2-Ae/2+c)),window.open(e,t,"width="+_+", height="+w+", top="+b+", left="+E+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(Te.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise((function(r,n){var o=setInterval((function(){if(e.closed)return t.cleanPopup(),clearInterval(o),void n(_r.createUserCancelledError());var i=H.EMPTY_STRING;try{i=e.location.href}catch(ni){}xt.isEmpty(i)||"about:blank"===i||(clearInterval(o),r())}),Oe)}))},e.generatePopupName=function(e,t,r,n){return Pe+"."+e+"."+t.join("-")+"."+r+"."+n},e.generateLogoutPopupName=function(e,t){var r=t.account&&t.account.homeAccountId;return Pe+"."+e+"."+r+"."+t.correlationId},e}(),wo=function(){function e(e,t,r,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.browserRequestLogger=n}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return _(this,void 0,void 0,(function(){var o,i,s;return w(this,(function(a){if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),xt.isEmpty(e))throw _r.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw Mt.createStateNotFoundError("Cached State");return s=this.authModule.handleFragmentResponse(e,i),[2,this.handleCodeResponseFromServer(s,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,o){return void 0===o&&(o=!0),_(this,void 0,void 0,(function(){var i,s,a,c,g,y;return w(this,(function(v){switch(v.label){case 0:if(this.browserRequestLogger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw Mt.createStateNotFoundError("Cached State");return a=this.browserStorage.generateNonceKey(s),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]:[3,2];case 1:v.sent(),v.label=2;case 2:return o&&(e.nonce=c||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(g=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=g),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return y=v.sent(),this.browserStorage.cleanRequestByState(t),[2,y]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return _(this,void 0,void 0,(function(){var n,o;return w(this,(function(i){switch(i.label){case 0:return n="https://"+e+"/"+t.tenant+"/",[4,go.createDiscoveredInstance(n,r,this.browserStorage,t.options)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(Ee.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(ni){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),bo=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.popupUtils=new _o(r,o),i}return y(t,e),t.prototype.initiateAuthRequest=function(e,t){if(xt.isEmpty(e))throw this.browserRequestLogger.error("Navigate url is empty"),_r.createEmptyNavigationUriError();return this.browserRequestLogger.infoPii("Navigate to: "+e),this.popupUtils.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then((function(){var r=e.location.hash;if(Vn.clearHash(e),t.popupUtils.cleanPopup(e),!r)throw _r.createEmptyHashError(e.location.href);if(Mn.hashContainsKnownProperties(r))return r;throw _r.createHashDoesNotContainKnownPropertiesError()}))},t}(wo),Eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.acquireToken=function(e){try{var t=_o.generatePopupName(this.config.auth.clientId,e.scopes||L,e.authority||this.config.auth.authority,this.correlationId),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=_o.openSizedPopup("about:blank",t,r,this.logger);return this.acquireTokenPopupAsync(e,t,r,n)}catch(ni){return Promise.reject(ni)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=_o.generateLogoutPopupName(this.config.auth.clientId,t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var s=_o.openSizedPopup("about:blank",r,i,this.logger);return this.logoutPopupAsync(t,r,i,n,s,o)}catch(ni){return Promise.reject(ni)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return _(this,void 0,void 0,(function(){var o,i,s,a,c,g,y,v,_,b,E;return w(this,(function(w){switch(w.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(Se.acquireTokenPopup),[4,this.initializeAuthorizationRequest(e,Te.Popup)];case 1:i=w.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||"",i.account||null),w.label=2;case 2:return w.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return s=w.sent(),[4,this.createAuthCodeClient(o,i.authority,i.azureCloudOptions)];case 4:return a=w.sent(),this.logger.verbose("Auth code client created"),[4,a.getAuthCodeUrl(i)];case 5:return c=w.sent(),g=new bo(a,this.browserStorage,s,this.logger),y={popup:n,popupName:t,popupWindowAttributes:r},v=g.initiateAuthRequest(c,y),this.eventHandler.emitEvent(Zn.POPUP_OPENED,Te.Popup,{popupWindow:v},null),[4,g.monitorPopupForHash(v)];case 6:return _=w.sent(),b=this.validateAndExtractStateFromHash(_,Te.Popup,i.correlationId),to.removeThrottle(this.browserStorage,this.config.auth.clientId,s),[4,g.handleCodeResponseFromHash(_,b,a.authority,this.networkClient)];case 7:return[2,w.sent()];case 8:throw E=w.sent(),n&&n.close(),E instanceof We&&E.setCorrelationId(this.correlationId),o.cacheFailedRequest(E),this.browserStorage.cleanRequestByState(i.state),E;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,o,i){return _(this,void 0,void 0,(function(){var s,a,c,g,y,v,_,b,E;return w(this,(function(w){switch(w.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Zn.LOGOUT_START,Te.Popup,e),s=this.initializeServerTelemetryManager(Se.logoutPopup),w.label=1;case 1:return w.trys.push([1,8,,9]),[4,this.clearCacheOnLogout(e.account)];case 2:return w.sent(),[4,this.createAuthCodeClient(s,n)];case 3:a=w.sent(),this.logger.verbose("Auth code client created"),c=a.getLogoutUri(e),this.eventHandler.emitEvent(Zn.LOGOUT_SUCCESS,Te.Popup,e),g=new _o(this.browserStorage,this.logger),y=g.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:o}),this.eventHandler.emitEvent(Zn.POPUP_OPENED,Te.Popup,{popupWindow:y},null),w.label=4;case 4:return w.trys.push([4,6,,7]),[4,g.monitorPopupForSameOrigin(y)];case 5:return w.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,7];case 6:return v=w.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+v),[3,7];case 7:return g.cleanPopup(y),i?(_={apiId:Se.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},b=Mn.getAbsoluteUrl(i,Vn.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+b),this.navigationClient.navigateInternal(b,_)):this.logger.verbose("No main window navigation requested"),[3,9];case 8:throw E=w.sent(),o&&o.close(),E instanceof We&&E.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Zn.LOGOUT_FAILURE,Te.Popup,null,E),this.eventHandler.emitEvent(Zn.LOGOUT_END,Te.Popup),s.cacheFailedRequest(E),E;case 9:return this.eventHandler.emitEvent(Zn.LOGOUT_END,Te.Popup),[2]}}))}))},t}(vo),Co=function(e){function t(t,r,n,o,i){var s=e.call(this,t,r,n,o)||this;return s.browserCrypto=i,s}return y(t,e),t.prototype.initiateAuthRequest=function(e,t){return _(this,void 0,void 0,(function(){var r;return w(this,(function(n){switch(n.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),xt.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Ee.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Ee.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:Se.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return n.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),_r.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n,o){return _(this,void 0,void 0,(function(){var i,s,a,c,g,y,v;return w(this,(function(_){switch(_.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),xt.isEmpty(e))throw _r.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw Mt.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,s),c=this.browserStorage.generateNonceKey(s),g=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:_.sent(),_.label=2;case 2:return a.nonce=g||void 0,a.state=s,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(y=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=y),o&&to.removeThrottle(this.browserStorage,o,this.authCodeRequest),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return v=_.sent(),this.browserStorage.cleanRequestByState(t),[2,v]}}))}))},t}(wo),So=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.acquireToken=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c;return w(this,(function(g){switch(g.label){case 0:return[4,this.initializeAuthorizationRequest(e,Te.Redirect)];case 1:t=g.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null),r=this.initializeServerTelemetryManager(Se.acquireTokenRedirect),g.label=2;case 2:return g.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return n=g.sent(),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return o=g.sent(),this.logger.verbose("Auth code client created"),i=new Co(o,this.browserStorage,n,this.logger,this.browserCrypto),[4,o.getAuthCodeUrl(t)];case 5:return s=g.sent(),a=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+a),[4,i.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:a,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,g.sent()];case 7:throw(c=g.sent())instanceof We&&c.setCorrelationId(this.correlationId),r.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y,v;return w(this,(function(_){switch(_.label){case 0:t=this.initializeServerTelemetryManager(Se.handleRedirectPromise),_.label=1;case 1:if(_.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Te.Redirect),[2,null];n=void 0;try{n=this.validateAndExtractStateFromHash(r,Te.Redirect),this.logger.verbose("State extracted from hash")}catch(ni){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+ni),this.browserStorage.cleanRequestByInteractionType(Te.Redirect),[2,null]}return o=this.browserStorage.getTemporaryCache(Ee.ORIGIN_URI,!0)||"",i=Mn.removeHashFromUrl(o),s=Mn.removeHashFromUrl(window.location.href),i===s&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return a=_.sent(),o.indexOf("#")>-1&&Vn.replaceHash(o),[2,a];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return Vn.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(Ee.URL_HASH,r,!0),c={apiId:Se.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},g=!0,o&&"null"!==o?[3,6]:(y=Vn.getHomepage(),this.browserStorage.setTemporaryCache(Ee.ORIGIN_URI,y,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(y,c)]));case 5:return g=_.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+o),[4,this.navigationClient.navigateInternal(o,c)];case 7:g=_.sent(),_.label=8;case 8:if(!g)return[2,this.handleHash(r,n,t)];_.label=9;case 9:return[2,null];case 10:throw(v=_.sent())instanceof We&&v.setCorrelationId(this.correlationId),t.cacheFailedRequest(v),this.browserStorage.cleanRequestByInteractionType(Te.Redirect),v;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),Mn.hashContainsKnownProperties(e))return Vn.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(Ee.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ee.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,r){return _(this,void 0,void 0,(function(){var n,o,i;return w(this,(function(s){switch(s.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),!(o=this.browserStorage.getCachedAuthority(t)))throw _r.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,o)];case 1:return i=s.sent(),this.logger.verbose("Auth code client created"),[4,new Co(i,this.browserStorage,n,this.logger,this.browserCrypto).handleCodeResponseFromHash(e,t,i.authority,this.networkClient,this.config.auth.clientId)];case 2:return[2,s.sent()]}}))}))},t.prototype.logout=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s;return w(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Se.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(Zn.LOGOUT_START,Te.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),n={apiId:Se.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return o=a.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(Zn.LOGOUT_SUCCESS,Te.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return a.sent(),[2];case 5:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return[4,this.navigationClient.navigateExternal(i,n)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(s=a.sent())instanceof We&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.eventHandler.emitEvent(Zn.LOGOUT_FAILURE,Te.Redirect,null,s),this.eventHandler.emitEvent(Zn.LOGOUT_END,Te.Redirect),s;case 11:return this.eventHandler.emitEvent(Zn.LOGOUT_END,Te.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return Mn.getAbsoluteUrl(t,Vn.getCurrentUri())},t}(vo),To=function(e){function t(t,r,n,o,i){var s=e.call(this,t,r,n,o)||this;return s.navigateFrameWait=i,s}return y(t,e),t.prototype.initiateAuthRequest=function(e){return _(this,void 0,void 0,(function(){var t;return w(this,(function(r){switch(r.label){case 0:if(xt.isEmpty(e))throw this.browserRequestLogger.info("Navigate url is empty"),_r.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,o){t<Xn&&r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Xn+"ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(s),void o(_r.createMonitorIframeTimeoutError());var t=H.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:H.EMPTY_STRING}catch(ni){}if(!xt.isEmpty(t)){var c=a?a.location.hash:H.EMPTY_STRING;return Mn.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(s),void n(c)):void 0}}),Oe)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(wo),Io=function(e){function t(t,r,n,o,i,s,a,c){var g=e.call(this,t,r,n,o,i,s,c)||this;return g.apiId=a,g}return y(t,e),t.prototype.acquireToken=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s;return w(this,(function(a){switch(a.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),xt.isEmpty(e.loginHint)&&xt.isEmpty(e.sid)&&(!e.account||xt.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==F.NONE)throw _r.createSilentPromptValueError(e.prompt);return[4,this.initializeAuthorizationRequest(v(v({},e),{prompt:F.NONE}),Te.Silent)];case 1:t=a.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null),r=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return n=a.sent(),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return o=a.sent(),this.logger.verbose("Auth code client created"),[4,o.getAuthCodeUrl(t)];case 5:return i=a.sent(),[4,this.silentTokenHelper(i,n,o,this.logger)];case 6:return[2,a.sent()];case 7:throw(s=a.sent())instanceof We&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 8:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(_r.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t,r,n){return _(this,void 0,void 0,(function(){var o,i,s,a;return w(this,(function(c){switch(c.label){case 0:return[4,(o=new To(r,this.browserStorage,t,n,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return i=c.sent(),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return s=c.sent(),a=this.validateAndExtractStateFromHash(s,Te.Silent,t.correlationId),[2,o.handleCodeResponseFromHash(s,a,r.authority,this.networkClient)]}}))}))},t}(vo),ko=function(e){function t(t){return e.call(this,t)||this}return T(t,e),t.prototype.acquireToken=function(e){return k(this,void 0,void 0,(function(){var t,r,n;return A(this,(function(o){switch(o.label){case 0:return t=mn.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new uo(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return k(this,void 0,void 0,(function(){var t,r;return A(this,(function(n){if(!e)throw ln.createEmptyTokenRequestError();if(!e.account)throw Mt.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(ni){if(t=ni instanceof xr&&ni.errorCode===Mr.code,r=ni instanceof Or&&ni.errorCode===ve&&ni.subError===_e,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw ni}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return k(this,void 0,void 0,(function(){var r,n;return A(this,(function(o){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw xr.createNoTokensFoundError();return n=I(I({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||se.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Lr.HOME_ACCOUNT_ID}}),[2,this.acquireToken(n)]}))}))},t.prototype.executeTokenRequest=function(e,t){return k(this,void 0,void 0,(function(){var r,n,o,i,s;return A(this,(function(a){switch(a.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=a.sent(),n=this.createTokenQueryParameters(e),o=this.createTokenRequestHeaders(e.ccsCredential),i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},s=Mn.appendQueryString(t.tokenEndpoint,n),[2,this.executePostToTokenEndpoint(s,r,o,i)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new io;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return k(this,void 0,void 0,(function(){var t,r,n,o,i;return A(this,(function(s){switch(s.label){case 0:return(t=new io).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(G.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),(n=e.clientAssertion||this.config.clientCredentials.clientAssertion)&&(t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),e.authenticationScheme!==se.POP?[3,2]:[4,new ao(this.cryptoUtils).generateCnf(e)];case 1:return o=s.sent(),t.addPopToken(o.reqCnfString),[3,3];case 2:if(e.authenticationScheme===se.SSH){if(!e.sshJwk)throw ln.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}s.label=3;case 3:if((!xt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Lr.HOME_ACCOUNT_ID:try{i=Hr(e.ccsCredential.credential),t.addCcsOid(i)}catch(ni){this.logger.verbose("Could not parse home account ID for CCS Header: "+ni)}break;case Lr.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}}))}))},t}(no),Ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.acquireToken=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i=this;return w(this,(function(s){switch(s.label){case 0:return r=[v({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=v.apply(void 0,r.concat([s.sent()])),n=this.initializeServerTelemetryManager(Se.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(n,t.authority,t.azureCloudOptions)];case 2:return o=s.sent(),this.logger.verbose("Refresh token client created"),[2,o.acquireTokenByRefreshToken(t).catch((function(e){throw e instanceof We&&e.setCorrelationId(i.correlationId),n.cacheFailedRequest(e),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(_r.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return _(this,void 0,void 0,(function(){var n;return w(this,(function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new ko(n)]}}))}))},t}(vo),Ro=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw _r.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,r);else{if(!e.authority)throw _r.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var n=fo.generateAuthority(e.authority,e.azureCloudOptions),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},i=new fo(n,this.config.system.networkClient,this.storage,o);if(r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,r.clientInfo,i.hostnameAndPort,i.tenant,r),this.loadAccessToken(e,t,r.clientInfo,i.hostnameAndPort,i.tenant,r);else{if(!t.client_info)throw _r.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,i.hostnameAndPort,i.tenant,r),this.loadAccessToken(e,t,t.client_info,i.hostnameAndPort,i.tenant,r)}}},e.prototype.loadIdToken=function(e,t,r,n,o){var i=gn.createIdTokenEntity(t,r,e,this.config.auth.clientId,n),s=new hn(e,this.cryptoObj),a=o.clientInfo?Dr.createAccount(o.clientInfo,t,s,void 0,void 0,void 0,void 0,r):Dr.createGenericAccount(t,s,void 0,void 0,void 0,void 0,r);if(!this.isBrowserEnvironment)throw _r.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(a),this.storage.setIdTokenCredential(i)},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(t.access_token){if(!t.expires_in)throw _r.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw _r.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new dn(e.scopes).printScopes(),a=t.expires_in,c=i.extendedExpiresOn,g=yn.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,s,a,c,this.cryptoObj);if(!this.isBrowserEnvironment)throw _r.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(g)}else this.logger.verbose("TokenCache - No access token provided for caching")},e}(),Po=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return y(t,e),t}(lo),Oo=function(e){function t(t,r,n,o,i,s,a,c){var g=e.call(this,t,r,n,o,i,s,c)||this;return g.apiId=a,g}return y(t,e),t.prototype.acquireToken=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s;return w(this,(function(a){switch(a.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw _r.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(e,Te.Silent)];case 1:t=a.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null),r=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,4,,5]),n=v(v({},t),{code:e.code}),[4,this.getClientConfiguration(r,t.authority)];case 3:return o=a.sent(),i=new Po(o),this.logger.verbose("Auth code client created"),[2,new To(i,this.browserStorage,n,this.logger,this.config.system.navigateFrameWait).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(s=a.sent())instanceof We&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(_r.createSilentLogoutUnsupportedError())},t}(vo),No=function(){function e(e){this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,o=e.system,i={clientId:"",authority:""+H.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Sn.AAD,azureCloudOptions:{azureCloudInstance:Tn.None,tenant:""}},s={cacheLocation:we.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},a={loggerCallback:function(){},logLevel:qe.Info,piiLoggingEnabled:!1},c=v(v({},Ln),{loggerOptions:a,networkClient:t?Vn.getBrowserNetworkClient():Wn,navigationClient:new Jn,loadFrameTimeout:0,windowHashTimeout:o&&o.loadFrameTimeout||6e4,iframeHashTimeout:o&&o.loadFrameTimeout||Xn,navigateFrameWait:t&&Vn.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1});return{auth:v(v({},i),r),cache:v(v({},s),n),system:v(v({},c),o)}}(e,this.isBrowserEnvironment),this.logger=new Rr(this.config.system.loggerOptions,"@azure/msal-browser",Qn),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.browserCrypto=this.isBrowserEnvironment?new kr(this.logger):Pr,this.eventHandler=new eo(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new qn(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(e,t){var r={cacheLocation:we.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};return new qn(e,r,Pr,t)}(this.config.auth.clientId,this.logger),this.tokenCache=new Ro(this.config,this.browserStorage,this.logger,this.browserCrypto)}return e.prototype.handleRedirectPromise=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s=this;return w(this,(function(a){return this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||H.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(Zn.HANDLE_REDIRECT_START,Te.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getTemporaryCache(Ee.CORRELATION_ID,!0)||"",i=new So(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,o),n=i.handleRedirectPromise(e).then((function(e){e&&(t.length<s.getAllAccounts().length?(s.eventHandler.emitEvent(Zn.LOGIN_SUCCESS,Te.Redirect,e),s.logger.verbose("handleRedirectResponse returned result, login success")):(s.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_SUCCESS,Te.Redirect,e),s.logger.verbose("handleRedirectResponse returned result, acquire token success")));return s.eventHandler.emitEvent(Zn.HANDLE_REDIRECT_END,Te.Redirect),e})).catch((function(e){throw t.length>0?s.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_FAILURE,Te.Redirect,null,e):s.eventHandler.emitEvent(Zn.LOGIN_FAILURE,Te.Redirect,null,e),s.eventHandler.emitEvent(Zn.HANDLE_REDIRECT_END,Te.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return _(this,void 0,void 0,(function(){var t,r=this;return w(this,(function(n){return this.logger.verbose("acquireTokenRedirect called"),this.preflightBrowserEnvironmentCheck(Te.Redirect),(t=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_START,Te.Redirect,e):this.eventHandler.emitEvent(Zn.LOGIN_START,Te.Redirect,e),[2,new So(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(e){throw t?r.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_FAILURE,Te.Redirect,null,e):r.eventHandler.emitEvent(Zn.LOGIN_FAILURE,Te.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this;try{this.logger.verbose("acquireTokenPopup called",e.correlationId),this.preflightBrowserEnvironmentCheck(Te.Popup)}catch(ni){return Promise.reject(ni)}var r=this.getAllAccounts();return r.length>0?this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_START,Te.Popup,e):this.eventHandler.emitEvent(Zn.LOGIN_START,Te.Popup,e),new Eo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).then((function(e){return r.length<t.getAllAccounts().length?t.eventHandler.emitEvent(Zn.LOGIN_SUCCESS,Te.Popup,e):t.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_SUCCESS,Te.Popup,e),e})).catch((function(e){return r.length>0?t.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_FAILURE,Te.Popup,null,e):t.eventHandler.emitEvent(Zn.LOGIN_FAILURE,Te.Popup,null,e),Promise.reject(e)}))},e.prototype.ssoSilent=function(e){return _(this,void 0,void 0,(function(){var t,r;return w(this,(function(n){switch(n.label){case 0:this.preflightBrowserEnvironmentCheck(Te.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(Zn.SSO_SILENT_START,Te.Silent,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new Io(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.ssoSilent,e.correlationId).acquireToken(e)];case 2:return t=n.sent(),this.eventHandler.emitEvent(Zn.SSO_SILENT_SUCCESS,Te.Silent,t),[2,t];case 3:throw r=n.sent(),this.eventHandler.emitEvent(Zn.SSO_SILENT_FAILURE,Te.Silent,null,r),r;case 4:return[2]}}))}))},e.prototype.acquireTokenByCode=function(e){return _(this,void 0,void 0,(function(){var t,r=this;return w(this,(function(n){this.preflightBrowserEnvironmentCheck(Te.Silent),this.logger.trace("acquireTokenByCode called",e.correlationId),this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_BY_CODE_START,Te.Silent,e);try{if(!e.code)throw _r.createAuthCodeRequiredError();return(t=this.hybridAuthCodeResponses.get(e.code))?this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId):(this.logger.verbose("Initiating new acquireTokenByCode request",e.correlationId),t=this.acquireTokenByCodeAsync(e).then((function(t){return r.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Te.Silent,t),r.hybridAuthCodeResponses.delete(e.code),t})).catch((function(t){throw r.hybridAuthCodeResponses.delete(e.code),t})),this.hybridAuthCodeResponses.set(e.code,t)),[2,t]}catch(ni){throw this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_BY_CODE_FAILURE,Te.Silent,null,ni),ni}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),[4,new Oo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenByCode,e.correlationId).acquireToken(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return _(this,void 0,void 0,(function(){var t=this;return w(this,(function(r){return this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_NETWORK_START,Te.Silent,e),Vn.blockReloadInHiddenIframes(),[2,new Ao(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(r){var n=r instanceof Or,o=r instanceof xr,i=r.errorCode===ke;if(n&&i&&!o)return t.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),new Io(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,Se.acquireTokenSilent_authCode,e.correlationId).acquireToken(e);throw r}))]}))}))},e.prototype.logout=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]}))}))},e.prototype.logoutRedirect=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){return this.preflightBrowserEnvironmentCheck(Te.Redirect),[2,new So(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{return this.preflightBrowserEnvironmentCheck(Te.Popup),new Eo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)}catch(ni){return Promise.reject(ni)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!xt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!xt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!xt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),Vn.blockNonBrowserEnvironment(this.isBrowserEnvironment),Vn.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Vn.blockReloadInHiddenIframes(),Vn.blockAcquireTokenInPopups(),e===Te.Redirect&&this.config.cache.cacheLocation===we.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Nn.createInMemoryRedirectUnavailableError();e!==Te.Redirect&&e!==Te.Popup||this.preflightInteractiveRequest()},e.prototype.preflightInteractiveRequest=function(){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Vn.blockReloadInHiddenIframes(),this.browserStorage.setInteractionInProgress(!0)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e}(),Uo=function(e){function t(t){return e.call(this,t)||this}return T(t,e),t.prototype.acquireToken=function(e){return k(this,void 0,void 0,(function(){var t;return A(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof Mt&&t.errorCode===kt.code)return[2,new ko(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return k(this,void 0,void 0,(function(){var i,s;return A(this,(function(a){switch(a.label){case 0:if(!e)throw ln.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(he.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),Mt.createRefreshRequiredError();if(!e.account)throw Mt.createNoAccountInSilentRequestError();if(i=e.authority||this.authority.getPreferredCache(),!(s=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,e,i)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(he.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),Mt.createRefreshRequiredError();if(mn.wasClockTurnedBack(s.accessToken.cachedAt)||mn.isTokenExpired(s.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(he.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),Mt.createRefreshRequiredError();if(s.accessToken.refreshOn&&mn.isTokenExpired(s.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(he.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),Mt.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(s,e)];case 1:return[2,a.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return k(this,void 0,void 0,(function(){var r;return A(this,(function(n){switch(n.label){case 0:return e.idToken&&(r=new hn(e.idToken.secret,this.config.cryptoInterface)),[4,uo.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,n.sent()]}}))}))},t}(no),Mo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.acquireToken=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o;return w(this,(function(i){switch(i.label){case 0:return t=this.initializeServerTelemetryManager(Se.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(t,e.authority,e.azureCloudOptions)];case 1:r=i.sent(),this.logger.verbose("Silent auth client created"),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,r.acquireCachedToken(e)];case 3:return n=i.sent(),this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_SUCCESS,Te.Silent,n),[2,n];case 4:throw(o=i.sent())instanceof _r&&o.errorCode===mr.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(_r.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return _(this,void 0,void 0,(function(){var n;return w(this,(function(o){switch(o.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return n=o.sent(),[2,new Uo(n)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return _(this,void 0,void 0,(function(){var r;return w(this,(function(n){switch(n.label){case 0:return r=[v({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,v.apply(void 0,[v.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(vo),xo=function(e){function t(t){var r=e.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return y(t,e),t.prototype.loginRedirect=function(e){return _(this,void 0,void 0,(function(){return w(this,(function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||Me)]}))}))},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||Me)},t.prototype.acquireTokenSilent=function(e){return _(this,void 0,void 0,(function(){var t,r,n,o,i,s=this;return w(this,(function(a){if(this.preflightBrowserEnvironmentCheck(Te.Silent),this.logger.verbose("acquireTokenSilent called",e.correlationId),!(t=e.account||this.getActiveAccount()))throw _r.createNoAccountError();return r={clientId:this.config.auth.clientId,authority:e.authority||"",scopes:e.scopes,homeAccountIdentifier:t.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},n=JSON.stringify(r),void 0===(o=this.activeSilentTokenRequests.get(n))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",e.correlationId),i=this.acquireTokenSilentAsync(e,t).then((function(e){return s.activeSilentTokenRequests.delete(n),e})).catch((function(e){throw s.activeSilentTokenRequests.delete(n),e})),this.activeSilentTokenRequests.set(n,i),[2,i]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",e.correlationId),[2,o])}))}))},t.prototype.acquireTokenSilentAsync=function(e,t){return _(this,void 0,void 0,(function(){var r,n,o=this;return w(this,(function(i){switch(i.label){case 0:return[4,(r=new Mo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId)).initializeSilentRequest(e,t)];case 1:return n=i.sent(),this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_START,Te.Silent,e),[2,r.acquireToken(n).catch((function(){return _(o,void 0,void 0,(function(){var e,t;return w(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireTokenByRefreshToken(n)];case 1:return e=r.sent(),this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_SUCCESS,Te.Silent,e),[2,e];case 2:throw t=r.sent(),this.eventHandler.emitEvent(Zn.ACQUIRE_TOKEN_FAILURE,Te.Silent,null,t),t;case 3:return[2]}}))}))}))]}}))}))},t}(No),qo=n(2124);const Ho=["apps.cognite.com","apps-staging.cognite.com","apps-test.cognite.com","apps-preview.cognite.com","localhost:8080"],Lo="cdf",Do=()=>{var e,t;return Ho.includes(window.location.host)&&(null===(t=null===(e=window.location.pathname.split("/"))||void 0===e?void 0:e.filter(Boolean))||void 0===t?void 0:t.at(0))===Lo},Ko=(0,r.readLoginHints)(),Fo=e=>{var t,r;return null!==(r=(null!==(t=qo.parse(window.location.search))&&void 0!==t?t:{})[e])&&void 0!==r?r:""},jo=()=>{if(Do()){const e=Fo("project")||(null==Ko?void 0:Ko.project);if(e)return e}const e=Do()?2:1;return new URL(window.location.href).pathname.split("/")[e]},Bo=()=>{const e=Fo("cluster")||(null==Ko?void 0:Ko.cluster);return Array.isArray(e)?e[0]:e},Go=()=>{const e=Fo("env");return Array.isArray(e)?e[0]:e},Wo=(e,t="https")=>{let r=e;return e.substr(0,t.length)!==t&&(r=`${t}://${e}`),r};function zo(){var t;return e(this,void 0,void 0,(function*(){if(Do()){let e=(0,r.readLoginHints)();if(!e)return Promise.reject(new Error("Missing login hints"));if(!(null==e?void 0:e.organization))return Promise.reject(new Error("Missing organization"));const t=yield(0,r.getDlc)(null==e?void 0:e.organization),n=(0,r.getIdp)(t.idps,null==e?void 0:e.idpInternalId);return n||Promise.reject(new Error("IDP not found"))}const{internalId:e}=null!==(t=c())&&void 0!==t?t:{},{idps:n=[],legacyProjects:o=[]}=yield fetch("/_api/login_info").then((e=>e.json()));if(!e&&1===n.length)return n[0];if(!e)return Promise.reject(new Error("IDP not selected"));const i=n.find((t=>t.internalId===e))||o.find((t=>t.internalId===e));return i||Promise.reject(new Error("IDP not found"))}))}const Yo=()=>e(void 0,void 0,void 0,(function*(){const t=Bo();if(t)return Wo(t);const r=yield e(void 0,void 0,void 0,(function*(){try{const e=yield zo(),t="COGNITE_AUTH"!==e.type?null==e?void 0:e.clusters:void 0;return 1===(null==t?void 0:t.length)?t[0]:void 0}catch(_h){return}}));return r?Wo(r):Promise.reject(new Error("cluster not found"))}));class WrappedSdkClient{constructor(e){this.instance=e}overrideInstance(e){this.instance=e}}const Vo=(e,t)=>({clientId:t,authority:e,redirectUri:`https://${window.location.host}`}),Jo={cacheLocation:"localStorage",storeAuthStateInCookie:!1};var Xo=n(9675);const Zo=Bo(),Qo=Go(),$o=jo(),ei=()=>`cognite-app-adfs-access-token_${null!=Zo?Zo:Qo}_${$o}`;function ti(t,r){return e(this,void 0,void 0,(function*(){const n=ei(),o=sessionStorage.getItem(n),i=yield Yo();if(o)try{const e=`${i}/api/v1/token/inspect`,t=yield fetch(e,{headers:{Authorization:`Bearer ${o}`}}).then((e=>200===e.status?e.json():Promise.reject(new Error("invalid token"))));if(t.subject)return o;throw new Error("expired token")}catch(ni){sessionStorage.removeItem(n)}return function(t,r){return e(this,void 0,void 0,(function*(){const e=yield Yo(),n=new Xo.ADFS({authority:t,requestParams:{clientId:r,resource:e}}),o=yield n.getCDFToken();if(!o){const e=yield n.login();return e||Promise.reject(new Error("token not found"))}return sessionStorage.setItem(ei(),o),o}))}(t,r)}))}function ri(t){return e(this,void 0,void 0,(function*(){localStorage.removeItem(s),sessionStorage.clear(),window.location.href=`${t}/logout`}))}var ni=function(e,t){return ni=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},ni(e,t)};function oi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ni(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var ii=function(){return ii=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ii.apply(this,arguments)};function si(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function ai(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function ci(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function ui(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function li(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}var di="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function hi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function pi(e,t){return e(t={exports:{}},t.exports),t.exports}var fi,gi,mi=function(e){return e&&e.Math==Math&&e},yi=mi("object"==typeof globalThis&&globalThis)||mi("object"==typeof window&&window)||mi("object"==typeof self&&self)||mi("object"==typeof di&&di)||function(){return this}()||Function("return this")(),vi=function(e){try{return!!e()}catch(e){return!0}},_i=!vi((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),wi=!vi((function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),bi=Function.prototype.call,Ei=wi?bi.bind(bi):function(){return bi.apply(bi,arguments)},Ci={}.propertyIsEnumerable,Si=Object.getOwnPropertyDescriptor,Ti=Si&&!Ci.call({1:2},1)?function(e){var t=Si(this,e);return!!t&&t.enumerable}:Ci,Ii={f:Ti},ki=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Ai=Function.prototype,Ri=Ai.bind,Pi=Ai.call,Oi=wi&&Ri.bind(Pi,Pi),Ni=wi?function(e){return e&&Oi(e)}:function(e){return e&&function(){return Pi.apply(e,arguments)}},Ui=Ni({}.toString),Mi=Ni("".slice),xi=function(e){return Mi(Ui(e),8,-1)},qi=yi.Object,Hi=Ni("".split),Li=vi((function(){return!qi("z").propertyIsEnumerable(0)}))?function(e){return"String"==xi(e)?Hi(e,""):qi(e)}:qi,Di=yi.TypeError,Ki=function(e){if(null==e)throw Di("Can't call method on "+e);return e},Fi=function(e){return Li(Ki(e))},ji=function(e){return"function"==typeof e},Bi=function(e){return"object"==typeof e?null!==e:ji(e)},Gi=function(e){return ji(e)?e:void 0},Wi=function(e,t){return arguments.length<2?Gi(yi[e]):yi[e]&&yi[e][t]},zi=Ni({}.isPrototypeOf),Yi=Wi("navigator","userAgent")||"",Vi=yi.process,Ji=yi.Deno,Xi=Vi&&Vi.versions||Ji&&Ji.version,Zi=Xi&&Xi.v8;Zi&&(gi=(fi=Zi.split("."))[0]>0&&fi[0]<4?1:+(fi[0]+fi[1])),!gi&&Yi&&(!(fi=Yi.match(/Edge\/(\d+)/))||fi[1]>=74)&&(fi=Yi.match(/Chrome\/(\d+)/))&&(gi=+fi[1]);var Qi=gi,$i=!!Object.getOwnPropertySymbols&&!vi((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Qi&&Qi<41})),es=$i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ts=yi.Object,rs=es?function(e){return"symbol"==typeof e}:function(e){var t=Wi("Symbol");return ji(t)&&zi(t.prototype,ts(e))},ns=yi.String,os=function(e){try{return ns(e)}catch(e){return"Object"}},is=yi.TypeError,ss=function(e){if(ji(e))return e;throw is(os(e)+" is not a function")},as=function(e,t){var r=e[t];return null==r?void 0:ss(r)},cs=yi.TypeError,us=Object.defineProperty,ls=function(e,t){try{us(yi,e,{value:t,configurable:!0,writable:!0})}catch(ii){yi[e]=t}return t},ds=yi["__core-js_shared__"]||ls("__core-js_shared__",{}),hs=pi((function(e){(e.exports=function(e,t){return ds[e]||(ds[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.0",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),ps=yi.Object,fs=function(e){return ps(Ki(e))},gs=Ni({}.hasOwnProperty),ms=Object.hasOwn||function(e,t){return gs(fs(e),t)},ys=0,vs=Math.random(),_s=Ni(1..toString),ws=function(e){return"Symbol("+(void 0===e?"":e)+")_"+_s(++ys+vs,36)},bs=hs("wks"),Es=yi.Symbol,Cs=Es&&Es.for,Ss=es?Es:Es&&Es.withoutSetter||ws,Ts=function(e){if(!ms(bs,e)||!$i&&"string"!=typeof bs[e]){var t="Symbol."+e;$i&&ms(Es,e)?bs[e]=Es[e]:bs[e]=es&&Cs?Cs(t):Ss(t)}return bs[e]},Is=yi.TypeError,ks=Ts("toPrimitive"),As=function(e){var t=function(e,t){if(!Bi(e)||rs(e))return e;var r,n=as(e,ks);if(n){if(void 0===t&&(t="default"),r=Ei(n,e,t),!Bi(r)||rs(r))return r;throw Is("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,n;if("string"===t&&ji(r=e.toString)&&!Bi(n=Ei(r,e)))return n;if(ji(r=e.valueOf)&&!Bi(n=Ei(r,e)))return n;if("string"!==t&&ji(r=e.toString)&&!Bi(n=Ei(r,e)))return n;throw cs("Can't convert object to primitive value")}(e,t)}(e,"string");return rs(t)?t:t+""},Rs=yi.document,Ps=Bi(Rs)&&Bi(Rs.createElement),Os=function(e){return Ps?Rs.createElement(e):{}},Ns=!_i&&!vi((function(){return 7!=Object.defineProperty(Os("div"),"a",{get:function(){return 7}}).a})),Us=Object.getOwnPropertyDescriptor,Ms={f:_i?Us:function(e,t){if(e=Fi(e),t=As(t),Ns)try{return Us(e,t)}catch(e){}if(ms(e,t))return ki(!Ei(Ii.f,e,t),e[t])}},xs=_i&&vi((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),qs=yi.String,Hs=yi.TypeError,Ls=function(e){if(Bi(e))return e;throw Hs(qs(e)+" is not an object")},Ds=yi.TypeError,Ks=Object.defineProperty,Fs=Object.getOwnPropertyDescriptor,js={f:_i?xs?function(e,t,r){if(Ls(e),t=As(t),Ls(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var n=Fs(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return Ks(e,t,r)}:Ks:function(e,t,r){if(Ls(e),t=As(t),Ls(r),Ns)try{return Ks(e,t,r)}catch(e){}if("get"in r||"set"in r)throw Ds("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},Bs=_i?function(e,t,r){return js.f(e,t,ki(1,r))}:function(e,t,r){return e[t]=r,e},Gs=Ni(Function.toString);ji(ds.inspectSource)||(ds.inspectSource=function(e){return Gs(e)});var Ws,zs,Ys,Vs=ds.inspectSource,Js=yi.WeakMap,Xs=ji(Js)&&/native code/.test(Vs(Js)),Zs=hs("keys"),Qs=function(e){return Zs[e]||(Zs[e]=ws(e))},$s={},ea=yi.TypeError,ta=yi.WeakMap;if(Xs||ds.state){var ra=ds.state||(ds.state=new ta),na=Ni(ra.get),oa=Ni(ra.has),ia=Ni(ra.set);Ws=function(e,t){if(oa(ra,e))throw new ea("Object already initialized");return t.facade=e,ia(ra,e,t),t},zs=function(e){return na(ra,e)||{}},Ys=function(e){return oa(ra,e)}}else{var sa=Qs("state");$s[sa]=!0,Ws=function(e,t){if(ms(e,sa))throw new ea("Object already initialized");return t.facade=e,Bs(e,sa,t),t},zs=function(e){return ms(e,sa)?e[sa]:{}},Ys=function(e){return ms(e,sa)}}var aa={set:Ws,get:zs,has:Ys,enforce:function(e){return Ys(e)?zs(e):Ws(e,{})},getterFor:function(e){return function(t){var r;if(!Bi(t)||(r=zs(t)).type!==e)throw ea("Incompatible receiver, "+e+" required");return r}}},ca=Function.prototype,ua=_i&&Object.getOwnPropertyDescriptor,la=ms(ca,"name"),da={EXISTS:la,PROPER:la&&"something"===(function(){}).name,CONFIGURABLE:la&&(!_i||_i&&ua(ca,"name").configurable)},ha=pi((function(e){var t=da.CONFIGURABLE,r=aa.get,n=aa.enforce,o=String(String).split("String");(e.exports=function(e,r,i,s){var a,c=!!s&&!!s.unsafe,g=!!s&&!!s.enumerable,y=!!s&&!!s.noTargetGet,v=s&&void 0!==s.name?s.name:r;ji(i)&&("Symbol("===String(v).slice(0,7)&&(v="["+String(v).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!ms(i,"name")||t&&i.name!==v)&&Bs(i,"name",v),(a=n(i)).source||(a.source=o.join("string"==typeof v?v:""))),e!==yi?(c?!y&&e[r]&&(g=!0):delete e[r],g?e[r]=i:Bs(e,r,i)):g?e[r]=i:ls(r,i)})(Function.prototype,"toString",(function(){return ji(this)&&r(this).source||Vs(this)}))})),pa=Math.ceil,fa=Math.floor,ga=function(e){var t=+e;return t!=t||0===t?0:(t>0?fa:pa)(t)},ma=Math.max,ya=Math.min,va=function(e,t){var r=ga(e);return r<0?ma(r+t,0):ya(r,t)},_a=Math.min,wa=function(e){return e>0?_a(ga(e),9007199254740991):0},ba=function(e){return wa(e.length)},Ea=function(e){return function(t,r,n){var o,i=Fi(t),s=ba(i),a=va(n,s);if(e&&r!=r){for(;s>a;)if((o=i[a++])!=o)return!0}else for(;s>a;a++)if((e||a in i)&&i[a]===r)return e||a||0;return!e&&-1}},Ca={includes:Ea(!0),indexOf:Ea(!1)},Sa=Ca.indexOf,Ta=Ni([].push),Ia=function(e,t){var r,n=Fi(e),o=0,i=[];for(r in n)!ms($s,r)&&ms(n,r)&&Ta(i,r);for(;t.length>o;)ms(n,r=t[o++])&&(~Sa(i,r)||Ta(i,r));return i},ka=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Aa=ka.concat("length","prototype"),Ra={f:Object.getOwnPropertyNames||function(e){return Ia(e,Aa)}},Pa={f:Object.getOwnPropertySymbols},Oa=Ni([].concat),Na=Wi("Reflect","ownKeys")||function(e){var t=Ra.f(Ls(e)),r=Pa.f;return r?Oa(t,r(e)):t},Ua=function(e,t,r){for(var n=Na(t),o=js.f,i=Ms.f,s=0;s<n.length;s++){var a=n[s];ms(e,a)||r&&ms(r,a)||o(e,a,i(t,a))}},Ma=/#|\.prototype\./,xa=function(e,t){var r=Ha[qa(e)];return r==Da||r!=La&&(ji(t)?vi(t):!!t)},qa=xa.normalize=function(e){return String(e).replace(Ma,".").toLowerCase()},Ha=xa.data={},La=xa.NATIVE="N",Da=xa.POLYFILL="P",Ka=xa,Fa=Ms.f,ja=function(e,t){var r,n,o,i,s,a=e.target,c=e.global,g=e.stat;if(r=c?yi:g?yi[a]||ls(a,{}):(yi[a]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(s=Fa(r,n))&&s.value:r[n],!Ka(c?n:a+(g?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ua(i,o)}(e.sham||o&&o.sham)&&Bs(i,"sham",!0),ha(r,n,i,e)}},Ba={};Ba[Ts("toStringTag")]="z";var Ga,Wa="[object z]"===String(Ba),za=Ts("toStringTag"),Ya=yi.Object,Va="Arguments"==xi(function(){return arguments}()),Ja=Wa?xi:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Ya(e),za))?r:Va?xi(t):"Object"==(n=xi(t))&&ji(t.callee)?"Arguments":n},Xa=yi.String,Za=function(e){if("Symbol"===Ja(e))throw TypeError("Cannot convert a Symbol value to a string");return Xa(e)},Qa=Ts("match"),$a=yi.TypeError,ec=function(e){if(function(e){var t;return Bi(e)&&(void 0!==(t=e[Qa])?!!t:"RegExp"==xi(e))}(e))throw $a("The method doesn't accept regular expressions");return e},tc=Ts("match"),rc=function(e){var t=/./;try{"/./"[e](t)}catch(ii){try{return t[tc]=!1,"/./"[e](t)}catch(e){}}return!1},nc=Ms.f,oc=Ni("".startsWith),ic=Ni("".slice),sc=Math.min,ac=rc("startsWith"),cc=!(ac||(Ga=nc(String.prototype,"startsWith"),!Ga||Ga.writable));ja({target:"String",proto:!0,forced:!cc&&!ac},{startsWith:function(e){var t=Za(Ki(this));ec(e);var r=wa(sc(arguments.length>1?arguments[1]:void 0,t.length)),n=Za(e);return oc?oc(t,n,r):ic(t,r,r+n.length)===n}});var uc=function(e,t){return Ni(yi[e].prototype[t])};uc("String","startsWith");var lc=Array.isArray||function(e){return"Array"==xi(e)},dc=function(e,t,r){var n=As(t);n in e?js.f(e,n,ki(0,r)):e[n]=r},hc=function(){},pc=[],fc=Wi("Reflect","construct"),gc=/^\s*(?:class|function)\b/,mc=Ni(gc.exec),yc=!gc.exec(hc),vc=function(e){if(!ji(e))return!1;try{return fc(hc,pc,e),!0}catch(e){return!1}},_c=function(e){if(!ji(e))return!1;switch(Ja(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return yc||!!mc(gc,Vs(e))}catch(e){return!0}};_c.sham=!0;var wc=!fc||vi((function(){var e;return vc(vc.call)||!vc(Object)||!vc((function(){e=!0}))||e}))?_c:vc,bc=Ts("species"),Ec=yi.Array,Cc=function(e,t){return new(function(e){var t;return lc(e)&&(t=e.constructor,(wc(t)&&(t===Ec||lc(t.prototype))||Bi(t)&&null===(t=t[bc]))&&(t=void 0)),void 0===t?Ec:t}(e))(0===t?0:t)},Sc=Ts("species"),Tc=Ts("isConcatSpreadable"),Ic=yi.TypeError,kc=Qi>=51||!vi((function(){var e=[];return e[Tc]=!1,e.concat()[0]!==e})),Ac=("concat",Qi>=51||!vi((function(){var e=[];return(e.constructor={})[Sc]=function(){return{foo:1}},1!==e.concat(Boolean).foo}))),Rc=function(e){if(!Bi(e))return!1;var t=e[Tc];return void 0!==t?!!t:lc(e)};ja({target:"Array",proto:!0,forced:!kc||!Ac},{concat:function(e){var t,r,n,o,i,s=fs(this),a=Cc(s,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(Rc(i=-1===t?s:arguments[t])){if(c+(o=ba(i))>9007199254740991)throw Ic("Maximum allowed index exceeded");for(r=0;r<o;r++,c++)r in i&&dc(a,c,i[r])}else{if(c>=9007199254740991)throw Ic("Maximum allowed index exceeded");dc(a,c++,i)}return a.length=c,a}});var Pc=Wa?{}.toString:function(){return"[object "+Ja(this)+"]"};Wa||ha(Object.prototype,"toString",Pc,{unsafe:!0});var Oc,Nc=Function.prototype,Uc=Nc.apply,Mc=Nc.call,xc="object"==typeof Reflect&&Reflect.apply||(wi?Mc.bind(Uc):function(){return Mc.apply(Uc,arguments)}),qc=Object.keys||function(e){return Ia(e,ka)},Hc=_i&&!xs?Object.defineProperties:function(e,t){Ls(e);for(var r,n=Fi(t),o=qc(t),i=o.length,s=0;i>s;)js.f(e,r=o[s++],n[r]);return e},Lc={f:Hc},Dc=Wi("document","documentElement"),Kc=Qs("IE_PROTO"),Fc=function(){},jc=function(e){return"<script>"+e+"<\/script>"},Bc=function(e){e.write(jc("")),e.close();var t=e.parentWindow.Object;return e=null,t},Gc=function(){try{Oc=new ActiveXObject("htmlfile")}catch(e){}var e,t;Gc="undefined"!=typeof document?document.domain&&Oc?Bc(Oc):((t=Os("iframe")).style.display="none",Dc.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(jc("document.F=Object")),e.close(),e.F):Bc(Oc);for(var r=ka.length;r--;)delete Gc.prototype[ka[r]];return Gc()};$s[Kc]=!0;var Wc=Object.create||function(e,t){var r;return null!==e?(Fc.prototype=Ls(e),r=new Fc,Fc.prototype=null,r[Kc]=e):r=Gc(),void 0===t?r:Lc.f(r,t)},zc=yi.Array,Yc=Math.max,Vc=Ra.f,Jc="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Xc={f:function(e){return Jc&&"Window"==xi(e)?function(e){try{return Vc(e)}catch(e){return function(e,t,r){for(var n=ba(e),o=va(void 0,n),i=va(n,n),s=zc(Yc(i-o,0)),a=0;o<i;o++,a++)dc(s,a,e[o]);return s.length=a,s}(Jc)}}(e):Vc(Fi(e))}},Zc=Ni([].slice),Qc={f:Ts},$c=yi,eu=js.f,tu=function(e){var t=$c.Symbol||($c.Symbol={});ms(t,e)||eu(t,e,{value:Qc.f(e)})},ru=js.f,nu=Ts("toStringTag"),ou=function(e,t,r){e&&!r&&(e=e.prototype),e&&!ms(e,nu)&&ru(e,nu,{configurable:!0,value:t})},iu=Ni(Ni.bind),su=function(e,t){return ss(e),void 0===t?e:wi?iu(e,t):function(){return e.apply(t,arguments)}},au=Ni([].push),cu=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,i=6==e,s=7==e,a=5==e||i;return function(c,g,y,v){for(var _,w,b=fs(c),E=Li(b),S=su(g,y),T=ba(E),I=0,k=v||Cc,A=t?k(c,T):r||s?k(c,0):void 0;T>I;I++)if((a||I in E)&&(w=S(_=E[I],I,b),e))if(t)A[I]=w;else if(w)switch(e){case 3:return!0;case 5:return _;case 6:return I;case 2:au(A,_)}else switch(e){case 4:return!1;case 7:au(A,_)}return i?-1:n||o?o:A}},uu=[cu(0),cu(1),cu(2),cu(3),cu(4),cu(5),cu(6),cu(7)][0],lu=Qs("hidden"),du=Ts("toPrimitive"),hu=aa.set,pu=aa.getterFor("Symbol"),fu=Object.prototype,gu=yi.Symbol,mu=gu&&gu.prototype,yu=yi.TypeError,vu=yi.QObject,_u=Wi("JSON","stringify"),wu=Ms.f,bu=js.f,Eu=Xc.f,Cu=Ii.f,Su=Ni([].push),Tu=hs("symbols"),Iu=hs("op-symbols"),ku=hs("string-to-symbol-registry"),Au=hs("symbol-to-string-registry"),Ru=hs("wks"),Pu=!vu||!vu.prototype||!vu.prototype.findChild,Ou=_i&&vi((function(){return 7!=Wc(bu({},"a",{get:function(){return bu(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=wu(fu,t);n&&delete fu[t],bu(e,t,r),n&&e!==fu&&bu(fu,t,n)}:bu,Nu=function(e,t){var r=Tu[e]=Wc(mu);return hu(r,{type:"Symbol",tag:e,description:t}),_i||(r.description=t),r},Uu=function(e,t,r){e===fu&&Uu(Iu,t,r),Ls(e);var n=As(t);return Ls(r),ms(Tu,n)?(r.enumerable?(ms(e,lu)&&e[lu][n]&&(e[lu][n]=!1),r=Wc(r,{enumerable:ki(0,!1)})):(ms(e,lu)||bu(e,lu,ki(1,{})),e[lu][n]=!0),Ou(e,n,r)):bu(e,n,r)},Mu=function(e,t){Ls(e);var r=Fi(t),n=qc(r).concat(Lu(r));return uu(n,(function(t){_i&&!Ei(xu,r,t)||Uu(e,t,r[t])})),e},xu=function(e){var t=As(e),r=Ei(Cu,this,t);return!(this===fu&&ms(Tu,t)&&!ms(Iu,t))&&(!(r||!ms(this,t)||!ms(Tu,t)||ms(this,lu)&&this[lu][t])||r)},qu=function(e,t){var r=Fi(e),n=As(t);if(r!==fu||!ms(Tu,n)||ms(Iu,n)){var o=wu(r,n);return!o||!ms(Tu,n)||ms(r,lu)&&r[lu][n]||(o.enumerable=!0),o}},Hu=function(e){var t=Eu(Fi(e)),r=[];return uu(t,(function(e){ms(Tu,e)||ms($s,e)||Su(r,e)})),r},Lu=function(e){var t=e===fu,r=Eu(t?Iu:Fi(e)),n=[];return uu(r,(function(e){!ms(Tu,e)||t&&!ms(fu,e)||Su(n,Tu[e])})),n};if($i||(mu=(gu=function(){if(zi(mu,this))throw yu("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?Za(arguments[0]):void 0,t=ws(e),r=function(e){this===fu&&Ei(r,Iu,e),ms(this,lu)&&ms(this[lu],t)&&(this[lu][t]=!1),Ou(this,t,ki(1,e))};return _i&&Pu&&Ou(fu,t,{configurable:!0,set:r}),Nu(t,e)}).prototype,ha(mu,"toString",(function(){return pu(this).tag})),ha(gu,"withoutSetter",(function(e){return Nu(ws(e),e)})),Ii.f=xu,js.f=Uu,Lc.f=Mu,Ms.f=qu,Ra.f=Xc.f=Hu,Pa.f=Lu,Qc.f=function(e){return Nu(Ts(e),e)},_i&&(bu(mu,"description",{configurable:!0,get:function(){return pu(this).description}}),ha(fu,"propertyIsEnumerable",xu,{unsafe:!0}))),ja({global:!0,wrap:!0,forced:!$i,sham:!$i},{Symbol:gu}),uu(qc(Ru),(function(e){tu(e)})),ja({target:"Symbol",stat:!0,forced:!$i},{for:function(e){var t=Za(e);if(ms(ku,t))return ku[t];var r=gu(t);return ku[t]=r,Au[r]=t,r},keyFor:function(e){if(!rs(e))throw yu(e+" is not a symbol");if(ms(Au,e))return Au[e]},useSetter:function(){Pu=!0},useSimple:function(){Pu=!1}}),ja({target:"Object",stat:!0,forced:!$i,sham:!_i},{create:function(e,t){return void 0===t?Wc(e):Mu(Wc(e),t)},defineProperty:Uu,defineProperties:Mu,getOwnPropertyDescriptor:qu}),ja({target:"Object",stat:!0,forced:!$i},{getOwnPropertyNames:Hu,getOwnPropertySymbols:Lu}),ja({target:"Object",stat:!0,forced:vi((function(){Pa.f(1)}))},{getOwnPropertySymbols:function(e){return Pa.f(fs(e))}}),_u){var Du=!$i||vi((function(){var e=gu();return"[null]"!=_u([e])||"{}"!=_u({a:e})||"{}"!=_u(Object(e))}));ja({target:"JSON",stat:!0,forced:Du},{stringify:function(e,t,r){var n=Zc(arguments),o=t;if((Bi(t)||void 0!==e)&&!rs(e))return lc(t)||(t=function(e,t){if(ji(o)&&(t=Ei(o,this,e,t)),!rs(t))return t}),n[1]=t,xc(_u,null,n)}})}if(!mu[du]){var Ku=mu.valueOf;ha(mu,du,(function(e){return Ei(Ku,this)}))}ou(gu,"Symbol"),$s[lu]=!0,tu("asyncIterator");var Fu=js.f,ju=yi.Symbol,Bu=ju&&ju.prototype;if(_i&&ji(ju)&&(!("description"in Bu)||void 0!==ju().description)){var Gu={},Wu=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:Za(arguments[0]),t=zi(Bu,this)?new ju(e):void 0===e?ju():ju(e);return""===e&&(Gu[t]=!0),t};Ua(Wu,ju),Wu.prototype=Bu,Bu.constructor=Wu;var zu="Symbol(test)"==String(ju("test")),Yu=Ni(Bu.toString),Vu=Ni(Bu.valueOf),Ju=/^Symbol\((.*)\)[^)]+$/,Xu=Ni("".replace),Zu=Ni("".slice);Fu(Bu,"description",{configurable:!0,get:function(){var e=Vu(this),t=Yu(e);if(ms(Gu,e))return"";var r=zu?Zu(t,7,-1):Xu(t,Ju,"$1");return""===r?void 0:r}}),ja({global:!0,forced:!0},{Symbol:Wu})}tu("hasInstance"),tu("isConcatSpreadable"),tu("iterator"),tu("match"),tu("matchAll"),tu("replace"),tu("search"),tu("species"),tu("split"),tu("toPrimitive"),tu("toStringTag"),tu("unscopables"),ou(yi.JSON,"JSON",!0),ou(Math,"Math",!0),ja({global:!0},{Reflect:{}}),ou(yi.Reflect,"Reflect",!0),$c.Symbol;var Qu,$u,el,tl=Ni("".charAt),rl=Ni("".charCodeAt),nl=Ni("".slice),ol=function(e){return function(t,r){var n,o,i=Za(Ki(t)),s=ga(r),a=i.length;return s<0||s>=a?e?"":void 0:(n=rl(i,s))<55296||n>56319||s+1===a||(o=rl(i,s+1))<56320||o>57343?e?tl(i,s):n:e?nl(i,s,s+2):o-56320+(n-55296<<10)+65536}},il={codeAt:ol(!1),charAt:ol(!0)},sl=!vi((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),al=Qs("IE_PROTO"),cl=yi.Object,ul=cl.prototype,ll=sl?cl.getPrototypeOf:function(e){var t=fs(e);if(ms(t,al))return t[al];var r=t.constructor;return ji(r)&&t instanceof r?r.prototype:t instanceof cl?ul:null},dl=Ts("iterator"),hl=!1;[].keys&&("next"in(el=[].keys())?($u=ll(ll(el)))!==Object.prototype&&(Qu=$u):hl=!0);var pl=null==Qu||vi((function(){var e={};return Qu[dl].call(e)!==e}));pl&&(Qu={}),ji(Qu[dl])||ha(Qu,dl,(function(){return this}));var fl={IteratorPrototype:Qu,BUGGY_SAFARI_ITERATORS:hl},gl={},ml=fl.IteratorPrototype,yl=function(){return this},vl=yi.String,_l=yi.TypeError,wl=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Ni(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return Ls(r),function(e){if("object"==typeof e||ji(e))return e;throw _l("Can't set "+vl(e)+" as a prototype")}(n),t?e(r,n):r.__proto__=n,r}}():void 0),bl=da.PROPER,El=da.CONFIGURABLE,Cl=fl.IteratorPrototype,Sl=fl.BUGGY_SAFARI_ITERATORS,Tl=Ts("iterator"),Il=function(){return this},kl=function(e,t,r,n,o,i,s){!function(e,t,r,n){var o=t+" Iterator";e.prototype=Wc(ml,{next:ki(1,r)}),ou(e,o,!1),gl[o]=yl}(r,t,n);var a,c,g,y=function(e){if(e===o&&E)return E;if(!Sl&&e in w)return w[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},v=t+" Iterator",_=!1,w=e.prototype,b=w[Tl]||w["@@iterator"]||o&&w[o],E=!Sl&&b||y(o),S="Array"==t&&w.entries||b;if(S&&(a=ll(S.call(new e)))!==Object.prototype&&a.next&&(ll(a)!==Cl&&(wl?wl(a,Cl):ji(a[Tl])||ha(a,Tl,Il)),ou(a,v,!0)),bl&&"values"==o&&b&&"values"!==b.name&&(El?Bs(w,"name","values"):(_=!0,E=function(){return Ei(b,this)})),o)if(c={values:y("values"),keys:i?E:y("keys"),entries:y("entries")},s)for(g in c)(Sl||_||!(g in w))&&ha(w,g,c[g]);else ja({target:t,proto:!0,forced:Sl||_},c);return w[Tl]!==E&&ha(w,Tl,E,{name:o}),gl[t]=E,c},Al=il.charAt,Rl=aa.set,Pl=aa.getterFor("String Iterator");kl(String,"String",(function(e){Rl(this,{type:"String Iterator",string:Za(e),index:0})}),(function(){var e,t=Pl(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Al(r,n),t.index+=e.length,{value:e,done:!1})}));var Ol=function(e,t,r){var n,o;Ls(e);try{if(!(n=as(e,"return"))){if("throw"===t)throw r;return r}n=Ei(n,e)}catch(e){o=!0,n=e}if("throw"===t)throw r;if(o)throw n;return Ls(n),r},Nl=function(e,t,r,n){try{return n?t(Ls(r)[0],r[1]):t(r)}catch(t){Ol(e,"throw",t)}},Ul=Ts("iterator"),Ml=Array.prototype,xl=function(e){return void 0!==e&&(gl.Array===e||Ml[Ul]===e)},ql=Ts("iterator"),Hl=function(e){if(null!=e)return as(e,ql)||as(e,"@@iterator")||gl[Ja(e)]},Ll=yi.TypeError,Dl=function(e,t){var r=arguments.length<2?Hl(e):t;if(ss(r))return Ls(Ei(r,e));throw Ll(os(e)+" is not iterable")},Kl=yi.Array,Fl=Ts("iterator"),jl=!1;try{var Bl=0,Gl={next:function(){return{done:!!Bl++}},return:function(){jl=!0}};Gl[Fl]=function(){return this},Array.from(Gl,(function(){throw 2}))}catch(ni){}var Wl=function(e,t){if(!t&&!jl)return!1;var r=!1;try{var n={};n[Fl]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},zl=!Wl((function(e){Array.from(e)}));ja({target:"Array",stat:!0,forced:zl},{from:function(e){var t=fs(e),r=wc(this),n=arguments.length,o=n>1?arguments[1]:void 0,i=void 0!==o;i&&(o=su(o,n>2?arguments[2]:void 0));var s,a,c,g,y,v,_=Hl(t),w=0;if(!_||this==Kl&&xl(_))for(s=ba(t),a=r?new this(s):Kl(s);s>w;w++)v=i?o(t[w],w):t[w],dc(a,w,v);else for(y=(g=Dl(t,_)).next,a=r?new this:[];!(c=Ei(y,g)).done;w++)v=i?Nl(g,o,[c.value,w],!0):c.value,dc(a,w,v);return a.length=w,a}}),$c.Array.from;var Yl,Vl,Jl,Xl="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Zl=js.f,Ql=yi.Int8Array,$l=Ql&&Ql.prototype,ed=yi.Uint8ClampedArray,td=ed&&ed.prototype,rd=Ql&&ll(Ql),nd=$l&&ll($l),od=Object.prototype,id=yi.TypeError,sd=Ts("toStringTag"),ad=ws("TYPED_ARRAY_TAG"),cd=ws("TYPED_ARRAY_CONSTRUCTOR"),ud=Xl&&!!wl&&"Opera"!==Ja(yi.opera),ld=!1,dd={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},hd={BigInt64Array:8,BigUint64Array:8},pd=function(e){if(!Bi(e))return!1;var t=Ja(e);return ms(dd,t)||ms(hd,t)};for(Yl in dd)(Jl=(Vl=yi[Yl])&&Vl.prototype)?Bs(Jl,cd,Vl):ud=!1;for(Yl in hd)(Jl=(Vl=yi[Yl])&&Vl.prototype)&&Bs(Jl,cd,Vl);if((!ud||!ji(rd)||rd===Function.prototype)&&(rd=function(){throw id("Incorrect invocation")},ud))for(Yl in dd)yi[Yl]&&wl(yi[Yl],rd);if((!ud||!nd||nd===od)&&(nd=rd.prototype,ud))for(Yl in dd)yi[Yl]&&wl(yi[Yl].prototype,nd);if(ud&&ll(td)!==nd&&wl(td,nd),_i&&!ms(nd,sd))for(Yl in ld=!0,Zl(nd,sd,{get:function(){return Bi(this)?this[ad]:void 0}}),dd)yi[Yl]&&Bs(yi[Yl],ad,Yl);var fd={NATIVE_ARRAY_BUFFER_VIEWS:ud,TYPED_ARRAY_CONSTRUCTOR:cd,TYPED_ARRAY_TAG:ld&&ad,aTypedArray:function(e){if(pd(e))return e;throw id("Target is not a typed array")},aTypedArrayConstructor:function(e){if(ji(e)&&(!wl||zi(rd,e)))return e;throw id(os(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(_i){if(r)for(var o in dd){var i=yi[o];if(i&&ms(i.prototype,e))try{delete i.prototype[e]}catch(r){try{i.prototype[e]=t}catch(e){}}}nd[e]&&!r||ha(nd,e,r?t:ud&&$l[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,o;if(_i){if(wl){if(r)for(n in dd)if((o=yi[n])&&ms(o,e))try{delete o[e]}catch(e){}if(rd[e]&&!r)return;try{return ha(rd,e,r?t:ud&&rd[e]||t)}catch(e){}}for(n in dd)!(o=yi[n])||o[e]&&!r||ha(o,e,t)}},isView:function(e){if(!Bi(e))return!1;var t=Ja(e);return"DataView"===t||ms(dd,t)||ms(hd,t)},isTypedArray:pd,TypedArray:rd,TypedArrayPrototype:nd},gd=yi.TypeError,md=Ts("species"),yd=fd.TYPED_ARRAY_CONSTRUCTOR,vd=fd.aTypedArrayConstructor,_d=fd.aTypedArray;(0,fd.exportTypedArrayMethod)("slice",(function(e,t){for(var r=Zc(_d(this),e,t),n=vd(function(e,t){var r,n=Ls(e).constructor;return void 0===n||null==(r=Ls(n)[md])?t:function(e){if(wc(e))return e;throw gd(os(e)+" is not a constructor")}(r)}(this,this[yd])),o=0,i=r.length,s=new n(i);i>o;)s[o]=r[o++];return s}),vi((function(){new Int8Array(1).slice()})));var wd=Ts("unscopables"),bd=Array.prototype;null==bd[wd]&&js.f(bd,wd,{configurable:!0,value:Wc(null)});var Ed=function(e){bd[wd][e]=!0},Cd=Ca.includes;ja({target:"Array",proto:!0},{includes:function(e){return Cd(this,e,arguments.length>1?arguments[1]:void 0)}}),Ed("includes"),uc("Array","includes");var Sd=Ni("".indexOf);ja({target:"String",proto:!0,forced:!rc("includes")},{includes:function(e){return!!~Sd(Za(Ki(this)),Za(ec(e)),arguments.length>1?arguments[1]:void 0)}}),uc("String","includes");var Td=js.f,Id=aa.set,kd=aa.getterFor("Array Iterator");kl(Array,"Array",(function(e,t){Id(this,{type:"Array Iterator",target:Fi(e),index:0,kind:t})}),(function(){var e=kd(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");var Ad=gl.Arguments=gl.Array;if(Ed("keys"),Ed("values"),Ed("entries"),_i&&"values"!==Ad.name)try{Td(Ad,"name",{value:"values"})}catch(ni){}var Rd=vi((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),Pd=Object.isExtensible,Od=vi((function(){Pd(1)}))||Rd?function(e){return!!Bi(e)&&(!Rd||"ArrayBuffer"!=xi(e))&&(!Pd||Pd(e))}:Pd,Nd=!vi((function(){return Object.isExtensible(Object.preventExtensions({}))})),Ud=pi((function(e){var t=js.f,r=!1,n=ws("meta"),o=0,i=function(e){t(e,n,{value:{objectID:"O"+o++,weakData:{}}})},s=e.exports={enable:function(){s.enable=function(){},r=!0;var e=Ra.f,t=Ni([].splice),o={};o[n]=1,e(o).length&&(Ra.f=function(r){for(var o=e(r),i=0,s=o.length;i<s;i++)if(o[i]===n){t(o,i,1);break}return o},ja({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Xc.f}))},fastKey:function(e,t){if(!Bi(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!ms(e,n)){if(!Od(e))return"F";if(!t)return"E";i(e)}return e[n].objectID},getWeakData:function(e,t){if(!ms(e,n)){if(!Od(e))return!0;if(!t)return!1;i(e)}return e[n].weakData},onFreeze:function(e){return Nd&&r&&Od(e)&&!ms(e,n)&&i(e),e}};$s[n]=!0}));Ud.enable,Ud.fastKey,Ud.getWeakData,Ud.onFreeze;var Md=yi.TypeError,xd=function(e,t){this.stopped=e,this.result=t},qd=xd.prototype,Hd=function(e,t,r){var n,o,i,s,a,c,g,y=r&&r.that,v=!(!r||!r.AS_ENTRIES),_=!(!r||!r.IS_ITERATOR),w=!(!r||!r.INTERRUPTED),b=su(t,y),E=function(e){return n&&Ol(n,"normal",e),new xd(!0,e)},S=function(e){return v?(Ls(e),w?b(e[0],e[1],E):b(e[0],e[1])):w?b(e,E):b(e)};if(_)n=e;else{if(!(o=Hl(e)))throw Md(os(e)+" is not iterable");if(xl(o)){for(i=0,s=ba(e);s>i;i++)if((a=S(e[i]))&&zi(qd,a))return a;return new xd(!1)}n=Dl(e,o)}for(c=n.next;!(g=Ei(c,n)).done;){try{a=S(g.value)}catch(e){Ol(n,"throw",e)}if("object"==typeof a&&a&&zi(qd,a))return a}return new xd(!1)},Ld=yi.TypeError,Dd=function(e,t){if(zi(t,e))return e;throw Ld("Incorrect invocation")},Kd=function(e,t,r){for(var n in t)ha(e,n,t[n],r);return e},Fd=Ts("species"),jd=js.f,Bd=Ud.fastKey,Gd=aa.set,Wd=aa.getterFor,zd={getConstructor:function(e,t,r,n){var o=e((function(e,o){Dd(e,i),Gd(e,{type:t,index:Wc(null),first:void 0,last:void 0,size:0}),_i||(e.size=0),null!=o&&Hd(o,e[n],{that:e,AS_ENTRIES:r})})),i=o.prototype,s=Wd(t),a=function(e,t,r){var n,o,i=s(e),a=c(e,t);return a?a.value=r:(i.last=a={index:o=Bd(t,!0),key:t,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=a),n&&(n.next=a),_i?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},c=function(e,t){var r,n=s(e),o=Bd(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return Kd(i,{clear:function(){for(var e=s(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,_i?e.size=0:this.size=0},delete:function(e){var t=this,r=s(t),n=c(t,e);if(n){var o=n.next,i=n.previous;delete r.index[n.index],n.removed=!0,i&&(i.next=o),o&&(o.previous=i),r.first==n&&(r.first=o),r.last==n&&(r.last=i),_i?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=s(this),n=su(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),Kd(i,r?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),_i&&jd(i,"size",{get:function(){return s(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=Wd(t),i=Wd(n);kl(e,t,(function(e,t){Gd(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),function(e){var t=Wi(e),r=js.f;_i&&t&&!t[Fd]&&r(t,Fd,{configurable:!0,get:function(){return this}})}(t)}};function Yd(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))}function Vd(e){return new this((function(t,r){if(!e||void 0===e.length)return r(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,r){if(r&&("object"==typeof r||"function"==typeof r)){var s=r.then;if("function"==typeof s)return void s.call(r,(function(t){i(e,t)}),(function(r){n[e]={status:"rejected",reason:r},0==--o&&t(n)}))}n[e]={status:"fulfilled",value:r},0==--o&&t(n)}for(var s=0;s<n.length;s++)i(s,n[s])}))}!function(e,t,r){var n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),i=n?"set":"add",s=yi[e],a=s&&s.prototype,c=s,g={},y=function(e){var t=Ni(a[e]);ha(a,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!Bi(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return o&&!Bi(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!Bi(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(Ka(e,!ji(s)||!(o||a.forEach&&!vi((function(){(new s).entries().next()})))))c=r.getConstructor(t,e,n,i),Ud.enable();else if(Ka(e,!0)){var v=new c,_=v[i](o?{}:-0,1)!=v,w=vi((function(){v.has(1)})),b=Wl((function(e){new s(e)})),E=!o&&vi((function(){for(var e=new s,t=5;t--;)e[i](t,t);return!e.has(-0)}));b||((c=t((function(e,t){Dd(e,a);var r=function(e,t,r){var n,o;return wl&&ji(n=t.constructor)&&n!==r&&Bi(o=n.prototype)&&o!==r.prototype&&wl(e,o),e}(new s,e,c);return null!=t&&Hd(t,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=a,a.constructor=c),(w||E)&&(y("delete"),y("has"),n&&y("get")),(E||_)&&y(i),o&&a.clear&&delete a.clear}g[e]=c,ja({global:!0,forced:c!=s},g),ou(c,e),o||r.setStrong(c,e,n)}("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),zd),$c.Set;var Jd=setTimeout,Xd="undefined"!=typeof setImmediate?setImmediate:null;function Zd(e){return Boolean(e&&void 0!==e.length)}function Qd(){}function $d(e){if(!(this instanceof $d))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],ih(e,this)}function eh(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,$d._immediateFn((function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var n;try{n=r(e._value)}catch(e){return void rh(t.promise,e)}th(t.promise,n)}else(1===e._state?th:rh)(t.promise,e._value)}))):e._deferreds.push(t)}function th(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof $d)return e._state=3,e._value=t,void nh(e);if("function"==typeof r)return void ih((n=r,o=t,function(){n.apply(o,arguments)}),e)}e._state=1,e._value=t,nh(e)}catch(t){rh(e,t)}var n,o}function rh(e,t){e._state=2,e._value=t,nh(e)}function nh(e){2===e._state&&0===e._deferreds.length&&$d._immediateFn((function(){e._handled||$d._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)eh(e,e._deferreds[t]);e._deferreds=null}function oh(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function ih(e,t){var r=!1;try{e((function(e){r||(r=!0,th(t,e))}),(function(e){r||(r=!0,rh(t,e))}))}catch(e){if(r)return;r=!0,rh(t,e)}}$d.prototype.catch=function(e){return this.then(null,e)},$d.prototype.then=function(e,t){var r=new this.constructor(Qd);return eh(this,new oh(e,t,r)),r},$d.prototype.finally=Yd,$d.all=function(e){return new $d((function(t,r){if(!Zd(e))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var o=n.length;function i(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,(function(t){i(e,t)}),r)}n[e]=s,0==--o&&t(n)}catch(e){r(e)}}for(var s=0;s<n.length;s++)i(s,n[s])}))},$d.allSettled=Vd,$d.resolve=function(e){return e&&"object"==typeof e&&e.constructor===$d?e:new $d((function(t){t(e)}))},$d.reject=function(e){return new $d((function(t,r){r(e)}))},$d.race=function(e){return new $d((function(t,r){if(!Zd(e))return r(new TypeError("Promise.race accepts an array"));for(var n=0,o=e.length;n<o;n++)$d.resolve(e[n]).then(t,r)}))},$d._immediateFn="function"==typeof Xd&&function(e){Xd(e)}||function(e){Jd(e,0)},$d._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var sh=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"function"!=typeof sh.Promise?sh.Promise=$d:(sh.Promise.prototype.finally||(sh.Promise.prototype.finally=Yd),sh.Promise.allSettled||(sh.Promise.allSettled=Vd)),function(e){function t(){}function r(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1===o.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}function n(e){for(var t=0,r=Math.min(65536,e.length+1),n=new Uint16Array(r),o=[],i=0;;){var s=t<e.length;if(!s||i>=r-1){if(o.push(String.fromCharCode.apply(null,n.subarray(0,i))),!s)return o.join("");e=e.subarray(t),i=t=0}if(0==(128&(s=e[t++])))n[i++]=s;else if(192==(224&s)){var a=63&e[t++];n[i++]=(31&s)<<6|a}else if(224==(240&s)){a=63&e[t++];var c=63&e[t++];n[i++]=(31&s)<<12|a<<6|c}else 240==(248&s)&&(65535<(s=(7&s)<<18|(a=63&e[t++])<<12|(c=63&e[t++])<<6|63&e[t++])&&(s-=65536,n[i++]=s>>>10&1023|55296,s=56320|1023&s),n[i++]=s)}}if(e.TextEncoder&&e.TextDecoder)return!1;var o=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var r=e.length,n=0,o=Math.max(32,r+(r>>>1)+7),i=new Uint8Array(o>>>3<<3);t<r;){var s=e.charCodeAt(t++);if(55296<=s&&56319>=s){if(t<r){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,s=((1023&s)<<10)+(1023&a)+65536)}if(55296<=s&&56319>=s)continue}if(n+4>i.length&&(o+=8,o=(o*=1+t/e.length*2)>>>3<<3,(a=new Uint8Array(o)).set(i),i=a),0==(4294967168&s))i[n++]=s;else{if(0==(4294965248&s))i[n++]=s>>>6&31|192;else if(0==(4294901760&s))i[n++]=s>>>12&15|224,i[n++]=s>>>6&63|128;else{if(0!=(4292870144&s))continue;i[n++]=s>>>18&7|240,i[n++]=s>>>12&63|128,i[n++]=s>>>6&63|128}i[n++]=63&s|128}}return i.slice?i.slice(0,n):i.subarray(0,n)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1});var i=n;"function"==typeof Buffer&&Buffer.from?i=function(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf-8")}:"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&(i=function(e){var t=URL.createObjectURL(new Blob([e],{type:"text/plain;charset=UTF-8"}));try{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.send(),r.responseText}catch(t){return n(e)}finally{URL.revokeObjectURL(t)}}),r.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");return e=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),i(e)},e.TextEncoder=t,e.TextDecoder=r}("undefined"!=typeof window?window:di),function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?s(e):t}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=o(e);if(t){var i=o(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return a(this,r)}}function g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function y(e,t,r){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=g(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}},y(e,t,r||e)}var v=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return r(t,[{key:"addEventListener",value:function(e,t,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:r})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,o=r.length;n<o;n++)if(r[n].callback===t)return void r.splice(n,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),r=0,n=t.length;r<n;r++){var o=t[r];try{o.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),t}(),_=function(t){n(a,t);var i=c(a);function a(){var t;return e(this,a),(t=i.call(this)).listeners||v.call(s(t)),Object.defineProperty(s(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(s(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return r(a,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),y(o(a.prototype),"dispatchEvent",this).call(this,e)}}]),a}(v),w=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new _,writable:!0,configurable:!0})}return r(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(w.prototype[Symbol.toStringTag]="AbortController",_.prototype[Symbol.toStringTag]="AbortSignal"),function(e){(function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController})(e)&&(e.AbortController=w,e.AbortSignal=_)}("undefined"!=typeof self?self:di)}();var ah=pi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,r){var n=e.locked.get(t);void 0===n?void 0===r?e.locked.set(t,[]):e.locked.set(t,[r]):void 0!==r&&(n.unshift(r),e.locked.set(t,n))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(r,n){e.isLocked(t)?e.addToLocked(t,r):(e.addToLocked(t),r())}))},this.unlock=function(t){var r=e.locked.get(t);if(void 0!==r&&0!==r.length){var n=r.pop();e.locked.set(t,r),void 0!==n&&setTimeout(n,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return r.getInstance()}}));hi(ah);var ch=pi((function(e,t){var r=di&&di.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))},n=di&&di.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o="browser-tabs-lock-key";function i(e){return new Promise((function(t){return setTimeout(t,e)}))}function s(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}var a=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+s(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,a){return void 0===a&&(a=5e3),r(this,void 0,void 0,(function(){var r,c,g,y,v,_;return n(this,(function(n){switch(n.label){case 0:r=Date.now()+s(4),c=Date.now()+a,g=o+"-"+t,y=window.localStorage,n.label=1;case 1:return Date.now()<c?[4,i(30)]:[3,8];case 2:return n.sent(),null!==y.getItem(g)?[3,5]:(v=this.id+"-"+t+"-"+r,[4,i(Math.floor(25*Math.random()))]);case 3:return n.sent(),y.setItem(g,JSON.stringify({id:this.id,iat:r,timeoutKey:v,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,i(30)];case 4:return n.sent(),null!==(_=y.getItem(g))&&(_=JSON.parse(_)).id===this.id&&_.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(g,r),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(c)];case 6:n.sent(),n.label=7;case 7:return r=Date.now()+s(4),[3,1];case 8:return[2,!1]}}))}))},e.prototype.refreshLockWhileAcquired=function(e,t){return r(this,void 0,void 0,(function(){var o=this;return n(this,(function(i){return setTimeout((function(){return r(o,void 0,void 0,(function(){var r,o;return n(this,(function(n){switch(n.label){case 0:return[4,ah.default().lock(t)];case 1:return n.sent(),this.acquiredIatSet.has(t)?(r=window.localStorage,null===(o=r.getItem(e))?(ah.default().unlock(t),[2]):((o=JSON.parse(o)).timeRefreshed=Date.now(),r.setItem(e,JSON.stringify(o)),ah.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(ah.default().unlock(t),[2])}}))}))}),1e3),[2]}))}))},e.prototype.waitForSomethingToChange=function(t){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){var n=!1,o=Date.now(),i=!1;function s(){if(i||(window.removeEventListener("storage",s),e.removeFromWaiting(s),clearTimeout(a),i=!0),!n){n=!0;var t=50-(Date.now()-o);t>0?setTimeout(r,t):r()}}window.addEventListener("storage",s),e.addToWaiting(s);var a=setTimeout(s,Math.max(0,t-Date.now()))}))];case 1:return r.sent(),[2]}}))}))},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter((function(e){return e!==t})))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach((function(e){return e()}))},e.prototype.releaseLock=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.releaseLock__private__=function(t){return r(this,void 0,void 0,(function(){var r,i,s;return n(this,(function(n){switch(n.label){case 0:return r=window.localStorage,i=o+"-"+t,null===(s=r.getItem(i))?[2]:(s=JSON.parse(s)).id!==this.id?[3,2]:[4,ah.default().lock(s.iat)];case 1:n.sent(),this.acquiredIatSet.delete(s.iat),r.removeItem(i),ah.default().unlock(s.iat),e.notifyWaiters(),n.label=2;case 2:return[2]}}))}))},e.lockCorrector=function(){for(var t=Date.now()-5e3,r=window.localStorage,n=Object.keys(r),i=!1,s=0;s<n.length;s++){var a=n[s];if(a.includes(o)){var c=r.getItem(a);null!==c&&(void 0===(c=JSON.parse(c)).timeRefreshed&&c.timeAcquired<t||void 0!==c.timeRefreshed&&c.timeRefreshed<t)&&(r.removeItem(a),i=!0)}}i&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=a})),uh=hi(ch),lh={timeoutInSeconds:60},dh=["login_required","consent_required","interaction_required","account_selection_required","access_denied"],hh={name:"auth0-spa-js",version:"1.20.0"},ph=function(){return Date.now()},fh=function(e){function t(r,n){var o=e.call(this,n)||this;return o.error=r,o.error_description=n,Object.setPrototypeOf(o,t.prototype),o}return oi(t,e),t.fromPayload=function(e){return new t(e.error,e.error_description)},t}(Error),gh=function(e){function t(r,n,o,i){void 0===i&&(i=null);var s=e.call(this,r,n)||this;return s.state=o,s.appState=i,Object.setPrototypeOf(s,t.prototype),s}return oi(t,e),t}(fh),mh=function(e){function t(){var r=e.call(this,"timeout","Timeout")||this;return Object.setPrototypeOf(r,t.prototype),r}return oi(t,e),t}(fh),yh=function(e){function t(r){var n=e.call(this)||this;return n.popup=r,Object.setPrototypeOf(n,t.prototype),n}return oi(t,e),t}(mh),vh=function(e){function t(r){var n=e.call(this,"cancelled","Popup closed")||this;return n.popup=r,Object.setPrototypeOf(n,t.prototype),n}return oi(t,e),t}(fh),_h=function(e){function t(r,n,o){var i=e.call(this,r,n)||this;return i.mfa_token=o,Object.setPrototypeOf(i,t.prototype),i}return oi(t,e),t}(fh),wh=function(e){return new Promise((function(t,r){var n,o=setInterval((function(){e.popup&&e.popup.closed&&(clearInterval(o),clearTimeout(i),window.removeEventListener("message",n,!1),r(new vh(e.popup)))}),1e3),i=setTimeout((function(){clearInterval(o),r(new yh(e.popup)),window.removeEventListener("message",n,!1)}),1e3*(e.timeoutInSeconds||60));n=function(s){if(s.data&&"authorization_response"===s.data.type){if(clearTimeout(i),clearInterval(o),window.removeEventListener("message",n,!1),e.popup.close(),s.data.response.error)return r(fh.fromPayload(s.data.response));t(s.data.response)}},window.addEventListener("message",n)}))},bh=function(){return window.crypto||window.msCrypto},Eh=function(){var e=bh();return e.subtle||e.webkitSubtle},Ch=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",t="";return Array.from(bh().getRandomValues(new Uint8Array(43))).forEach((function(r){return t+=e[r%e.length]})),t},Sh=function(e){return btoa(e)},Th=function(e){return Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},Ih=function(e){return ai(void 0,void 0,void 0,(function(){var t;return ci(this,(function(r){switch(r.label){case 0:return t=Eh().digest({name:"SHA-256"},(new TextEncoder).encode(e)),window.msCrypto?[2,new Promise((function(e,r){t.oncomplete=function(t){e(t.target.result)},t.onerror=function(e){r(e.error)},t.onabort=function(){r("The digest operation was aborted")}}))]:[4,t];case 1:return[2,r.sent()]}}))}))},kh=function(e){return function(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(e.replace(/_/g,"/").replace(/-/g,"+"))},Ah=function(e){var t=new Uint8Array(e);return function(e){var t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,(function(e){return t[e]}))}(window.btoa(String.fromCharCode.apply(String,li([],ui(Array.from(t)),!1))))},Rh=function(e,t){return ai(void 0,void 0,void 0,(function(){var r,n;return ci(this,(function(o){switch(o.label){case 0:return[4,(i=e,s=t,s=s||{},new Promise((function(e,t){var r=new XMLHttpRequest,n=[],o=[],a={},c=function(){return{ok:2==(r.status/100|0),statusText:r.statusText,status:r.status,url:r.responseURL,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([r.response]))},clone:c,headers:{keys:function(){return n},entries:function(){return o},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var g in r.open(s.method||"get",i,!0),r.onload=function(){r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,r){n.push(t=t.toLowerCase()),o.push([t,r]),a[t]=a[t]?a[t]+","+r:r})),e(c())},r.onerror=t,r.withCredentials="include"==s.credentials,s.headers)r.setRequestHeader(g,s.headers[g]);r.send(s.body||null)})))];case 1:return r=o.sent(),n={ok:r.ok},[4,r.json()];case 2:return[2,(n.json=o.sent(),n)]}var i,s}))}))},Ph=function(e,t,r){return ai(void 0,void 0,void 0,(function(){var n,o;return ci(this,(function(i){return n=new AbortController,t.signal=n.signal,[2,Promise.race([Rh(e,t),new Promise((function(e,t){o=setTimeout((function(){n.abort(),t(new Error("Timeout when executing 'fetch'"))}),r)}))]).finally((function(){clearTimeout(o)}))]}))}))},Oh=function(e,t,r,n,o,i,s){return ai(void 0,void 0,void 0,(function(){return ci(this,(function(a){return[2,(c={auth:{audience:t,scope:r},timeout:o,fetchUrl:e,fetchOptions:n,useFormData:s},g=i,new Promise((function(e,t){var r=new MessageChannel;r.port1.onmessage=function(r){r.data.error?t(new Error(r.data.error)):e(r.data)},g.postMessage(c,[r.port2])})))];var c,g}))}))},Nh=function(e,t,r,n,o,i,s){return void 0===s&&(s=1e4),ai(void 0,void 0,void 0,(function(){return ci(this,(function(a){return o?[2,Oh(e,t,r,n,s,o,i)]:[2,Ph(e,n,s)]}))}))};function Uh(e,t,r,n,o,i,s){return ai(this,void 0,void 0,(function(){var a,c,g,y,v,_,w,b,E;return ci(this,(function(S){switch(S.label){case 0:a=null,g=0,S.label=1;case 1:if(!(g<3))return[3,6];S.label=2;case 2:return S.trys.push([2,4,,5]),[4,Nh(e,r,n,o,i,s,t)];case 3:return c=S.sent(),a=null,[3,6];case 4:return y=S.sent(),a=y,[3,5];case 5:return g++,[3,1];case 6:if(a)throw a.message=a.message||"Failed to fetch",a;if(v=c.json,_=v.error,w=v.error_description,b=si(v,["error","error_description"]),!c.ok){if(E=w||"HTTP error. Unable to fetch ".concat(e),"mfa_required"===_)throw new _h(_,E,b.mfa_token);throw new fh(_||"request_error",E)}return[2,b]}}))}))}function Mh(e,t){var r=e.baseUrl,n=e.timeout,o=e.audience,i=e.scope,s=e.auth0Client,a=e.useFormData,c=si(e,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);return ai(this,void 0,void 0,(function(){var e;return ci(this,(function(g){switch(g.label){case 0:return e=a?Th(c):JSON.stringify(c),[4,Uh("".concat(r,"/oauth/token"),n,o||"default",i,{method:"POST",body:e,headers:{"Content-Type":a?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(s||hh))}},t,a)];case 1:return[2,g.sent()]}}))}))}var xh=function(e){return Array.from(new Set(e))},qh=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return xh(e.join(" ").trim().split(/\s+/)).join(" ")},Hh=function(){function e(e,t){void 0===t&&(t="@@auth0spajs@@"),this.prefix=t,this.client_id=e.client_id,this.scope=e.scope,this.audience=e.audience}return e.prototype.toKey=function(){return"".concat(this.prefix,"::").concat(this.client_id,"::").concat(this.audience,"::").concat(this.scope)},e.fromKey=function(t){var r=ui(t.split("::"),4),n=r[0],o=r[1],i=r[2];return new e({client_id:o,scope:r[3],audience:i},n)},e.fromCacheEntry=function(t){return new e({scope:t.scope,audience:t.audience,client_id:t.client_id})},e}(),Lh=function(){function e(){}return e.prototype.set=function(e,t){localStorage.setItem(e,JSON.stringify(t))},e.prototype.get=function(e){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return}},e.prototype.remove=function(e){localStorage.removeItem(e)},e.prototype.allKeys=function(){return Object.keys(window.localStorage).filter((function(e){return e.startsWith("@@auth0spajs@@")}))},e}(),Dh=function(){var e;this.enclosedCache=(e={},{set:function(t,r){e[t]=r},get:function(t){var r=e[t];if(r)return r},remove:function(t){delete e[t]},allKeys:function(){return Object.keys(e)}})},Kh=function(){function e(e,t,r){this.cache=e,this.keyManifest=t,this.nowProvider=r,this.nowProvider=this.nowProvider||ph}return e.prototype.get=function(e,t){var r;return void 0===t&&(t=0),ai(this,void 0,void 0,(function(){var n,o,i,s,a;return ci(this,(function(c){switch(c.label){case 0:return[4,this.cache.get(e.toKey())];case 1:return(n=c.sent())?[3,4]:[4,this.getCacheKeys()];case 2:return(o=c.sent())?(i=this.matchExistingCacheKey(e,o),[4,this.cache.get(i)]):[2];case 3:n=c.sent(),c.label=4;case 4:return n?[4,this.nowProvider()]:[2];case 5:return s=c.sent(),a=Math.floor(s/1e3),n.expiresAt-t<a?n.body.refresh_token?(n.body={refresh_token:n.body.refresh_token},[4,this.cache.set(e.toKey(),n)]):[3,7]:[3,10];case 6:return c.sent(),[2,n.body];case 7:return[4,this.cache.remove(e.toKey())];case 8:return c.sent(),[4,null===(r=this.keyManifest)||void 0===r?void 0:r.remove(e.toKey())];case 9:return c.sent(),[2];case 10:return[2,n.body]}}))}))},e.prototype.set=function(e){var t;return ai(this,void 0,void 0,(function(){var r,n;return ci(this,(function(o){switch(o.label){case 0:return r=new Hh({client_id:e.client_id,scope:e.scope,audience:e.audience}),[4,this.wrapCacheEntry(e)];case 1:return n=o.sent(),[4,this.cache.set(r.toKey(),n)];case 2:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.add(r.toKey())];case 3:return o.sent(),[2]}}))}))},e.prototype.clear=function(e){var t;return ai(this,void 0,void 0,(function(){var r,n=this;return ci(this,(function(o){switch(o.label){case 0:return[4,this.getCacheKeys()];case 1:return(r=o.sent())?[4,r.filter((function(t){return!e||t.includes(e)})).reduce((function(e,t){return ai(n,void 0,void 0,(function(){return ci(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return r.sent(),[4,this.cache.remove(t)];case 2:return r.sent(),[2]}}))}))}),Promise.resolve())]:[2];case 2:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.clear()];case 3:return o.sent(),[2]}}))}))},e.prototype.clearSync=function(e){var t=this,r=this.cache.allKeys();r&&r.filter((function(t){return!e||t.includes(e)})).forEach((function(e){t.cache.remove(e)}))},e.prototype.wrapCacheEntry=function(e){return ai(this,void 0,void 0,(function(){var t,r,n;return ci(this,(function(o){switch(o.label){case 0:return[4,this.nowProvider()];case 1:return t=o.sent(),r=Math.floor(t/1e3)+e.expires_in,n=Math.min(r,e.decodedToken.claims.exp),[2,{body:e,expiresAt:n}]}}))}))},e.prototype.getCacheKeys=function(){var e;return ai(this,void 0,void 0,(function(){var t;return ci(this,(function(r){switch(r.label){case 0:return this.keyManifest?[4,this.keyManifest.get()]:[3,2];case 1:return t=null===(e=r.sent())||void 0===e?void 0:e.keys,[3,4];case 2:return[4,this.cache.allKeys()];case 3:t=r.sent(),r.label=4;case 4:return[2,t]}}))}))},e.prototype.matchExistingCacheKey=function(e,t){return t.filter((function(t){var r=Hh.fromKey(t),n=new Set(r.scope&&r.scope.split(" ")),o=e.scope.split(" "),i=r.scope&&o.reduce((function(e,t){return e&&n.has(t)}),!0);return"@@auth0spajs@@"===r.prefix&&r.client_id===e.client_id&&r.audience===e.audience&&i}))[0]},e}(),Fh=function(){function e(e,t){this.storage=e,this.clientId=t,this.storageKey="".concat("a0.spajs.txs",".").concat(this.clientId),this.transaction=this.storage.get(this.storageKey)}return e.prototype.create=function(e){this.transaction=e,this.storage.save(this.storageKey,e,{daysUntilExpire:1})},e.prototype.get=function(){return this.transaction},e.prototype.remove=function(){delete this.transaction,this.storage.remove(this.storageKey)},e}(),jh=function(e){return"number"==typeof e},Bh=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],Gh=function(e){if(!e.id_token)throw new Error("ID token is required but missing");var t=function(e){var t=e.split("."),r=ui(t,3),n=r[0],o=r[1],i=r[2];if(3!==t.length||!n||!o||!i)throw new Error("ID token could not be decoded");var s=JSON.parse(kh(o)),a={__raw:e},c={};return Object.keys(s).forEach((function(e){a[e]=s[e],Bh.includes(e)||(c[e]=s[e])})),{encoded:{header:n,payload:o,signature:i},header:JSON.parse(kh(n)),claims:a,user:c}}(e.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw new Error('Issuer (iss) claim mismatch in the ID token; expected "'.concat(e.iss,'", found "').concat(t.claims.iss,'"'));if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error('Signature algorithm of "'.concat(t.header.alg,'" is not supported. Expected the ID token to be signed with "RS256".'));if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(e.aud,'" but was not one of "').concat(t.claims.aud.join(", "),'"'));if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw new Error('Authorized Party (azp) claim mismatch in the ID token; expected "'.concat(e.aud,'", found "').concat(t.claims.azp,'"'))}}else if(t.claims.aud!==e.aud)throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(e.aud,'" but found "').concat(t.claims.aud,'"'));if(e.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw new Error('Nonce (nonce) claim mismatch in the ID token; expected "'.concat(e.nonce,'", found "').concat(t.claims.nonce,'"'))}if(e.max_age&&!jh(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(!jh(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!jh(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");var r=e.leeway||60,n=new Date(e.now||Date.now()),o=new Date(0),i=new Date(0),s=new Date(0);if(s.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+r),o.setUTCSeconds(t.claims.exp+r),i.setUTCSeconds(t.claims.nbf-r),n>o)throw new Error("Expiration Time (exp) claim error in the ID token; current time (".concat(n,") is after expiration time (").concat(o,")"));if(jh(t.claims.nbf)&&n<i)throw new Error("Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Currrent time (".concat(n,") is before ").concat(i));if(jh(t.claims.auth_time)&&n>s)throw new Error("Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Currrent time (".concat(n,") is after last auth at ").concat(s));if(e.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw new Error('Organization ID (org_id) claim mismatch in the ID token; expected "'.concat(e.organizationId,'", found "').concat(t.claims.org_id,'"'))}return t},Wh=pi((function(e,t){var r=di&&di.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e,t){if(!t)return"";var r="; "+e;return!0===t?r:r+"="+t}function o(e,t,r){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return n("Expires",e.expires?e.expires.toUTCString():"")+n("Domain",e.domain)+n("Path",e.path)+n("Secure",e.secure)+n("SameSite",e.sameSite)}(r)}function i(e){for(var t={},r=e?e.split("; "):[],n=/(%[\dA-F]{2})+/gi,o=0;o<r.length;o++){var i=r[o].split("="),s=i.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{t[i[0].replace(n,decodeURIComponent)]=s.replace(n,decodeURIComponent)}catch(e){}}return t}function s(){return i(document.cookie)}function a(e,t,n){document.cookie=o(e,t,r({path:"/"},n))}t.__esModule=!0,t.encode=o,t.parse=i,t.getAll=s,t.get=function(e){return s()[e]},t.set=a,t.remove=function(e,t){a(e,"",r(r({},t),{expires:-1}))}}));hi(Wh),Wh.encode,Wh.parse,Wh.getAll;var zh=Wh.get,Yh=Wh.set,Vh=Wh.remove,Jh={get:function(e){var t=zh(e);if(void 0!==t)return JSON.parse(t)},save:function(e,t,r){var n={};"https:"===window.location.protocol&&(n={secure:!0,sameSite:"none"}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),Yh(e,JSON.stringify(t),n)},remove:function(e){Vh(e)}},Xh={get:function(e){return Jh.get(e)||Jh.get("".concat("_legacy_").concat(e))},save:function(e,t,r){var n={};"https:"===window.location.protocol&&(n={secure:!0}),(null==r?void 0:r.daysUntilExpire)&&(n.expires=r.daysUntilExpire),Yh("".concat("_legacy_").concat(e),JSON.stringify(t),n),Jh.save(e,t,r)},remove:function(e){Jh.remove(e),Jh.remove("".concat("_legacy_").concat(e))}},Zh={get:function(e){if("undefined"!=typeof sessionStorage){var t=sessionStorage.getItem(e);if(void 0!==t)return JSON.parse(t)}},save:function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},remove:function(e){sessionStorage.removeItem(e)}};var Qh,$h=("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Ci8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uCgogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuCgogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgKICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULAogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NCiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUgogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovdmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHIsdD0xLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWZvcih2YXIgbyBpbiByPWFyZ3VtZW50c1t0XSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixvKSYmKGVbb109cltvXSk7cmV0dXJuIGV9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtmdW5jdGlvbiByKGUscix0LG4pe3JldHVybiBuZXcodHx8KHQ9UHJvbWlzZSkpKChmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHMoZSl7dHJ5e2Mobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBpKGUpe3RyeXtjKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGMoZSl7dmFyIHI7ZS5kb25lP28oZS52YWx1ZSk6KHI9ZS52YWx1ZSxyIGluc3RhbmNlb2YgdD9yOm5ldyB0KChmdW5jdGlvbihlKXtlKHIpfSkpKS50aGVuKHMsaSl9Yygobj1uLmFwcGx5KGUscnx8W10pKS5uZXh0KCkpfSkpfWZ1bmN0aW9uIHQoZSxyKXt2YXIgdCxuLG8sYSxzPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OmkoMCksdGhyb3c6aSgxKSxyZXR1cm46aSgyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBpKGEpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYodCl0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtzOyl0cnl7aWYodD0xLG4mJihvPTImYVswXT9uLnJldHVybjphWzBdP24udGhyb3d8fCgobz1uLnJldHVybikmJm8uY2FsbChuKSwwKTpuLm5leHQpJiYhKG89by5jYWxsKG4sYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKG49MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIHMubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6cy5sYWJlbCsrLG49YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1zLm9wcy5wb3AoKSxzLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89cy50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtzPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtzLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJnMubGFiZWw8b1sxXSl7cy5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZzLmxhYmVsPG9bMl0pe3MubGFiZWw9b1syXSxzLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJnMub3BzLnBvcCgpLHMudHJ5cy5wb3AoKTtjb250aW51ZX1hPXIuY2FsbChlLHMpfWNhdGNoKGUpe2E9WzYsZV0sbj0wfWZpbmFsbHl7dD1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLGldKX19fXZhciBuPXt9LG89ZnVuY3Rpb24oZSxyKXtyZXR1cm4iIi5jb25jYXQoZSwifCIpLmNvbmNhdChyKX07YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uKGEpe3ZhciBzPWEuZGF0YSxpPXMudGltZW91dCxjPXMuYXV0aCx1PXMuZmV0Y2hVcmwsZj1zLmZldGNoT3B0aW9ucyxsPXMudXNlRm9ybURhdGEsaD1mdW5jdGlvbihlLHIpe3ZhciB0PSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighdClyZXR1cm4gZTt2YXIgbixvLGE9dC5jYWxsKGUpLHM9W107dHJ5e2Zvcig7KHZvaWQgMD09PXJ8fHItLSA+MCkmJiEobj1hLm5leHQoKSkuZG9uZTspcy5wdXNoKG4udmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e24mJiFuLmRvbmUmJih0PWEucmV0dXJuKSYmdC5jYWxsKGEpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gc30oYS5wb3J0cywxKVswXTtyZXR1cm4gcih2b2lkIDAsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgcixhLHMscCx5LGIsZCx2LHcsZztyZXR1cm4gdCh0aGlzLChmdW5jdGlvbih0KXtzd2l0Y2godC5sYWJlbCl7Y2FzZSAwOnM9KGE9Y3x8e30pLmF1ZGllbmNlLHA9YS5zY29wZSx0LmxhYmVsPTE7Y2FzZSAxOmlmKHQudHJ5cy5wdXNoKFsxLDcsLDhdKSwhKHk9bD8oaz1mLmJvZHksUz1uZXcgVVJMU2VhcmNoUGFyYW1zKGspLF89e30sUy5mb3JFYWNoKChmdW5jdGlvbihlLHIpe19bcl09ZX0pKSxfKTpKU09OLnBhcnNlKGYuYm9keSkpLnJlZnJlc2hfdG9rZW4mJiJyZWZyZXNoX3Rva2VuIj09PXkuZ3JhbnRfdHlwZSl7aWYoYj1mdW5jdGlvbihlLHIpe3JldHVybiBuW28oZSxyKV19KHMscCksIWIpdGhyb3cgbmV3IEVycm9yKCJUaGUgd2ViIHdvcmtlciBpcyBtaXNzaW5nIHRoZSByZWZyZXNoIHRva2VuIik7Zi5ib2R5PWw/bmV3IFVSTFNlYXJjaFBhcmFtcyhlKGUoe30seSkse3JlZnJlc2hfdG9rZW46Yn0pKS50b1N0cmluZygpOkpTT04uc3RyaW5naWZ5KGUoZSh7fSx5KSx7cmVmcmVzaF90b2tlbjpifSkpfWQ9dm9pZCAwLCJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihkPW5ldyBBYm9ydENvbnRyb2xsZXIsZi5zaWduYWw9ZC5zaWduYWwpLHY9dm9pZCAwLHQubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHQudHJ5cy5wdXNoKFsyLDQsLDVdKSxbNCxQcm9taXNlLnJhY2UoWyhtPWksbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUpe3JldHVybiBzZXRUaW1lb3V0KGUsbSl9KSkpLGZldGNoKHUsZSh7fSxmKSldKV07Y2FzZSAzOnJldHVybiB2PXQuc2VudCgpLFszLDVdO2Nhc2UgNDpyZXR1cm4gdz10LnNlbnQoKSxoLnBvc3RNZXNzYWdlKHtlcnJvcjp3Lm1lc3NhZ2V9KSxbMl07Y2FzZSA1OnJldHVybiB2P1s0LHYuanNvbigpXTooZCYmZC5hYm9ydCgpLGgucG9zdE1lc3NhZ2Uoe2Vycm9yOiJUaW1lb3V0IHdoZW4gZXhlY3V0aW5nICdmZXRjaCcifSksWzJdKTtjYXNlIDY6cmV0dXJuKHI9dC5zZW50KCkpLnJlZnJlc2hfdG9rZW4/KGZ1bmN0aW9uKGUscix0KXtuW28ocix0KV09ZX0oci5yZWZyZXNoX3Rva2VuLHMscCksZGVsZXRlIHIucmVmcmVzaF90b2tlbik6ZnVuY3Rpb24oZSxyKXtkZWxldGUgbltvKGUscildfShzLHApLGgucG9zdE1lc3NhZ2Uoe29rOnYub2ssanNvbjpyfSksWzMsOF07Y2FzZSA3OnJldHVybiBnPXQuc2VudCgpLGgucG9zdE1lc3NhZ2Uoe29rOiExLGpzb246e2Vycm9yX2Rlc2NyaXB0aW9uOmcubWVzc2FnZX19KSxbMyw4XTtjYXNlIDg6cmV0dXJuWzJdfXZhciBtLGssUyxffSkpfSkpfSkpfSgpOwoK",null,!1,function(e){return Qh=Qh||function(e,t,r){var n=void 0===t?null:t,o=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),o=0,i=r.length;o<i;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(e,void 0!==r&&r),i=o.indexOf("\n",10)+1,s=o.substring(i)+(n?"//# sourceMappingURL="+n:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Ci8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uCgogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuCgogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgKICAgIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULAogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NCiAgICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUgogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovdmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHIsdD0xLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWZvcih2YXIgbyBpbiByPWFyZ3VtZW50c1t0XSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixvKSYmKGVbb109cltvXSk7cmV0dXJuIGV9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtmdW5jdGlvbiByKGUscix0LG4pe3JldHVybiBuZXcodHx8KHQ9UHJvbWlzZSkpKChmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHMoZSl7dHJ5e2Mobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBpKGUpe3RyeXtjKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGMoZSl7dmFyIHI7ZS5kb25lP28oZS52YWx1ZSk6KHI9ZS52YWx1ZSxyIGluc3RhbmNlb2YgdD9yOm5ldyB0KChmdW5jdGlvbihlKXtlKHIpfSkpKS50aGVuKHMsaSl9Yygobj1uLmFwcGx5KGUscnx8W10pKS5uZXh0KCkpfSkpfWZ1bmN0aW9uIHQoZSxyKXt2YXIgdCxuLG8sYSxzPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OmkoMCksdGhyb3c6aSgxKSxyZXR1cm46aSgyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBpKGEpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYodCl0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtzOyl0cnl7aWYodD0xLG4mJihvPTImYVswXT9uLnJldHVybjphWzBdP24udGhyb3d8fCgobz1uLnJldHVybikmJm8uY2FsbChuKSwwKTpuLm5leHQpJiYhKG89by5jYWxsKG4sYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKG49MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIHMubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6cy5sYWJlbCsrLG49YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1zLm9wcy5wb3AoKSxzLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89cy50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtzPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtzLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJnMubGFiZWw8b1sxXSl7cy5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZzLmxhYmVsPG9bMl0pe3MubGFiZWw9b1syXSxzLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJnMub3BzLnBvcCgpLHMudHJ5cy5wb3AoKTtjb250aW51ZX1hPXIuY2FsbChlLHMpfWNhdGNoKGUpe2E9WzYsZV0sbj0wfWZpbmFsbHl7dD1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLGldKX19fXZhciBuPXt9LG89ZnVuY3Rpb24oZSxyKXtyZXR1cm4iIi5jb25jYXQoZSwifCIpLmNvbmNhdChyKX07YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGZ1bmN0aW9uKGEpe3ZhciBzPWEuZGF0YSxpPXMudGltZW91dCxjPXMuYXV0aCx1PXMuZmV0Y2hVcmwsZj1zLmZldGNoT3B0aW9ucyxsPXMudXNlRm9ybURhdGEsaD1mdW5jdGlvbihlLHIpe3ZhciB0PSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighdClyZXR1cm4gZTt2YXIgbixvLGE9dC5jYWxsKGUpLHM9W107dHJ5e2Zvcig7KHZvaWQgMD09PXJ8fHItLSA+MCkmJiEobj1hLm5leHQoKSkuZG9uZTspcy5wdXNoKG4udmFsdWUpfWNhdGNoKGUpe289e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e24mJiFuLmRvbmUmJih0PWEucmV0dXJuKSYmdC5jYWxsKGEpfWZpbmFsbHl7aWYobyl0aHJvdyBvLmVycm9yfX1yZXR1cm4gc30oYS5wb3J0cywxKVswXTtyZXR1cm4gcih2b2lkIDAsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgcixhLHMscCx5LGIsZCx2LHcsZztyZXR1cm4gdCh0aGlzLChmdW5jdGlvbih0KXtzd2l0Y2godC5sYWJlbCl7Y2FzZSAwOnM9KGE9Y3x8e30pLmF1ZGllbmNlLHA9YS5zY29wZSx0LmxhYmVsPTE7Y2FzZSAxOmlmKHQudHJ5cy5wdXNoKFsxLDcsLDhdKSwhKHk9bD8oaz1mLmJvZHksUz1uZXcgVVJMU2VhcmNoUGFyYW1zKGspLF89e30sUy5mb3JFYWNoKChmdW5jdGlvbihlLHIpe19bcl09ZX0pKSxfKTpKU09OLnBhcnNlKGYuYm9keSkpLnJlZnJlc2hfdG9rZW4mJiJyZWZyZXNoX3Rva2VuIj09PXkuZ3JhbnRfdHlwZSl7aWYoYj1mdW5jdGlvbihlLHIpe3JldHVybiBuW28oZSxyKV19KHMscCksIWIpdGhyb3cgbmV3IEVycm9yKCJUaGUgd2ViIHdvcmtlciBpcyBtaXNzaW5nIHRoZSByZWZyZXNoIHRva2VuIik7Zi5ib2R5PWw/bmV3IFVSTFNlYXJjaFBhcmFtcyhlKGUoe30seSkse3JlZnJlc2hfdG9rZW46Yn0pKS50b1N0cmluZygpOkpTT04uc3RyaW5naWZ5KGUoZSh7fSx5KSx7cmVmcmVzaF90b2tlbjpifSkpfWQ9dm9pZCAwLCJmdW5jdGlvbiI9PXR5cGVvZiBBYm9ydENvbnRyb2xsZXImJihkPW5ldyBBYm9ydENvbnRyb2xsZXIsZi5zaWduYWw9ZC5zaWduYWwpLHY9dm9pZCAwLHQubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHQudHJ5cy5wdXNoKFsyLDQsLDVdKSxbNCxQcm9taXNlLnJhY2UoWyhtPWksbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUpe3JldHVybiBzZXRUaW1lb3V0KGUsbSl9KSkpLGZldGNoKHUsZSh7fSxmKSldKV07Y2FzZSAzOnJldHVybiB2PXQuc2VudCgpLFszLDVdO2Nhc2UgNDpyZXR1cm4gdz10LnNlbnQoKSxoLnBvc3RNZXNzYWdlKHtlcnJvcjp3Lm1lc3NhZ2V9KSxbMl07Y2FzZSA1OnJldHVybiB2P1s0LHYuanNvbigpXTooZCYmZC5hYm9ydCgpLGgucG9zdE1lc3NhZ2Uoe2Vycm9yOiJUaW1lb3V0IHdoZW4gZXhlY3V0aW5nICdmZXRjaCcifSksWzJdKTtjYXNlIDY6cmV0dXJuKHI9dC5zZW50KCkpLnJlZnJlc2hfdG9rZW4/KGZ1bmN0aW9uKGUscix0KXtuW28ocix0KV09ZX0oci5yZWZyZXNoX3Rva2VuLHMscCksZGVsZXRlIHIucmVmcmVzaF90b2tlbik6ZnVuY3Rpb24oZSxyKXtkZWxldGUgbltvKGUscildfShzLHApLGgucG9zdE1lc3NhZ2Uoe29rOnYub2ssanNvbjpyfSksWzMsOF07Y2FzZSA3OnJldHVybiBnPXQuc2VudCgpLGgucG9zdE1lc3NhZ2Uoe29rOiExLGpzb246e2Vycm9yX2Rlc2NyaXB0aW9uOmcubWVzc2FnZX19KSxbMyw4XTtjYXNlIDg6cmV0dXJuWzJdfXZhciBtLGssUyxffSkpfSkpfSkpfSgpOwoK",null,false),new Worker(Qh,e)}),ep={},tp=function(){function e(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}return e.prototype.add=function(e){var t;return ai(this,void 0,void 0,(function(){var r,n;return ci(this,(function(o){switch(o.label){case 0:return n=Set.bind,[4,this.cache.get(this.manifestKey)];case 1:return(r=new(n.apply(Set,[void 0,(null===(t=o.sent())||void 0===t?void 0:t.keys)||[]]))).add(e),[4,this.cache.set(this.manifestKey,{keys:li([],ui(r),!1)})];case 2:return o.sent(),[2]}}))}))},e.prototype.remove=function(e){return ai(this,void 0,void 0,(function(){var t,r;return ci(this,(function(n){switch(n.label){case 0:return[4,this.cache.get(this.manifestKey)];case 1:return(t=n.sent())?((r=new Set(t.keys)).delete(e),r.size>0?[4,this.cache.set(this.manifestKey,{keys:li([],ui(r),!1)})]:[3,3]):[3,5];case 2:case 4:return[2,n.sent()];case 3:return[4,this.cache.remove(this.manifestKey)];case 5:return[2]}}))}))},e.prototype.get=function(){return this.cache.get(this.manifestKey)},e.prototype.clear=function(){return this.cache.remove(this.manifestKey)},e.prototype.createManifestKeyFrom=function(e){return"".concat("@@auth0spajs@@","::").concat(e)},e}(),rp=new uh,np={memory:function(){return(new Dh).enclosedCache},localstorage:function(){return new Lh}},op=function(e){return np[e]},ip=function(){function e(e){var t,r,n,o;if(this.options=e,"undefined"!=typeof window&&function(){if(!bh())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===Eh())throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")}(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)n=e.cache;else{if(this.cacheLocation=e.cacheLocation||"memory",!op(this.cacheLocation))throw new Error('Invalid cache location "'.concat(this.cacheLocation,'"'));n=op(this.cacheLocation)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===e.legacySameSiteCookie?Jh:Xh,this.orgHintCookieName=(o=this.options.client_id,"auth0.".concat(o,".organization_hint")),this.isAuthenticatedCookieName=function(e){return"auth0.".concat(e,".is.authenticated")}(this.options.client_id),this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;var i,s=e.useCookiesForTransactions?this.cookieStorage:Zh;this.scope=this.options.scope,this.transactionManager=new Fh(s,this.options.client_id),this.nowProvider=this.options.nowProvider||ph,this.cacheManager=new Kh(n,n.allKeys?null:new tp(n,this.options.client_id),this.nowProvider),this.domainUrl=(i=this.options.domain,/^https?:\/\//.test(i)?i:"https://".concat(i)),this.tokenIssuer=function(e,t){return e?e.startsWith("https://")?e:"https://".concat(e,"/"):"".concat(t,"/")}(this.options.issuer,this.domainUrl),this.defaultScope=qh("openid",void 0!==(null===(r=null===(t=this.options)||void 0===t?void 0:t.advancedOptions)||void 0===r?void 0:r.defaultScope)?this.options.advancedOptions.defaultScope:"openid profile email"),this.options.useRefreshTokens&&(this.scope=qh(this.scope,"offline_access")),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&"memory"===this.cacheLocation&&!/Trident.*rv:11\.0/.test(navigator.userAgent)&&(this.worker=new $h),this.customOptions=function(e){return e.advancedOptions,e.audience,e.auth0Client,e.authorizeTimeoutInSeconds,e.cacheLocation,e.client_id,e.domain,e.issuer,e.leeway,e.max_age,e.redirect_uri,e.scope,e.useRefreshTokens,e.useCookiesForTransactions,e.useFormData,si(e,["advancedOptions","audience","auth0Client","authorizeTimeoutInSeconds","cacheLocation","client_id","domain","issuer","leeway","max_age","redirect_uri","scope","useRefreshTokens","useCookiesForTransactions","useFormData"])}(e)}return e.prototype._url=function(e){var t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||hh)));return"".concat(this.domainUrl).concat(e,"&auth0Client=").concat(t)},e.prototype._getParams=function(e,t,r,n,o){var i=this.options;i.useRefreshTokens,i.useCookiesForTransactions,i.useFormData,i.auth0Client,i.cacheLocation,i.advancedOptions,i.detailedResponse,i.nowProvider,i.authorizeTimeoutInSeconds,i.legacySameSiteCookie,i.sessionCheckExpiryDays,i.domain,i.leeway,i.httpTimeoutInSeconds;var s=si(i,["useRefreshTokens","useCookiesForTransactions","useFormData","auth0Client","cacheLocation","advancedOptions","detailedResponse","nowProvider","authorizeTimeoutInSeconds","legacySameSiteCookie","sessionCheckExpiryDays","domain","leeway","httpTimeoutInSeconds"]);return ii(ii(ii({},s),e),{scope:qh(this.defaultScope,this.scope,e.scope),response_type:"code",response_mode:"query",state:t,nonce:r,redirect_uri:o||this.options.redirect_uri,code_challenge:n,code_challenge_method:"S256"})},e.prototype._authorizeUrl=function(e){return this._url("/authorize?".concat(Th(e)))},e.prototype._verifyIdToken=function(e,t,r){return ai(this,void 0,void 0,(function(){var n;return ci(this,(function(o){switch(o.label){case 0:return[4,this.nowProvider()];case 1:return n=o.sent(),[2,Gh({iss:this.tokenIssuer,aud:this.options.client_id,id_token:e,nonce:t,organizationId:r,leeway:this.options.leeway,max_age:this._parseNumber(this.options.max_age),now:n})]}}))}))},e.prototype._parseNumber=function(e){return"string"!=typeof e?e:parseInt(e,10)||void 0},e.prototype._processOrgIdHint=function(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays}):this.cookieStorage.remove(this.orgHintCookieName)},e.prototype.buildAuthorizeUrl=function(e){return void 0===e&&(e={}),ai(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y,v,_;return ci(this,(function(w){switch(w.label){case 0:return t=e.redirect_uri,r=e.appState,n=si(e,["redirect_uri","appState"]),o=Sh(Ch()),i=Sh(Ch()),s=Ch(),[4,Ih(s)];case 1:return a=w.sent(),c=Ah(a),g=e.fragment?"#".concat(e.fragment):"",y=this._getParams(n,o,i,c,t),v=this._authorizeUrl(y),_=e.organization||this.options.organization,this.transactionManager.create(ii({nonce:i,code_verifier:s,appState:r,scope:y.scope,audience:y.audience||"default",redirect_uri:y.redirect_uri,state:o},_&&{organizationId:_})),[2,v+g]}}))}))},e.prototype.loginWithPopup=function(e,t){return ai(this,void 0,void 0,(function(){var r,n,o,i,s,a,c,g,y,v,_,w,b;return ci(this,(function(E){switch(E.label){case 0:return e=e||{},(t=t||{}).popup||(t.popup=function(e){var t=window.screenX+(window.innerWidth-400)/2,r=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup","left=".concat(t,",top=").concat(r,",width=").concat(400,",height=").concat(600,",resizable,scrollbars=yes,status=1"))}()),r=si(e,[]),n=Sh(Ch()),o=Sh(Ch()),i=Ch(),[4,Ih(i)];case 1:return s=E.sent(),a=Ah(s),c=this._getParams(r,n,o,a,this.options.redirect_uri||window.location.origin),g=this._authorizeUrl(ii(ii({},c),{response_mode:"web_message"})),t.popup.location.href=g,[4,wh(ii(ii({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}))];case 2:if(y=E.sent(),n!==y.state)throw new Error("Invalid state");return[4,Mh({audience:c.audience,scope:c.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:i,code:y.code,grant_type:"authorization_code",redirect_uri:c.redirect_uri,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},this.worker)];case 3:return v=E.sent(),_=e.organization||this.options.organization,[4,this._verifyIdToken(v.id_token,o,_)];case 4:return w=E.sent(),b=ii(ii({},v),{decodedToken:w,scope:c.scope,audience:c.audience||"default",client_id:this.options.client_id}),[4,this.cacheManager.set(b)];case 5:return E.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),this._processOrgIdHint(w.claims.org_id),[2]}}))}))},e.prototype.getUser=function(e){return void 0===e&&(e={}),ai(this,void 0,void 0,(function(){var t,r,n;return ci(this,(function(o){switch(o.label){case 0:return t=e.audience||this.options.audience||"default",r=qh(this.defaultScope,this.scope,e.scope),[4,this.cacheManager.get(new Hh({client_id:this.options.client_id,audience:t,scope:r}))];case 1:return[2,(n=o.sent())&&n.decodedToken&&n.decodedToken.user]}}))}))},e.prototype.getIdTokenClaims=function(e){return void 0===e&&(e={}),ai(this,void 0,void 0,(function(){var t,r,n;return ci(this,(function(o){switch(o.label){case 0:return t=e.audience||this.options.audience||"default",r=qh(this.defaultScope,this.scope,e.scope),[4,this.cacheManager.get(new Hh({client_id:this.options.client_id,audience:t,scope:r}))];case 1:return[2,(n=o.sent())&&n.decodedToken&&n.decodedToken.claims]}}))}))},e.prototype.loginWithRedirect=function(e){return void 0===e&&(e={}),ai(this,void 0,void 0,(function(){var t,r,n;return ci(this,(function(o){switch(o.label){case 0:return t=e.redirectMethod,r=si(e,["redirectMethod"]),[4,this.buildAuthorizeUrl(r)];case 1:return n=o.sent(),window.location[t||"assign"](n),[2]}}))}))},e.prototype.handleRedirectCallback=function(e){return void 0===e&&(e=window.location.href),ai(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y;return ci(this,(function(v){switch(v.label){case 0:if(0===(t=e.split("?").slice(1)).length)throw new Error("There are no query params available for parsing.");if(r=function(e){e.indexOf("#")>-1&&(e=e.substr(0,e.indexOf("#")));var t=e.split("&"),r={};return t.forEach((function(e){var t=ui(e.split("="),2),n=t[0],o=t[1];r[n]=decodeURIComponent(o)})),r.expires_in&&(r.expires_in=parseInt(r.expires_in)),r}(t.join("")),n=r.state,o=r.code,i=r.error,s=r.error_description,!(a=this.transactionManager.get()))throw new Error("Invalid state");if(this.transactionManager.remove(),i)throw new gh(i,s,n,a.appState);if(!a.code_verifier||a.state&&a.state!==n)throw new Error("Invalid state");return c={audience:a.audience,scope:a.scope,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:a.code_verifier,grant_type:"authorization_code",code:o,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},void 0!==a.redirect_uri&&(c.redirect_uri=a.redirect_uri),[4,Mh(c,this.worker)];case 1:return g=v.sent(),[4,this._verifyIdToken(g.id_token,a.nonce,a.organizationId)];case 2:return y=v.sent(),[4,this.cacheManager.set(ii(ii(ii(ii({},g),{decodedToken:y,audience:a.audience,scope:a.scope}),g.scope?{oauthTokenScope:g.scope}:null),{client_id:this.options.client_id}))];case 3:return v.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),this._processOrgIdHint(y.claims.org_id),[2,{appState:a.appState}]}}))}))},e.prototype.checkSession=function(e){return ai(this,void 0,void 0,(function(){var t;return ci(this,(function(r){switch(r.label){case 0:if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return[2];this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),this.cookieStorage.remove("auth0.is.authenticated")}r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getTokenSilently(e)];case 2:return r.sent(),[3,4];case 3:if(t=r.sent(),!dh.includes(t.error))throw t;return[3,4];case 4:return[2]}}))}))},e.prototype.getTokenSilently=function(e){return void 0===e&&(e={}),ai(this,void 0,void 0,(function(){var t,r,n,o=this;return ci(this,(function(i){return t=ii(ii({audience:this.options.audience,ignoreCache:!1},e),{scope:qh(this.defaultScope,this.scope,e.scope)}),r=t.ignoreCache,n=si(t,["ignoreCache"]),[2,(s=function(){return o._getTokenSilently(ii({ignoreCache:r},n))},a="".concat(this.options.client_id,"::").concat(n.audience,"::").concat(n.scope),c=ep[a],c||(c=s().finally((function(){delete ep[a],c=null})),ep[a]=c),c)];var s,a,c}))}))},e.prototype._getTokenSilently=function(e){return void 0===e&&(e={}),ai(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g;return ci(this,(function(y){switch(y.label){case 0:return t=e.ignoreCache,r=si(e,["ignoreCache"]),t?[3,2]:[4,this._getEntryFromCache({scope:r.scope,audience:r.audience||"default",client_id:this.options.client_id,getDetailedEntry:e.detailedResponse})];case 1:if(n=y.sent())return[2,n];y.label=2;case 2:return[4,(v=function(){return rp.acquireLock("auth0.lock.getTokenSilently",5e3)},_=10,void 0===_&&(_=3),ai(void 0,void 0,void 0,(function(){var e;return ci(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<_?[4,v()]:[3,4];case 2:if(t.sent())return[2,!0];t.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}}))})))];case 3:if(!y.sent())return[3,15];y.label=4;case 4:return y.trys.push([4,,12,14]),t?[3,6]:[4,this._getEntryFromCache({scope:r.scope,audience:r.audience||"default",client_id:this.options.client_id,getDetailedEntry:e.detailedResponse})];case 5:if(n=y.sent())return[2,n];y.label=6;case 6:return this.options.useRefreshTokens?[4,this._getTokenUsingRefreshToken(r)]:[3,8];case 7:return i=y.sent(),[3,10];case 8:return[4,this._getTokenFromIFrame(r)];case 9:i=y.sent(),y.label=10;case 10:return o=i,[4,this.cacheManager.set(ii({client_id:this.options.client_id},o))];case 11:return y.sent(),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays}),e.detailedResponse?(s=o.id_token,a=o.access_token,c=o.oauthTokenScope,g=o.expires_in,[2,ii(ii({id_token:s,access_token:a},c?{scope:c}:null),{expires_in:g})]):[2,o.access_token];case 12:return[4,rp.releaseLock("auth0.lock.getTokenSilently")];case 13:return y.sent(),[7];case 14:return[3,16];case 15:throw new mh;case 16:return[2]}var v,_}))}))},e.prototype.getTokenWithPopup=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),ai(this,void 0,void 0,(function(){return ci(this,(function(r){switch(r.label){case 0:return e.audience=e.audience||this.options.audience,e.scope=qh(this.defaultScope,this.scope,e.scope),t=ii(ii({},lh),t),[4,this.loginWithPopup(e,t)];case 1:return r.sent(),[4,this.cacheManager.get(new Hh({scope:e.scope,audience:e.audience||"default",client_id:this.options.client_id}))];case 2:return[2,r.sent().access_token]}}))}))},e.prototype.isAuthenticated=function(){return ai(this,void 0,void 0,(function(){return ci(this,(function(e){switch(e.label){case 0:return[4,this.getUser()];case 1:return[2,!!e.sent()]}}))}))},e.prototype.buildLogoutUrl=function(e){void 0===e&&(e={}),null!==e.client_id?e.client_id=e.client_id||this.options.client_id:delete e.client_id;var t=e.federated,r=si(e,["federated"]),n=t?"&federated":"";return this._url("/v2/logout?".concat(Th(r)))+n},e.prototype.logout=function(e){var t=this;void 0===e&&(e={});var r=e.localOnly,n=si(e,["localOnly"]);if(r&&n.federated)throw new Error("It is invalid to set both the `federated` and `localOnly` options to `true`");var o=function(){if(t.cookieStorage.remove(t.orgHintCookieName),t.cookieStorage.remove(t.isAuthenticatedCookieName),!r){var e=t.buildLogoutUrl(n);window.location.assign(e)}};if(this.options.cache)return this.cacheManager.clear().then((function(){return o()}));this.cacheManager.clearSync(),o()},e.prototype._getTokenFromIFrame=function(e){return ai(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g,y,v,_,w,b,E,S,T;return ci(this,(function(I){switch(I.label){case 0:return t=Sh(Ch()),r=Sh(Ch()),n=Ch(),[4,Ih(n)];case 1:o=I.sent(),i=Ah(o),s=si(e,["detailedResponse"]),a=this._getParams(s,t,r,i,e.redirect_uri||this.options.redirect_uri||window.location.origin),(c=this.cookieStorage.get(this.orgHintCookieName))&&!a.organization&&(a.organization=c),g=this._authorizeUrl(ii(ii({},a),{prompt:"none",response_mode:"web_message"})),I.label=2;case 2:if(I.trys.push([2,6,,7]),window.crossOriginIsolated)throw new fh("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");return y=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,[4,(k=g,A=this.domainUrl,R=y,void 0===R&&(R=60),new Promise((function(e,t){var r=window.document.createElement("iframe");r.setAttribute("width","0"),r.setAttribute("height","0"),r.style.display="none";var n,o=function(){window.document.body.contains(r)&&(window.document.body.removeChild(r),window.removeEventListener("message",n,!1))},i=setTimeout((function(){t(new mh),o()}),1e3*R);n=function(r){if(r.origin==A&&r.data&&"authorization_response"===r.data.type){var s=r.source;s&&s.close(),r.data.response.error?t(fh.fromPayload(r.data.response)):e(r.data.response),clearTimeout(i),window.removeEventListener("message",n,!1),setTimeout(o,2e3)}},window.addEventListener("message",n,!1),window.document.body.appendChild(r),r.setAttribute("src",k)})))];case 3:if(v=I.sent(),t!==v.state)throw new Error("Invalid state");return _=e.scope,w=e.audience,b=si(e,["scope","audience","redirect_uri","ignoreCache","timeoutInSeconds","detailedResponse"]),[4,Mh(ii(ii(ii({},this.customOptions),b),{scope:_,audience:w,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:n,code:v.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:b.timeout||this.httpTimeoutMs}),this.worker)];case 4:return E=I.sent(),[4,this._verifyIdToken(E.id_token,r)];case 5:return S=I.sent(),this._processOrgIdHint(S.claims.org_id),[2,ii(ii({},E),{decodedToken:S,scope:a.scope,oauthTokenScope:E.scope,audience:a.audience||"default"})];case 6:throw"login_required"===(T=I.sent()).error&&this.logout({localOnly:!0}),T;case 7:return[2]}var k,A,R}))}))},e.prototype._getTokenUsingRefreshToken=function(e){return ai(this,void 0,void 0,(function(){var t,r,n,o,i,s,a,c,g;return ci(this,(function(y){switch(y.label){case 0:return e.scope=qh(this.defaultScope,this.options.scope,e.scope),[4,this.cacheManager.get(new Hh({scope:e.scope,audience:e.audience||"default",client_id:this.options.client_id}))];case 1:return(t=y.sent())&&t.refresh_token||this.worker?[3,3]:[4,this._getTokenFromIFrame(e)];case 2:return[2,y.sent()];case 3:r=e.redirect_uri||this.options.redirect_uri||window.location.origin,o=e.scope,i=e.audience,s=si(e,["scope","audience","ignoreCache","timeoutInSeconds","detailedResponse"]),a="number"==typeof e.timeoutInSeconds?1e3*e.timeoutInSeconds:null,y.label=4;case 4:return y.trys.push([4,6,,9]),[4,Mh(ii(ii(ii(ii(ii({},this.customOptions),s),{audience:i,scope:o,baseUrl:this.domainUrl,client_id:this.options.client_id,grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:r}),a&&{timeout:a}),{auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs}),this.worker)];case 5:return n=y.sent(),[3,9];case 6:return"The web worker is missing the refresh token"===(c=y.sent()).message||c.message&&c.message.indexOf("invalid refresh token")>-1?[4,this._getTokenFromIFrame(e)]:[3,8];case 7:return[2,y.sent()];case 8:throw c;case 9:return[4,this._verifyIdToken(n.id_token)];case 10:return g=y.sent(),[2,ii(ii({},n),{decodedToken:g,scope:e.scope,oauthTokenScope:n.scope,audience:e.audience||"default"})]}}))}))},e.prototype._getEntryFromCache=function(e){var t=e.scope,r=e.audience,n=e.client_id,o=e.getDetailedEntry,i=void 0!==o&&o;return ai(this,void 0,void 0,(function(){var e,o,s,a,c;return ci(this,(function(g){switch(g.label){case 0:return[4,this.cacheManager.get(new Hh({scope:t,audience:r,client_id:n}),60)];case 1:return(e=g.sent())&&e.access_token?i?(o=e.id_token,s=e.access_token,a=e.oauthTokenScope,c=e.expires_in,[2,ii(ii({id_token:o,access_token:s},a?{scope:a}:null),{expires_in:c})]):[2,e.access_token]:[2]}}))}))},e}();function sp(e){return ai(this,void 0,void 0,(function(){var t;return ci(this,(function(r){switch(r.label){case 0:return[4,(t=new ip(e)).checkSession()];case 1:return r.sent(),[2,t]}}))}))}var ap,cp,up,lp=n(3724),dp=n.n(lp),hp=n(287),pp=n.n(hp),fp=n(4676),gp=n.n(fp),mp=n(7154),yp=n.n(mp),vp=n(612),_p={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},wp=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(wp||{});(up=wp||(wp={})).reset=function(){ap=3,cp=_p},up.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");ap=e},up.setLogger=function(e){cp=e};var bp=class{constructor(e){this._name=e}debug(...e){ap>=4&&cp.debug(bp._format(this._name,this._method),...e)}info(...e){ap>=3&&cp.info(bp._format(this._name,this._method),...e)}warn(...e){ap>=2&&cp.warn(bp._format(this._name,this._method),...e)}error(...e){ap>=1&&cp.error(bp._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const r=new bp(`${e}.${t}`);return r.debug("begin"),r}static _format(e,t){const r=`[${e}]`;return t?`${r} ${t}:`:r}static debug(e,...t){ap>=4&&cp.debug(bp._format(e),...t)}static info(e,...t){ap>=3&&cp.info(bp._format(e),...t)}static warn(e,...t){ap>=2&&cp.warn(bp._format(e),...t)}static error(e,...t){ap>=1&&cp.error(bp._format(e),...t)}};wp.reset();var Ep=class{static _randomWord(){return dp().lib.WordArray.random(1).words[0]}static generateUUIDv4(){const e="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^Ep._randomWord()&15>>+e/4).toString(16)));return e.replace(/-/g,"")}static generateCodeVerifier(){return Ep.generateUUIDv4()+Ep.generateUUIDv4()+Ep.generateUUIDv4()}static generateCodeChallenge(e){try{const t=pp()(e);return gp().stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw bp.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const r=yp().parse([e,t].join(":"));return gp().stringify(r)}},Cp=class{constructor(e){this._name=e,this._logger=new bp(`Event('${this._name}')`),this._callbacks=[]}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}raise(...e){this._logger.debug("raise:",...e);for(const t of this._callbacks)t(...e)}},Sp=class{static decode(e){try{return(0,vp.default)(e)}catch(t){throw bp.error("JwtUtils.decode",t),t}}},Tp=class{static center({...e}){var t;return null==e.width&&(e.width=null!=(t=[800,720,600,480].find((e=>e<=window.outerWidth/1.618)))?t:360),null!=e.left||(e.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-e.width)/2))),null!=e.height&&(null!=e.top||(e.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-e.height)/2)))),e}static serialize(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${e}=${"boolean"!=typeof t?t:t?"yes":"no"}`)).join(",")}},Ip=class extends Cp{constructor(){super(...arguments),this._logger=new bp(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-Ip.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=Ip.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const r=Ip.getEpochTime()+e;if(this.expiration===r&&this._timerHandle)return void t.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),t.debug("using duration",e),this._expiration=r;const n=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*n)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},kp=class{static readParams(e,t="query"){if(!e)throw new TypeError("Invalid URL");const r=new URL(e,"http://127.0.0.1")["fragment"===t?"hash":"search"];return new URLSearchParams(r.slice(1))}},Ap=class extends Error{constructor(e,t){var r,n,o;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw bp.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(r=e.error_description)?r:null,this.error_uri=null!=(n=e.error_uri)?n:null,this.state=e.userState,this.session_state=null!=(o=e.session_state)?o:null}},Rp=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},Pp=class{constructor(e){this._logger=new bp("AccessTokenEvents"),this._expiringTimer=new Ip("Access token expiring"),this._expiredTimer=new Ip("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const r=e.expires_in;if(t.debug("access token present, remaining duration:",r),r>0){let e=r-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;t.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}},Op=class{constructor(){this._logger=new bp("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create(`getItem('${e}')`),this._data[e]}setItem(e,t){this._logger.create(`setItem('${e}')`),this._data[e]=t}removeItem(e){this._logger.create(`removeItem('${e}')`),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},Np=class{constructor(e=[],t=null,r={}){this._jwtHandler=t,this._extraHeaders=r,this._logger=new bp("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e,t={}){const{timeoutInSeconds:r,...n}=t;if(!r)return await fetch(e,n);const o=new AbortController,i=setTimeout((()=>o.abort()),1e3*r);try{return await fetch(e,{...t,signal:o.signal})}catch(s){if(s instanceof DOMException&&"AbortError"===s.name)throw new Rp("Network timed out");throw s}finally{clearTimeout(i)}}async getJson(e,{token:t,credentials:r}={}){const n=this._logger.create("getJson"),o={Accept:this._contentTypes.join(", ")};let i;t&&(n.debug("token passed, setting Authorization header"),o.Authorization="Bearer "+t),this.appendExtraHeaders(o);try{n.debug("url:",e),i=await this.fetchWithTimeout(e,{method:"GET",headers:o,credentials:r})}catch(c){throw n.error("Network Error"),c}n.debug("HTTP response received, status",i.status);const s=i.headers.get("Content-Type");if(s&&!this._contentTypes.find((e=>s.startsWith(e)))&&n.throw(new Error(`Invalid response Content-Type: ${null!=s?s:"undefined"}, from URL: ${e}`)),i.ok&&this._jwtHandler&&(null==s?void 0:s.startsWith("application/jwt")))return await this._jwtHandler(await i.text());let a;try{a=await i.json()}catch(c){if(n.error("Error parsing JSON response",c),i.ok)throw c;throw new Error(`${i.statusText} (${i.status})`)}if(!i.ok){if(n.error("Error from server:",a),a.error)throw new Ap(a);throw new Error(`${i.statusText} (${i.status}): ${JSON.stringify(a)}`)}return a}async postForm(e,{body:t,basicAuth:r,timeoutInSeconds:n,initCredentials:o}){const i=this._logger.create("postForm"),s={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};let a;void 0!==r&&(s.Authorization="Basic "+r),this.appendExtraHeaders(s);try{i.debug("url:",e),a=await this.fetchWithTimeout(e,{method:"POST",headers:s,body:t,timeoutInSeconds:n,credentials:o})}catch(v){throw i.error("Network error"),v}i.debug("HTTP response received, status",a.status);const c=a.headers.get("Content-Type");if(c&&!this._contentTypes.find((e=>c.startsWith(e))))throw new Error(`Invalid response Content-Type: ${null!=c?c:"undefined"}, from URL: ${e}`);const g=await a.text();let y={};if(g)try{y=JSON.parse(g)}catch(v){if(i.error("Error parsing JSON response",v),a.ok)throw v;throw new Error(`${a.statusText} (${a.status})`)}if(!a.ok){if(i.error("Error from server:",y),y.error)throw new Ap(y,t);throw new Error(`${a.statusText} (${a.status}): ${JSON.stringify(y)}`)}return y}appendExtraHeaders(e){const t=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),n=["authorization","accept","content-type"];0!==r.length&&r.forEach((r=>{if(n.includes(r.toLocaleLowerCase()))return void t.warn("Protected header could not be overridden",r,n);const o="function"==typeof this._extraHeaders[r]?this._extraHeaders[r]():this._extraHeaders[r];o&&""!==o&&(e[r]=o)}))}},Up=class{constructor({prefix:e="oidc.",store:t=localStorage}={}){this._logger=new bp("WebStorageStateStore"),this._store=t,this._prefix=e}async set(e,t){this._logger.create(`set('${e}')`),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create(`get('${e}')`),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create(`remove('${e}')`),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let r=0;r<e;r++){const e=await this._store.key(r);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}},Mp=class{constructor({authority:e,metadataUrl:t,metadata:r,signingKeys:n,metadataSeed:o,client_id:i,client_secret:s,response_type:a="code",scope:c="openid",redirect_uri:g,post_logout_redirect_uri:y,client_authentication:v="client_secret_post",prompt:_,display:w,max_age:b,ui_locales:E,acr_values:S,resource:T,response_mode:I="query",filterProtocolClaims:k=!0,loadUserInfo:A=!1,staleStateAgeInSeconds:R=900,clockSkewInSeconds:O=300,userInfoJwtIssuer:N="OP",mergeClaims:U=!1,disablePKCE:M=!1,stateStore:q,refreshTokenCredentials:H,revokeTokenAdditionalContentTypes:L,fetchRequestCredentials:D,refreshTokenAllowedScope:K,extraQueryParams:F={},extraTokenParams:j={},extraHeaders:G={}}){if(this.authority=e,t?this.metadataUrl=t:(this.metadataUrl=e,e&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=o,this.signingKeys=n,this.client_id=i,this.client_secret=s,this.response_type=a,this.scope=c,this.redirect_uri=g,this.post_logout_redirect_uri=y,this.client_authentication=v,this.prompt=_,this.display=w,this.max_age=b,this.ui_locales=E,this.acr_values=S,this.resource=T,this.response_mode=I,this.filterProtocolClaims=null==k||k,this.loadUserInfo=!!A,this.staleStateAgeInSeconds=R,this.clockSkewInSeconds=O,this.userInfoJwtIssuer=N,this.mergeClaims=!!U,this.disablePKCE=!!M,this.revokeTokenAdditionalContentTypes=L,D&&H&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=D||(H||"same-origin"),q)this.stateStore=q;else{const e="undefined"!=typeof window?window.localStorage:new Op;this.stateStore=new Up({store:e})}this.refreshTokenAllowedScope=K,this.extraQueryParams=F,this.extraTokenParams=j,this.extraHeaders=G}},xp=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new bp("TokenClient"),this._jsonService=new Np(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode({grant_type:e="authorization_code",redirect_uri:t=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,...o}){const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),t||i.throw(new Error("A redirect_uri is required")),o.code||i.throw(new Error("A code is required"));const s=new URLSearchParams({grant_type:e,redirect_uri:t});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;a=Ep.generateBasicAuth(r,n);break;case"client_secret_post":s.append("client_id",r),n&&s.append("client_secret",n)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeCredentials({grant_type:e="password",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...o}){const i=this._logger.create("exchangeCredentials");t||i.throw(new Error("A client_id is required"));const s=new URLSearchParams({grant_type:e,scope:n});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=Ep.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async exchangeRefreshToken({grant_type:e="refresh_token",client_id:t=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,...o}){const i=this._logger.create("exchangeRefreshToken");t||i.throw(new Error("A client_id is required")),o.refresh_token||i.throw(new Error("A refresh_token is required"));const s=new URLSearchParams({grant_type:e});for(const[y,v]of Object.entries(o))null!=v&&s.set(y,v);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;a=Ep.generateBasicAuth(t,r);break;case"client_secret_post":s.append("client_id",t),r&&s.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const g=await this._jsonService.postForm(c,{body:s,basicAuth:a,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),g}async revoke(e){var t;const r=this._logger.create("revoke");e.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${null!=(t=e.token_type_hint)?t:"default token type"}`);const o=new URLSearchParams;for(const[i,s]of Object.entries(e))null!=s&&o.set(i,s);o.set("client_id",this._settings.client_id),this._settings.client_secret&&o.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:o}),r.debug("got response")}},qp=class{constructor(e){this.id=e.id||Ep.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=Ip.getEpochTime(),this.request_type=e.request_type}toStorageString(){return new bp("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})}static fromStorageString(e){return bp.createStatic("State","fromStorageString"),new qp(JSON.parse(e))}static async clearStaleState(e,t){const r=bp.createStatic("State","clearStaleState"),n=Ip.getEpochTime()-t,o=await e.getAllKeys();r.debug("got keys",o);for(let s=0;s<o.length;s++){const t=o[s],a=await e.get(t);let c=!1;if(a)try{const e=qp.fromStorageString(a);r.debug("got item from key:",t,e.created),e.created<=n&&(c=!0)}catch(i){r.error("Error parsing state for key:",t,i),c=!0}else r.debug("no item in storage for key:",t),c=!0;c&&(r.debug("removed item for key:",t),e.remove(t))}}},Hp=class extends qp{constructor(e){super(e),!0===e.code_verifier?this.code_verifier=Ep.generateCodeVerifier():e.code_verifier&&(this.code_verifier=e.code_verifier),this.code_verifier&&(this.code_challenge=Ep.generateCodeChallenge(this.code_verifier)),this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}toStorageString(){return new bp("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){bp.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return new Hp(t)}},Lp=class{constructor(e){this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Ip.getEpochTime()}set expires_in(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+Ip.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},Dp=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],Kp=["sub","iss","aud","exp","iat"],Fp=class{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Ip.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+Ip.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new bp("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return bp.createStatic("User","fromStorageString"),new Fp(JSON.parse(e))}},jp="oidc-client",Bp=class{constructor(){this._abort=new Cp("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:r,keepOpen:n}=await new Promise(((r,n)=>{const o=o=>{var i;const s=o.data,a=null!=(i=e.scriptOrigin)?i:window.location.origin;if(o.origin===a&&(null==s?void 0:s.source)===jp){try{const r=kp.readParams(s.url,e.response_mode).get("state");if(r||t.warn("no state found in response url"),o.source!==this._window&&r!==e.state)return}catch(c){this._dispose(),n(new Error("Invalid response from window"))}r(s)}};window.addEventListener("message",o,!1),this._disposeHandlers.add((()=>window.removeEventListener("message",o,!1))),this._disposeHandlers.add(this._abort.addHandler((e=>{this._dispose(),n(e)})))}));return t.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t,r=!1,n=window.location.origin){e.postMessage({source:jp,url:t,keepOpen:r},n)}},Gp={location:!1,toolbar:!1,height:640},Wp="_blank",zp=60,Yp=2,Vp=10,Jp=class extends Mp{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:r=e.post_logout_redirect_uri,popupWindowFeatures:n=Gp,popupWindowTarget:o=Wp,redirectMethod:i="assign",redirectTarget:s="self",iframeNotifyParentOrigin:a=e.iframeNotifyParentOrigin,iframeScriptOrigin:c=e.iframeScriptOrigin,silent_redirect_uri:g=e.redirect_uri,silentRequestTimeoutInSeconds:y=Vp,automaticSilentRenew:v=!0,validateSubOnSilentRenew:_=!0,includeIdTokenInSilentRenew:w=!1,monitorSession:b=!1,monitorAnonymousSession:E=!1,checkSessionIntervalInSeconds:S=Yp,query_status_response_type:T="code",stopCheckSessionOnError:I=!0,revokeTokenTypes:k=["access_token","refresh_token"],revokeTokensOnSignout:A=!1,includeIdTokenInSilentSignout:R=!1,accessTokenExpiringNotificationTimeInSeconds:O=zp,userStore:N}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=o,this.redirectMethod=i,this.redirectTarget=s,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=c,this.silent_redirect_uri=g,this.silentRequestTimeoutInSeconds=y,this.automaticSilentRenew=v,this.validateSubOnSilentRenew=_,this.includeIdTokenInSilentRenew=w,this.monitorSession=b,this.monitorAnonymousSession=E,this.checkSessionIntervalInSeconds=S,this.stopCheckSessionOnError=I,this.query_status_response_type=T,this.revokeTokenTypes=k,this.revokeTokensOnSignout=A,this.includeIdTokenInSilentSignout=R,this.accessTokenExpiringNotificationTimeInSeconds=O,N)this.userStore=N;else{const e="undefined"!=typeof window?window.sessionStorage:new Op;this.userStore=new Up({store:e})}}},Xp=class extends Bp{constructor({silentRequestTimeoutInSeconds:e=Vp}){super(),this._logger=new bp("IFrameWindow"),this._timeoutInSeconds=e,this._frame=Xp.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout((()=>this._abort.raise(new Rp("IFrame timed out without a response"))),1e3*this._timeoutInSeconds);return this._disposeHandlers.add((()=>clearTimeout(t))),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(e=>{var t;const r=e.target;null==(t=r.parentNode)||t.removeChild(r),this._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},Zp=class extends Bp{constructor({popupWindowTarget:e=Wp,popupWindowFeatures:t={}}){super(),this._logger=new bp("PopupWindow");const r=Tp.center({...Gp,...t});this._window=window.open(void 0,e,Tp.serialize(r))}async navigate(e){var t;null==(t=this._window)||t.focus();const r=setInterval((()=>{this._window&&!this._window.closed||this._abort.raise(new Error("Popup closed by user"))}),500);return this._disposeHandlers.add((()=>clearInterval(r))),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,t)}},Qp=class extends Pp{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new bp("UserManagerEvents"),this._userLoaded=new Cp("User loaded"),this._userUnloaded=new Cp("User unloaded"),this._silentRenewError=new Cp("Silent renew error"),this._userSignedIn=new Cp("User signed in"),this._userSignedOut=new Cp("User signed out"),this._userSessionChanged=new Cp("User session changed")}load(e,t=!0){super.load(e),t&&this._userLoaded.raise(e)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}_raiseSilentRenewError(e){this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},$p=class{constructor(e){this._logger=new bp("UserManager"),this.settings=new Jp(e),this._client=new class{constructor(e){this._logger=new bp("OidcClient"),this.settings=new Mp(e),this.metadataService=new class{constructor(e){this._settings=e,this._logger=new bp("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new Np(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,t),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(e=!0){return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(e=!0){return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(e=!0){return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e,t=!1){const r=this._logger.create(`_getMetadataProperty('${e}')`),n=await this.getMetadata();if(r.debug("resolved"),void 0===n[e]){if(!0===t)return void r.warn("Metadata does not contain optional property");r.throw(new Error("Metadata does not contain property "+e))}return n[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const r=await this._jsonService.getJson(t);if(e.debug("got key set",r),!Array.isArray(r.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}}(this.settings),this._claimsService=new class{constructor(e){this._settings=e,this._logger=new bp("ClaimsService")}filterProtocolClaims(e){const t={...e};if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:Dp;for(const r of e)Kp.includes(r)||delete t[r]}return t}mergeClaims(e,t){const r={...e};for(const[n,o]of Object.entries(t))for(const e of Array.isArray(o)?o:[o]){const t=r[n];t?Array.isArray(t)?t.includes(e)||t.push(e):r[n]!==e&&("object"==typeof e&&this._settings.mergeClaims?r[n]=this.mergeClaims(t,e):r[n]=[t,e]):r[n]=e}return r}}(this.settings),this._validator=new class{constructor(e,t,r){this._settings=e,this._metadataService=t,this._claimsService=r,this._logger=new bp("ResponseValidator"),this._userInfoService=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new bp("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const r=Sp.decode(e);return t.debug("JWT decoding successful"),r}catch(r){throw t.error("Error parsing JWT response"),r}},this._jsonService=new Np(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:e,credentials:this._settings.fetchRequestCredentials});return t.debug("got claims",n),n}}(this._settings,this._metadataService),this._tokenClient=new xp(this._settings,this._metadataService)}async validateSigninResponse(e,t){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const r=this._logger.create("validateCredentialsResponse");e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,t,e.isOpenId),r.debug("claims processed")}async validateRefreshResponse(e,t){const r=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),r.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const n=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,n),r.debug("claims processed")}validateSignoutResponse(e,t){const r=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&r.throw(new Error("State does not match")),r.debug("state validated"),e.userState=t.data,e.error)throw r.warn("Response was error",e.error),new Ap(e)}_processSigninState(e,t){const r=this._logger.create("_processSigninState");if(t.id!==e.state&&r.throw(new Error("State does not match")),t.client_id||r.throw(new Error("No client_id on state")),t.authority||r.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&r.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&r.throw(new Error("client_id mismatch on settings vs. signin state")),r.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw r.warn("Response was error",e.error),new Ap(e);t.code_verifier&&!e.code&&r.throw(new Error("Expected code in response"))}async _processClaims(e,t=!1,r=!0){const n=this._logger.create("_processClaims");if(e.profile=this._claimsService.filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void n.debug("not loading user info");n.debug("loading user info");const o=await this._userInfoService.getClaims(e.access_token);n.debug("user info claims received from user info endpoint"),r&&o.sub!==e.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._claimsService.mergeClaims(e.profile,this._claimsService.filterProtocolClaims(o)),n.debug("user info claims received, updated profile:",e.profile)}async _processCode(e,t){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,...t.extraTokenParams});Object.assign(e,n)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const o=Sp.decode(null!=(r=e.id_token)?r:"");if(o.sub||n.throw(new Error("ID Token is missing a subject claim")),t){const e=Sp.decode(t);o.sub!==e.sub&&n.throw(new Error("sub in id_token does not match current sub")),o.auth_time&&o.auth_time!==e.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),o.azp&&o.azp!==e.azp&&n.throw(new Error("azp in id_token does not match original azp")),!o.azp&&e.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=o}}(this.settings,this.metadataService,this._claimsService),this._tokenClient=new xp(this.settings,this.metadataService)}async createSigninRequest({state:e,request:t,request_uri:r,request_type:n,id_token_hint:o,login_hint:i,skipUserInfo:s,nonce:a,response_type:c=this.settings.response_type,scope:g=this.settings.scope,redirect_uri:y=this.settings.redirect_uri,prompt:v=this.settings.prompt,display:_=this.settings.display,max_age:w=this.settings.max_age,ui_locales:b=this.settings.ui_locales,acr_values:E=this.settings.acr_values,resource:S=this.settings.resource,response_mode:T=this.settings.response_mode,extraQueryParams:I=this.settings.extraQueryParams,extraTokenParams:k=this.settings.extraTokenParams}){const A=this._logger.create("createSigninRequest");if("code"!==c)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const R=await this.metadataService.getAuthorizationEndpoint();A.debug("Received authorization endpoint",R);const O=new class{constructor({url:e,authority:t,client_id:r,redirect_uri:n,response_type:o,scope:i,state_data:s,response_mode:a,request_type:c,client_secret:g,nonce:y,resource:v,skipUserInfo:_,extraQueryParams:w,extraTokenParams:b,disablePKCE:E,...S}){if(this._logger=new bp("SigninRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!o)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!i)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!t)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new Hp({data:s,request_type:c,code_verifier:!E,client_id:r,authority:t,redirect_uri:n,response_mode:a,client_secret:g,scope:i,extraTokenParams:b,skipUserInfo:_});const T=new URL(e);T.searchParams.append("client_id",r),T.searchParams.append("redirect_uri",n),T.searchParams.append("response_type",o),T.searchParams.append("scope",i),y&&T.searchParams.append("nonce",y),T.searchParams.append("state",this.state.id),this.state.code_challenge&&(T.searchParams.append("code_challenge",this.state.code_challenge),T.searchParams.append("code_challenge_method","S256")),v&&(Array.isArray(v)?v:[v]).forEach((e=>T.searchParams.append("resource",e)));for(const[I,k]of Object.entries({response_mode:a,...S,...w}))null!=k&&T.searchParams.append(I,k.toString());this.url=T.href}}({url:R,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:y,response_type:c,scope:g,state_data:e,prompt:v,display:_,max_age:w,ui_locales:b,id_token_hint:o,login_hint:i,acr_values:E,resource:S,request:t,request_uri:r,extraQueryParams:I,extraTokenParams:k,request_type:n,response_mode:T,client_secret:this.settings.client_secret,skipUserInfo:s,nonce:a,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const N=O.state;return await this.settings.stateStore.set(N.id,N.toStorageString()),O}async readSigninResponseState(e,t=!1){const r=this._logger.create("readSigninResponseState"),n=new Lp(kp.readParams(e,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:Hp.fromStorageString(o),response:n}}async processSigninResponse(e){const t=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(e,!0);return t.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r=!1,extraTokenParams:n={}}){const o=await this._tokenClient.exchangeCredentials({username:e,password:t,...n}),i=new Lp(new URLSearchParams);return Object.assign(i,o),await this._validator.validateCredentialsResponse(i,r),i}async useRefreshToken({state:e,timeoutInSeconds:t}){var r;const n=this._logger.create("useRefreshToken");let o;if(void 0===this.settings.refreshTokenAllowedScope)o=e.scope;else{const t=this.settings.refreshTokenAllowedScope.split(" ");o=((null==(r=e.scope)?void 0:r.split(" "))||[]).filter((e=>t.includes(e))).join(" ")}const i=await this._tokenClient.exchangeRefreshToken({refresh_token:e.refresh_token,scope:o,timeoutInSeconds:t}),s=new Lp(new URLSearchParams);return Object.assign(s,i),n.debug("validating response",s),await this._validator.validateRefreshResponse(s,{...e,scope:o}),s}async createSignoutRequest({state:e,id_token_hint:t,request_type:r,post_logout_redirect_uri:n=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}={}){const i=this._logger.create("createSignoutRequest"),s=await this.metadataService.getEndSessionEndpoint();if(!s)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",s);const a=new class{constructor({url:e,state_data:t,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:o,request_type:i}){if(this._logger=new bp("SignoutRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");const s=new URL(e);r&&s.searchParams.append("id_token_hint",r),n&&(s.searchParams.append("post_logout_redirect_uri",n),t&&(this.state=new qp({data:t,request_type:i}),s.searchParams.append("state",this.state.id)));for(const[a,c]of Object.entries({...o}))null!=c&&s.searchParams.append(a,c.toString());this.url=s.href}}({url:s,id_token_hint:t,post_logout_redirect_uri:n,state_data:e,extraQueryParams:o,request_type:r});await this.clearStaleState();const c=a.state;return c&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(c.id,c.toStorageString())),a}async readSignoutResponseState(e,t=!1){const r=this._logger.create("readSignoutResponseState"),n=new class{constructor(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}}(kp.readParams(e,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new Ap(n);return{state:void 0,response:n}}const o=await this.settings.stateStore[t?"remove":"get"](n.state);if(!o)throw r.throw(new Error("No matching state found in storage")),null;return{state:qp.fromStorageString(o),response:n}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(e,!0);return r?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):t.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),qp.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}}(e),this._redirectNavigator=new class{constructor(e){this._settings=e,this._logger=new bp("RedirectNavigator")}async prepare({redirectMethod:e=this._settings.redirectMethod,redirectTarget:t=this._settings.redirectTarget}){var r;this._logger.create("prepare");let n=window.self;"top"===t&&(n=null!=(r=window.top)?r:window.self);const o=n.location[e].bind(n.location);let i;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise(((e,t)=>{i=t}));return o(e.url),await t},close:()=>{this._logger.create("close"),null==i||i(new Error("Redirect aborted")),n.stop()}}}}(this.settings),this._popupNavigator=new class{constructor(e){this._settings=e,this._logger=new bp("PopupNavigator")}async prepare({popupWindowFeatures:e=this._settings.popupWindowFeatures,popupWindowTarget:t=this._settings.popupWindowTarget}){return new Zp({popupWindowFeatures:e,popupWindowTarget:t})}async callback(e,t=!1){this._logger.create("callback"),Zp.notifyOpener(e,t)}}(this.settings),this._iframeNavigator=new class{constructor(e){this._settings=e,this._logger=new bp("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:e=this._settings.silentRequestTimeoutInSeconds}){return new Xp({silentRequestTimeoutInSeconds:e})}async callback(e){this._logger.create("callback"),Xp.notifyParent(e,this._settings.iframeNotifyParentOrigin)}}(this.settings),this._events=new Qp(this.settings),this._silentRenewService=new class{constructor(e){this._userManager=e,this._logger=new bp("SilentRenewService"),this._isStarted=!1,this._retryTimer=new Ip("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof Rp)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new class{constructor(e){this._userManager=e,this._logger=new bp("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const r=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,r.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,r.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){r.debug("initializing check session iframe");const n=this._userManager.settings.client_id,o=this._userManager.settings.checkSessionIntervalInSeconds,i=this._userManager.settings.stopCheckSessionOnError,s=new class{constructor(e,t,r,n,o){this._callback=e,this._client_id=t,this._intervalInSeconds=n,this._stopOnError=o,this._logger=new bp("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const i=new URL(r);this._frame_origin=i.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=i.href}load(){return new Promise((e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)}))}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}}(this._callback,n,e,o,i);await s.load(),this._checkSessionIFrame=s,s.start(t)}else r.warn("no check session iframe found in the metadata")}catch(n){r.error("Error from getCheckSessionIframe:",n instanceof Error?n.message:n)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval((async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}catch(r){e.error("error from querySessionStatus",r instanceof Error?r.message:r)}}),1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let r=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(r=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",t.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),r?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((e=>{this._logger.error(e)}))}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}}}(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),this._events.load(t,!1),t):(e.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),this._events.unload()}async signinRedirect(e={}){this._logger.create("signinRedirect");const{redirectMethod:t,...r}=e,n=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(e=window.location.href){const t=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(e);return r.profile&&r.profile.sub?t.info("success, signed in subject",r.profile.sub):t.info("no subject"),r}async signinResourceOwnerCredentials({username:e,password:t,skipUserInfo:r=!1}){const n=this._logger.create("signinResourceOwnerCredential"),o=await this._client.processResourceOwnerPasswordCredentials({username:e,password:t,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});n.debug("got signin response");const i=await this._buildUser(o);return i.profile&&i.profile.sub?n.info("success, signed in subject",i.profile.sub):n.info("no subject"),i}async signinPopup(e={}){const t=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_redirect_uri;i||t.throw(new Error("No popup_redirect_uri configured"));const s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),a=await this._signin({request_type:"si:p",redirect_uri:i,display:"popup",...o},s);return a&&(a.profile&&a.profile.sub?t.info("success, signed in subject",a.profile.sub):t.info("no subject")),a}async signinPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async signinSilent(e={}){var t;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,...o}=e;let i=await this._loadUser();if(null==i?void 0:i.refresh_token){r.debug("using refresh token");const e=new class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}}(i);return await this._useRefreshToken(e)}const s=this.settings.silent_redirect_uri;let a;s||r.throw(new Error("No silent_redirect_uri configured")),i&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",i.profile.sub),a=i.profile.sub);const c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return i=await this._signin({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,...o},c,a),i&&((null==(t=i.profile)?void 0:t.sub)?r.info("success, signed in subject",i.profile.sub):r.info("no subject")),i}async _useRefreshToken(e){const t=await this._client.useRefreshToken({state:e,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new Fp({...e,...t});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(e=window.location.href){const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(e=window.location.href){const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":return await this.signinPopupCallback(e);case"si:s":return await this.signinSilentCallback(e);default:throw new Error("invalid response_type in state")}}async signoutCallback(e=window.location.href,t=!1){const{state:r}=await this._client.readSignoutResponseState(e);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(e);break;case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(e={}){const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=e,o=this.settings.silent_redirect_uri;o||t.throw(new Error("No silent_redirect_uri configured"));const i=await this._loadUser(),s=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),a=await this._signinStart({request_type:"si:s",redirect_uri:o,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==i?void 0:i.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},s);try{const e=await this._client.processSigninResponse(a.url);return t.debug("got signin response"),e.session_state&&e.profile.sub?(t.info("success for subject",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid}):(t.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof Ap)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:c.session_state}}throw c}}async _signin(e,t,r){const n=await this._signinStart(e,t);return await this._signinEnd(n.url,r)}async _signinStart(e,t){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(e);return r.debug("got signin request"),await t.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(n){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),n}}async _signinEnd(e,t){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(e);r.debug("got signin response");return await this._buildUser(n,t)}async _buildUser(e,t){const r=this._logger.create("_buildUser"),n=new Fp(e);if(t){if(t!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new Ap({...e,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(e={}){const t=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=e,o=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},o),t.info("success")}async signoutRedirectCallback(e=window.location.href){const t=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(e);return t.info("success"),r}async signoutPopup(e={}){const t=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...o}=e,i=this.settings.popup_post_logout_redirect_uri,s=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:i,state:null==i?void 0:{},...o},s),t.info("success")}async signoutPopupCallback(e=window.location.href,t=!1){const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,t),r.info("success")}async _signout(e,t){const r=await this._signoutStart(e,t);return await this._signoutEnd(r.url)}async _signoutStart(e={},t){var r;const n=this._logger.create("_signoutStart");try{const o=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(o);const i=e.id_token_hint||o&&o.id_token;i&&(n.debug("setting id_token_hint in signout request"),e.id_token_hint=i),await this.removeUser(),n.debug("user removed, creating signout request");const s=await this._client.createSignoutRequest(e);return n.debug("got signout request"),await t.navigate({url:s.url,state:null==(r=s.state)?void 0:r.id})}catch(o){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),o}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(e);return t.debug("got signout response"),r}async signoutSilent(e={}){var t;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...o}=e,i=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,s=this.settings.popup_post_logout_redirect_uri,a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:s,id_token_hint:i,...o},a),r.info("success")}async signoutSilentCallback(e=window.location.href){const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e,t=this.settings.revokeTokenTypes){const r=this._logger.create("_revokeInternal");if(!e)return;const n=t.filter((t=>"string"==typeof e[t]));if(n.length){for(const t of n)await this._client.revokeToken(e[t],t),r.info(`${t} revoked successfully`),"access_token"!==t&&(e[t]=null);await this.storeUser(e),r.debug("user stored"),this._events.load(e)}else r.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),Fp.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const r=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}};const ef=e=>new $p({authority:e.authority,client_id:e.client_id,redirect_uri:window.location.href,scope:"openid offline_access email profile",automaticSilentRenew:!0,userStore:new Up({store:window.localStorage,prefix:`oidc:user:${e.authority}/`}),stateStore:new Up({store:window.localStorage,prefix:`oidc:state:${e.authority}/`})});let tf;const rf=e=>new $p({authority:e.realm?`${e.authority}/realms/${e.realm}`:e.authority,client_id:e.client_id,redirect_uri:window.location.href,scope:e.realm?`openid profile https://${e.cluster} user_impersonation IDENTITY`:e.audience,automaticSilentRenew:!1,userStore:new Up({store:window.localStorage,prefix:e.realm?`oidc:user:${e.authority}/realms/${e.realm}`:`oidc:user:${e.authority}/`}),stateStore:new Up({store:window.localStorage,prefix:e.realm?`oidc:state:${e.authority}/realms/${e.realm}`:`oidc:state:${e.authority}/`})});let nf;const of=Bo(),sf=Go(),af=jo(),cf=()=>`cognite-app-legacy-access-token_${null!=of?of:sf}_${af}`,uf=()=>e(void 0,void 0,void 0,(function*(){const e=yield Yo(),t=new i.tU({project:af,baseUrl:e});let r=yield t.handleLoginRedirect();if(r)return sessionStorage.setItem(cf(),r.accessToken),r.accessToken;if(r=yield t.login({onAuthenticate:i.RQ}),r)return r.accessToken;throw new Error("could not get access token")}));class FusionTokenProvider{getAppId(){return"fusion.cognite.com"}getToken(){return e(this,void 0,void 0,(function*(){const t=yield zo();switch(t.type){case"AZURE_AD":return function(t,r){return e(this,void 0,void 0,(function*(){const e=yield Yo(),n=[`${e}/IDENTITY`,`${e}/user_impersonation`],o=new xo({auth:Vo(t,r),cache:Jo}),i=yield o.handleRedirectPromise();i&&o.setActiveAccount(i.account);const s=o.getActiveAccount();try{if(!s)throw new Error("no user found");const{accessToken:e}=yield o.acquireTokenSilent({account:s,scopes:n});return e}catch(ni){yield o.loginRedirect({prompt:"select_account",scopes:n,redirectStartPage:window.location.href})}throw new Error("Access token was not found")}))}(t.authority,t.appConfiguration.clientId);case"COGNITE_AUTH":return function(){var t;return e(this,void 0,void 0,(function*(){const e=yield Yo(),r=cf(),n=sessionStorage.getItem(r);if(n)try{const r=`${e}/login/status`,o=null===(t=yield fetch(r,{headers:{Authorization:`Bearer ${n}`}}).then((e=>e.json())))||void 0===t?void 0:t.data;if(o.loggedIn)return n;throw new Error("expired token")}catch(ni){return sessionStorage.removeItem(r),uf()}return uf()}))}();case"ADFS2016":return ti(`${t.authority}/authorize`,t.appConfiguration.clientId);case"AUTH0":return function(t,r,n){return e(this,void 0,void 0,(function*(){const e=yield sp({domain:r,client_id:t,cacheLocation:"localstorage",audience:n,useRefreshTokens:!0,redirect_uri:window.location.href}),o=yield e.getTokenSilently();if(!o)throw new Error("Token not found");return o}))}(t.appConfiguration.clientId,t.authority,t.appConfiguration.audience);case"KEYCLOAK":{const e=t,n=yield(r={authority:e.authority,clientId:e.appConfiguration.clientId,cluster:e.clusters[0],realm:e.realm,audience:e.appConfiguration.audience},nf||(nf=new Promise(((e,t)=>{const n=rf(Object.assign({client_id:r.clientId},r));n.getUser().then((e=>(null==e?void 0:e.expired)?n.signinSilent():e)).then((t=>e(t.access_token))).catch((e=>{t(e)})).finally((()=>n.clearStaleState()))})),nf.then((()=>{nf=void 0})),nf));return n}case"COGNITE_IDP":{const r=t,n=yield(t=>e(void 0,void 0,void 0,(function*(){return tf||(tf=new Promise(((e,r)=>{const n=ef({authority:t.authority,client_id:t.clientId});n.getUser().then((e=>(null==e?void 0:e.expired)?n.signinSilent():e)).then((t=>e(t.access_token))).catch(r).finally((()=>n.clearStaleState()))})),tf.then((()=>{tf=void 0})),tf)})))({authority:r.authority,clientId:r.appConfiguration.clientId});return n}default:throw new Error("Unknown login type")}var r}))}getUserInformation(){return e(this,void 0,void 0,(function*(){const t=yield zo();switch(t.type){case"AZURE_AD":return function(t,r){return e(this,void 0,void 0,(function*(){const e=new xo({auth:Vo(t,r),cache:Jo}),n=e.getActiveAccount();if(!n)throw new Error("no user found");const o=yield e.acquireTokenSilent({account:n,scopes:["User.Read"]}),i=yield fetch("https://graph.microsoft.com/v1.0/me",{headers:{"content-type":"application/json",authorization:`Bearer ${o.accessToken}`}}).then((e=>e.json()));return i}))}(t.authority,t.appConfiguration.clientId);case"AUTH0":return function(t,r,n){return e(this,void 0,void 0,(function*(){const e=yield sp({domain:r,client_id:t,cacheLocation:"localstorage",audience:n,useRefreshTokens:!0,redirect_uri:window.location.href}),o=yield e.getUser();return{id:o.sub,displayName:o.name,userPrincipalName:o.sub,mail:o.email}}))}(t.appConfiguration.clientId,t.authority,t.appConfiguration.audience);case"KEYCLOAK":{const n=t;return r={authority:n.authority,clientId:n.appConfiguration.clientId,cluster:n.clusters[0],realm:n.realm,audience:n.appConfiguration.audience},e(void 0,void 0,void 0,(function*(){const e=rf(Object.assign({client_id:r.clientId},r)),t=yield e.getUser();return{id:(null==t?void 0:t.profile.sid)||(null==t?void 0:t.profile.subid),displayName:(null==t?void 0:t.profile.preferred_username)||(null==t?void 0:t.profile.name),mail:null==t?void 0:t.profile.email,userPrincipalName:null==t?void 0:t.profile.sub}}))}case"COGNITE_IDP":{const r=t;return(t=>e(void 0,void 0,void 0,(function*(){const e=ef({authority:t.authority,client_id:t.clientId}),r=yield e.getUser();return{id:r.profile.sub,displayName:r.profile.name,mail:r.profile.email,userPrincipalName:r.profile.sub,profilePicture:r.profile.picture}})))({authority:r.authority,clientId:r.appConfiguration.clientId})}default:throw new Error("Unknown login type")}var r}))}getFlow(){var e;const{type:t}=null!==(e=c())&&void 0!==e?e:{};return{flow:t}}logout(){return e(this,void 0,void 0,(function*(){const t=yield zo();switch(t.type){case"AZURE_AD":yield function(t,r){return e(this,void 0,void 0,(function*(){const e=new xo({auth:Vo(t,r),cache:Jo}),n=e.getActiveAccount();e.logoutRedirect({account:n,onRedirectNavigate:()=>!1}),e.setActiveAccount(null)}))}(t.authority,t.appConfiguration.clientId);break;case"AUTH0":yield function(t,r,n){return e(this,void 0,void 0,(function*(){const e=yield sp({domain:r,client_id:t,cacheLocation:"localstorage",audience:n,useRefreshTokens:!0,redirect_uri:window.location.href});yield e.logout({returnTo:window.location.origin})}))}(t.appConfiguration.clientId,t.authority,t.appConfiguration.audience);break;case"ADFS2016":ri(t.authority);break;case"COGNITE_AUTH":!function(){const e=cf();sessionStorage.removeItem(e)}();break;case"KEYCLOAK":{const n=t;yield(r={authority:n.authority,clientId:n.appConfiguration.clientId,cluster:n.clusters[0],realm:n.realm,audience:n.appConfiguration.audience},e(void 0,void 0,void 0,(function*(){const e=rf(Object.assign({client_id:r.clientId},r));yield e.signoutRedirect({post_logout_redirect_uri:window.location.origin})})));break}case"COGNITE_IDP":{const r=t;yield(t=>e(void 0,void 0,void 0,(function*(){const e=ef({authority:t.authority,client_id:t.clientId});yield e.signoutRedirect({post_logout_redirect_uri:window.location.origin})})))({authority:r.authority,clientId:r.appConfiguration.clientId});break}}var r;window.location.href="/"}))}}var lf,df=n(1577);"undefined"!=typeof System&&(0,df.m)("@cognite/cdf-sdk-singleton");const{organization:hf,cluster:pf,idpInternalId:ff}=null!==(lf=(0,r.readLoginHints)())&&void 0!==lf?lf:{},gf=()=>e(void 0,void 0,void 0,(function*(){if(!hf||!ff||!pf)return Promise.reject(new Error("Missing login hints"));const e=yield(0,r.getDlc)(hf),t=yield(0,r.getIdp)(e.idps,ff);return t?new r.OidcService(t,hf,pf):Promise.reject(new Error("Missing idp"))}));class UnifiedSigninTokenProvider{getAppId(){return"apps.cognite.com/cdf"}getToken(){var t;return e(this,void 0,void 0,(function*(){yield this.initService();const e=null===(t=this.service)||void 0===t?void 0:t.acquireTokenSilent(pf);if(!e)throw new Error("Token not found");return e}))}getUserInformation(){var t;return e(this,void 0,void 0,(function*(){yield this.initService();const e=yield null===(t=this.service)||void 0===t?void 0:t.getUser();if(!e)throw new Error("User not found");return Object.assign({id:null==e?void 0:e.id,mail:null==e?void 0:e.email,displayName:null==e?void 0:e.name},e)}))}getFlow(){var t;return e(this,void 0,void 0,(function*(){yield this.initService();return{flow:null===(t=this.service)||void 0===t?void 0:t.idp.type}}))}logout(){var t;return e(this,void 0,void 0,(function*(){yield this.initService(),null===(t=this.service)||void 0===t||t.logout()}))}initService(){return e(this,void 0,void 0,(function*(){this.service||(this.service=yield gf()),this.service.idp.internalId!==ff&&(this.service=yield gf())}))}}const mf=Bo(),yf=jo();let vf=Do()?new UnifiedSigninTokenProvider:new FusionTokenProvider;const _f=(e,t)=>(vf=t||Do()?new UnifiedSigninTokenProvider:new FusionTokenProvider,new i.c6(Object.assign(Object.assign({},e),{appId:vf.getAppId(),getToken:If}))),wf=(bf=_f({appId:vf.getAppId(),baseUrl:mf?Wo(mf):void 0,project:yf}),bf=Object(bf),new Proxy(new WrappedSdkClient(bf),{get:function(e,t,r){return"overrideInstance"===t?e.overrideInstance:e.instance[t]}}));var bf;const Ef=t=>e(void 0,void 0,void 0,(function*(){const e=yield Yo();return t?new i.c6(t):new i.c6({appId:vf.getAppId(),getToken:If,baseUrl:e,project:yf})})),Cf=mf?Promise.resolve():Yo().then((e=>{e&&e!==wf.getBaseUrl()&&sdkSingelton.httpClient.setBaseUrl(Wo(e))}));function Sf(){return e(this,void 0,void 0,(function*(){return vf.getUserInformation()}))}function Tf(){return vf.getFlow()}function If(){return e(this,void 0,void 0,(function*(){return(null===window||void 0===window?void 0:window.testAuthOverrides)?window.testAuthOverrides.getToken():(yield Cf,vf.getToken())}))}function kf(){return e(this,void 0,void 0,(function*(){return vf.logout()}))}const Af=wf;let Rf;function Pf(){return Rf||(Rf=wf.authenticate().then((()=>{})).catch((()=>{Do()?((0,r.clearUrlLoginHints)(),(0,r.clearLoginHints)(),window.location.href=(0,t.eQ)()):window.location.href="/"}))),Rf}})(),o})())}}}));
