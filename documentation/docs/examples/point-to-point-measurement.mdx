---
id: point-to-point-measurement
title: Point to point measurement
description: Demo shows how to measure point to point distance in Reveal.
---

import { DemoWrapper } from '@site/docs/components/DemoWrapper';
import useBaseUrl from '@docusaurus/useBaseUrl';

The `MeasurementTool` is a measuring tool for point to point distance in 3D models, by clicking to- and from-points. The default measurement unit is meters, but the tool provides callbacks to allow configuring the unit.

The tool provides ability to change measuring line width & color.

:::note
Recommended: `CameraControlsOptions.changeCameraTargetOnClick` should be set to `false` to avoid click event when `MeasurementTool` is active.
:::

<DemoWrapper name="Cognite3DViewerDemo" />

## Point to point distance measurment
To enter point-to-point measurement mode, use `MeasurementTool.enterMeasurementMode()`. This will register events for handling mouse clicks and touch events to allow placing the measurement end-points.

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer);
measurementTool.enterMeasurementMode();
```

## Events
The tool contains events for subscribe to measurement start, end & added.
```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer);
// Subscribe to measurement events
measurementTool.subscribe('started', () => alert('Measurement is active'));
measurementTool.subscribe('added', () => alert('Measurement is added'));

measurementTool.enterMeasurementMode();
```

## Cancel measurement
To exit from measurement mode, use `MeasurementTool.exitMeasurementMode()`.

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer);
measurementTool.subscribe('ended', () => alert('Measurement is ended'));

measurementTool.enterMeasurementMode();

//Add point to point distance measurement before existing from measurement tool.
setTimeout(() => {
  measurementTool.exitMeasurementMode();
  viewer.requestRedraw();
}, 10000);
```

### Cancel active measurement
To cancel the current/active measurement, the user can use `ESC` key which will kill the active measurement

## Set width and color of the measuring line
To change width and color of the line, use `MeasurementTool.setLineOptions(options: MeasurementOptions)`. MeasurementOptions expects
  - `lineWidth` : number - units in meters
  - `color` : THREE.color

The updated line width and color will be applied for the next measuring distance.

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const lineOptions = {
  lineWidth: 3,
  color: new THREE.Color(0xff0000)
};
const measurementTool = new MeasurementTool(viewer);
measurementTool.enterMeasurementMode();

//Update line width & color for the next measuring line.
measurementTool.setLineOptions(lineOptions);
```

To change existing measurement line width or color, use `MeasurementTool.updateLineWidth(lineWidth: number)` or `MeasurementTool.updateLineColor(color: THREE.Color)`

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer);
measurementTool.enterMeasurementMode();

// Add few measurements

//Changes measurement line color & width to random values every 5 seconds.
setInterval(() => {
    const measurements = measurementTool.getAllMeasurements();

    measurements.forEach(measurement => {
      const color = Math.floor(Math.random() * 16777215);
      measurementTool.updateLineColor(measurement, new THREE.Color(color));

      //Update line width
      const lineWidth = (Math.random() * 1.0) + 0.2;
      measurementTool.updateLineWidth(measurement, lineWidth);
      viewer.requestRedraw();
    });
}, 5000);
```
### Change unit

It's also possible to apply custom label content for the measurement.
The tool provides a callback, `MeasurementOptions.distanceToLabelCallback`, that can be
used to trigger custom operation like changing the measuring units to feet:

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer, {distanceToLabelCallback: (distanceInMeters) => {
      // 1 meter = 3.281 feet
      return `${(distanceInMeters * 3.281).toFixed(2)} ft`;
     }});
measurementTool.enterMeasurementMode();
```

### Get all measurement
To get all measurements added in the viewer, we can provide `MeasurementTool.getAllMeasurements()` which will
returns array of measurement reference `Measurement` having
  - `measurementId` : unique id of measurement.
  - `startPoint` : start point of the measurement.
  - `endPoint` : end point of the measurement.
  - `distanceInMeters` : measured distance in meters.

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer);
measurementTool.enterMeasurementMode();

//add measurements

//get all measurements
setTimeout(() => {
  const measurements = measurementTool.getAllMeasurements();
  measurements.forEach(measurement => {
    alert(measurement.distanceInMeters);
  });
}, 6000);
```

### Remove measurement
To remove a measurement from the viewer, we have `MeasurementTool.removeMeasurement(measurement: Measurement)`
  - `measurement` : Measurement to be removed.

```jsx runnable
// import { MeasurementTool } from '@cognite/reveal/tools';

const measurementTool = new MeasurementTool(viewer);
measurementTool.enterMeasurementMode();

//remove the first measurement in the added list
setTimeout(() => {
    const measurements = measurementTool.getAllMeasurements();

    if (measurements[0]) {
      measurementTool.removeMeasurement(measurements[0]);
      viewer.requestRedraw();
    }
  }, 6000);
```

To remove all measurement from the viewer, use `MeasurementTool.removeAllMeasurement()`

```jsx
// Remove all measurement from the viewer
measurementTool.removeAllMeasurement();
```
### Label Visibility
Measurement labels can be hidden/visible using `MeasurementTool.showMeasurementLabels(enable: boolean)`.
```jsx
// Hide all measurement lables
measurementTool.showMeasurementLabels(false);
```

