{"ast":null,"code":"var _jsxFileName = \"/Volumes/csvol/fusion/apps/functions-ui/src/components/buttons/DeleteFunctionButton.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { notification } from 'antd';\nimport { Button } from '@cognite/cogs.js';\nimport DeleteFunctionModal from '../../components/FunctionModals/DeleteFunctionModal';\nimport { deleteFunction } from '../../utils/api';\nimport { useFunction } from '../../utils/hooks';\nimport { allFunctionsKey } from '../../utils/queryKeys';\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NOTIFICATION_KEY = `delete-notifications`;\nexport default function DeleteFunctionButton({\n  id\n}) {\n  _s();\n  const client = useQueryClient();\n  const [showModal, setShowModal] = useState(false);\n  const {\n    data\n  } = useFunction(id);\n  const name = data?.name;\n  const {\n    mutate: deleteFn,\n    isLoading: isDeleting,\n    isSuccess: isDeleted,\n    isError\n  } = useMutation(deleteFunction, {\n    onSuccess() {\n      client.invalidateQueries([allFunctionsKey]);\n    }\n  });\n  useEffect(() => {\n    if (isDeleting) {\n      notification.info({\n        message: 'Deleting function',\n        description: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"Deleting function \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 43,\n            columnNumber: 31\n          }, this), \" (\", id, \")\"]\n        }, void 0, true),\n        key: NOTIFICATION_KEY\n      });\n    }\n  }, [isDeleting, id, name]);\n  useEffect(() => {\n    if (isDeleted) {\n      notification.success({\n        message: 'Function deleted',\n        description: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"Function \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 22\n          }, this), \" (\", id, \") deleted successfully\"]\n        }, void 0, true),\n        key: NOTIFICATION_KEY\n      });\n    }\n  }, [isDeleted, id, name]);\n  useEffect(() => {\n    if (isError) {\n      notification.error({\n        message: 'Deleting function',\n        description: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"An error occured when trying to delete function\", ' ', /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 13\n          }, this), \" ($\", id, \")\"]\n        }, void 0, true),\n        key: NOTIFICATION_KEY\n      });\n    }\n  }, [isError, id, name]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      icon: \"Delete\",\n      size: \"small\",\n      style: {\n        marginLeft: '8px',\n        justifyContent: 'center'\n      },\n      onClick: e => {\n        e.stopPropagation();\n        setShowModal(true);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(DeleteFunctionModal, {\n      id: id,\n      onCancel: () => setShowModal(false),\n      onDelete: (functionId, fileId) => {\n        deleteFn({\n          id: functionId,\n          fileId\n        });\n        setShowModal(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(DeleteFunctionButton, \"mOTiMKXAxHTDjGIHRfZHF7Ys5/A=\", false, function () {\n  return [useQueryClient, useFunction, useMutation];\n});\n_c = DeleteFunctionButton;\nvar _c;\n$RefreshReg$(_c, \"DeleteFunctionButton\");","map":{"version":3,"names":["React","useState","useEffect","useMutation","useQueryClient","notification","Button","DeleteFunctionModal","deleteFunction","useFunction","allFunctionsKey","NOTIFICATION_KEY","DeleteFunctionButton","id","client","showModal","setShowModal","data","name","mutate","deleteFn","isLoading","isDeleting","isSuccess","isDeleted","isError","onSuccess","invalidateQueries","info","message","description","key","success","error","marginLeft","justifyContent","e","stopPropagation","functionId","fileId"],"sources":["/Volumes/csvol/fusion/apps/functions-ui/src/components/buttons/DeleteFunctionButton.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { notification } from 'antd';\n\nimport { Button } from '@cognite/cogs.js';\n\nimport DeleteFunctionModal from '../../components/FunctionModals/DeleteFunctionModal';\nimport { deleteFunction } from '../../utils/api';\nimport { useFunction } from '../../utils/hooks';\nimport { allFunctionsKey } from '../../utils/queryKeys';\n\ntype Props = {\n  id: number;\n};\n\nconst NOTIFICATION_KEY = `delete-notifications`;\n\nexport default function DeleteFunctionButton({ id }: Props) {\n  const client = useQueryClient();\n  const [showModal, setShowModal] = useState(false);\n\n  const { data } = useFunction(id);\n  const name = data?.name;\n\n  const {\n    mutate: deleteFn,\n    isLoading: isDeleting,\n    isSuccess: isDeleted,\n    isError,\n  } = useMutation(deleteFunction, {\n    onSuccess() {\n      client.invalidateQueries([allFunctionsKey]);\n    },\n  });\n\n  useEffect(() => {\n    if (isDeleting) {\n      notification.info({\n        message: 'Deleting function',\n        description: (\n          <>\n            Deleting function <strong>{name}</strong> ({id})\n          </>\n        ),\n        key: NOTIFICATION_KEY,\n      });\n    }\n  }, [isDeleting, id, name]);\n\n  useEffect(() => {\n    if (isDeleted) {\n      notification.success({\n        message: 'Function deleted',\n        description: (\n          <>\n            Function <strong>{name}</strong> ({id}) deleted successfully\n          </>\n        ),\n        key: NOTIFICATION_KEY,\n      });\n    }\n  }, [isDeleted, id, name]);\n\n  useEffect(() => {\n    if (isError) {\n      notification.error({\n        message: 'Deleting function',\n        description: (\n          <>\n            An error occured when trying to delete function{' '}\n            <strong>{name}</strong> (${id})\n          </>\n        ),\n        key: NOTIFICATION_KEY,\n      });\n    }\n  }, [isError, id, name]);\n\n  return (\n    <>\n      <Button\n        icon=\"Delete\"\n        size=\"small\"\n        style={{\n          marginLeft: '8px',\n          justifyContent: 'center',\n        }}\n        onClick={(e) => {\n          e.stopPropagation();\n          setShowModal(true);\n        }}\n      />\n      {showModal && (\n        <DeleteFunctionModal\n          id={id}\n          onCancel={() => setShowModal(false)}\n          onDelete={(functionId: number, fileId?: number) => {\n            deleteFn({ id: functionId, fileId });\n            setShowModal(false);\n          }}\n        />\n      )}\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}